!function(e){function t(a){if(r[a])return r[a].exports;var _=r[a]={i:a,l:!1,exports:{}};return e[a].call(_.exports,_,_.exports,t),_.l=!0,_.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=91)}([function(e,t,r){"use strict";var a=r(35),_={};t.a=function(e,t,r){function n(){return function(e){return e=e||"__b4w_default",void 0!==o[e]?o[e]:(o[e]=i?{}:n(),t(e,o[e]),o[e])}}var o={},i="__"==e.split("").slice(0,2).join("");if(void 0!==_[e])return _[e];var s=i?n():n()();return a.a._n_module[e]=_[e]=s,s}},function(e,t,r){"use strict";function a(e,t){function r(e,t){var r=[];e[0].indexOf("%c")>-1?r.push(e[0].replace("%c","%c"+t+": ")):r.push(t+": "+e[0]);for(var a=1;a<e.length;a++)r.push(e[a]);return r}function a(){i++;var e=r(arguments,"B4W ERROR");console.error.apply(console,e)}function _(e){e in c||(c[e]=e,a([e]))}function n(e,t){_(e+"() is deprecated, use "+t+"() instead.")}var o=!1,i=0,s=0,c={};t.set_verbose=function(e){o=e},t.log_raw=function(){console.log.apply(console,arguments)},t.log=function(){if(o){var e=r(arguments,"B4W LOG");console.log.apply(console,e)}},t.compose_args_prefix=r,t.error=a,t.error_once=_,t.error_deprecated=n,t.error_deprecated_arr=function(e,t){switch(t.length>1){case!0:_(e+"() is deprecated, use "+t.slice(0,-1).join("(), ")+"() or "+t[t.length-1]+"() instead.");break;case!1:n(e,t[0])}},t.error_deprecated_cfg=function(e,t){_(void 0===t?'Config option "'+e+'" is deprecated.':'Config option "'+e+'" is deprecated, use "'+t+'" instead.')},t.warn=function(){s++;var e=r(arguments,"B4W WARN");console.warn.apply(console,e)},t.info=function(){var e=r(arguments,"B4W INFO");console.info.apply(console,e)},t.export_error=function(){i++;var e=r(arguments,"B4W EXPORT ERROR");console.error.apply(console,e)},t.export_warn=function(){s++;var e=r(arguments,"B4W EXPORT WARNING");console.warn.apply(console,e)},t.time=function(){o&&console.time.apply(console,arguments)},t.timeEnd=function(){o&&console.timeEnd.apply(console,arguments)},t.group=function(){console.group.apply(console,arguments)},t.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)},t.groupEnd=function(){console.groupEnd.apply(console,arguments)},t.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)},t.get_warning_count=function(){return s},t.get_error_count=function(){return i},t.clear_errors_warnings=function(){s=0,i=0}}var _=r(0),n=Object(_.a)("print",a);Object(_.a)("__print",a),t.a=n},function(e,t,r){"use strict";function a(e){return qt.test(Object.prototype.toString.call(e))}function _(e){return"undefined"!=typeof e}function n(e,t,r){for(var a=[],_=r.length,n=0;n<_;n++){var o=r[n];o[e]==t&&a.push(o)}return a}function o(e){return new Float32Array(e)}function i(e,t){var r=e.length,a=new Float32Array(r+t.length);return a.set(e),a.set(t,r),a}function s(e,t){var r=e.length,a=new Uint32Array(r+t.length);return a.set(e),a.set(t,r),a}function c(){var e=new Uint16Array([255]);return 255==new DataView(e.buffer).getUint16(0,!0)}function E(e,t){var r,a,_=[],n={},o=t.length;for(r=0;r<o;r++)n[t[r]]=!0;for(o=e.length,r=0;r<o;r++)(a=e[r])in n&&_.push(a);return _}function l(e){return e>0?1:e<0?-1:0}function T(e,t,r){for(var a=0;a<r.length;a++){var _=r[a];if(_[e]===t)return _}return null}function u(e,t,r){for(var a=0;a<e.length;a++)if(e[a][t]==r)return a;return-1}function d(e,t){for(var r=0;r<e.length;r++)if(e[r]==t)return;e.push(t)}function f(e,t,r,a){return a||(a=new Float32Array(16)),_t.identity(a),a[12]=e,a[13]=t,a[14]=r,a}function P(e){var t=Math.floor(e[0]/er),r=e[0]%er,a=Jt*r-$t*t;return e[0]=a>0?a:a+Zt,(e[0]-1)/(Zt-1)}function A(e,t){return t||(t=[]),t[0]=Wt+Math.floor(e),t}function S(e,t){var r=Et;return r[0]=e[2],r[1]=e[1],r[2]=e[0],p(r,zt,t),t}function p(e,t,r){var a=e[0],_=e[1],n=e[2],o=Math.cos(a/2),i=Math.cos(_/2),s=Math.cos(n/2),c=Math.sin(a/2),E=Math.sin(_/2),l=Math.sin(n/2);if(Vt.indexOf(t)>-1)var T=Math.cos((a+n)/2),u=Math.sin((a+n)/2),d=Math.cos((a-n)/2),f=Math.sin((a-n)/2),P=Math.cos((n-a)/2),A=Math.sin((n-a)/2);switch(t){case Ct:r[0]=i*u,r[1]=E*d,r[2]=E*f,r[3]=i*T;break;case Dt:r[0]=E*f,r[1]=i*u,r[2]=E*d,r[3]=i*T;break;case Ft:r[0]=E*d,r[1]=E*f,r[2]=i*u,r[3]=i*T;break;case Gt:r[0]=i*u,r[1]=E*A,r[2]=E*P,r[3]=i*T;break;case kt:r[0]=E*P,r[1]=i*u,r[2]=E*A,r[3]=i*T;break;case Kt:r[0]=E*A,r[1]=E*P,r[2]=i*u,r[3]=i*T;break;case Bt:r[0]=c*i*s+o*E*l,r[1]=o*E*s-c*i*l,r[2]=o*i*l+c*E*s,r[3]=o*i*s-c*E*l;break;case Xt:r[0]=o*i*l+c*E*s,r[1]=c*i*s+o*E*l,r[2]=o*E*s-c*i*l,r[3]=o*i*s-c*E*l;break;case jt:r[0]=o*E*s-c*i*l,r[1]=o*i*l+c*E*s,r[2]=c*i*s+o*E*l,r[3]=o*i*s-c*E*l;break;case Ht:r[0]=c*i*s-o*E*l,r[1]=o*i*l-c*E*s,r[2]=o*E*s+c*i*l,r[3]=o*i*s+c*E*l;break;case Qt:r[0]=o*E*s+c*i*l,r[1]=c*i*s-o*E*l,r[2]=o*i*l-c*E*s,r[3]=o*i*s+c*E*l;break;case zt:r[0]=o*i*l-c*E*s,r[1]=o*E*s+c*i*l,r[2]=c*i*s-o*E*l,r[3]=o*i*s+c*E*l}return r}function v(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3];switch(t){case Ct:r[0]=Math.atan2(a*_+n*o,_*o-a*n),r[1]=Math.acos(1-2*(_*_+n*n)),r[2]=Math.atan2(a*_-n*o,a*n+_*o);break;case Dt:r[0]=Math.atan2(a*o+_*n,n*o-a*_),r[1]=Math.acos(1-2*(a*a+n*n)),r[2]=Math.atan2(_*n-a*o,a*_+n*o);break;case Ft:r[0]=Math.atan2(a*n+_*o,a*o-_*n),r[1]=Math.acos(1-2*(a*a+_*_)),r[2]=Math.atan2(a*n-_*o,a*o+_*n);break;case Gt:r[0]=Math.atan2(a*n-_*o,a*_+n*o),r[1]=Math.acos(1-2*(_*_+n*n)),r[2]=Math.atan2(a*n+_*o,n*o-a*_);break;case kt:r[0]=Math.atan2(a*_-n*o,a*o+_*n),r[1]=Math.acos(1-2*(a*a+n*n)),r[2]=Math.atan2(a*_+n*o,a*o-_*n);break;case Kt:r[0]=Math.atan2(_*n-a*o,a*n+_*o),r[1]=Math.acos(1-2*(a*a+_*_)),r[2]=Math.atan2(a*o+_*n,_*o-a*n);break;case Bt:r[0]=Math.atan2(2*(a*o-_*n),1-2*(a*a+_*_)),r[1]=Math.asin(2*(a*n+_*o)),r[2]=Math.atan2(2*(n*o-a*_),1-2*(_*_+n*n));break;case Xt:var i=a*_+n*o;i>.499999?(r[0]=0,r[1]=Math.PI/2,r[2]=2*Math.atan2(a,o)):i<-.499999?(r[0]=0,r[1]=-Math.PI/2,r[2]=-2*Math.atan2(a,o)):(r[0]=Math.atan2(2*(_*o-a*n),1-2*(_*_+n*n)),r[1]=Math.asin(2*(a*_+n*o)),r[2]=Math.atan2(2*(a*o-_*n),1-2*(a*a+n*n)));break;case jt:r[0]=Math.atan2(2*(n*o-a*_),1-2*(a*a+n*n)),r[1]=Math.asin(2*(a*o+_*n)),r[2]=Math.atan2(2*(_*o-a*n),1-2*(a*a+_*_));break;case Ht:r[0]=Math.atan2(2*(a*o+_*n),1-2*(a*a+n*n)),r[1]=Math.asin(2*(n*o-a*_)),r[2]=Math.atan2(2*(a*n+_*o),1-2*(_*_+n*n));break;case Qt:r[0]=Math.atan2(2*(a*n+_*o),1-2*(a*a+_*_)),r[1]=Math.asin(2*(a*o-_*n)),r[2]=Math.atan2(2*(a*_+n*o),1-2*(a*a+n*n));break;case zt:var i=_*o-a*n;i>.499999?(r[0]=0,r[1]=Math.PI/2,r[2]=-2*Math.atan2(n,o)):i<-.499999?(r[0]=0,r[1]=-Math.PI/2,r[2]=2*Math.atan2(n,o)):(r[0]=Math.atan2(2*(a*_+n*o),1-2*(_*_+n*n)),r[1]=Math.asin(2*(_*o-a*n)),r[2]=Math.atan2(2*(a*o+_*n),1-2*(a*a+_*_)))}return r}function m(e,t){var r=Math.cos(e[0]),a=Math.cos(e[1]),_=Math.cos(e[2]),n=Math.sin(e[0]),o=Math.sin(e[1]),i=Math.sin(e[2]),s=r*_,c=r*i,E=n*_,l=n*i;return t[0]=a*_,t[1]=a*i,t[2]=-o,t[3]=o*E-c,t[4]=o*l+s,t[5]=a*n,t[6]=o*s+l,t[7]=o*c-E,t[8]=a*r,t}function O(e,t){var r=v(e,zt,Et);return t[0]=r[2],t[1]=r[1],t[2]=r[0],t}function N(e,t,r){return r||(r=new Float32Array(3)),st.transformQuat(t,e,r),r}function g(e,t,r){r||(r=new Float32Array(4)),e=st.normalize(e,Et);var a=st.dot(t,e),_=st.cross(t,e,lt),n=Math.acos(a);return r[0]=_[0]*Math.sin(n/2),r[1]=_[1]*Math.sin(n/2),r[2]=_[2]*Math.sin(n/2),r[3]=Math.cos(n/2),r}function h(e,t,r,a){return a||(a=new Float32Array(4)),st.transformQuat(r,t,a),a[3]=-st.dot(e,a),a}function R(e,t,r,a){if(0==r)return e;a=a||[];for(var _=0;_<e.length;_++)a[_]=(1-r)*e[_]+r*t[_];return a}function I(e){if(!(e instanceof Object))return e;var t,r=e.constructor;switch(r){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:t=new r(e);break;case Array:t=new r(e.length);for(var a=0;a<e.length;a++)t[a]=I(e[a]);break;default:t=new r;for(var _ in e)e.hasOwnProperty(_)&&(t[_]=I(e[_]))}return t}function b(e){var t=e instanceof Array?[]:{};for(var r in e)if(e.hasOwnProperty(r))if(e[r]instanceof Object){var a=e[r].constructor;switch(a){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:t[r]=new a(e[r]);break;case Array:t[r]=e[r].slice(0);break;default:t[r]=e[r]}}else t[r]=e[r];return t}function Y(e,t){t||(t=new Float32Array(4)),at.fromMat4(e,vt);var r=vt[0],a=vt[3],_=vt[6],n=vt[1],o=vt[4],i=vt[7],s=vt[2],c=vt[5],E=vt[8],l=Math.sqrt(r*r+a*a+_*_)||1,T=Math.sqrt(n*n+o*o+i*i)||1,u=Math.sqrt(s*s+c*c+E*E)||1;return vt[0]/=l,vt[3]/=l,vt[6]/=l,vt[1]/=T,vt[4]/=T,vt[7]/=T,vt[2]/=u,vt[5]/=u,vt[8]/=u,ot.fromMat3(vt,t),ot.normalize(t,t),t}function L(e,t){return t||(t=new Float32Array(3)),t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function M(e,t){St[0]=.577350269189626,St[1]=.577350269189626,St[2]=.577350269189626,St[3]=0,ct.transformMat4(St,e,St);var r=ct.length(St);return t?st.set(r,r,r,t):r}function y(e,t){var r=t.left,a=t.right,_=t.top,n=t.bottom,o=t.near,i=t.far;return r[0]=e[3]+e[0],r[1]=e[7]+e[4],r[2]=e[11]+e[8],r[3]=e[15]+e[12],a[0]=e[3]-e[0],a[1]=e[7]-e[4],a[2]=e[11]-e[8],a[3]=e[15]-e[12],_[0]=e[3]-e[1],_[1]=e[7]-e[5],_[2]=e[11]-e[9],_[3]=e[15]-e[13],n[0]=e[3]+e[1],n[1]=e[7]+e[5],n[2]=e[11]+e[9],n[3]=e[15]+e[13],o[0]=e[3]+e[2],o[1]=e[7]+e[6],o[2]=e[11]+e[10],o[3]=e[15]+e[14],i[0]=e[3]-e[2],i[1]=e[7]-e[6],i[2]=e[11]-e[10],i[3]=e[15]-e[14],x(r),x(a),x(_),x(n),x(o),x(i),t}function x(e){var t=e[0],r=e[1],a=e[2],_=e[3],n=Math.sqrt(t*t+r*r+a*a);n=1/n,e[0]=t*n,e[1]=r*n,e[2]=a*n,e[3]=_*n}function U(e,t,r){return r<-nt.P(e,t.near)||r<-nt.P(e,t.left)||r<-nt.P(e,t.right)||r<-nt.P(e,t.top)||r<-nt.P(e,t.bottom)||r<-nt.P(e,t.far)}function w(e,t,r,a,_){var n=st.dot(r,t.far),o=st.dot(a,t.far),i=st.dot(_,t.far),s=Math.sqrt(n*n+o*o+i*i);return s<-nt.P(e,t.near)||s<-nt.P(e,t.far)||(n=st.dot(r,t.left),o=st.dot(a,t.left),i=st.dot(_,t.left),Math.sqrt(n*n+o*o+i*i)<-nt.P(e,t.left)||(n=st.dot(r,t.right),o=st.dot(a,t.right),i=st.dot(_,t.right),Math.sqrt(n*n+o*o+i*i)<-nt.P(e,t.right)||(n=st.dot(r,t.top),o=st.dot(a,t.top),i=st.dot(_,t.top),Math.sqrt(n*n+o*o+i*i)<-nt.P(e,t.top)||(n=st.dot(r,t.bottom),o=st.dot(a,t.bottom),i=st.dot(_,t.bottom),Math.sqrt(n*n+o*o+i*i)<-nt.P(e,t.bottom)))))}function C(e,t,r,a){a||(a=0);for(var _=e.length,n=0;n<_;n+=3){var o=e[n],i=e[n+1],s=e[n+2];r[a+n]=t[0]*o+t[4]*i+t[8]*s+t[12],r[a+n+1]=t[1]*o+t[5]*i+t[9]*s+t[13],r[a+n+2]=t[2]*o+t[6]*i+t[10]*s+t[14]}return r}function D(e,t,r,a){a=a||0;for(var _=e.length,n=ht,o=0;o<_;o+=4){n[0]=e[o],n[1]=e[o+1],n[2]=e[o+2],n[3]=e[o+3];var i=n[3]>0;ot.multiply(t,n,n),(i&&n[3]<0||!i&&n[3]>0)&&ct.scale(n,-1,n),r[a+o]=n[0],r[a+o+1]=n[1],r[a+o+2]=n[2],r[a+o+3]=n[3]}return r}function F(e,t,r){r||(r=new Float32Array(3));var a=St;a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=0,ct.transformMat4(a,t,a),r[0]=a[0],r[1]=a[1],r[2]=a[2]}function G(e,t){t||(t=[]);for(var r=0;r<e.length;r+=3){var a=new Float32Array([e[r],e[r+1],e[r+2]]);t[r/3]=a}return t}function k(e,t,r,a){if(a<r)return r;var _=r+Math.floor((a-r)/2);return e[_]>t?k(e,t,r,_-1):e[_]<t?k(e,t,_+1,a):_}function K(e,t){for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function B(e,t,r,a,_){_||(_=new Float32Array(3));var n=_t.fromRotationTranslation(r,a,Nt);if(1!==t){var o=_t.identity(gt),i=st.set(t,t,t,Et);_t.scale(o,i,o),_t.multiply(n,o,n)}return st.transformMat4(e,n,_),_}function X(e,t,r,a){a||(a=new Float32Array(3));var _=Et;st.subtract(t,e,_),st.transformQuat(_,r,_),st.subtract(t,_,a)}function j(){var e=Et;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),r=new Float32Array(16),a=new Float32Array(16),_=new Float32Array(16),n=new Float32Array(16),o=new Float32Array(16);return _t.lookAt(e,[-1,0,0],[0,-1,0],t),_t.scale(t,[-1,1,1],t),_t.scale(t,[-1,1,-1],r),_t.lookAt(e,[0,-1,0],[0,0,-1],a),_t.scale(a,[1,1,-1],a),_t.scale(a,[1,-1,-1],_),_t.lookAt(e,[0,0,-1],[0,-1,0],n),_t.scale(n,[-1,1,1],n),_t.scale(n,[-1,1,-1],o),[t,r,a,_,n,o]}function H(){var e=Et;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),r=new Float32Array(16),a=new Float32Array(16),_=new Float32Array(16),n=new Float32Array(16),o=new Float32Array(16);return _t.lookAt(e,[1,0,0],[0,-1,0],t),_t.scale(t,[-1,1,-1],r),_t.lookAt(e,[0,1,0],[0,0,1],a),_t.scale(a,[1,-1,-1],_),_t.lookAt(e,[0,0,1],[0,-1,0],n),_t.scale(n,[-1,1,-1],o),[t,r,a,_,n,o]}function Q(e,t){for(var r=t,a=0;a<e.length;a++){r=(r<<5)-r+e.charCodeAt(a),r&=r}return r}function z(e,t){return t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t}function q(e,t){t||(t=e);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(r>0){t[3]=2*Math.acos(e[3]);var a=1/Math.sqrt(r);t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t}function V(e){return(e*=34*e+1)%289}function W(e){return e-Math.floor(e)}function J(e){return isNaN(e)||"undefined"==typeof e?NaN:0|e}function Z(e){return e*Math.PI/180}function $(e){return 180*e/Math.PI}function ee(e){var t=.211324865405187,r=.366025403784439,a=-.577350269189626,_=.024390243902439,n=e[0]*r+e[1]*r,o=Math.floor(e[0]+n),i=Math.floor(e[1]+n),s=o*t+i*t,c=e[0]-o+s,E=e[1]-i+s,l=c>E?1:0,T=1-l,u=c+t-l,d=E+t-T,f=c+a,P=E+a;o%=289,i%=289;var A=V(V(i)+o),S=V(V(i+T)+o+l),p=V(V(i+1)+o+1),v=Math.max(.5-(c*c+E*E),0),m=Math.max(.5-(u*u+d*d),0),O=Math.max(.5-(f*f+P*P),0);v*=v*v*v,m*=m*m*m,O*=O*O*O;var N=2*W(A*_)-1,g=2*W(S*_)-1,h=2*W(p*_)-1,R=Math.abs(N)-.5,I=Math.abs(g)-.5,b=Math.abs(h)-.5,Y=Math.floor(N+.5),L=Math.floor(g+.5),M=Math.floor(h+.5),y=N-Y,x=g-L,U=h-M;return v*=1.79284291400159-.85373472095314*(y*y+R*R),m*=1.79284291400159-.85373472095314*(x*x+I*I),O*=1.79284291400159-.85373472095314*(U*U+b*b),130*(v*(y*c+R*E)+m*(x*u+I*d)+O*(U*f+b*P))}function te(e){return re((34*e+5)*e)}function re(e){return e-289*Math.floor(e/289)}function ae(e){return e-7*Math.floor(e/7)}function _e(e){var t=1/7,r=t/2,a=re(Math.floor(e[0])),_=re(Math.floor(e[1])),n=W(e[0]),o=W(e[1]),i=n-.5,s=n-1.5,c=i,E=s,l=o-.5,T=l,u=o-1.5,d=u,f=te(a),P=te(a+1),A=f,S=P;f=te(f+_),P=te(P+_),A=te(A+_+1),S=te(S+_+1);var p=ae(f)*t+r,v=ae(P)*t+r,m=ae(A)*t+r,O=ae(S)*t+r,N=ae(Math.floor(f*t))*t+r,g=ae(Math.floor(P*t))*t+r,h=ae(Math.floor(A*t))*t+r,R=ae(Math.floor(S*t))*t+r,I=i+.7*p,b=s+.7*v,Y=c+.7*m,L=E+.7*O,M=l+.7*N,y=T+.7*g,x=u+.7*h,U=d+.7*R,w=I*I+M*M,C=b*b+y*y,D=Y*Y+x*x,F=L*L+U*U;return Math.min(w,C,D,F)}function ne(e,t,r,a,_){_||(_=new Float32Array(4));var n=st.transformQuat(t,e,Et),o=r[0],i=r[1],s=r[2],c=vt;return c[0]=i*i+s*s,c[1]=-i*o,c[2]=-s*o,c[3]=-o*i,c[4]=o*o+s*s,c[5]=-s*i,c[6]=-o*s,c[7]=-i*s,c[8]=o*o+i*i,st.transformMat3(n,c,n),st.normalize(n,n),ot.rotationTo(a,n,_),_}function oe(e,t){t||(t=new Float32Array(4));var r=St,a=pt;return r=ot.setAxisAngle([0,0,1],Math.PI,ot.create()),a=ot.setAxisAngle([1,0,0],Math.PI/2,ot.create()),ot.multiply(r,a,r),ot.multiply(e,r,t),t}function ie(e,t,r){return e<t&&(e=t),e>r&&(e=r),e}function se(e,t,r,a){if(a){var _=Math.exp(-r/a);return(1-_)*e+_*t}return e}function ce(e,t,r,a,_){if(_||(_=new Float32Array(e.length)),a)for(var n=Math.exp(-r/a),o=0;o<_.length;o++)_[o]=(1-n)*e[o]+n*t[o];else st.copy(e,_);return _}function Ee(e,t,r,a,_){if(_||(_=new Float32Array(e.length)),a){var n=Math.exp(-r/a);ot.slerp(e,t,n,_)}else ot.copy(e,_);return _}function le(e){return!!("object"===typeof e&&e.buffer&&e.buffer instanceof ArrayBuffer)}function Te(e,t){return!!(e instanceof Array||e.buffer&&e.buffer instanceof ArrayBuffer)&&(!(!t||t!=e.length)||!t)}function ue(e,t){var r=at.fromQuat(e,vt),a=Et;a[0]=r[6],a[1]=r[7],a[2]=r[8];var _=st.cross(yt,a,a);st.normalize(_,_);var n=r[4];!t&&n>0&&(_[0]*=-1,_[1]*=-1,_[2]*=-1);var o=lt;o[0]=r[0],o[1]=r[1],o[2]=r[2],st.normalize(o,o);var i=pt;ot.rotationTo(o,_,i),ot.multiply(i,e,e)}function de(e,t,r,a){var _=r*t-.5,n=a*t-.5,o=_-Math.floor(_),i=n-Math.floor(n);_=Math.floor(_),n=Math.floor(n);var s=t-1;return(e[n*t+_]*(1-o)+e[n*t+Math.min(_+1,s)]*o)*(1-i)+(e[Math.min(n+1,s)*t+_]*(1-o)+e[Math.min(n+1,s)*t+Math.min(_+1,s)]*o)*i}function fe(e){for(var t=0,r=0;r<3;r++)(e&1<<r)>0&&t++;return t}function Pe(e){for(var t=[0,0,0],r=0;r<3;r++)(e&1<<r)>0&&(t[2-r]=1);return t}function Ae(e,t){var r=0;return 1!=t&&2!=t||(4&e)>0&&r++,2==t&&(2&e)>0&&r++,r}function Se(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function pe(e){var t=0;for(var r in e)e.hasOwnProperty(r)&&t++;return t}function ve(e){return e.length?e[Math.floor(Math.random()*e.length)]:null}function me(e,t,r){r||(r=new Float32Array(3)),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=0,st.normalize(r,r)}function Oe(e,t,r){var a=e[0],_=e[1],n=e[2],o=t[0],i=t[1],s=t[2],c=t[3],E=i*n-s*_,l=s*a-o*n,T=o*_-i*a,u=i*T-s*l,d=s*E-o*T,f=o*l-i*E;return E*=2*c,l*=2*c,T*=2*c,u*=2,d*=2,f*=2,r[0]=a+E+u,r[1]=_+l+d,r[2]=n+T+f,r}function Ne(e,t,r){var a=e-t,_=r-t;return t+(a-Math.floor(a/_)*_)}function ge(e){return Ne(e,0,2*Math.PI)}function he(e,t){for(var r in e){var a=!0,_=e[r],n=t[r];switch(typeof _){case"number":case"string":case"boolean":a=_==n;break;case"object":a=Re(_,n)}if(!a)return!1}return!0}function Re(e,t){if(e&&t){var r=e instanceof Array;if(r!=t instanceof Array)return!1;var a=e.buffer instanceof ArrayBuffer&&"undefined"!==e.byteLength;if(a!=(t.buffer instanceof ArrayBuffer&&"undefined"!==t.byteLength))return!1;if(r){if(e.length!=t.length)return!1;for(var _=0;_<e.length;_++)if(!Ie(e[_],t[_]))return!1}else if(a){if(e.length!=t.length)return!1;for(var _=0;_<e.length;_++)if(e[_]!=t[_])return!1}else{switch(e.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:return e==t}for(var n in e)if(!Ie(e[n],t[n]))return!1;for(var n in t)if(!(n in e))return!1}return!0}return!(e||t)}function Ie(e,t){if(typeof e!=typeof t)return!1;switch(typeof e){case"number":case"string":case"boolean":return e==t;case"object":return Re(e,t);default:return!0}}function be(e,t){var r=e[0],a=e[1],_=e[2],n=e[3];return t[0]=a,t[1]=_,t[2]=n,t[3]=r,t}function Ye(e,t,r,a){var _=St;_.set(e),_[3]=t;var n=pt;Et[0]=r[3],Et[1]=r[4],Et[2]=r[5],n.set(Et),n[3]=0;var o=ct.dot(_,n);if(0==o)return null;var i=pt;st.copy(r,Et),i.set(Et),i[3]=1;var s=ct.dot(_,i),c=-s/o;return a[0]=r[0]+c*r[3],a[1]=r[1]+c*r[4],a[2]=r[2]+c*r[5],a}function Le(e,t,r,a){var _=t[0]-e[0],n=r[0]-e[0],o=t[1]-e[1],i=r[1]-e[1],s=t[2]-e[2],c=r[2]-e[2];return a[0]=o*c-s*i,a[1]=n*s-_*c,a[2]=_*i-o*n,a}function Me(e,t,r){var a=Et,_=st.dot(e,t);return _<-.9999999?(st.cross(Lt,e,a),st.length(a)<1e-6&&st.cross(Mt,e,a),st.normalize(a,a),ot.setAxisAngle(a,Math.PI,r)):(st.cross(e,t,a),r.set(a),r[3]=1+_,ot.normalize(r,r)),r}function ye(e,t,r){if(t==r)return r-e;e=ge(e),t=ge(t),r=ge(r);var a=2*Math.PI-t;if(t=0,r+=a,r=ge(r),e+=a,(e=ge(e))>r){var _=r-e,n=2*Math.PI-e;return-_>n?n:_}return 0}function xe(e,t,r){return isFinite(t)&&isFinite(r)&&(e=ie(e,t,r)),e*e*(3-2*e)}function Ue(e,t,r){return t+e*(r-t)}function we(e,t){for(var r=0;r<e.length;r++)for(var a=0;a<t.length;a++)if(t[a]==e[r])return!0;return!1}function Ce(e,t){for(var r=Math.max(e.length,t.length),a=0;a<r;a++){var _=a>=e.length?0:e[a],n=a>=t.length?0:t[a],o=l(_-n);if(o)return o}return 0}function De(e){return e.join(".")}function Fe(e){return e.split(".").map(function(e){return 0|e})}function Ge(e,t){return t[0]=Math.pow(e[0],rr),t[1]=Math.pow(e[1],rr),t[2]=Math.pow(e[2],rr),t}function ke(e,t){return t[0]=Math.pow(e[0],1/rr),t[1]=Math.pow(e[1],1/rr),t[2]=Math.pow(e[2],1/rr),t}function Ke(e){return 0!=parseInt(e.toString(2).substr(1),2)}function Be(e,t,r,a){return a[0]=e[0],a[1]=t[0],a[2]=r[0],a[3]=e[1],a[4]=t[1],a[5]=r[1],a[6]=e[2],a[7]=t[2],a[8]=r[2],a}function Xe(){var e=[{}];return e.length=0,e}function je(e){var t=Math.round(32767.5*(e+1)-32768);return ie(t||0,-32768,32767)}function He(e){return ie((e+32768)/32767.5-1,-1,1)}function Qe(e){return ie(Math.round(255*e),0,255)}function ze(e){return ie(e/255,0,1)}function qe(e,t,r,a){var _=st.subtract(r,t,Et),n=st.subtract(a,r,lt),o=st.subtract(t,a,Tt),i=st.subtract(e,t,ut),s=st.subtract(e,r,dt),c=st.subtract(e,a,ft),E=st.cross(_,n,Pt);if(st.dot(st.cross(E,_,At),i)>=0&&st.dot(st.cross(E,n,At),s)>=0&&st.dot(st.cross(E,o,At),c)>=0){var l=st.length(E),T=st.dot(E,i);return Math.abs(T/l)}var u=st.scale(_,ie(st.dot(_,i)/st.length(_),0,1),At),d=st.length(st.subtract(i,u,At)),f=st.scale(n,ie(st.dot(n,s)/st.length(n),0,1),At),P=st.length(st.subtract(s,f,At)),A=st.scale(o,ie(st.dot(o,c)/st.length(o),0,1),At),S=st.length(st.subtract(c,A,At));return Math.min(Math.min(d,P),S)}function Ve(e,t,r,a,_){if(r||a){var n=ot.identity(ht);if(r){var o=ot.setAxisAngle(t,r,Rt);ot.multiply(n,o,n)}var i=ot.copy(e,_);if(a){var s=N(i,Lt,Et),c=ot.setAxisAngle(s,a,Rt);ot.normalize(c,c),ot.multiply(n,c,n)}ot.multiply(n,i,i),ot.normalize(i,i)}}function We(e,t,r,a){var _=lt;N(t,a,_),st.normalize(_,_);var n=Tt;st.subtract(r,e,n),st.normalize(n,n);var o=Me(_,n,St);ot.multiply(o,t,t),ot.normalize(t,t)}function Je(e,t,r,a){var _=st.transformQuat(t,e,lt),n=st.dot(a,r),o=st.scale(a,n,Tt),i=st.subtract(r,o,Tt),s=ot.identity(ht);st.normalize(i,i),Math.abs(st.dot(_,i))<.999999&&Me(_,i,s),ot.normalize(s,s),ot.multiply(s,e,e)}function Ze(e,t){for(var r=2*Math.PI,a=[],_=0;_<3;_++)a[_]=e[_]-t[_],a[_]>5.1?(e[_]-=a[_]/r*r,a[_]=e[_]-t[_]):a[_]<-5.1&&(e[_]+=-a[_]/r*r,a[_]=e[_]-t[_]);Math.abs(a[0])>3.2&&Math.abs(a[1])<1.6&&Math.abs(a[2])<1.6&&(a[0]>0?e[0]-=r:e[0]+=r),Math.abs(a[1])>3.2&&Math.abs(a[2])<1.6&&Math.abs(a[0])<1.6&&(a[1]>0?e[1]-=r:e[1]+=r),Math.abs(a[2])>3.2&&Math.abs(a[0])<1.6&&Math.abs(a[1])<1.6&&(a[2]>0?e[2]-=r:e[2]+=r)}function $e(e,t,r){var a=m(t,vt),_=m(e,mt);return rt(at.multiply(_,a,Ot),r)}function et(e,t,r){var a=Math.sqrt(e[0]*e[0]+e[1]*e[1]);a>1e-6?(t[0]=Math.atan2(e[5],e[8]),t[1]=Math.atan2(-e[2],a),t[2]=Math.atan2(e[1],e[0]),r[0]=Math.atan2(-e[5],-e[8]),r[1]=Math.atan2(-e[2],-a),r[2]=Math.atan2(-e[1],-e[0])):(t[0]=Math.atan2(-e[7],e[4]),t[1]=Math.atan2(-e[2],a),t[2]=0,st.copy(t,r))}function tt(e,t,r){var a=at.fromQuat(e,vt),_=Et,n=lt;et(a,_,n);var o=Math.abs(_[0]-t[0])+Math.abs(_[1]-t[1])+Math.abs(_[2]-t[2]),i=Math.abs(n[0]-t[0])+Math.abs(n[1]-t[1])+Math.abs(n[2]-t[2]),s=o>i?n:_;return st.copy(s,r),r}function rt(e,t){var r=Et,a=lt;et(e,r,a);var _=Math.abs(r[0])+Math.abs(r[1])+Math.abs(r[2]),n=Math.abs(a[0])+Math.abs(a[1])+Math.abs(a[2]),o=_>n?a:r;return st.copy(o,t),t}r.d(t,"m",function(){return It}),r.d(t,"k",function(){return bt}),r.d(t,"n",function(){return Yt}),r.d(t,"d",function(){return Lt}),r.d(t,"e",function(){return Mt}),r.d(t,"f",function(){return yt}),r.d(t,"a",function(){return xt}),r.d(t,"b",function(){return Ut}),r.d(t,"c",function(){return wt}),r.d(t,"o",function(){return Ct}),r.d(t,"v",function(){return Dt}),r.d(t,"x",function(){return Ft}),r.d(t,"q",function(){return Gt}),r.d(t,"s",function(){return kt}),r.d(t,"z",function(){return Kt}),r.d(t,"p",function(){return Bt}),r.d(t,"u",function(){return Xt}),r.d(t,"w",function(){return jt}),r.d(t,"r",function(){return Ht}),r.d(t,"t",function(){return Qt}),r.d(t,"y",function(){return zt}),t._15=a,r.d(t,"j",function(){return tr}),r.d(t,"g",function(){return ar}),r.d(t,"l",function(){return _r}),r.d(t,"h",function(){return nr}),r.d(t,"i",function(){return or}),t._17=_,t._18=n,t._1=o,t._2=i,t._67=s,t.K=c,t.D=E,t._50=l,t._19=T,t._9=u,t.C=d,t._60=f,t._40=P,t._13=A,t.Y=S,t._27=p,t._37=v,t.Z=m,t._36=O,t._34=N,t.U=g,t._61=h,t.G=R,t.O=I,t.N=b,t._24=Y,t._26=L,t._25=M,t._0=y,t._56=U,t.X=w,t._28=C,t._38=D,t._68=F,t._69=G,t.F=k,t.P=K,t._63=B,t._46=X,t._5=j,t._6=H,t._11=Q,t._23=z,t._33=q,t._64=J,t.T=Z,t._39=$,t._55=ee,t.J=_e,t._30=ne,t.I=oe,t.M=ie,t._51=se,t._54=ce,t._52=Ee,t._14=le,t._16=Te,t.R=ue,t._7=de,t._43=fe,t._44=Pe,t._42=Ae,t._4=Se,t._8=pe,t._41=ve,t._12=me,t._62=Oe,t.B=Ne,t.A=ge,t._59=he,t._29=be,t._22=Ye,t._10=Le,t._48=Me,t.H=ye,t._53=xe,t._20=Ue,t.E=we,t._70=Ce,t._71=De,t._58=Fe,t._57=Ge,t._21=ke,t.L=Ke,t.W=Be,t.S=Xe,t._3=je,t._49=He,t._66=Qe,t._65=ze,t.V=qe,t._47=Ve,t._31=We,t._32=Je,t.Q=Ze,t._45=$e,t._35=tt;var at=r(28),_t=r(21),nt=r(45),ot=r(8),it=r(6),st=r(3),ct=r(7),Et=new Float32Array(3),lt=new Float32Array(3),Tt=new Float32Array(3),ut=new Float32Array(3),dt=new Float32Array(3),ft=new Float32Array(3),Pt=new Float32Array(3),At=new Float32Array(3),St=new Float32Array(4),pt=new Float32Array(4),vt=new Float32Array(9),mt=new Float32Array(9),Ot=new Float32Array(9),Nt=new Float32Array(16),gt=new Float32Array(16),ht=ot.create(),Rt=ot.create(),It=new Float32Array([0,0,0]),bt=new Float32Array([0,0,0,1]),Yt=(it.b(),it.b(),new Float32Array([1,1,1])),Lt=new Float32Array([1,0,0]),Mt=new Float32Array([0,1,0]),yt=new Float32Array([0,0,1]),xt=new Float32Array([-1,0,0]),Ut=new Float32Array([0,-1,0]),wt=new Float32Array([0,0,-1]),Ct=0,Dt=1,Ft=2,Gt=3,kt=4,Kt=5,Bt=6,Xt=7,jt=8,Ht=9,Qt=10,zt=11,qt=new RegExp("object .*Array"),Vt=[Ct,Dt,Ft,kt,Kt],Wt=5e4,Jt=48271,Zt=2147483647,$t=Zt%Jt,er=Math.floor(Zt/Jt),tr=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])],rr=2.2,ar=1,_r=2,nr=4,or=4},function(e,t,r){"use strict";function a(){var e=new D(3);return e[0]=0,e[1]=0,e[2]=0,e}function _(e){var t=new D(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function n(e,t,r){var a=new D(3);return a[0]=e,a[1]=t,a[2]=r,a}function o(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function i(e,t,r,a){return a[0]=e,a[1]=t,a[2]=r,a}function s(e,t,r){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function c(e,t,r){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function E(e,t,r){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function l(e,t,r){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r}function T(e,t,r){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function u(e,t,r){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function d(e,t,r){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function f(e,t,r,a){return a[0]=e[0]+t[0]*r,a[1]=e[1]+t[1]*r,a[2]=e[2]+t[2]*r,a}function P(e,t){var r=t[0]-e[0],a=t[1]-e[1],_=t[2]-e[2];return Math.sqrt(r*r+a*a+_*_)}function A(e,t){var r=t[0]-e[0],a=t[1]-e[1],_=t[2]-e[2];return r*r+a*a+_*_}function S(e){var t=e[0],r=e[1],a=e[2];return Math.sqrt(t*t+r*r+a*a)}function p(e){var t=e[0],r=e[1],a=e[2];return t*t+r*r+a*a}function v(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function m(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function O(e,t){var r=e[0],a=e[1],_=e[2],n=r*r+a*a+_*_;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n),t}function N(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function g(e,t,r){var a=e[0],_=e[1],n=e[2],o=t[0],i=t[1],s=t[2];return r[0]=_*s-n*i,r[1]=n*o-a*s,r[2]=a*i-_*o,r}function h(e,t,r,a){var _=e[0],n=e[1],o=e[2];return a[0]=_+r*(t[0]-_),a[1]=n+r*(t[1]-n),a[2]=o+r*(t[2]-o),a}function R(e,t,r,a,_,n){var o=_*_,i=o*(2*_-3)+1,s=o*(_-2)+_,c=o*(_-1),E=o*(3-2*_);return n[0]=e[0]*i+t[0]*s+r[0]*c+a[0]*E,n[1]=e[1]*i+t[1]*s+r[1]*c+a[1]*E,n[2]=e[2]*i+t[2]*s+r[2]*c+a[2]*E,n}function I(e,t,r,a,_,n){var o=1-_,i=o*o,s=_*_,c=i*o,E=3*_*i,l=3*s*o,T=s*_;return n[0]=e[0]*c+t[0]*E+r[0]*l+a[0]*T,n[1]=e[1]*c+t[1]*E+r[1]*l+a[1]*T,n[2]=e[2]*c+t[2]*E+r[2]*l+a[2]*T,n}function b(e,t){var r=2*F()*Math.PI,a=2*F()-1,_=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(r)*_,t[1]=Math.sin(r)*_,t[2]=a*e,t}function Y(e,t,r){var a=e[0],_=e[1],n=e[2],o=t[3]*a+t[7]*_+t[11]*n+t[15];return o=o||1,r[0]=(t[0]*a+t[4]*_+t[8]*n+t[12])/o,r[1]=(t[1]*a+t[5]*_+t[9]*n+t[13])/o,r[2]=(t[2]*a+t[6]*_+t[10]*n+t[14])/o,r}function L(e,t,r){var a=e[0],_=e[1],n=e[2];return r[0]=a*t[0]+_*t[3]+n*t[6],r[1]=a*t[1]+_*t[4]+n*t[7],r[2]=a*t[2]+_*t[5]+n*t[8],r}function M(e,t,r){var a=e[0],_=e[1],n=e[2],o=t[0],i=t[1],s=t[2],c=t[3],E=c*a+i*n-s*_,l=c*_+s*a-o*n,T=c*n+o*_-i*a,u=-o*a-i*_-s*n;return r[0]=E*c+u*-o+l*-s-T*-i,r[1]=l*c+u*-i+T*-o-E*-s,r[2]=T*c+u*-s+E*-i-l*-o,r}function y(e,t,r,a){var _=[],n=[];return _[0]=e[0]-t[0],_[1]=e[1]-t[1],_[2]=e[2]-t[2],n[0]=_[0],n[1]=_[1]*Math.cos(r)-_[2]*Math.sin(r),n[2]=_[1]*Math.sin(r)+_[2]*Math.cos(r),a[0]=n[0]+t[0],a[1]=n[1]+t[1],a[2]=n[2]+t[2],a}function x(e,t,r,a){var _=[],n=[];return _[0]=e[0]-t[0],_[1]=e[1]-t[1],_[2]=e[2]-t[2],n[0]=_[2]*Math.sin(r)+_[0]*Math.cos(r),n[1]=_[1],n[2]=_[2]*Math.cos(r)-_[0]*Math.sin(r),a[0]=n[0]+t[0],a[1]=n[1]+t[1],a[2]=n[2]+t[2],a}function U(e,t,r,a){var _=[],n=[];return _[0]=e[0]-t[0],_[1]=e[1]-t[1],_[2]=e[2]-t[2],n[0]=_[0]*Math.cos(r)-_[1]*Math.sin(r),n[1]=_[0]*Math.sin(r)+_[1]*Math.cos(r),n[2]=_[2],a[0]=n[0]+t[0],a[1]=n[1]+t[1],a[2]=n[2]+t[2],a}function w(e,t){var r=n(e[0],e[1],e[2]),a=n(t[0],t[1],t[2]);O(r,r),O(a,a);var _=N(r,a);return _>1?0:Math.acos(_)}function C(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.clone=_,t.fromValues=n,t.copy=o,t.set=i,t.add=s,t.subtract=c,r.d(t,"sub",function(){return c}),t.multiply=E,r.d(t,"mul",function(){return E}),t.divide=l,r.d(t,"div",function(){return l}),t.min=T,t.max=u,t.scale=d,t.scaleAndAdd=f,t.distance=P,r.d(t,"dist",function(){return P}),t.squaredDistance=A,r.d(t,"sqrDist",function(){return A}),t.length=S,r.d(t,"len",function(){return S}),t.squaredLength=p,r.d(t,"sqrLen",function(){return p}),t.negate=v,t.inverse=m,t.normalize=O,t.dot=N,t.cross=g,t.lerp=h,t.hermite=R,t.bezier=I,t.random=b,t.transformMat4=Y,t.transformMat3=L,t.transformQuat=M,t.rotateX=y,t.rotateY=x,t.rotateZ=U,r.d(t,"forEach",function(){return G}),t.angle=w,t.str=C;var D="undefined"!==typeof Float32Array?Float32Array:Array,F=Math.random,G=function(){var e=a();return function(t,r,a,_,n,o){var i,s;for(r||(r=3),a||(a=0),s=_?Math.min(_*r+a,t.length):t.length,i=a;i<s;i+=r)e[0]=t[i],e[1]=t[i+1],e[2]=t[i+2],n(e,o,e),t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2];return t}}()},function(e,t,r){"use strict";function a(e,t){function r(e,r){switch(e){case"allow_cors":t.defaults.allow_cors=r;break;case"allow_hidpi":t.defaults.allow_hidpi=r;break;case"alpha":t.context.alpha=r;break;case"alpha_sort":t.defaults.alpha_sort=r;break;case"alpha_sort_threshold":t.defaults.alpha_sort_threshold=r;break;case"anaglyph_use":l.error_deprecated_cfg("anaglyph_use","stereo"),t.defaults.stereo=r?"ANAGLYPH":t.defaults.stereo;break;case"animation_framerate":t.animation.framerate=r;break;case"anisotropic_filtering":t.defaults.anisotropic_filtering=r;break;case"antialiasing":t.defaults.antialiasing=r;break;case"assets_dir":case"assets_path":t.assets.path=r;break;case"assets_dds_available":t.assets.dds_available=r;break;case"assets_pvr_available":t.assets.pvr_available=r;break;case"assets_min50_available":t.assets.min50_available=r;break;case"audio":t.sfx.webaudio=r;break;case"background_color":t.defaults.background_color=r;break;case"bloom":t.defaults.bloom=r;break;case"built_in_module_name":t.paths.built_in_data_module=r;break;case"canvas_resolution_factor":t.defaults.canvas_resolution_factor=r;break;case"console_verbose":t.defaults.console_verbose=r;break;case"compositing":t.defaults.compositing=r;break;case"dof":t.defaults.dof=r;break;case"do_not_load_resources":t.defaults.do_not_load_resources=r;break;case"god_rays":t.defaults.god_rays=r;break;case"stereo":t.defaults.stereo=r;break;case"lod_leap_smooth_threshold":t.defaults.lod_leap_smooth_threshold=r;break;case"lod_smooth_transitions":t.defaults.lod_smooth_transitions=r;break;case"max_fps":t.defaults.max_fps=r;break;case"max_fps_physics":t.physics.max_fps=r;break;case"media_auto_activation":t.defaults.media_auto_activation=r;break;case"motion_blur":t.defaults.motion_blur=r;break;case"physics_enabled":t.physics.enabled=r;break;case"physics_uranium_path":_()?(t.physics.uranium_path=r+t.physics.wasmjs_file,t.physics.uranium_bin=r+t.physics.wasm_file):(t.physics.uranium_path=r+t.physics.asmjs_file,t.physics.uranium_bin=r+t.physics.mem_file),t.physics.uranium_dir=r;break;case"physics_use_wasm":t.physics.use_wasm=r;break;case"physics_calc_fps":t.physics.calc_fps=r;break;case"physics_use_workers":t.physics.use_workers=r;break;case"precision":t.defaults.precision=r;break;case"prevent_caching":t.assets.prevent_caching=r;break;case"quality":t.defaults.quality=r;break;case"reflections":t.defaults.reflections=r;break;case"refractions":t.defaults.refractions=r;break;case"sfx_mix_mode":t.sfx.mix_mode=r;break;case"shaders_dir":case"shaders_path":t.paths.shaders_path=r;break;case"shadows":t.defaults.shadows=r;break;case"show_hud_debug_info":t.defaults.show_hud_debug_info=r;break;case"smaa":l.error_deprecated_cfg("smaa"),t.defaults.smaa=r;break;case"smaa_search_texture_path":l.error_deprecated_cfg("smaa_search_texture_path"),t.paths.smaa_search_texture_path=r;break;case"smaa_area_texture_path":l.error_deprecated_cfg("smaa_area_texture_path"),t.paths.smaa_area_texture_path=r;break;case"ssao":t.defaults.ssao=r;break;case"debug_view":t.defaults.debug_view=r;break;case"enable_selectable":t.defaults.enable_selectable=r;break;case"enable_outlining":t.defaults.enable_outlining=r;break;case"outlining_overview_mode":t.outlining.outlining_overview_mode=r;break;case"glow_materials":t.defaults.glow_materials=r;break;case"url_params":t.defaults.url_params=r;break;case"use_min50":t.defaults.use_min50=r;break;case"enable_texture_cache":t.defaults.enable_texture_cache=r;break;case"gl_debug":t.defaults.gl_debug=r;break;case"srgb_type":t.defaults.srgb_type=r;break;case"shadow_blur_samples":t.defaults.shadow_blur_samples=r;break;case"reflection_quality":t.defaults.reflection_quality=r;break;case"assets_gzip_available":t.defaults.assets_gzip_available=r;break;case"debug_loading":t.defaults.debug_loading=r;break;case"msaa_samples":t.defaults.msaa_samples=r;break;default:l.error("Unknown config property: "+e)}}function a(){return n.a.module_check(t.paths.built_in_data_module)}function _(){return t.physics.use_wasm&&window.WebAssembly}function c(){for(var e=t.paths,r=null,a=!1,_=document.getElementsByTagName("script"),n=0;n<_.length;n++){for(var o=_[n].src,i=0;i<e.js_src_search_paths.length;i++){var s=e.js_src_search_paths[i];if(o.indexOf(s)>=0&&(r=o,_[n].attributes["b4w-offset"])){r=r.substring(0,r.lastIndexOf("/"))+"/"+_[n].attributes["b4w-offset"].value,a=!0;break}}if(a)break}r||(l.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),r=document.location.href);var c=r.indexOf("?");return c>=0&&(r=r.substring(0,c)),r.substring(0,r.lastIndexOf("/"))}var E=Object(o.a)(e),l=Object(i.a)(e);t.P_LOW=1,t.P_HIGH=2,t.P_ULTRA=3,t.P_CUSTOM=4,t.P_AUTO=5,t.context={alpha:!0,antialias:!1,premultipliedAlpha:!0},t.context_save=s.O(t.context),t.defaults={alpha_sort:!0,alpha_sort_threshold:.1,min_format_version:[6,3],max_fps:1e4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,enable_texture_cache:!0,fps_measurement_interval:1,fps_callback_interval:5,background_color:[0,0,0,0],canvas_resolution_factor:1,texture_min_filter:3,allow_cors:!1,force_low_quality_nodes:!1,anisotropic_available:!0,anisotropic_filtering:!0,texture_lod_available:!1,tex_float_available:!1,tex_hfloat_available:!1,tex_float_lin_available:!1,tex_hfloat_lin_available:!1,cbuffer_float_available:!1,cbuffer_hfloat_available:!1,show_hud_debug_info:!1,depth_tex_available:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,water_wireframe_debug:!1,foam:!0,parallax:!0,dynamic_grass:!0,water_dynamic:!0,shore_smoothing:!0,shore_distance:!0,use_compression:!0,precision:"highp",quality:t.P_HIGH,allow_vertex_textures:!0,lod_leap_smooth_threshold:3,assets_gzip_available:!1,no_phy_interp_hack:!1,shader_constants_hack:!1,disable_blend_shadows_hack:!1,vert_anim_mix_normals_hack:!1,is_mobile_device:!1,init_wa_context_hack:!1,clear_procedural_sky_hack:!1,sky_update_hack:!1,seq_video_fallback:!1,allow_hidpi:!1,shadows_color_slink_hack:!1,mobile_firefox_media_hack:!1,ipad_video_hack:!1,enable_selectable:!0,enable_outlining:!0,lod_smooth_transitions:!0,glow_materials:!0,ie11_edge_touchscreen_hack:!1,firefox_tex_reuse_hack:!1,loaded_data_version:[0,0],quality_aa_method:!0,skinning_hack:!1,url_params:null,webgl2:!0,msaa_samples:4,compared_mode_depth:!1,safari_canvas_alpha_hack:!1,safari_glow_hack:!1,resize_cubemap_canvas_hack:!1,resize_texture_canvas_hack:!1,chrome_html_bkg_music_hack:!1,ie_edge_anchors_floor_hack:!1,ie11_edge_mouseoffset_hack:!1,media_auto_activation:!0,max_cast_lamps:4,mac_os_shadow_hack:!1,gl_debug:!1,check_framebuffer_hack:!1,allow_instanced_arrays_ext:!1,allow_vao_ext:!1,compress_format:"dds",shadow_blur_samples:"",reflection_quality:"",srgb_type:"SRGB_SIMPLE",ios_copy_tex_hack:!1,rgba_fallback_shadows:!1,debug_loading:!1,mali_alpha_antialias_hack:!1,mali4_lamps_hack:!1,chrome_csm_blend_hack:!1,reuse_depth_optimization:!0},t.defaults_save=s.O(t.defaults),t.animation={framerate:-1,frames_blending_hack:!1,frame_steps:1},t.controls={mouse_wheel_notch_multiplier:1/120},t.assets={path:"",path_default:"B4W_ASSETS_PATH=__JS__/assets/",proj_path_default:"B4W_PROJ_ASSETS_PATH=__JS__/../projects/__NAME__/assets/",max_requests:15,prevent_caching:!0,min50_available:!1,dds_available:!1,pvr_available:!1},t.assets_save=s.O(t.assets),t.paths={shaders_path:"",shaders_path_default:"../shaders/",shaders_include_dir:"include/",shaders_postp_dir:"postprocessing/",built_in_data_module:"built_in_data",js_src_search_paths:["b4w.js","b4w.min.js","b4w.simple.min.js","b4w.whitespace.min.js","b4w_app_bundle.js","B4W_MAIN_MODULE"],smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"},t.hmd_params={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{distor_scale:.8,inter_lens_dist:.064,base_line_dist:.035,screen_to_lens_dist:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],width_dist:.11,height_dist:.062,bevel_size:.004}},t.physics={enabled:!0,max_fps:60,uranium_path:"",uranium_bin:"",uranium_path_default:"B4W_URANIUM_PATH=/dist/uranium/",asmjs_file:"uranium.js",wasmjs_file:"uranium_wasm.js",mem_file:"uranium.js.mem",wasm_file:"uranium_wasm.wasm",uranium_dir:"/dist/uranium",calc_fps:!1,ping:!1,use_workers:!0,use_wasm:!0},t.physics_save=s.O(t.physics),t.scenes={grass_tex_size:1024,cubemap_tex_size:256,cube_reflect_low:32,cube_reflect_medium:128,cube_reflect_high:256,plane_reflect_low:.25,plane_reflect_medium:.5,plane_reflect_high:1},t.scenes_save=s.O(t.scenes),t.sfx={webaudio:!0,mix_mode:!1,audio_loading_hack:!1,clamp_playback_rate_hack:!1,disable_playback_rate_hack:!1},t.sfx_save=s.O(t.sfx),t.outlining={outlining_overview_mode:!1,outline_color:[1,.4,.05],outline_duration:.2,outline_period:3.8,outline_relapses:1},t.debug_subs={enabled:!1,subs_type:3,subs_number:1,slink_type:"COLOR"},t.debug_subs_save=s.O(t.debug_subs),t.context_limits={max_combined_texture_image_units:8,max_fragment_uniform_vectors:64,max_texture_image_units:8,max_varying_vectors:8,max_vertex_attribs:15,max_vertex_texture_image_units:0,max_vertex_uniform_vectors:128,max_cube_map_texture_size:1024,max_renderbuffer_size:4096,max_texture_size:4096,max_viewport_dims:[4096,4096],depth_bits:24},t.context_limits_save=s.O(t.context_limits),t.apply_quality=function(){var e=t.defaults,r=t.physics,a=t.scenes;switch(e.quality){case t.P_ULTRA:e.shadows=!0,e.shore_smoothing=!0,e.ssao=!0,e.dof=!0,e.god_rays=!0,e.bloom=!0,e.reflections=!0,e.refractions=!0,e.foam=!0,e.parallax=!0,e.dynamic_grass=!0,a.grass_tex_size=2048,a.cubemap_tex_size=512,e.texture_min_filter=3,e.anisotropic_filtering=!0,e.use_min50=!1,e.water_dynamic=!0,e.shore_distance=!0,e.antialiasing=!0,e.smaa=!1,e.compositing=!0,e.motion_blur=!0,e.allow_hidpi=!0,e.enable_outlining=!0,e.glow_materials=!0,e.msaa_samples=16,e.srgb_type="SRGB_PROPER",r.max_fps=120,e.lod_smooth_transitions=!0;break;case t.P_HIGH:e.shadows=!0,e.shore_smoothing=!0,e.ssao=!0,e.dof=!0,e.god_rays=!0,e.bloom=!0,e.reflections=!0,e.refractions=!0,e.foam=!0,e.parallax=!0,e.dynamic_grass=!0,a.grass_tex_size=1024,a.cubemap_tex_size=256,e.texture_min_filter=3,e.anisotropic_filtering=!0,e.use_min50=!1,e.water_dynamic=!0,e.shore_distance=!0,e.antialiasing=!0,e.smaa=!1,e.compositing=!0,e.motion_blur=!0,e.allow_hidpi=!1,e.enable_outlining=!0,e.glow_materials=!0,e.srgb_type="SRGB_SIMPLE",e.msaa_samples=4,r.max_fps=60,e.lod_smooth_transitions=!0;break;case t.P_LOW:e.shadows=!1,e.shore_smoothing=!1,e.ssao=!1,e.dof=!1,e.god_rays=!1,e.bloom=!1,e.reflections=!1,e.refractions=!1,e.foam=!1,e.parallax=!1,e.dynamic_grass=!1,a.grass_tex_size=512,a.cubemap_tex_size=256,e.texture_min_filter=2,e.anisotropic_filtering=!1,e.use_min50=!0,e.water_dynamic=!1,e.shore_distance=!1,e.antialiasing=!1,e.smaa=!1,e.compositing=!1,e.motion_blur=!1,e.allow_hidpi=!1,e.enable_outlining=!1,e.glow_materials=!1,e.srgb_type="SRGB_SIMPLE",e.msaa_samples=1,r.max_fps=60,e.lod_smooth_transitions=!1;break;case t.P_CUSTOM:break;case t.P_AUTO:E.panic("Direct AUTO quality profile setting is forbidden")}},t.set=r,t.get=function(e){switch(e){case"allow_cors":return t.defaults.allow_cors;case"allow_hidpi":return t.defaults.allow_hidpi;case"alpha":return t.context.alpha;case"alpha_sort":return t.defaults.alpha_sort;case"alpha_sort_threshold":return t.defaults.alpha_sort_threshold;case"anaglyph_use":return"ANAGLYPH"==t.defaults.stereo;case"animation_framerate":return t.animation.framerate;case"anisotropic_filtering":return t.defaults.anisotropic_filtering;case"antialiasing":return t.defaults.antialiasing;case"assets_dir":case"assets_path":return t.assets.path;case"assets_dds_available":return t.assets.dds_available;case"assets_pvr_available":return t.assets.pvr_available;case"assets_min50_available":return t.assets.min50_available;case"audio":return t.sfx.webaudio;case"background_color":return t.defaults.background_color;case"bloom":return t.defaults.bloom;case"built_in_module_name":return t.paths.built_in_data_module;case"canvas_resolution_factor":return t.defaults.canvas_resolution_factor;case"console_verbose":return t.defaults.console_verbose;case"compositing":return t.defaults.compositing;case"dof":return t.defaults.dof;case"do_not_load_resources":return t.defaults.do_not_load_resources;case"is_mobile_device":return t.defaults.is_mobile_device;case"god_rays":return t.defaults.god_rays;case"stereo":return t.defaults.stereo;case"lod_leap_smooth_threshold":return t.defaults.lod_leap_smooth_threshold;case"lod_smooth_transitions":return t.defaults.lod_smooth_transitions;case"max_fps":return t.defaults.max_fps;case"max_fps_physics":return t.physics.max_fps;case"media_auto_activation":return t.defaults.media_auto_activation;case"motion_blur":return t.defaults.motion_blur;case"physics_enabled":return t.physics.enabled;case"physics_uranium_path":return t.physics.uranium_dir;case"physics_uranium_bin":return t.physics.uranium_bin;case"physics_use_wasm":return t.physics.use_wasm;case"physics_calc_fps":return t.physics.calc_fps;case"physics_use_workers":return t.physics.use_workers;case"precision":return t.defaults.precision;case"prevent_caching":return t.assets.prevent_caching;case"quality":return t.defaults.quality;case"reflections":return t.defaults.reflections;case"refractions":return t.defaults.refractions;case"sfx_mix_mode":return t.sfx.mix_mode;case"shaders_dir":case"shaders_path":return t.paths.shaders_path;case"shadows":return t.defaults.shadows;case"show_hud_debug_info":return t.defaults.show_hud_debug_info;case"smaa":return t.defaults.smaa;case"smaa_search_texture_path":return t.paths.smaa_search_texture_path;case"smaa_area_texture_path":return t.paths.smaa_area_texture_path;case"ssao":return t.defaults.ssao;case"debug_view":return t.defaults.debug_view;case"enable_selectable":return t.defaults.enable_selectable;case"enable_outlining":return t.defaults.enable_outlining;case"outlining_overview_mode":return t.outlining.outlining_overview_mode;case"glow_materials":return t.defaults.glow_materials;case"url_params":return t.defaults.url_params;case"use_min50":return t.defaults.use_min50;case"enable_texture_cache":return t.defaults.enable_texture_cache;case"gl_debug":return t.defaults.gl_debug;case"srgb_type":return t.defaults.srgb_type;case"shadow_blur_samples":return t.defaults.shadow_blur_samples;case"reflection_quality":return t.defaults.reflection_quality;case"assets_gzip_available":return t.defaults.assets_gzip_available;case"debug_loading":return t.defaults.debug_loading;case"msaa_samples":return t.defaults.msaa_samples;default:l.error("Unknown config property: "+e)}},t.reset=function(){for(var e in t.context_save)t.context[e]=t.context_save[e];for(var e in t.defaults_save)t.defaults[e]=t.defaults_save[e];for(var e in t.assets_save)t.assets[e]=t.assets_save[e];for(var e in t.physics_save)t.physics[e]=t.physics_save[e];for(var e in t.scenes_save)t.scenes[e]=t.scenes_save[e];for(var e in t.sfx_save)t.sfx[e]=t.sfx_save[e];for(var e in t.debug_subs_save)t.debug_subs[e]=t.debug_subs_save[e]},t.reset_limits=function(){var e=t.context_limits.depth_bits;for(var r in t.context_limits_save)t.context_limits[r]=t.context_limits_save[r];t.context_limits.depth_bits=e},t.is_built_in_data=a,t.set_paths=function(){var e=t.paths,r=t.physics;if(a()||""!=e.shaders_path||(e.shaders_path=c()+"/"+e.shaders_path_default),_())var n=r.uranium_path_default+r.wasmjs_file,o=r.uranium_path_default+r.wasm_file;else var n=r.uranium_path_default+r.asmjs_file,o=r.uranium_path_default+r.mem_file;r.enabled&&""==r.uranium_path&&(r.uranium_path=n.replace("B4W_URANIUM_PATH=",""),r.uranium_bin=o.replace("B4W_URANIUM_PATH=",""))},t.get_assets_path=function(e){var r=t.assets;if(r.path)return r.path;var a=r.path_default,_="B4W_ASSETS_PATH=";return e&&(a=r.proj_path_default,_="B4W_PROJ_ASSETS_PATH=",a=a.replace("__NAME__",e)),a=a.replace(_,""),a=a.replace("__JS__",c())}}var _=r(0),n=r(35),o=r(5),i=r(1),s=r(2),c=Object(_.a)("__config",a);t.a=c},function(e,t,r){"use strict";function a(e,t){function r(e){throw e&&s.error.apply(s,arguments),"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/"}function a(e,t){if(_(e)||r("Structure assertion failed: invalid first object value"),_(t)||r("Structure assertion failed: invalid second object value"),i(e,t)||r("Structure assertion failed: incompatible types"),!(null==e||null==t||"object"!=typeof e||n._14(e)||e instanceof Array)){for(var a in e)_(e[a])||r("Structure assertion failed: invalid value for key in the first object: "+a),a in t||r("Structure assertion failed: missing key in the first object: "+a);for(var a in t)_(t[a])||r("Structure assertion failed: invalid value for key in the second object: "+a),a in e||r("Structure assertion failed: missing key in the second object: "+a),i(e[a],t[a])||r("Structure assertion failed: incompatible types for key "+a)}}function _(e){return"undefined"!=typeof e&&("number"!=typeof e||!isNaN(e))}function i(e,t){if(typeof e!=typeof t)return!1;if(null!=e&&null!=t&&"object"==typeof e){var r=e instanceof Array,a=t instanceof Array;if(r&&!a||!r&&a)return!1;var _=n._14(e),o=n._14(t);if(_&&!o||!_&&o)return!1}return!0}var s=Object(o.a)(e),c=null,E=!1;t.panic=r,t.assert=function(e){e||r("Assertion failed")},t.is_constructor=function(e,t){e.constructor!=t&&r("Type assertion failed: value <"+e+"> has type <"+e.constructor+">, required <"+t+">")},t.equal=a,t.equal_seq=function(e){E?a(e,c):E=!0,c=null!=e&&"object"==typeof e?n.N(e):e}}var _=r(0),n=r(2),o=r(1),i=Object(_.a)("assert",a);t.a=i},function(e,t,r){"use strict";function a(){var e=new Float32Array(9);return e[3]=1,e[4]=1,e[5]=1,e}function _(e,t,r,_,n,o,i,s){var c=a();c[0]=e,c[1]=t,c[2]=r,c[3]=_,c[4]=_,c[5]=_;var E=s<0?-1:1;return c[6]=E*n,c[7]=E*o,c[8]=E*i,c}function n(){var e=new Float32Array(9);return e[3]=1,e[4]=1,e[5]=1,e}function o(e,t){if(e[8]!=e[8])throw new Error(e);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function i(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=1,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e}function s(e,t,r,a){a[0]=e[0],a[1]=e[1],a[2]=e[2],g._15(t)?(a[3]=t[0],a[4]=t[1],a[5]=t[2]):(a[3]=t,a[4]=t,a[5]=t);var _=r[3]<0?-1:1;return a[6]=_*r[0],a[7]=_*r[1],a[8]=_*r[2],a}function c(e,t){if(e[0]!=e[0])throw new Error(e);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function E(e,t){return g._15(e)?(t[3]=e[0],t[4]=e[1],t[5]=e[2]):(t[3]=e,t[4]=e,t[5]=e),t}function l(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function T(e,t){if(e[0]!=e[0])throw new Error(e);var r=e[3]<0?-1:1;return t[6]=r*e[0],t[7]=r*e[1],t[8]=r*e[2],t}function u(e){return d(e,N.create())}function d(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function f(e,t){return t?(t[0]=e[3],t[1]=e[4],t[2]=e[5],t):e[3]}function P(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function A(e){return S(e,N.create())}function S(e,t){return t[0]=e[6],t[1]=e[7],t[2]=e[8],t[3]=Math.sqrt(Math.abs(1-e[6]*e[6]-e[7]*e[7]-e[8]*e[8])),t}function p(e,t,r){return S(t,r),N.multiply(r,e,r)}function v(e,t,r){return r[0]=e[9*t],r[1]=e[9*t+1],r[2]=e[9*t+2],r[3]=e[9*t+3],r[4]=e[9*t+4],r[5]=e[9*t+5],r[6]=e[9*t+6],r[7]=e[9*t+7],r[8]=e[9*t+8],r}function m(e,t,r){return t[9*r]=e[0],t[9*r+1]=e[1],t[9*r+2]=e[2],t[9*r+3]=e[3],t[9*r+4]=e[4],t[9*r+5]=e[5],t[9*r+6]=e[6],t[9*r+7]=e[7],t[9*r+8]=e[8],t}t.b=a,t.e=_,t.c=n,t.a=o,t.m=i,t.t=s,t.v=c,t.s=E,t.w=l,t.r=T,t.k=u,t.j=d,t.i=f,t.l=P,t.h=A,t.g=S,r.d(t,"p",function(){return b}),r.d(t,"x",function(){return Y}),r.d(t,"d",function(){return L}),r.d(t,"q",function(){return M}),r.d(t,"D",function(){return y}),r.d(t,"E",function(){return x}),r.d(t,"F",function(){return U}),r.d(t,"z",function(){return w}),r.d(t,"y",function(){return C}),r.d(t,"C",function(){return D}),t.A=p,r.d(t,"B",function(){return F}),r.d(t,"G",function(){return G}),r.d(t,"o",function(){return k}),r.d(t,"n",function(){return K}),t.f=v,t.u=m;var O=r(21),N=r(8),g=r(2),h=r(3),R=Math.sin(-Math.PI/4),I=-R,b=(new Float32Array(3),new Float32Array(4),new Float32Array(16),function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_){var n=f(a,e);if(h.inverse(n,n),!n[0])return null;var o=d(a,t),i=S(a,r);return N.invert(i,i),h.multiply(o,n,o),h.transformQuat(o,i,o),h.negate(o,o),c(o,_),E(n,_),T(i,_),_}}()),Y=function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_){var n=d(a,e),o=f(a,t),i=S(a,r);return O.fromRotationTranslation(i,n,_),O.scale(_,o,_),_}}(),L=function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_){var n=g._26(a,e),o=g._25(a,t),i=g._24(a,r);return c(n,_),E(o,_),T(i,_),_}}(),M=function(){var e=h.create(),t=h.create(),r=N.create(),a=N.create();return function(_,n,o){var i=d(n,e);y(i,_,i),c(i,o);var s=f(_,e),l=f(n,t);E(h.multiply(s,l,e),o);var u=S(_,r),P=S(n,a);return T(N.multiply(u,P,r),o),o}}(),y=(function(){var e=O.create()}(),function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_,n){var o=d(_,e),i=f(_,t),s=S(_,r);return h.multiply(a,i,n),h.transformQuat(n,s,n),h.add(n,o,n),n}}()),x=function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_,n){var o=d(_,e),i=f(_,t),s=S(_,r);return h.subtract(a,o,n),N.invert(s,s),h.transformQuat(n,s,n),h.inverse(i,i),h.multiply(n,i,n),n}}(),U=function(){var e=h.create(),t=h.create(),r=h.create(),a=N.create();return function(_,n,o,i){i|=0;for(var s=_.length,c=d(n,e),E=f(n,t),l=S(n,a),T=r,u=0;u<s;u+=3)T[0]=_[u],T[1]=_[u+1],T[2]=_[u+2],h.multiply(T,E,T),h.transformQuat(T,l,T),h.add(T,c,T),o[i+u]=T[0],o[i+u+1]=T[1],o[i+u+2]=T[2];return o}}(),w=function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_,n,o){o|=0;for(var i=a.length,s=f(_,e),c=S(_,r),E=t,l=0;l<i;l+=3)E[0]=a[l],E[1]=a[l+1],E[2]=a[l+2],h.multiply(E,s,E),h.transformQuat(E,c,E),n[o+l]=E[0],n[o+l+1]=E[1],n[o+l+2]=E[2];return n}}(),C=function(){var e=h.create(),t=N.create();return function(r,a,_){var n=f(a,e),o=S(a,t);return h.multiply(r,n,_),h.transformQuat(_,o,_),_}}(),D=function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_,n,o){o|=0;for(var i=a.length,s=f(_,e),c=S(_,r),E=t,l=0;l<i;l+=4)E=a[l],E=a[l+1],E=a[l+2],h.scale(E,s,E),h.transformQuat(E,c,E),n[o+l]=E[0],n[o+l+1]=E[1],n[o+l+2]=E[2],n[o+l+3]=a[l+3];return n}}(),F=function(){var e=N.create();return function(t,r,a,_){_|=0;var n=S(r,e);return g._38(t,n,a,_),a}}(),G=function(){var e=h.create(),t=h.create(),r=N.create();return function(a,_,n){var i=d(a,e),s=f(a,t),E=S(a,r),l=h.multiply(_,s,t);return h.transformQuat(l,E,l),h.add(i,l,i),o(a,n),c(i,n),n}}(),k=function(){var e=h.create(),t=h.create(),r=N.create(),a=N.create();return function(_,n,o,i){var s=d(_,e),l=d(n,t);c(h.lerp(s,l,o,e),i);f(_,e),f(n,t);E(h.lerp(s,l,o,e),i);var u=S(_,r),P=S(n,a);return T(N.slerp(u,P,o,r),i),i}}(),K=(function(){var e=h.create(),t=h.create(),r=N.create(),a=N.create()}(),function(){var e=h.create(),t=(h.create(),N.create()),r=N.create();return function(a,_,n,o,i){var s=d(a,e);s[0]=s[0]+_*n[0],s[1]=s[1]+_*n[1],s[2]=s[2]+_*n[2],c(s,i),E(f(a,e),i);var l=S(a,t),u=o[0],P=o[1],A=o[2],p=r;return p[0]=.5*(u*l[3]+P*l[2]-A*l[1]),p[1]=.5*(P*l[3]+A*l[0]-u*l[2]),p[2]=.5*(A*l[3]+u*l[1]-P*l[0]),p[3]=.5*(-u*l[0]-P*l[1]-A*l[2]),l[0]=l[0]+p[0]*_,l[1]=l[1]+p[1]*_,l[2]=l[2]+p[2]*_,l[3]=l[3]+p[3]*_,N.normalize(l,l),T(l,i),i}}());(function(){var e=h.create(),t=h.create(),r=N.create(),a=N.create()})(),function(){var e=h.create(),t=N.create()}()},function(e,t,r){"use strict";function a(){var e=new Y(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function _(e){var t=new Y(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function n(e,t,r,a){var _=new Y(4);return _[0]=e,_[1]=t,_[2]=r,_[3]=a,_}function o(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function i(e,t,r,a,_){return _[0]=e,_[1]=t,_[2]=r,_[3]=a,_}function s(e,t,r){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function c(e,t,r){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function E(e,t,r){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r[3]=e[3]*t[3],r}function l(e,t,r){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r[3]=e[3]/t[3],r}function T(e,t,r){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.min(e[3],t[3]),r}function u(e,t,r){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r}function d(e,t,r){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function f(e,t,r,a){return a[0]=e[0]+t[0]*r,a[1]=e[1]+t[1]*r,a[2]=e[2]+t[2]*r,a[3]=e[3]+t[3]*r,a}function P(e,t){var r=t[0]-e[0],a=t[1]-e[1],_=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(r*r+a*a+_*_+n*n)}function A(e,t){var r=t[0]-e[0],a=t[1]-e[1],_=t[2]-e[2],n=t[3]-e[3];return r*r+a*a+_*_+n*n}function S(e){var t=e[0],r=e[1],a=e[2],_=e[3];return Math.sqrt(t*t+r*r+a*a+_*_)}function p(e){var t=e[0],r=e[1],a=e[2],_=e[3];return t*t+r*r+a*a+_*_}function v(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function m(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function O(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=r*r+a*a+_*_+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=a*o,t[2]=_*o,t[3]=n*o),t}function N(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function g(e,t,r,a){var _=e[0],n=e[1],o=e[2],i=e[3];return a[0]=_+r*(t[0]-_),a[1]=n+r*(t[1]-n),a[2]=o+r*(t[2]-o),a[3]=i+r*(t[3]-i),a}function h(e,t){return t[0]=L(),t[1]=L(),t[2]=L(),t[3]=L(),O(t,t),e(t,e,t),t}function R(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3];return r[0]=t[0]*a+t[4]*_+t[8]*n+t[12]*o,r[1]=t[1]*a+t[5]*_+t[9]*n+t[13]*o,r[2]=t[2]*a+t[6]*_+t[10]*n+t[14]*o,r[3]=t[3]*a+t[7]*_+t[11]*n+t[15]*o,r}function I(e,t,r){var a=e[0],_=e[1],n=e[2],o=t[0],i=t[1],s=t[2],c=t[3],E=c*a+i*n-s*_,l=c*_+s*a-o*n,T=c*n+o*_-i*a,u=-o*a-i*_-s*n;return r[0]=E*c+u*-o+l*-s-T*-i,r[1]=l*c+u*-i+T*-o-E*-s,r[2]=T*c+u*-s+E*-i-l*-o,r[3]=e[3],r}function b(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.clone=_,t.fromValues=n,t.copy=o,t.set=i,t.add=s,t.subtract=c,r.d(t,"sub",function(){return c}),t.multiply=E,r.d(t,"mul",function(){return E}),t.divide=l,r.d(t,"div",function(){return l}),t.min=T,t.max=u,t.scale=d,t.scaleAndAdd=f,t.distance=P,r.d(t,"dist",function(){return P}),t.squaredDistance=A,r.d(t,"sqrDist",function(){return A}),t.length=S,r.d(t,"len",function(){return S}),t.squaredLength=p,r.d(t,"sqrLen",function(){return p}),t.negate=v,t.inverse=m,t.normalize=O,t.dot=N,t.lerp=g,t.random=h,t.transformMat4=R,t.transformQuat=I,r.d(t,"forEach",function(){return M}),t.str=b;var Y="undefined"!==typeof Float32Array?Float32Array:Array,L=Math.random,M=function(){var e=a();return function(t,r,a,_,n,o){var i,s;for(r||(r=4),a||(a=0),s=_?Math.min(_*r+a,t.length):t.length,i=a;i<s;i+=r)e[0]=t[i],e[1]=t[i+1],e[2]=t[i+2],e[3]=t[i+3],n(e,o,e),t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3];return t}}()},function(e,t,r){"use strict";function a(){var e=new p(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function _(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function n(e,t,r){t*=.5;var a=Math.sin(t);return r[0]=a*e[0],r[1]=a*e[1],r[2]=a*e[2],r[3]=Math.cos(t),r}function o(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3],i=t[0],s=t[1],c=t[2],E=t[3];return r[0]=a*E+o*i+_*c-n*s,r[1]=_*E+o*s+n*i-a*c,r[2]=n*E+o*c+a*s-_*i,r[3]=o*E-a*i-_*s-n*c,r}function i(e,t,r){t*=.5;var a=e[0],_=e[1],n=e[2],o=e[3],i=Math.sin(t),s=Math.cos(t);return r[0]=a*s+o*i,r[1]=_*s+n*i,r[2]=n*s-_*i,r[3]=o*s-a*i,r}function s(e,t,r){t*=.5;var a=e[0],_=e[1],n=e[2],o=e[3],i=Math.sin(t),s=Math.cos(t);return r[0]=a*s-n*i,r[1]=_*s+o*i,r[2]=n*s+a*i,r[3]=o*s-_*i,r}function c(e,t,r){t*=.5;var a=e[0],_=e[1],n=e[2],o=e[3],i=Math.sin(t),s=Math.cos(t);return r[0]=a*s+_*i,r[1]=_*s-a*i,r[2]=n*s+o*i,r[3]=o*s-n*i,r}function E(e,t){var r=e[0],a=e[1],_=e[2];return t[0]=r,t[1]=a,t[2]=_,t[3]=Math.sqrt(Math.abs(1-r*r-a*a-_*_)),t}function l(e,t,r,a){var _,n,o,i,s,c=e[0],E=e[1],l=e[2],T=e[3],u=t[0],d=t[1],f=t[2],P=t[3];return n=c*u+E*d+l*f+T*P,n<0&&(n=-n,u=-u,d=-d,f=-f,P=-P),1-n>1e-6?(_=Math.acos(n),o=Math.sin(_),i=Math.sin((1-r)*_)/o,s=Math.sin(r*_)/o):(i=1-r,s=r),a[0]=i*c+s*u,a[1]=i*E+s*d,a[2]=i*l+s*f,a[3]=i*T+s*P,a}function T(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=r*r+a*a+_*_+n*n,i=o?1/o:0;return t[0]=-r*i,t[1]=-a*i,t[2]=-_*i,t[3]=n*i,t}function u(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function d(e,t){var r,a=e[0]+e[4]+e[8];if(a>0)r=Math.sqrt(a+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var _=0;e[4]>e[0]&&(_=1),e[8]>e[3*_+_]&&(_=2);var n=(_+1)%3,o=(_+2)%3;r=Math.sqrt(e[3*_+_]-e[3*n+n]-e[3*o+o]+1),t[_]=.5*r,r=.5/r,t[3]=(e[3*n+o]-e[3*o+n])*r,t[n]=(e[3*n+_]+e[3*_+n])*r,t[o]=(e[3*o+_]+e[3*_+o])*r}return t}function f(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,r.d(t,"rotationTo",function(){return v}),r.d(t,"setAxes",function(){return m}),t.identity=_,t.setAxisAngle=n,t.multiply=o,r.d(t,"mul",function(){return o}),t.rotateX=i,t.rotateY=s,t.rotateZ=c,t.calculateW=E,t.slerp=l,r.d(t,"sqlerp",function(){return O}),t.invert=T,t.conjugate=u,t.fromMat3=d,t.str=f;var P=r(3),A=r(7),S=r(28);r.d(t,"clone",function(){return A.clone}),r.d(t,"fromValues",function(){return A.fromValues}),r.d(t,"copy",function(){return A.copy}),r.d(t,"set",function(){return A.set}),r.d(t,"add",function(){return A.add}),r.d(t,"scale",function(){return A.scale}),r.d(t,"dot",function(){return A.dot}),r.d(t,"lerp",function(){return A.lerp}),r.d(t,"length",function(){return A.length}),r.d(t,"len",function(){return A.length}),r.d(t,"squaredLength",function(){return A.squaredLength}),r.d(t,"sqrLen",function(){return A.squaredLength}),r.d(t,"normalize",function(){return A.normalize});var p="undefined"!==typeof Float32Array?Float32Array:Array,v=(Math.random,function(){var e=P.create(),t=P.fromValues(1,0,0),r=P.fromValues(0,1,0);return function(a,_,o){var i=P.dot(a,_);return i<-.9999999?(P.cross(t,a,e),P.length(e)<1e-6&&P.cross(r,a,e),P.normalize(e,e),n(e,Math.PI,o),o):i>.9999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(P.cross(a,_,e),o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=1+i,A.normalize(o,o))}}()),m=function(){var e=S.create();return function(t,r,a,_){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-t[0],e[5]=-t[1],e[8]=-t[2],A.normalize(d(e,_),_)}}(),O=function(){var e=a(),t=a();return function(r,a,_,n,o,i){return l(r,n,o,e),l(a,_,o,t),l(e,t,2*o*(1-o),i),i}}()},function(e,t,r){"use strict";function a(e,t){function r(e){var t={type:e,data_id:0,world_tsr:i.c(),world_tsr_inv:i.c(),pivot:new Float32Array(3),hover_pivot:new Float32Array(3),init_dist:0,init_fov:0,is_copied:!1,is_copied_deep:!1,color_id:null,outline_intensity:0,target_cam_upside_down:!1,vertical_axis:c.create(),use_panning:!1,move_style:0,velocity_trans:1,velocity_rot:1,velocity_zoom:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,dof_foreground_blur:!1,dof_object:null,horizontal_limits:null,vertical_limits:null,distance_limits:null,hover_vert_trans_limits:null,hover_horiz_trans_limits:null,pivot_limits:null,enable_hover_hor_rotation:!0,outline_anim_settings_default:{outline_duration:1,outline_period:1,outline_relapses:0},cube_reflection_id:-1,plane_reflection_id:-1,reflection_plane:new Float32Array(4),friction:0,elasticity:0,is_lod:!1,lod_center:new Float32Array(3),main_lod_offset:new Float32Array(3),lod_dist_min:0,lod_dist_max:g,lod_lower_border_range:0,lod_upper_border_range:0,do_not_render:!1,shadow_cast:!1,shadow_receive:!1,shadow_cast_only:!1,reflexible:!1,reflexible_only:!1,reflective:!1,reflection_type:"",wind_bending:!1,dynamic_geometry:!1,dynamic_grass:!1,hide:!1,hide_children:!1,selectable:!1,origin_selectable:!1,outlining:!1,origin_outlining:!1,outline_on_select:!1,is_hair_particles:!1,is_visible:!1,force_zsort:!1,wind_bending_angle:0,wind_bending_amp:0,wind_bending_freq:0,detail_bending_freq:0,detail_bending_amp:0,branch_bending_amp:0,main_bend_col:"",detail_bend_col:{leaves_stiffness:"",leaves_phase:"",overall_stiffness:""},bend_center_only:!1,center_pos:new Float32Array(3),billboard:!1,billboard_pres_glob_orientation:!1,billboard_type:"",billboard_spherical:!1,frame_factor:0,va_frame:0,va_frame_factor:0,max_bones:0,frames_blending:!1,vertex_anim:!1,use_shape_keys:!1,shape_keys_values:[],is_skinning:!1,anim_mixing:!1,anim_mix_factor:1,anim_mix_factor_change_speed:0,anim_destination_mix_factor:1,anim_mix_cb:null,mix_with_current:!1,blend_skel_slots:new Int8Array([-1,-1]),skinned_renders:[],mesh_to_arm_bone_maps:[],skinning_data_cache:[],quats_before:null,quats_after:null,trans_before:null,trans_after:null,trans_curr:null,quats_curr:null,bone_pointers:null,bone_skinning_info:null,pose_data:null,arm_rel_trans:null,arm_rel_quat:null,bb_original:n.w(),bb_local:n.w(),bb_world:n.w(),bs_local:n.A(),bs_world:n.A(),be_local:n.y(),be_world:n.y(),bbr_local:n.C(),bbr_world:n.C(),bcyl_local:n.K(),bcap_local:n.I(),bcon_local:n.J(),pass_index:0};return c.copy(s.f,t.vertical_axis),t}function a(e){var t=r(e.type);return t.data_id=e.data_id,i.a(e.world_tsr,t.world_tsr),i.a(e.world_tsr_inv,t.world_tsr_inv),c.copy(e.pivot,t.pivot),c.copy(e.hover_pivot,t.hover_pivot),t.init_dist=e.init_dist,t.init_fov=e.init_fov,t.is_copied=e.is_copied,t.is_copied_deep=e.is_copied_deep,e.color_id&&(t.color_id=c.clone(e.color_id)),t.outline_intensity=e.outline_intensity,t.target_cam_upside_down=e.target_cam_upside_down,c.copy(e.vertical_axis,t.vertical_axis),t.use_panning=e.use_panning,t.move_style=e.move_style,t.velocity_trans=e.velocity_trans,t.velocity_rot=e.velocity_rot,t.velocity_zoom=e.velocity_zoom,t.dof_distance=e.dof_distance,t.dof_front_start=e.dof_front_start,t.dof_front_end=e.dof_front_end,t.dof_rear_start=e.dof_rear_start,t.dof_rear_end=e.dof_rear_end,t.dof_power=e.dof_power,t.dof_bokeh_intensity=e.dof_bokeh_intensity,t.dof_bokeh=e.dof_bokeh,t.dof_foreground_blur=e.dof_foreground_blur,t.dof_object=e.dof_object,t.horizontal_limits=s.O(e.horizontal_limits),t.vertical_limits=s.O(e.vertical_limits),t.distance_limits=s.O(e.distance_limits),t.hover_vert_trans_limits=s.O(e.hover_vert_trans_limits),t.hover_horiz_trans_limits=s.O(e.hover_horiz_trans_limits),t.pivot_limits=e.pivot_limits,t.enable_hover_hor_rotation=e.enable_hover_hor_rotation,t.outline_anim_settings_default.outline_duration=e.outline_anim_settings_default.outline_duration,t.outline_anim_settings_default.outline_period=e.outline_anim_settings_default.outline_period,t.outline_anim_settings_default.outline_relapses=e.outline_anim_settings_default.outline_relapses,t.cube_reflection_id=e.cube_reflection_id,t.plane_reflection_id=e.plane_reflection_id,t.reflection_plane=e.reflection_plane,t.friction=e.friction,t.elasticity=e.elasticity,t.is_lod=e.is_lod,c.copy(e.lod_center,t.lod_center),c.copy(e.main_lod_offset,t.main_lod_offset),t.lod_dist_min=e.lod_dist_min,t.lod_dist_max=e.lod_dist_max,t.lod_lower_border_range=e.lod_lower_border_range,t.lod_upper_border_range=e.lod_upper_border_range,t.do_not_render=e.do_not_render,t.shadow_cast=e.shadow_cast,t.shadow_receive=e.shadow_receive,t.shadow_cast_only=e.shadow_cast_only,t.reflexible=e.reflexible,t.reflexible_only=e.reflexible_only,t.reflective=e.reflective,t.reflection_type=e.reflection_type,t.wind_bending=e.wind_bending,t.dynamic_geometry=e.dynamic_geometry,t.dynamic_grass=e.dynamic_grass,t.hide=e.hide,t.selectable=e.selectable,t.origin_selectable=e.origin_selectable,t.outlining=e.outlining,t.origin_outlining=e.origin_outlining,t.outline_on_select=e.outline_on_select,t.is_hair_particles=e.is_hair_particles,t.is_visible=e.is_visible,t.force_zsort=e.force_zsort,t.wind_bending_angle=e.wind_bending_angle,t.wind_bending_amp=e.wind_bending_amp,t.wind_bending_freq=e.wind_bending_freq,t.detail_bending_freq=e.detail_bending_freq,t.detail_bending_amp=e.detail_bending_amp,t.branch_bending_amp=e.branch_bending_amp,t.main_bend_col=e.main_bend_col,t.detail_bend_col=e.detail_bend_col,t.bend_center_only=e.bend_center_only,c.copy(e.center_pos,t.center_pos),t.billboard=e.billboard,t.billboard_pres_glob_orientation=e.billboard_pres_glob_orientation,t.billboard_type=e.billboard_type,t.billboard_spherical=e.billboard_spherical,t.frame_factor=e.frame_factor,t.va_frame=e.va_frame,t.va_frame_factor=e.va_frame_factor,t.max_bones=e.max_bones,t.frames_blending=e.frames_blending,t.vertex_anim=e.vertex_anim,t.use_shape_keys=e.use_shape_keys,t.shape_keys_values=s.O(e.shape_keys_values),t.is_skinning=e.is_skinning,t.anim_mixing=e.anim_mixing,t.anim_mix_factor=e.anim_mix_factor,t.anim_mix_factor_change_speed=e.anim_mix_factor_change_speed,t.anim_destination_mix_factor=e.anim_destination_mix_factor,t.blend_skel_slots.set(e.blend_skel_slots),t.skinned_renders=s.O(e.skinned_renders),t.mesh_to_arm_bone_maps=s.O(e.mesh_to_arm_bone_maps),t.skinning_data_cache=s.O(e.skinning_data_cache),t.quats_before=s.O(e.quats_before),t.quats_after=s.O(e.quats_after),t.trans_before=s.O(e.trans_before),t.trans_after=s.O(e.trans_after),t.bone_pointers=s.O(e.bone_pointers),t.bone_skinning_info=s.O(e.bone_skinning_info),t.pose_data=s.O(e.pose_data),t.arm_rel_trans=s.O(e.arm_rel_trans),t.arm_rel_quat=s.O(e.arm_rel_quat),n.o(e.bb_original,t.bb_original),n.o(e.bb_local,t.bb_local),n.o(e.bb_world,t.bb_world),n.u(e.bs_local,t.bs_local),n.u(e.bs_world,t.bs_world),n.s(e.be_local,t.be_local),n.s(e.be_world,t.be_world),n.p(e.bcap_local,t.bcap_local),n.r(e.bcyl_local,t.bcyl_local),n.q(e.bcon_local,t.bcon_local),t.pass_index=e.pass_index,t}function _(e,t,r){return r||(r=e),{name:e,uuid:s._4(),origin_name:r,type:t,materials:[],is_meta:!0,_bpy_obj:null,mat_inheritance_data:{original_mat_names:[],is_disabled:[]},is_dynamic:!1,is_hair_dupli:!1,use_default_animation:!1,is_boundings_overridden:!1,render:null,constraint:null,sfx:null,light:null,armobj:null,anchor:null,field:null,metatags:null,custom_prop:null,scenes_data:[],vertex_anim:[],cons_descends:s.S(),cons_armat_bone_descends:s.S(),anim_slots:[],reflective_objs:[],nla_events:[],action_anim_cache:[],sensor_manifolds:null,sensor_manifolds_arr:[],parent:null,parent_is_dupli:!1,parent_bone:"",viewport_alignment:null,pinverse_tsr:null,use_obj_physics:!1,collision_id:"",correct_bounding_offset:"AUTO",is_vehicle:!1,is_character:!1,is_floating:!1,bob_synchronize_pos:!1,physics:null,vehicle:null,floater:null,vehicle_settings:null,floating_settings:null,character_settings:null,physics_constraints:[],physics_settings:{physics_type:"NO_COLLISION",use_ghost:!1,use_sleep:!1,mass:0,velocity_min:0,velocity_max:0,damping:0,rotation_damping:0,lock_location_x:!1,lock_location_y:!1,lock_location_z:!1,lock_rotation_x:!1,lock_rotation_y:!1,lock_rotation_z:!1,collision_margin:0,collision_group:0,collision_mask:0,use_collision_bounds:!1,collision_bounds_type:"BOX",use_collision_compound:!1},outline_animation:{time_start:0,outline_time:0,period:0,relapses:0},anim_behavior_def:0,def_action_slots:[],need_update_transform:!1,need_inv_zup_tsr:!1,meta_objects:[]}}function l(e){return{scene:e,is_active:!1,batches:[],batch_world_bounds:[],plane_refl_subs:[],cube_refl_subs:null,shadow_subscenes:[],light_index:0,obj_has_nla_on_scene:!1,cameras:[],shadow_cameras:[]}}function T(e){if(!(e instanceof Object))return e;var t=null,r=null,a=null,_=null,n=null,o=null;e.textures&&(t=e.textures,e.textures=null),e.texture_names&&(r=e.texture_names,e.texture_names=null),e.bpy_tex_names&&(a=e.bpy_tex_names,e.bpy_tex_names=null),e.shape_keys&&(_=e.shape_keys,e.shape_keys=null),e.shader&&(n=e.shader,e.shader=null),e.vaos&&(o=e.vaos,e.vaos=null);var i,c=e.constructor;switch(c){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:i=new c(e);break;case Array:i=new c(e.length);for(var E=0;E<e.length;E++)i[E]=T(e[E]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:i=e;break;case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:i=null;break;case Function:i=e;break;default:i=new c;for(var l in e)i[l]=T(e[l])}return t&&(i.textures=t,e.textures=t),r&&(i.texture_names=r,e.texture_names=r),a&&(i.bpy_tex_names=a,e.bpy_tex_names=a),_&&(i.shape_keys=_,e.shape_keys=_),n&&(i.shader=n,e.shader=n),o&&(i.vaos=s.S(),e.vaos=o),i}function u(e){return e.is_dynamic}function d(e,t){n.o(t,e.bb_local),n.h(e.bb_local,e.world_tsr,e.bb_world)}function f(e,t,r){e.bs_local=n.l(t,r),n.k(e.bs_local,e.world_tsr,e.bs_world)}function P(e,t,r,a,_,o){e.be_local=n.e(t,r,a,o),c.scale(e.be_local.axis_x,_[0],e.be_local.axis_x),c.scale(e.be_local.axis_y,_[1],e.be_local.axis_y),c.scale(e.be_local.axis_z,_[2],e.be_local.axis_z),n.i(e.be_local,e.world_tsr,e.be_world)}function A(e,t,r,a){e.bcyl_local=n.d(t,a),e.bcap_local=n.b(r,a),e.bcon_local=n.c(t,a)}function S(e,t,r,a,_,o){e.bbr_local=n.O(o,t,r,a,_),n.j(e.bbr_local,e.world_tsr,e.bbr_world)}function p(e,t,r){n.h(e.bounds_local.bb,t,r.bb),e.use_be&&n.i(e.bounds_local.be,t,r.be),n.k(e.bounds_local.bs,t,r.bs)}function v(e,t){for(var r=e.scenes_data,a=0;a<r.length;a++){var _=r[a];if(_.scene==t)return _}return null}function m(e){return e.parent_is_dupli?e.parent:e.parent?m(e.parent):null}var O=Object(o.a)(e),N=O.defaults,g=1/0;t.LOD_DIST_MAX_INFINITY=g,t.create_render=r,t.clone_render=a,t.create_object=_,t.init_scene_data=l,t.copy_bpy_object_props_by_link=function(e){return e instanceof Array?e.slice():e},t.copy_object_props_by_value=T,t.is_dynamic=u,t.is_dynamic_mesh=function(e){return"MESH"==e.type&&e.is_dynamic},t.append_scene_data=function(e,t){var r=l(t);e.scenes_data.push(r)},t.append_batch=function(e,t,r){var a=e.render,_=v(e,t);_.batches.push(r);var o=n.L();p(r,a.world_tsr,o),_.batch_world_bounds.push(o)},t.update_render_bounds_billboard=function(e,t){var r=e.render,a=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),_=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),o=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),i=Math.sqrt(a*a+_*_+o*o),s=Math.sqrt(a*a+_*_),c=n.w();c.max_x=c.max_y=c.max_z=i,c.min_x=c.min_y=c.min_z=-i,d(r,c),f(r,i,[0,0,0]),P(r,[1,0,0],[0,1,0],[0,0,1],[i,i,i],[0,0,0]),u(e)?A(r,s,s,c):S(r,[1,0,0],[0,1,0],[0,0,1],[i,i,i],[0,0,0])},t.update_render_bounds_from_bpy=function(e,t,r){var a=e.render,_=r.bs_rad,n=r.bc_rad,o=r.bs_cen,i=r.be_cen,s=r.caxis_x,c=r.caxis_y,E=r.caxis_z,l=r.be_ax,T=r.rbb.rbb_c,p=r.rbb.rbb_s;d(a,t),f(a,_,o);var v=u(e);P(a,v?s:[1,0,0],v?c:[0,1,0],v?E:[0,0,1],l,i),u(e)?A(a,n,n,a.bb_local):S(a,s,c,E,p,T)},t.update_render_bounds_from_pos_arrays=function(e,t,r){for(var a=e.render,_=t.max_x-t.min_x,n=t.max_y-t.min_y,o=t.max_z-t.min_z,i=(t.max_x+t.min_x)/2,s=(t.max_y+t.min_y)/2,c=(t.max_z+t.min_z)/2,E=i,l=s,T=Math.max(_,Math.max(n,o))/2,p=Math.max(_,n)/2,v=[i/(_||1),s/(n||1),c/(o||1)],m=.5,O=0;O<r.length;O++)for(var N=r[O],g=0;g<N.length;g+=3){var h=N[g],R=N[g+1],I=N[g+2],b=Math.sqrt((i-h)*(i-h)+(s-R)*(s-R)+(c-I)*(c-I));if(b>T){var Y=i-T*(h-i)/b,L=s-T*(R-s)/b,M=c-T*(I-c)/b;i=(Y+h)/2,s=(L+R)/2,c=(M+I)/2,T=Math.sqrt((i-h)*(i-h)+(s-R)*(s-R)+(c-I)*(c-I))}var y=Math.sqrt((E-h)*(E-h)+(l-R)*(l-R));if(y>p){var Y=E-p*(h-E)/y,L=l-p*(R-l)/y;E=(Y+h)/2,l=(L+R)/2,p=Math.sqrt((E-h)*(E-h)+(l-R)*(l-R))}h/=_||1,R/=n||1,I/=o||1;var x=Math.sqrt((v[0]-h)*(v[0]-h)+(v[1]-R)*(v[1]-R)+(v[2]-I)*(v[2]-I));if(x>m){var Y=v[0]-m*(h-v[0])/x,L=v[1]-m*(R-v[1])/x,M=v[2]-m*(I-v[2])/x;v[0]=(Y+h)/2,v[1]=(L+R)/2,v[2]=(M+I)/2,m=Math.sqrt((v[0]-h)*(v[0]-h)+(v[1]-R)*(v[1]-R)+(v[2]-I)*(v[2]-I))}}var U=_?_*v[0]:t.max_x,w=n?n*v[1]:t.max_y,C=o?o*v[2]:t.max_z,D=m*_,F=m*n,G=m*o;if(d(a,t),f(a,T,[i,s,c]),P(a,[1,0,0],[0,1,0],[0,0,1],[D,F,G],[U,w,C]),u(e))A(a,p,p,a.bb_local);else{S(a,[(a.bb_local.max_x-a.bb_local.min_x)/2,0,0],[0,(a.bb_local.max_y-a.bb_local.min_y)/2,0],[0,0,(a.bb_local.max_z-a.bb_local.min_z)/2],[1,1,1],[(a.bb_local.max_x+a.bb_local.min_x)/2,(a.bb_local.max_y+a.bb_local.min_y)/2,(a.bb_local.max_z+a.bb_local.min_z)/2])}},t.update_world_bounds_from_batch_tsr=p,t.remove_scene_data=function(e,t){for(var r=e.scenes_data,a=0;a<r.length;a++){if(r[a].scene==t){r.splice(a,1);break}}},t.get_scene_data=v,t.update_refl_objects=function(e,t){for(var r=0;r<e.length;r++)E.copy(t,e[r].render.reflection_plane)},t.scene_data_set_active=function(e,t,r){for(var a=0;a<e.scenes_data.length;a++){var _=e.scenes_data[a];r&&_.scene!=r||(_.is_active=t)}},t.scene_data_remove_batch=function(e,t){e.batches.splice(t,1),e.batch_world_bounds.splice(t,1)},t.get_shadow_lamps=function(e,t){for(var r=[],a=t?N.max_cast_lamps-1:N.max_cast_lamps,_=0;_<e.length;_++){var n=e[_];n.light.generate_shadows&&r.length<a&&r.push(n)}return r.length?r:e[0]?[e[0]]:[]},t.meta_obj_append_render=function(e,t){i.m(t.world_tsr),t.color_id=null,e.render=t},t.check_obj_soft_particles_accessibility=function(e,t){if(t.b4w_enable_soft_particles&&t.b4w_particles_softness>0){var r=t.material-1,a=e.materials;if(r>=0&&r<a.length&&("ADD"==a[r].blend_mode||"ALPHA"==a[r].blend_mode||"ALPHA_SORT"==a[r].blend_mode))return!0}return!1},t.check_inv_zup_tsr_is_needed=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)for(var a=t[r].batches,_=0;_<a.length;_++)for(var n=a[_].shaders_info.directives,o=0;o<n.length;o++){var i=n[o];if("USE_MODEL_TSR_INVERSE"==i[0]&&"1"==i[1])return!0}return!1},t.gen_dupli_name=function(e,t){return e+"*"+t},t.get_parent=function(e){return e.parent_is_dupli?null:e.parent},t.get_dg_parent=m,t.get_dg_objects=function(e,t){for(var r=[],a=0;a<t.length;a++){var _=t[a];m(_)==e&&r.push(_)}return r},t.get_object_data_id=function(e){return e.render.data_id},t.is_mesh=function(e){return"MESH"===e.type},t.is_armature=function(e){return"ARMATURE"===e.type},t.is_speaker=function(e){return"SPEAKER"===e.type},t.is_camera=function(e){return"CAMERA"===e.type},t.is_lamp=function(e){return"LAMP"===e.type},t.is_empty=function(e){return"EMPTY"===e.type},t.is_line=function(e){return"LINE"===e.type},t.is_world=function(e){return"WORLD"===e.type}}var _=r(0),n=r(25),o=r(4),i=r(6),s=r(2),c=r(3),E=r(7),l=Object(_.a)("__obj_util",a);t.a=l},function(e,t,r){"use strict";function a(e,t){function r(){return er||(er=a(rr)),er}function a(e){for(var t=0;t<e.length;t++){var r=e[t];if(!r._render_to_textures||!r._render_to_textures.length)return r}return null}function _(){return tr||mt.panic("No active scene available"),tr}function U(){return!!tr}function w(){return rr}function C(e,r,a,_,n,o){var i=xt.get_scene_data(r._camera,r),s=[],c={reflection_params:q(e,a,n)};Ft.update_rendering_graph(r._render,i,r._camera.render,s,c),t.prepare_rendering(r,r),t.generate_auxiliary_batches(r,r._render.graph)}function D(e,t,r,a,_){e._render_to_textures=e._render_to_textures||[],e._nla=null;var n=e._render,o=xt.get_scene_data(e._camera,e),i=e._camera.render;n.video_textures=[];var s=e.world;n.lamps_number=r.length,n.sun_exist=k(r),n.sky_params=W(s,n.sun_exist),n.world_light_set=_e(s,n.sky_params),n.world_fog_set=ne(s),n.hmd_stereo_use=!e._render_to_textures.length&&z(o),n.anaglyph_use=!e._render_to_textures.length&&H(o),n.sidebyside_use=!e._render_to_textures.length&&Q(o),n.anchor_visibility=!n.anaglyph_use&&!n.sidebyside_use&&Te(e,_),n.reflection_params=q(e,t,a),n.bloom_params=Z(e),n.mb_params=$(e),n.cc_params=ee(e),n.god_rays_params=te(e),n.outline_params=re(e),n.glow_params=ae(e),n.dof=jt.dof&&(i.dof_distance>0||i.dof_object),n.motion_blur=jt.motion_blur&&e.b4w_enable_motion_blur,n.compositing=jt.compositing&&e.b4w_enable_color_correction,n.antialiasing=jt.antialiasing&&1==jt.msaa_samples&&"NONE"!=e.b4w_antialiasing_quality,n.ssao=jt.ssao&&e.b4w_enable_ssao,n.god_rays=jt.god_rays&&e.b4w_enable_god_rays&&n.sun_exist,n.depth_tex=jt.depth_tex_available,n.glow_over_blend=e.b4w_glow_settings.render_glow_over_blend,n.ssao_params=J(e);var c=j(a);switch(n.materials_params=c,n.refractions=Ee(e,c),n.shadow_params=F(e,r,a),n.water_params=X(a),n.xray=le(a),n.soft_particles=B(a),n.shore_smoothing=K(a),n.dynamic_grass=oe(e,a),n.color_picking=ie(e,a),n.outline=se(e,a),n.glow_materials=ce(e,a),n.lod_smooth_type=e.b4w_lod_smooth_type,n.lod_hyst_interval=e.b4w_lod_hyst_interval,jt.reflection_quality?jt.reflection_quality:e.b4w_reflection_quality){case"LOW":n.cubemap_refl_size=zt.cube_reflect_low,n.plane_refl_size=zt.plane_reflect_low;break;case"MEDIUM":n.cubemap_refl_size=zt.cube_reflect_medium,n.plane_refl_size=zt.plane_reflect_medium;break;case"HIGH":n.cubemap_refl_size=zt.cube_reflect_high,n.plane_refl_size=zt.plane_reflect_high;break;default:n.cubemap_refl_size=zt.cube_reflect_low,n.plane_refl_size=zt.plane_reflect_low}ht.is_hidpi()?(Ct.log("%cENABLE HIDPI MODE","color: #00a"),n.aa_quality="AA_QUALITY_LOW",n.resolution_factor=1,jt.msaa_samples=1):jt.msaa_samples>1?(Ct.log("%cENABLE MSAA RENDERING: "+jt.msaa_samples+"x","color: #00a"),n.resolution_factor=1):(n.aa_quality="AA_QUALITY_"+e.b4w_antialiasing_quality,jt.quality===gt.P_ULTRA?n.resolution_factor=1.33:n.resolution_factor=1);var E=function(e,t){return t.source_size-e.source_size},l=e._render_to_textures.sort(E);n.graph=Ft.create_rendering_graph(n,o,i,l),n.queue=[],n.need_shadow_update=!1,n.need_grass_map_update=!1,n.need_outline=!1,n.wind=new Float32Array(3),rr.push(e),ar||(ar=It.create()),It.append_node_attr(ar,e);for(var T=0;T<t.length;T++)xt.scene_data_set_active(t[T],!0,e);var u=ht.get_container();ht.resize(u.clientWidth,u.clientHeight,!0)}function F(e,t,r){if(!G(e,t,r))return null;var a=e.b4w_shadow_settings,_={};a.csm_resolution>Ht.max_texture_size?(_.csm_resolution=Ht.max_texture_size,Ct.error("Shadow map texture has unsupported size. Changed to "+Ht.max_texture_size+".")):_.csm_resolution=a.csm_resolution,jt.shadow_blur_samples=jt.shadow_blur_samples?jt.shadow_blur_samples:a.blur_samples,_.soft_shadows=a.soft_shadows;var n=jt.ssao&&e.b4w_enable_ssao,o=xt.get_shadow_lamps(t,n);_.self_shadow_polygon_offset=a.self_shadow_polygon_offset,_.self_shadow_normal_offset=a.self_shadow_normal_offset,_.enable_csm=a.b4w_enable_csm&&1==o.length,a.b4w_enable_csm&&a.csm_num>1&&o.length>1&&Ct.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps."),_.lamp_types=[],_.spot_sizes=[],_.clip_start=[],_.clip_end=[];for(var i=0;i<o.length;i++)_.lamp_types.push(o[i].light.type),_.spot_sizes.push(o[i].light.spot_size),_.clip_start.push(o[i].light.clip_start),_.clip_end.push(o[i].light.clip_end),"SPOT"!=_.lamp_types[i]&&"POINT"!=_.lamp_types[i]||!_.enable_csm||(Ct.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),_.enable_csm=!1);return _.enable_csm?(_.csm_num=a.csm_num,_.csm_first_cascade_border=a.csm_first_cascade_border,_.first_cascade_blur_radius=a.first_cascade_blur_radius,_.csm_last_cascade_border=a.csm_last_cascade_border,_.last_cascade_blur_radius=a.last_cascade_blur_radius,_.fade_last_cascade=a.fade_last_cascade,_.blend_between_cascades=a.blend_between_cascades):(_.csm_num=1,_.csm_first_cascade_border=a.csm_first_cascade_border,_.first_cascade_blur_radius=a.first_cascade_blur_radius,_.csm_last_cascade_border=a.csm_last_cascade_border,_.last_cascade_blur_radius=a.last_cascade_blur_radius,_.fade_last_cascade=!1,_.blend_between_cascades=!1),_}function G(e,t,r){if(0==t.length)return!1;if(!jt.shadows)return!1;switch(e.b4w_render_shadows){case"OFF":return!1;case"ON":return!0}var a=!1,_=!1,n=jt.ssao&&e.b4w_enable_ssao;if(0==t.length&&!n)return!1;for(var o=0;o<r.length;o++){var i=r[o];if(i.b4w_shadow_cast&&(a=!0),i.b4w_shadow_receive&&(_=!0),(n||a)&&_)return!0}return!1}function k(e){for(var t=0;t<e.length;t++)if("SUN"==e[t].light.type)return!0;return!1}function K(e){if(!jt.shore_smoothing)return!1;for(var t=qe(e),r=0;r<t.length;r++){var a=t[r];if(a.water_settings.is_water&&a.water_settings.shore_smoothing)return!0}return!1}function B(e){for(var t=0;t<e.length;t++)for(var r=e[t],a=r.particle_systems,_=0;_<a.length;_++){var n=a[_].settings;if(xt.check_obj_soft_particles_accessibility(e[t]._object,n))return!0}return!1}function X(e){for(var t=qe(e),r=[],a=0;a<t.length;a++){var _=t[a];if(_.water_settings.is_water){for(var n={},o=0;o<e.length;o++)for(var i=e[o],s=i._object.materials,c=0;c<s.length;c++){var E=s[c];E==_&&(n.water_level=i.location[2])}n.fog_color_density=new Float32Array(4),n.fog_color_density.set(_.water_settings.fog_color),n.fog_color_density[3]=_.water_settings.fog_density,_.water_settings.is_dynamic?(n.dynamic=!0,n.waves_height=_.water_settings.waves_height,n.waves_length=_.water_settings.waves_length,n.dst_noise_scale0=_.water_settings.dst_noise_scale0,n.dst_noise_scale1=_.water_settings.dst_noise_scale1,n.dst_noise_freq0=_.water_settings.dst_noise_freq0,n.dst_noise_freq1=_.water_settings.dst_noise_freq1,n.dir_min_shore_fac=_.water_settings.dir_min_shore_fac,n.dir_freq=_.water_settings.dir_freq,n.dir_noise_scale=_.water_settings.dir_noise_scale,n.dir_noise_freq=_.water_settings.dir_noise_freq,n.dir_min_noise_fac=_.water_settings.dir_min_noise_fac,n.dst_min_fac=_.water_settings.dst_min_fac,n.waves_hor_fac=_.water_settings.waves_hor_fac):(n.dynamic=!1,n.waves_height=0,n.waves_length=0),n.caustics=_.water_settings.enable_caust,n.caustic_scale=_.water_settings.caust_scale,n.caustic_brightness=_.water_settings.caust_brightness,n.caustic_speed=new Float32Array([.3,.7]),n.shoremap_image=null;for(var l=_.texture_slots,o=0;o<l.length;o++){var T=l[o].texture;if(!0===T.b4w_shore_dist_map&&"FILE"==T.image.source){n.shoremap_image=T.image,n.shoremap_tex_size=T.image.size[0],n.max_shore_dist=T.b4w_max_shore_dist;var u=T.b4w_shore_boundings;n.shoremap_center=[(u[0]+u[1])/2,(u[2]+u[3])/2],n.shoremap_size=[u[0]-u[1],u[2]-u[3]]}}r.push(n)}}if(r.length>0){var n=r[0];if(!n.dynamic)for(var a=0;a<r.length;a++)r[a].dynamic&&(n=r[a]);return n}return null}function j(e){for(var t={refractions:!1},r=qe(e),a=function(e,r){if(e)for(var _=e.nodes,n=0;n<_.length;n++){var o=_[n];"GROUP"==o.type&&o.node_group&&a(o.node_group.node_tree,r),"GROUP"==o.type&&"B4W_REFRACTION"==o.node_tree_name&&(t.refractions=!0),"BSDF_TRANSPARENT"==o.type&&(o.b4w_use_alpha?r.blend_mode="ALPHA_SORT":t.refractions=!0),"BSDF_PRINCIPLED"==o.type&&(t.refractions=!0)}},_=0;_<r.length;_++){var n=r[_];n.is_refractive&&(t.refractions=!0),n.node_tree&&a(n.node_tree,n)}return t}function H(e){return e.cameras[0].type!=Nt.TYPE_PERSP&&"ANAGLYPH"==jt.stereo?(Ct.warn("Anaglyph stereo is disabled for the non-perspective camera"),jt.stereo="NONE",!1):"ANAGLYPH"==jt.stereo}function Q(e){return e.cameras[0].type!=Nt.TYPE_PERSP&&"SIDEBYSIDE"==jt.stereo?(Ct.warn("Side-by-side stereo is disabled for the non-perspective camera"),jt.stereo="NONE",!1):"SIDEBYSIDE"==jt.stereo}function z(e){if("HMD"==jt.stereo){if(e.cameras[0].type!=Nt.TYPE_PERSP)return Ct.warn("Head-mounted display stereo is disabled for the non-perspective camera"),jt.stereo="NONE",!1;if(!Yt.can_use_device(Yt.DEVICE_HMD))return Ct.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices"),jt.stereo="NONE",!1}return"HMD"==jt.stereo}function q(e,t,r){if(!jt.reflections)return!1;switch(e.b4w_render_reflections){case"OFF":return!1}for(var a=[],_=[],n=!1,o=!1,i=!1,s=0;s<t.length;s++){var c=t[s];if(c.render.reflective&&"CUBE"==c.render.reflection_type&&_.push(c),c.render.reflective&&"PBR"==c.render.reflection_type&&(o=!0),c.reflective_objs.length){for(var E=null,l=0;l<a.length;l++){if(a[l]==c){E=l;break}}null==E&&a.push(c)}}for(var s=0;s<r.length;s++){var T=r[s];T.b4w_reflexible&&(n=!0),V(T)&&(i=!0)}return{refl_plane_objs:a,refl_cube_objs:_,cube_refl_subs:[],cube_refl_subs_blend:[],plane_refl_subs:[],plane_refl_subs_blend:[],has_reflexible:n,has_pbr_reflexible:o,has_blend_reflexible:i}}function V(e){if(e.b4w_reflexible){for(var t=e._object.materials,r=0;r<t.length;r++){var a=t[r].blend_mode;if("OPAQUE"!=a&&"CLIP"!=a&&"ALPHA_ANTIALIASING"!=a)return!0}return!1}}function W(e,t){var r=e.b4w_sky_settings,a={};return a.render_sky=r.render_sky||r.procedural_skydome,a.procedural_skydome=r.procedural_skydome,a.use_as_environment_lighting=r.use_as_environment_lighting,a.sky_color=r.color,a.rayleigh_brightness=r.rayleigh_brightness,a.mie_brightness=r.mie_brightness,a.spot_brightness=r.spot_brightness,a.scatter_strength=r.scatter_strength,a.rayleigh_strength=r.rayleigh_strength,a.mie_strength=r.mie_strength,a.rayleigh_collection_power=r.rayleigh_collection_power,a.mie_collection_power=r.mie_collection_power,a.mie_distribution=r.mie_distribution,a.reflexible=r.reflexible,a.reflexible_only=r.reflexible_only,!t&&r.procedural_skydome&&Ct.warn("There is no sun on the scene. Procedural sky will use a default sun position."),a}function J(e){var t={},r=e.b4w_ssao_settings;return t.radius_increase=r.radius_increase,t.hemisphere=r.hemisphere,t.blur_depth=r.blur_depth,t.blur_discard_value=r.blur_discard_value,t.influence=r.influence,t.dist_factor=r.dist_factor,t.samples=r.samples,t}function Z(e){if(!jt.bloom||!e.b4w_enable_bloom)return null;var t={},r=e.b4w_bloom_settings;return t.blur=r.blur,t.edge_lum=r.edge_lum,t.key=r.key,t.adaptive=r.adaptive,t.average_luminance=r.average_luminance,t}function $(e){var t={},r=e.b4w_motion_blur_settings;return t.mb_decay_threshold=r.motion_blur_decay_threshold,t.mb_factor=r.motion_blur_factor,t}function ee(e){var t={},r=e.b4w_color_correction_settings;return t.brightness=r.brightness,t.contrast=r.contrast,t.exposure=r.exposure,t.saturation=r.saturation,t}function te(e){var t={},r=e.b4w_god_rays_settings;return t.intensity=r.intensity,t.max_ray_length=r.max_ray_length,t.steps_per_pass=r.steps_per_pass,t}function re(e){var t={};return t.outline_color=e.b4w_outline_color,t.outline_factor=e.b4w_outline_factor,t}function ae(e){var t={},r=e.b4w_glow_settings;return t.small_glow_mask_coeff=r.small_glow_mask_coeff,t.large_glow_mask_coeff=r.large_glow_mask_coeff,t.small_glow_mask_width=r.small_glow_mask_width,t.large_glow_mask_width=r.large_glow_mask_width,t}function _e(e,t){var r=e.light_settings,a={};if(a.environment_energy=r.environment_energy,a.use_environment_light=r.use_environment_light,a.environment_color=r.environment_color,a.horizon_color=e.horizon_color.slice(0),a.zenith_color=e.zenith_color.slice(0),a.use_sky_paper=e.use_sky_paper,a.use_sky_blend=e.use_sky_blend,a.use_sky_real=e.use_sky_real,a.sky_texture_slot=null,a.sky_texture_param=null,a.environment_texture_slot=null,a.ngraph_proxy_id="",t.render_sky&&e.use_nodes&&e.node_tree){var _=e.node_tree,n=e.uuid,o=e.name,i=Lt.compose_ngraph_proxy(_,n,!1,e.name+"(World)",o,"MAIN",null,[]);a.ngraph_proxy_id=i.id}var s=!0;if(a.use_environment_light&&"SKY_TEXTURE"==a.environment_color&&(!t.procedural_skydome||!t.use_as_environment_lighting)){for(var c=null,E=0;E<e.texture_slots.length;E++)if(e.texture_slots[E].texture.b4w_use_as_environment_lighting&&!e.texture_slots[E].texture.b4w_use_as_skydome){c=e.texture_slots[E];break}c?a.environment_texture_slot=c:s=!1}for(var E=0;E<e.texture_slots.length;E++)if(e.texture_slots[E].texture.b4w_use_as_skydome){var l=e.texture_slots[E];if(l.texture.image){s=!0,a.sky_texture_slot=l;var T=Math.min(Ht.max_cube_map_texture_size,Bt.calc_pot_size(l.texture.image.size[0]/3));a.sky_texture_param={tex_size:T,blend_factor:l.blend_factor,horizon_factor:l.horizon_factor,zenith_up_factor:l.zenith_up_factor,zenith_down_factor:l.zenith_down_factor,color:l.color,default_value:l.default_value,invert:l.invert,use_rgb_to_intensity:l.use_rgb_to_intensity,blend_type:l.blend_type,use_map_blend:l.use_map_blend,use_map_horizon:l.use_map_horizon,use_map_zenith_up:l.use_map_zenith_up,use_map_zenith_down:l.use_map_zenith_down}}break}return a.use_environment_light=!!a.use_environment_light&&s,a}function ne(e){var t=e.fog_settings,r={};r.use_fog=t.use_fog,r.intensity=t.intensity,r.depth=t.depth,r.start=t.start,r.height=t.height,r.falloff=t.falloff,t.use_custom_color?r.color=t.color.slice(0):r.color=e.horizon_color.slice(0);var a=r.color,_=1/r.depth;return r.fog_color_density=new Float32Array([a[0],a[1],a[2],_]),r.fog_params=new Float32Array([r.intensity,r.depth,r.start,r.height]),r}function oe(e,t){if(!jt.dynamic_grass)return!1;switch(e.b4w_render_dynamic_grass){case"OFF":return!1;case"ON":return!0}for(var r=!1,a=!1,_=0;_<t.length;_++){for(var n=t[_],o=n._object.materials,i=0;i<o.length;i++){o[i].terrain_settings.is_terrain&&(r=!0)}for(var s=n.particle_systems,i=0;i<s.length;i++){var c=s[i].settings;"HAIR"==c.type&&c.b4w_dynamic_grass&&(a=!0)}if(r&&a)return!0}return!1}function ie(e,t){if(Qt.outlining_overview_mode)return!0;if(!jt.enable_selectable)return!1;switch(e.b4w_enable_object_selection){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++)if(t[r]._object.render.selectable)return!0;return!1}}function se(e,t){if(Qt.outlining_overview_mode)return!0;if(!jt.enable_outlining)return!1;switch(e.b4w_enable_outlining){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++)if(t[r]._object.render.outlining)return!0;return!1}}function ce(e,t){if(!jt.glow_materials)return!1;switch(e.b4w_enable_glow_materials){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++)for(var a=t[r]._object.materials,_=0;_<a.length;_++)if(Lt.check_material_glow_output(a[_]))return!0;return!1}}function Ee(e,t){if(!jt.refractions)return!1;switch(e.b4w_render_refractions){case"OFF":return!1;case"ON":return!0;case"AUTO":return t.refractions}}function le(e){for(var t=0;t<e.length;t++)for(var r=e[t]._object.materials,a=0;a<r.length;a++){var _=r[a];if(_.render_above_all&&"OPAQUE"!=_.blend_mode&&"CLIP"!=_.blend_mode&&"ALPHA_ANTIALIASING"!=_.blend_mode)return!0}return!1}function Te(e,t){switch(e.b4w_enable_anchors_visibility){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++){var a=t[r]._object;if(a.anchor&&a.anchor.detect_visibility)return!0}return!1}}function ue(e,t){if(e&&e._render&&e._render.graph){var r=e._render.graph,a=Ft.find_subs(e._render.graph,Kt.SKY);if(a){var _=null;if(Ft.traverse_slinks(r,function(e,t,r,a){if("CUBEMAP"==e.from&&r.type==Kt.SKY&&a.type==Kt.SINK)return _=e.texture,!0}),_){var n=zt.cubemap_tex_size,o=Ot.get_batch_by_type(t,"SKY",e);if(o&&o.has_nodes){var i=Lt.get_ngraph_proxy_cached(o.ngraph_proxy_id),s=i.graph,c=Lt.get_max_env_texture_height(s);-1!=c&&(n=yt.calc_pot_size(c/2))}else{var E=e._render,l=E.world_light_set,T=l.sky_texture_param;T&&(n=T.tex_size)}n=Math.min(n,Ht.max_cube_map_texture_size),a.camera.width=n,a.camera.height=n,Bt.set_cubemap_tex_size(_,n),de(e,n);var u=Ft.find_subs(e._render.graph,Kt.IRRADIANCE);if(u){u.camera.width=32,u.camera.height=32;var d=null;Ft.traverse_slinks(r,function(e,t,r,a){if("CUBEMAP"==e.from&&r.type==Kt.IRRADIANCE&&a.type==Kt.MAIN_OPAQUE)return d=e.texture,!0}),d&&Bt.set_cubemap_tex_size(d,32)}var f=Ft.find_subs(e._render.graph,Kt.ROUGHNESS_CONVOLUTION);if(f){f.camera.width=128,f.camera.height=128;var P=null;Ft.traverse_slinks(r,function(e,t,r,a){if("CUBEMAP"==e.from&&r.type==Kt.ROUGHNESS_CONVOLUTION&&a.type==Kt.MAIN_OPAQUE)return P=e.texture,!0}),P&&Bt.set_cubemap_tex_size(P,128)}}}}}function de(e,t){for(var r=et(e,[Kt.MAIN_OPAQUE,Kt.MAIN_BLEND,Kt.MAIN_GLOW]),a=0;a<r.length;a++)r[a].bsdf_cube_sky_dim=t}function fe(e,t){for(var r=e.scenes_data,a=0;a<r.length;a++){var _=r[a].scene,n=_._render.graph,o=Ft.find_subs(_._render.graph,Kt.SKY);if(o){var i=null;if(Ft.traverse_slinks(n,function(e,t,r,a){if("CUBEMAP"==e.from&&r.type==Kt.SKY&&a.type==Kt.IRRADIANCE)return i=e.texture,!0}),i){var s=yt.calc_pot_size(t.height/2);s=Math.min(s,Ht.max_cube_map_texture_size),o.camera.width=s,o.camera.height=s,Bt.set_cubemap_tex_size(i,s),de(_,s)}}}}function Pe(e,t,r,a,_){switch(e.type){case Kt.MAIN_OPAQUE:Ae(e,t,r,"OPAQUE",a,_);break;case Kt.MAIN_BLEND:Ae(e,t,r,"BLEND",a,_);break;case Kt.MAIN_XRAY:Ae(e,t,r,"XRAY",a,_);break;case Kt.MAIN_GLOW:Ae(e,t,r,"GLOW",a,_);break;case Kt.MAIN_PLANE_REFLECT:case Kt.MAIN_CUBE_REFLECT:he(e,t,r,!1,a,_);break;case Kt.MAIN_PLANE_REFLECT_BLEND:case Kt.MAIN_CUBE_REFLECT_BLEND:he(e,t,r,!0,a,_);break;case Kt.SHADOW_RECEIVE:Ne(e,t,r,a,_);break;case Kt.SHADOW_CAST:ge(e,t,r,a,_);break;case Kt.COLOR_PICKING:case Kt.COLOR_PICKING_XRAY:Ue(e,t,r,a,_);break;case Kt.OUTLINE_MASK:Fe(e,t,r,a,_);break;case Kt.GRASS_MAP:De(e,t,a,_);break;case Kt.DEBUG_VIEW:we(e,t,r,a,_)}}function Ae(e,t,r,a,_,n){for(var o=t.render,i=xt.get_scene_data(t,_),s=i.batches,c=0;c<s.length;c++){var E=s[c];if(!E.shadow_cast_only&&!E.reflexible_only&&(("MAIN"==E.type||"NODES_GLOW"==E.type||"PARTICLES"==E.type||"LINE"==E.type)&&("OPAQUE"==E.subtype&&"OPAQUE"==a||"BLEND"==E.subtype&&"BLEND"==a||"XRAY"==E.subtype&&"XRAY"==a||"NODES_GLOW"==E.type&&"GLOW"==a))){if(!n&&(pe(E,e,t,r,a,_),!Ot.update_shader(E))){if("DEBUG"!==Object(x.d)())continue;Ot.apply_shader(E,"error.glslv","error.glslf"),Ot.update_shader(E)}var l=Kt.init_bundle(E,o,i.batch_world_bounds[c]);Kt.append_draw_data(e,l),Ce(r,e,E,!1),me(E)}}}function Se(e){e.lod_settings.use_smoothing&&Ot.set_batch_directive(e,"USE_LOD_SMOOTHING",1)}function pe(e,t,r,a,_,n){var o=r.render,i=n._render,s=xt.get_scene_data(r,n),c="NO_SHADOWS",E=et(n,[Kt.SHADOW_CAST]);if(E.length&&e.shadow_receive){switch(_){case"OPAQUE":c="SHADOW_MAPPING_OPAQUE";break;case"BLEND":case"XRAY":c="SHADOW_MAPPING_BLEND";break;case"COLOR_ID":case"REFLECT":case"GLOW":c="NO_SHADOWS";break;case"SHADOW":c="SHADOW_MASK_GENERATION";break;default:mt.panic("Wrong subscene type")}for(var l=0;l<E.length;l++)Ot.assign_shadow_receive_dirs(e,n._render.shadow_params,E[l])}var T="NO_SOFT_SHADOWS";if(i.shadow_params&&i.shadow_params.soft_shadows)switch(jt.shadow_blur_samples){case"16x":T="POISSON_X_16";break;case"8x":T="POISSON_X_8";break;case"4x":T="POISSON_X_4"}var u=e.shaders_info;if(kt.set_directive(u,"SHADOW_USAGE",c),kt.set_directive(u,"POISSON_DISK_NUM",T),Se(e),e.dynamic_grass){var d=Ft.find_subs(a,Kt.GRASS_MAP);d&&Oe(e,d,o)}if(ve(u,t.camera),"SHADOW"!=e.type&&"COLOR_ID"!=_||e.has_nodes){var f=t.num_lights;kt.set_directive(u,"NUM_LIGHTS",f);var P=f%2==0?f/2:Math.floor(f/2)+1;kt.set_directive(u,"NUM_LFACTORS",P),kt.set_directive(u,"REFLECTION_PASS","REFL_PASS_NONE"),kt.set_directive(u,"SSAO_ONLY",0);var A=i.water_params;if(A&&(kt.set_directive(u,"WATER_EFFECTS",1),kt.set_directive(u,"WAVES_HEIGHT",kt.glsl_value(A.waves_height)),kt.set_directive(u,"WAVES_LENGTH",kt.glsl_value(A.waves_length)),kt.set_directive(u,"WATER_LEVEL",kt.glsl_value(A.water_level))),t.caustics&&e.caustics){kt.set_directive(u,"CAUSTICS",1);var S=i.shadow_params;if(S){for(var p=S.lamp_types,v=0,l=0;l<p.length;l++)"SUN"==p[l]&&(v=l);kt.set_directive(u,"SUN_NUM",v)}kt.set_directive(u,"CAUST_SCALE",kt.glsl_value(t.caust_scale)),kt.set_directive(u,"CAUST_SPEED",kt.glsl_value(t.caust_speed,2)),kt.set_directive(u,"CAUST_BRIGHT",kt.glsl_value(t.caust_brightness))}var m=s.cube_refl_subs,O=s.plane_refl_subs,N=Ft.find_subs(a,Kt.SKY),g=Ft.find_subs(a,Kt.IRRADIANCE),h=Ft.find_subs(a,Kt.ROUGHNESS_CONVOLUTION);if(-1!==e.texture_names.indexOf("u_mirrormap"))kt.set_directive(u,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(e.reflective&&g&&h&&!m&&!O.length){var R=g.camera.color_attachment;Ot.append_texture(e,R,"u_cube_irradiance");var I=h.camera.color_attachment;Ot.append_texture(e,I,"u_cube_r_convolution"),kt.set_directive(u,"REFLECTION_TYPE","REFL_PBR_STANDARD")}else if(!e.reflective||m||O.length||jt.quality==gt.P_LOW)if(e.reflective&&m){var b=m.camera.color_attachment;i.reflection_params.has_reflexible||(m.force_do_not_render=!0,N&&(b=N.camera.color_attachment)),Ot.append_texture(e,b,"u_cube_reflection"),kt.set_directive(u,"REFLECTION_TYPE","REFL_CUBE")}else if(e.reflective&&O)for(var l=0;l<O.length;l++){var b=O[l].camera.color_attachment;Ot.append_texture(e,b,"u_plane_reflection"),kt.set_directive(u,"REFLECTION_TYPE","REFL_PLANE")}else kt.set_directive(u,"REFLECTION_TYPE","REFL_NONE");else if(N){var Y=N.camera.color_attachment;Ot.append_texture(e,Y,"u_sky_reflection"),kt.set_directive(u,"REFLECTION_TYPE","REFL_PBR_SIMPLE")}else kt.set_directive(u,"REFLECTION_TYPE","REFL_NONE");if(N)if(e.draw_proc_sky){var b=N.camera.color_attachment;Ot.append_texture(e,b,"u_sky")}else N.procedural_skydome&&(e.cube_fog=N.cube_fog,kt.set_directive(u,"PROCEDURAL_FOG",1));else kt.set_directive(u,"PROCEDURAL_FOG",0);var L=i.world_light_set;if(L.use_environment_light)if(kt.set_directive(u,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==L.environment_color){if(L.environment_texture_slot){var M=L.environment_texture_slot.texture,b=Bt.get_batch_texture(L.environment_texture_slot);Ot.append_texture(e,b,"u_sky_texture",M.name)}else if(N){var b=N.camera.color_attachment;Ot.append_texture(e,b,"u_sky_texture")}kt.set_directive(u,"SKY_TEXTURE",1)}else"SKY_COLOR"==L.environment_color&&kt.set_directive(u,"SKY_COLOR",1);var y=i.world_fog_set;if(y.use_fog&&(kt.set_directive(u,"USE_FOG",1),kt.set_directive(u,"FOG_TYPE",y.falloff)),e.refractive&&e.blend?(jt.depth_tex_available&&kt.set_directive(u,"USE_REFRACTION_CORRECTION",1),"MAIN"==e.type&&e.has_nodes||"NODES_GLOW"==e.type?(kt.set_directive(u,"REFRACTIVE",1),i.refractions?kt.set_directive(u,"USE_REFRACTION",1):kt.set_directive(u,"USE_REFRACTION",0)):i.refractions?kt.set_directive(u,"REFRACTIVE",1):kt.set_directive(u,"REFRACTIVE",0),(i.materials_params.refractions||i.refractions)&&kt.set_directive(u,"HAS_REFRACT_TEXTURE",1)):(kt.set_directive(u,"REFRACTIVE",0),kt.set_directive(u,"USE_REFRACTION",0),kt.set_directive(u,"USE_REFRACTION_CORRECTION",0)),e.water&&(jt.shore_smoothing&&e.water_shore_smoothing&&Ft.find_subs(a,Kt.DEPTH_PACK)?kt.set_directive(u,"SHORE_SMOOTHING",1):kt.set_directive(u,"SHORE_SMOOTHING",0),e.water_dynamic&&A&&A.waves_height?kt.set_directive(u,"DYNAMIC",1):kt.set_directive(u,"DYNAMIC",0)),"PARTICLES"==e.type&&kt.set_directive(u,"COLOR_RAMP_LENGTH",e.particles_data.color_ramp_length),!e.forked_batch)for(var x=e.textures,U=0;U<x.length;U++){var b=x[U];if("SCENE"==b.source)for(var w=0;w<rr.length;w++)for(var C=rr[w],D=rr[w]._render_to_textures,F=0;F<D.length;F++)D[F]==b&&It.append_edge_attr(ar,C,n,null)}}}function ve(e,t){t.type==Nt.TYPE_ORTHO||t.type==Nt.TYPE_ORTHO_ASPECT||t.type==Nt.TYPE_ORTHO_ASYMMETRIC?kt.set_directive(e,"CAMERA_TYPE","CAM_TYPE_ORTHO"):kt.set_directive(e,"CAMERA_TYPE","CAM_TYPE_PERSP")}function me(e){e.textures.length>$t&&Ct.warn(e.type,"too many textures used - "+e.textures.length+" (max "+$t+'), materials "'+e.material_names.join(", ")+'"')}function Oe(e,t,r){e.grass_map_dim=t.grass_map_dim;var a=t.grass_map_dim[0],_=t.grass_map_dim[1],n=t.grass_map_dim[2],o=r.bb_local,i=Math.max(o.max_x-o.min_x,o.max_y-o.min_y);n=0==n?i:Math.max(n,i),t.grass_map_dim[2]=n;var s=t.camera;Nt.set_frustum2(s,n/2,n/2,-_,-a),Nt.set_projection(s,!1);var c=e.grass_size||0;c=0==c?i:Math.max(c,i),e.grass_size=c}function Ne(e,t,r,a,_){for(var n=xt.get_scene_data(t,a),o=n.batches,i=0;i<o.length;i++){var s=o[i];if("SHADOW"==s.type&&"RECEIVE"==s.subtype&&s.shadow_receive&&(_||(pe(s,e,t,r,"SHADOW",a),Ot.update_shader(s)))){var c=Kt.init_bundle(s,t.render,n.batch_world_bounds[i]);Kt.append_draw_data(e,c),Ce(r,e,s,!1),me(s)}}}function ge(e,t,r,a,_){for(var n=!1,o=t.render,i=xt.get_scene_data(t,a),s=i.batches,c=Ft.find_subs(r,Kt.GRASS_MAP),E=0;E<s.length;E++){var l=s[E];if("SHADOW"==l.type&&"CAST"==l.subtype){if(n=!0,!_){Se(l);var T=e.num_lights;Ot.set_batch_directive(l,"NUM_LIGHTS",T);var u=T%2==0?T/2:Math.floor(T/2)+1;if(Ot.set_batch_directive(l,"NUM_LFACTORS",u),ve(l.shaders_info,e.camera),kt.set_directive(l.shaders_info,"SHADOW_USAGE","SHADOW_CASTING"),l.dynamic_grass&&c&&Oe(l,c,o),Ot.set_batch_directive(l,"SHADOW_TEX_RES",kt.glsl_value(a._render.shadow_params.csm_resolution)),!Ot.update_shader(l))continue}l.dynamic_grass&&(a._render.shadow_params.dynamic_grass_cast=!0);var d=Kt.init_bundle(l,o,i.batch_world_bounds[E]);Kt.append_draw_data(e,d),Ce(r,e,l,!1),me(l)}}if(n){var f=a._render.shadow_params;Ye(e,a,Ft.find_subs(r,Kt.MAIN_OPAQUE).camera,f,!0)}}function he(e,t,r,a,_,n){for(var o=t.render,i=xt.get_scene_data(t,_),s=i.batches,c=0;c<s.length;c++){var E=s[c];if(("MAIN"==E.type||"PARTICLES"==E.type||"LINE"==E.type)&&("REFLECT"==E.subtype&&E.blend==a)){if(e.type==Kt.MAIN_PLANE_REFLECT||e.type==Kt.MAIN_PLANE_REFLECT_BLEND){var l=pt(_,e);if(l==o.plane_reflection_id)continue}else{var l=vt(_,e);if(l==o.cube_reflection_id)continue}if(!n){pe(E,e,t,r,"REFLECT",_);var T=E.shaders_info;if(kt.set_directive(T,"WATER_EFFECTS",0),e.type==Kt.MAIN_PLANE_REFLECT||e.type==Kt.MAIN_PLANE_REFLECT_BLEND?kt.set_directive(T,"REFLECTION_PASS","REFL_PASS_PLANE"):kt.set_directive(T,"REFLECTION_PASS","REFL_PASS_CUBE"),kt.set_directive(T,"TEXTURE_NORM",0),!Ot.update_shader(E)){if("DEBUG"!==Object(x.d)())continue;Ot.apply_shader(E,"error.glslv","error.glslf"),Ot.update_shader(E)}}if(!Kt.find_bundle(e,E,o)){var u=Kt.init_bundle(E,o,i.batch_world_bounds[c]);Kt.append_draw_data(e,u),Ce(r,e,E,!1),me(E)}}}}function Re(e){e._render.need_shadow_update=!0}function Ie(e){Xe(e);var t=tt(e,Kt.MAIN_OPAQUE),r=e._render.graph,a=!0,_=e._render.shadow_params;It.traverse(r,function(r,n){var o=n;o.type===Kt.SHADOW_CAST&&(Ye(o,e,t.camera,_,a),a=!1)})}function be(e){var t=e._render.graph;It.traverse(t,function(e,t){t.type===Kt.OUTLINE&&(t.draw_outline_flag=1)})}function Ye(e,t,r,a,_){if(0!=e.draw_data.length){var n=e.camera;if(Y.a(r.world_tsr,n.world_tsr),Y.a(r.view_tsr,n.shadow_cast_billboard_view_tsr),"SUN"===a.lamp_types[e.shadow_lamp_index]||"HEMI"===a.lamp_types[e.shadow_lamp_index]){var o=ye(e,r.world_tsr,Sr),s=i.F(o,Pr);if(L._28(s,n.view_matrix,s),a.enable_csm){var c=M.copy(r.csm_centers[e.csm_index],Tr),E=f.invert(r.view_matrix,fr);L._28(c,E,c),L._28(c,n.view_matrix,c);var l=r.csm_radii[e.csm_index];if(_){vr=0,mr=-1/0;for(var T=2;T<s.length;T+=3)vr=Math.min(vr,s[T]),mr=Math.max(mr,s[T])}var u=Sr;u.max_x=c[0]+l,u.max_y=c[1]+l,u.max_z=mr,u.min_x=c[0]-l,u.min_y=c[1]-l,u.min_z=vr}else{var u=Sr,d=Le(s,u);if(d>0){var P=f.identity(fr);f.rotate(P,d,L.c,P),f.multiply(P,n.view_matrix,n.view_matrix),Y.d(n.view_matrix,n.view_tsr)}u=Me(u),gr(e,t._render.graph)}Nt.set_frustum_asymmetric(n,u.min_x,u.max_x,u.min_y,u.max_y,-u.max_z,-u.min_z),Nt.set_projection(n,!1)}else"SPOT"!==a.lamp_types[e.shadow_lamp_index]&&"POINT"!==a.lamp_types[e.shadow_lamp_index]||Nt.set_projection(n,!1)}}function Le(e,t){var r=Ar;r.set(e);var a=or/(ir-1),_=f.identity(fr);f.rotate(_,a,L.c,_);for(var n=-1,o=-1,s=0;s<ir;s++){var c=i.a(r,0,r.length,pr),E=(c.max_x-c.min_x)*(c.max_y-c.min_y);(-1==n||n-E>sr)&&(n=E,o=s,i.o(c,t)),L._28(r,_,r)}return o*a}function Me(e){var t=e.max_x-e.min_x,r=e.max_y-e.min_y;if(t&&r){var a=Math.abs(t-r)/2;t/r>nr?(e.max_y+=a,e.min_y-=a):r/t>nr&&(e.max_x+=a,e.min_x-=a)}return e.max_x+=cr,e.max_y+=cr,e.max_z+=Er,e.min_x-=cr,e.min_y-=cr,e.min_z-=Er,e}function ye(e,t,r){i.P(r);for(var a=0;a<e.draw_data.length;a++)for(var _=e.draw_data[a].bundles,n=0;n<_.length;n++){var o=_[n].batch,s=_[n].obj_render;if(o.dynamic_grass){var c=Y.g(t,dr),E=M.transformQuat(L.c,c,ur),l=-E[0],T=E[1],u=Y.j(t,ur),d=u[0]-o.grass_size*(1+l)/2,f=u[1]-o.grass_size*(1-T)/2,P=i.h(o.bounds_local.bb,s.world_tsr,pr),A=P.max_z-P.min_z,S=pr;S.min_x=d,S.min_y=f,S.min_z=o.grass_map_dim[0]-A,S.max_x=d+o.grass_size,S.max_y=f+o.grass_size,S.max_z=o.grass_map_dim[1]+A}else var S=s.bb_world;0==a&&0==n?i.o(S,r):i.D(r,S)}return r}function xe(e,t){for(var r=e._render.shadow_params,a=new Float32Array(r.csm_num),_=0;_<r.csm_num;_++)a[_]=Nt.csm_far_plane(r,t,_);return a}function Ue(e,t,r,a,_){for(var n=t.render,o=xt.get_scene_data(t,a),i=o.batches,s=0;s<i.length;s++){var c=i[s];if("COLOR_ID"==c.type&&((e.type==Kt.COLOR_PICKING&&"COLOR_ID"==c.subtype||e.type==Kt.COLOR_PICKING_XRAY&&"COLOR_ID_XRAY"==c.subtype)&&(_||(pe(c,e,t,r,"COLOR_ID",a),Ot.set_batch_directive(c,"USE_OUTLINE",0),Ot.update_shader(c))))){var E=Kt.init_bundle(c,n,o.batch_world_bounds[s]);Kt.append_draw_data(e,E)}}}function we(e,t,r,a,_){for(var n=t.render,o=xt.get_scene_data(t,a),i=o.batches,s=0;s<i.length;s++){var c=i[s];if("DEBUG_VIEW"==c.type){if(!_){if(c.dynamic_grass){var E=Ft.find_subs(r,Kt.GRASS_MAP);E&&Oe(c,E,n)}if(!Ot.update_shader(c)){if("DEBUG"!==Object(x.d)())return;Ot.apply_shader(c,"error.glslv","error.glslf"),Ot.update_shader(c)}}var l=Kt.init_bundle(c,n,o.batch_world_bounds[s]);Kt.append_draw_data(e,l),Ce(r,e,c,!1),me(c)}}}function Ce(e,t,r,a){var _=It.node_by_attr(e,t);It.traverse_inputs(e,_,function(e,t,_){var n=_,o=t;if(n.active){switch(n.from){case"COLOR":case"CUBEMAP":var i=o.camera.color_attachment;break;case"DEPTH":var i=o.camera.depth_attachment;break;case"SCREEN":var i=null;break;case Kt.MAIN_CUBE_REFLECT:return;default:mt.panic("Wrong slink")}switch(n.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"u_cube_reflection":case"u_plane_reflection":break;default:if(!i){if(a)return;mt.panic("Connection of SCREEN is forbidden")}i.w_renderbuffer&&mt.panic("Batch texture can't use renderbuffer"),kt.check_uniform(r.shader,n.to)&&(a?Ot.replace_texture(r,i,n.to):Ot.append_texture(r,i,n.to))}}});for(var n=0;n<t.slinks_internal.length;n++){var o=t.slinks_internal[n],i=t.textures_internal[n];switch(o.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":break;default:i.w_renderbuffer&&mt.panic("Batch texture can't use renderbuffer"),kt.check_uniform(r.shader,o.to)&&(a?Ot.replace_texture(r,i,o.to):Ot.append_texture(r,i,o.to))}}}function De(e,t,r,a){for(var _=t.render,n=xt.get_scene_data(t,r),o=n.batches,i=0;i<o.length;i++){var s=o[i];if("GRASS_MAP"==s.type){if(!a&&!Ot.update_shader(s)){if("DEBUG"!==Object(x.d)())continue;Ot.apply_shader(s,"error.glslv","error.glslf"),Ot.update_shader(s)}var c=Kt.init_bundle(s,_,n.batch_world_bounds[i]);Kt.append_draw_data(e,c);var E=e.camera,l=_.bb_world,T=e.grass_map_dim[0],u=e.grass_map_dim[1],d=e.grass_map_dim[2];0==T&&0==u?(T=l.min_z,u=l.max_z):(T=Math.min(T,l.min_z),u=Math.max(u,l.max_z));var f=(u-T)*_r;T-=f,u+=f,e.grass_map_dim[0]=T,e.grass_map_dim[1]=u,Nt.set_frustum2(E,d/2,d/2,-u,-T),Nt.set_projection(E,!1)}}}function Fe(e,t,r,a,_){for(var n=t.render,o=xt.get_scene_data(t,a),i=o.batches,s=0;s<i.length;s++){var c=i[s];if("COLOR_ID"==c.type&&("OUTLINE"==c.subtype&&(_||(pe(c,e,t,r,"COLOR_ID",a),Ot.set_batch_directive(c,"USE_OUTLINE",1),Ot.update_shader(c))))){var E=Kt.init_bundle(c,n,o.batch_world_bounds[s]);Kt.append_draw_data(e,E)}}}function Ge(e,t){ke(e,t);for(var r=0;r<e.cons_descends.length;r++)e.cons_descends[r].parent==e&&Ge(e.cons_descends[r],t)}function ke(e,t){if(e.render.hide=t,xt.is_lamp(e))for(var r=0;r<e.scenes_data.length;r++)for(var a=e.scenes_data[r],_=a.scene,n=et(_,Vt),o=0;o<n.length;o++)Be(e,a,n[o])}function Ke(e,t){for(var r=e.light,a=xt.get_scene_data(e,t),_=a.light_index,n=et(t,Vt),o=0;o<n.length;o++){var i=n[o];i.light_color_intensities.set(r.color_intensity,4*_),i.need_perm_uniforms_update=!0}}function Be(e,t,r){var a=e.render,_=e.light,n=t.light_index,o=_.use_diffuse&&!a.hide?1:0;r.light_positions[4*n+3]=o,o=_.use_specular&&!a.hide?1:0,r.light_color_intensities[4*n+3]=o,r.need_perm_uniforms_update=!0}function Xe(e){var t=Mt.get_scene_objs(e,"LAMP",Mt.DATA_ID_ALL),r=jt.ssao&&e.b4w_enable_ssao,a=xt.get_shadow_lamps(t,r);if(a.length)for(var _=0;_<a.length;_++)for(var n=a[_],o=n.render,i=Y.j(o.world_tsr,Tr),s=Y.g(o.world_tsr,dr),c=0;c<n.scenes_data.length;c++){var E=n.scenes_data[c],l=E.shadow_subscenes;if(E.scene==e)for(var T=0;T<l.length;T++){var u=l[T],d=u.camera;Nt.set_view_trans_quat(d,i,s)}}}function je(e){var t=tt(e,Kt.SKY);t&&He(e,t)}function He(e,t){if(Ut.prerender_subs(t),Dt.draw(t),t.need_fog_update)for(var r=et(e,Wt),a=0;a<r.length;a++)for(var _=r[a].draw_data,n=0;n<_.length;n++)for(var o=_[n].bundles,i=0;i<o.length;i++){var s=o[i];if(s.do_render){var c=s.batch;Ot.check_batch_perm_uniform(c,"u_cube_fog")&&Dt.update_batch_permanent_uniform(c,"u_cube_fog")}}Qe(e)}function Qe(e){var t=tt(e,Kt.IRRADIANCE);t&&(Ut.prerender_subs(t),Dt.draw(t));var r=tt(e,Kt.ROUGHNESS_CONVOLUTION);r&&(Ut.prerender_subs(r),Dt.draw(r));var a=tt(e,Kt.BRDF);a&&(Ut.prerender_subs(a),Dt.draw(a))}function ze(e){var t=e.camera;Dt.render_target_cleanup(t.framebuffer,t.color_attachment,t.depth_attachment,t.width,t.height);for(var r=e.draw_data,a=0;a<r.length;a++)for(var _=r[a].bundles,n=0;n<_.length;n++){var o=_[n].batch;o&&Ot.clear_batch(o)}}function qe(e){for(var t=[],r=0;r<e.length;r++)for(var a=e[r]._object.materials,_=0;_<a.length;_++){var n=a[_];-1==t.indexOf(n)&&t.push(n)}return t}function Ve(e,t,r){ht.setup_viewport_dim(e,t,r),tr&&Ze(tr,e,t)}function We(e,t,a,_){var n=t,o=a;ht.is_hidpi()&&(n*=window.devicePixelRatio,o*=window.devicePixelRatio);var i=r();if(i){var s=i._render;n*=s.resolution_factor,o*=s.resolution_factor}return n*=e.size_mult_x,o*=e.size_mult_y,_[0]=Math.floor(n),_[1]=Math.floor(o),_}function Je(e,t,r){var a=We(e,t,r,lr);return a[0]>Ht.max_texture_size||a[1]>Ht.max_texture_size?(Ct.warn("Texture size exceeds platform limits, downscaling"),Math.min(Ht.max_texture_size/a[0],Ht.max_texture_size/a[0])):1}function Ze(e,t,r){var a=e._render,_=xt.get_scene_data(e._camera,e),n=_.cameras;if(0!=r)var o=t/r;else var o=1;for(var i=0;i<n.length;i++){var s=n[i];Nt.set_aspect(s,o),Nt.set_projection(s,!1),a.shadow_params&&Nt.update_camera_shadows(s,a.shadow_params)}if(a.shadow_params){a.need_shadow_update=!0;for(var c=et(e,[Kt.SHADOW_RECEIVE]),i=0;i<c.length;i++)c[i].need_perm_uniforms_update=!0;for(var E=et(e,[Kt.MAIN_BLEND]),i=0;i<E.length;i++)E[i].need_perm_uniforms_update=!0}$e(e,t,r)}function $e(e,t,r){var a=e._render,_=a.graph,n=1/0;Ft.traverse_slinks(_,function(e,a,_,o){e.update_dim&&(n=Math.min(n,Je(e,t,r)))}),Ft.traverse_slinks(_,function(a,o,i,s){if(a.update_dim){var c,E,l;if(s&&s.type==Kt.SINK||i.is_pp&&!a.apply_resolution_factors?(c=t*a.size_mult_x,E=r*a.size_mult_y):(l=We(a,t,r,lr),c=l[0]*n,E=l[1]*n),o)for(var T=0;T<i.slinks_internal.length;T++){var u=i.slinks_internal[T];u==a&&Bt.resize(a.texture,c,E)}else{Bt.is_texture(a.texture)&&(Bt.resize(a.texture,c,E),a.texture.use_mipmap&&(s.last_mip_map_ind=a.texture.mipmap_count));var d=i.camera;switch(d.width=c,d.height=E,i.type){case Kt.DOF:_t(e,{dof_power:i.camera.dof_power});break;case Kt.GLOW_COMBINE:it(e,{small_glow_mask_width:i.small_glow_mask_width,large_glow_mask_width:i.large_glow_mask_width});break;case Kt.BLOOM:ot(e,{blur:i.bloom_blur});break;case Kt.RESIZE:d.width=d.color_attachment.width,d.height=d.color_attachment.height;break;case Kt.OUTLINE:var f=Ft.find_input(_,i,Kt.POSTPROCESSING),P=Ft.find_input(_,f,Kt.POSTPROCESSING),A=Ft.find_input(_,P,Kt.POSTPROCESSING),S=Ft.find_input(_,A,Kt.POSTPROCESSING);Ft.set_texel_size(f,1/c,1/c),Ft.set_texel_size(P,1/c,1/c),Ft.set_texel_size(A,1/c,1/c),Ft.set_texel_size(S,1/c,1/c);break;default:Ft.set_texel_size(i,1/c,1/E)}}}})}function et(e,t){for(var r=[],a=0;a<t.length;a++){var _=t[a];e._render.graph&&It.traverse(e._render.graph,function(e,t){var a=t;a.type==_&&r.push(a)})}return r}function tt(e,t){var r=e._render.graph;return Ft.find_subs(r,t)}function rt(e){var t=r();if(t){var a=t._render.graph;It.traverse(a,function(t,r){var a=r,_=a.camera;_&&_.type==Nt.TYPE_HMD_RIGHT&&(a.force_do_not_render=e)})}}function at(e,t,r,a){for(var _=et(e,Vt),n=0;n<_.length;n++){var o=_[n];o.horizon_color.set(r),o.zenith_color.set(a),o.environment_energy=t,o.need_perm_uniforms_update=!0}var i=Ft.find_subs(e._render.graph,Kt.SKY);i&&He(e,i)}function _t(e,t){var r=et(e,[Kt.DOF]);if(!r.length)return Ct.error("DOF is not enabled on the scene. Check camera settings"),0;for(var a=0;a<r.length;a++)nt(r[a],t,e)}function nt(e,t,r){var a=e.dof_bokeh,_=a?et(r,[Kt.COC]):[],n=r._render.graph;if("boolean"==typeof t.dof_on&&(e.camera.dof_on=t.dof_on,a))for(var o=0;o<_.length;o++)_[o].camera.dof_on=t.dof_on;if("number"==typeof t.dof_distance&&(e.camera.dof_distance=t.dof_distance,a))for(var o=0;o<_.length;o++)_[o].camera.dof_distance=t.dof_distance;if("number"==typeof t.dof_front_start&&(e.camera.dof_front_start=t.dof_front_start,a))for(var o=0;o<_.length;o++)_[o].camera.dof_front_start=t.dof_front_start;if("number"==typeof t.dof_front_end&&(e.camera.dof_front_end=t.dof_front_end,a))for(var o=0;o<_.length;o++)_[o].camera.dof_front_end=t.dof_front_end;if("number"==typeof t.dof_rear_start&&(e.camera.dof_rear_start=t.dof_rear_start,a))for(var o=0;o<_.length;o++)_[o].camera.dof_rear_start=t.dof_rear_start;if("number"==typeof t.dof_rear_end&&(e.camera.dof_rear_end=t.dof_rear_end,a))for(var o=0;o<_.length;o++)_[o].camera.dof_rear_end=t.dof_rear_end;if("number"==typeof t.dof_bokeh_intensity&&(e.camera.dof_bokeh_intensity=t.dof_bokeh_intensity,a)){var i=Ft.get_inputs_by_type(n,e,Kt.POSTPROCESSING);i[0].camera.dof_bokeh_intensity=t.dof_bokeh_intensity,i[1].camera.dof_bokeh_intensity=t.dof_bokeh_intensity,i[0]=Ft.find_input(n,i[0],Kt.POSTPROCESSING),i[0].camera.dof_bokeh_intensity=t.dof_bokeh_intensity}if("number"==typeof t.dof_power)if(a){var s=t.dof_power;e.camera.dof_power=s,s/=2;var c=e.camera.width,E=e.camera.height,l=[1/c,0],T=[1/c*.5,1/E*.866],u=[-1/c*.5,1/E*.866],i=Ft.get_inputs_by_type(n,e,Kt.POSTPROCESSING);Ft.set_texel_size_mult(i[0],s),Ft.set_texel_size(i[0],u[0],u[1]),Ft.set_texel_size_mult(i[1],s),Ft.set_texel_size(i[1],T[0],T[1]),i[0]=Ft.find_input(n,i[0],Kt.POSTPROCESSING),Ft.set_texel_size_mult(i[0],s),Ft.set_texel_size(i[0],l[0],l[1]),e.camera.dof_foreground_blur&&(i[0]=Ft.find_input(n,i[0],Kt.COC),i[0]=Ft.find_input(n,i[0],Kt.POSTPROCESSING),Ft.set_texel_size(i[0],1/c,1/E),i[0]=Ft.find_input(n,i[0],Kt.POSTPROCESSING),Ft.set_texel_size(i[0],1/c,1/E))}else{e.camera.dof_power=t.dof_power;var d=Ft.find_input(n,e,Kt.POSTPROCESSING),f=Ft.find_input(n,d,Kt.POSTPROCESSING);Ft.set_texel_size_mult(d,e.camera.dof_power),Ft.set_texel_size(d,1/e.camera.width,1/e.camera.height),Ft.set_texel_size_mult(f,e.camera.dof_power),Ft.set_texel_size(f,1/e.camera.width,1/e.camera.height)}}function ot(e,t){var r=et(e,[Kt.LUMINANCE_TRUNCED]),a=et(e,[Kt.BLOOM]);if(!r.length||!a.length)return Ct.error("Bloom is not enabled on the scene"),0;if("number"==typeof t.key)for(var _=0;_<r.length;_++)r[_].bloom_key=t.key,r[_].need_perm_uniforms_update=!0;if("number"==typeof t.edge_lum)for(var _=0;_<r.length;_++)r[_].bloom_edge_lum=t.edge_lum,r[_].need_perm_uniforms_update=!0;if("number"==typeof t.blur)for(var _=0;_<a.length;_++){a[_].bloom_blur=t.blur;for(var n=e._render.graph,o=a[_].camera.width/.5,i=a[_].camera.height/.5,s=Ft.get_inputs_by_type(n,a[_],Kt.POSTPROCESSING),c=0;c<s.length;++c){var E=s[c],l=Ft.find_input(n,E,Kt.POSTPROCESSING),T=o*E.bloom_blur_scale,u=i*E.bloom_blur_scale;Ft.set_texel_size_mult(E,t.blur),Ft.set_texel_size(E,1/T,1/u),Ft.set_texel_size_mult(l,t.blur),Ft.set_texel_size(l,1/T,1/u)}}if("number"==typeof t.average_luminance)for(var _=0;_<r.length;_++)r[_].adaptive_bloom||(r[_].average_luminance=t.average_luminance,r[_].need_perm_uniforms_update=!0)}function it(e,t){var r=et(e,[Kt.GLOW_COMBINE]);if(!r.length)return Ct.error("Glow is not enabled on the scene"),null;for(var a=0;a<r.length;a++)st(r[a],t,e)}function st(e,t,r){for(var a=r._render.graph,_=Ft.get_inputs(a,e),n=0;n<_.length;++n){var o=_[n];if(o.type==Kt.POSTPROCESSING&&"GLOW_MASK_LARGE"==o.subtype)var i=o;if(o.type==Kt.POSTPROCESSING&&"GLOW_MASK_SMALL"==o.subtype)var s=o}var c=Ft.find_input(a,i,Kt.POSTPROCESSING),E=Ft.find_input(a,s,Kt.POSTPROCESSING);"number"==typeof t.small_glow_mask_coeff&&(e.small_glow_mask_coeff=t.small_glow_mask_coeff,e.need_perm_uniforms_update=!0),"number"==typeof t.large_glow_mask_coeff&&(e.large_glow_mask_coeff=t.large_glow_mask_coeff,e.need_perm_uniforms_update=!0),"number"==typeof t.small_glow_mask_width&&(e.small_glow_mask_width=t.small_glow_mask_width,Ft.set_texel_size_mult(s,t.small_glow_mask_width),Ft.set_texel_size(s,1/e.camera.width,1/e.camera.height),s.need_perm_uniforms_update=!0,Ft.set_texel_size_mult(E,t.small_glow_mask_width),Ft.set_texel_size(E,1/e.camera.width,1/e.camera.height),E.need_perm_uniforms_update=!0),"number"==typeof t.large_glow_mask_width&&(e.large_glow_mask_width=t.large_glow_mask_width,Ft.set_texel_size_mult(i,t.large_glow_mask_width),Ft.set_texel_size(i,1/e.camera.width,1/e.camera.height),i.need_perm_uniforms_update=!0,Ft.set_texel_size_mult(c,t.large_glow_mask_width),Ft.set_texel_size(c,1/e.camera.width,1/e.camera.height),c.need_perm_uniforms_update=!0)}function ct(e){e._render.need_grass_map_update=!0}function Et(e,t,r){var a=e._render,_=a.water_params;if(!_.dynamic)return _.water_level;var n=_.waves_height,o=_.waves_length,i=_.water_level,s=M.length(a.wind)||1,c=tt(e,Kt.MAIN_OPAQUE),E=c.time;E*=s;var l=lr;l[0]=20/o*(t-.25*E),l[1]=20/o*(r-.25*E);var T=L.J(l);l[0]=17/o*(r+.1*E),l[1]=17/o*(t+.1*E);var u=L.J(l),d=T+u-1,f=_.dst_noise_scale0,P=_.dst_noise_scale1,A=_.dst_noise_freq0,S=_.dst_noise_freq1,p=lr;p[0]=f*(t+A*E),p[1]=f*(r+A*E);var v=L._55(p);p[0]=P*(r-S*E),p[1]=P*(t-S*E);var m=L._55(p),O=n*v*m;if(_.shoremap_image){var N=_.shoremap_size[0],g=_.shoremap_size[1],h=_.shoremap_center[0],R=_.shoremap_center[1],I=(t-h)/N,b=(R+r)/g;if(I+=.5,b+=.5,I>1||I<0||b>1||b<0)var Y=O;else{var y=_.shoremap_tex_size,x=a.shore_distances,U=L._7(x,y,I,b),w=_.dir_min_shore_fac,C=_.dir_freq,D=_.dir_noise_scale,F=_.dir_noise_freq,G=_.dir_min_noise_fac,k=_.dst_min_fac,K=_.max_shore_dist,B=o/K/Math.PI,X=[D/o*(t+F*E),D/o*(r+F*E)],j=Math.sqrt(U),H=n*Math.max(U,w)*Math.sin(j/B+C*E)*Math.max(L._55(X),G),Q=Math.max(j,k),Y=H*(1-Q)+O*Q;d*=U}}else var Y=O;return Y+=.05*d,i+Y}function lt(e,t,r){t.is_for_outline&&t.type==Kt.POSTPROCESSING&&r.do_render!=t.do_render&&(t.do_render=r.do_render),r.do_render||t.type!=Kt.OUTLINE||(t.draw_outline_flag=0)}function Tt(e,t,r,a){var _=It.get_node_attr(e,t);Nt.set_attachment(_.camera,r,a),_.assign_texture=!0,It.traverse_outputs(e,t,function(t,_,n){var o=n;o.active&&o.from==r&&Ft.check_slink_tex_conn(o)&&ut(e,t,o.to,a)}),It.traverse_inputs(e,t,function(t,_,n){var o=n;o.active&&o.from==r&&o.from==o.to&&Tt(e,t,r,a)})}function ut(e,t,r,a){for(var _=It.get_node_attr(e,t),n=_.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var c=i[s].batch;Ot.replace_texture(c,a,r)}}function dt(e){for(var t=et(e,[Kt.GRASS_MAP]),r=0;r<t.length;r++){var a=t[r],_=a.camera,n=e._camera.render,o=Y.j(n.world_tsr,Tr),i=ur;i[0]=0,i[1]=0,i[2]=-a.grass_map_dim[2]/2;var s=Y.g(n.world_tsr,dr);M.transformQuat(i,s,i),i[0]+=o[0],i[1]+=o[1],i[2]=0,N.identity(s),Nt.set_view_trans_quat(_,i,s)}}function ft(e,t){It.traverse(e,function(r,a){var _=a;if(_.type==Kt.MOTION_BLUR){_.slinks_internal[0]&&_.textures_internal[0]||mt.panic("Wrong MOTION_BLUR subscene");var n=_.slinks_internal[0],o=_.textures_internal[0];_.textures_internal[0]=_.camera.color_attachment,It.traverse_outputs(e,r,function(t,r,a){var _=a;_.active&&ut(e,t,_.to,o)}),Tt(e,r,n.from,o),ut(e,r,n.to,_.textures_internal[0]),_.motion_blur_exp=Math.exp(-t/_.mb_factor)}})}function Pt(e){var t=e._render.graph;It.traverse(t,function(e,t){t.need_perm_uniforms_update=!0})}function At(e){for(var t=_(),r=et(t,[Kt.OUTLINE]),a=0;a<r.length;a++){var n=r[a];n.outline_color.set(e),n.need_perm_uniforms_update=!0}}function St(e){return e._render.wind}function pt(e,t){for(var r=e._render.reflection_params.plane_refl_subs,a=0;a<r.length;a++)for(var _=0;_<r[a].length;_++)if(r[a][_]==t)return a;for(var n=e._render.reflection_params.plane_refl_subs_blend,a=0;a<n.length;a++)for(var _=0;_<n[a].length;_++)if(n[a][_]==t)return a;return null}function vt(e,t){if(!e._render.reflection_params)return null;for(var r=e._render.reflection_params.cube_refl_subs,a=0;a<r.length;a++)if(r[a]==t)return a;for(var _=e._render.reflection_params.cube_refl_subs_blend,a=0;a<_.length;a++)if(_[a]==t)return a;return null}var mt=Object(n.a)(e),Ot=Object(o.a)(e),Nt=Object(s.a)(e),gt=Object(c.a)(e),ht=Object(E.a)(e),Rt=Object(l.a)(e),It=Object(T.a)(e),bt=Object(u.a)(e),Yt=Object(d.a)(e),Lt=Object(P.a)(e),Mt=Object(A.a)(e),yt=Object(S.a)(e),xt=Object(p.a)(e),Ut=Object(v.a)(e),wt=Object(m.a)(e),Ct=Object(O.a)(e),Dt=Object(g.a)(e),Ft=Object(h.a)(e),Gt=Object(R.a)(e),kt=Object(I.a)(e),Kt=Object(b.a)(e),Bt=Object(S.a)(e),Xt=gt.debug_subs,jt=gt.defaults,Ht=gt.context_limits,Qt=gt.outlining,zt=gt.scenes,qt=[Kt.GRASS_MAP,Kt.SHADOW_CAST,Kt.MAIN_OPAQUE,Kt.MAIN_BLEND,Kt.MAIN_XRAY,Kt.MAIN_GLOW,Kt.MAIN_PLANE_REFLECT,Kt.MAIN_CUBE_REFLECT,Kt.MAIN_PLANE_REFLECT_BLEND,Kt.MAIN_CUBE_REFLECT_BLEND,Kt.COLOR_PICKING,Kt.COLOR_PICKING_XRAY,Kt.SHADOW_RECEIVE,Kt.OUTLINE_MASK,Kt.DEBUG_VIEW];t.OBJECT_SUBSCENE_TYPES=qt;var Vt=[Kt.MAIN_OPAQUE,Kt.MAIN_BLEND,Kt.MAIN_XRAY,Kt.MAIN_GLOW,Kt.MAIN_PLANE_REFLECT,Kt.MAIN_CUBE_REFLECT,Kt.GOD_RAYS,Kt.GOD_RAYS_COMBINE,Kt.SKY,Kt.MAIN_PLANE_REFLECT_BLEND,Kt.MAIN_CUBE_REFLECT_BLEND,Kt.LUMINANCE_TRUNCED,Kt.SHADOW_RECEIVE,Kt.SHADOW_CAST,Kt.COLOR_PICKING,Kt.COLOR_PICKING_XRAY,Kt.OUTLINE_MASK],Wt=[Kt.MAIN_OPAQUE,Kt.SSAO,Kt.MAIN_BLEND,Kt.MAIN_XRAY,Kt.MAIN_GLOW,Kt.MAIN_PLANE_REFLECT,Kt.MAIN_CUBE_REFLECT,Kt.MAIN_PLANE_REFLECT_BLEND,Kt.MAIN_CUBE_REFLECT_BLEND],Jt=[Kt.SHADOW_CAST,Kt.MAIN_OPAQUE,Kt.MAIN_BLEND,Kt.MAIN_XRAY,Kt.MAIN_GLOW,Kt.MAIN_PLANE_REFLECT,Kt.MAIN_CUBE_REFLECT,Kt.MAIN_PLANE_REFLECT_BLEND,Kt.MAIN_CUBE_REFLECT_BLEND,Kt.COLOR_PICKING,Kt.COLOR_PICKING_XRAY,Kt.SHADOW_RECEIVE,Kt.GOD_RAYS,Kt.OUTLINE_MASK,Kt.DEBUG_VIEW],Zt=[Kt.MAIN_OPAQUE,Kt.MAIN_BLEND,Kt.MAIN_XRAY,Kt.MAIN_GLOW,Kt.MAIN_PLANE_REFLECT,Kt.MAIN_CUBE_REFLECT,Kt.MAIN_PLANE_REFLECT_BLEND,Kt.MAIN_CUBE_REFLECT_BLEND],$t=8,er=null,tr=null,rr=[],ar=null,_r=1e-4,nr=2,or=Math.PI/2,ir=10,sr=.1,cr=.005,Er=.005,lr=new Float32Array(2),Tr=new Float32Array(3),ur=new Float32Array(3),dr=new Float32Array(4),fr=(new Float32Array(4),new Float32Array(16)),Pr=new Float32Array(24),Ar=new Float32Array(24),Sr=i.w(),pr=i.w(),vr=0,mr=-1/0,Or=new Uint8Array(4);t.create_scene_render=function(){return{}},t.set_active=function(e){tr=e,Gt.set_active_scene(e)},t.prepare_rendering=function(e,t){var r=e._render,a=Ft.create_rendering_queue(r.graph);if(e==t){Ze(e,ht.get_viewport_width(),ht.get_viewport_height());for(var _=0;_<a.length;_++)e._render.queue.push(a[_])}else{var n=e._render_to_textures[0];Ze(e,n.source_size,n.source_size);for(var _=0;_<a.length;_++)t._render.queue.push(a[_])}for(var o=et(e,Jt),i=0;i<o.length;i++)o[i].wind.set(r.wind);for(var _=0;_<r.queue.length;_++)r.queue[_].type==Kt.SHADOW_CAST&&Dt.draw(r.queue[_])},t.get_main=r,t.find_main_scene=a,t.get_active=_,t.check_active=U,t.get_camera=function(e){return e._camera},t.get_all_scenes=w,t.get_rendered_scenes=function(){if(1==rr.length)return rr;for(var e=0;e<rr.length;e++){var t=rr[e]._render.graph;It.traverse(t,function(t,r){for(var a=r,_=a.draw_data,n=0;n<_.length;n++)for(var o=_[n].bundles,i=0;i<o.length;i++){for(var s=o[i],c=s.batch.textures,E=s.batch.bpy_tex_names,l=null,T=0;T<c.length;T++)if("SCENE"==c[T].source&&c[T].source_id==rr[e].name&&a.type!=Kt.COPY){Ct.error('Texture-scene loop detected. A scene is rendered to texture "'+E[T]+'" yet this texture belongs to the same scene.'),l=s.batch;break}if(l){var u=l.textures;l.textures=[],l.texture_names=[],Ot.update_batch_material_error(l,null),Ot.update_shader(l),Kt.append_draw_data(a,s);for(var T=0;T<u.length;T++){var d=u[T];yt.cleanup_unused(d)}}}})}for(var r=[],e=0;e<rr.length;e++){var a=rr[e];if(!a._render_to_textures.length){var _=It.node_by_attr(ar,a);It.enforce_acyclic(ar,_);var t=It.subgraph_node_conn(ar,_,It.BACKWARD_DIR);t=It.topsort(t),It.traverse(t,function(e,t){r.push(t)});break}}return r},t.update_scene_graph=C,t.append_scene=D,t.append_scene_vtex=function(e,t,r){for(var a=0;a<t.length;a++){var _=t[a]._render;_&&_.is_movie&&(_.vtex_data_id=r,e._render.video_textures.push(t[a]))}},t.get_graph=function(e){return e._render.graph},t.generate_auxiliary_batches=function(e,t){It.traverse(t,function(r,a){var _=a,n=null;switch(_.type){case Kt.POSTPROCESSING:n=Ot.create_postprocessing_batch(_.pp_effect);break;case Kt.SSAO:n=Ot.create_ssao_batch(_);break;case Kt.SSAO_BLUR:n=Ot.create_ssao_blur_batch(_);break;case Kt.DEPTH_PACK:n=Ot.create_depth_pack_batch();break;case Kt.GOD_RAYS:var o=_.water,i=_.steps_per_pass;n=Ot.create_god_rays_batch(_.pack,o,i);break;case Kt.GOD_RAYS_COMBINE:n=Ot.create_god_rays_combine_batch();break;case Kt.MOTION_BLUR:n=Ot.create_motion_blur_batch(_.mb_decay_threshold);break;case Kt.COC:n=Ot.create_coc_batch(_.coc_type);break;case Kt.DOF:n=Ot.create_dof_batch(_);var s=_.camera.dof_power;if(_.dof_bokeh){s/=2;var c=Ft.get_inputs_by_type(t,_,Kt.POSTPROCESSING);Ft.set_texel_size_mult(c[0],s),Ft.set_texel_size_mult(c[1],s),c[0]=Ft.find_input(t,c[0],Kt.POSTPROCESSING),Ft.set_texel_size_mult(c[0],s)}else{var E=Ft.find_input(t,_,Kt.POSTPROCESSING),l=Ft.find_input(t,E,Kt.POSTPROCESSING);Ft.set_texel_size_mult(E,s),Ft.set_texel_size_mult(l,s)}break;case Kt.OUTLINE:n=Ot.create_outline_batch();var T=Ft.find_input(t,_,Kt.POSTPROCESSING),u=Ft.find_input(t,T,Kt.POSTPROCESSING),d=Ft.find_input(t,u,Kt.POSTPROCESSING),f=Ft.find_input(t,d,Kt.POSTPROCESSING);Ft.set_texel_size_mult(u,_.blur_texel_size_mult),Ft.set_texel_size_mult(T,_.blur_texel_size_mult),Ft.set_texel_size_mult(f,_.ext_texel_size_mult*_.outline_factor),Ft.set_texel_size_mult(d,_.ext_texel_size_mult*_.outline_factor);break;case Kt.GLOW_COMBINE:n=Ot.create_glow_combine_batch();break;case Kt.COMPOSITING:n=Ot.create_compositing_batch();break;case Kt.ANTIALIASING:n=Ot.create_antialiasing_batch(_);break;case Kt.SMAA_RESOLVE:case Kt.SMAA_EDGE_DETECTION:case Kt.SMAA_BLENDING_WEIGHT_CALCULATION:case Kt.SMAA_NEIGHBORHOOD_BLENDING:n=Ot.create_smaa_batch(_.type);break;case Kt.STEREO:n=Ot.create_stereo_batch(_.subtype);break;case Kt.SKY:n=Ot.create_cube_sky_batch(e,_);break;case Kt.IRRADIANCE:n=Ot.create_cube_irradiance_batch(e,_);break;case Kt.ROUGHNESS_CONVOLUTION:n=Ot.create_cube_roughness_convolution_batch(e,_);break;case Kt.BRDF:n=Ot.create_brdf_batch(e,_);break;case Kt.LUMINANCE:n=Ot.create_luminance_batch();break;case Kt.AVERAGE_LUMINANCE:n=Ot.create_average_luminance_batch();break;case Kt.LUMINANCE_TRUNCED:n=Ot.create_luminance_truncated_batch(_.adaptive_bloom);break;case Kt.BLOOM:n=Ot.create_bloom_combine_batch(_.bloom_blur_num);break;case Kt.RESIZE:n=Ot.create_postprocessing_batch("NONE");break;case Kt.VELOCITY:n=Ot.create_velocity_batch();break;case Kt.ANCHOR_VISIBILITY:n=Ot.create_anchor_visibility_batch();break;case Kt.PERFORMANCE:n=Ot.create_performance_batch()}if(n){var P=Kt.init_bundle(n,xt.create_render("NONE"));Kt.append_draw_data(_,P),Ce(t,_,n,!1),me(n)}})};var Nr=function(){var e=N.create(),t=M.create();return function(r,a){for(var _=et(a,Vt),n=r.light,o=r.render,i=xt.get_scene_data(r,a),s=Y.j(o.world_tsr,t),c=Y.g(o.world_tsr,e),E=0;E<_.length;E++){var l=_[E];switch(hr(r,i,l),n.type){case"SUN":l.sun_quaternion.set(c),l.sun_intensity=n.color_intensity,M.copy(n.direction,l.sun_direction),l.type==Kt.SKY&&l.procedural_skydome&&(l.need_fog_update=n.need_sun_fog_update,He(a,l));break;case"HEMI":case"POINT":case"SPOT":break;default:Ct.error("Unknown light type: "+n.type+'".')}for(var T=l.draw_data,u=0;u<T.length;u++)for(var d=T[u].bundles,f=0;f<d.length;f++){var P=d[f].batch;P.lamp_uuid_indexes&&Ot.set_lamp_data(P,r)}}for(var A=tt(a,Kt.MAIN_OPAQUE),S=A.camera,p=i.shadow_subscenes,v=a._render.shadow_params,E=0;E<p.length;E++){var l=p[E],m=l.camera;Nt.set_view_trans_quat(m,s,c),Ye(l,a,S,v,!0),gr(l,a._render.graph)}}}();t.update_lamp_scene=Nr,t.append_object=function(e,t,r){switch(t.type){case"MESH":case"LINE":case"WORLD":var a=e._render.graph,_=t.render;!Ft.find_subs(a,Kt.SHADOW_CAST)&&_.shadow_receive&&(_.shadow_receive=!1);for(var n=et(e,qt),o=0;o<n.length;o++)Pe(n[o],t,a,e,r);break;case"LAMP":Nr(t,e)}for(var i=xt.get_scene_data(t,e),s=i.batches,c=0;c<s.length;c++)null==s[c].shader&&"PHYSICS"!=s[c].type&&(xt.scene_data_remove_batch(i,c),c--);xt.scene_data_set_active(t,!0,e)},t.init_cube_sky_dim=ue,t.update_cube_sky_dim=fe,t.add_object_subs_reflect=he,t.schedule_shadow_update=Re,t.update_shadow_billboard_view=function(e,t){It.traverse(t,function(t,r){var a=r;a.type===Kt.SHADOW_CAST&&(Y.a(e.world_tsr,a.camera.world_tsr),Y.a(e.view_tsr,a.camera.shadow_cast_billboard_view_tsr))})};var gr=function(){var e=N.create(),t=M.create(),r=y.create();return function(a,_){for(var n=a.camera,o=Ft.get_outputs(_,a),i=0;i<o.length;i++){var s=o[i];if(s.type==Kt.MAIN_OPAQUE||s.type==Kt.SHADOW_RECEIVE||s.type==Kt.MAIN_BLEND||s.type==Kt.MAIN_XRAY)if(jt.mac_os_shadow_hack)s.v_light_tsr.set(n.view_tsr,9*a.shadow_lamp_index);else{var c=Y.j(n.view_tsr,t),E=Y.i(n.view_tsr),l=Y.g(n.view_tsr,e);y.set(c[0],c[1],c[2],E,r),s.v_light_ts.set(r,4*a.shadow_lamp_index),s.v_light_r.set(l,4*a.shadow_lamp_index)}}}}();t.update_shadow_receive_subs=gr,t.get_csm_borders=xe,t.connect_render_targets_batch=Ce,t.change_visibility_rec=Ge,t.change_visibility=ke,t.is_hidden=function(e){return e.render.hide},t.remove_object_bundles=function(e,t){for(var r=0;r<e.scenes_data.length;r++)for(var a=e.scenes_data[r].scene,_=et(a,qt),n=0;n<_.length;n++)for(var o=_[n].draw_data,i=0;i<o.length;i++)for(var s=o[i].bundles,c=s.length-1;c>=0;c--){var E=s[c];E.obj_render==e.render&&(E.batch?"undefined"!=typeof t&&-1==E.batch.material_names.indexOf(t)&&0!=E.batch.material_names.length||(Ot.clear_batch(E.batch),s.splice(c,1)):s.splice(c,1))}},t.update_lamp_scene_color_intensity=Ke;var hr=function(){var e=M.create(),t=y.create();return function(r,a,_){var n=r.render,o=r.light,i=a.light_index,s=Y.j(r.render.world_tsr,e),c=o.color_intensity;_.light_directions.set(o.direction,3*i),t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=o.use_diffuse&&!n.hide?1:0,_.light_positions.set(t,4*i),t[0]=c[0],t[1]=c[1],t[2]=c[2],t[3]=o.use_specular&&!n.hide?1:0,_.light_color_intensities.set(t,4*i),_.need_perm_uniforms_update=!0}}();t.update_sky_texture=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)je(t[r].scene)},t.update_world_texture=je,t.update_sky=He,t.cleanup=function(){for(var e=0;e<rr.length;e++){var t=rr[e],r=t._render.graph;It.traverse(r,function(e,t){t.type!=Kt.SINK&&ze(t)}),t._render.graph=null,t._render.queue=[]}er=null,tr=null,rr.length=0,ar=null},t.clear_subscene=ze,t.make_frustum_shot=function(e,t,r){var a=Nt.extract_frustum_corners(e,e.near,e.far,null,!0),_=wt.generate_frustum(a),n=xt.create_render("DYNAMIC");n.bb_world=n.bb_local=i.f(),n.bs_world=n.bs_local=i.g();var o=n.bs_world.radius;n.be_world=n.be_local=i.e([o,0,0],[0,o,0],[0,0,o],n.bs_world.center);var s=Ot.create_shadeless_batch(_,r,.5);s.do_not_cull=!0;var c=Kt.init_bundle(s,n);Kt.append_draw_data(t,c)},t.get_scene_timeline=function(e){return[e.frame_start,e.frame_end]},t.setup_dim=Ve,t.subs_array=et,t.get_subs=tt,t.render_both_eyes=function(){rt(!1)},t.render_one_eye=function(){rt(!0)},t.get_environment_colors=function(e){var t=tt(e,Kt.MAIN_OPAQUE),r=t.horizon_color,a=t.zenith_color,_=[],n=[];return _[0]=r[0],_[1]=r[1],_[2]=r[2],n[0]=a[0],n[1]=a[1],n[2]=a[2],[t.environment_energy,_,n]},t.set_environment_colors=at,t.get_sky_params=function(e){var t=tt(e,Kt.SKY);if(t&&t.procedural_skydome){var r={};return r.color=new Array(3),M.copy(t.sky_color,r.color),r.procedural_skydome=t.procedural_skydome,r.use_as_environment_lighting=t.use_as_environment_lighting,r.rayleigh_brightness=t.rayleigh_brightness,r.mie_brightness=t.mie_brightness,r.spot_brightness=t.spot_brightness,r.scatter_strength=t.scatter_strength,r.rayleigh_strength=t.rayleigh_strength,r.mie_strength=t.mie_strength,r.rayleigh_collection_power=t.rayleigh_collection_power,r.mie_collection_power=t.mie_collection_power,r.mie_distribution=t.mie_distribution,r}return null},t.get_fog_intensity=function(e){return et(e,Wt)[0].fog_params[0]},t.get_fog_depth=function(e){return et(e,Wt)[0].fog_params[1]},t.get_fog_start=function(e){return et(e,Wt)[0].fog_params[2]},t.get_fog_height=function(e){return et(e,Wt)[0].fog_params[3]},t.set_fog_intensity=function(e,t){for(var r=et(e,Wt),a=0;a<r.length;a++){var _=r[a];_.fog_params[0]=t,_.need_perm_uniforms_update=!0}},t.set_fog_depth=function(e,t){for(var r=et(e,Wt),a=0;a<r.length;a++){var _=r[a];_.fog_params[1]=t,_.need_perm_uniforms_update=!0}},t.set_fog_start=function(e,t){for(var r=et(e,Wt),a=0;a<r.length;a++){var _=r[a];_.fog_params[2]=t,_.need_perm_uniforms_update=!0}},t.set_fog_height=function(e,t){for(var r=et(e,Wt),a=0;a<r.length;a++){var _=r[a];_.fog_params[3]=t,_.need_perm_uniforms_update=!0}},t.get_fog_color_density=function(e,t){var r=t||[],a=et(e,Wt)[0],_=a.fog_color_density;return r[0]=_[0],r[1]=_[1],r[2]=_[2],r[3]=_[3],r},t.set_fog_color_density=function(e,t){for(var r=et(e,Wt),a=0;a<r.length;a++){var _=r[a];_.fog_color_density.set(t),_.need_perm_uniforms_update=!0}},t.get_ssao_params=function(e){var t=tt(e,Kt.SSAO),r=tt(e,Kt.SSAO_BLUR),a=tt(e,Kt.MAIN_OPAQUE);if(!t)return null;var _={};return _.quality=t.ssao_samples,_.use_hemisphere=t.ssao_hemisphere,_.use_blur_depth=r.ssao_blur_depth,_.blur_discard_value=r.ssao_blur_discard_value,_.radius_increase=t.ssao_radius_increase,_.influence=t.ssao_influence,_.dist_factor=t.ssao_dist_factor,_.ssao_only=a.ssao_only,_.ssao_white=t.ssao_white,_},t.get_dof_params=function(e){var t=tt(e,Kt.DOF);if(!t)return null;var r={};return r.dof_on=t.camera.dof_on,r.dof_bokeh=t.dof_bokeh,r.dof_distance=t.camera.dof_distance,r.dof_front_start=t.camera.dof_front_start,r.dof_front_end=t.camera.dof_front_end,r.dof_rear_start=t.camera.dof_rear_start,r.dof_rear_end=t.camera.dof_rear_end,r.dof_power=t.camera.dof_power,r.dof_bokeh_intensity=t.camera.dof_bokeh_intensity,r.dof_object=t.camera.dof_object,r},t.set_dof_params=_t,t.get_god_rays_params=function(e){var t=et(e,[Kt.GOD_RAYS]),r=tt(e,Kt.GOD_RAYS_COMBINE);if(!t||!r)return null;var a={};a.god_rays_max_ray_length=t[0].max_ray_length,a.god_rays_intensity=r.god_rays_intensity;var _=t[0].draw_data[0].bundles[0].batch;return a.god_rays_steps=Ot.get_batch_directive(_,"STEPS_PER_PASS")[1],a},t.set_god_rays_params=function(e,t){var r=et(e,[Kt.GOD_RAYS]),a=et(e,[Kt.GOD_RAYS_COMBINE]);if(!r.length||!a.length)return Ct.error("God Rays are not enabled on the scene"),0;if("number"==typeof t.god_rays_intensity)for(var _=0;_<a.length;_++)a[_].god_rays_intensity=t.god_rays_intensity;if("number"==typeof t.god_rays_max_ray_length)for(var n=t.god_rays_max_ray_length,_=0;_<r.length;_++)r[_].max_ray_length=n,r[_].radial_blur_step=n/r[_].steps_per_pass/(_+1),r[_].need_perm_uniforms_update=!0;if("number"==typeof t.god_rays_steps)for(var o=kt.glsl_value(t.god_rays_steps,1),n=r[0].max_ray_length,_=0;_<r.length;_++){r[_].steps_per_pass=o,r[_].radial_blur_step=n/o/(_+1),r[_].need_perm_uniforms_update=!0;var i=r[_].draw_data[0].bundles[0],s=i.batch;Ot.set_batch_directive(s,"STEPS_PER_PASS",o),Ot.update_shader(s),Kt.append_draw_data(r[_],i)}for(var _=0;_<a.length;_++)a.need_perm_uniforms_update=!0},t.get_bloom_params=function(e){var t=tt(e,Kt.LUMINANCE_TRUNCED),r=tt(e,Kt.BLOOM);if(!t||!r)return null;var a={};return a.key=t.bloom_key,a.edge_lum=t.bloom_edge_lum,a.blur=r.bloom_blur,a.adaptive=t.adaptive_bloom,a.average_luminance=t.average_luminance,a},t.set_bloom_params=ot,t.get_glow_material_params=function(e){var t=tt(e,Kt.GLOW_COMBINE);if(!t)return null;var r={};return r.small_glow_mask_coeff=t.small_glow_mask_coeff,r.large_glow_mask_coeff=t.large_glow_mask_coeff,r.small_glow_mask_width=t.small_glow_mask_width,r.large_glow_mask_width=t.large_glow_mask_width,r},t.set_glow_material_params=it,t.get_wind_params=function(e){var t=St(e),r=M.length(t);if(0==r)return null;var a=L._39(Math.atan2(t[0],-t[1])),_={};return _.wind_dir=a,_.wind_strength=r,_},t.schedule_grass_map_update=ct,t.get_water_surface_level=Et,t.get_water_mat_params=function(e,t){var r=e._render.water_params,a=tt(e,Kt.MAIN_OPAQUE);if(a&&r){t.waves_height=r.waves_height,t.waves_length=r.waves_length,t.water_fog_density=a.water_fog_color_density[3];var _=t.water_fog_color=[];_[0]=a.water_fog_color_density[0],_[1]=a.water_fog_color_density[1],_[2]=a.water_fog_color_density[2]}},t.set_water_params=function(e,t){var r=e._render.water_params;if(!r)return Ct.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof t.dst_noise_scale0&&(r.dst_noise_scale0=t.dst_noise_scale0),"number"==typeof t.dst_noise_scale1&&(r.dst_noise_scale1=t.dst_noise_scale1),"number"==typeof t.dst_noise_freq0&&(r.dst_noise_freq0=t.dst_noise_freq0),"number"==typeof t.dst_noise_freq1&&(r.dst_noise_freq1=t.dst_noise_freq1),"number"==typeof t.dir_min_shore_fac&&(r.dir_min_shore_fac=t.dir_min_shore_fac),"number"==typeof t.dir_freq&&(r.dir_freq=t.dir_freq),"number"==typeof t.dir_noise_scale&&(r.dir_noise_scale=t.dir_noise_scale),"number"==typeof t.dir_noise_freq&&(r.dir_noise_freq=t.dir_noise_freq),"number"==typeof t.dir_min_noise_fac&&(r.dir_min_noise_fac=t.dir_min_noise_fac),"number"==typeof t.dst_min_fac&&(r.dst_min_fac=t.dst_min_fac),"number"==typeof t.waves_hor_fac&&(r.waves_hor_fac=t.waves_hor_fac),"number"==typeof t.water_dynamic&&(r.dynamic=t.water_dynamic);for(var a=et(e,Zt),_=0;_<a.length;_++){var n=a[_];"number"==typeof t.water_fog_density&&r.fog_color_density&&(n.water_fog_color_density[3]=t.water_fog_density),"object"==typeof t.water_fog_color&&r.fog_color_density&&n.water_fog_color_density.set(t.water_fog_color),n.need_perm_uniforms_update=!0}},t.get_shore_dist=function(e,t,r){var a=e._render.water_params;if(!a.shoremap_image)return 100;var _=a.shoremap_size[0],n=a.shoremap_size[1],o=a.shoremap_center[0],i=a.shoremap_center[1],s=a.max_shore_dist,c=a.water_level,E=(t[0]-o)/_,l=(i+t[1])/n;if(E+=.5,l+=.5,!(E>1||E<0||l>1||l<0)){var T=a.shoremap_tex_size,u=tr._render.shore_distances,d=s*L._7(u,T,E,l),f=(c-t[2])*r;return Math.sqrt(d*d+f*f)}},t.update=function(e,t){Dt.clear();for(var r=_()._camera.render,a=0;a<rr.length;a++){var n=rr[a],o=n._render.graph,i=n._render;if(i.water_params){var s=Y.j(r.world_tsr,Tr),c=s[2]-Et(n,s[0],s[1]);Y.v(s,r.world_tsr)}for(var E=0;E<i.video_textures.length;E++){var l=i.video_textures[E]._render,T=l.video_file,u=l.seq_video;if((!n.b4w_use_nla||!l.use_nla)&&((T||u)&&Bt.video_is_played(l))){var d=Bt.video_get_current_frame(l),f=Bt.video_get_start_frame(l);T&&jt.is_mobile_device&&(f-=5);var P=Bt.video_get_end_frame(l);if(d>=P&&l.use_cyclic||d<f)Bt.reset_video(l),u&&(l.seq_last_discrete_mark=Bt.seq_video_get_discrete_timemark(l,e));else if(d>=P&&!l.use_cyclic)Bt.pause_video(l);else if(Bt.video_update_is_available(l))if(T)Bt.update_video_texture(l);else{var A=Bt.seq_video_get_discrete_timemark(l,e);A!=l.seq_last_discrete_mark&&(Bt.update_seq_video_texture(l),l.seq_cur_frame++),l.seq_last_discrete_mark=A}}}It.traverse(o,function(t,r){var a=r;Jt.indexOf(a.type)>-1&&(a.time=e),i.water_params&&(a.cam_water_depth=c)})}for(var a=0;a<rr.length;a++){var n=rr[a],i=n._render,o=i.graph,S=i.queue;if(S.length){i.need_shadow_update&&(Ie(n),i.need_shadow_update=!1),i.need_grass_map_update&&(dt(n),i.need_grass_map_update=!1),i.need_outline&&(be(n),i.need_outline=!1),i.motion_blur&&ft(o,t);for(var p=Ft.find_subs(o,Kt.OUTLINE_MASK),E=0;E<S.length;E++){var v=S[E];Ut.prerender_subs(v),p&&lt(o,v,p),Dt.draw(v)}}}jt.show_hud_debug_info&&bt.show_debug_info(rr,t)},t.request_outline=function(e){e._render.need_outline=!0},t.get_all_subscenes=function(e){var t=e._render.graph,r=[];return It.traverse(t,function(e,t){r.push(t)}),r},t.get_cam_water_depth=function(){var e=tt(tr,Kt.MAIN_BLEND),t=tr;return e||t._render.water_params?e.cam_water_depth:null},t.update_scene_permanent_uniforms=Pt,t.set_debug_view_mode=function(e,t){e.debug_view_mode=t,e.do_render=t!=Rt.DV_NONE,e.blend=t==Rt.DV_TRANSPARENT_WIREFRAME,e.need_perm_uniforms_update=!0;for(var r=_(),a=0;a<Zt.length;a++)for(var n=et(r,[Zt[a]]),o=0;o<n.length;o++)n[o].do_not_debug=t==Rt.DV_RENDER_TIME},t.set_debug_colors_seed=function(e,t){e.debug_colors_seed=t,e.need_perm_uniforms_update=!0},t.set_render_time_threshold=function(e,t){e.debug_render_time_threshold=t,e.need_perm_uniforms_update=!0},t.set_wireframe_edge_color=function(e,t){for(var r=e.draw_data,a=0;a<r.length;a++)for(var _=r[a].bundles,n=0;n<_.length;n++){var o=_[n].batch;M.copy(t,o.wireframe_edge_color),o.shader.need_uniforms_update=!0}},t.update_force_scene=function(){var e=N.create();return function(t,r){var a=r.field,_=t._render.wind;if(a&&"WIND"==a.type&&_){var n=r.render,o=Y.g(n.world_tsr,e);M.transformQuat(L.f,o,_),M.normalize(_,_),M.scale(_,a.strength,_);for(var i=et(t,Jt),s=0;s<i.length;s++)i[s].wind.set(_);return!0}return!1}}(),t.pick_color=function(e,t,r){var a=tt(e,Kt.COLOR_PICKING);if(a){var _=Xt.enabled&&(Xt.subs_type===Kt.COLOR_PICKING||Xt.subs_type===Kt.COLOR_PICKING_XRAY);if(_)var n=ht.canvas_to_viewport_coords(t,r,lr,a.camera);else{var o=ht.get_canvas(),i=o.clientHeight,s=o.clientWidth;Nt.set_color_pick_proj(a.camera,t,r,s,i)}Ut.prerender_subs(a),a.do_render&&Dt.draw(a);var c=tt(e,Kt.COLOR_PICKING_XRAY);if(c){f.copy(a.camera.proj_matrix,c.camera.proj_matrix),f.copy(a.camera.view_proj_matrix,c.camera.view_proj_matrix),L._0(c.camera.view_proj_matrix,c.camera.frustum_planes),Ut.prerender_subs(c),c.do_render&&Dt.draw(c);var E=c.camera}else var E=a.camera;return a.do_render||c&&c.do_render?_?(n[1]=E.height-n[1],Dt.read_pixels(E.framebuffer,n[0],n[1],1,1,Or)):Dt.read_pixels(c?c.camera.framebuffer:a.camera.framebuffer,0,0,1,1,Or):null}return Ct.error("Object Selection is not available on the scene"),null},t.set_outline_color=At,t.get_wind=St,t.get_meta_tags=function(e){var t={title:"",description:""};return e.b4w_tags&&(t.title=e.b4w_tags.title,t.description=e.b4w_tags.description),t},t.get_custom_prop=function(e){return e.b4w_custom_prop},t.update_cube_reflect_subs=function(e,t){var r=Tr;M.negate(t,r);for(var a=0;a<6;a++){var _=e.cube_view_matrices[a],n=e.cube_cam_frustums[a],o=e.camera;f.translate(L.j[a],r,_),f.multiply(o.proj_matrix,_,o.view_proj_matrix),L._0(o.view_proj_matrix,n)}},t.update_plane_reflect_subs=function(e,t,r){var a=e.camera;L._61(t,r,L.f,a.reflection_plane)},t.assign_scene_data_subs=function(e,t,r){var a=e._render.reflection_params;if(a&&t)for(var _=0;_<t.length;_++){var n=t[_],o=xt.get_scene_data(n,e);if(-1!=n.render.plane_reflection_id){var i=a.plane_refl_subs,s=a.plane_refl_subs_blend,c=n.render.plane_reflection_id;s.length&&c<s.length?o.plane_refl_subs=s[c]:i.length&&c<i.length&&(o.plane_refl_subs=i[c])}else if(-1!=n.render.cube_reflection_id){var E=a.cube_refl_subs,l=a.cube_refl_subs_blend,c=n.render.cube_reflection_id;l.length?o.cube_refl_subs=l[c]:E.length&&(o.cube_refl_subs=E[c])}}if(r)for(var T=jt.ssao&&e.b4w_enable_ssao,u=xt.get_shadow_lamps(r,T),d=e._render.shadow_params,_=0;_<u.length;_++){var o=xt.get_scene_data(u[_],e);if(d)for(var f=et(e,[Kt.SHADOW_CAST]),P=0;P<f.length;P++)_==f[P].shadow_lamp_index&&o.shadow_subscenes.push(f[P])}},t.marker_frame=function(e,t){return e.timeline_markers[t]},t.set_hmd_params=function(e){var t=_(),r=tt(t,Kt.STEREO);r&&(e.distortion_coefs&&(r.distortion_params[0]=e.distortion_coefs[0],r.distortion_params[1]=e.distortion_coefs[1],r.need_perm_uniforms_update=!0),e.chromatic_aberration_coefs&&(r.chromatic_aberration_coefs[0]=e.chromatic_aberration_coefs[0],r.chromatic_aberration_coefs[1]=e.chromatic_aberration_coefs[1],r.chromatic_aberration_coefs[2]=e.chromatic_aberration_coefs[2],r.chromatic_aberration_coefs[3]=e.chromatic_aberration_coefs[3],r.need_perm_uniforms_update=!0),e.base_line_factor&&(r.distortion_params[2]=e.base_line_factor,r.need_perm_uniforms_update=!0),e.inter_lens_factor&&(r.distortion_params[3]=e.inter_lens_factor,r.need_perm_uniforms_update=!0),null!=e.enable_hmd_stereo&&(r.enable_hmd_stereo=e.enable_hmd_stereo,r.need_perm_uniforms_update=!0))},t.multiply_size_mult=function(e,r){for(var a=w(),_=0;_<a.length;_++){var n=a[_],o=t.get_graph(n);Ft.multiply_size_mult_by_graph(o,e,r)}},t.update_all_mesh_shaders=function(e){for(var t=Mt.get_scene_objs(e,"LAMP",Mt.DATA_ID_ALL),r=et(e,qt),a=0;a<r.length;a++)for(var _=r[a],n=_.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var c=i[s],E=c.batch;"MAIN"==E.type&&(Ot.update_batch_lights(E,t,e),Ot.update_shader(E),Kt.append_draw_data(_,c))}},t.recalculate_draw_data=function(e){for(var t=0;t<rr.length;t++){var r=rr[t]._render.graph;It.traverse(r,function(t,r){for(var a=r,_=a.draw_data,n=0;n<_.length;n++)for(var o=_[n].bundles,i=0;i<o.length;i++){var s=o[i];s.batch==e&&Kt.append_draw_data(a,s)}})}}}var _=r(0),n=r(5),o=r(16),i=r(25),s=r(14),c=r(4),E=r(15),l=r(49),T=r(30),u=r(54),d=r(42),f=r(21),P=r(66),A=r(12),S=r(17),p=r(9),v=r(115),m=r(68),O=r(1),N=r(8),g=r(22),h=r(61),R=r(23),I=r(37),b=r(11),Y=r(6),L=r(2),M=r(3),y=r(7),x=r(40),U=Object(_.a)("__scenes",a);t.a=U},function(e,t,r){"use strict";function a(e,t){function r(e,t){e.num_lights=t,e.light_directions=new Float32Array(3*t),e.light_positions=new Float32Array(4*t),e.light_color_intensities=new Float32Array(4*t)}function a(e){var t={type:e,subtype:"",force_do_not_render:!1,do_render:!1,enqueue:!1,clear_color:!1,clear_depth:!1,depth_test:!1,blend:!1,pack:!1,assign_texture:!1,need_fog_update:!1,need_perm_uniforms_update:!1,debug_render_calls:0,debug_render_time:0,debug_render_time_queries:[],debug_view_mode:0,debug_colors_seed:0,debug_render_time_threshold:1,do_not_debug:!1,time:0,camera:null,cube_view_matrices:null,cube_cam_frustums:[],draw_data:[],slinks_internal:[],textures_internal:[],wind:new Float32Array(3),grass_map_dim:new Float32Array(3),fog_color_density:new Float32Array(4),fog_params:new Float32Array(4),cube_fog:new Float32Array(16),sky_tex_default_value:0,environment_energy:0,num_lights:0,light_directions:null,light_positions:null,light_color_intensities:null,light_factors:null,horizon_color:new Float32Array(3),zenith_color:new Float32Array(3),sky_tex_fac:new Float32Array(4),sun_intensity:new Float32Array(3),sun_direction:new Float32Array([0,0,1]),sun_quaternion:new Float32Array(4),sky_tex_color:new Float32Array(3),sky_ngraph_proxy_id:"",bsdf_cube_sky_dim:0,outline_factor:0,draw_outline_flag:0,is_for_outline:!1,outline_color:new Float32Array(3),water:!1,cam_water_depth:0,water_fog_color_density:new Float32Array(4),water_level:0,caustics:!1,caust_scale:0,caust_speed:new Float32Array(2),caust_brightness:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,sky_color:new Float32Array(3),ssao_hemisphere:!1,ssao_blur_depth:!1,ssao_blur_discard_value:0,ssao_radius_increase:0,ssao_influence:0,ssao_dist_factor:0,ssao_samples:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,max_ray_length:0,radial_blur_step:0,steps_per_pass:0,csm_index:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,v_light_ts:null,v_light_r:null,v_light_tsr:null,p_light_matrix:null,is_pp:!1,fxaa_quality:"",bloom_key:0,bloom_blur:0,bloom_edge_lum:0,adaptive_bloom:!0,average_luminance:0,blur_texel_size_mult:0,ext_texel_size_mult:0,mb_decay_threshold:0,mb_factor:0,motion_blur_exp:0,pp_effect:"",dof_bokeh:!1,coc_type:"",jitter_projection_space:new Float32Array(2),last_mip_map_ind:0,bloom_blur_num:2,bloom_blur_scale:.5,small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,texel_size_multiplier:0,texel_size:new Float32Array(2),texel_mask:new Float32Array(2),distortion_params:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,shadow_lamp_index:0,need_draw_data_sort:!0,sky_invert:!1,sky_use_rgb_to_intensity:!1,sky_use_map_blend:!1,sky_use_map_horizon:!1,sky_use_map_zenith_up:!1,sky_use_map_zenith_down:!1,sky_blend_type:"",use_sky_blend:!1,use_sky_paper:!1,use_sky_real:!1,refl_obj:null};return t.do_render=!0,t.enqueue=!0,t.clear_color=!0,t.clear_depth=!0,t.depth_test=!0,t.need_perm_uniforms_update=!0,t.texel_size_multiplier=1,t.texel_mask[0]=1,t.texel_mask[1]=1,t.distortion_params[2]=.5,t.distortion_params[3]=.5,t.ssao_samples=8,t}function _(e,t,r){var a=t;a.fog_color_density&&e.water_fog_color_density.set(a.fog_color_density),e.water_level=a.water_level,a.caustics&&r&&(e.caustics=!0,e.caust_scale=a.caustic_scale,e.caust_brightness=a.caustic_brightness,e.caust_speed.set(a.caustic_speed))}function E(e,t,r,a,_){return{shader:e,bundles:[t],alpha_antialiasing:r,offset_z:a,is_sky:_,do_render:!0,z_index:1/0}}function l(e,t,r,a,_){for(var n=0;n<e.length;n++){var o=e[n];if(o.shader==t&&o.alpha_antialiasing==r&&o.offset_z==a&&o.is_sky==_)return o}return null}function T(e,t){return e==t?0:e>t?1:-1}function u(e,t){return T(e.alpha_antialiasing,t.alpha_antialiasing)||T(e.is_sky,t.is_sky)||T(e.offset_z,t.offset_z)||T(e.shader.has_discard,t.shader.has_discard)||T(e.z_index,t.z_index)}var d=Object(n.a)(e),f=Object(o.a)(e),P=Object(i.a)(e),A=P.outlining;t.MAIN_OPAQUE=0,t.MAIN_BLEND=1,t.MAIN_XRAY=2,t.MAIN_PLANE_REFLECT=3,t.MAIN_CUBE_REFLECT=4,t.MAIN_PLANE_REFLECT_BLEND=5,t.MAIN_CUBE_REFLECT_BLEND=6,t.MAIN_GLOW=7,t.SHADOW_CAST=8,t.SHADOW_RECEIVE=9,t.GRASS_MAP=10,t.POSTPROCESSING=11,t.GLOW_COMBINE=13,t.RESOLVE=14,t.COLOR_PICKING=15,t.COLOR_PICKING_XRAY=16,t.DEBUG_VIEW=17,t.ANCHOR_VISIBILITY=18,t.DEPTH_PACK=19,t.SSAO=20,t.SSAO_BLUR=21,t.ANTIALIASING=22,t.SMAA_BLENDING_WEIGHT_CALCULATION=23,t.SMAA_EDGE_DETECTION=24,t.SMAA_RESOLVE=25,t.SMAA_NEIGHBORHOOD_BLENDING=26,t.COMPOSITING=27,t.MOTION_BLUR=28,t.COC=29,t.DOF=30,t.OUTLINE_MASK=31,t.OUTLINE=32,t.GOD_RAYS=33,t.GOD_RAYS_COMBINE=34,t.SKY=35,t.COPY=36,t.STEREO=37,t.LUMINANCE=38,t.AVERAGE_LUMINANCE=39,t.LUMINANCE_TRUNCED=40,t.BLOOM=41,t.VELOCITY=42,t.SINK=43,t.PERFORMANCE=44,t.RESIZE=45,t.IRRADIANCE=46,t.ROUGHNESS_CONVOLUTION=47,t.BRDF=48,t.create_subs_shadow_cast=function(e,t,_,n){var o=a(8);switch(o.csm_index=e,o.self_shadow_polygon_offset=_.self_shadow_polygon_offset,o.shadow_lamp_index=t,_.lamp_types[t]){case"SPOT":case"POINT":o.camera=f.create_camera(f.TYPE_PERSP);var i=_.spot_sizes[t],s=_.clip_start[t],c=_.clip_end[t];f.set_frustum(o.camera,i,s,c);break;default:o.camera=f.create_camera(f.TYPE_ORTHO_ASYMMETRIC)}return r(o,n),o},t.clone_subs=function(e){var t=a(e.type);return t.subtype=e.subtype,t.force_do_not_render=e.force_do_not_render,t.do_render=e.do_render,t.enqueue=e.enqueue,t.clear_color=e.clear_color,t.clear_depth=e.clear_depth,t.depth_test=e.depth_test,t.blend=e.blend,t.pack=e.pack,t.assign_texture=e.assign_texture,t.need_fog_update=e.need_fog_update,t.need_perm_uniforms_update=e.need_perm_uniforms_update,t.debug_render_calls=0,t.debug_render_time=0,t.debug_render_time_queries=[],t.debug_view_mode=e.debug_view_mode,t.debug_colors_seed=e.debug_colors_seed,t.debug_render_time_threshold=e.debug_render_time_threshold,t.do_not_debug=e.do_not_debug,t.time=e.time,t.camera=f.clone_camera(e.camera,!0),t.cube_view_matrices=s.O(e.cube_view_matrices),t.cube_cam_frustums=s.O(e.cube_cam_frustums),t.draw_data=s.O(e.draw_data),t.slinks_internal=s.O(e.slinks_internal),t.textures_internal=s.O(e.textures_internal),t.wind.set(e.wind),t.grass_map_dim.set(e.grass_map_dim),t.fog_color_density.set(e.fog_color_density),t.fog_params.set(e.fog_params),t.cube_fog.set(e.cube_fog),t.sky_tex_default_value=e.sky_tex_default_value,t.environment_energy=e.environment_energy,t.num_lights=e.num_lights,t.light_directions=s.O(e.light_directions),t.light_positions=s.O(e.light_positions),t.light_color_intensities=s.O(e.light_color_intensities),t.light_factors=s.O(e.light_factors),t.horizon_color.set(e.horizon_color),t.zenith_color.set(e.zenith_color),t.sky_tex_fac.set(e.sky_tex_fac),t.sun_intensity.set(e.sun_intensity),t.sun_direction.set(e.sun_direction),t.sun_quaternion.set(e.sun_quaternion),t.sky_tex_color.set(e.sky_tex_color),t.sky_ngraph_proxy_id=e.sky_ngraph_proxy_id,t.bsdf_cube_sky_dim=e.bsdf_cube_sky_dim,t.outline_factor=e.outline_factor,t.draw_outline_flag=e.draw_outline_flag,t.is_for_outline=e.is_for_outline,t.outline_color.set(e.outline_color),t.water=e.water,t.cam_water_depth=e.cam_water_depth,t.water_fog_color_density.set(e.water_fog_color_density),t.water_level=e.water_level,t.caustics=e.caustics,t.caust_scale=e.caust_scale,t.caust_speed.set(e.caust_speed),t.caust_brightness=e.caust_brightness,t.procedural_skydome=e.procedural_skydome,t.use_as_environment_lighting=e.use_as_environment_lighting,t.mie_brightness=e.mie_brightness,t.rayleigh_brightness=e.rayleigh_brightness,t.spot_brightness=e.spot_brightness,t.mie_strength=e.mie_strength,t.rayleigh_strength=e.rayleigh_strength,t.scatter_strength=e.scatter_strength,t.mie_collection_power=e.mie_collection_power,t.rayleigh_collection_power=e.rayleigh_collection_power,t.mie_distribution=e.mie_distribution,t.sky_color.set(e.sky_color),t.ssao_hemisphere=e.ssao_hemisphere,t.ssao_blur_depth=e.ssao_blur_depth,t.ssao_blur_discard_value=e.ssao_blur_discard_value,t.ssao_radius_increase=e.ssao_radius_increase,t.ssao_influence=e.ssao_influence,t.ssao_dist_factor=e.ssao_dist_factor,t.ssao_samples=e.ssao_samples,t.ssao_only=e.ssao_only,t.ssao_white=e.ssao_white,t.brightness=e.brightness,t.contrast=e.contrast,t.exposure=e.exposure,t.saturation=e.saturation,t.god_rays_intensity=e.god_rays_intensity,t.max_ray_length=e.max_ray_length,t.radial_blur_step=e.radial_blur_step,t.steps_per_pass=e.steps_per_pass,t.csm_index=e.csm_index,t.self_shadow_polygon_offset=e.self_shadow_polygon_offset,t.self_shadow_normal_offset=e.self_shadow_normal_offset,t.v_light_ts=s.O(e.v_light_ts),t.v_light_r=s.O(e.v_light_r),t.v_light_tsr=s.O(e.v_light_tsr),t.p_light_matrix=s.O(e.p_light_matrix),t.is_pp=e.is_pp,t.fxaa_quality=e.fxaa_quality,t.bloom_key=e.bloom_key,t.bloom_blur=e.bloom_blur,t.bloom_edge_lum=e.bloom_edge_lum,t.adaptive_bloom=e.adaptive_bloom,t.average_luminance=e.average_luminance,t.blur_texel_size_mult=e.blur_texel_size_mult,t.ext_texel_size_mult=e.ext_texel_size_mult,t.mb_decay_threshold=e.mb_decay_threshold,t.mb_factor=e.mb_factor,t.motion_blur_exp=e.motion_blur_exp,t.pp_effect=e.pp_effect,t.coc_type=e.coc_type,t.dof_bokeh=e.dof_bokeh,t.jitter_projection_space.set(e.jitter_projection_space),t.last_mip_map_ind=e.last_mip_map_ind,t.bloom_blur_num=e.bloom_blur_num,t.bloom_blur_scale=e.bloom_blur_scale,t.small_glow_mask_width=e.small_glow_mask_width,t.large_glow_mask_width=e.large_glow_mask_width,t.small_glow_mask_coeff=e.small_glow_mask_coeff,t.large_glow_mask_coeff=e.large_glow_mask_coeff,t.texel_size_multiplier=e.texel_size_multiplier,t.texel_size.set(e.texel_size),t.texel_mask.set(e.texel_mask),t.distortion_params.set(e.distortion_params),t.chromatic_aberration_coefs.set(e.chromatic_aberration_coefs),t.enable_hmd_stereo=e.enable_hmd_stereo,t.shadow_lamp_index=e.shadow_lamp_index,t.need_draw_data_sort=e.need_draw_data_sort,t.sky_invert=e.sky_invert,t.sky_use_rgb_to_intensity=e.sky_use_rgb_to_intensity,t.sky_use_map_blend=e.sky_use_map_blend,t.sky_use_map_horizon=e.sky_use_map_horizon,t.sky_use_map_zenith_up=e.sky_use_map_zenith_up,t.sky_use_map_zenith_down=e.sky_use_map_zenith_down,t.sky_blend_type=e.sky_blend_type,t.use_sky_blend=e.use_sky_blend,t.use_sky_paper=e.use_sky_paper,t.use_sky_real=e.use_sky_real,t},t.create_subs_grass_map=function(){var e=a(10);return e.camera=f.create_camera(f.TYPE_ORTHO_ASPECT),e},t.create_subs_postprocessing=function(e){var t=a(11);switch(t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1,t.is_pp=!0,t.camera=f.create_camera(f.TYPE_NONE),t.pp_effect=e,e){case"NONE":case"GRAYSCALE":t.texel_mask[0]=1,t.texel_mask[1]=1;break;case"X_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_GLOW_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_GLOW_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_BLOOM_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_BLOOM_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_DOF_BLUR":case"Y_DOF_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=1;break;case"X_ALPHA_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0,t.texel_size_multiplier=3;break;case"Y_ALPHA_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1,t.texel_size_multiplier=3;break;case"X_EXTEND":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_EXTEND":t.texel_mask[0]=0,t.texel_mask[1]=1;break;default:d.panic("Wrong postprocessing effect: "+e)}return t},t.create_subs_glow_combine=function(e,t){var r=a(13);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.small_glow_mask_coeff=t.glow_params.small_glow_mask_coeff,r.large_glow_mask_coeff=t.glow_params.large_glow_mask_coeff,r.small_glow_mask_width=t.glow_params.small_glow_mask_width,r.large_glow_mask_width=t.glow_params.large_glow_mask_width,r.camera=e,r.is_pp=!0,r},t.create_subs_main=function(e,t,n,o,i,s,c,E,l){var T=a(e);0==e?(T.clear_color=!0,T.clear_depth=n,T.blend=!1):1==e?(T.clear_color=!1,T.clear_depth=!1,T.blend=!0):2==e?(T.clear_color=!1,T.clear_depth=!0,T.blend=!0):3==e||4==e?(T.clear_color=!0,T.clear_depth=!0,T.blend=!1):5==e||6==e?(T.clear_color=!1,T.clear_depth=!1,T.blend=!0):7==e?(T.clear_color=!0,T.clear_depth=!1,T.blend=!0):d.panic("wrong main subscene type"),T.blend&&E&&(T.self_shadow_normal_offset=E.self_shadow_normal_offset),T.camera=t;var u=c.sky_texture_param;return u&&(T.sky_tex_fac.set([u.blend_factor,u.horizon_factor,u.zenith_up_factor,u.zenith_down_factor]),T.sky_tex_color.set(u.color),T.sky_tex_default_value=u.default_value),T.horizon_color.set(c.horizon_color),T.zenith_color.set(c.zenith_color),T.environment_energy=c.environment_energy,T.fog_color_density=s.fog_color_density,T.fog_params=s.fog_params,o&&_(T,o,l),r(T,i),T},t.create_subs_resolve=function(){var e=a(14);return e.is_pp=!0,e.camera=f.create_camera(f.TYPE_NONE),e},t.create_subs_color_picking=function(e,t,_){var n=a(15);return t&&(n.type=16,n.clear_color=!1,n.clear_depth=!0),n.enqueue=!1,n.camera=e,r(n,_),n},t.create_subs_debug_view=function(e){var t=a(17);return t.do_render=!1,t.clear_color=!1,t.clear_depth=!1,t.camera=e,t},t.create_subs_anchor_visibility=function(e){var t=a(18);return t.clear_color=!0,t.clear_depth=!1,t.camera=e,t},t.create_subs_shadow_receive=function(e,t,_){var n=a(9);return n.camera=t,r(n,_),n},t.create_subs_depth_pack=function(e){var t=a(19);return t.clear_color=!1,t.clear_depth=!1,t.camera=e,t.is_pp=!0,t},t.create_subs_ssao=function(e,t,r){var _=a(20);return _.clear_color=!1,_.clear_depth=!1,_.depth_test=!1,_.camera=e,_.fog_color_density=t.fog_color_density,_.water_fog_color_density.set(t.fog_color_density),_.ssao_radius_increase=r.radius_increase,_.ssao_hemisphere=r.hemisphere,_.ssao_influence=r.influence,_.ssao_dist_factor=r.dist_factor,_.ssao_samples=r.samples,_.is_pp=!0,_},t.create_subs_ssao_blur=function(e,t){var r=a(21);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=e,r.ssao_blur_depth=t.blur_depth,r.ssao_blur_discard_value=t.blur_discard_value,r.is_pp=!0,r},t.create_subs_aa=function(e){var t=a(22);return t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1,t.texel_size_multiplier=1/e.resolution_factor,t.fxaa_quality=e.aa_quality,t.camera=f.create_camera(f.TYPE_NONE),t.is_pp=!0,t},t.create_subs_smaa=function(e,t){var r=a(e);return r.clear_color=23==e||24==e,r.clear_depth=!1,r.depth_test=!1,r.texel_size_multiplier=1/t.resolution_factor,r.camera=f.create_camera(f.TYPE_NONE),23==e&&(r.jitter_subsample_ind=new Float32Array(4)),r.is_pp=!0,r},t.create_subs_compositing=function(e,t,r,_){var n=a(27);return n.clear_color=!1,n.clear_depth=!1,n.depth_test=!1,n.camera=f.create_camera(f.TYPE_NONE),n.brightness=e,n.contrast=t,n.exposure=r,n.saturation=_,n.is_pp=!0,n},t.create_subs_motion_blur=function(e,t){var r=a(28);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=f.create_camera(f.TYPE_NONE),r.assign_texture=!0,r.mb_decay_threshold=e,r.mb_factor=t,r.is_pp=!0,r},t.create_subs_coc=function(e,t){var r=a(29);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=e,r.texel_size_multiplier=r.camera.dof_power,r.coc_type=t,r.is_pp=!0,r},t.create_subs_dof=function(e,t){var r=a(30);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=e,r.texel_size_multiplier=e.dof_power,r.dof_bokeh=t,r.is_pp=!0,r},t.create_subs_outline_mask=function(e,t){var _=a(31);return _.depth_test=!1,_.camera=e,r(_,t),_},t.create_subs_outline=function(e){var t=a(32);return A.outlining_overview_mode?t.outline_color.set(A.outline_color):t.outline_color.set(e.outline_color),t.outline_factor=e.outline_factor,t.ext_texel_size_mult=5,t.blur_texel_size_mult=3,t.depth_test=!1,t.camera=f.create_camera(f.TYPE_NONE),t.is_pp=!0,t},t.create_subs_god_rays=function(e,t,_,n,o,i,s){var c=a(33);return c.clear_color=!1,c.clear_depth=!1,c.depth_test=!1,c.horizon_color=new Float32Array([1,1,1]),c.zenith_color=new Float32Array([1,1,1]),c.environment_energy=1,c.pack=n,c.water=t,c.radial_blur_step=o,c.max_ray_length=_,c.steps_per_pass=s,c.camera=e,r(c,i),c},t.create_subs_god_rays_comb=function(e,t){var _=a(34);return _.clear_color=!1,_.clear_depth=!1,_.depth_test=!1,_.camera=f.create_camera(f.TYPE_NONE),_.god_rays_intensity=e,r(_,t),_.is_pp=!0,_},t.create_subs_sky=function(e,t,_,n){var o=a(35);o.enqueue=!1,o.clear_color=!1,o.clear_depth=!1,o.depth_test=!1;var i=f.create_camera(f.TYPE_NONE);if(i.width=n,i.height=n,o.camera=i,o.cube_view_matrices=s._5(),r(o,t),o.horizon_color=new Float32Array([1,1,1]),o.zenith_color=new Float32Array([1,1,1]),o.environment_energy=1,o.sky_color.set(_.sky_color),o.procedural_skydome=_.procedural_skydome,o.use_as_environment_lighting=_.use_as_environment_lighting,o.rayleigh_brightness=_.rayleigh_brightness,o.mie_brightness=_.mie_brightness,o.spot_brightness=_.spot_brightness,o.scatter_strength=_.scatter_strength,o.rayleigh_strength=_.rayleigh_strength,o.mie_strength=_.mie_strength,o.rayleigh_collection_power=_.rayleigh_collection_power,o.mie_collection_power=_.mie_collection_power,o.mie_distribution=_.mie_distribution,e){o.horizon_color.set(e.horizon_color),o.zenith_color.set(e.zenith_color),o.environment_energy=e.environment_energy;var c=e.sky_texture_param;c&&(o.sky_tex_fac.set([c.blend_factor,c.horizon_factor,c.zenith_up_factor,c.zenith_down_factor]),o.sky_tex_color.set(c.color),o.sky_tex_default_value=c.default_value,o.sky_invert=c.invert,o.sky_use_rgb_to_intensity=c.use_rgb_to_intensity,o.sky_use_map_blend=c.use_map_blend,o.sky_use_map_horizon=c.use_map_horizon,o.sky_use_map_zenith_up=c.use_map_zenith_up,o.sky_use_map_zenith_down=c.use_map_zenith_down,o.sky_blend_type=c.blend_type),o.use_sky_blend=e.use_sky_blend,o.use_sky_paper=e.use_sky_paper,o.use_sky_real=e.use_sky_real,o.sky_ngraph_proxy_id=e.ngraph_proxy_id}return o},t.create_subs_irradiance=function(e,t){var _=a(46);_.enqueue=!1,_.clear_color=!1,_.clear_depth=!1,_.depth_test=!1;var n=f.create_camera(f.TYPE_NONE);return n.width=t,n.height=t,_.camera=n,_.cube_view_matrices=s._5(),r(_,e),_},t.create_subs_rougness_convolution=function(e){var t=a(47);t.enqueue=!1,t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1;var _=f.create_camera(f.TYPE_NONE);return _.width=128,_.height=128,t.camera=_,t.cube_view_matrices=s._5(),r(t,e),t},t.create_subs_brdf=function(){var e=a(48);e.enqueue=!1,e.clear_color=!1,e.clear_depth=!1,e.depth_test=!1;var t=f.create_camera(f.TYPE_NONE);return t.width=512,t.height=512,e.camera=t,e},t.create_subs_copy=function(){var e=a(36);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_subs_stereo=function(e,t){var r=a(37);return r.clear_color=!1,r.clear_depth=!1,r.subtype=e?"HMD":t?"ANAGLYPH":"SIDEBYSIDE",r.camera=f.create_camera(f.TYPE_NONE),r.is_pp=!0,r},t.create_subs_luminance=function(){var e=a(38);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_subs_av_luminance=function(){var e=a(39);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_resize_subs=function(){var e=a(45);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_subs_luminance_truncated=function(e,t,_,n){var o=a(40);return o.clear_color=!1,o.clear_depth=!1,o.bloom_key=e,o.bloom_edge_lum=t,o.camera=n,r(o,_),o.is_pp=!0,o},t.create_subs_bloom_combine=function(e,t){var r=a(41);return r.clear_color=!1,r.clear_depth=!1,r.camera=f.create_camera(f.TYPE_NONE),r.bloom_blur=e,r.bloom_blur_num=t,r.is_pp=!0,r},t.create_subs_veloctity=function(e){var t=a(42);return t.clear_color=!1,t.clear_depth=!1,t.camera=e,t.is_pp=!0,t},t.create_subs_sink=function(){var e=a(43);return e.enqueue=!1,e},t.create_subs_perf=function(){var e=a(44);return e.is_pp=!0,e},t.subs_label=function(e){switch(e.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+e.pp_effect.replace(/_/g," ")+")";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 46:return"IRRADIANCE";case 47:return"ROUGHNESS_CONVOLUTION";case 48:return"PRE-COMPUTE_BRDF";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";case 45:return"RESIZE";default:return"UNKNOWN"}},t.append_draw_data=function(e,t){for(var r=t.batch,a=r.shader,_=r.alpha_antialiasing,n=0;n<e.draw_data.length;n++){var o=e.draw_data[n],i=o.bundles,s=i.indexOf(t);if(-1!=s&&(i.splice(s,1),!i.length)){e.draw_data.splice(n,1);break}}if(e.blend)var c=r.offset_z;else var c=0;var T=l(e.draw_data,a,_,c,r.is_sky);if(T)T.bundles.push(t);else{var u=E(a,t,_,c,r.is_sky);e.draw_data.push(u),e.need_draw_data_sort=!0}},t.init_bundle=function(e,t,r){var a={do_render:!0,do_render_cube:[!0,!0,!0,!0,!0,!0],obj_render:t,batch:e,world_bounds:r||null,info_for_z_sort_updates:null,z_index:1/0};if(e.z_sort&&e.bufs_data.ibo_array){var _=e.bufs_data.ibo_array;a.info_for_z_sort_updates={median_cache:new Float32Array(_.length),median_world_cache:new Float32Array(_.length),dist_cache:new Float32Array(_.length/3),zsort_eye_last:new Float32Array(3),bb_min_side:c.m(e.bounds_local.bb)}}return a},t.find_bundle=function(e,t,r){for(var a=0;a<e.draw_data.length;a++)for(var _=0;_<e.draw_data[a].bundles.length;_++)if(e.draw_data[a].bundles[_].batch==t&&e.draw_data[a].bundles[_].render==r)return!0;return!1},t.sort_draw_data=function(e){e.draw_data.sort(u),e.need_draw_data_sort=!1}}var _=r(0),n=r(5),o=r(14),i=r(4),s=r(2),c=r(25),E=Object(_.a)("__subscene",a);t.a=E},function(e,t,r){"use strict";function a(e,t){function r(e,t){e.render.outline_intensity=t,a(e)}function a(e){for(var t=e.scenes_data,r=e.render,a=0;a<t.length;a++){var _=t[a],n=_.scene;n._render.outline&&r.outline_intensity&&Fe.request_outline(n)}}function _(e){e.render.outline_intensity=0;var t=rt.indexOf(e);-1!=t&&rt.splice(t,1)}function F(e,t){if(t.uuid=e.uuid,t.is_meta=!1,t.def_action_slots=e._def_action_slots,t.is_dynamic=e._is_dynamic,t.is_hair_dupli=e._is_hair_dupli||!1,_e(e,t),"MESH"===t.type)var r=t.is_dynamic?"DYNAMIC":"STATIC";else var r=t.type;var a=t.render=xe.create_render(r);oe(e,t);var _=e.location,n=e.scale,o=_t;switch(M._29(e.rotation_quaternion,o),Xe.set_translation(t,_),Xe.set_rotation(t,o),Xe.set_scale(t,n),t.use_default_animation=e.b4w_use_default_animation,t.anim_behavior_def=Ne.anim_behavior_bpy_b4w(e.b4w_anim_behavior),e.b4w_object_tags&&(t.metatags={title:e.b4w_object_tags.title,description:e.b4w_object_tags.description,category:e.b4w_object_tags.category}),t.custom_prop=e.b4w_custom_prop,e.b4w_viewport_alignment&&(t.viewport_alignment={alignment:e.b4w_viewport_alignment.alignment,distance:e.b4w_viewport_alignment.distance}),a.hide=e.b4w_hidden_on_load,a.hide_children=e.b4w_hide_chldr_on_load,e.type){case"ARMATURE":x.e(e,t);var i=a.bone_pointers,c=Ne.calc_pose_data(i);e.b4w_animation_mixing?(a.quats_before=new Float32Array(c.quats),a.quats_after=new Float32Array(c.quats),a.trans_before=new Float32Array(c.trans),a.trans_after=new Float32Array(c.trans)):(a.quats_before=c.quats,a.quats_after=c.quats,a.trans_before=c.trans,a.trans_after=c.trans);for(var E in i){var l=i[E];1==l.chain.length&&x.d(l,!0,c.trans,c.quats)}a.pose_data=c,a.frame_factor=0,a.anim_mixing=e.b4w_animation_mixing;break;case"MESH":a.bb_original=he.bb_bpy_to_b4w(e.data.b4w_boundings.bb),t.is_boundings_overridden=e.data.is_boundings_overridden,a.do_not_render=e.b4w_do_not_render,a.selectable=Ve.outlining_overview_mode||e.b4w_selectable,a.origin_selectable=e.b4w_selectable,a.outlining=Ve.outlining_overview_mode||e.b4w_outlining,a.origin_outlining=e.b4w_outlining,a.outline_on_select=Ve.outlining_overview_mode||e.b4w_outline_on_select,a.billboard=e.b4w_billboard,a.billboard_pres_glob_orientation=e.b4w_pres_glob_orientation,a.billboard_type="BASIC",a.billboard_spherical="SPHERICAL"==e.b4w_billboard_geometry;var T=a.outline_anim_settings_default;if(T.outline_duration=e.b4w_outline_settings.outline_duration,T.outline_period=e.b4w_outline_settings.outline_period,T.outline_relapses=e.b4w_outline_settings.outline_relapses,a.selectable&&(a.color_id=Le.gen_color_id(Ze),Ze++),ne(e,t),ee(e,t),a.shadow_cast=e.b4w_shadow_cast,a.shadow_receive=e.b4w_shadow_receive,a.shadow_cast_only=e.b4w_shadow_cast_only&&a.shadow_cast,a.reflexible=e.b4w_reflexible,a.reflexible_only=e.b4w_reflexible_only&&a.reflexible,a.reflective=e.b4w_reflective,a.reflection_type=e.b4w_reflection_type,a.reflective||k(t),a.caustics=e.b4w_caustics,a.wind_bending=e.b4w_wind_bending,e.b4w_wind_bending){a.wind_bending_angle=e.b4w_wind_bending_angle;var u=he.wb_angle_to_amp(M.T(e.b4w_wind_bending_angle),a.bb_original,e.scale[0]);a.wind_bending_amp=u,a.wind_bending_freq=e.b4w_wind_bending_freq,a.detail_bending_freq=e.b4w_detail_bending_freq,a.detail_bending_amp=e.b4w_detail_bending_amp,a.branch_bending_amp=e.b4w_branch_bending_amp,a.main_bend_col=e.b4w_main_bend_stiffness_col;var d=e.b4w_detail_bend_colors;a.detail_bend_col.leaves_stiffness=d.leaves_stiffness_col,a.detail_bend_col.leaves_phase=d.leaves_phase_col,a.detail_bend_col.overall_stiffness=d.overall_stiffness_col}if(a.dynamic_geometry=e.b4w_dynamic_geometry,a.dynamic_geometry){t._bpy_obj=e;for(var P=0;P<t.materials.length;P++){var A=t.materials[P];t.mat_inheritance_data.original_mat_names.push(A.name),t.mat_inheritance_data.is_disabled.push(!1)}}var S=t.materials[0];a.friction=S.physics_settings.friction,a.elasticity=S.physics_settings.elasticity,a.lod_dist_min=0,a.lod_dist_max=xe.LOD_DIST_MAX_INFINITY,a.pass_index=e.pass_index;break;case"LINE":a.bb_local=s.w(),a.be_local=s.y(),a.bb_world=s.w(),a.be_world=s.y();break;case"CAMERA":Re.camera_object_to_camera(e,t),Re.assign_boundings(t);break;case"LAMP":f.a(e,t);break;case"SPEAKER":t.sfx=ke.create_sfx();for(var p=!1,P=0;P<t.scenes_data.length;P++)if(t.scenes_data[P].scene._sfx){p=!0;break}p&&ke.update_object(e,t);break;case"EMPTY":var v=s.w();a.bb_local=v;var m=s.A();a.bs_local=m,e.field&&(t.field={type:e.field.type,strength:e.field.strength}),e.b4w_anchor&&(t.anchor={type:e.b4w_anchor.type,detect_visibility:e.b4w_anchor.detect_visibility,element_id:e.b4w_anchor.element_id,max_width:e.b4w_anchor.max_width})}de(t)}function G(e,t){t.uuid=e.uuid,t.is_meta=!1,t.def_action_slots=e._def_action_slots,t.is_dynamic=e._is_dynamic;var r=t.type;t.render=xe.create_render(r),t.use_default_animation=e.b4w_use_default_animation,t.anim_behavior_def=Ne.anim_behavior_bpy_b4w(e.b4w_anim_behavior),de(t)}function k(e){for(var t=e.materials,r=0;r<t.length;r++){var a=t[r];a.use_nodes&&(K(a.node_tree,"BSDF_GLOSSY")||K(a.node_tree,"BSDF_DIFFUSE")||K(a.node_tree,"BSDF_PRINCIPLED"))&&(e.render.reflective=!0,e.render.reflection_type="PBR")}}function K(e,t){return-1!=e._bsdf_types.indexOf(t)}function B(e){if(e.field)for(var t=e.scenes_data,r=0;r<t.length;r++){var a=t[r].scene;Fe.update_force_scene(a,e)}}function X(e,t){var r=t.render;if("CUBE"==r.reflection_type)r.cube_reflection_id=$e++,tt.push(t);else if("PLANE"==r.reflection_type){var a=H(e,t);a||(a=j(t));for(var _=null,n=0;n<et.length;n++){var o=et[n];if(o==a){_=n;break}}null==_&&(_=et.length,et.push(a)),a.render.plane_reflection_id=_,r.plane_reflection_id=_,a.reflective_objs.push(t)}}function j(e){var t=Le.unique_name("%reflection%"),r=xe.create_object(t,"EMPTY"),a=xe.create_render("EMPTY");return a.data_id=e.render.data_id,r.render=a,Q(e,r),be.append_stiff_obj(r,e,[0,0,0],null,1),de(r),r}function H(e,t){for(var r=e.constraints,a=0;a<r.length;a++){var _=r[a];if("LOCKED_TRACK"==_.type&&"REFLECTION PLANE"==_.name){if(_.target&&_.target._object)return _.target._object;Ce.warn('Reflection plane target for object: "'+t.name+"\" is not present on the scene. Using object's Z-axis.")}}return null}function Q(e,t){for(var r=e.scenes_data,a=t.scenes_data,_=0;_<r.length;_++){for(var n=!1,o=0;o<a.length;o++)if(r[_].scene==a[o].scene){n=!0;break}n||z(t,r[_].scene)&&xe.append_scene_data(t,r[_].scene)}}function z(e,t){return!(!t._is_main&&"SPEAKER"==e.type)&&!(!t._is_primary_thread&&"LAMP"==e.type)}function q(e){var t=Ne.bpy_mesh_empty_is_animatable(e),r=e.b4w_do_not_batch,a=e.b4w_collision,_=e.b4w_vehicle,n=e.b4w_floating,o=e.b4w_character,i=Ue.has_dynamic_grass_particles(e),s=ye.bpy_obj_has_nla(e),c=e.data.b4w_shape_keys.length>0,E=e.b4w_dynamic_geometry,l=V(e);return We||t||r||a||_||c||n||i||o||s||E||J(e)||l}function V(e){var t=!1,r=e.constraints.length;if(r){for(var a=null,_=r-1;_>=0;_--){var n=e.constraints[_];if("LOCKED_TRACK"!=n.type||"REFLECTION PLANE"!=n.name){a=n;break}}if(!a)return!1;if(!a.target)return!1;var o=a.target,i=o.type;if(o.parent){var s=o.parent.type;return t="MESH"==s?t||q(o.parent):"EMPTY"!=s||(t||W(o.parent))}t="MESH"==i?t||q(o):"EMPTY"!=i||(t||W(o))}return t}function W(e){var t=Ne.bpy_mesh_empty_is_animatable(e),r=ye.bpy_obj_has_nla(e),a=e.b4w_do_not_batch,_=Boolean(e.b4w_anchor),n=V(e);return t||r||a||_||n}function J(e){for(var t=e.data,r=0;r<t.materials.length;r++){var a=t.materials[r];if(a.water_settings.is_water)return!0;if(a.is_lens_flares)return!0;if(Z(a.node_tree))return!0}return!1}function Z(e){if(!e)return!1;for(var t=e.nodes,r=0;r<t.length;r++){var a=t[r];if("VECT_TRANSFORM"==a.type){var _=a.convert_from,n=a.convert_to,o=a.outputs[0];if(o.is_linked&&("WORLD"!=_||"CAMERA"!=n)&&("CAMERA"!=_||"WORLD"!=n)&&("OBJECT"!=_||"OBJECT"!=n))return!0}if("NORMAL_MAP"==a.type){var i=a.space,o=a.outputs[0];if(o.is_linked&&("OBJECT"==i||"BLENDER_OBJECT"==i))return!0}if("TEX_COORD"==a.type){if(a.outputs[3].is_linked)return!0}if("OBJECT_INFO"==a.type){var s=a.outputs[0],c=a.outputs[1],E=a.outputs[3];if(s.is_linked||c.is_linked||E.is_linked)return!0}}return!1}function $(e,t,r){var a=t.render,_=e.data;t.armobj=r;var n=_.vertex_groups;if(n.length){var o=r.render.bone_pointers,i=0,s={};for(var c in o){var E=M._19("name",c,n);if(E){var l=o[c];s[c]={vgroup_index:E.index,bone_index:l.bone_index,deform_bone_index:i++}}}a.bone_skinning_info=s;var T=i,u=Ne.get_max_bones();a.max_bones=T,T>2*u?(a.is_skinning=!1,Ce.error('too many bones for "'+e.name+'" / '+a.max_bones+" bones (max "+u+" with blending, "+2*u+" without blending). Skinning will be disabled.")):a.is_skinning=!0}}function ee(e,t){"MESH"!=e.type&&ge.panic("Wrong object type: "+e.name);var r=t.render;if(e.data.b4w_shape_keys.length){r.use_shape_keys=!0;for(var a=0;a<e.data.b4w_shape_keys.length;a++){var _={};_.value=e.data.b4w_shape_keys[a].value,_.name=e.data.b4w_shape_keys[a].name,r.shape_keys_values.push(_)}}else r.use_shape_keys=!1}function te(e){if(Ee(e,Je.ALL,!1,nt)){for(var t,r=1;;){if(t="."+(String(r).length<3?("000"+String(r)).slice(-3):String(r)),!Ee(e+t,Je.ALL,!1,nt))break;r++}return Ce.error('Object "'+e+'" already exists. Name was replaced by "'+e+t+'".'),t}return""}function re(e,t,r){var a=t,_=xe.get_dg_parent(e),n=_?xe.gen_dupli_name(_.name,t):t,o=te(n);n+=o,a+=o;var i=xe.create_object(n,e.type,a);i.is_meta=e.is_meta,i._bpy_obj=e._bpy_obj,i.mat_inheritance_data.original_mat_names=xe.copy_bpy_object_props_by_link(e.mat_inheritance_data.original_mat_names),i.mat_inheritance_data.is_disabled=xe.copy_bpy_object_props_by_link(e.mat_inheritance_data.is_disabled),i.is_dynamic=e.is_dynamic,i.is_hair_dupli=e.is_hair_dupli,i.use_default_animation=e.use_default_animation,i.def_action_slots=e.def_action_slots,i.render=xe.clone_render(e.render),i.render.is_lod=!1,i.metatags=xe.copy_object_props_by_value(e.metatags),i.custom_prop=xe.copy_object_props_by_value(e.custom_prop),Q(e,i),i.action_anim_cache=xe.copy_bpy_object_props_by_link(e.action_anim_cache),i.parent=xe.copy_bpy_object_props_by_link(e.parent),i.parent_is_dupli=e.parent_is_dupli,i.parent_bone=e.parent_bone,i.vertex_anim=xe.copy_bpy_object_props_by_link(e.vertex_anim),i.anim_behavior_def=e.anim_behavior_def,e.physics&&!(e.is_vehicle||e.is_character||e.is_floating)&&(i.use_obj_physics=e.use_obj_physics,i.physics=null),i.collision_id=e.collision_id,i.correct_bounding_offset=e.correct_bounding_offset,i.physics_settings=xe.copy_object_props_by_value(e.physics_settings),ae(e,i,r);for(var s=0;s<e.materials.length;s++)i.materials.push(P.a(e.materials[s]));return xe.scene_data_set_active(i,!1),de(i),i}function ae(e,t,r){for(var a=[],_=0;_<e.scenes_data.length;_++){var n=e.scenes_data[_],o=t.scenes_data[_],i=n.batches;if(r){for(var s=o.batches,c=0;c<i.length;c++)if(!i[c].forked_batch){var E=xe.copy_object_props_by_value(i[c]);E.bufs_data=Me.clone_bufs_data(i[c].bufs_data),xe.append_batch(t,o.scene,E),a.push(i[c].bufs_data)}for(var c=0;c<i.length;c++)if(i[c].forked_batch){var l=xe.copy_object_props_by_value(i[c]);xe.append_batch(t,o.scene,l);for(var T=0;T<a.length;T++)a[T]==i[c].bufs_data&&(l.bufs_data=s[T].bufs_data)}for(var c=0;c<s.length;c++)s[c].bufs_data&&Me.update_gl_buffers(s[c].bufs_data),qe.allow_vao_ext&&s[c].bufs_data&&He.assign_vao(s[c]),s[c].odd_id_prop=he.generate_odd_id(s[c],t.render,t.uuid),he.update_batch_id(s[c]);Ke.share_batch_canvas_textures(s)}else for(var c=0;c<i.length;c++)xe.append_batch(t,o.scene,i[c])}}function _e(e,t){t.is_vehicle=e.b4w_vehicle,t.is_character=e.b4w_character,t.is_floating=e.b4w_floating,t.use_obj_physics=e.b4w_collision,t.collision_id=e.b4w_collision_id,t.correct_bounding_offset=e.b4w_correct_bounding_offset;var r=e.game;t.physics_settings={physics_type:r.physics_type,use_ghost:r.use_ghost,use_sleep:r.use_sleep,mass:r.mass,velocity_min:r.velocity_min,velocity_max:r.velocity_max,damping:r.damping,rotation_damping:r.rotation_damping,lock_location_x:r.lock_location_x,lock_location_y:r.lock_location_y,lock_location_z:r.lock_location_z,lock_rotation_x:r.lock_rotation_x,lock_rotation_y:r.lock_rotation_y,lock_rotation_z:r.lock_rotation_z,collision_margin:r.collision_margin,collision_group:r.collision_group,collision_mask:r.collision_mask,use_collision_bounds:r.use_collision_bounds,collision_bounds_type:r.collision_bounds_type,use_collision_compound:r.use_collision_compound};var a=e.b4w_vehicle_settings;a&&(t.vehicle_settings={name:a.name,part:a.part,suspension_rest_length:a.suspension_rest_length,suspension_compression:a.suspension_compression,suspension_stiffness:a.suspension_stiffness,suspension_damping:a.suspension_damping,wheel_friction:a.wheel_friction,roll_influence:a.roll_influence,max_suspension_travel_cm:a.max_suspension_travel_cm,force_max:a.force_max,brake_max:a.brake_max,steering_max:a.steering_max,max_speed_angle:a.max_speed_angle,delta_tach_angle:a.delta_tach_angle,speed_ratio:a.speed_ratio,steering_ratio:a.steering_ratio,inverse_control:a.inverse_control,floating_factor:a.floating_factor,water_lin_damp:a.water_lin_damp,water_rot_damp:a.water_rot_damp,synchronize_position:a.synchronize_position});var _=e.b4w_floating_settings;_&&(t.floating_settings={name:_.name,part:_.part,floating_factor:_.floating_factor,water_lin_damp:_.water_lin_damp,water_rot_damp:_.water_rot_damp,synchronize_position:_.synchronize_position});var n=e.b4w_character_settings;n&&(t.character_settings={walk_speed:n.walk_speed,run_speed:n.run_speed,step_height:n.step_height,jump_strength:n.jump_strength,waterline:n.waterline});for(var o=0;o<e.constraints.length;o++){var i=e.constraints[o];"RIGID_BODY_JOINT"==i.type&&t.physics_constraints.push({target:i.target._object,pivot_type:i.pivot_type,pivot_x:i.pivot_x,pivot_y:i.pivot_y,pivot_z:i.pivot_z,axis_x:i.axis_x,axis_y:i.axis_y,axis_z:i.axis_z,use_limit_x:i.use_limit_x,use_limit_y:i.use_limit_y,use_limit_z:i.use_limit_z,use_angular_limit_x:i.use_angular_limit_x,use_angular_limit_y:i.use_angular_limit_y,use_angular_limit_z:i.use_angular_limit_z,limit_max_x:i.limit_max_x,limit_max_y:i.limit_max_y,limit_max_z:i.limit_max_z,limit_min_x:i.limit_min_x,limit_min_y:i.limit_min_y,limit_min_z:i.limit_min_z,limit_angle_max_x:i.limit_angle_max_x,limit_angle_max_y:i.limit_angle_max_y,limit_angle_max_z:i.limit_angle_max_z,limit_angle_min_x:i.limit_angle_min_x,limit_angle_min_y:i.limit_angle_min_y,limit_angle_min_z:i.limit_angle_min_z})}}function ne(e,t){for(var r=0;r<e.data.b4w_vertex_anim.length;r++){var a=e.data.b4w_vertex_anim[r];t.vertex_anim.push({name:a.name,frame_start:a.frame_start,frame_end:a.frame_end,averaging:a.averaging,averaging_interval:a.averaging_interval,allow_nla:a.allow_nla})}t.render.vertex_anim=!!t.vertex_anim.length}function oe(e,t){if(e.parent){if(t.parent=e.parent._object,"BONE"==e.parent_type&&"ARMATURE"==e.parent.type&&(t.parent_bone=e.parent_bone),e.pinverse_tsr)if(9===e.pinverse_tsr.length)t.pinverse_tsr=L.a(e.pinverse_tsr,L.b());else{t.pinverse_tsr=L.b();var r=y.set(e.pinverse_tsr[0],e.pinverse_tsr[1],e.pinverse_tsr[2],at),a=e.pinverse_tsr[3],_=N.set(e.pinverse_tsr[4],e.pinverse_tsr[5],e.pinverse_tsr[6],e.pinverse_tsr[7],_t);L.t(r,a,_,t.pinverse_tsr)}}else e.dg_parent&&(t.parent=e.dg_parent._object,t.parent_is_dupli=!0)}function ie(e,t,r){for(var a=Je[t]||[],_=[],n=0;n<a.length;n++){var o=a[n];if(o.render.data_id==r||r==nt)for(var i=o.scenes_data,s=0;s<i.length;s++){var c=i[s];c.scene==e&&_.push(o)}}return _}function se(e,t){var r=Je[e]||[];if(t==nt)return r;for(var a=[],_=0;_<r.length;_++){var n=r[_];n.render.data_id==t&&a.push(n)}return a}function ce(e,t,r,a){for(var _=0;_<e.scenes_data.length;_++)for(var n=e.scenes_data[_].batches,o=0;o<n.length;o++){var i=n[o];i.bufs_data&&(i.bufs_data.cleanup_gl_data_on_unload=t),i.cleanup_gl_data_on_unload=t,i.shader&&(i.shader.cleanup_gl_data_on_unload=r),he.set_cleanup_nodemat(a)}}function Ee(e,t,r,a,_){for(var n=null,o=0;o<t.length;o++){var i=t[o];if((r?i.origin_name:i.name)==e&&(i.render.data_id==a||a==nt)&&(!_||!i.is_meta)&&(n=i,!xe.get_dg_parent(n)))break}return n}function le(e,t,r,a){for(var _=0;_<r.length;_++){var n=r[_];if(n.origin_name==t&&(n.render.data_id==a||a==nt)){var o=xe.get_dg_parent(n);if(o&&o.origin_name==e)return n}}return null}function Te(e,t,r){for(var a=0;a<t.length;a++){for(var _=t[a],n=e.length-1,o=_,i=!0;n>=0&&i;)i=o&&o.origin_name==e[n]&&(o.render.data_id==r||r==nt),o&&(o=xe.get_dg_parent(o)),n--;if(i&&!o)return _}return null}function ue(e,t){var r=0,a=e.outline_animation;0==a.time_start&&(a.time_start=t);var n=t-a.time_start;if(a.relapses&&n/a.period>=a.relapses)return void _(e);var o=n%a.period;if(o<a.outline_time){var i=o/(a.outline_time/5),s=Math.floor(i);switch(s){case 0:r=(i-s)/2;break;case 1:r=(i-s)/2+.5;break;case 2:r=1;break;case 3:r=1-(i-s)/2;break;case 4:r=.5-(i-s)/2}}e.render.outline_intensity=r}function de(e){Je.ALL.push(e),Je[e.type]||(Je[e.type]=[]),Je[e.type].push(e);var t=e.render.plane_reflection_id;if(null!=t)for(var r=0;r<et.length;r++){var a=et[r];a.render.plane_reflection_id==t&&a.reflective_objs.push(e)}}function fe(e){var t=Je.ALL,r=Je[e.type],a=t.indexOf(e),_=r.indexOf(e);-1!=a&&t.splice(a,1),-1!=_&&r.splice(_,1)}function Pe(e,t,r){if(!t.is_lod)return!0;var a=e.lod_settings;if(a.dest_coverage!=a.coverage)if(a.use_smoothing){var _=M._50(a.dest_coverage-a.coverage);a.coverage+=_*Be.get_delta()/ot,a.coverage=M.M(a.coverage,0,1)}else a.coverage=a.dest_coverage;if("STATIC"==t.type)var n=t.lod_center;else var n=y.add(t.bs_world.center,t.main_lod_offset,at);var o=y.dist(n,r);if(0==a.hyst_prev_state)var i=Math.max(t.lod_dist_min-a.hyst_interval_min/2,0),s=t.lod_dist_max+a.hyst_interval_max/2;else if(-1==a.hyst_prev_state)var i=t.lod_dist_min+a.hyst_interval_min/2,s=t.lod_dist_max+a.hyst_interval_max/2;else var i=Math.max(t.lod_dist_min-a.hyst_interval_min/2,0),s=Math.max(t.lod_dist_max-a.hyst_interval_max/2,0);return a.hyst_prev_state=o<i?-1:o<s?0:1,a.dest_coverage=o<i||o>s?0:1,a.cmp_logic=0==a.dest_coverage?-1:1,Math.abs(o-a.prev_dist)>qe.lod_leap_smooth_threshold&&(0==a.coverage||1==a.coverage)&&(a.coverage=a.dest_coverage),a.prev_dist=o,0!=a.dest_coverage||0!=a.coverage}function Ae(e,t){var r=e.render,a=t._render;if(r.is_lod)for(var _=Xe.get_translation(t._camera,at),n=0;n<e.scenes_data.length;n++)if(e.scenes_data[n].scene==t)for(var o=0;o<e.scenes_data[n].batches.length;o++){var i=e.scenes_data[n].batches[o],s=i.lod_settings,c="SHADOW"==i.type&&"RECEIVE"==i.subtype&&!qe.reuse_depth_optimization;if(qe.lod_smooth_transitions&&!c){var E=a.lod_smooth_type;("ALL"==E||"NON-OPAQUE"==E&&(i.blend||i.alpha_clip))&&(s.use_smoothing=!0)}Pe(i,r,_),s.coverage=s.dest_coverage,s.hyst_interval_min=Math.min(a.lod_hyst_interval,2*it*r.lod_lower_border_range),s.hyst_interval_max=Math.min(a.lod_hyst_interval,2*it*r.lod_upper_border_range)}}function Se(e,t){ce(e,!0,!1,!0);for(var r=se("ALL",nt),a=0;a<r.length;a++){var _=r[a];_!=e&&ce(_,!1,!1,!1)}Fe.remove_object_bundles(e,t);for(var a=0;a<e.scenes_data.length;a++)for(var n=e.scenes_data[a].batches.length-1;n>=0;n--){var o=e.scenes_data[a].batches[n];0!=o.material_names.length&&-1==o.material_names.indexOf(t)||xe.scene_data_remove_batch(e.scenes_data[a],n)}we.obj_has_physics(e)&&we.remove_object(e);for(var a=0;a<r.length;a++)r[a]!=e&&ce(r[a],!0,!0,!0);Ne.delete_cached_anim_data_by_mat(e,t);var i=e._bpy_obj._object;return e._bpy_obj._object=e,i}function pe(e,t){e._bpy_obj._object=t,ce(e,!0,!0,!0)}function ve(e,t,r,a){var _=e.mat_inheritance_data.original_mat_names.indexOf(t),n=r.mat_inheritance_data.original_mat_names.indexOf(a),o=e.materials[_];r.materials[n]=o;var i=o.name;o.name=a;for(var s=0;s<r.materials.length;s++)r.mat_inheritance_data.is_disabled[s]=!(s==n);return i}function me(e,t,r,a){for(var _=0;_<r.materials.length;_++)r.mat_inheritance_data.is_disabled[_]=!1;var n=e.mat_inheritance_data.original_mat_names.indexOf(t);e.materials[n].name=a}function Oe(e,t,r,a,_){for(var n=1;n<e.render.shape_keys_values.length;n++){var o=e.render.shape_keys_values[n].name,i=e.render.shape_keys_values[n].value;Me.apply_shape_key(e,o,i)}if(Ne.is_animated(e))for(var n=0;n<e.anim_slots.length;n++){var s=e.anim_slots[n];if(s)switch(s.type){case Ne.OBJ_ANIM_TYPE_PARTICLES:var c=Ne.get_current_frame_float(e,n);Ne.set_frame(e,c,n);break;case Ne.OBJ_ANIM_TYPE_MATERIAL:if(s.node_batches)for(var E=s.node_batches.length-1;E>=0;E--){var l=s.node_batches[E];-1!=l.material_names.indexOf(t)&&s.node_batches.splice(E,1)}}}if(a){var T=function(t){if(t.particles_data){var r=t.particles_data.name;if(a[r]){var _=t.particles_data.count_factor!=a[r].count_factor;t.particles_data=Ue.clone_particles_data(a[r]),_&&Ue.set_factor(e,r,t.particles_data.count_factor)}}};he.iterate_batches_by_mat(e,t,T,"PARTICLES")}if(_){var u=he.find_batch_material(e,t,"MAIN");u&&(u.diffuse_color.set(_.diffuse_color),u.diffuse_intensity=_.diffuse_intensity,u.diffuse_color_factor=_.diffuse_color_factor,u.diffuse_params.set(_.diffuse_params),u.specular_color.set(_.specular_color),u.specular_color_factor=_.specular_color_factor,u.specular_params.set(_.specular_params),u.specular_alpha=_.specular_alpha,u.emit=_.emit,u.ambient=_.ambient,u.alpha_factor=_.alpha_factor,u.mirror_factor=_.mirror_factor,u.normal_factor=_.normal_factor,u.reflect_factor=_.reflect_factor,u.refr_bump=_.refr_bump,u.fresnel_params.set(_.fresnel_params),u.parallax_scale=_.parallax_scale,u.texture_scale.set(_.texture_scale),u.shallow_water_col.set(_.shallow_water_col),u.shallow_water_col_fac=_.shallow_water_col_fac,u.shore_water_col.set(_.shore_water_col),u.shore_water_col_fac=_.shore_water_col_fac,u.foam_factor=_.foam_factor,u.water_norm_uv_velocity=_.water_norm_uv_velocity,u.node_values=_.node_values.slice(),u.node_rgbs=_.node_rgbs.slice())}var d=function(t){for(var a=0;a<t.bpy_tex_names.length;a++){var _=t.bpy_tex_names[a],n=t.textures[a];if("IMAGE"==n.source||"ENVIRONMENT"==n.source){var o=Ke.get_texture_by_name(r,_);o&&n.img_full_filepath!=o.img_full_filepath&&Ke.set_texture_by_name(e,_,o)}}};he.iterate_batches_by_mat(e,t,d)}var Ne=Object(n.a)(e),ge=Object(o.a)(e),he=Object(i.a)(e),Re=Object(c.a)(e),Ie=Object(E.a)(e),be=Object(l.a)(e),Ye=Object(T.a)(e),Le=Object(u.a)(e),Me=Object(d.a)(e),ye=Object(A.a)(e),xe=Object(S.a)(e),Ue=Object(p.a)(e),we=Object(v.a)(e),Ce=Object(m.a)(e),De=Object(O.a)(e),Fe=Object(g.a)(e),Ge=Object(h.a)(e),ke=Object(R.a)(e),Ke=Object(I.a)(e),Be=Object(b.a)(e),Xe=Object(Y.a)(e),je=Object(U.a)(e),He=Object(w.a)(e),Qe=Object(C.a)(e),ze=Object(D.a)(e),qe=Ie.defaults,Ve=Ie.outlining,We=!1,Je={ALL:[]},Ze=0,$e=0,et=[],tt=[],rt=[],at=new Float32Array(3),_t=new Float32Array(4),nt=-1,ot=.4,it=.3;t.GET_OBJECT_BY_NAME=0,t.GET_OBJECT_BY_DUPLI_NAME=1,t.GET_OBJECT_BY_DUPLI_NAME_LIST=2,t.DATA_ID_ALL=nt,t.update=function(e,t){for(var r=0;r<rt.length;r++){var _=rt[r];ue(_,e),_.render.outline_intensity&&a(_)}var n=Je.ARMATURE;if(n)for(var r=0;r<n.length;r++){var o=n[r];o.need_update_transform&&(Xe.update_transform(o),o.need_update_transform=!1)}},t.set_outline_intensity=r,t.apply_outline_anim=function(e,t,r,a){var _=e.outline_animation;_.time_start=0,_.outline_time=t,_.period=r,_.relapses=a,-1==rt.indexOf(e)&&rt.push(e)},t.clear_outline_anim=_,t.create_object_from_bpy=function(e,t){var r=t?"%meta_world%"+e.name:e.name,a=t?"%meta_world%"+e.name:e.origin_name,_=t?"WORLD":e.type,n=xe.create_object(r,_,a);if("MESH"==n.type)for(var o=0;o<e.data.materials.length;o++)n.materials.push(e.data.materials[o]);for(var o=0;o<e._scenes.length;o++)xe.append_scene_data(n,e._scenes[o]);return e._object=n,t?G(e,n):F(e,n),n},t.update_object_relations=function(e,t){var r=t.render;if("MESH"==t.type){var a=Ne.get_bpy_armobj(e);if(a){var _=a._object,n=_.render.pose_data;$(e,t,_);var o=Ne.extract_skinned_pose_data(n.trans,n.quats,r.bone_skinning_info);a.b4w_animation_mixing?(r.quats_before=new Float32Array(o.quats),r.quats_after=new Float32Array(o.quats),r.trans_before=new Float32Array(o.trans),r.trans_after=new Float32Array(o.trans)):(r.quats_before=o.quats,r.quats_after=o.quats,r.trans_before=o.trans,r.trans_after=o.trans),r.arm_rel_trans=new Float32Array(4),r.arm_rel_quat=N.create(),r.pose_data=o,r.frame_factor=0}r.reflective&&X(e,t)}},t.update_force=B,t.unload_plane_reflections=function(e){if(e.render.plane_reflection_id>=0)for(var t=0;t<e.scenes_data.length;t++){for(var r=e.scenes_data[t].scene._render.graph,a=0;a<et.length;a++){var _=et[a];if(_.render.plane_reflection_id==e.render.plane_reflection_id){var n=_.reflective_objs.indexOf(e);n>-1&&_.reflective_objs.splice(n,1);var o=[];Qe.traverse(r,function(e,t){t.type!=Ge.MAIN_PLANE_REFLECT&&t.type!=Ge.MAIN_PLANE_REFLECT_BLEND||t.refl_obj!=_||o.push(t)});for(var i=0;i<o.length;i++){var s=o[i],c=Qe.get_node_id(r,s);Qe.remove_node(r,c),Fe.clear_subscene(s)}Qe.cleanup_loose_edges(r)}}e.scenes_data[t].scene._render.queue=ze.create_rendering_queue(r)}},t.unload_cube_reflections=function(e){if(e.render.cube_reflection_id>=0)for(var t=0;t<e.scenes_data.length;t++){for(var r=e.scenes_data[t].scene._render.graph,a=0;a<tt.length;a++){var _=tt[a];if(_.render.cube_reflection_id==e.render.cube_reflection_id){var n=[];Qe.traverse(r,function(e,t){t.type!=Ge.MAIN_CUBE_REFLECT&&t.type!=Ge.MAIN_CUBE_REFLECT_BLEND||t.refl_obj!=_||n.push(t)});for(var o=0;o<n.length;o++){var i=n[o],s=Qe.get_node_id(r,i);Qe.remove_node(r,s),Fe.clear_subscene(i)}Qe.cleanup_loose_edges(r)}}e.scenes_data[t].scene._render.queue=ze.create_rendering_queue(r)}},t.copy_scene_data=Q,t.check_bpy_obj_scene_compatibility=z,t.update_objects_dynamics=function(e){for(var t=0;t<e.length;t++){var r=e[t];!r.render||"DYNAMIC"!=r.render.type&&"CAMERA"!=r.render.type||Xe.update_transform(r),r.use_default_animation&&Ne.obj_is_animatable(r)&&(Ne.apply_def(r),r.anim_slots.length&&Ne.play(r,null,Ne.SLOT_ALL))}},t.bpy_obj_is_dynamic=function(e){if(e.b4w_hidden_on_load)return!0;if(e.dg_parent&&e.dg_parent._is_dynamic)return!0;if(e.parent&&e.parent._is_dynamic)return!0;switch(e.type){case"MESH":return q(e);case"EMPTY":return W(e);default:return!0}},t.get_meta_tags=function(e){return M.O(e.metatags)},t.get_custom_prop=function(e){return e.custom_prop},t.cleanup=function(){Ze=0,$e=0,et.length=0,tt.length=0,rt.length=0,Je={ALL:[]}},t.copy=function(e,t,r){var a=re(e,t,r);return a.render.is_copied=!0,a.render.is_copied_deep=r,a.render.color_id=Le.gen_color_id(Ze),Ze++,a},t.get_bpy_def_action_slots=function(e,t){var r=[],a=e.animation_data,_=e.data?e.data.animation_data:null;if(a&&a.action){var n=a.action;(n._render.type==Ne.OBJ_ANIM_TYPE_OBJECT||n._render.type==Ne.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==e.type||n._render.type==Ne.OBJ_ANIM_TYPE_LIGHT&&"LAMP"==e.type||n._render.type==Ne.OBJ_ANIM_TYPE_ENVIRONMENT&&t)&&r.push(Ne.init_action_slot(null,n))}return _&&_.action&&("SPEAKER"==e.type||"LAMP"==e.type)&&r.push(Ne.init_action_slot(null,_.action)),"MESH"==e.type&&r.push.apply(r,Ne.get_bpy_material_actions(e)),t&&r.push.apply(r,Ne.get_bpy_world_material_actions(e)),r},t.update_boundings=function(e){for(var t=e.render,r=null,a=e.scenes_data[0].batches,_=0;_<a.length;_++){var n=a[_],o=e.scenes_data[0].batch_world_bounds[_];if(n.bufs_data&&o.be&&o.bb){var i=Me.get_vbo_type_by_attr_name("a_position"),c=Me.get_vbo_source_by_type(n.bufs_data.vbo_source_data,i);if(c){var E=n.bufs_data.pointers.a_position.offset,l=n.bufs_data.pointers.a_position.length+E;he.update_local_bounds_from_pos(n,c.subarray(E,l)),xe.update_world_bounds_from_batch_tsr(n,t.world_tsr,o),"MAIN"==n.type&&(r?s.D(r,n.bounds_local.bb):r=s.n(n.bounds_local.bb))}}}if(r=r||s.w(),t.billboard)xe.update_render_bounds_billboard(e,r);else{for(var T=[],_=0;_<a.length;_++){var n=a[_];if("MAIN"==n.type){var i=Me.get_vbo_type_by_attr_name("a_position"),c=Me.get_vbo_source_by_type(n.bufs_data.vbo_source_data,i);if(c){var u=a[_].bufs_data.pointers,E=u.a_position.offset,l=u.a_position.length+E;T.push(c.subarray(E,l))}}}xe.update_render_bounds_from_pos_arrays(e,r,T)}if(qe.debug_view)for(var _=0;_<a.length;_++)if("DEBUG_VIEW"===a[_].type&&a[_].debug_sphere){var d=t.be_local,f=De.generate_uv_sphere(16,8,1,d.center,!1,!1),P=[d.axis_x[0],d.axis_y[1],d.axis_z[2]];Me.scale_submesh_xyz(f,P,d.center),Me.submesh_drop_indices(f,1,!0),f.va_common.a_polyindex=Me.extract_polyindices(f),he.update_batch_geometry(a[_],f);break}},t.get_scene_objs=ie,t.get_scene_objs_derived=function(e,t,r){for(var a=Je[t]||[],_=[],n=0;n<a.length;n++){var o=a[n];if(!(o.render.data_id!=r&&r!=nt||o.is_meta))for(var i=o.scenes_data,s=0;s<i.length;s++){var c=i[s];c.scene==e&&_.push(o)}}return _},t.get_all_objects=se,t.get_first_character=function(e){var t=Je.MESH;if(t)for(var r=0;r<t.length;r++){var a=t[r];if(we.has_character_physics(a))for(var _=a.scenes_data,n=0;n<_.length;n++){var o=_[n];if(o.scene==e)return a}}return null},t.obj_switch_cleanup_flags=ce,t.get_selectable_objects=function(){var e=[],t=Je.MESH;if(t)for(var r=0;r<t.length;r++){var a=t[r];a.render.selectable&&!a.is_meta&&e.push(a)}return e},t.get_outlining_objects=function(){var e=[],t=Je.MESH;if(t)for(var r=0;r<t.length;r++){var a=t[r];a.render.outlining&&!a.is_meta&&e.push(a)}return e},t.get_object=function(){var e=null,r=Je.ALL;switch(arguments[0]){case t.GET_OBJECT_BY_NAME:e=Ee(arguments[1],r,!0,arguments[2],arguments[3]);break;case t.GET_OBJECT_BY_DUPLI_NAME:e=le(arguments[1],arguments[2],r,arguments[3]);break;case t.GET_OBJECT_BY_DUPLI_NAME_LIST:e=Te(arguments[1],r,arguments[2])}return e},t.get_world_by_name=function(e,t){return Ee("%meta_world%"+e,Je.WORLD,!0,t)},t.get_world_name=function(e){return e.origin_name.replace("%meta_world%","")},t.pick_object=function(e,r){var a=Fe.get_main();if(!a)return Ce.error("No active scene"),null;var _=Fe.get_subs(a,Ge.STEREO);if(_&&_.enable_hmd_stereo){var n=Ye.get_canvas();e=n.clientHeight/2,r=n.clientWidth/2}var o=je.pick_anchor(e,r);if(o)return o;var i=Fe.pick_color(a,e,r);if(!i)return null;for(var s=ie(a,"MESH",nt),c=0;c<s.length;c++){var E=s[c].render,l=E.color_id;if(l&&Math.abs(255*l[0]-i[0])<3&&Math.abs(255*l[1]-i[1])<3&&Math.abs(255*l[2]-i[2])<3){if(E.outlining&&E.outline_on_select)if(Ve.outlining_overview_mode)t.apply_outline_anim(s[c],Ve.outline_duration,Ve.outline_period,Ve.outline_relapses);else{var T=E.outline_anim_settings_default;t.apply_outline_anim(s[c],T.outline_duration,T.outline_period,T.outline_relapses)}return s[c]}}return null},t.set_wind_params=function(e,t){for(var r=ie(e,"EMPTY",nt),a=0;a<r.length;a++){var _=r[a];if(_.field&&"WIND"===_.field.type){var n=_;break}}if(!n)return Ce.error("There is no wind on the scene"),0;if("number"==typeof t.wind_dir){var o=M.T(t.wind_dir);y.set(Math.sin(o),-Math.cos(o),0,at),M.U(at,M.f,_t),Xe.set_rotation(n,_t)}"number"==typeof t.wind_strength&&(n.field.strength=t.wind_strength),B(n)},t.remove_object=function(e){be.check_constraint(e)&&be.remove(e),fe(e)},t.objects_storage_add=de,t.objects_storage_check=function(e){return Je[e.type]&&Je[e.type].indexOf(e)>-1},t.update_lod_scene=function(e,t){e.render.is_lod&&Ae(e,t)},t.update_lod_visibility=Pe,t.set_hair_particles_wind_bend_params=function(e){for(var t=e.render,r=t.wind_bending_amp,a=t.wind_bending_freq,_=t.detail_bending_freq,n=t.detail_bending_amp,o=t.branch_bending_amp,i=e.scenes_data,s=0;s<i.length;s++)for(var c=i[s].batches,E=0;E<c.length;E++){var l=c[E],T=l.bufs_data,u=T.pointers,d=u.au_wind_bending_amp,f=u.au_wind_bending_freq,P=u.au_detail_bending_amp,A=u.au_detail_bending_freq,S=u.au_branch_bending_amp;if(f){var p=Array.apply(null,Array(f.length)).map(function(){return a});Me.update_gl_buffer_sub_data(T,Me.VBO_FLOAT,new Float32Array(p),f.offset)}if(d){var p=Array.apply(null,Array(d.length)).map(function(){return r});Me.update_gl_buffer_sub_data(T,Me.VBO_FLOAT,new Float32Array(p),d.offset)}if(P){var p=Array.apply(null,Array(P.length)).map(function(){return n});Me.update_gl_buffer_sub_data(T,Me.VBO_FLOAT,new Float32Array(p),P.offset)}if(A){var p=Array.apply(null,Array(A.length)).map(function(){return _});Me.update_gl_buffer_sub_data(T,Me.VBO_FLOAT,new Float32Array(p),A.offset)}if(S){var p=Array.apply(null,Array(S.length)).map(function(){return o});Me.update_gl_buffer_sub_data(T,Me.VBO_FLOAT,new Float32Array(p),S.offset)}}},t.inherit_material=function(e,t,r,a){if(e.render.dynamic_geometry&&r.render.dynamic_geometry){var _=he.find_batch_material(e,t,"MAIN"),n=null,o=function(e){n||(n={}),e.particles_data&&(n[e.particles_data.name]=e.particles_data)};he.iterate_batches_by_mat(r,a,o,"PARTICLES");for(var i=Se(r,a),s=ve(e,t,r,a),c=Fe.get_active(),E=0;E<r.scenes_data.length;E++){var l=r.scenes_data[E].scene;Fe.set_active(l);var T=ie(l,"LAMP",0),u=r.scenes_data[E].batches;r.scenes_data[E].batches=[],r.scenes_data[E].batch_world_bounds=[],he.generate_main_batches(l,[r._bpy_obj],T,[]),he.create_forked_batches(r,Fe.get_graph(l),l),Fe.assign_scene_data_subs(l,[r]),Fe.append_object(l,r,!1),we.append_object(r,l);for(var d=0;d<u.length;d++)xe.append_batch(r,l,u[d])}me(e,t,r,s),pe(r,i),Oe(r,a,e,n,_),Fe.set_active(c)}},t.create_line=function(e){e=e||"",e+=te(e);var t=xe.create_object(e,"LINE");return t.render=xe.create_render("EMPTY"),t.is_dynamic=!0,he.generate_line_batches(Fe.get_main(),[t]),Fe.append_object(Fe.get_main(),t),de(t),t},t.create_empty=function(e){e=e||"",e+=te(e);var t=xe.create_object(e,"EMPTY");return t.render=xe.create_render("EMPTY"),t.is_dynamic=!0,xe.append_scene_data(t,Fe.get_main()),de(t),t},t.generate_mesh_render_boundings=function(e,t){var r=t.render,a=s.n(r.bb_original);r.billboard?xe.update_render_bounds_billboard(t,a):xe.update_render_bounds_from_bpy(t,a,e.data.b4w_boundings)},t.set_nodemat_value=function(e,t,r,a){for(var _=xe.is_world(e),n=!1,o=0;o<e.scenes_data.length;o++)for(var i=e.scenes_data[o].batches,s=0;s<i.length;s++){var c=i[s];(_||-1!=c.material_names.indexOf(t))&&(n|=he.set_nodemat_value(c,r,a))}return n&&_&&Fe.update_sky_texture(e),n},t.set_nodemat_rgb=function(e,t,r,a,_,n){for(var o=xe.is_world(e),i=!1,s=0;s<e.scenes_data.length;s++)for(var c=e.scenes_data[s].batches,E=0;E<c.length;E++){var l=c[E];(o||-1!=l.material_names.indexOf(t))&&(i|=he.set_nodemat_rgb(l,r,a,_,n))}return i&&o&&Fe.update_sky_texture(e),i},t.get_nodemat_value=function(e,t,r){var a=he.find_batch_material_any(e,t,"MAIN")||he.find_batch_material_any(e,t,"PARTICLES");return he.get_nodemat_value(a,r)},t.get_nodemat_rgb=function(e,t,r,a){var _=he.find_batch_material_any(e,t,"MAIN")||he.find_batch_material_any(e,t,"PARTICLES");return he.get_nodemat_rgb(_,r,a)}}var _=r(0),n=r(41),o=r(5),i=r(16),s=r(25),c=r(14),E=r(4),l=r(62),T=r(15),u=r(34),d=r(20),f=r(60),P=r(81),A=r(55),S=r(9),p=r(50),v=r(19),m=r(1),O=r(68),N=r(8),g=r(10),h=r(11),R=r(23),I=r(17),b=r(18),Y=r(13),L=r(6),M=r(2),y=r(3),x=r(59),U=r(58),w=r(22),C=r(30),D=r(61),F=Object(_.a)("__objects",a);t.a=F},function(e,t,r){"use strict";function a(e,t){function r(e,t){if(O.has_child_of(e)){var r=O.get_child_of_offset(e);u.v(t,r)}else{var a=e.render;u.v(t,a.world_tsr)}}function a(e,t){var r=e.render;if(O.has_child_of(e)){u.r(t,r.world_tsr);var a=O.get_child_of_parent_tsr(e),_=u.p(a,L),n=O.get_child_of_offset(e);u.q(_,r.world_tsr,n)}else u.r(t,r.world_tsr)}function _(e,t){if(O.has_child_of(e)){var r=O.get_child_of_offset(e);u.r(t,r)}else u.r(t,e.render.world_tsr)}function P(e,t){return u.g(e.render.world_tsr,t),t}function A(e,t){if(O.has_child_of(e)){var r=O.get_child_of_offset(e);u.g(r,t)}else u.g(e.render.world_tsr,t);return t}function S(e,t){if(O.has_child_of(e)){var r=O.get_child_of_offset(e);u.a(t,r)}else u.a(t,e.render.world_tsr)}function p(e,t){if(O.has_child_of(e)){var r=O.get_child_of_offset(e);u.a(r,t)}else u.a(e.render.world_tsr,t);return t}function v(e){var t=e.render,r=e.scenes_data,a=e.type;O.update_constraint(e,y),"CAMERA"==a&&m.update_camera(e),n.h(t.bb_local,t.world_tsr,t.bb_world),n.k(t.bs_local,t.world_tsr,t.bs_world);for(var _=0;_<r.length;_++)for(var o=r[_].batches,i=0;i<o.length;i++){var c=o[i],E=r[_].batch_world_bounds[i];g.update_world_bounds_from_batch_tsr(c,t.world_tsr,E)}switch(a){case"MESH":e.need_inv_zup_tsr&&u.p(e.render.world_tsr,e.render.world_tsr_inv);var l=e.armobj;if(l){var T=l.render.world_tsr;0!=T[3]&&0!=T[4]&&0!=T[5]?(u.p(T,L),u.q(L,t.world_tsr,L),u.l(L,t.arm_rel_trans),u.g(L,t.arm_rel_quat)):u.l(T,t.arm_rel_trans)}t.force_zsort=!0;break;case"CAMERA":for(var _=0;_<r.length;_++)m.update_camera_transform(e,r[_]);break;case"SPEAKER":R.speaker_update_transform(e,y,x);break;case"LAMP":s.g(e)}for(var d=u.j(t.world_tsr,I),f=u.g(t.world_tsr,Y),_=0;_<r.length;_++){var P=r[_];if(P.is_active){var A=P.scene,S=A._render,o=P.batches;switch(a){case"MESH":t.shadow_cast&&h.schedule_shadow_update(A);var p=P.cube_refl_subs;null!=t.cube_reflection_id&&p&&h.update_cube_reflect_subs(p,d);break;case"EMPTY":N.update_force(e);break;case"CAMERA":if(h.get_active()==A&&h.get_camera(A)==e){if(h.schedule_grass_map_update(A),S.shadow_params){(S.shadow_params.enable_csm||S.shadow_params.dynamic_grass_cast)&&h.schedule_shadow_update(A);var b=g.get_scene_data(e,A),M=b.cameras[0];h.update_shadow_billboard_view(M,S.graph)}R.listener_update_transform(A,d,f,y,x)}break;case"LAMP":h.update_lamp_scene(e,A)}var U=P.plane_refl_subs,w=e.reflective_objs;if(w.length)for(var i=0;i<U.length;i++){var C=U[i].camera;h.update_plane_reflect_subs(U[i],d,f),g.update_refl_objects(w,C.reflection_plane),m.set_view(C,h.get_camera(A))}}}for(var D=e.cons_descends,_=0;_<D.length;_++)v(D[_]);for(var F=e.cons_armat_bone_descends,_=0;_<F.length;_++){var G=F[_],l=G[0],k=G[1];O.update_bone_constraint(l,k)}}var m=Object(o.a)(e),O=Object(i.a)(e),N=Object(c.a)(e),g=Object(E.a)(e),h=Object(l.a)(e),R=Object(T.a)(e),I=new Float32Array(3),b=new Float32Array(3),Y=new Float32Array(4),L=u.b(),M=u.b(),y=0,x=0;t.update=function(e){y=e,x++},t.set_translation=function(e,t){var r=e.render;if(O.has_child_of(e)){u.v(t,r.world_tsr);var a=O.get_child_of_parent_tsr(e),_=u.p(a,L),n=O.get_child_of_offset(e);u.q(_,r.world_tsr,n)}else u.v(t,r.world_tsr)},t.set_translation_rel=r,t.get_translation=function(e,t){return u.j(e.render.world_tsr,t),t},t.get_translation_rel=function(e,t){if(O.has_child_of(e)){var r=O.get_child_of_offset(e);u.j(r,t)}else u.j(e.render.world_tsr,t);return t},t.set_rotation=a,t.set_rotation_rel=_,t.get_rotation=P,t.get_rotation_rel=A,t.set_rotation_euler=function(e,t){a(e,d.Y(t,Y))},t.set_rotation_euler_rel=function(e,t){_(e,d.Y(t,Y))},t.get_rotation_euler=function(e,t){var r=P(e,Y);return t=d._36(r,t)},t.get_rotation_euler_rel=function(e,t){var r=A(e,Y);return t=d._36(r,t)},t.set_scale=function(e,t){var r=e.render;if(O.has_child_of(e)){u.s(t,r.world_tsr);var a=O.get_child_of_parent_tsr(e),_=u.p(a,L),n=O.get_child_of_offset(e);u.q(_,r.world_tsr,n)}else u.s(t,r.world_tsr)},t.set_scale_rel=function(e,t){var r=e.render;if(O.has_child_of(e)){var a=O.get_child_of_offset(e);u.s(t,a)}else u.s(t,r.world_tsr)},t.get_scale=function(e,t){return u.i(e.render.world_tsr,t)},t.get_scale_rel=function(e,t){if(O.has_child_of(e)){var r=O.get_child_of_offset(e);return u.i(r,t)}return u.i(e.render.world_tsr,t)},t.set_tsr=function(e,t){if(u.a(t,e.render.world_tsr),O.has_child_of(e)){var r=O.get_child_of_parent_tsr(e),a=u.p(r,L),_=O.get_child_of_offset(e);u.q(a,e.render.world_tsr,_)}},t.set_tsr_rel=S,t.get_tsr=function(e,t){return u.a(e.render.world_tsr,t)},t.get_tsr_rel=p,t.get_object_size=function(){var e=f.create();return function(t){var r=t.render,a=r.bb_original,_=u.i(r.world_tsr,e),n=_[0]*(a.max_x-a.min_x),o=_[1]*(a.max_y-a.min_y),i=_[2]*(a.max_z-a.min_z);return.5*Math.sqrt(n*n+o*o+i*i)}}(),t.get_object_center=function(e,t,r){if(t){var a=e.render;f.copy(a.bs_world.center,r)}else{var a=e.render,_=a.bb_original;r[0]=(_.max_x+_.min_x)/2,r[1]=(_.max_y+_.min_y)/2,r[2]=(_.max_z+_.min_z)/2,u.D(r,a.world_tsr,r)}return r},t.move_local=function(e,t,a,_){var n=p(e,L),o=I;o[0]=t,o[1]=a,o[2]=_,u.D(o,n,o),r(e,o)},t.rotate_local=function(e,t){var r=p(e,L),a=u.r(t,u.m(M));u.q(r,a,a),S(e,a)},t.update_transform=v,t.distance=function(e,t){var r=u.j(e.render.world_tsr,I),a=u.j(t.render.world_tsr,b);return f.dist(r,a)},t.obj_point_distance=function(e,t){var r=u.j(e.render.world_tsr,I);return f.dist(r,t)}}var _=r(0),n=r(25),o=r(14),i=r(62),s=r(60),c=(r(8),r(12)),E=r(9),l=r(10),T=r(23),u=r(6),d=r(2),f=r(3),P=Object(_.a)("__transform",a);t.a=P},function(e,t,r){"use strict";function a(e,t){function r(e,r){var a=r.render.move_style,_=e.data,n=null;return a!=t.MS_TARGET_CONTROLS&&a!=t.MS_EYE_CONTROLS||!_.b4w_use_horizontal_clamping||(n={left:_.b4w_rotation_left_limit,right:_.b4w_rotation_right_limit,camera_space:"LOCAL"==_.b4w_horizontal_clamping_type},a==t.MS_EYE_CONTROLS&&(n.left*=-1,n.right*=-1)),n}function a(e,r){var a=r.render.move_style,_=e.data,n=null;return a!=t.MS_TARGET_CONTROLS&&a!=t.MS_EYE_CONTROLS||!_.b4w_use_vertical_clamping?a==t.MS_HOVER_CONTROLS&&_.b4w_use_zooming&&(_.b4w_hover_angle_min<=_.b4w_hover_angle_max?(n={down:_.b4w_hover_angle_min,up:_.b4w_hover_angle_max},n.down*=-1,n.up*=-1):Ue.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(n={down:_.b4w_rotation_down_limit,up:_.b4w_rotation_up_limit,camera_space:"LOCAL"==_.b4w_vertical_clamping_type},a==t.MS_TARGET_CONTROLS&&(n.down*=-1,n.up*=-1)),n}function _(e,r){var a=r.render.move_style,_=e.data,n=null;return a==t.MS_TARGET_CONTROLS&&_.b4w_use_target_distance_limits&&_.b4w_distance_min<=_.b4w_distance_max?n={min:_.b4w_distance_min,max:_.b4w_distance_max}:a===t.MS_HOVER_CONTROLS&&_.b4w_use_zooming&&(_.b4w_distance_min<=_.b4w_distance_max?n={min:_.b4w_distance_min,max:_.b4w_distance_max}:Ue.error("Wrong distance limits for the HOVER camera. Disabling distance limits.")),n}function v(e,r){var a=r.render.move_style,_=e.data,n=null;return a==t.MS_HOVER_CONTROLS&&_.b4w_use_horizontal_clamping&&_.b4w_horizontal_translation_min<=_.b4w_horizontal_translation_max&&(n={min:_.b4w_horizontal_translation_min,max:_.b4w_horizontal_translation_max}),n}function m(e,r){var a=r.render.move_style,_=e.data,n=null;return a==t.MS_HOVER_CONTROLS&&_.b4w_use_vertical_clamping&&_.b4w_vertical_translation_min<=_.b4w_vertical_translation_max&&(n={min:_.b4w_vertical_translation_min,max:_.b4w_vertical_translation_max}),n}function O(e,r){var a=r.render.move_style,_=e.data,n=null;return a==t.MS_TARGET_CONTROLS&&_.b4w_use_pivot_limits&&(n={min_z:_.b4w_pivot_z_min,max_z:_.b4w_pivot_z_max}),n}function N(e,t,r,a,_){De.set_translation(e,t),r&&j(e,t,r),H(e,a),z(e,_)}function g(e,t,r,a,_,n,o,i){var s=e.render;De.set_translation(e,t),s.pivot.set(r),j(e,t,r),H(e,a),z(e,_),J(e,n),Z(e,o),s.use_panning=i}function h(e,t,r,a,_,n,o,i){var s=e.render;De.set_translation(e,t),s.hover_pivot.set(r),j(e,t,r),W(e,a),q(e,_),$(e,n),ee(e,o),s.enable_hover_hor_rotation=i}function R(e){var t={type:e,name:"",size_mult:1,width:0,height:0,framebuffer:null,framebuffer_prev:null,color_attachment:null,depth_attachment:null,aspect:0,fov:0,fit:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,hmd_fov:p.create(),world_tsr:P.c(),view_matrix:new Float32Array(16),view_refl_matrix:new Float32Array(16),view_transform_params:{trans:S.create(),angle:0},proj_matrix:new Float32Array(16),view_proj_matrix:new Float32Array(16),view_proj_inv_matrix:new Float32Array(16),prev_view_proj_matrix:new Float32Array(16),sky_vp_inv_matrix:new Float32Array(16),direction:new Float32Array(3),view_tsr:P.c(),view_tsr_inv:P.c(),real_view_tsr:P.c(),real_view_tsr_inv:P.c(),shadow_cast_billboard_view_tsr:P.c(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dof_bokeh:!1,dof_foreground_blur:!1,dof_on:!1,lod_eye:new Float32Array(3),frustum_planes:b(),stereo_conv_dist:0,stereo_eye_dist:0,reflection_plane:null,csm_centers:null,csm_radii:null,csm_center_dists:new Float32Array(4),pcf_blur_radii:new Float32Array(4)};return t.hmd_fov[0]=t.hmd_fov[2]=0,t.hmd_fov[1]=t.hmd_fov[3]=0,t}function I(e,t){var r=R(e.type);return r.name=e.name,r.size_mult=e.size_mult,r.width=e.width,r.height=e.height,t||(r.framebuffer=e.framebuffer,r.framebuffer_prev=e.framebuffer_prev,r.color_attachment=e.color_attachment,r.depth_attachment=e.depth_attachment),r.aspect=e.aspect,r.fit=e.fit,r.fov=e.fov,r.near=e.near,r.far=e.far,r.left=e.left,r.right=e.right,r.top=e.top,r.bottom=e.bottom,p.copy(e.hmd_fov,r.hmd_fov),P.a(e.world_tsr,r.world_tsr),s.copy(e.view_matrix,r.view_matrix),s.copy(e.view_refl_matrix,r.view_refl_matrix),r.view_transform_params=A.O(e.view_transform_params),s.copy(e.proj_matrix,r.proj_matrix),s.copy(e.view_proj_matrix,r.view_proj_matrix),s.copy(e.view_proj_inv_matrix,r.view_proj_inv_matrix),s.copy(e.prev_view_proj_matrix,r.prev_view_proj_matrix),s.copy(e.sky_vp_inv_matrix,r.sky_vp_inv_matrix),r.direction.set(e.direction),P.a(e.view_tsr,r.view_tsr),P.a(e.view_tsr_inv,r.view_tsr_inv),P.a(e.real_view_tsr,r.real_view_tsr),P.a(e.real_view_tsr_inv,r.real_view_tsr_inv),P.a(e.shadow_cast_billboard_view_tsr,r.shadow_cast_billboard_view_tsr),r.dof_distance=e.dof_distance,r.dof_front_start=e.dof_front_start,r.dof_front_end=e.dof_front_end,r.dof_rear_start=e.dof_rear_start,r.dof_rear_end=e.dof_rear_end,r.dof_power=e.dof_power,r.dof_bokeh_intensity=e.dof_bokeh_intensity,r.dof_object=e.dof_object,r.dof_bokeh=e.dof_bokeh,r.dof_foreground_blur=e.dof_foreground_blur,r.dof_on=e.dof_on,S.copy(e.lod_eye,r.lod_eye),Y(e.frustum_planes,r.frustum_planes),r.stereo_conv_dist=e.stereo_conv_dist,r.stereo_eye_dist=e.stereo_eye_dist,e.reflection_plane&&(r.reflection_plane=p.clone(e.reflection_plane)),Re(e,r),p.copy(e.csm_center_dists,r.csm_center_dists),p.copy(e.pcf_blur_radii,r.pcf_blur_radii),r}function b(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function Y(e,t){return p.copy(e.left,t.left),p.copy(e.right,t.right),p.copy(e.top,t.top),p.copy(e.bottom,t.bottom),p.copy(e.near,t.near),p.copy(e.far,t.far),t}function L(e){switch(e){case"STATIC":return t.MS_STATIC;case"TARGET":return t.MS_TARGET_CONTROLS;case"EYE":return t.MS_EYE_CONTROLS;case"HOVER":return t.MS_HOVER_CONTROLS;default:Me.panic("Unknown move style")}}function M(e){var r=R(e);if(e==t.TYPE_NONE)return r;switch(e){case t.TYPE_PERSP:C(r,Ge,ke,Ke);break;case t.TYPE_ORTHO:C(r,Fe,ke,Ke);break;case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:case t.TYPE_ORTHO_ASYMMETRIC:break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:Me.panic("Stereo camera may only be created from perspective one");break;default:Me.panic("Unknown camera type")}return r}function y(e,r,a){if(e.type!=t.TYPE_STEREO_LEFT&&e.type!=t.TYPE_STEREO_RIGHT&&e.type!=t.TYPE_HMD_LEFT&&e.type!=t.TYPE_HMD_RIGHT&&Me.panic("set_stereo_params(): wrong camera type"),e.type!=t.TYPE_STEREO_LEFT&&e.type!=t.TYPE_STEREO_RIGHT||(e.stereo_conv_dist=r),e.stereo_eye_dist=a,Te(e,!1),we.check_active()){var _=we.get_active(),n=_._render.shadow_params;if(n)for(var o=xe.get_scene_data(we.get_camera(_),_),i=o.cameras,s=0;s<i.length;s++)Ne(i[s],n)}}function x(e,t,r){var a=Ve,_=We;S.dot(t,A.f)>0?(S.cross(A.d,t,a),S.normalize(a,a)):S.copy(A.f,a),S.cross(t,a,_);var n=A._34(e,A.f,Je),o=A._34(e,A.b,Ze);S.normalize(n,n),S.normalize(o,o);var i=-Math.asin(S.dot(n,t)),s=S.dot(o,t);if(Math.abs(i)>Math.PI/4)var c=S.scale(o,-A._50(i),$e);else var c=S.scale(n,-A._50(Math.asin(s)),et);var E=Math.atan(Math.abs(S.dot(_,c)/S.dot(a,c))),l=i;s>0&&(l=A._50(l)*Math.PI-l);var T=E;return S.dot(a,c)<0&&(T=Math.PI-T),S.dot(_,c)<0&&(T=2*Math.PI-T),r[0]=T,r[1]=l,r}function U(e){switch(e.fit){case"AUTO":return e.aspect>1?Ye(e)?e.fov/e.aspect:2*Math.atan(Math.tan(e.fov/2)/e.aspect):e.fov;case"HORIZONTAL":return Ye(e)?e.fov/e.aspect:2*Math.atan(Math.tan(e.fov/2)/e.aspect);case"VERTICAL":return e.fov}}function w(e){switch(e.fit){case"AUTO":return e.aspect>1?e.fov:Ye(e)?e.fov*e.aspect:2*Math.atan(Math.tan(e.fov/2)*e.aspect);case"HORIZONTAL":return e.fov;case"VERTICAL":return Ye(e)?e.fov*e.aspect:2*Math.atan(Math.tan(e.fov/2)*e.aspect)}}function C(e,r,a,_){switch(e.type){case t.TYPE_PERSP:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_ORTHO:e.fov=r,e.aspect=1;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:break;default:Me.panic("set_frustum(): Unsupported camera type: "+e.type)}e.near=a,e.far=_}function D(e,r,a,_,n,o,i){switch(e.type){case t.TYPE_ORTHO_ASYMMETRIC:e.left=r,e.right=a,e.bottom=_,e.top=n,e.near=o,e.far=i;break;default:Me.panic("set_frustum_asymmetric(): Unsupported camera type: "+e.type)}}function F(e){return e.render.move_style}function G(e){var t=e.reflection_plane[0],r=e.reflection_plane[1],a=e.reflection_plane[2],_=e.reflection_plane[3],n=e.view_refl_matrix;n[0]=1-2*t*t,n[1]=-2*t*r,n[2]=-2*t*a,n[3]=0,n[4]=-2*t*r,n[5]=1-2*r*r,n[6]=-2*r*a,n[7]=0,n[8]=-2*t*a,n[9]=-2*r*a,n[10]=1-2*a*a,n[11]=0,n[12]=-2*t*_,n[13]=-2*r*_,n[14]=-2*a*_,n[15]=1}function k(e){s.multiply(e.view_matrix,e.view_refl_matrix,e.view_matrix)}function K(e,t){Te(e,!0);var r=rt,a=_t;s.invert(e.view_matrix,a),s.transpose(a,a),p.transformMat4(e.reflection_plane,a,r);var _=at;_[0]=(A._50(r[0])+e.proj_matrix[8])/e.proj_matrix[0],_[1]=(A._50(r[1])+e.proj_matrix[9])/e.proj_matrix[5],_[2]=-1,_[3]=(1+e.proj_matrix[10])/e.proj_matrix[14];var n=r[0]*_[0]+r[1]*_[1]+r[2]*_[2]+r[3]*_[3];p.scale(r,2/n,r),e.proj_matrix[2]=r[0],e.proj_matrix[6]=r[1],e.proj_matrix[10]=r[2]+1,e.proj_matrix[14]=r[3],fe(e),t||Pe(e)}function B(e,r,a,_){s.lookAt(r,a,_,e.view_matrix);var n=we.get_active(),o=we.get_subs(n,Ce.STEREO);e.type==t.TYPE_STEREO_LEFT||o&&o.enable_hmd_stereo&&e.type==t.TYPE_HMD_LEFT?e.view_matrix[12]+=e.stereo_eye_dist/2:(e.type==t.TYPE_STEREO_RIGHT||o&&o.enable_hmd_stereo&&e.type==t.TYPE_HMD_RIGHT)&&(e.view_matrix[12]-=e.stereo_eye_dist/2),P.d(e.view_matrix,e.view_tsr),Ae(e),Se(e),P.v(r,e.world_tsr)}function X(e,t,r){var a=S.subtract(r,t,Ve);if(S.length(a)){S.normalize(a,a);var _=A._48(A.c,a,tt);De.set_rotation(e,_)}De.set_translation(e,t)}function j(e,t,r){var a=e.render,_=lt(e);if(X(e,t,r),_){var n=S.copy(a.vertical_axis,Ve);S.negate(n,n),Et(e,n,!0)}else Et(e,a.vertical_axis,!0)}function H(e,t){var r=e.render;t?(r.horizontal_limits=r.horizontal_limits||{},r.horizontal_limits.left=t.left,r.horizontal_limits.right=t.right,r.horizontal_limits.left_local=t.left,r.horizontal_limits.right_local=t.right,r.horizontal_limits.camera_space=Boolean(t.camera_space),Q(e)):r.horizontal_limits=null}function Q(e){var r=e.render,a=r.horizontal_limits;if(a&&(r.move_style==t.MS_EYE_CONTROLS||r.move_style==t.MS_TARGET_CONTROLS)){var _=ot(e,Qe);a.camera_space?(a.left+=_[0],a.right+=_[0]):(a.left_local-=_[0],a.right_local-=_[0]),a.left=A.A(a.left),a.right=A.A(a.right),a.left_local=A.A(a.left_local),a.right_local=A.A(a.right_local)}}function z(e,t){var r=e.render;t?(r.vertical_limits=r.vertical_limits||{},r.vertical_limits.down=t.down,r.vertical_limits.up=t.up,r.vertical_limits.down_local=t.down,r.vertical_limits.up_local=t.up,r.vertical_limits.camera_space=Boolean(t.camera_space),V(e)):r.vertical_limits=null}function q(e,t){var r=e.render;if(!t){var a=ot(e,Qe);t={down:a[1],up:a[1]}}r.vertical_limits=r.vertical_limits||{},r.vertical_limits.down=t.down,r.vertical_limits.up=t.up,V(e),r.distance_limits&&r.vertical_limits&&St(e)}function V(e){var r=e.render,a=r.vertical_limits;if(a)switch(r.move_style){case t.MS_EYE_CONTROLS:case t.MS_TARGET_CONTROLS:var _=ot(e,Qe);a.camera_space?(a.up+=_[1],a.down+=_[1]):(a.up_local-=_[1],a.down_local-=_[1]),a.up=A.B(a.up,-Math.PI,Math.PI),a.down=A.B(a.down,-Math.PI,Math.PI),a.up_local=A.B(a.up_local,-Math.PI,Math.PI),a.down_local=A.B(a.down_local,-Math.PI,Math.PI);break;case t.MS_HOVER_CONTROLS:a.up=A.B(a.up,-Math.PI,Math.PI),a.down=A.B(a.down,-Math.PI,Math.PI),a.up=A.M(a.up,-Math.PI/2,0),a.down=A.M(a.down,-Math.PI/2,0)}}function W(e,t){var r=e.render;if(!t){var a=De.obj_point_distance(e,r.hover_pivot);t={min:a,max:a}}r.distance_limits=r.distance_limits||{},r.distance_limits.min=t.min,r.distance_limits.max=t.max,r.distance_limits&&r.vertical_limits&&St(e)}function J(e,t){var r=e.render;t?(r.distance_limits=r.distance_limits||{},r.distance_limits.min=t.min,r.distance_limits.max=t.max):r.distance_limits=null}function Z(e,t){var r=e.render;t?(r.pivot_limits=r.pivot_limits||{},r.pivot_limits.min_z=t.min_z,r.pivot_limits.max_z=t.max_z):r.pivot_limits=null}function $(e,t){var r=e.render;t?(r.hover_horiz_trans_limits=r.hover_horiz_trans_limits||{},r.hover_horiz_trans_limits.min=t.min,r.hover_horiz_trans_limits.max=t.max):r.hover_horiz_trans_limits=null}function ee(e,t){var r=e.render;t?(r.hover_vert_trans_limits=r.hover_vert_trans_limits||{},r.hover_vert_trans_limits.min=t.min,r.hover_vert_trans_limits.max=t.max):r.hover_vert_trans_limits=null}function te(e){var r=e.render,a=r.move_style;if(a===t.MS_TARGET_CONTROLS||a===t.MS_EYE_CONTROLS){if(r.horizontal_limits){var _=r.horizontal_limits.left,n=r.horizontal_limits.right,o=ot(e,Qe);if(a==t.MS_TARGET_CONTROLS)var i=A.H(o[0],_,n);else var i=A.H(o[0],n,_);i&&(a==t.MS_TARGET_CONTROLS?ae(e,i,0):ne(e,i,0))}if(r.vertical_limits){var s=r.vertical_limits.down,c=r.vertical_limits.up,o=ot(e,Qe);if(a==t.MS_TARGET_CONTROLS)var i=A.H(o[1],c,s);else var i=A.H(o[1],s,c);i&&(a==t.MS_TARGET_CONTROLS?ae(e,0,i):ne(e,0,i))}a===t.MS_TARGET_CONTROLS&&r.distance_limits&&dt(e)}a===t.MS_TARGET_CONTROLS&&r.pivot_limits&&pt(e),a===t.MS_HOVER_CONTROLS&&(vt(e),Ee(e))}function re(e,t,r,a){var _=ot(e,qe);return a[0]=t-_[0],a[1]=r-_[1],a}function ae(e,t,r){ft(e,e.render.pivot,t,r)}function _e(e,t,r){var a=re(e,t,r,ze);ae(e,a[0],a[1])}function ne(e,t,r){Pt(e,t,r)}function oe(e,t,r){At(e,t,r)}function ie(e,t,r){var a=e.render;a.enable_hover_hor_rotation||(t=0),ft(e,a.hover_pivot,t,r),r&&St(e)}function se(e,t,r){var a=re(e,t,r,ze);ie(e,a[0],a[1])}function ce(e,t){var r=e.render,a=r.vertical_limits,_=r.distance_limits;if(a.down-a.up){var n=(a.down-t)/(a.down-a.up);n=Math.max(n,0)}else var n=0;return n*(_.max-_.min)+_.min}function Ee(e){var t=e.render,r=ot(e,Qe)[1],a=A.H(r,t.vertical_limits.up,t.vertical_limits.down);a&&ie(e,0,a)}function le(e,r){switch(e.type){case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:Ue.error("set_aspect(): Unsupported camera type: "+e.type);break;default:e.aspect=r}}function Te(e,r){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:s.perspective(U(e),e.aspect,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:var a=U(e),_=a*e.aspect;s.ortho(-_,_,-a,a,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO_ASYMMETRIC:s.ortho(e.left,e.right,e.bottom,e.top,e.near,e.far,e.proj_matrix);break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:ue(e);break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:de(e);break;case t.TYPE_NONE:return;default:Me.panic("Wrong camera type: "+e.type)}fe(e),r||Pe(e)}function ue(e){var r=Math.tan(U(e)/2),a=e.near*r,_=-a,n=e.aspect*e.stereo_conv_dist*r;if(e.type==t.TYPE_STEREO_LEFT)var o=n-e.stereo_eye_dist/2,i=n+e.stereo_eye_dist/2;else var o=n+e.stereo_eye_dist/2,i=n-e.stereo_eye_dist/2;var c=-e.near/e.stereo_conv_dist*o,E=e.near/e.stereo_conv_dist*i;s.frustum(c,E,_,a,e.near,e.far,e.proj_matrix),e.left=c,e.right=E}function de(e){if(we.check_active()){var t=we.get_active(),r=we.get_subs(t,Ce.STEREO);if(r&&r.enable_hmd_stereo){var a=Math.tan(e.hmd_fov[0]),_=Math.tan(e.hmd_fov[1]),n=Math.tan(e.hmd_fov[2]),o=Math.tan(e.hmd_fov[3]);e.top=e.near*a,e.right=e.near*_,e.bottom=-e.near*n,e.left=-e.near*o,s.frustum(e.left,e.right,e.bottom,e.top,e.near,e.far,e.proj_matrix)}else e.top=e.near*Math.tan(U(e)/2),e.bottom=-e.top,e.right=e.top*e.aspect,e.left=-e.right,s.perspective(U(e),e.aspect,e.near,e.far,e.proj_matrix)}}function fe(e){s.translate(e.proj_matrix,e.view_transform_params.trans,e.proj_matrix),s.rotateZ(e.proj_matrix,e.view_transform_params.angle,e.proj_matrix)}function Pe(e){Ae(e),Se(e),A._0(e.view_proj_matrix,e.frustum_planes)}function Ae(e){s.copy(e.view_matrix,e.view_proj_matrix),s.multiply(e.proj_matrix,e.view_proj_matrix,e.view_proj_matrix),s.invert(e.view_proj_matrix,e.view_proj_inv_matrix)}function Se(e){s.copy(e.view_matrix,e.sky_vp_inv_matrix),e.sky_vp_inv_matrix[12]=0,e.sky_vp_inv_matrix[13]=0,e.sky_vp_inv_matrix[14]=0,e.sky_vp_inv_matrix[15]=1,s.multiply(e.proj_matrix,e.sky_vp_inv_matrix,e.sky_vp_inv_matrix),s.invert(e.sky_vp_inv_matrix,e.sky_vp_inv_matrix)}function pe(e,r,a,_,n){_||(_=new Float32Array(24)),r||(r=e.near),a||(a=e.far);var o,i,c,E,l,T,u,d;switch(e.type){case t.TYPE_NONE:Me.panic("Extraction from NONE camera is not possible");break;case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:o=r*Math.tan(U(e)/2),E=-o,i=o*e.aspect,c=-i;l=o*(a/r),d=-l,T=l*e.aspect,u=-T;break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:var f=U(e),P=f*e.aspect;o=l=f,i=T=P,E=d=-f,c=u=-P;break;case t.TYPE_ORTHO_ASYMMETRIC:o=l=e.top,i=T=e.right,E=d=e.bottom,c=u=e.left;break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var S=r/e.near;o=r*Math.tan(U(e)/2),E=-o,i=e.right*S,c=e.left*S;var p=a/r;l=o*p,d=-l,T=i*p,u=c*p;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:var S=r/e.near;o=e.top*S,E=e.bottom*S,i=e.right*S,c=e.left*S;var p=a/r;l=o*p,d=E*p,T=i*p,u=c*p;break;default:Me.panic("Wrong camera type: "+e.type)}if(_[0]=c,_[1]=E,_[2]=-r,_[3]=i,_[4]=E,_[5]=-r,_[6]=i,_[7]=o,_[8]=-r,_[9]=c,_[10]=o,_[11]=-r,_[12]=u,_[13]=d,_[14]=-a,_[15]=u,_[16]=l,_[17]=-a,_[18]=T,_[19]=l,_[20]=-a,_[21]=T,_[22]=d,_[23]=-a,n){var v=_t;s.invert(e.view_matrix,v),A._28(_,v,_,0)}return _}function ve(e){return xe.is_camera(e)&&e.render&&e.render.move_style==t.MS_STATIC}function me(e){return xe.is_camera(e)&&e.render&&e.render.move_style==t.MS_TARGET_CONTROLS}function Oe(e){return xe.is_camera(e)&&e.render&&e.render.move_style==t.MS_HOVER_CONTROLS}function Ne(e,t){t.enable_csm?ge(e,t):e.pcf_blur_radii[0]=t.first_cascade_blur_radius}function ge(e,t){var r=t.csm_num;e.csm_centers||he(e,t);for(var a=0;a<r;a++){var _=0==a?e.near:Ie(t,e,a-1),n=Ie(t,e,a),i=pe(e,_,n,nt),s=o.H(i);e.csm_centers[a].set(s.center),e.csm_radii[a]=s.radius,e.csm_center_dists[a]=S.length(s.center);var c=t.first_cascade_blur_radius,E=t.last_cascade_blur_radius;e.pcf_blur_radii[a]=be(c,E,r,a)}}function he(e,t){var r=t.csm_num;e.csm_centers=new Array(r);for(var a=0;a<r;a++)e.csm_centers[a]=new Float32Array(3);e.csm_radii=new Float32Array(r)}function Re(e,t){if(e.csm_centers){var r=e.csm_centers.length;t.csm_centers=new Array(r);for(var a=0;a<r;a++)t.csm_centers[a]=S.clone(e.csm_centers[a]);t.csm_radii=new Float32Array(e.csm_radii)}}function Ie(e,t,r){var a=e.csm_num,_=A.M(e.csm_first_cascade_border,t.near,t.far),n=A.M(e.csm_last_cascade_border,t.near,t.far),o=be(_,n,a,r);return A.M(o,t.near,t.far)}function be(e,t,r,a){switch(a){case 0:var _=e;break;case r-1:var _=t;break;default:var _=0==e?0:e*Math.pow(t/e,a/(r-1))}return _}function Ye(e){switch(e.type){case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:case t.TYPE_ORTHO_ASYMMETRIC:return!0;default:return!1}}function Le(e,t){return t||(t=new Float32Array(3)),P.j(e.render.world_tsr,t)}var Me=Object(n.a)(e),ye=Object(i.a)(e),xe=Object(E.a)(e),Ue=Object(l.a)(e),we=Object(u.a)(e),Ce=Object(d.a)(e),De=Object(f.a)(e);t.TYPE_NONE=10,t.TYPE_PERSP=20,t.TYPE_ORTHO=30,t.TYPE_PERSP_ASPECT=40,t.TYPE_ORTHO_ASPECT=50,t.TYPE_ORTHO_ASYMMETRIC=60,t.TYPE_STEREO_LEFT=70,t.TYPE_STEREO_RIGHT=80,t.TYPE_HMD_LEFT=90,t.TYPE_HMD_RIGHT=100,t.MS_STATIC=0,t.MS_TARGET_CONTROLS=2,t.MS_EYE_CONTROLS=3,t.MS_HOVER_CONTROLS=4;var Fe=2.5,Ge=A.T(40),ke=.1,Ke=1e3,Be=A.T(.5),Xe=new Float32Array([1,1,1,1]),je=new Float32Array([-1,-1,1,1]),He=new Float32Array([0,0,-1,1]),Qe=new Float32Array(2),ze=new Float32Array(2),qe=new Float32Array(2),Ve=new Float32Array(3),We=new Float32Array(3),Je=new Float32Array(3),Ze=new Float32Array(3),$e=new Float32Array(3),et=new Float32Array(3),tt=(T.create(),new Float32Array(4)),rt=(new Float32Array(4),new Float32Array(4)),at=new Float32Array(4),_t=new Float32Array(16),nt=new Float32Array(24);new Float32Array(6);t.camera_object_to_camera=function(){var e=S.create(),n=S.create();return function(o,i){var s=i.render,c=o.data;switch(c.type){case"PERSP":var E=M(t.TYPE_PERSP);E.fit=c.sensor_fit;C(E,c.angle,c.clip_start,c.clip_end);break;case"ORTHO":var E=M(t.TYPE_ORTHO);E.fit=c.sensor_fit;C(E,c.ortho_scale/2,c.clip_start,c.clip_end)}E.name=i.name;var l=i.scenes_data;l[0].cameras.push(E);for(var T=1;T<l.length;T++){var u=I(E,!1);l[T].cameras.push(u)}s.move_style=L(c.b4w_move_style),s.dof_distance=c.dof_distance;var d=c.dof_object;s.dof_object=d?d._object:null,s.dof_front_start=c.b4w_dof_front_start,s.dof_front_end=c.b4w_dof_front_end,s.dof_rear_start=c.b4w_dof_rear_start,s.dof_rear_end=c.b4w_dof_rear_end,s.dof_power=c.b4w_dof_power,s.dof_bokeh=c.b4w_dof_bokeh,s.dof_bokeh_intensity=c.b4w_dof_bokeh_intensity,s.dof_foreground_blur=c.b4w_dof_foreground_blur,s.velocity_trans=c.b4w_trans_velocity,s.velocity_rot=c.b4w_rot_velocity,s.velocity_zoom=c.b4w_zoom_velocity;var f=r(o,i),A=a(o,i),S=_(o,i),p=v(o,i),R=m(o,i),b=O(o,i);switch(s.move_style){case t.MS_STATIC:break;case t.MS_EYE_CONTROLS:var Y=P.j(i.render.world_tsr,e);N(i,Y,null,f,A);break;case t.MS_TARGET_CONTROLS:var Y=P.j(i.render.world_tsr,e);g(i,Y,c.b4w_target,f,A,S,b,c.b4w_use_panning);break;case t.MS_HOVER_CONTROLS:var Y=P.j(i.render.world_tsr,e);h(i,Y,it(i,o.data.b4w_hover_zero_level,n),S,A,p,R,c.b4w_enable_hover_hor_rotation)}te(i),st(i)}}(),t.setup_eye_model=N,t.setup_target_model=g,t.setup_hover_model=h;var ot=function(){var e=T.create();return function(t,r){return x(P.g(t.render.world_tsr,e),t.render.vertical_axis,r)}}();t.get_camera_angles=ot;var it=function(){var e=new Float32Array(6),t=T.create(),r=new Float32Array(2),a=S.create(),_=S.create(),n=p.create();return function(o,i,s){var E=o.render,l=P.j(E.world_tsr,a),T=P.g(E.world_tsr,t),u=n;u.set(A.f),u[3]=0;var d=ot(o,r)[1],f=A._34(T,A.c,_);return c.R(e,l),c.Q(e,f),(!A._22(u,-i,e,s)||Math.abs(d)<Be)&&(Ue.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),s[0]=l[0],s[1]=l[1],s[2]=0),s}}(),st=function(){var e=S.create();return function(r){for(var a=r.render,_=0;_<r.scenes_data.length;_++){var n=r.scenes_data[_].cameras[0];if(n.type==t.TYPE_ORTHO)switch(a.move_style){case t.MS_TARGET_CONTROLS:var o=P.j(a.world_tsr,e);a.init_dist=S.dist(o,a.pivot),a.init_fov=n.fov;break;case t.MS_HOVER_CONTROLS:var o=P.j(a.world_tsr,e);a.init_dist=S.dist(o,a.hover_pivot),a.init_fov=n.fov}}}}();t.init_ortho_props=st,t.clone_camera=I,t.create_frustum_planes=b,t.move_style_bpy_to_b4w=L,t.create_camera=M,t.check_attachment=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return Boolean(e.color_attachment);case"DEPTH":return Boolean(e.depth_attachment);case"SCREEN":return!Boolean(e.color_attachment)&&!Boolean(e.depth_attachment);default:Me.panic("Wrong attachment type: "+t)}},t.set_attachment=function(e,t,r){switch(t){case"COLOR":case"CUBEMAP":e.color_attachment=r;break;case"DEPTH":e.depth_attachment=r;break;case"SCREEN":e.color_attachment=null,e.depth_attachment=null;break;default:Me.panic("Wrong attachment type: "+t)}},t.get_attachment=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return e.color_attachment;case"DEPTH":return e.depth_attachment;case"SCREEN":return null;default:Me.panic("Wrong attachment type: "+t)}},t.make_stereo=function(e,r){(e.type!=t.TYPE_PERSP||r!=t.TYPE_STEREO_LEFT&&r!=t.TYPE_STEREO_RIGHT&&r!=t.TYPE_HMD_LEFT&&r!=t.TYPE_HMD_RIGHT)&&Me.panic("make_stereo(): wrong camera type"),e.type=r,y(e,6,.065)},t.set_stereo_params=y,t.get_camera_angles_from_quat=x,t.get_camera_angles_char=function(e,t){return ot(e,t),t[0]=A.A(t[0]+Math.PI),t[1]*=-1,t},t.set_fov=function(e,r){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:e.fov=r}},t.get_fov=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:return e.fov;default:return 0}},t.get_vfov=U,t.set_frustum=C,t.set_frustum2=function(e,r,a,_,n){switch(e.type){case t.TYPE_PERSP:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_ORTHO:e.fov=a,e.aspect=1;break;case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:e.fov=a,e.aspect=r/a;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:break;default:Me.panic("set_frustum2(): Unsupported camera type: "+e.type)}e.near=_,e.far=n},t.set_frustum_asymmetric=D,t.get_move_style=F;var ct=function(){var e=S.create(),r=T.create(),a=s.create();return function(_,n){var o=P.j(n.render.world_tsr,e),i=P.g(n.render.world_tsr,r),c=s.fromRotationTranslation(i,o,a);if(s.invert(c,_.view_matrix),we.check_active())var E=we.get_active(),l=we.get_subs(E,Ce.STEREO);_.type==t.TYPE_STEREO_LEFT||l&&l.enable_hmd_stereo&&_.type==t.TYPE_HMD_LEFT?_.view_matrix[12]+=_.stereo_eye_dist/2:(_.type==t.TYPE_STEREO_RIGHT||l&&l.enable_hmd_stereo&&_.type==t.TYPE_HMD_RIGHT)&&(_.view_matrix[12]-=_.stereo_eye_dist/2),_.reflection_plane&&(P.d(_.view_matrix,_.real_view_tsr),P.p(_.real_view_tsr,_.real_view_tsr_inv),G(_),k(_),K(_,!0),S.transformMat4(o,_.view_refl_matrix,o)),P.d(_.view_matrix,_.view_tsr),P.p(_.view_tsr,_.view_tsr_inv),P.t(o,1,i,_.world_tsr),Pe(_)}}();t.set_view=ct,t.set_projection_reflect=K,t.set_view_trans_quat=function(e,t,r){var a=Ve;a[0]=0,a[1]=0,a[2]=-1,S.transformQuat(a,r,a),a[0]+=t[0],a[1]+=t[1],a[2]+=t[2];var _=We;_[0]=0,_[1]=1,_[2]=0,S.transformQuat(_,r,_),B(e,t,a,_)},t.set_look_at=X;var Et=function(){var e=S.create(),t=S.create(),r=S.create(),a=T.create(),_=T.create();return function(n,o,i){var s=n.render,c=P.g(s.world_tsr,a),E=A._34(c,A.f,e);if(S.normalize(E,E),Math.abs(S.dot(o,E))>.999999)var l=T.identity(_);else{var u=S.cross(o,E,t);S.normalize(u,u);var d=A._34(c,A.b,r);S.dot(d,o)>0&&S.negate(u,u);var f=A._34(c,A.d,r);S.normalize(f,f);var p=A.M(S.dot(f,u),-1,1);if(p<=-.999999)var v=Math.acos(p),l=T.setAxisAngle(E,v,_);else var l=T.rotationTo(f,u,_);T.normalize(l,l)}if(T.multiply(l,c,c),i){var m=A._34(c,A.e,e);S.dot(o,m)<0&&T.rotateZ(c,Math.PI,c)}P.r(c,s.world_tsr)}}();t.correct_up=Et;var lt=function(){var e=T.create(),t=S.create();return function(r){var a=P.g(r.render.world_tsr,e),_=r.render.vertical_axis,n=A._34(a,A.e,t);return S.dot(n,_)<0}}();t.set_look_at_corrected=j;var Tt=function(){var e=S.create(),t=S.create(),r=S.create(),a=T.create();return function(_,n){for(var o=_.render,i=n.cameras,s=P.g(o.world_tsr,a),c=A._34(s,A.c,e),E=P.j(o.world_tsr,t),l=n.shadow_cameras,T=0;T<l.length;T++){var u=l[T];S.copy(c,u.direction),P.j(o.world_tsr,u.lod_eye)}for(var T=0;T<i.length;T++){var u=i[T];if(ct(u,_),S.copy(c,u.direction),u.dof_object&&u.dof_on){var d=De.get_translation(u.dof_object,r),f=S.dist(E,d);u.dof_distance=f}}}}();t.update_camera_transform=Tt,t.update_camera=function(){var e=T.create(),r=S.create();return function(a){var _=a.render;switch(te(a),ut(a),_.move_style){case t.MS_TARGET_CONTROLS:var n=P.j(_.world_tsr,r),o=P.g(_.world_tsr,e);A._31(n,o,_.pivot,A.c),P.r(o,_.world_tsr);for(var i=0;i<a.scenes_data.length;i++)for(var s=a.scenes_data[i].cameras,c=0;c<s.length;c++){var E=s[c];E.type!=t.TYPE_STEREO_LEFT&&E.type!=t.TYPE_STEREO_RIGHT||y(E,S.dist(n,_.pivot),E.stereo_eye_dist)}Et(a,_.vertical_axis);break;case t.MS_EYE_CONTROLS:a.constraint||Et(a,_.vertical_axis)}}}(),t.set_horizontal_rot_limits=H,t.set_vertical_rot_limits=z,t.hover_set_vertical_limits=q,t.hover_set_distance_limits=W,t.set_distance_limits=J,t.set_pivot_limits=Z,t.set_hor_trans_limits=$,t.set_vert_trans_limits=ee;var ut=function(){var e=S.create();return function(r){var a=r.render;if(xe.is_camera(r))for(var _=r.scenes_data,n=0;n<_.length;n++){var o=_[n].cameras;if(o[0].type===t.TYPE_ORTHO){switch(a.move_style){case t.MS_TARGET_CONTROLS:var i=P.j(a.world_tsr,e),s=S.dist(i,a.pivot),c=s/a.init_dist*a.init_fov;break;case t.MS_HOVER_CONTROLS:var i=P.j(a.world_tsr,e),s=S.distance(i,a.hover_pivot),c=s/a.init_dist*a.init_fov;break;default:var c=o[0].fov}for(var E=0;E<o.length;E++){var l=o[E];l.fov=c,Te(l,!0)}Tt(r,_[n])}}}}();t.update_ortho_scale=ut;var dt=function(){var e=T.create(),t=S.create(),r=S.create(),a=S.create();return function(_){var n=_.render,o=P.j(n.world_tsr,t),i=S.subtract(o,n.pivot,r),s=S.length(i);if(s>n.distance_limits.max){var c=n.distance_limits.max/s;S.scale(i,c,i),S.add(n.pivot,i,o)}else if(s<n.distance_limits.min){var E=P.g(n.world_tsr,e),l=A._34(E,A.c,a);S.scale(l,100*n.distance_limits.min,l),S.add(i,l,i),S.scale(i,-n.distance_limits.min/S.length(i),i),S.add(n.pivot,i,o)}P.v(o,n.world_tsr)}}(),ft=function(){var e=T.create(),t=T.create(),r=T.create(),a=S.create(),_=S.create();return function(n,o,i,s){var c=n.render;if(i||s){var E=T.identity(e);i&&T.setAxisAngle(n.render.vertical_axis,i,E);var l=P.g(c.world_tsr,t);if(s){var u=A._34(l,A.d,a),d=T.setAxisAngle(u,s,r);T.normalize(d,d),T.multiply(E,d,E)}var f=P.j(c.world_tsr,_);A._46(f,o,E,f),P.v(f,c.world_tsr),T.multiply(E,l,l),T.normalize(l,l),P.r(l,c.world_tsr)}}}();t.rotate_target_angles=ae,t.set_rotation_target_angles=_e;var Pt=function(){var e=T.create(),t=T.create(),r=T.create(),a=S.create();return function(_,n,o){var i=_.render;if(n||o){var s=T.identity(e);if(n){var c=T.setAxisAngle(i.vertical_axis,n,t);T.multiply(s,c,s)}var E=P.g(i.world_tsr,t);if(o){var l=A._34(E,A.d,a),u=T.setAxisAngle(l,o,r);T.normalize(u,u),T.multiply(s,u,s)}T.multiply(s,E,E),T.normalize(E,E),P.r(E,i.world_tsr)}}}();t.rotate_static_angles=Pt,t.rotate_eye_angles=ne,t.set_rotation_eye_angles=oe;var At=function(){var e=new Float32Array(2),t=T.create();return function(r,a,_){var n=a,o=_,i=r.render,s=P.g(i.world_tsr,t),c=x(s,i.vertical_axis,e);n=a-c[0],o=_-c[1],Pt(r,n,o)}}();t.set_rotation_static_angles=At,t.rotate_hover_angles=ie,t.set_rotation_hover_angles=se,t.rotate_angles=function(e,r,a){var _=e.render,n=_.move_style;n===t.MS_TARGET_CONTROLS?ae(e,r,a):n===t.MS_EYE_CONTROLS?ne(e,r,a):n===t.MS_HOVER_CONTROLS?ie(e,r,a):n===t.MS_STATIC&&Pt(e,r,a)},t.set_rotation_angles=function(e,r,a){var _=e.render,n=_.move_style;n===t.MS_TARGET_CONTROLS?_e(e,r,a):n===t.MS_EYE_CONTROLS?oe(e,r,a):n===t.MS_HOVER_CONTROLS?se(e,r,a):n===t.MS_STATIC&&At(e,r,a)};var St=function(){var e=T.create(),t=new Float32Array(2),r=S.create(),a=S.create();return function(_){var n=_.render,o=ot(_,t)[1],i=ce(_,o),s=P.j(n.world_tsr,r),c=P.g(n.world_tsr,e),E=A._34(c,A.c,a);S.normalize(E,E),S.scale(E,i,E),S.subtract(n.hover_pivot,E,s),P.v(s,n.world_tsr)}}(),pt=function(){var e=S.create(),t=S.create();return function(r){var a=r.render,_=a.pivot[2],n=A.M(a.pivot[2],a.pivot_limits.min_z,a.pivot_limits.max_z);if(n!=_){var o=S.set(0,0,n-_,e);S.add(a.pivot,o,a.pivot);var i=P.j(a.world_tsr,t);S.add(i,o,i),P.v(i,a.world_tsr)}}}(),vt=function(){var e=S.create();return function(t){var r=t.render;if(r.hover_horiz_trans_limits){var a=A.M(r.hover_pivot[0],r.hover_horiz_trans_limits.min,r.hover_horiz_trans_limits.max)-r.hover_pivot[0];r.hover_pivot[0]+=a;var _=P.j(r.world_tsr,e);_[0]+=a,P.v(_,r.world_tsr)}if(r.hover_vert_trans_limits){var n=A.M(r.hover_pivot[1],r.hover_vert_trans_limits.min,r.hover_vert_trans_limits.max)-r.hover_pivot[1];r.hover_pivot[1]+=n;var _=P.j(r.world_tsr,e);_[1]+=n,P.v(_,r.world_tsr)}}}();t.is_float_aspect=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_ORTHO:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:return!0;default:return!1}},t.get_angular_diameter=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var r=U(e),a=w(e);return Math.min(r,a);default:return Ue.error("get_angular_diameter(): Unsupported camera type: "+e.type),0}},t.set_aspect=le,t.get_aspect=function(e){return e.aspect},t.set_projection=Te,t.set_color_pick_proj=function(e,r,a,_,n){var o=1/Math.max(n,_);switch(e.type){case t.TYPE_NONE:case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:var i=n/2,c=_/2;a=-(a-i)/i*Math.tan(U(e)/2),r=(r-c)/c*Math.tan(U(e)/2)*e.aspect;var E=e.near*(a+o),l=e.near*(r+o),T=e.near*(a-o),u=e.near*(r-o);s.frustum(u,l,T,E,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:a=-a/n,r/=_;var E=U(e),l=E*e.aspect,u=(r-o)*(l+l)-l;l=(r+o)*(l+l)-l;var T=E+(a-o)*(E+E);E+=(a+o)*(E+E),s.ortho(u,l,T,E,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO_ASYMMETRIC:a=-a/n,r/=_;var E=e.top+(a+o)*(e.top-e.bottom),l=e.left+(r+o)*(e.right-e.left),T=e.top+(a-o)*(e.top-e.bottom),u=e.left+(r-o)*(e.right-e.left);s.ortho(u,l,T,E,e.near,e.far,e.proj_matrix)}fe(e),Pe(e)},t.calc_sky_vp_inverse=Se,t.extract_frustum_corners=pe,t.assign_boundings=function(e){var t=e.render,r=o.w();r.min_x=-1,r.max_x=1,r.min_y=-1,r.max_y=1,r.min_z=-1,r.max_z=1,t.bb_local=r;var a=o.l(1,A._1([0,0,0]));t.bs_local=a,t.bcap_local=o.b(1,r),t.bcyl_local=o.d(1,r),t.bcon_local=o.c(1,r)},t.is_static_camera=ve,t.is_target_camera=me,t.is_eye_camera=function(e){return xe.is_camera(e)&&e.render&&e.render.move_style==t.MS_EYE_CONTROLS},t.is_hover_camera=Oe,t.is_ortho_camera=function(e){return xe.is_camera(e)&&e.render&&e.scenes_data[0].cameras[0].type==t.TYPE_ORTHO},t.update_camera_shadows=Ne,t.csm_far_plane=Ie,t.project_point=function(e,r,a){var _=e.scenes_data[0].cameras[0];switch(_.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:case t.TYPE_NONE:var n=rt;n.set(r),n[3]=1;var o=_.view_proj_matrix;p.transformMat4(n,o,n);var i=n[0]/n[3],s=-n[1]/n[3];return a[0]=(i+1)/2*_.width,a[1]=(s+1)/2*_.height,ye.viewport_to_canvas_coords(a[0],a[1],a,_),a.length>2&&(a[2]=(n[2]/Math.abs(n[3])+1)/2),a;default:return Ue.error("Non-compatible camera"),a}},t.get_first_cam=function(e){return e.scenes_data[0].cameras[0]},t.get_edge=function(e,r){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var a=Math.tan(U(e)/2);switch(r){case"LEFT":return-a*e.aspect;case"RIGHT":return a*e.aspect;case"TOP":return a;case"BOTTOM":return-a}break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:switch(r){case"LEFT":return-U(e)*e.aspect;case"RIGHT":return U(e)*e.aspect;case"TOP":return U(e);case"BOTTOM":return-U(e)}break;case t.TYPE_ORTHO_ASYMMETRIC:switch(r){case"LEFT":return e.left;case"RIGHT":return e.right;case"TOP":return e.top;case"BOTTOM":return e.bottom}break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:var _=we.get_active(),n=we.get_subs(_,Ce.STEREO);if(n&&n.enable_hmd_stereo)switch(r){case"LEFT":return-Math.tan(Math.min(e.hmd_fov[1],e.hmd_fov[3]));case"RIGHT":return Math.tan(Math.min(e.hmd_fov[1],e.hmd_fov[3]));case"TOP":return Math.tan(Math.min(e.hmd_fov[0],e.hmd_fov[2]));case"BOTTOM":return-Math.tan(Math.min(e.hmd_fov[0],e.hmd_fov[2]))}else{var a=Math.tan(U(e)/2);switch(r){case"LEFT":return-a*e.aspect;case"RIGHT":return a*e.aspect;case"TOP":return a;case"BOTTOM":return-a}}break;default:Me.panic("Unknown camera type")}},t.is_ortho=Ye,t.set_trans_pivot=function(e,t,r){var a=e.render;P.v(t,a.world_tsr),S.copy(r,a.pivot)},t.set_hover_pivot=function(){var e=S.create(),t=S.create();return function(r,a){var _=r.render,n=S.subtract(a,_.hover_pivot,e),o=P.j(_.world_tsr,t),i=S.add(n,o,n);De.set_translation(r,i),S.copy(a,_.hover_pivot)}}(),t.set_target_pivot=function(){var e=S.create(),t=S.create();return function(r,a){var _=r.render,n=S.subtract(a,_.pivot,e),o=P.j(_.world_tsr,t),i=S.add(n,o,n);De.set_translation(r,i),S.copy(a,_.pivot)}}(),t.get_eye=Le,t.set_move_style=function(){var e=S.create(),r=S.create(),a=T.create();return function(_,n){switch(_.render.move_style=n,_.render.horizontal_limits=null,_.render.vertical_limits=null,_.render.distance_limits=null,_.render.hover_horiz_trans_limits=null,_.render.hover_vert_trans_limits=null,st(_),n){case t.MS_STATIC:case t.MS_EYE_CONTROLS:break;case t.MS_HOVER_CONTROLS:var o=P.j(_.render.world_tsr,e),i=it(_,0,r);h(_,o,i,null,null,null,null,_.render.enable_hover_hor_rotation);break;case t.MS_TARGET_CONTROLS:var s=Le(_,e),c=P.g(_.render.world_tsr,a),E=A._34(c,A.c,r),i=S.scaleAndAdd(s,E,10,E);S.copy(i,_.render.pivot)}}}(),t.wipe_move_style=function(e){var t=e.render;t.move_style=0,S.set(0,0,0,t.pivot),S.set(0,0,0,t.hover_pivot),t.use_panning=!1,t.horizontal_limits=null,t.vertical_limits=null,t.distance_limits=null,t.hover_horiz_trans_limits=null,t.hover_vert_trans_limits=null,t.pivot_limits=null,t.enable_hover_hor_rotation=!0},t.set_eye_distance=function(e,t){for(var r=0;r<e.length;r++){var a=e[r];70!=a.type&&80!=a.type&&90!=a.type&&100!=a.type||y(a,a.stereo_conv_dist,t)}},t.set_hmd_fov=function(e,t,r){for(var a=we.get_active(),_=xe.get_scene_data(e,a),n=_.cameras,o=0;o<n.length;o++){var i=n[o];90!=i.type&&100!=i.type||(90==i.type&&p.copy(t,i.hmd_fov),100==i.type&&p.copy(r,i.hmd_fov),i.reflection_plane?K(i,!1):Te(i,!1))}},t.set_hmd_proj_mat=function(e,t,r){for(var a=we.get_active(),_=xe.get_scene_data(e,a),n=_.cameras,o=0;o<n.length;o++){var i=n[o];90!=i.type&&100!=i.type||(90==i.type&&t&&s.copy(t,i.proj_matrix),100==i.type&&r&&s.copy(r,i.proj_matrix),fe(i),Pe(i))}},t.set_proj_mat=function(e,r){for(var a,_,n,o,i,c,E,l,T=we.get_active(),u=xe.get_scene_data(e,T),d=u.cameras,f=0;f<d.length;f++){var P=d[f];if(P.type==t.TYPE_NONE&&P.near||P.type==t.TYPE_PERSP||P.type==t.TYPE_PERSP_ASPECT){a=P.near,_=P.far;var A=s.invert(r,_t),S=p.transformMat4(Xe,A,rt);n=S[0]*a,o=S[1]*a;var v=p.transformMat4(je,A,rt);i=v[0]*a,c=v[1]*a;var m=p.transformMat4(He,A,rt);_=-m[2]*m[3],E=s.frustum(i,n,c,o,a,_,_t),l=(n-i)/(o-c);break}}for(var f=0;f<d.length;f++){var P=d[f];P.type!=t.TYPE_NONE&&P.type!=t.TYPE_PERSP&&P.type!=t.TYPE_PERSP_ASPECT||(P.far=_,P.near=a,P.right=n,P.top=o,P.left=i,P.bottom=c,P.aspect=l,P.fov=Math.atan(o/a)-Math.atan(c/a),s.copy(E,P.proj_matrix),fe(P),Pe(P))}}}var _=r(0),n=r(5),o=r(25),i=r(15),s=r(21),c=r(45),E=r(9),l=r(1),T=r(8),u=r(10),d=r(11),f=r(13),P=r(6),A=r(2),S=r(3),p=r(7),v=Object(_.a)("__camera",a);t.a=v},function(e,t,r){"use strict";function a(e,t){function r(){return y}function a(){return x}function _(){return U}function u(e,t){D.offset_left=e,D.offset_top=t}function d(){var e=y.getBoundingClientRect();u(e.left,e.top)}function f(e,t,r){D.width=e,D.height=t,D.scale=r,d()}function P(e,t,r){if(e.constructor==MouseEvent)r[0]=e.offsetX,r[1]=e.offsetY;else if(e.constructor==TouchEvent){if("touchend"==e.type)var a=e.changedTouches;else var a=t?e.targetTouches:e.touches;A(a[0].clientX,a[0].clientY,e.target,r)}else r[0]=-1,r[1]=-1;return r}function A(e,t,r,a){if(Y.ie11_edge_mouseoffset_hack){var _=r.getBoundingClientRect();a[0]=e-_.left,a[1]=t-_.top}else{w.clientX=e,w.clientY=t,w.view=window;var n=new MouseEvent("b4w_convert",w);r.dispatchEvent(n),a[0]=n.offsetX,a[1]=n.offsetY}return a}function S(){return!!(Y.allow_hidpi&&window.devicePixelRatio>=2)}function p(e,t,r,a){e.style.width=r+"px",e.style.height=a+"px",t&&(t.style.width=r+"px",t.style.height=a+"px")}function v(e,t,_){var n=r(),o=a();_&&p(n,o,e,t),o&&(o.width=e,o.height=t,g.update_dim());var i=Math.floor(e*Y.canvas_resolution_factor),s=Math.floor(t*Y.canvas_resolution_factor);n.width=i,n.height=s;var c=Math.min(M.drawingBufferWidth,L.max_renderbuffer_size,L.max_viewport_dims[0]),E=Math.min(M.drawingBufferHeight,L.max_renderbuffer_size,L.max_viewport_dims[1]);if(i>c||s>E){h.warn("Canvas size exceeds platform limits, downscaling");var l=Math.min(c/i,c/s);i*=l,s*=l}if(e)var T=i/e;else var T=1;n.width=Math.floor(i),n.height=Math.floor(s),R.setup_dim(n.width,n.height,T),R.check_active()&&b.update_transform(R.get_active()._camera),N.update_media_controls(n.width,n.height)}var m=Object(n.a)(e),O=Object(o.a)(e),N=Object(i.a)(e),g=Object(s.a)(e),h=Object(c.a)(e),R=Object(E.a)(e),I=Object(l.a)(e),b=Object(T.a)(e),Y=O.defaults,L=O.context_limits,M=null,y=null,x=null,U=null,w={clientX:0,clientY:0},C=!1,D={width:0,height:0,scale:1,offset_top:0,offset_left:0};t.setup_context=function(e){M=e},t.get_canvas=r,t.get_canvas_hud=a,t.get_container=_,t.init=function(e,t){e&&e.parentNode?(y=e,x=t,U=e.parentNode):m.panic("canvas container is not available")},t.insert_to_container=function(e,t){switch(t=t||"LAST"){case"FIRST":var r=U.firstElementChild;U.insertBefore(e,r);break;case"JUST_BEFORE_CANVAS":U.insertBefore(e,y);break;case"JUST_AFTER_CANVAS":y.nextElementSibling?U.insertBefore(e,y.nextElementSibling):U.appendChild(e,y);break;case"LAST":U.appendChild(e,y);break;default:h.error(t+" invalid stack order")}},t.get_viewport_width=function(){return D.width},t.get_viewport_height=function(){return D.height},t.set_canvas_offsets=u,t.update_canvas_offsets=d,t.setup_viewport_dim=f,t.force_offsets_updating=function(){C=!0},t.client_to_canvas_coords=function(e,t,r){return A(e,t,y,r)},t.get_coords_target_space=P,t.client_to_element_coords=A,t.canvas_to_viewport_coords=function(e,t,r,a){if(r||(r=new Float32Array(2)),r[0]=e*D.scale,r[1]=t*D.scale,a){var _=a.width/D.width;r[0]*=_,r[1]*=_}return r},t.viewport_to_canvas_coords=function(e,t,r,a){if(r||(r=new Float32Array(2)),r[0]=e/D.scale,r[1]=t/D.scale,a){var _=a.width/D.width;r[0]/=_,r[1]/=_}return r},t.is_child=function(e){return!(!e||!e.parentNode)&&(e.parentNode==U||t.is_child(e.parentNode))},t.is_hidpi=S,t.resize=v,t.resize_to_container=function(e){var t=_(),n=r(),o=t.clientWidth,i=t.clientHeight;if(e||o!=n.clientWidth||i!=n.clientHeight){var s=n.width,c=n.height;if(p(r(),a(),o,i),R.check_active()){var E=R.get_active(),l=R.get_subs(E,I.STEREO);if(l&&l.enable_hmd_stereo)return void v(s,c,!1)}v(o,i,!1)}},t.reset=function(){M=null,y=null,x=null,U=null}}var _=r(0),n=r(5),o=r(4),i=r(46),s=r(54),c=r(1),E=r(10),l=r(11),T=r(13),u=(r(2),Object(_.a)("__container",a));t.a=u},function(e,t,r){"use strict";function a(e,t){function r(e){return Ut[e]||null}function a(e,t){Ut[e]=t}function _(e){var t={type:e,subtype:"",id:0,data_id:0,cluster_id:-1,odd_id_prop:"",debug_id_color:-1,debug_main_batch_id:-1,debug_main_batch_render_time:0,debug_render_time:0,debug_render_time_queries:[],textures:[],texture_names:[],bpy_tex_names:[],material_names:[],common_attributes:[],uv_maps_usage:null,vertex_colors_usage:{},shader:null,shaders_info:lt.init_shaders_info(),ngraph_proxy_id:"",attribute_setters:[],bufs_data:null,vaos:R.S(),use_shape_keys:!1,debug_sphere:!1,debug_sphere_dynamic:!1,num_vertices:0,num_triangles:0,jitter_amp:0,jitter_freq:0,dynamic_grass:!1,grass_scale_threshold:0,grass_size:0,grass_map_dim:new Float32Array(3),cube_fog:new Float32Array(16),alpha_clip:!1,alpha_antialiasing:!1,blend:!1,depth_mask:!1,xray:!1,use_backface_culling:!1,use_shadeless:!1,dynamic_geometry:!1,shadow_cast:!1,shadow_cast_only:!1,shadow_receive:!1,reflexible:!1,reflexible_only:!1,reflective:!1,draw_mode:dt.DM_DEFAULT,z_sort:!1,forked_batch:!1,do_not_cull:!1,caustics:!1,lod_dist_max:nt.LOD_DIST_MAX_INFINITY,lod_dist_min:0,lod_lower_border_range:0,lod_upper_border_range:0,lod_settings:L(),cube_reflection_id:-1,plane_reflection_id:-1,halo:!1,halo_size:0,halo_hardness:0,halo_stars_blend:0,halo_stars_height:0,halo_rings_color:new Float32Array(3),halo_lines_color:new Float32Array(3),halo_particles:!1,ambient:0,emit:0,diffuse_intensity:1,reflect_factor:0,specular_color_factor:0,specular_alpha:1,parallax_scale:0,diffuse_color_factor:0,alpha_factor:1,normal_factor:0,mirror_factor:0,offset_z:0,refr_bump:0,diffuse_params:new Float32Array(2),specular_params:new Float32Array(3),texture_scale:new Float32Array(3),specular_color:new Float32Array(3),diffuse_color:new Float32Array(4),fresnel_params:new Float32Array(2),lamp_uuid_indexes:null,lamp_light_positions:null,lamp_light_directions:null,lamp_light_color_intensities:null,has_nodes:!1,wireframe_edge_color:I.create(),water:!1,water_dynamic:!1,water_shore_smoothing:!1,water_generated_mesh:!1,water_num_cascads:0,water_subdivs:0,water_detailed_dist:0,water_norm_uv_velocity:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,foam_uv_freq:new Float32Array(2),foam_mag:new Float32Array(2),foam_scale:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),normalmap_scales:null,refractive:!1,is_sky:!1,draw_proc_sky:!1,particles_data:null,line_width:0,anchor_positions:null,part_node_data:null,node_values:[],node_value_inds:[],node_rgbs:[],node_rgb_inds:[],bounds_local:o.L(),use_be:!1,submesh:null,cleanup_gl_data_on_unload:!0,inst_array_state:0,obj_info_params:new Float32Array(3),lights:[]};return t.diffuse_color[3]=1,t.depth_mask=!0,t.line_width=1,t.lod_settings.hyst_prev_state=-1,t}function Y(e){var t=_(e.type);return t.subtype=e.subtype,t.id=e.id,t.cluster_id=e.cluster_id,t.odd_id_prop=e.odd_id_prop,t.debug_id_color=e.debug_id_color,t.debug_main_batch_id=e.debug_main_batch_id,t.debug_main_batch_render_time=e.debug_main_batch_render_time,t.debug_render_time=e.debug_render_time,t.debug_render_time_queries=[],t.textures=e.textures.slice(),t.texture_names=e.texture_names.slice(),t.bpy_tex_names=e.bpy_tex_names.slice(),t.material_names=e.material_names.slice(),t.common_attributes=e.common_attributes.slice(),t.uv_maps_usage=R.O(e.uv_maps_usage),t.vertex_colors_usage=R.O(e.vertex_colors_usage),t.shader=e.shader,t.shaders_info=lt.clone_shaders_info(e.shaders_info),t.ngraph_proxy_id=e.ngraph_proxy_id,t.attribute_setters=st.clone_attribute_setters(e.attribute_setters),t.bufs_data=e.bufs_data,t.use_shape_keys=e.use_shape_keys,t.debug_sphere=e.debug_sphere,t.debug_sphere_dynamic=e.debug_sphere_dynamic,t.num_vertices=e.num_vertices,t.num_triangles=e.num_triangles,t.jitter_amp=e.jitter_amp,t.jitter_freq=e.jitter_freq,t.grass_scale_threshold=e.grass_scale_threshold,t.grass_size=e.grass_size,t.grass_map_dim=e.grass_map_dim,t.cube_fog=e.cube_fog,t.alpha_clip=e.alpha_clip,t.alpha_antialiasing=e.alpha_antialiasing,t.blend=e.blend,t.depth_mask=e.depth_mask,t.xray=e.xray,t.use_backface_culling=e.use_backface_culling,t.use_shadeless=e.use_shadeless,t.dynamic_geometry=e.dynamic_geometry,t.shadow_cast=e.shadow_cast,t.shadow_cast_only=e.shadow_cast_only,t.shadow_receive=e.shadow_receive,t.reflexible=e.reflexible,t.reflexible_only=e.reflexible_only,t.reflective=e.reflective,t.dynamic_grass=e.dynamic_grass,t.draw_mode=e.draw_mode,t.z_sort=e.z_sort,t.forked_batch=e.forked_batch,t.do_not_cull=e.do_not_cull,t.caustics=e.caustics,t.lod_dist_max=e.lod_dist_max,t.lod_dist_min=e.lod_dist_min,t.lod_lower_border_range=e.lod_lower_border_range,t.lod_upper_border_range=e.lod_upper_border_range,t.lod_settings=M(e.lod_settings),t.cube_reflection_id=e.cube_reflection_id,t.plane_reflection_id=e.plane_reflection_id,t.halo=e.halo,t.halo_size=e.halo_size,t.halo_hardness=e.halo_hardness,t.halo_stars_blend=e.halo_stars_blend,t.halo_stars_height=e.halo_stars_height,I.copy(e.halo_rings_color,t.halo_rings_color),I.copy(e.halo_lines_color,t.halo_lines_color),t.halo_particles=e.halo_particles,t.ambient=e.ambient,t.emit=e.emit,t.diffuse_intensity=e.diffuse_intensity,t.reflect_factor=e.reflect_factor,t.specular_color_factor=e.specular_color_factor,t.specular_alpha=e.specular_alpha,t.parallax_scale=e.parallax_scale,t.diffuse_color_factor=e.diffuse_color_factor,t.alpha_factor=e.alpha_factor,t.normal_factor=e.normal_factor,t.mirror_factor=e.mirror_factor,t.offset_z=e.offset_z,t.refr_bump=e.refr_bump,t.diffuse_params[0]=e.diffuse_params[0],t.diffuse_params[1]=e.diffuse_params[1],I.copy(e.specular_params,t.specular_params),I.copy(e.texture_scale,t.texture_scale),I.copy(e.specular_color,t.specular_color),b.copy(e.diffuse_color,t.diffuse_color),t.fresnel_params.set(e.fresnel_params),t.lamp_uuid_indexes=R.O(e.lamp_uuid_indexes),e.lamp_light_positions&&(t.lamp_light_positions=new Float32Array(e.lamp_light_positions),t.lamp_light_directions=new Float32Array(e.lamp_light_directions),t.lamp_light_color_intensities=new Float32Array(e.lamp_light_color_intensities)),t.has_nodes=e.has_nodes,I.copy(e.wireframe_edge_color,t.wireframe_edge_color),t.water=e.water,t.water_dynamic=e.water_dynamic,t.water_shore_smoothing=e.water_shore_smoothing,t.water_generated_mesh=e.water_generated_mesh,t.water_num_cascads=e.water_num_cascads,t.water_subdivs=e.water_subdivs,t.water_detailed_dist=e.water_detailed_dist,t.water_norm_uv_velocity=e.water_norm_uv_velocity,t.shallow_water_col_fac=e.shallow_water_col_fac,t.shore_water_col_fac=e.shore_water_col_fac,t.foam_factor=e.foam_factor,t.foam_uv_freq.set(e.foam_uv_freq),t.foam_mag.set(e.foam_mag),t.foam_scale.set(e.foam_scale),I.copy(e.shallow_water_col,t.shallow_water_col),I.copy(e.shore_water_col,t.shore_water_col),t.normalmap_scales=R.O(e.normalmap_scales),t.refractive=e.refractive,t.is_sky=e.is_sky,t.draw_proc_sky=e.draw_proc_sky,e.particles_data&&(t.particles_data=ot.clone_particles_data(e.particles_data)),t.line_width=e.line_width,e.anchor_positions&&(t.anchor_positions=new Float32Array(e.anchor_positions)),t.part_node_data=R.O(e.part_node_data),t.node_values=e.node_values.slice(),t.node_value_inds=e.node_value_inds.slice(),t.node_rgbs=e.node_rgbs.slice(),t.node_rgb_inds=e.node_rgb_inds.slice(),o.t(e.bounds_local,t.bounds_local),t.use_be=e.use_be,t.cleanup_gl_data_on_unload=e.cleanup_gl_data_on_unload,t.obj_info_params=e.obj_info_params,t.lights=e.lights,t}function L(){var e={use_smoothing:!1,coverage:0,cmp_logic:0,dest_coverage:0,hyst_prev_state:0,hyst_interval_min:0,hyst_interval_max:0,prev_dist:0};return e.cmp_logic=1,e}function M(e){var t=L();return t.use_smoothing=e.use_smoothing,t.coverage=e.coverage,t.cmp_logic=e.cmp_logic,t.dest_coverage=e.dest_coverage,t.hyst_prev_state=e.hyst_prev_state,t.hyst_interval_min=e.hyst_interval_min,t.hyst_interval_max=e.hyst_interval_max,t.prev_dist=e.prev_dist,t}function y(e){switch(e.type){case"MAIN":case"PARTICLES":case"LINE":e.blend?e.xray?e.subtype="XRAY":e.subtype="BLEND":e.subtype="OPAQUE";break;case"SHADOW":e.shadow_cast_only?e.subtype="CAST":e.subtype="RECEIVE";break;case"COLOR_ID":e.xray?e.subtype="COLOR_ID_XRAY":e.subtype="COLOR_ID"}}function x(e,t,r){for(var a=[],_=0;_<e.length;_++){var n=e[_],o=n._object,i=o.render;o.is_hair_dupli||a.push.apply(a,U(n,i,t,r))}return a}function U(e,t,r,a){var n=[],o=e._object,i=Q(r,t,!t.do_not_render,!1),s=e.data,c=o.materials,E=new Array(c.length),l=new Array(c.length),T=[],u=ct.find_subs(r,Tt.MAIN_OPAQUE),d=!1;u&&(d=!!u.light_positions.length);for(var f=0;f<i.length;f++)for(var P=i[f],A=0;A<c.length;A++){var S=c[A];if(!Je(o,A)&&!dt.has_empty_submesh(s,A))if("PHYSICS"==P&&e.b4w_collision&&"NAVMESH"==e.game.physics_type)T.push(dt.extract_submesh(s,A,[],t.bone_skinning_info,{},null));else if(!S.is_lens_flares||d){var p=_(P);p.lights=R.O(a),"MAIN"==P?E[A]=p:"DEBUG_VIEW"==P&&(l[A]=p),p.cluster_id=e.b4w_cluster_data.cluster_id;var v=Ie(p,S);if(v){var m=z(p,S,s);if(m){"SHADOW"==P&&E[A]&&(p.use_shadeless=E[A].use_shadeless),p.draw_mode=t.use_shape_keys||t.dynamic_geometry?dt.DM_DYNAMIC_TRIANGLES:dt.DM_DEFAULT,Ae(p,t),pe(p,e.particle_systems),"DYNAMIC"!=t.type&&"COLOR_ID"!=p.type||(p.odd_id_prop=We(p,t,e.uuid)),p.do_not_cull=e.b4w_do_not_cull,"MAIN"==p.type&&(p.caustics=e.b4w_caustics);var O="COLOR_ID"!=P&&"SHADOW"!=P&&e.b4w_disable_fogging;me(p,"DISABLE_FOG",0|O);var N=dt.extract_submesh(s,A,p.common_attributes,t.bone_skinning_info,p.vertex_colors_usage,p.uv_maps_usage);!S.use_tangent_shading||"a_shade_tangs"in N.va_frames[0]||(me(p,"CALC_TBN",1),ve(p,"a_tbn")),S.is_lens_flares&&(N=w(N)),De(p),n.push({batch:p,obj_render:t,batch_render:t,submesh:N,mat_names:[S.name],rel_bpy_objects:[e]})}}}}if(T.length){var p=_("PHYSICS");p.subtype="NAVMESH",p.odd_id_prop=We(p,t,e.uuid);for(var N=dt.submesh_list_join(T),g=[],f=0;f<c.length;f++)g.push(c[f].name);De(p),n.push({batch:p,obj_render:t,batch_render:t,submesh:N,mat_names:g,rel_bpy_objects:[e]})}for(var f=0;f<l.length;f++)l[f]&&(l[f].debug_main_batch_id=E[f].id,De(l[f]));var h=e.particle_systems;if(h.length>0){for(var I=!1,b=!1,f=0;f<h.length;f++){var Y=h[f],L=Y.settings;if(L.use_render_emitter&&n.length&&(I=!0),"HAIR"!=L.type||"OBJECT"!=L.render_type&&"GROUP"!=L.render_type&&Y.transforms.length||(b=!0),I&&b)break}if(n.length)var M=n[0];else var M=C(s,t,h);var y=M.batch.vertex_colors_usage;if(b)if(c.length>1)var x=D(s,h,y,e._object.render);else var x=M.submesh;else var x=null;var U=F(e,t,r,y,x,a);I?n.push.apply(n,U):n=U}return n}function w(e){for(var t=e.base_length,r=e.va_frames[0].a_position,a=[],_=[],n=0;n<t;n++)_.push(r[3*n]),a.push(r[3*n+1]),_.push(r[3*n+2]);return a=new Float32Array(a),_=new Float32Array(_),e.va_common.a_lf_dist=a,e.va_common.a_lf_bb_vertex=_,e}function C(e,t,r){var a=_("TMP");return pe(a,r),{batch:a,submesh:dt.extract_submesh(e,0,a.common_attributes,t.bone_skinning_info,a.vertex_colors_usage,a.uv_maps_usage)}}function D(e,t,r,a){for(var _={},n=0;n<t.length;n++){var o=t[n].settings;if("HAIR"==o.type&&("OBJECT"==o.render_type||"GROUP"==o.render_type)){var i=o.b4w_vcol_from_name,s=o.b4w_vcol_to_name;""!==i&&""!==s&&(_[i]=R.O(r[i]))}}return"a_bending_col_main"in r&&(_.a_bending_col_main=R.O(r.a_bending_col_main)),"a_bending_col_detail"in r&&(_.a_bending_col_detail=R.O(r.a_bending_col_detail)),dt.extract_submesh_all_mats(e,[],_)}function F(e,t,r,a,n,o){for(var i=e._object,s=[],c=e.particle_systems,E=e.data,l=0;l<c.length;l++){var T=c[l],u=T.settings;if(u.count)if("EMITTER"==u.type){if("DYNAMIC"==t.type){var d=_("PARTICLES");d.bounds_local.bb=t.bb_local,d.bounds_local.be=t.be_local,d.bounds_local.bs=t.bs_local,d.lights=R.O(o);var f=G(T,i.materials),P=i.materials[f];if(Je(i,f))continue;"HALO"===T.settings.render_type&&"HALO"==P.type&&(d.halo_particles=!0);var A=z(d,P,E);if(!A)continue;he(d,T,i),d.dynamic_geometry=!0,d.do_not_cull=e.b4w_do_not_cull,d.odd_id_prop=We(d,t,i.name+"_"+u.uuid),ot.create_particles_data(d,T,P);var S=ot.generate_emitter_particles_submesh(d,E,T,i.render);ot.update_particles_submesh(S,d,u.count),ot.update_particles_objs_cache(i),Ae(d,i.render),De(d),s.push({batch:d,obj_render:t,batch_render:t,submesh:S,mat_names:[P.name],rel_bpy_objects:[e]})}}else if("HAIR"==u.type){var p=R._13(T.seed),v=-1!=R._70(ft.loaded_data_version,Ct)&&!u.b4w_initial_rand_rotation&&!u.b4w_hair_billboard,m=4;if(v&&(m=8),T.transforms.length)var O=T.transforms;else for(var N=dt.geometry_random_points(n,u.count,!1,p),O=new Float32Array(N.length*m),g=0;g<N.length;g++){var h=.75+.5*R._40(p);O[g*m]=N[g][0],O[g*m+1]=N[g][1],O[g*m+2]=N[g][2],O[g*m+3]=h,v&&(O[g*m+4]=1,O[g*m+5]=0,O[g*m+6]=0,O[g*m+7]=0)}var I=!!ct.find_subs(r,Tt.GRASS_MAP);if("OBJECT"==u.render_type){var b=[Q(r,u.dupli_object._object.render,!t.do_not_render,!0)],Y=Re(e,t,a,n,[u.dupli_object],b,[O],u,T,I,p,!1,o);s.push.apply(s,Y)}else if("GROUP"==u.render_type){for(var L=u.dupli_group.objects,b=[],g=0;g<L.length;g++){var M=Q(r,L[g]._object.render,!t.do_not_render,!0);b.push(M)}for(var y=!1,x=[],g=0;g<L.length;g++)x.push(L[g]._object);if(u.use_whole_group){var U=Ft(O,x,v,m);y=!0}else if(u.use_group_count)var U=Ce(O,x,u.dupli_weights,p,v,m);else var U=we(O,x,p,v,m);var Y=Re(e,t,a,n,L,b,U,u,T,I,p,y,o);s.push.apply(s,Y)}"INSTANCE"==u.b4w_wind_bend_inheritance&&i.render.wind_bending&&tt.warn('Emitter object "'+i.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else Ze.panic("Unknown particle settings type")}return s}function G(e,t){var r=e.settings.material-1;return r>=t.length&&(tt.warn('Wrong material used for rendering particle system "'+e.name+'"'),r=0),r}function k(e){for(var t=[],r=[],a={},_=0;_<e.length;_++){var n=e[_].batch,i=null;if(n.id in a){var s=a[n.id],c=r[s].batch;if(Fe(n,function(e){Fe(c,function(t){R._59(e,t)&&e.inst_array_state!=ht&&(i=r[s])})}),!i)do{n.id++}while(a[n.id])}if(i&&!mt||(i={batch:n,obj_renders_ordered:[],batch_renders_ordered:[],submeshes_ordered:[],rel_bpy_objects:[],rel_bpy_objects_uuids:[],mat_names:[]},a[n.id]=r.length,r.push(i)),e[_].submesh&&e[_].submesh.base_length){i.obj_renders_ordered.push(e[_].obj_render),i.batch_renders_ordered.push(e[_].batch_render),i.submeshes_ordered.push(e[_].submesh);for(var E=0;E<e[_].rel_bpy_objects.length;E++){var l=e[_].rel_bpy_objects[E];-1==i.rel_bpy_objects_uuids.indexOf(l.uuid)&&(i.rel_bpy_objects.push(l),i.rel_bpy_objects_uuids.push(l.uuid))}for(var E=0;E<e[_].mat_names.length;E++){var T=e[_].mat_names[E];-1==i.mat_names.indexOf(T)&&i.mat_names.push(T)}}i.mat_names.sort()}for(var _=0;_<r.length;_++){var n=r[_].batch,u=r[_].obj_renders_ordered,d=r[_].batch_renders_ordered,f=r[_].submeshes_ordered,P=K(d,n);if("STATIC"==P.type&&"COLOR_ID"!=n.type)for(var E=0;E<u.length;E++){var A=u[E],S=d[E],p=f[E],v=g.m(yt);if(A.billboard&&!A.billboard_pres_glob_orientation){var m=g.j(A.world_tsr,It);g.v(m,v);var O=g.i(A.world_tsr,It);g.s(O,v)}else g.a(A.world_tsr,v);if(S.is_hair_particles?p.instanced_array_data||(S.billboard?dt.submesh_apply_particle_transform(p,v):dt.submesh_apply_transform(p,v)):dt.submesh_apply_transform(p,v),S.is_hair_particles)me(n,"AU_QUALIFIER","GLSL_IN");else if(r[_].rel_bpy_objects.length>1){var N={};(S.wind_bending||S.billboard)&&(N.au_center_pos=g.j(v,I.create())),S.wind_bending&&(N.au_wind_bending_amp=[S.wind_bending_amp],N.au_wind_bending_freq=[S.wind_bending_freq],N.au_detail_bending_amp=[S.detail_bending_amp],N.au_detail_bending_freq=[S.detail_bending_freq],N.au_branch_bending_amp=[S.branch_bending_amp]),dt.submesh_apply_params(p,N),me(n,"AU_QUALIFIER","GLSL_IN")}else P.center_pos.set(v.subarray(0,3)),me(n,"AU_QUALIFIER","uniform")}if(0==f.length)var p=dt.init_submesh(et.unique_name("%empty"));else if(1==f.length)var p=f[0];else{for(var h=[],E=0;E<f.length;E++)dt.is_long_submesh(f[E])||h.push(E);if(h.length<f.length)for(var E=0;E<h.length;E++)dt.submesh_drop_indices(f[h[E]]);var p=dt.submesh_list_join(f)}if("STATIC"==P.type){if("COLOR_ID"!=n.type){for(var b=[],E=0;E<r[_].rel_bpy_objects.length;E++){var Y=r[_].rel_bpy_objects[E]._object;o.G(Y.render.bbr_world,b)}o.a(b,0,b.length,P.bb_world),o.o(P.bb_world,P.bb_local),P.be_world=o.z(R._1(b),!0),o.s(P.be_world,P.be_local),P.bs_world=o.B(P.be_world),o.u(P.bs_world,P.bs_local)}if(P.is_lod){var L=r[_].rel_bpy_objects[0].b4w_cluster_data;L.cluster_center?P.lod_center.set(L.cluster_center):P.lod_center.set(P.bs_world.center)}}if("PARTICLES"!=n.type){var M=p.submesh_bd;P.billboard?(o.o(P.bb_local,n.bounds_local.bb),o.s(P.be_local,n.bounds_local.be),o.u(P.bs_local,n.bounds_local.bs),n.use_be=!1):(o.o(M.bb_local,n.bounds_local.bb),o.s(M.be_local,n.bounds_local.be),P.bs_local.radius<M.bs_local.radius?"STATIC"==P.type&&"COLOR_ID"!=n.type?o.u(P.bs_world,n.bounds_local.bs):o.u(P.bs_local,n.bounds_local.bs):o.u(M.bs_local,n.bounds_local.bs),n.use_be=o.M(n.bounds_local.be,n.bounds_local.bs))}var y={batch:n,render:P,submesh:p,mat_names:r[_].mat_names,rel_bpy_objects:r[_].rel_bpy_objects};t.push(y)}return t}function K(e,t){return"DYNAMIC"==e[0].type||"COLOR_ID"==t.type?e[0]:nt.clone_render(e[0])}function B(e,t,r){var a=r*(t.max_z-t.min_z);if(0==a)return 0;var _=a*Math.tan(e);return.5*(Math.sqrt(2*Math.sqrt(4*_+1)+2)/2-1)/a}function X(e,t,r){var a=r*(t.max_z-t.min_z);if(0==a)return 0;e*=2*a;var _=Math.pow(e+1,4)-Math.pow(e+1,2);return Math.atan(_/a)}function j(e){var t=o.w();return t.max_x=e.max_x,t.min_x=e.min_x,t.max_y=e.max_y,t.min_y=e.min_y,t.max_z=e.max_z,t.min_z=e.min_z,t}function H(e,t){for(var r=0;r<t.length;r++){var a=e.indexOf(t[r]);-1!==a&&e.splice(a,1)}return e}function Q(e,t,r,a){var _=[];if(a||(t.selectable&&ct.find_subs(e,Tt.COLOR_PICKING)||t.outlining&&ct.find_subs(e,Tt.OUTLINE_MASK))&&_.push("COLOR_ID"),r&&(_.push("MAIN"),_.push("NODES_GLOW"),ct.find_subs(e,Tt.DEBUG_VIEW)&&_.push("DEBUG_VIEW"),ct.find_subs(e,Tt.SHADOW_RECEIVE)&&_.push("SHADOW"),ct.find_subs(e,Tt.GRASS_MAP)&&_.push("GRASS_MAP")),_.push("PHYSICS"),t.shadow_cast_only||t.reflexible_only){var n=null;if(t.shadow_cast_only&&(n=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),t.reflexible_only){var o=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"];n=null!==n?R.D(n,o):o}_=H(_,n)}return _}function z(e,t,r){var a;switch(e.type){case"MAIN":a=V(e,t,r);break;case"NODES_GLOW":a=_e(e,t,r,"GLOW");break;case"SHADOW":a=le(e,t,r);break;case"PHYSICS":a=Te(e,t);break;case"COLOR_ID":a=ue(e,t,r);break;case"GRASS_MAP":a=fe(e,t);break;case"DEBUG_VIEW":a=de(e,t);break;case"PARTICLES":a=Pe(e,t,r);break;default:Ze.panic("Wrong batch type: "+e.type)}return a}function q(e,t,r){var a="";if(Et.check_active()){a=Et.get_active().uuid}return _t.generate_graph_id(e,t,a,r)}function V(e,t,r){if(t.do_not_render)return!1;if(t.use_nodes&&"HALO"!=t.type)return _e(e,t,r,"MAIN"),!0;Z(e,t),e.use_backface_culling=t.use_backface_culling,e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.offset_z=t.offset_z,e.texture_scale.set([1,1,1]);var a=t.texture_slots;if(e.diffuse_color.set(t.diffuse_color),e.diffuse_color[3]=t.alpha,t.is_lens_flares){ke(e,"lens_flares.glslv","lens_flares.glslf"),ve(e,"a_position"),ve(e,"a_texcoord");var _=ut.get_batch_texture(a[0]),n=a[0].texture;Ke(e,_,"u_sampler",n.name)}else{if(ke(e,"main.glslv","main_stack.glslf"),!t.use_shadeless){var o={use_shadeless:t.use_shadeless,diffuse_shader:t.diffuse_shader,specular_shader:t.specular_shader,use_tangent_shading:t.use_tangent_shading},i=q(t.uuid,"MAIN"),s=_t.create_lighting_graph(i,o,e.lights);e.shaders_info.node_elements=_t.compose_node_elements(s)}var c=$("use_map_color_diffuse",!0,a),E=$("use_map_color_spec",!0,a),l=$("use_map_normal",!0,a),T=$("use_map_mirror",!0,a),u=$("use_stencil",!0,a),d=c[0],f=E[0],P=l[0],A=T[0],S=c[1],p=u[0]&&$("use_rgb_to_intensity",!0,a)[0];if(d){var n=d.texture;switch(d.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}var _=ut.get_batch_texture(d);Ke(e,_,"u_colormap0",n.name),e.diffuse_color_factor=d.diffuse_color_factor,d.use_map_alpha?e.alpha_factor=d.alpha_factor:e.alpha_factor=0,e.texture_scale.set(d.scale)}var v=d&&d==f;if(f){if(!v){var n=f.texture,_=ut.get_batch_texture(f);Ke(e,_,"u_specmap0",n.name)}e.specular_color_factor=f.specular_color_factor}if(P){var n=P.texture;ve(e,"a_tbn");var _=ut.get_batch_texture(P);if(Ke(e,_,"u_normalmap0",n.name),e.normal_factor=P.normal_factor,n.b4w_use_map_parallax&&ft.parallax){var m=lt.glsl_value(n.b4w_parallax_steps),O=lt.glsl_value(n.b4w_parallax_lod_dist);me(e,"PARALLAX",1),me(e,"PARALLAX_STEPS",m),me(e,"PARALLAX_LOD_DIST",O),e.parallax_scale=n.b4w_parallax_scale}}if(A){var n=A.texture,_=ut.get_batch_texture(A);Ke(e,_,"u_mirrormap",n.name),e.mirror_factor=A.mirror_factor}var N=d&&S&&p?1:0;if(N){var _=ut.get_batch_texture(S),n=S.texture;Ke(e,_,"u_colormap1",n.name),_=ut.get_batch_texture(p),n=p.texture,Ke(e,_,"u_stencil0",n.name)}var g=d||f||P;g&&e.texture_scale.set(g.scale),me(e,"TEXTURE_SPEC",void 0==f?0:1),me(e,"ALPHA_AS_SPEC",v?1:0),me(e,"TEXTURE_STENCIL_ALPHA_MASK",N),ve(e,"a_position"),ve(e,"a_tbn"),(d||f||P)&&ve(e,"a_texcoord"),t.water_settings.is_water&&ee(t,e),"HALO"===t.type&&(ke(e,"halo.glslv","halo.glslf"),W(e,t),e.common_attributes=["a_position"]),t.use_tangent_shading&&(me(e,"USE_TBN_SHADING",1),ve(e,"a_shade_tangs")),me(e,"TEXCOORD",0),me(e,"NORMAL_TEXCOORD",0),d&&J(e,d,"TEXTURE_COLOR0_CO"),S&&J(e,S,"TEXTURE_COLOR1_CO"),p&&J(e,p,"TEXTURE_STENCIL_ALPHA_MASK_CO"),f&&J(e,f,"TEXTURE_SPEC_CO"),P&&J(e,P,"TEXTURE_NORM_CO"),me(e,"SHADELESS",t.use_shadeless?1:0),e.use_shadeless=t.use_shadeless}return me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),me(e,"DOUBLE_SIDED_LIGHTING",t.use_double_sided_lighting?1:0),t.use_vertex_color_paint?(me(e,"VERTEX_COLOR",1),ve(e,"a_color")):me(e,"VERTEX_COLOR",0),e.ambient=t.ambient,e.diffuse_intensity=t.diffuse_intensity,e.emit=t.emit,e.specular_color.set(t.specular_color),e.specular_alpha=t.specular_alpha,re(e,t),ae(e,t),t.is_wettable?me(e,"WETTABLE",1):me(e,"WETTABLE",0),te(e,t),t.is_refractive&&!e.blend?(tt.warn('Material "'+t.name+'" is not blend. Disabling refractions.'),e.refractive=!1):e.refractive=t.is_refractive,e.refr_bump=t.refr_bump,!0}function W(e,t){var r=t.halo_settings;me(e,"NUM_RINGS",r.ring_count),me(e,"NUM_LINES",r.line_count),me(e,"NUM_STARS",r.star_tip_count),me(e,"SKY_STARS",r.is_sky_stars?1:0),e.halo_size=r.size,e.halo_hardness=r.hardness/20,e.halo_rings_color.set(r.rings_color),e.halo_lines_color.set(r.lines_color),e.halo_stars_blend=1/r.stars_blend_height,e.halo_stars_height=r.stars_min_height,e.halo=!0}function J(e,t,r){switch(t.texture_coords){case"UV":case"ORCO":me(e,r,"TEXTURE_COORDS_UV_ORCO"),me(e,"TEXCOORD",1);break;case"NORMAL":me(e,r,"TEXTURE_COORDS_NORMAL"),me(e,"NORMAL_TEXCOORD",1);break;default:me(e,r,"TEXTURE_COORDS_NONE")}}function Z(e,t){switch(t.blend_mode){case"ALPHA_ANTIALIASING":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!0;break;case"ALPHA_SORT":e.blend=!0,e.z_sort=!0,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"ALPHA":e.blend=!0,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"CLIP":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!0,e.alpha_antialiasing=!1;break;case"ADD":e.blend=!0,e.z_sort=!1,e.depth_mask=!1,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"OPAQUE":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;default:Ze.panic("Unknown alpha blend mode: "+t.blend_mode)}}function $(e,t,r){for(var a=[],_=r.length,n=0;n<_;n++){var o=r[n];o[e]==t&&o.texture&&o.texture._render&&a.push(o)}return a}function ee(e,t){t.water=!0,t.water_dynamic=e.water_settings.is_dynamic,e.water_settings.shore_smoothing&&!t.blend?(tt.warn('Material: "'+e.name+'" is opaque.',"Disabling water shore smoothing."),t.water_shore_smoothing=!1):t.water_shore_smoothing="REFLECT"!=t.subtype&&e.water_settings.shore_smoothing,ke(t,"water.glslv","water.glslf");var r={use_shadeless:!1,diffuse_shader:e.diffuse_shader,specular_shader:e.specular_shader,use_tangent_shading:e.use_tangent_shading},a=q(e.uuid),_=_t.create_lighting_graph(a,r,t.lights);t.shaders_info.node_elements=_t.compose_node_elements(_),ve(t,"a_position"),ft.water_wireframe_debug?(ve(t,"a_polyindex"),t.depth_mask=!0,I.set(0,0,0,t.wireframe_edge_color),rt.get_standard_derivatives()?me(t,"DEBUG_WIREFRAME",1):me(t,"DEBUG_WIREFRAME",2)):me(t,"DEBUG_WIREFRAME",0);var n=e.texture_slots,o=$("use_map_normal",!0,n),i=$("use_map_mirror",!0,n)[0];if(o.length){var s=ut.get_batch_texture(o[0]),c=o[0].texture;Ke(t,s,"u_normalmap0",c.name),t.water_norm_uv_velocity=e.water_settings.norm_uv_velocity}me(t,"NUM_NORMALMAPS",o.length),t.normalmap_scales=new Array(o.length);for(var E=0;E<o.length;E++)t.normalmap_scales[E]=new Float32Array(2),t.normalmap_scales[E].set([o[E].scale[0],o[E].scale[1]]);if(i){var l=ut.get_batch_texture(i),c=i.texture;Ke(t,l,"u_mirrormap",c.name),t.mirror_factor=i.mirror_factor}var T=null;if(ft.foam)for(var E=0;E<n.length;E++){var u=n[E];if(!0===u.texture.b4w_water_foam){T=u;break}}if(T){me(t,"FOAM",1);var d=ut.get_batch_texture(T),c=T.texture;Ke(t,d,"u_foam",c.name),t.foam_factor=e.water_settings.foam_factor,t.foam_uv_freq.set(c.b4w_foam_uv_freq),t.foam_mag.set(c.b4w_foam_uv_magnitude),t.foam_scale[0]=T.scale[0],t.foam_scale[1]=T.scale[1]}for(var E=0;E<n.length;E++){var u=n[E];if(!0===u.texture.b4w_shore_dist_map){var f=u;break}}if(f&&ft.allow_vertex_textures){var P=ut.get_batch_texture(f),c=f.texture;Ke(t,P,"u_shore_dist_map",c.name),me(t,"SHORE_PARAMS",1);var A=u.texture.b4w_shore_boundings;me(t,"MAX_SHORE_DIST",lt.glsl_value(u.texture.b4w_max_shore_dist)),me(t,"SHORE_MAP_SIZE_X",lt.glsl_value(A[0]-A[1])),me(t,"SHORE_MAP_SIZE_Y",lt.glsl_value(A[2]-A[3])),me(t,"SHORE_MAP_CENTER_X",lt.glsl_value((A[0]+A[1])/2)),me(t,"SHORE_MAP_CENTER_Y",lt.glsl_value((A[2]+A[3])/2))}if(e.water_settings.is_generated_mesh?(me(t,"GENERATED_MESH",1),t.water_generated_mesh=!0,t.water_num_cascads=e.water_settings.num_cascads,t.water_subdivs=e.water_settings.num_subdivs,t.water_detailed_dist=e.water_settings.detailed_dist):(ve(t,"a_tbn"),(T||o.length)&&ve(t,"a_texcoord"),me(t,"GENERATED_MESH",0)),e.water_settings.is_dynamic){var S=lt.glsl_value(e.water_settings.dst_noise_scale0),p=lt.glsl_value(e.water_settings.dst_noise_scale1),v=lt.glsl_value(e.water_settings.dst_noise_freq0),m=lt.glsl_value(e.water_settings.dst_noise_freq1),O=lt.glsl_value(e.water_settings.dir_min_shore_fac),N=lt.glsl_value(e.water_settings.dir_freq),g=lt.glsl_value(e.water_settings.dir_noise_scale),h=lt.glsl_value(e.water_settings.dir_noise_freq),R=lt.glsl_value(e.water_settings.dir_min_noise_fac),b=lt.glsl_value(e.water_settings.dst_min_fac),Y=lt.glsl_value(e.water_settings.waves_hor_fac);me(t,"DST_NOISE_SCALE_0",S),me(t,"DST_NOISE_SCALE_1",p),me(t,"DST_NOISE_FREQ_0",v),me(t,"DST_NOISE_FREQ_1",m),me(t,"DIR_MIN_SHR_FAC",O),me(t,"DIR_FREQ",N),me(t,"DIR_NOISE_SCALE",g),me(t,"DIR_NOISE_FREQ",h),me(t,"DIR_MIN_NOISE_FAC",R),me(t,"DST_MIN_FAC",b),me(t,"WAVES_HOR_FAC",Y)}re(t,e),ae(t,e),t.shallow_water_col.set(e.water_settings.shallow_col),t.shore_water_col.set(e.water_settings.shore_col),t.shallow_water_col_fac=e.water_settings.shallow_col_fac,t.shore_water_col_fac=e.water_settings.shore_col_fac,me(t,"ABSORB",lt.glsl_value(e.water_settings.absorb_factor)),me(t,"SSS_STRENGTH",lt.glsl_value(e.water_settings.sss_strength)),me(t,"SSS_WIDTH",lt.glsl_value(e.water_settings.sss_width))}function te(e,t){var r=t.raytrace_mirror;e.reflect_factor=r.reflect_factor,e.fresnel_params[0]=r.fresnel,e.fresnel_params[1]=1-r.fresnel_factor/5}function re(e,t){var r,a=0;switch(t.specular_shader){case"PHONG":case"COOKTORR":r=t.specular_hardness;break;case"WARDISO":r=t.specular_slope;break;case"TOON":r=t.specular_toon_size,a=t.specular_toon_smooth;break;case"BLINN":r=t.specular_ior,a=t.specular_hardness;break;default:tt.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.name+'")'),r=t.specular_hardness}e.specular_params[0]=t.specular_intensity,e.specular_params[1]=r,e.specular_params[2]=a}function ae(e,t){switch(t.diffuse_shader){case"LAMBERT":e.diffuse_params[0]=0,e.diffuse_params[1]=0;break;case"OREN_NAYAR":e.diffuse_params[0]=t.roughness,e.diffuse_params[1]=0;break;case"FRESNEL":e.diffuse_params[0]=t.diffuse_fresnel,e.diffuse_params[1]=t.diffuse_fresnel_factor;break;case"MINNAERT":e.diffuse_params[0]=t.darkness,e.diffuse_params[1]=0;break;case"TOON":e.diffuse_params[0]=t.diffuse_toon_size,e.diffuse_params[1]=t.diffuse_toon_smooth;break;default:tt.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.name+'")'),e.diffuse_params[0]=0,e.diffuse_params[1]=0}}function _e(e,t,r,a){if(!t.use_nodes||t.do_not_render)return!1;var _;switch(a){case"MAIN":ke(e,"main.glslv","main.glslf"),_=!1;break;case"GLOW":ke(e,"main.glslv","main.glslf"),_=!0;break;case"SHADOW":ke(e,"shadow.glslv","shadow.glslf"),_=!1;break;case"COLOR_ID":ke(e,"color_id.glslv","color_id.glslf"),_=!1}var n=t.node_tree,o={vc_name:r.active_vcol_name,uv_name:r.active_uv_name},i=q(t.uuid,a,o),s=_t.compose_ngraph_proxy(n,i,!1,r.name,t.name,a,o,e.lights);if(!s.graph)return tt.error('Failed to create node graph for material "'+t.name+'", disable nodes'),Ee(e,t),!0;e.ngraph_proxy_id=s.id,e.has_nodes=!0,me(e,"NODES",1),me(e,"DOUBLE_SIDED_LIGHTING",t.use_double_sided_lighting?1:0),ve(e,"a_position"),t.use_orco_tex_coord&&ve(e,"a_orco_tex_coord"),Z(e,t),e.use_backface_culling=t.use_backface_culling,e.offset_z=t.offset_z,_?(me(e,"ALPHA",1),me(e,"ALPHA_CLIP",0)):(me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0)),e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.emit=t.emit,e.ambient=t.ambient,te(e,t),t.is_wettable?me(e,"WETTABLE",1):me(e,"WETTABLE",0);var c=null,E=!1;at.traverse(s.graph,function(r,a){switch(a.type){case"UVMAP":case"TEX_COORD_UV":case"GEOMETRY_UV":case"UV_MERGED":var _=a.data.name,n=a.data.value;e.uv_maps_usage||(e.uv_maps_usage={}),e.uv_maps_usage[n]=_;break;case"GEOMETRY_VC":case"GEOMETRY_VC1":case"GEOMETRY_VC2":case"GEOMETRY_VC3":var _=a.data.name,o=a.data.value;e.vertex_colors_usage[_]={generate_buffer:!0,src:[{name:o}]};var i=0;if("GEOMETRY_VC"==a.type)i=7;else for(var s=0;s<a.outputs.length;s++){var l="RGB".indexOf(a.outputs[s].identifier);l>-1&&(i|=1<<2-l)}e.vertex_colors_usage[_].src[0].mask=i;break;case"TEX_COORD_NO":case"TEX_COORD_RE":case"GEOMETRY_NO":case"FRESNEL":case"LAYER_WEIGHT":ve(e,"a_tbn");break;case"TEX_COORD_OB":me(e,"USE_MODEL_TSR_INVERSE",1);break;case"TEX_COORD_WI":me(e,"USE_POSITION_CLIP",1);break;case"MATERIAL_BEGIN":a.data.value.use_tangent_shading&&(me(e,"USE_TBN_SHADING",1),"PARTICLES"!=e.type&&ve(e,"a_shade_tangs")),ve(e,"a_tbn"),E=!0;break;case"BSDF_BEGIN":E=!0,ve(e,"a_tbn");break;case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_CUBE":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":var _=a.data.name,T=a.data.bpy_name,u=a.data.value;Ke(e,u,_,T);break;case"TEXTURE_NORMAL":case"B4W_PARALLAX":if(me(e,"CALC_TBN_SPACE",1),ve(e,"a_tbn"),a.data){var _=a.data.name,T=a.data.bpy_name,u=a.data.value;Ke(e,u,_,T)}break;case"NORMAL_MAP":ve(e,"a_tbn");switch(Number(a.dirs[0][1])){case _t.NM_TANGENT:me(e,"CALC_TBN_SPACE",1);break;case _t.NM_OBJECT:case _t.NM_BLENDER_OBJECT:me(e,"USE_MODEL_TSR",1)}break;case"LAMP":a.data&&(e.lamp_uuid_indexes=a.data);break;case"B4W_REFRACTION":e.blend?e.refractive=!0:(e.refractive=!1,tt.warn('Material "'+t.name+'" is not blend. Disabling refractions.')),me(e,"USE_POSITION_CLIP",1);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":c||(c=a.data.texture);break;case"PARTICLE_INFO":"PARTICLES"==e.type&&a.data&&(e.part_node_data=a.data);break;case"VECT_TRANSFORM":switch(Number(a.dirs[1][1])){case _t.VT_WORLD_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1);break;case _t.VT_WORLD_TO_CAMERA:me(e,"USE_VIEW_TSR",1);break;case _t.VT_OBJECT_TO_WORLD:me(e,"USE_MODEL_TSR",1);break;case _t.VT_OBJECT_TO_CAMERA:me(e,"USE_MODEL_TSR",1),me(e,"USE_VIEW_TSR",1);break;case _t.VT_CAMERA_TO_WORLD:me(e,"USE_VIEW_TSR_INVERSE",1);break;case _t.VT_CAMERA_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1),me(e,"USE_VIEW_TSR_INVERSE",1)}break;case"OBJECT_INFO":me(e,"USE_MODEL_TSR",1),e.obj_info_params[1]=t.pass_index,e.obj_info_params[2]=Math.random();break;case"B4W_VECTOR_VIEW":case"GEOMETRY_VW":me(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":me(e,"USE_VIEW_TSR_INVERSE",1);break;case"BUMP":case"DISPLACEMENT_BUMP":ve(e,"a_tbn"),rt.get_standard_derivatives()?me(e,"USE_DERIVATIVES_EXT",1):tt.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+t.name+'" material.');break;case"BSDF_TRANSPARENT":a.data.value.use_alpha?me(e,"USE_BSDF_TRANSPARENT_ALPHA",1):(e.blend=!0,e.refractive=!0,me(e,"USE_BSDF_TRANSPARENT_REFRACT",1));break;case"BSDF_GLOSSY":case"BSDF_DIFFUSE":me(e,"USE_BSDF_SKY_DIM",1),rt.get_texture_lod()&&me(e,"USE_TEXTURE_LOD_EXT",1);break;case"BSDF_PRINCIPLED":me(e,"USE_BSDF_SKY_DIM",1),rt.get_texture_lod()&&me(e,"USE_TEXTURE_LOD_EXT",1),a.data.value.use_refract&&(e.blend=!0,e.refractive=!0,me(e,"USE_BSDF_PRINCIPLED_REFRACT",1),me(e,"USE_VIEW_TSR",1),me(e,"USE_PROJ_MATRIX_FRAG",1))}}),c&&Ke(e,c,"u_nodes_texture"),E||(e.use_shadeless=!0);var l=e.shaders_info.node_elements=_t.compose_node_elements(s.graph);oe(s.graph,e,t.name);for(var T=e.node_value_inds,u=e.node_rgb_inds,d=0;d<l.length;d++){var f=l[d];switch(f.id){case"VALUE":var P=f.param_values[0];if(P)for(var A=0;A<T.length;A+=3)if(T[A]==P){f.dirs.push(["VALUE_ROW_IND",T[A+1]]),f.dirs.push(["VALUE_COL_IND",T[A+2]]);break}break;case"RGB":var P=f.param_values[0];if(P)for(var A=0;A<u.length;A+=2)if(u[A]==P){f.dirs.push(["RGB_IND",u[A+1]]);break}}}return me(e,"NUM_VALUES",e.node_values.length/4),me(e,"NUM_RGBS",e.node_rgbs.length),!0}function ne(e,t){var r=t._render.world_light_set;if(""!=r.ngraph_proxy_id){e.has_nodes=!0,e.ngraph_proxy_id=r.ngraph_proxy_id;var a=_t.get_ngraph_proxy_cached(r.ngraph_proxy_id),_=a.graph;if(!_)return tt.error('Failed to create node graph for world "'+t.world.name+'", disable nodes'),Ee(e,t.world.name),!0;var n=null;at.traverse(_,function(t,r){switch(r.type){case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":var a=r.data.name,_=r.data.bpy_name,o=r.data.value;Ke(e,o,a,_);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":n||(n=r.data.texture);break;case"VECT_TRANSFORM":switch(Number(r.dirs[1][1])){case _t.VT_WORLD_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1);break;case _t.VT_WORLD_TO_CAMERA:me(e,"USE_VIEW_TSR",1);break;case _t.VT_OBJECT_TO_WORLD:me(e,"USE_MODEL_TSR",1);break;case _t.VT_OBJECT_TO_CAMERA:me(e,"USE_MODEL_TSR",1),me(e,"USE_VIEW_TSR",1);break;case _t.VT_CAMERA_TO_WORLD:me(e,"USE_VIEW_TSR_INVERSE",1);break;case _t.VT_CAMERA_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1),me(e,"USE_VIEW_TSR_INVERSE",1)}break;case"B4W_VECTOR_VIEW":me(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":me(e,"USE_VIEW_TSR_INVERSE",1)}}),n&&Ke(e,n,"u_nodes_texture");var o=e.shaders_info.node_elements=_t.compose_node_elements(_);oe(_,e,t.world.name);for(var i=e.node_value_inds,s=e.node_rgb_inds,c=0;c<o.length;c++){var E=o[c];switch(E.id){case"VALUE":var l=E.param_values[0];if(l)for(var T=0;T<i.length;T+=3)if(i[T]==l){E.dirs.push(["VALUE_ROW_IND",i[T+1]]),E.dirs.push(["VALUE_COL_IND",i[T+2]]);break}break;case"RGB":var l=E.param_values[0];if(l)for(var T=0;T<s.length;T+=2)if(s[T]==l){E.dirs.push(["RGB_IND",s[T+1]]);break}}}return me(e,"NUM_VALUES",e.node_values.length/4),me(e,"NUM_RGBS",e.node_rgbs.length),!0}return!1}function oe(e,t,r){var a=[],_=[],n=[],o=[];ie(e,"",a,_,n,o),t.node_values=a,t.node_value_inds=_,t.node_rgbs=n,t.node_rgb_inds=o}function ie(e,t,r,a,_,n){at.traverse(e,function(e,o){if("VALUE"==o.type){var i=se(t,o.name);r.push(o.outputs[0].default_value);var s=a.length/3,c=parseInt(s/4),E=parseInt(s%4);a.push(i,c,E)}else if("RGB"==o.type){var i=se(t,o.name),l=o.outputs[0].default_value.slice(0,3);_.push(l[0],l[1],l[2]),n.push(i,n.length/2)}});for(var o=r.length+4-r.length%4,i=r.length;i<o;i++)r.push(0)}function se(e,t){var r=e?e+"%join%":"";return r+=t}function ce(e,t){for(var r=e[t],a=t+1;a<e.length;a++)r=se(r,e[a]);return r}function Ee(e,t){switch(e.type){case"SHADOW":ke(e,"shadow.glslv","shadow.glslf");break;case"COLOR_ID":ke(e,"color_id.glslv","color_id.glslf");break;default:ke(e,"main.glslv","main_stack.glslf")}return me(e,"SHADELESS",1),ve(e,"a_position"),ve(e,"a_tbn"),b.set(1,0,1,1,e.diffuse_color),t&&(me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),me(e,"VERTEX_COLOR",0),e.offset_z=t.offset_z,Z(e,t),e.use_backface_culling=t.use_backface_culling),!0}function le(e,t,r){if(t.is_lens_flares||t.water_settings.is_water||t.do_not_render||"HALO"==t.type)return!1;if(Z(e,t),e.use_backface_culling=t.use_backface_culling,e.blend)return!1;!t.use_nodes||"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode?ke(e,"shadow.glslv","shadow.glslf"):_e(e,t,r,"SHADOW"),e.depth_mask=e.depth_mask&&!(ft.reuse_depth_optimization&&"ALPHA_ANTIALIASING"==t.blend_mode),b.set(0,0,0,t.alpha,e.diffuse_color),ve(e,"a_position"),ve(e,"a_tbn"),me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),e.texture_scale.set([1,1,1]);var a=t.texture_slots,_=$("use_map_color_diffuse",!0,a)[0];if(!_||"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode)me(e,"TEXTURE_COLOR",0);else{switch(_.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.texture_scale.set(_.scale),me(e,"TEXTURE_COLOR",1),ve(e,"a_texcoord");var n=ut.get_batch_texture(_),o=_.texture;"IMAGE"!=n.source&&"ENVIRONMENT_MAP"!=n.source&&"CANVAS"!=n.source&&"NONE"!=n.source||Ke(e,n,"u_colormap0",o.name)}return!0}function Te(e,t){var r=t.physics_settings,a=t.water_settings;return r.use_coll_physics?(e.use_ghost=r.use_ghost,e.collision_id=r.collision_id,e.collision_margin=r.collision_margin,e.collision_group=r.collision_group,e.collision_mask=r.collision_mask,e.friction=r.friction,e.elasticity=r.elasticity,!0):!!a.is_water&&(e.water=!0,e.water_dynamics=a.is_dynamic,e.dst_noise_scale0=a.dst_noise_scale0,e.dst_noise_scale1=a.dst_noise_scale1,e.dst_noise_freq0=a.dst_noise_freq0,e.dst_noise_freq1=a.dst_noise_freq1,e.dir_min_shore_fac=a.dir_min_shore_fac,e.dir_freq=a.dir_freq,e.dir_noise_scale=a.dir_noise_scale,e.dir_noise_freq=a.dir_noise_freq,e.dir_min_noise_fac=a.dir_min_noise_fac,e.dst_min_fac=a.dst_min_fac,e.waves_hor_fac=a.waves_hor_fac,!0)}function ue(e,t,r){if(t.is_lens_flares||"HALO"==t.type)return!1;var a=t.blend_mode,_=a;"ALPHA_ANTIALIASING"==_&&(_="CLIP",t.blend_mode="CLIP"),Z(e,t),e.use_backface_culling=t.use_backface_culling,e.z_sort=!1,e.depth_mask=!0,e.blend=!1,e.xray=t.render_above_all&&"OPAQUE"!=_&&"CLIP"!=_,t.use_nodes&&"CLIP"==_?_e(e,t,r,"COLOR_ID"):ke(e,"color_id.glslv","color_id.glslf"),b.set(0,0,0,t.alpha,e.diffuse_color),ve(e,"a_position"),me(e,"ALPHA","OPAQUE"===_?0:1),e.texture_scale.set([1,1,1]);var n=t.texture_slots,o=$("use_map_color_diffuse",!0,n)[0];if(me(e,"ALPHA_CLIP","CLIP"===_?1:0),o&&"CLIP"==_){switch(o.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.texture_scale.set(o.scale),me(e,"TEXTURE_COLOR",1),ve(e,"a_texcoord");var i=ut.get_batch_texture(o),s=o.texture;"IMAGE"!=i.source&&"ENVIRONMENT_MAP"!=i.source&&"CANVAS"!=i.source&&"NONE"!=i.source||Ke(e,i,"u_colormap0",s.name)}else me(e,"TEXTURE_COLOR",0);return t.blend_mode=a,!0}function de(e,t){return(!t||!t.is_lens_flares&&!t.do_not_render)&&(ke(e,"debug_view.glslv","debug_view.glslf"),ve(e,"a_position"),ve(e,"a_tbn"),ve(e,"a_polyindex"),e.depth_mask=!0,I.set(0,0,0,e.wireframe_edge_color),!0)}function fe(e,t){if(!t.terrain_settings.is_terrain||t.do_not_render)return!1;if(Z(e,t),e.use_backface_culling=t.use_backface_culling,e.blend=!1,e.z_sort=!1,e.depth_mask=!0,ke(e,"grass_map.glslv","grass_map.glslf"),ve(e,"a_position"),t.terrain_settings.dynamic_grass_size)var r=t.terrain_settings.dynamic_grass_size;else var r=null;if(t.terrain_settings.dynamic_grass_color)var a=t.terrain_settings.dynamic_grass_color;else var a=null;e.vertex_colors_usage.a_grass_size={generate_buffer:!0,src:[]},r?(e.vertex_colors_usage.a_grass_size.src.push({name:r,mask:4}),me(e,"DYNAMIC_GRASS_SIZE",1)):me(e,"DYNAMIC_GRASS_SIZE",0),e.vertex_colors_usage.a_grass_color={generate_buffer:!0,src:[]},a?(e.vertex_colors_usage.a_grass_color.src.push({name:a,mask:7}),me(e,"DYNAMIC_GRASS_COLOR",1)):me(e,"DYNAMIC_GRASS_COLOR",0);var _=At.grass_tex_size;return me(e,"GRASS_TEXTURE_SIZE",lt.glsl_value(_)),!0}function Pe(e,t,r){if(t.do_not_render)return!1;var a=t.texture_slots;if(e.halo_particles)ke(e,"particle_system.glslv","particle_system_stack.glslf"),me(e,"HALO_PARTICLES",1),W(e,t);else{var _={use_shadeless:!1,diffuse_shader:t.diffuse_shader,specular_shader:t.specular_shader,use_tangent_shading:t.use_tangent_shading};if(t.use_nodes)return ke(e,"particle_system.glslv","particle_system.glslf"),_e(e,t,r,"PARTICLES"),!0;ke(e,"particle_system.glslv","particle_system_stack.glslf");var n=q(t.uuid),o=_t.create_lighting_graph(n,_,e.lights);e.shaders_info.node_elements=_t.compose_node_elements(o);var i=$("use_map_color_diffuse",!0,a)[0];if(i){switch(me(e,"TEXTURE_COLOR",1),i.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.diffuse_color_factor=i.diffuse_color_factor,i.use_map_alpha?e.alpha_factor=i.alpha_factor:e.alpha_factor=0;Ke(e,ut.get_batch_texture(i),"default"+String(e.textures.length),i.texture.name)}}return e.diffuse_color.set(t.diffuse_color),e.diffuse_color[3]=t.alpha,e.ambient=t.ambient,e.diffuse_intensity=t.diffuse_intensity,e.emit=t.emit,e.specular_color.set(t.specular_color),e.specular_alpha=t.specular_alpha,ve(e,"a_position"),ve(e,"a_tbn"),me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),me(e,"PARTICLES_SHADELESS",t.use_shadeless?1:0),re(e,t),ae(e,t),Z(e,t),e.use_backface_culling=t.use_backface_culling,e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.offset_z=t.offset_z,!0}function Ae(e,t){if(e.data_id=t.data_id,"PHYSICS"!==e.type){switch("DYNAMIC"==t.type||"COLOR_ID"==e.type?(t.is_hair_particles?me(e,"AU_QUALIFIER","GLSL_IN"):me(e,"AU_QUALIFIER","uniform"),me(e,"STATIC_BATCH",0)):(me(e,"AU_QUALIFIER","GLSL_IN"),me(e,"STATIC_BATCH",1)),"DEBUG_VIEW"==e.type&&(rt.get_standard_derivatives()?me(e,"WIREFRAME_QUALITY",1):me(e,"WIREFRAME_QUALITY",0),e.debug_sphere?(me(e,"DEBUG_SPHERE",1),e.debug_sphere_dynamic?me(e,"DEBUG_SPHERE_DYNAMIC",1):me(e,"DEBUG_SPHERE_DYNAMIC",0)):me(e,"DEBUG_SPHERE",0),me(e,"ALPHA",1)),t.use_shape_keys&&"PARTICLES"!=e.type&&!t.is_hair_particles&&(e.use_shape_keys=t.use_shape_keys),t.wind_bending?(""!==t.main_bend_col?(e.vertex_colors_usage.a_bending_col_main={generate_buffer:!0,src:[{name:t.main_bend_col,mask:4}]},ve(e,"a_bending_col_main"),""!==t.detail_bend_col.leaves_stiffness&&""!==t.detail_bend_col.leaves_phase&&""!==t.detail_bend_col.overall_stiffness?(e.vertex_colors_usage.a_bending_col_detail={generate_buffer:!0,src:[{name:t.detail_bend_col.leaves_stiffness,mask:4},{name:t.detail_bend_col.leaves_phase,mask:2},{name:t.detail_bend_col.overall_stiffness,mask:1}]},ve(e,"a_bending_col_detail"),ve(e,"a_tbn"),me(e,"DETAIL_BEND",1)):me(e,"DETAIL_BEND",0),me(e,"MAIN_BEND_COL",1)):me(e,"MAIN_BEND_COL",0),t.bend_center_only?me(e,"BEND_CENTER_ONLY",1):me(e,"BEND_CENTER_ONLY",0),me(e,"WIND_BEND",1)):me(e,"WIND_BEND",0),me(e,"BILLBOARD_PRES_GLOB_ORIENTATION",0|t.billboard_pres_glob_orientation),t.billboard?me(e,"BILLBOARD",1):me(e,"BILLBOARD",0),t.billboard&&t.is_hair_particles?me(e,"HAIR_BILLBOARD",1):me(e,"HAIR_BILLBOARD",0),t.billboard_spherical?me(e,"BILLBOARD_SPHERICAL",1):me(e,"BILLBOARD_SPHERICAL",0),t.billboard_type){case"RANDOM":me(e,"BILLBOARD_RANDOM",1),me(e,"BILLBOARD_JITTERED",0);break;case"JITTERED":me(e,"BILLBOARD_RANDOM",0),me(e,"BILLBOARD_JITTERED",1);break;default:me(e,"BILLBOARD_RANDOM",0),me(e,"BILLBOARD_JITTERED",0)}t.dynamic_grass&&ft.allow_vertex_textures?me(e,"DYNAMIC_GRASS",1):me(e,"DYNAMIC_GRASS",0),e.dynamic_grass=t.dynamic_grass,"PARTICLES"!=e.type&&(e.dynamic_geometry=t.dynamic_geometry),e.shadow_cast=t.shadow_cast,e.shadow_cast_only=t.shadow_cast_only,e.shadow_receive=t.shadow_receive&&!e.use_shadeless&&!(e.blend&&ft.disable_blend_shadows_hack),ft.rgba_fallback_shadows?("MAIN"==e.type&&e.shadow_receive||"SHADOW"==e.type)&&me(e,"RGBA_SHADOWS",1):me(e,"RGBA_SHADOWS",0),e.reflexible=t.reflexible,e.reflexible_only=t.reflexible_only,e.reflective=t.reflective,e.obj_info_params[0]=t.pass_index,e.lod_dist_max=t.lod_dist_max,e.lod_dist_min=t.lod_dist_min,e.lod_lower_border_range=t.lod_lower_border_range,e.lod_upper_border_range=t.lod_upper_border_range,e.cube_reflection_id=t.cube_reflection_id,e.plane_reflection_id=t.plane_reflection_id,t.is_skinning?(ve(e,"a_influence"),me(e,"SKINNED",1),ft.skinning_hack?(me(e,"DISABLE_TANGENT_SKINNING",1),me(e,"FRAMES_BLENDING",0)):(me(e,"DISABLE_TANGENT_SKINNING",0),t.frames_blending?me(e,"FRAMES_BLENDING",1):me(e,"FRAMES_BLENDING",0)),me(e,"MAX_BONES",t.max_bones)):(me(e,"SKINNED",0),me(e,"FRAMES_BLENDING",0),me(e,"DISABLE_TANGENT_SKINNING",0)),t.vertex_anim?(me(e,"VERTEX_ANIM",1),ft.vert_anim_mix_normals_hack?me(e,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):me(e,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):me(e,"VERTEX_ANIM",0),t.is_skinning&&t.vertex_anim&&Ze.panic("Skinning and vertex animation are mutually exlusive")}}function Se(e,t,r){if(t.length){for(var a=ft.ssao&&r.b4w_enable_ssao,_=nt.get_shadow_lamps(t,a),n=e.shaders_info,o=e.lamp_uuid_indexes,i=0,s=0;s<e.shaders_info.node_elements.length;s++){var c=e.shaders_info.node_elements[s];if("LIGHTING_LAMP"==c.id){var E=t[i++%t.length],l=E.light,T=nt.get_scene_data(E,r);if("SPOT"==l.type||"POINT"==l.type)var u=Math.cos(l.spot_size/2);if("SPOT"==l.type)var d=l.spot_blend*(1-u);var f=T.light_index,P=_.indexOf(E);c.dirs=[["LAMP_TYPE",l.type],["LAMP_IND",f],["LAMP_SPOT_SIZE",lt.glsl_value(u||.01)],["LAMP_SPOT_BLEND",lt.glsl_value(d||.01)],["LAMP_LIGHT_DIST",lt.glsl_value(l.distance)],["LAMP_USE_SPHERE",l.use_sphere?1:0],["LAMP_SHADOW_MAP_IND",P]]}else if("LAMP"==c.id&&o)for(var A=c.dirs[0][1],S=0;S<t.length;S++){var E=t[S];if(o[E.uuid]==A){var l=E.light;if("SPOT"==l.type||"POINT"==l.type)var u=Math.cos(l.spot_size/2);if("SPOT"==l.type)var d=l.spot_blend*(1-u);c.dirs.push(["LAMP_TYPE",l.type],["LAMP_SPOT_SIZE",lt.glsl_value(u||.01)],["LAMP_SPOT_BLEND",lt.glsl_value(d||.01)],["LAMP_LIGHT_DIST",lt.glsl_value(l.distance)],["LAMP_USE_SPHERE",l.use_sphere?1:0])}}}if(o){var p=0;for(var v in o)p++;e.lamp_light_positions=new Float32Array(3*p),e.lamp_light_directions=new Float32Array(3*p),e.lamp_light_color_intensities=new Float32Array(3*p),lt.set_directive(n,"NUM_LAMP_LIGHTS",p);for(var s=0;s<t.length;s++)Dt(e,t[s])}}}function pe(e,t){for(var r=0;r<t.length;r++){var a=t[r].settings.b4w_vcol_from_name,_=t[r].settings.b4w_vcol_to_name;""!==a&&""!==_&&(e.vertex_colors_usage[a]={generate_buffer:!1,src:[{name:a,mask:7}]})}}function ve(e,t){var r=e.common_attributes;-1==r.indexOf(t)&&r.push(t),e.common_attributes=r.sort()}function me(e,t,r){lt.set_directive(e.shaders_info,t,r)}function Oe(e,t){return lt.get_directive(e.shaders_info,t)}function Ne(e,t,r){if("PHYSICS"==e.type)return void("NAVMESH"==e.subtype?e.bufs_data=dt.submesh_to_bufs_data(t,dt.DM_DEFAULT,[]):(t.shape_keys.length>0&&dt.submesh_init_shape_keys(t,t.va_frames[0],r),e.submesh=t));var a=e.draw_mode;if(e.halo&&"PARTICLES"!=e.type&&(t=dt.extract_halo_submesh(t)),e.water_generated_mesh){var _=e.water_num_cascads,n=e.water_subdivs,o=e.water_detailed_dist;t=it.generate_cascaded_grid(_,n,o)}var i=dt.submesh_to_bufs_data(t,a,e.vertex_colors_usage);e.bufs_data=i,vt||e.dynamic_geometry||e.z_sort||e.use_shape_keys||(i.ibo_array=null,i.vbo_source_data.length=0);var s=t.va_frames.length;e.num_vertices=t.base_length*s,ge(e)?dt.is_indexed(t)?e.num_triangles=t.indices.length/3*s:e.num_triangles=t.base_length/3*s:e.num_triangles=0,pt&&(e.submesh=t)}function ge(e){switch(e.draw_mode){case dt.DM_DEFAULT:case dt.DM_TRIANGLES:case dt.DM_DYNAMIC_TRIANGLES:return!0;default:return!1}}function he(e,t,r){var a=t.settings;switch(a.b4w_billboard_align){case"VIEW":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case"XY":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case"YZ":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case"ZX":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:Ze.panic("Wrong billboard align value")}me(e,"BILLBOARD",0);var _=a.b4w_enable_soft_particles&&nt.check_obj_soft_particles_accessibility(r,a);me(e,"SOFT_PARTICLES",a.b4w_particles_softness>0&&_&&ft.depth_tex_available?1:0),me(e,"SOFT_STRENGTH",lt.glsl_value(a.b4w_particles_softness));var n="WORLD"==a.b4w_coordinate_system?1:0;lt.set_directive(e.shaders_info,"WORLD_SPACE",n)}function Re(e,t,r,a,n,o,i,s,c,E,l,T,u){var d=e._object,f=[],P=s.b4w_dynamic_grass;if(!E&&P)return f;for(var S="INSTANCE"==s.b4w_wind_bend_inheritance,p="INSTANCE"==s.b4w_shadow_inheritance,v="INSTANCE"==s.b4w_reflection_inheritance,m=[],O=[],N=0;N<n.length;N++){var h=n[N]._object.render,b=nt.clone_render(t);b.billboard=s.b4w_hair_billboard,b.billboard_type=s.b4w_hair_billboard_type,b.billboard_spherical="SPHERICAL"==s.b4w_hair_billboard_geometry,b.dynamic_grass=P,b.is_hair_particles=!0,S?(b.wind_bending=h.wind_bending,b.wind_bending_angle=h.wind_bending_angle,b.wind_bending_freq=h.wind_bending_freq,b.detail_bending_freq=h.detail_bending_freq,b.main_bend_col=h.main_bend_col,b.detail_bending_amp=h.detail_bending_amp,b.branch_bending_amp=h.branch_bending_amp,b.wind_bending_amp=h.wind_bending_amp,b.detail_bend_col=h.detail_bend_col,b.bend_center_only=!1):(b.wind_bending=d.render.wind_bending,b.wind_bending_angle=d.render.wind_bending_angle,b.wind_bending_freq=d.render.wind_bending_freq,b.detail_bending_freq=d.render.detail_bending_freq,b.main_bend_col=d.render.main_bend_col,b.detail_bending_amp=d.render.detail_bending_amp,b.branch_bending_amp=d.render.branch_bending_amp,b.wind_bending_amp=d.render.wind_bending_amp,b.detail_bend_col=d.render.detail_bend_col,b.bend_center_only=!0),p?(b.shadow_cast=h.shadow_cast,b.shadow_cast_only=h.shadow_cast_only,b.shadow_receive=h.shadow_receive):(b.shadow_cast=d.render.shadow_cast,b.shadow_cast_only=d.render.shadow_cast_only,b.shadow_receive=d.render.shadow_receive),v?(b.reflexible=h.reflexible,b.reflexible_only=h.reflexible_only,b.reflective=h.reflective,b.cube_reflection_id=h.cube_reflection_id,b.plane_reflection_id=h.plane_reflection_id,b.reflection_type=h.reflection_type):(b.reflexible=d.render.reflexible,b.reflexible_only=d.render.reflexible_only,b.reflective=d.render.reflective,b.cube_reflection_id=d.render.cube_reflection_id,b.plane_reflection_id=d.render.plane_reflection_id,b.reflection_type=d.render.reflection_type),m.push(b);var Y=i[N];Y||(Y=new Float32Array),T&&R._13(c.seed,l);var L=new Float32Array(3),M=new Float32Array([0,0,0,1]),y=[],x=-1!=R._70(ft.loaded_data_version,Ct)&&!s.b4w_initial_rand_rotation&&!s.b4w_hair_billboard,U=4;x&&(U=8);for(var w=0;w<Y.length;w+=U){L[0]=Y[w],L[1]=Y[w+1],L[2]=Y[w+2];var C=Y[w+3]*g.i(h.world_tsr);if(s.b4w_initial_rand_rotation){switch(s.b4w_rotation_type){case"XYZ":var D=new Float32Array([R._40(l),R._40(l),R._40(l)]);I.normalize(D,D);break;case"Z":var D=new Float32Array([0,0,1]);break;default:Ze.panic("Unsupported random rotation type: "+s.b4w_rotation_type)}var F=s.b4w_rand_rotation_strength;A.setAxisAngle(D,F*(2*Math.PI*R._40(l)-Math.PI),M)}else if(x&&(M.set(Y.subarray(w+4,w+8)),R._29(M,M),!s.use_whole_group))if(s.use_rotation_dupli){var G=g.g(h.world_tsr,Mt);A.multiply(M,G,M)}else A.multiply(M,Nt,M);var k=g.t(L,C,M,g.b());y.push(k)}O.push(y)}for(var K={},B=0,N=0;N<n.length;N++)for(var X=n[N]._object.materials,w=0;w<X.length;w++)X[w].name in K?K[X[w].name]++:(K[X[w].name]=1,B++);B=B||1;for(var j={},N=0;N<n.length;N++){var H=n[N],Q=o[N],b=m[N],q={};b.wind_bending&&(q.au_wind_bending_amp=[b.wind_bending_amp],q.au_wind_bending_freq=[b.wind_bending_freq],q.au_detail_bending_freq=[b.detail_bending_freq],q.au_detail_bending_amp=[b.detail_bending_amp],q.au_branch_bending_amp=[b.branch_bending_amp],b.wind_bending_amp=0,b.wind_bending_freq=0,b.detail_bending_freq=0,b.detail_bending_amp=0,b.branch_bending_amp=0);var y=O[N];if(y.length){for(var V=H.data,X=H._object.materials,W=new Array(X.length),J=new Array(X.length),w=0;w<X.length;w++)if(!Je(d,w)&&!dt.has_empty_submesh(V,w))for(var Z=0;Z<Q.length;Z++){var $=Q[Z],ee=_($),te=X[w];"MAIN"==$?W[w]=ee:"DEBUG_VIEW"==$&&(J[w]=ee),ee.cluster_id=e.b4w_cluster_data.cluster_id;var re=Ie(ee,te);if(re){ee.lights=R.O(u);var ae=z(ee,te,V);if(ae){"SHADOW"==$&&W[w]&&(ee.use_shadeless=W[w].use_shadeless),ee.draw_mode=dt.DM_DEFAULT,Ae(ee,b),ee.odd_id_prop=We(ee,b,s.uuid),ee.do_not_cull=e.b4w_do_not_cull||s.b4w_dynamic_grass,"MAIN"==ee.type&&(ee.caustics=e.b4w_caustics);var _e="COLOR_ID"!=$&&"SHADOW"!=$&&e.b4w_disable_fogging;me(ee,"DISABLE_FOG",0|_e),"JITTERED"==s.b4w_hair_billboard_type&&(ee.jitter_amp=s.b4w_hair_billboard_jitter_amp,ee.jitter_freq=s.b4w_hair_billboard_jitter_freq),P&&(ee.grass_scale_threshold=s.b4w_dynamic_grass_scale_threshold),S||(delete ee.vertex_colors_usage.a_bending_col_main,delete ee.vertex_colors_usage.a_bending_col_detail);var ne=dt.extract_submesh(V,w,ee.common_attributes,t.bone_skinning_info,ee.vertex_colors_usage,ee.uv_maps_usage),oe=d.render.world_tsr,ie=!0;if(K[te.name]>1){var se=0;for(var ce in ne.va_frames)se++;ie=ne.indices.length*y.length*se*K[te.name]>gt*B}var Ee=ft.allow_instanced_arrays_ext&&ie&&"PHYSICS"!=ee.type;if(Ee){ee.inst_array_state=s.use_whole_group?Rt:ht;var le=dt.clone_submesh(ne);if(dt.calc_unit_boundings(ne,le,y),le.instanced_array_data={tsr_array:y,stat_part_em_tsr:oe,static_hair:"STATIC"==t.type,submesh_params:q,part_inh_attrs:{},dyn_grass:P},b.wind_bending&&b.bend_center_only){var Te=I.fromValues(0,0,0);g.D(Te,d.render.world_tsr,Te);for(var ue=[],de=0;de<y.length;de++)ue.push(Te[0],Te[1],Te[2]);le.instanced_array_data.part_inh_attrs.a_emitter_center={num_comp:3,data:ue}}dt.calc_unit_boundings(ne,ne,y),"STATIC"==t.type&&dt.bounding_data_apply_transform(le.submesh_bd,oe)}else{var le=dt.make_propagated_submesh(ne,q,y);le=Me(le,y),b.wind_bending&&b.bend_center_only&&(le=ye(le,d.render.world_tsr))}var fe=Ye(s.b4w_vcol_from_name,s.b4w_vcol_to_name,ee,r,!S,V);le=xe(le,y,d.render.bb_local,a,fe,ee.vertex_colors_usage,j,Ee),me(ee,"USE_INSTANCED_PARTCLS",le.instanced_array_data?1:0),De(ee),f.push({batch:ee,obj_render:t,batch_render:b,submesh:le,mat_names:[te.name],rel_bpy_objects:[e]})}}}for(var w=0;w<J.length;w++)J[w]&&(J[w].debug_main_batch_id=W[w].id,De(J[w]))}}return f}function Ie(e,t){var r=!0;return"NODES_GLOW"==e.type&&(r=_t.check_material_glow_output(t)),r}function be(e,t,r){e.cell_size=new Float32Array(3),e.base_point=new Float32Array(3),e.verts_indices=new Uint32Array(r.length/3),e.octs_indices=new Uint32Array(r.length/3),e.cell_size[0]=(t.max_x-t.min_x)/Ot,e.cell_size[1]=(t.max_y-t.min_y)/Ot,e.cell_size[2]=(t.max_z-t.min_z)/Ot,e.base_point[0]=t.min_x,e.base_point[1]=t.min_y,e.base_point[2]=t.min_z;for(var a=0;a<r.length/3;a++){var _=r[3*a],n=r[3*a+1],o=r[3*a+2],i=R._64((_-e.base_point[0])/e.cell_size[0]),s=R._64((n-e.base_point[1])/e.cell_size[1]),c=R._64((o-e.base_point[2])/e.cell_size[2]);i=R.M(i,0,Ot-1),s=R.M(s,0,Ot-1),c=R.M(c,0,Ot-1),e.verts_indices[a]=a,e.octs_indices[a]=c*Math.pow(Ot,2)+s*Ot+i}dt.sort_two_arrays(e.octs_indices,e.verts_indices,dt.SORT_NUMERIC,!0),e.verts_offsets=new Uint32Array(Math.pow(Ot,3));for(var a=0;a<e.octs_indices.length;a++){var E=e.octs_indices[a];e.verts_offsets[E]++}delete e.octs_indices;for(var a=1;a<e.verts_offsets.length;a++)e.verts_offsets[a]+=e.verts_offsets[a-1];return e}function Ye(e,t,r,a,_,n){var o=[];if(""!==e&&""!==t){var i=Le(t,r.vertex_colors_usage);if(i.length>0)for(var s=0;s<i.length;s+=3)o.push({emitter_attr:e,emitter_mask:7,particle_attr:i[s],particle_mask:i[s+1],dst_channel_offset:i[s+2]});else dt.has_attr(r.common_attributes,"a_color")&&t==n.active_vcol_name&&o.push({emitter_attr:e,emitter_mask:7,particle_attr:"a_color",particle_mask:7,dst_channel_offset:0})}return _&&("a_bending_col_main"in a&&o.push({emitter_attr:"a_bending_col_main",emitter_mask:4,particle_attr:"a_bending_col_main",particle_mask:4,dst_channel_offset:0}),"a_bending_col_detail"in a&&o.push({emitter_attr:"a_bending_col_detail",emitter_mask:7,particle_attr:"a_bending_col_detail",particle_mask:7,dst_channel_offset:0})),o}function Le(e,t){var r=[];for(var a in t)for(var _=t[a].src,n=0,o=0;o<_.length;o++){var i=_[o].mask;e==_[o].name&&r.push(a,i,n),n+=R._43(i)}return r}function Me(e,t){e.va_common.au_center_pos=new Float32Array(3*e.base_length);for(var r=t.length,a=e.base_length/r,_=0;_<r;_++)for(var n=t[_],o=3*a*_,i=0;i<a;i++)e.va_common.au_center_pos[o+3*i]=n[0],e.va_common.au_center_pos[o+3*i+1]=n[1],e.va_common.au_center_pos[o+3*i+2]=n[2];return e}function ye(e,t){e.va_common.a_emitter_center=new Float32Array(3*e.base_length);var r=I.fromValues(0,0,0);g.D(r,t,r);for(var a=0;a<e.base_length;a++)e.va_common.a_emitter_center[3*a]=r[0],e.va_common.a_emitter_center[3*a+1]=r[1],e.va_common.a_emitter_center[3*a+2]=r[2];return e}function xe(e,t,r,a,_,n,o,i){for(var s=!1,c=0;c<_.length;c++){var E=_[c].emitter_attr,l=a.va_common[E];if(l&&l.length>0){s=!0;break}}if(i)var T=e.instanced_array_data.part_inh_attrs;if(s)for(var u=Ue(r,a.va_frames[0].a_position,t,o),d=e.base_length/t.length,c=0;c<_.length;c++){var f=_[c].particle_attr,P=_[c].particle_mask,E=_[c].emitter_attr,A=_[c].emitter_mask,l=a.va_common[E];switch(f){case"a_bending_col_main":var S=1;break;case"a_bending_col_detail":case"a_color":var S=3;break;default:for(var S=0,p=0;p<n[f].src.length;p++)S+=R._43(n[f].src[p].mask)}if(l&&l.length>0){var v=R._43(A),m=R._43(P),O=A&P,N=R._44(O);if(O!=P&&tt.error("Wrong color extraction from "+E+" to "+f+"."),i){T[f]={num_comp:S,data:[]};for(var p=0;p<t.length;p++)for(var g=u[p],h=g*v,I=0;I<N.length;I++)if(N[I]){var b=R._42(A,I);T[f].data.push(l[h+b])}}else{"a_bending_col_main"!=f&&"a_bending_col_detail"!=f||(e.va_common[f]=new Float32Array(e.base_length*m));for(var p=0;p<t.length;p++){var g=u[p],h=g*v,Y=p*d*S;if(-1!=g)for(var L=0;L<d;L++)for(var M=L*S,I=0;I<N.length;I++)if(N[I]){var b=R._42(A,I),y=_[c].dst_channel_offset+R._42(P,I);e.va_common[f][Y+M+y]=l[h+b]}}}}else e.va_common[f]=new Float32Array(0)}return e}function Ue(e,t,r,a){var _=new Float32Array(3),n=new Float32Array(3),o=new Uint32Array(r.length);"verts_indices"in a||be(a,e,t);for(var i=0;i<r.length;i++){_[0]=r[i][0],_[1]=r[i][1],_[2]=r[i][2];var s=1e10,c=-1,E=R._64((_[0]-a.base_point[0])/a.cell_size[0]),l=R._64((_[1]-a.base_point[1])/a.cell_size[1]),T=R._64((_[2]-a.base_point[2])/a.cell_size[2]);E=R.M(E,0,Ot-1),l=R.M(l,0,Ot-1),T=R.M(T,0,Ot-1);for(var u=T*Math.pow(Ot,2)+l*Ot+E,d=0==u?0:a.verts_offsets[u-1],f=a.verts_offsets[u],P=d;P<f;P++){var A=a.verts_indices[P];n[0]=t[3*A],n[1]=t[3*A+1],n[2]=t[3*A+2],I.sub(n,_,n);var S=I.sqrLen(n);S<=s&&(s=S,c=A)}if(-1==c)for(var P=0;P<t.length/3;P++){n[0]=t[3*P],n[1]=t[3*P+1],n[2]=t[3*P+2],I.sub(n,_,n);var S=I.sqrLen(n);S<=s&&(s=S,c=P)}o[i]=c}return o}function we(e,t,r,a,_){for(var n=t.length,o={},i=0;i<e.length;i+=_){var s=Math.floor(n*R._40(r));o[s]=o[s]||[],o[s].push(e[i],e[i+1],e[i+2],e[i+3]),a&&o[s].push(e[i+4],e[i+5],e[i+6],e[i+7])}for(var s in o)o[s]=new Float32Array(o[s]);return o}function Ce(e,t,r,a,_,n){for(var o={},i=[],s=0;s<t.length;s++)for(var c=t[s],E=c.origin_name||c.name,l=0;l<r.length;l++){var T=r[l];E==T.name&&i.push(T)}r.length!=i.length&&tt.error("dupli weights match failed");for(var s=0;s<e.length;s+=n){var u=function(e){for(var t=[0],r=0;r<e.length;r++){var _=e[r];t[r+1]=t[r]+_.count}for(var n=t[t.length-1],o=n*R._40(a),i=0,r=0;r<t.length;r++)if(o>=t[r]&&o<t[r+1]){i=r;break}return i}(i);o[u]=o[u]||[],o[u].push(e[s],e[s+1],e[s+2],e[s+3]),_&&o[u].push(e[s+4],e[s+5],e[s+6],e[s+7])}for(var u in o)o[u]=new Float32Array(o[u]);return o}function De(e){Fe(e,function(e){e.id=0,e.id=et.calc_variable_id(e,0)})}function Fe(e,t){for(var r=null,a=null,_=[],n=0;n<e.textures.length;n++){var o=e.textures[n],i=o.canvas_context;i&&(r||(r={}),r[n]=i,o.canvas_context=null);var s=o.video_file;s&&(a||(a={}),a[n]=s,o.video_file=null),_.push(o.num_users),o.num_users=0}var c=e.bounds_local;e.bounds_local=null;var E=e.vaos;e.vaos=null;var l=e.bufs_data;e.bufs_data=null;var T=e.submesh;if(e.submesh=null,t(e),e.bufs_data=l,e.submesh=T,e.vaos=E,e.bounds_local=c,r)for(var n in r)e.textures[n].canvas_context=r[n];if(a)for(var n in a)e.textures[n].video_file=a[n];for(var n=0;n<e.textures.length;n++)e.textures[n].num_users=_[n]}function Ge(e,t,r,a){var n=_("DEBUG_VIEW");if(ke(n,"debug_view.glslv","debug_view.glslf"),n.debug_sphere=!0,n.depth_mask=!0,n.odd_id_prop=We(n,e,t),n.debug_sphere_dynamic=r,Ae(n,e),De(n),a.use_be){var i=a.bounds_local.be,s=I.create(),c=it.generate_uv_sphere(16,8,1,s,!1,!1),E=I.fromValues(I.length(i.axis_x),I.length(i.axis_y),I.length(i.axis_z));dt.scale_submesh_xyz(c,E,s);var l=I.normalize(i.axis_x,It),u=I.normalize(i.axis_y,bt),d=I.normalize(i.axis_z,Yt);!E[0]&&E[1]&&E[2]?I.cross(u,d,l):!E[1]&&E[0]&&E[2]?I.cross(d,l,u):!E[2]&&E[0]&&E[1]&&I.cross(l,u,d);var f=R.W(l,u,d,xt);T.invert(f,f);var P=A.fromMat3(f,Lt);g.r(P,yt),g.s(1,yt),g.v(i.center,yt),dt.submesh_apply_transform(c,yt)}else var S=a.bounds_local.bs,c=it.generate_uv_sphere(16,8,S.radius,S.center,!1,!1);return o.t(a.bounds_local,n.bounds_local),dt.submesh_drop_indices(c,1,!0),c.va_common.a_polyindex=dt.extract_polyindices(c),Ne(n,c),n}function ke(e,t,r){e.shaders_info.vert=t,e.shaders_info.frag=r,lt.set_default_directives(e.shaders_info)}function Ke(e,t,r,a){a=a||"",-1==e.texture_names.indexOf(r)&&(e.textures.push(t),e.texture_names.push(r),e.bpy_tex_names.push(a)),e.shader&&st.assign_texture_uniforms(e)}function Be(e){return e.shaders_info||Ze.panic("No shaders info for batch "+e.name),e.shader=lt.get_compiled_shader(e.shaders_info),Xe(e),e.shaders_info.status===lt.VALID&&(st.assign_uniform_setters(e.shader),st.assign_attribute_setters(e),st.assign_texture_uniforms(e),!0)}function Xe(e){var t=e.shaders_info;if(t.status===lt.VALID){var r=e.shader,a=r.attributes,_=e.bufs_data.pointers;for(var n in a){_[n]||Ze.panic('missing data for "'+n+'" attribute')}}t.status&lt.INVALID_TEX_IMAGE_UNITS&&tt.error("Texture limit exceeded for shader - "+t.frag+', materials: "'+e.material_names.join(", ")+'". Maximum texture count: '+Pt.max_texture_image_units+", actual texture count: "+t.texture_count),t.status&lt.INVALID_F_UNIFORM_VECTORS&&tt.error("Fragment uniform limit exceeded for shader - "+t.frag+', materials: "'+e.material_names.join(", ")+'". '),t.status&lt.INVALID_V_UNIFORM_VECTORS&&tt.error("Vertex uniform limit exceeded for shader - "+t.vert+', materials: "'+e.material_names.join(", ")+'". '),t.status&lt.INVALID_VERTEX_ATTRIBS&&tt.error("Vertex attribute limit exceeded for shader - "+t.vert+', materials: "'+e.material_names.join(", ")+'". Maximum attribute count: '+Pt.max_vertex_attribs+", actual attribute count: "+t.attribute_count),t.status&lt.INVALID_VARYING_VECTORS&&je(e),t.status&lt.COMPILATION_ERROR&&tt.error("Shader compilation/linking error: "+t.vert+", "+t.frag+', materials: "'+e.material_names.join(", ")+'"')}function je(e){if("MAIN"!=e.type||e.has_nodes||tt.error("Varying limit exceeded for shader - "+e.shaders_info.frag+', materials: "'+e.material_names.join(", ")+'"'),"MAIN"==e.type&&e.has_nodes||"NODES_GLOW"==e.type){var t=0,r=0;e.uv_maps_usage&&(t=R._8(e.uv_maps_usage)),e.vertex_colors_usage&&(r=R._8(e.vertex_colors_usage)),tt.error("Varying limit exceeded for node shader - "+e.shaders_info.frag+", uv: "+t+", vc: "+r+', materials: "'+e.material_names.join(", ")+'"')}}function He(e,t,r){for(var a=e.scenes_data[0],_=a.batches,n=0;n<_.length;n++)if(_[n].type==r&&-1!=_[n].material_names.indexOf(t))return _[n];return null}function Qe(e,t,r){for(var a=e.scenes_data[0],_=a.batches,n=0;n<_.length;n++)if(_[n].type==r&&!_[n].forked_batch&&-1!=_[n].material_names.indexOf(t))return _[n];return null}function ze(e,t,r){for(var a=e.scenes_data[0],_=a.batches,n=0;n<_.length;n++)if(_[n].type==r&&_[n].forked_batch&&-1!=_[n].material_names.indexOf(t))return _[n];return null}function qe(e,t,r,a){for(var _=e.scenes_data[0],n=_.batches,o=0;o<n.length;o++){var i=n[o];if(-1!=i.material_names.indexOf(t)&&(!a||i.type==a)&&r(i))return}}function Ve(e,t,r){for(var a=r?nt.get_scene_data(e,r):e.scenes_data[0],_=a.batches,n=0;n<_.length;n++)if(_[n].type==t)return _[n];return null}function We(e,t,r){var a=r;return"NAVMESH"==e.subtype?a:t.dynamic_geometry?"_odd_id_"+et.unique_id():a}function Je(e,t){return t>=0&&t<e.mat_inheritance_data.is_disabled.length&&e.mat_inheritance_data.is_disabled[t]}var Ze=Object(n.a)(e),$e=Object(i.a)(e),et=Object(s.a)(e),tt=Object(c.a)(e),rt=Object(E.a)(e),at=Object(l.a)(e),_t=Object(u.a)(e),nt=Object(d.a)(e),ot=Object(f.a)(e),it=Object(P.a)(e),st=Object(S.a)(e),ct=Object(p.a)(e),Et=Object(v.a)(e),lt=Object(m.a)(e),Tt=Object(O.a)(e),ut=Object(N.a)(e),dt=Object(h.a)(e),ft=$e.defaults,Pt=$e.context_limits,At=$e.scenes,St=$e.hmd_params,pt=!1,vt=!1,mt=!1,Ot=20,Nt=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),gt=2e5,ht=1,Rt=2,It=new Float32Array(3),bt=new Float32Array(3),Yt=new Float32Array(3),Lt=new Float32Array(4),Mt=A.create(),yt=g.b(),xt=T.create(),Ut={},wt=new Float32Array(24),Ct=[5,4];t.batch_get_debug_storage=r,t.batch_set_debug_storage=a,t.clone_batch=Y,t.generate_main_batches=function(e,t,r,a){var _=(r||[]).map(function(e){return e.light}),n=x(t,e._render.graph,_);n=k(n);for(var o=0;o<n.length;o++){var i=n[o].batch;if(i.material_names=n[o].mat_names,Ne(i,n[o].submesh),Se(i,r,e),"STATIC"==n[o].render.type&&"COLOR_ID"!=i.type){var s=et.unique_name("%meta%"+i.type+"%"+i.material_names.join("%")+"%"),c=nt.create_object(s,"MESH");if(nt.meta_obj_append_render(c,n[o].render),nt.append_scene_data(c,e),nt.append_batch(c,e,i),a.push(c),"MAIN"==i.type)for(var E=0;E<n[o].rel_bpy_objects.length;E++){var l=n[o].rel_bpy_objects[E]._object;l.meta_objects.push(c)}}else{var l=n[o].rel_bpy_objects[0]._object;nt.append_batch(l,e,i)}}if(ft.debug_view){for(var o=0;o<n.length;o++){var T=n[o].render;if("DYNAMIC"==T.type){var l=n[o].rel_bpy_objects[0]._object,i=n[o].batch;if("MAIN"==i.type){for(var u=nt.get_scene_data(l,e),d=u.batches,f=!1,E=0;E<d.length;E++)if(d[E].debug_sphere){f=!0;continue}if(f)continue;var P=Ge(T,l.name,!0,i);nt.append_batch(l,e,P)}}}for(var o=0;o<a.length;o++){var l=a[o],T=l.render,u=nt.get_scene_data(l,e),i=u.batches[0];if("MAIN"==i.type){var P=Ge(T,l.name,!1,i);nt.append_batch(l,e,P)}}for(var o=0;o<n.length;o++){var i=n[o].batch;"DEBUG_VIEW"==i.type&&(i.debug_id_color=o)}}for(var o=0;o<t.length;o++)for(var u=nt.get_scene_data(t[o]._object,e),d=u.batches,E=0;E<d.length;E++)y(d[E]);for(var o=0;o<a.length;o++)for(var u=nt.get_scene_data(a[o],e),d=u.batches,E=0;E<d.length;E++)y(d[E])},t.append_sky_batch_to_world=function(e,t,r){var a=e._render.world_light_set,n=_("MAIN");if(ke(n,"sky.glslv","sky.glslf"),n.is_sky=!0,n.depth_mask=!1,t.procedural_skydome)me(n,"PROCEDURAL_SKYDOME",1),n.draw_proc_sky=!0;else{var o=a.sky_texture_param;Ke(n,ct.find_subs(e._render.graph,Tt.SKY).camera.color_attachment,"u_sky"),o&&(me(n,"WO_SKYTEX",1),o.invert&&me(n,"MTEX_NEGATIVE",1),o.use_rgb_to_intensity&&me(n,"MTEX_RGBTOINT",1),me(n,"BLENDTYPE",o.blend_type),o.use_map_blend&&me(n,"WOMAP_BLEND",1),o.use_map_horizon&&me(n,"WOMAP_HORIZ",1),o.use_map_zenith_up&&me(n,"WOMAP_ZENUP",1),o.use_map_zenith_down&&me(n,"WOMAP_ZENDOWN",1)),a.use_sky_blend&&me(n,"WO_SKYBLEND",1),a.use_sky_paper&&me(n,"WO_SKYPAPER",1),a.use_sky_real&&me(n,"WO_SKYREAL",1)}t.reflexible&&(n.reflexible=!0,t.reflexible_only&&(n.reflexible_only=!0)),ve(n,"a_position");var i=it.generate_fullscreen_quad();if(Ne(n,i),y(n),n.do_not_cull=!0,De(n),nt.append_batch(r,e,n),ct.find_subs(e._render.graph,Tt.DEBUG_VIEW)){var s=Y(n);s.type="DEBUG_VIEW",s.subtype="",de(s),me(s,"DEBUG_VIEW_SPECIAL_SKYDOME",1),i.va_common.a_polyindex=dt.extract_polyindices(i),Ne(s,i),s.debug_main_batch_id=n.id,De(s),nt.append_batch(r,e,s)}},t.create_forked_batches=function(e,t,r){for(var a=nt.get_scene_data(e,r),_=a.batches,n=[],o=ct.find_subs(t,Tt.MAIN_PLANE_REFLECT),i=ct.find_subs(t,Tt.MAIN_CUBE_REFLECT),s=ct.find_subs(t,Tt.OUTLINE_MASK),c=ct.find_subs(t,Tt.COLOR_PICKING),E=0;E<_.length;E++){var l=_[E],T=null;"SHADOW"==l.type&&"RECEIVE"==l.subtype&&l.shadow_cast&&(T=Y(l),T.subtype="CAST"),"MAIN"!=l.type&&"PARTICLES"!=l.type||!o&&!i||!l.reflexible||(T=Y(l),T.subtype="REFLECT",T.refractive=!1,T.z_sort&&(T.z_sort=!1,T.depth_mask=!1),T.particles_data=l.particles_data),"COLOR_ID"==l.type&&s&&e.render.outlining&&(c&&e.render.selectable?(T=Y(l),T.subtype="OUTLINE"):l.subtype="OUTLINE"),T&&(T.forked_batch=!0,De(T),n.push(T))}for(var u=0;u<n.length;u++)nt.append_batch(e,r,n[u])},t.wb_angle_to_amp=B,t.wb_amp_to_angle=X,t.bb_bpy_to_b4w=j,t.name_list_to_node_name=ce,t.update_batch_material_error=Ee,t.update_batch_lights=Se;var Dt=function(){var e=I.create();return function(t,r){if(r.uuid in t.lamp_uuid_indexes){var a=t.lamp_uuid_indexes[r.uuid],_=g.j(r.render.world_tsr,e);t.lamp_light_positions.set(_,3*a),t.lamp_light_directions.set(r.light.direction,3*a),t.lamp_light_color_intensities.set(r.light.color_intensity,3*a)}}}();t.set_lamp_data=Dt,t.assign_shadow_receive_dirs=function(e,t,r){if(me(e,"CSM_SECTION1",0),me(e,"CSM_SECTION2",0),me(e,"CSM_SECTION3",0),me(e,"NUM_CAST_LAMPS",0),t){me(e,"NUM_CAST_LAMPS",t.lamp_types.length),ft.mac_os_shadow_hack&&me(e,"MAC_OS_SHADOW_HACK",1);for(var a=1;a<t.csm_num;a++)me(e,"CSM_SECTION"+String(a),1);me(e,"SHADOW_TEX_RES",lt.glsl_value(t.csm_resolution)),me(e,"CSM_FADE_LAST_CASCADE",t.fade_last_cascade?1:0),me(e,"CSM_BLEND_BETWEEN_CASCADES",t.blend_between_cascades&&!ft.chrome_csm_blend_hack?1:0)}else me(e,"SHADOW_TEX_RES",0),me(e,"CSM_FADE_LAST_CASCADE",0),me(e,"CSM_BLEND_BETWEEN_CASCADES",0)},t.set_batch_directive=me,t.get_batch_directive=Oe,t.update_batch_geometry=Ne;var Ft=function(){var e=I.create();return function(t,r,a,_){for(var n={},o=new Float32Array([0,0,0,1]),i=0;i<t.length;i+=_)for(var s=0;s<r.length;s++){var c=I.create(),E=g.i(r[s].render.world_tsr),l=g.j(r[s].render.world_tsr,e);I.scale(l,E,c);var T=I.clone([t[i],t[i+1],t[i+2]]);n[s]||(n[s]=new Float32Array(t.length)),a&&(n[s][i+4]=o[0]=t[i+4],n[s][i+5]=o[1]=t[i+5],n[s][i+6]=o[2]=t[i+6],n[s][i+7]=o[3]=t[i+7],R._29(o,o),R._62(c,o,c)),I.add(T,c,T),n[s][i]=T[0],n[s][i+1]=T[1],n[s][i+2]=T[2],n[s][i+3]=t[i+3]}return n}}();t.update_batch_id=De,t.update_local_bounds_from_pos=function(e,t){e.bounds_local.bb=o.a(t,0,t.length,e.bounds_local.bb);var r=o.F(e.bounds_local.bb,wt);e.bounds_local.be=o.z(r,!0),e.bounds_local.bs=o.B(e.bounds_local.be),e.use_be=o.M(e.bounds_local.be,e.bounds_local.bs)},t.apply_shader=ke,t.append_texture=Ke,t.replace_texture=function(e,t,r){var a=e.texture_names.indexOf(r);a>-1&&(e.textures[a]=t)},t.create_shadeless_batch=function(e,t,r){var a=_("MAIN");return r<1&&(a.blend=!0),b.set(t[0],t[1],t[2],r,a.diffuse_color),a.draw_mode=dt.DM_TRIANGLES,Ne(a,e),ke(a,"main.glslv","main_stack.glslf"),me(a,"SHADELESS",1),Be(a),a},t.update_shader=Be,t.generate_line_batches=function(e,t){for(var r=0;r<t.length;r++){var a=t[r],n=_("LINE");ke(n,"line.glslv","line.glslf"),n.blend=!0,n.do_not_cull=!0;Ne(n,it.generate_line()),y(n),nt.append_scene_data(a,e),nt.append_batch(a,e,n),Be(n)}},t.check_batch_perm_uniform=function(e,t){return!!e.shader.permanent_uniform_setters.length&&!!e.shader.permanent_uniform_setters_table[t]},t.create_depth_pack_batch=function(e){var t=_("DEPTH_PACK");return t.use_backface_culling=!0,t.depth_mask=!1,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf"),Be(t),t},t.create_postprocessing_batch=function(e){var t=_("POSTPROCESSING");switch(ke(t,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf"),e){case"NONE":me(t,"POST_EFFECT","POST_EFFECT_NONE");break;case"GRAYSCALE":me(t,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case"X_BLUR":case"Y_BLUR":me(t,"POST_EFFECT","POST_EFFECT_BLUR");break;case"X_GLOW_BLUR":case"Y_GLOW_BLUR":case"X_BLOOM_BLUR":case"Y_BLOOM_BLUR":me(t,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case"X_DOF_BLUR":case"Y_DOF_BLUR":me(t,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case"X_ALPHA_BLUR":case"Y_ALPHA_BLUR":me(t,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case"X_EXTEND":case"Y_EXTEND":me(t,"POST_EFFECT","POST_EFFECT_EXTEND");break;case"FLIP_CUBEMAP_COORDS":me(t,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:Ze.panic("Wrong postprocessing effect: "+e)}return me(t,"SHADOW_USAGE","NO_SHADOWS"),t.use_backface_culling=!0,t.depth_mask=!1,Ne(t,it.generate_fullscreen_tri()),Be(t),t},t.create_ssao_batch=function(e){var t=_("SSAO");t.depth_mask=!1,t.use_backface_culling=!0,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf"),me(t,"SSAO_QUALITY","SSAO_QUALITY_"+e.ssao_samples),me(t,"SSAO_HEMISPHERE",e.ssao_hemisphere?1:0),me(t,"SHADOW_USAGE","NO_SHADOWS");var r={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])},a=ut.create_texture(ut.TT_RGBA_INT,!1);return a.source="NODE_TEX",ut.update_texture(a,r,0),Ke(t,a,"u_ssao_special_tex"),Be(t),t},t.create_ssao_blur_batch=function(e){var t=_("SSAO_BLUR");return t.depth_mask=!1,t.use_backface_culling=!0,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf"),me(t,"SSAO_BLUR_DEPTH",e.ssao_blur_depth?1:0),me(t,"SHADOW_USAGE","NO_SHADOWS"),Be(t),t},t.create_coc_batch=function(e){var t=_("COC");switch(t.depth_mask=!1,t.use_backface_culling=!0,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf"),me(t,"DEPTH_RGBA",1),e){case"COC_ALL":me(t,"COC_TYPE","COC_ALL");break;case"COC_FOREGROUND":me(t,"COC_TYPE","COC_FOREGROUND");break;case"COC_COMBINE":me(t,"COC_TYPE","COC_COMBINE")}return me(t,"SHADOW_USAGE","NO_SHADOWS"),Be(t),t},t.create_dof_batch=function(e){var t=_("DOF");return t.depth_mask=!1,t.use_backface_culling=!0,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf"),e.dof_bokeh?me(t,"DOF_TYPE","DOF_BOKEH"):(me(t,"DOF_TYPE","DOF_SIMPLE"),me(t,"DEPTH_RGBA",1)),me(t,"SHADOW_USAGE","NO_SHADOWS"),Be(t),t},t.create_outline_batch=function(){var e=_("OUTLINE");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf"),Be(e),e},t.create_glow_combine_batch=function(){var e=_("GLOW_COMBINE");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf"),Be(e),e},t.create_god_rays_batch=function(e,t,r){var a=_("GOD_RAYS");return a.depth_mask=!1,a.use_backface_culling=!0,Ne(a,it.generate_billboard()),ke(a,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf"),me(a,"DEPTH_RGBA",e?1:0),me(a,"WATER_EFFECTS",t?1:0),me(a,"STEPS_PER_PASS",lt.glsl_value(r,1)),me(a,"SHADOW_USAGE","NO_SHADOWS"),Be(a),a},t.create_god_rays_combine_batch=function(){var e=_("GOD_RAYS_COM");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf"),me(e,"SAFARI_CANVAS_ALPHA_HACK",ft.safari_canvas_alpha_hack?1:0),Be(e),e},t.create_cube_sky_batch=function(e,t){var r=_("SKY");if(r.depth_mask=!1,r.use_backface_culling=!1,Ne(r,it.generate_plane(1,1)),""!=t.sky_ngraph_proxy_id)ke(r,"skybox.glslv","node_skybox.glslf"),me(r,"IS_WORLD",1),ne(r,e);else if(t.procedural_skydome)ke(r,"skybox.glslv","proc_skybox.glslf"),me(r,"WATER_EFFECTS",1);else{if(ke(r,"skybox.glslv","tex_skybox.glslf"),e){var a=e._render.world_light_set;if(a.sky_texture_slot){var n=a.sky_texture_slot.texture,o=ut.get_batch_texture(a.sky_texture_slot,null);Ke(r,o,"u_sky_texture",n.name)}a.sky_texture_param&&me(r,"WO_SKYTEX",1)}t.sky_invert&&me(r,"MTEX_NEGATIVE",1),t.sky_use_rgb_to_intensity&&me(r,"MTEX_RGBTOINT",1),me(r,"BLENDTYPE",t.sky_blend_type),t.sky_use_map_blend&&me(r,"WOMAP_BLEND",1),t.sky_use_map_horizon&&me(r,"WOMAP_HORIZ",1),t.sky_use_map_zenith_up&&me(r,"WOMAP_ZENUP",1),t.sky_use_map_zenith_down&&me(r,"WOMAP_ZENDOWN",1),t.use_sky_blend&&me(r,"WO_SKYBLEND",1),t.use_sky_paper&&me(r,"WO_SKYPAPER",1),t.use_sky_real&&me(r,"WO_SKYREAL",1)}return Be(r),r},t.append_cube_sky_batch_to_world=function(e,t){var r=ct.find_subs(e._render.graph,Tt.SKY);if(r){var a=r.draw_data[0].bundles[0].batch;nt.append_batch(t,e,a)}},t.create_cube_irradiance_batch=function(e,t){var r=_("IRRADIANCE");return r.depth_mask=!1,r.use_backface_culling=!1,Ne(r,it.generate_plane(1,1)),ke(r,"skybox.glslv","irradiance_skybox.glslf"),Be(r),r},t.create_cube_roughness_convolution_batch=function(e,t){var r=_("R_CONVOLUTION");return r.depth_mask=!1,r.use_backface_culling=!1,Ne(r,it.generate_plane(1,1)),ke(r,"skybox.glslv","r_convolution_skybox.glslf"),Be(r),r},t.create_brdf_batch=function(e,t){var r=_("BRDF");return r.depth_mask=!1,r.use_backface_culling=!1,Ne(r,it.generate_plane(1,1)),ke(r,"postprocessing/postprocessing.glslv","postprocessing/precompute_brdf.glslf"),Be(r),r},t.create_antialiasing_batch=function(e){var t=_("ANTIALIASING");return t.depth_mask=!1,t.use_backface_culling=!0,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf"),ft.quality_aa_method?(me(t,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),me(t,"AA_QUALITY",e.fxaa_quality)):me(t,"AA_METHOD","AA_METHOD_FXAA_LIGHT"),Be(t),t},t.create_smaa_batch=function(e){var t=_("SMAA");return Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/smaa.glslv","postprocessing/smaa.glslf"),me(t,"AA_METHOD","AA_METHOD_SMAA_HIGH"),me(t,"SMAA_PASS",e),me(t,"SMAA_PREDICATION",0),me(t,"SMAA_REPROJECTION",0),Be(t),t.depth_mask=!1,t.use_backface_culling=!0,t},t.create_compositing_batch=function(){var e=_("COMPOSITING");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf"),Be(e),e},t.create_motion_blur_batch=function(e){var t=_("MOTION_BLUR");return t.use_backface_culling=!0,t.depth_mask=!1,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf"),Be(t),t},t.create_stereo_batch=function(e){var t=_("STEREO");return t.use_backface_culling=!0,t.depth_mask=!1,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf"),me(t,"ANAGLYPH","ANAGLYPH"===e?1:0),me(t,"SIDEBYSIDE","SIDEBYSIDE"===e?1:0),me(t,"DISTOR_SCALE",St.nonwebvr.distor_scale),Be(t),t},t.create_luminance_batch=function(){var e=_("LUMINANCE");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf"),Be(e),e},t.create_average_luminance_batch=function(){var e=_("LUMINANCE");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf"),Be(e),e},t.create_luminance_truncated_batch=function(e){var t=_("LUMINANCE_X_BLUR");return t.depth_mask=!1,t.use_backface_culling=!0,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/luminance_truncated.glslf"),e&&lt.set_directive(t.shaders_info,"ADAPTIVE_BLOOM",1),Be(t),t},t.create_bloom_combine_batch=function(e){var t=_("BLOOM");if(t.depth_mask=!1,t.use_backface_culling=!0,Ne(t,it.generate_fullscreen_tri()),ke(t,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf"),1==e)var r="BLUR_PASS_1";else if(2==e)var r="BLUR_PASS_2";else if(3==e)var r="BLUR_PASS_3";else if(4==e)var r="BLUR_PASS_4";else if(5==e)var r="BLUR_PASS_5";return lt.set_directive(t.shaders_info,"BLUR_PASS_NUM",r),Be(t),t},t.create_velocity_batch=function(){var e=_("VELOCITY");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf"),Be(e),e},t.create_anchor_visibility_batch=function(){var e=_("ANCHOR_VISIBILITY");return e.depth_mask=!0,e.use_backface_culling=!0,e.draw_mode=dt.DM_TRIANGLES,ke(e,"anchors.glslv","anchors.glslf"),Ne(e,it.generate_index(1)),me(e,"ANCHOR_NUM",1),Be(e),e.anchor_positions=new Float32Array(3),e},t.create_performance_batch=function(){var e=_("PERFORMANCE");return e.depth_mask=!1,e.use_backface_culling=!0,Ne(e,it.generate_fullscreen_tri()),ke(e,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf"),Be(e),e},t.update_anchor_visibility_batch=function(e,t){var r=t.length/3;if(r!=e.anchor_positions.length/3){Ne(e,it.generate_index(r)),me(e,"ANCHOR_NUM",r),Be(e)}e.anchor_positions=t},t.get_first_batch=function(e){if(!e.scenes_data.length)return null;var t=e.scenes_data[0];return t.batches.length?t.batches[0]:null},t.find_batch_material_any=He,t.find_batch_material=Qe,t.find_batch_material_forked=ze,t.iterate_batches_by_mat=qe,t.check_batch_type=function(e,t){for(var r=e.scenes_data[0],a=r.batches,_=0;_<a.length;_++)if(a[_].type==t)return!0;return!1},t.get_batch_by_type=Ve,t.clear_batch=function(e){var t=e.textures;e.textures=[];for(var r=0;r<t.length;r++)ut.cleanup_unused(t[r]);if(e.textures=t,e.bufs_data&&e.bufs_data.cleanup_gl_data_on_unload&&dt.cleanup_bufs_data(e.bufs_data),e.cleanup_gl_data_on_unload&&e.vaos.length&&st.cleanup_vao(e),e.shader&&e.shader.cleanup_gl_data_on_unload&&lt.cleanup_shader(e.shader),e.ngraph_proxy_id){var a=_t.get_ngraph_proxy_cached(e.ngraph_proxy_id);a&&a.cleanup_on_unload&&_t.cleanup_ngraph_proxy(e.ngraph_proxy_id)}},t.set_cleanup_nodemat=function(e,t){if(""!==e.ngraph_proxy_id){var r=_t.get_ngraph_proxy_cached(e.ngraph_proxy_id);r&&(r.cleanup_on_unload=t)}},t.generate_odd_id=We,t.cleanup=function(){Ut={}},t.set_nodemat_value=function(e,t,r){for(var a=e.node_value_inds,_=0;_<a.length;_+=3)if(a[_]==t)return e.node_values[4*a[_+1]+a[_+2]]=r,!0;return!1},t.set_nodemat_rgb=function(e,t,r,a,_){for(var n=e.node_rgb_inds,o=0;o<n.length;o+=2)if(n[o]==t){var i=n[o+1];return e.node_rgbs[3*i]=r,e.node_rgbs[3*i+1]=a,e.node_rgbs[3*i+2]=_,!0}return!1},t.get_nodemat_value=function(e,t){for(var r=e.node_value_inds,a=0;a<r.length;a+=3)if(r[a]==t)return e.node_values[4*r[a+1]+r[a+2]];return null},t.get_nodemat_rgb=function(e,t,r){for(var a=e.node_rgb_inds,_=0;_<a.length;_+=2)if(a[_]==t){var n=a[_+1];return r[0]=e.node_rgbs[3*n],r[1]=e.node_rgbs[3*n+1],r[2]=e.node_rgbs[3*n+2],r}return null}}var _=r(0),n=r(5),o=r(25),i=r(4),s=r(34),c=r(1),E=r(29),l=r(30),T=r(28),u=r(66),d=r(9),f=r(50),P=r(68),A=r(8),S=r(22),p=r(61),v=r(10),m=r(37),O=r(11),N=r(17),g=r(6),h=r(20),R=r(2),I=r(3),b=r(7),Y=Object(_.a)("__batch",a);t.a=Y},function(e,t,r){"use strict";function a(e,t){function r(){return De||(De=Xe.createFramebuffer()),De}function a(){return Ce||(Ce=Xe.createTexture()),Ce}function _(){return{type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""}}function m(e,t,r){e.img_uuid=t.uuid,e.img_filepath=t.filepath,e.img_source=t.source,e.img_name=t.name,e.img_full_filepath=Object(v.b)(r+t.filepath),e.img_comp_method=t._comp_method,-1==Ge.textures.indexOf(e)&&(Ge.textures.push(e),Ge.loaded_status.push(!1))}function O(e){var t=_();return t.type=e.type,t.anisotropic_filtering=e.anisotropic_filtering,t.source=e.source,t.source_id=e.source_id,t.width=e.width,t.height=e.height,t.compress_ratio=e.compress_ratio,t.source_size=e.source_size,t.enable_canvas_mipmapping=e.enable_canvas_mipmapping,t.canvas_context=e.canvas_context,t.w_target=e.w_target,t.w_texture=e.w_texture,t.w_renderbuffer=e.w_renderbuffer,t.is_movie=e.is_movie,t.vtex_data_id=e.vtex_data_id,t.video_file=e.video_file,t.video_tex_name=e.video_tex_name,t.movie_length=e.movie_length,t.fps=e.fps,t.frame_start=e.frame_start,t.frame_offset=e.frame_offset,t.frame_duration=e.frame_duration,t.need_resize=e.need_resize,t.scale_fac=e.scale_fac,t.seq_video=e.seq_video,t.seq_movie_length=e.seq_movie_length,t.seq_fps=e.seq_fps,t.seq_cur_frame=e.seq_cur_frame,t.seq_video_played=e.seq_video_played,t.seq_last_discrete_mark=e.seq_last_discrete_mark,t.video_was_stopped=e.video_was_stopped,t.use_auto_refresh=e.use_auto_refresh,t.use_cyclic=e.use_cyclic,t.use_nla=e.use_nla,t.repeat=e.repeat,t.img_filepath=e.img_filepath,t.img_full_filepath=e.img_full_filepath,t.img_uuid=e.img_uuid,t.img_source=e.img_source,t.img_name=e.img_name,t.img_comp_method=e.img_comp_method,t}function N(e,t,r){var a=t.indexOf(".dds")>-1,_=t.indexOf(".pvr")>-1;e.img_comp_method=a?"dds":_?"pvr":"",e.img_filepath=t,e.img_full_filepath=r,e.img_uuid=u._4(),Ge.textures.push(e),Ge.loaded_status.push(!0)}function g(e,t){Xe.bindTexture(e.w_target,e.w_texture);var r=Xe.getTexParameter(e.w_target,Xe.TEXTURE_MAG_FILTER),a=Xe.getTexParameter(e.w_target,Xe.TEXTURE_MIN_FILTER),_=Xe.getTexParameter(e.w_target,Xe.TEXTURE_WRAP_S),n=Xe.getTexParameter(e.w_target,Xe.TEXTURE_WRAP_T);t.w_texture=Xe.createTexture(),Xe.bindTexture(t.w_target,t.w_texture),Xe.texParameteri(t.w_target,Xe.TEXTURE_MAG_FILTER,r),Xe.texParameteri(t.w_target,Xe.TEXTURE_MIN_FILTER,a),Xe.texParameteri(t.w_target,Xe.TEXTURE_WRAP_S,_),Xe.texParameteri(t.w_target,Xe.TEXTURE_WRAP_T,n),Xe.bindTexture(t.w_target,null)}function h(e,r,a){var n=_();if(n.type=e,n.source="NONE",n.use_mipmap=a,e==t.TT_RB_RGBA||e==t.TT_RB_DEPTH||e==t.TT_RB_RGBA_MS||e==t.TT_RB_DEPTH_MS)n.w_renderbuffer=Xe.createRenderbuffer();else{var o=Xe.TEXTURE_2D,i=Xe.createTexture();Xe.bindTexture(o,i),Xe.texParameteri(o,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),a?Xe.texParameteri(o,Xe.TEXTURE_MIN_FILTER,Fe[ye.texture_min_filter]):Xe.texParameteri(o,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),Xe.texParameteri(o,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(o,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE);var s=B(n),c=X(n),E=H(n);if(e==t.TT_DEPTH)var l=null;else if(e==t.TT_RGBA_FLOAT)var l=new Float32Array([204,204,204,255]);else var l=new Uint8Array([204,204,204,255]);Xe.texImage2D(o,0,c,1,1,0,s,E,l),ye.compared_mode_depth&&r&&Xe.texParameterf(o,Xe.TEXTURE_COMPARE_MODE,Xe.COMPARE_REF_TO_TEXTURE),Xe.bindTexture(o,null),n.w_target=o,n.w_texture=i}return n}function R(e,t,r){if(ye.anisotropic_available){var a=t.b4w_anisotropic_filtering;if("DEFAULT"===a&&(a=r),"OFF"!==a&&ye.anisotropic_filtering){var _=parseFloat(a.split("x")[0]);e.anisotropic_filtering=_}}}function I(e,t){("REPEAT"!=t.extension||t.b4w_shore_dist_map)&&(e.repeat=!1)}function b(e,t){e.is_movie=!0,e.video_tex_name=t.name,e.frame_start=t.frame_start,e.frame_offset=t.frame_offset,e.frame_duration=t.frame_duration,e.use_auto_refresh=t.use_auto_refresh,e.use_cyclic=t.use_cyclic,e.movie_length=t.movie_length,e.use_nla=t.b4w_nla_video,0!=e.frame_offset&&he.warn('Frame offset for texture "'+t.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')}function Y(e,t,r){var a=t.b4w_source_id,_=t.b4w_source_size;e.source_id=a,e.enable_canvas_mipmapping=t.b4w_enable_canvas_mipmapping;var n=document.createElement("canvas");n.width=_,n.height=_,e.canvas_context=n.getContext("2d"),r in ke||(ke[r]={}),ke[r][a]=e}function L(e){var t=e.w_texture,r=e.w_target;Xe.bindTexture(r,t);var a=B(e),_=X(e),n=H(e),o=e.canvas_context.canvas;Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),Xe.texImage2D(r,0,_,a,n,o),Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!1),e.enable_canvas_mipmapping&&Xe.generateMipmap(r),Xe.bindTexture(r,null),e.width=o.width,e.height=o.height}function M(e){var t=e.w_texture,r=e.w_target;Xe.bindTexture(r,t),Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),4!=e.video_file.length?e.need_resize?U(e,e.video_file,e.width*e.scale_fac,e.height*e.scale_fac,!1):Xe.texImage2D(r,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,e.video_file):Xe.texImage2D(r,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,e.video_file),Xe.bindTexture(r,null)}function y(e){var t=e.w_texture,r=e.w_target;Xe.bindTexture(r,t),Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),e.need_resize?U(e,e.seq_video[e.seq_cur_frame],e.width*e.scale_fac,e.height*e.scale_fac,!1):Xe.texImage2D(r,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,e.seq_video[e.seq_cur_frame]),Xe.bindTexture(r,null)}function x(){return we||(we=document.createElement("canvas")),we}function U(e,t,_,n,o){o||(D(Xe.TEXTURE_2D),Xe.texImage2D(Xe.TEXTURE_2D,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,t)),Xe.bindTexture(Xe.TEXTURE_2D,null);var i=r(),s=a();Ie.draw_resized_texture(e,_,n,i,s,"NONE")}function w(e,t,_,n){D(Xe.TEXTURE_2D),Xe.texImage2D(Xe.TEXTURE_2D,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,t),Xe.bindTexture(Xe.TEXTURE_2D,null);for(var o=0;o<6;o++)Xe.texImage2D(Xe.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,Xe.RGBA,_,_,0,Xe.RGBA,Xe.UNSIGNED_BYTE,null);Xe.bindTexture(e.w_target,null);var i=r();Xe.bindFramebuffer(Xe.FRAMEBUFFER,i);for(var s=a(),o=0;o<6;o++)Ie.draw_resized_cubemap_texture(e,Xe[je[o]],_,n,s,o);Xe.bindFramebuffer(Xe.FRAMEBUFFER,null),Xe.bindTexture(e.w_target,e.w_texture),Xe.texParameteri(e.w_target,Xe.TEXTURE_MIN_FILTER,Fe[ye.texture_min_filter]),Xe.texParameteri(e.w_target,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR)}function C(e,t,r,a){for(var _=0;_<6;_++){var n=je[_],o=He[_],i=x();i.width=a,i.height=a;var s=i.getContext("2d");s.translate(a/2,a/2),"TEXTURE_CUBE_MAP_POSITIVE_X"==n?(s.rotate(Math.PI/2),s.scale(1,-1)):"TEXTURE_CUBE_MAP_NEGATIVE_X"==n?(s.rotate(Math.PI/2),s.scale(-1,1)):"TEXTURE_CUBE_MAP_POSITIVE_Y"==n||"TEXTURE_CUBE_MAP_POSITIVE_Z"==n?s.scale(1,-1):"TEXTURE_CUBE_MAP_NEGATIVE_Y"!=n&&"TEXTURE_CUBE_MAP_NEGATIVE_Z"!=n||s.scale(-1,1),s.drawImage(t,o[0]*r,o[1]*r,r,r,-a/2,-a/2,a,a),ye.d3d9_canvas_resizing_hack?Xe.texImage2D(Xe[n],0,Xe.RGBA,a,a,0,Xe.RGBA,Xe.UNSIGNED_BYTE,new Uint8Array(s.getImageData(0,0,a,a).data.buffer)):Xe.texImage2D(Xe[n],0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,i)}}function D(e){Xe.bindTexture(e,null);var t=a();Xe.bindTexture(e,t),k(e)}function F(e,t,r){var a=e.source,_=e.w_texture,n=e.w_target,o=e.img_comp_method,i=e.img_filepath,s=1,c=1;if(Xe.bindTexture(n,_),e.repeat?(Xe.texParameteri(n,Xe.TEXTURE_WRAP_S,Xe.REPEAT),Xe.texParameteri(n,Xe.TEXTURE_WRAP_T,Xe.REPEAT)):(Xe.texParameteri(n,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(n,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE)),e.is_movie||"NODE_TEX"==a?Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR):Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Fe[ye.texture_min_filter]),e.anisotropic_filtering&&Xe.texParameterf(n,ge.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,e.anisotropic_filtering),4==t.length){var E=!0;t=new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}if("IMAGE"==a)if(E)Xe.texImage2D(n,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,t),e.width=1,e.height=1;else if(o){var l=Oe.get_width_height(t,o),T=u.L(l.width)||u.L(l.height);if(q(l.width,l.height))return void he.error('Image "'+i+'" has unsupported size: '+l.width+"x"+l.height+". Max available: "+xe.max_texture_size+"x"+xe.max_texture_size+".");s=l.width,c=l.height,(T||"pvr"==o)&&(e.need_resize=!0,D(n),s=K(s*e.scale_fac),c=K(c*e.scale_fac)),"dds"==o?Oe.upload_dds_levels(Xe,ge.get_s3tc(),t,!0):"pvr"==o&&Oe.upload_pvr_levels(Xe,ge.get_pvr(),t,!0),e.need_resize&&(U(e,null,s,c,!0),Xe.bindTexture(n,_),Xe.generateMipmap(n)),e.width=s,e.height=c,e.compress_ratio=Oe.get_compress_ratio(t,o)}else{if(Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),e.is_movie?ye.seq_video_fallback?(s=t[0].width,c=t[0].height):(s=t.videoWidth,c=t.videoHeight):(s=t.width,c=t.height),e.width=s,e.height=c,q(s,c)&&(he.warn('Image "'+i+'" has unsupported size: '+s+"x"+c+". Max available: "+xe.max_texture_size+"x"+xe.max_texture_size+". Reduced image size will be used."),e.scale_fac=Math.min(xe.max_texture_size/s,xe.max_texture_size/c),e.need_resize=!0),e.is_movie)if(r in Ke||(Ke[r]={}),Ke[r][e.video_tex_name]=e,ye.seq_video_fallback){e.seq_video=t,e.seq_movie_length=t.length,e.fps=e.seq_fps*e.movie_length/t.length;var d=t[0]}else{e.video_file=t,e.video_file.loop=e.use_cyclic,e.fps=t.duration?e.movie_length/t.duration:Re.get_framerate(),Ue.disable_playback_rate_hack||(t.playbackRate=Re.get_framerate()/e.fps,Ue.clamp_playback_rate_hack&&t.playbackRate>Be&&(t.playbackRate=Be));var d=t;G(e)}else var d=t;if(s=K(e.width*e.scale_fac),c=K(e.height*e.scale_fac),e.need_resize||ye.resize_texture_canvas_hack){var f=x(),P=f.getContext("2d");f.width=s,f.height=c,P.drawImage(d,0,0,e.width,e.height,0,0,s,c),ye.d3d9_canvas_resizing_hack?Xe.texImage2D(n,0,Xe.RGBA,s,c,0,Xe.RGBA,Xe.UNSIGNED_BYTE,new Uint8Array(P.getImageData(0,0,s,c).data.buffer)):Xe.texImage2D(n,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,f)}else ye.webgl2||!u.L(e.width)&&!u.L(e.height)?Xe.texImage2D(n,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,d):(U(e,d,s,c,!1),e.need_resize=!0);e.width=s,e.height=c,e.is_movie||(Xe.bindTexture(n,_),Xe.generateMipmap(n))}else if("ENVIRONMENT_MAP"==a)if(E){for(var A=0;A<6;A++){var S=je[A];Xe.texImage2D(Xe["TEXTURE_CUBE_MAP_"+S],0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,t)}e.width=3,e.height=2}else{if(Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!1),t.width%3||t.height%2)return void he.error('Cubemap Image "'+i+'" has unsupported size: '+t.width+"x"+t.height+". The width must be multiple of three and the height - multiple of two.");var p=t.width/3;if(V(p)){he.warn('Cubemap Image "'+i+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+3*xe.max_cube_map_texture_size+"x"+2*xe.max_cube_map_texture_size+". Reduced image size will be used.");var v=xe.max_cube_map_texture_size/p,m=K(p*v);e.need_resize=!0}else{var m=K(p);!ye.webgl2&&q(3*m,2*m)&&(e.need_resize=!0)}e.need_resize||ye.resize_cubemap_canvas_hack?C(e,t,p,m):w(e,t,m,p),Ne.ff_cubemap_out_of_memory()&&(he.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),C(e,t,p,ve.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE)),e.width=3*m,e.height=2*m,Xe.generateMipmap(n)}else"NODE_TEX"==a&&(Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!1),Xe.texImage2D(n,0,Xe.RGBA,t.width,t.height,0,Xe.RGBA,Xe.UNSIGNED_BYTE,t.data),e.width=t.width,e.height=t.height);Xe.bindTexture(n,null)}function G(e){e.video_file.oncanplay=function(){re(e)&&M(e)}}function k(e){Xe.texParameteri(e,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(e,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE),Xe.texParameteri(e,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),Xe.texParameteri(e,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR)}function K(e){if(u.L(e)){var t=Math.pow(2,(0|e).toString(2).length);return u.M(t,2,xe.max_texture_size)}return e}function B(e){var r;switch(e.type){case t.TT_RGBA_INT:r=Xe.RGBA;break;case t.TT_RGB_INT:r=Xe.RGB;break;case t.TT_RGBA_FLOAT:r=Xe.RGBA;break;case t.TT_RGB_FLOAT:r=Xe.RGB;break;case t.TT_DEPTH:r=Xe.DEPTH_COMPONENT;break;default:pe.panic("Wrong texture type")}return r}function X(e){var r;switch(e.type){case t.TT_RGBA_INT:r=ye.webgl2?Xe.RGBA8:Xe.RGBA;break;case t.TT_RGB_INT:r=ye.webgl2?Xe.RGB8:Xe.RGB;break;case t.TT_RGBA_FLOAT:r=ye.webgl2?Xe.RGBA32F:Xe.RGBA;break;case t.TT_RGB_FLOAT:r=ye.webgl2?Xe.RGB8:Xe.RGB;break;case t.TT_DEPTH:r=ye.webgl2?j(xe.depth_bits):Xe.DEPTH_COMPONENT;break;default:pe.panic("Wrong texture type")}return r}function j(e){var t;switch(e){case 16:t=Xe.DEPTH_COMPONENT16;break;case 24:t=Xe.DEPTH_COMPONENT24;break;case 32:t=Xe.DEPTH_COMPONENT32F;break;default:t=Xe.DEPTH_COMPONENT24}return t}function H(e){var r;switch(e.type){case t.TT_RGBA_INT:case t.TT_RGB_INT:r=Xe.UNSIGNED_BYTE;break;case t.TT_RGBA_FLOAT:case t.TT_RGB_FLOAT:r=Xe.FLOAT;break;case t.TT_DEPTH:r=Xe.UNSIGNED_INT;break;default:pe.panic("Wrong texture type")}return r}function Q(e){e.w_texture&&Xe.deleteTexture(e.w_texture);var t=Ge.textures.indexOf(e);-1!=t&&(Ge.textures.splice(t,1),Ge.loaded_status.splice(t,1))}function z(e){return!(!e||!e.w_renderbuffer)}function q(e,t){return e>xe.max_texture_size||t>xe.max_texture_size}function V(e){return e>xe.max_cube_map_texture_size}function W(e,t){return t in Ke&&e in Ke[t]?Ke[t][e]:null}function J(e){return e.use_nla}function Z(e){e.video_file?e.video_file.play():e.seq_video&&(e.seq_video_played=!0),e.video_was_stopped=!1}function $(e){e.video_file?e.video_file.pause():e.seq_video&&(e.seq_video_played=!1),e.video_was_stopped=!0}function ee(e){e.video_file?e.video_file.currentTime=e.frame_offset/e.fps:e.seq_video&&(e.seq_cur_frame=ae(e,e.frame_offset),y(e))}function te(e){return e.video_file?!e.video_file.paused:!!e.seq_video&&e.seq_video_played}function re(e){return e.video_file||e.seq_video?!e.video_file||e.video_file.readyState>=2:0}function ae(e,t){return Math.round(t*e.seq_movie_length/e.movie_length)}function _e(e,t){if(Ye.is_dynamic(e))return oe(e,t);for(var r=e.meta_objects,a=0;a<r.length;a++){var _=oe(r[a],t);if(_)return _}return null}function ne(e,t,r){if(Ye.is_dynamic(e))ie(e,t,r);else for(var a=e.meta_objects,_=0;_<a.length;_++)ie(a[_],t,r)}function oe(e,t){var r=e.scenes_data;if(r.length)for(var a=r[0],_=a.batches,n=0;n<_.length;n++){var o=_[n];if("MAIN"==o.type||"SKY"==o.type)for(var i=0;i<o.textures.length;i++)if(o.bpy_tex_names[i]==t)return o.textures[i]}return null}function ie(e,t,r){var a=e.scenes_data;if(a.length)for(var _=a[0],n=_.batches,o=0;o<n.length;o++){var i=n[o];if("MAIN"==i.type)for(var s=0;s<i.textures.length;s++){var c=i.bpy_tex_names[s];if(c==t){var E=i.textures[s];i.textures[s]=r,fe(E)}}}}function se(e,t){var r=e.scenes_data;if(r.length)for(var a=r[0],_=a.batches,n=0;n<_.length;n++){var o=_[n];if("MAIN"==o.type)for(var i=0;i<o.textures.length;i++){var s=o.textures[i],c=o.bpy_tex_names[i];-1==t.indexOf(c)&&"NODE_TEX"!=s.source&&t.push(c)}}}function ce(e){var t=_();t.source="CANVAS",t.width=e.width,t.height=e.height,t.enable_canvas_mipmapping=e.enable_canvas_mipmapping,t.type=e.type;var r=document.createElement("canvas");return r.width=t.width,r.height=t.height,t.canvas_context=r.getContext("2d"),t.w_target=Xe.TEXTURE_2D,t.w_texture=Xe.createTexture(),Xe.bindTexture(Xe.TEXTURE_2D,t.w_texture),t.enable_canvas_mipmapping?Xe.texParameteri(Xe.TEXTURE_2D,Xe.TEXTURE_MIN_FILTER,Fe[ye.texture_min_filter]):Xe.texParameteri(Xe.TEXTURE_2D,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),Xe.texParameteri(Xe.TEXTURE_2D,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),Xe.bindTexture(Xe.TEXTURE_2D,null),t}function Ee(e,t){var r=t.canvas_context;e.canvas_context.drawImage(r.canvas,0,0),L(e)}function le(e,t,r){for(var a=e.elements,_=e.interpolation,n=0;n<t;n++){var o=n/(t-1),i=ue(a,o,!0),s=de(a,o,!0);i&&s&&("CONSTANT"==_?r.push.apply(r,i.color):Te(r,i,s,o)),s&&!i&&r.push.apply(r,s.color),i&&!s&&r.push.apply(r,i.color)}}function Te(e,t,r,a){if(t==r)e.push.apply(e,t.color);else{var _=Le.linear_interpolation(r.color[0],r.position,t.color[0],t.position,a);e.push(_);var n=Le.linear_interpolation(r.color[1],r.position,t.color[1],t.position,a);e.push(n);var o=Le.linear_interpolation(r.color[2],r.position,t.color[2],t.position,a);e.push(o);var i=Le.linear_interpolation(r.color[3],r.position,t.color[3],t.position,a);e.push(i)}}function ue(e,t,r){for(var a=null,_=0;_<e.length;_++){if(r)var n=t-e[_].position;else var n=t-e[_][1][0];if(n>=0)if(a){if(r)var o=t-a.position;else var o=t-e[_][1][0];n<=o&&(a=e[_])}else a=e[_]}return a}function de(e,t,r){for(var a=null,_=0;_<e.length;_++){if(r)var n=e[_].position-t;else var n=e[_][1][0]-t;if(n>=0)if(a){if(r)var o=a.position-t;else var o=a[1][0]-t;n<=o&&(a=e[_])}else a=e[_]}return a}function fe(e){ye.enable_texture_cache||Pe(e)||Q(e)}function Pe(e){for(var t=be.get_all_objects("ALL",be.DATA_ID_ALL),r=0;r<t.length;r++){var a=t[r];if(Ae(a,e))return!0;for(var _=a.meta_objects,n=0;n<_.length;n++)if(Ae(_[n],e))return!0}return!1}function Ae(e,t){for(var r=0;r<e.scenes_data.length;r++)for(var a=e.scenes_data[r].batches,_=0;_<a.length;_++)for(var n=a[_],o=n.textures,i=0;i<o.length;i++)if(o[i]==t)return!0}function Se(e,t){for(var r=0;r<Ge.textures.length;r++){var a=Ge.textures[r];if(a.img_full_filepath==e&&a.type==t.type&&a.source==t.source&&a.repeat==t.repeat&&a.anisotropic_filtering==t.anisotropic_filtering&&a.use_nla==t.use_nla)return a}return null}var pe=Object(n.a)(e),ve=Object(o.a)(e),me=Object(i.a)(e),Oe=Object(s.a)(e),Ne=Object(c.a)(e),ge=Object(E.a)(e),he=Object(l.a)(e),Re=Object(T.a)(e),Ie=Object(d.a)(e),be=Object(f.a)(e),Ye=Object(P.a)(e),Le=Object(A.a)(e),Me=Object(p.a)(e),ye=me.defaults,xe=me.context_limits,Ue=me.sfx,we=null,Ce=null,De=null;t.TF_NEAREST=0,t.TF_LINEAR=0,t.TF_NEAREST_MIPMAP_NEAREST=0,t.TF_LINEAR_MIPMAP_NEAREST=0,t.TF_NEAREST_MIPMAP_LINEAR=0,t.TF_LINEAR_MIPMAP_LINEAR=0,t.TT_RGBA_INT=10,t.TT_RGB_INT=20,t.TT_RGBA_FLOAT=30,t.TT_RGB_FLOAT=40,t.TT_DEPTH=50,t.TT_RB_RGBA=60,t.TT_RB_DEPTH=70,t.TT_RB_RGBA_MS=80,t.TT_RB_DEPTH_MS=90,t.CURVE_NODES_TEXT_SIZE=128,t.COLORRAMP_TEXT_SIZE=128,t.PART_COLORRAMP_TEXT_SIZE=128;var Fe,Ge={textures:[],loaded_status:[]},ke={},Ke={},Be=2,Xe=null,je=["TEXTURE_CUBE_MAP_POSITIVE_X","TEXTURE_CUBE_MAP_NEGATIVE_X","TEXTURE_CUBE_MAP_POSITIVE_Y","TEXTURE_CUBE_MAP_NEGATIVE_Y","TEXTURE_CUBE_MAP_POSITIVE_Z","TEXTURE_CUBE_MAP_NEGATIVE_Z"],He=[[2,0],[0,0],[2,1],[1,0],[1,1],[0,1]];t.setup_context=function(e){Fe=[e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],t.TF_NEAREST=e.NEAREST,t.TF_LINEAR=e.LINEAR,t.TF_NEAREST_MIPMAP_NEAREST=e.NEAREST_MIPMAP_NEAREST,t.TF_LINEAR_MIPMAP_NEAREST=e.LINEAR_MIPMAP_NEAREST,t.TF_NEAREST_MIPMAP_LINEAR=e.NEAREST_MIPMAP_LINEAR,t.TF_LINEAR_MIPMAP_LINEAR=e.LINEAR_MIPMAP_LINEAR,Xe=e},t.get_canvas_context=function(e,t){return t in ke&&e in ke[t]?ke[t][e].canvas_context:null},t.update_canvas_context=function(e,t){return t in ke&&e in ke[t]&&(L(ke[t][e]),!0)},t.append_img_info=m,t.create_texture=h,t.create_cubemap_texture=function(e,r){var a=Xe.createTexture(),n=Xe.TEXTURE_CUBE_MAP;Xe.bindTexture(n,a),Xe.texParameteri(n,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),r?Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Fe[ye.texture_min_filter]):Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),Xe.texParameteri(n,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(n,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE);for(var o=0;o<6;o++){var i=je[o];Xe.texImage2D(Xe[i],0,Xe.RGBA,e,e,0,Xe.RGBA,Xe.UNSIGNED_BYTE,null)}Xe.bindTexture(n,null);var s=_();return s.type=t.TT_RGBA_INT,s.source="NONE",s.width=3*e,s.height=2*e,s.compress_ratio=1,s.use_mipmap=r,s.w_texture=a,s.w_target=Xe.TEXTURE_CUBE_MAP,s},t.set_cubemap_tex_size=function(e,t){var r=e.w_texture,a=e.w_target;Xe.bindTexture(a,r);for(var _=0;_<6;_++){var n=je[_];Xe.texImage2D(Xe[n],0,Xe.RGBA,t,t,0,Xe.RGBA,Xe.UNSIGNED_BYTE,null)}Xe.bindTexture(a,null),e.width=3*t,e.height=2*t},t.set_filters=function(e,t,r){var a=e.w_target,_=e.w_texture;Xe.bindTexture(a,_),t&&Xe.texParameteri(a,Xe.TEXTURE_MIN_FILTER,t),r&&Xe.texParameteri(a,Xe.TEXTURE_MAG_FILTER,r),Xe.bindTexture(a,null)},t.resize=function(e,r,a){if(r=Math.max(r,1),a=Math.max(a,1),e.width!=r||e.height!=a){switch(e.type){case t.TT_RB_RGBA:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorage(Xe.RENDERBUFFER,Xe.RGB565,r,a),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;case t.TT_RB_DEPTH:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorage(Xe.RENDERBUFFER,j(xe.depth_bits),r,a),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;case t.TT_RB_RGBA_MS:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorageMultisample(Xe.RENDERBUFFER,ye.msaa_samples,Xe.RGBA8,r,a),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;case t.TT_RB_DEPTH_MS:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorageMultisample(Xe.RENDERBUFFER,ye.msaa_samples,j(xe.depth_bits),r,a),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;default:var _=e.w_texture,n=e.w_target;Xe.bindTexture(n,_);var o=B(e),i=X(e),s=H(e);if(e.use_mipmap){if(!ye.webgl2){var c=Math.max(r,a);r=K(c),a=K(c)}e.mipmap_count=Math.round(Math.log(Math.max(r,a))/Math.log(2)+.5)}Xe.texImage2D(n,0,i,r,a,0,o,s,null),Xe.bindTexture(n,null)}if(q(r,a))return void pe.panic('Slink texture "'+e.type+'" has unsupported size: '+r+"x"+a+". Max available: "+xe.max_texture_size+"x"+xe.max_texture_size+".");e.width=r,e.height=a}},t.create_texture_bpy=function(e,r,a,n,o){var i=e.type;if("BLEND"==i)return null;var s=e.image,c=_();if(c.type=t.TT_RGBA_INT,c.width=1,c.height=1,R(c,e,r),I(c,e),s){"IMAGE"==i&&"MOVIE"==s.source&&b(c,e),c.source=i;var E=Object(v.b)(o+s.filepath),l=Se(E,c);if(l)return l;m(c,s,o)}var T=new Uint8Array([204,204,204,255]);switch(i){case"IMAGE":var d=Xe.createTexture(),f=Xe.TEXTURE_2D;Xe.bindTexture(f,d),Xe.texImage2D(f,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,T);break;case"NONE":if("NONE"==e.b4w_source_type)return null;var d=Xe.createTexture(),f=Xe.TEXTURE_2D;if(c.source=e.b4w_source_type,"SCENE"==c.source){if(!e.b4w_source_id)return null;var P=e.b4w_source_id,A=u._19("name",P,a);if(!A)return null;c.source_id=e.b4w_source_id,c.source_size=e.b4w_source_size,A._render_to_textures=A._render_to_textures||[],A._render_to_textures.push(c),Xe.bindTexture(f,d),Xe.texImage2D(f,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,T)}else"CANVAS"==c.source&&(Y(c,e,n),Xe.bindTexture(f,d));break;case"ENVIRONMENT_MAP":var d=Xe.createTexture(),f=Xe.TEXTURE_CUBE_MAP;Xe.bindTexture(f,d);for(var S=["POSITIVE_X","NEGATIVE_X","POSITIVE_Y","NEGATIVE_Y","POSITIVE_Z","NEGATIVE_Z"],p=0;p<6;p++)Xe.texImage2D(Xe["TEXTURE_CUBE_MAP_"+S[p]],0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,T);break;default:return he.error('texture "'+e.name+'" has unsupported type "'+i+'"'),null}return c.w_texture=d,c.w_target=f,"NONE"==i?(c.enable_canvas_mipmapping?Xe.texParameteri(f,Xe.TEXTURE_MIN_FILTER,Fe[ye.texture_min_filter]):Xe.texParameteri(f,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),c.anisotropic_filtering&&Xe.texParameterf(f,ge.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,c.anisotropic_filtering),"CANVAS"==c.source&&L(c)):(Xe.generateMipmap(f),Xe.bindTexture(f,null)),c},t.update_texture_canvas=L,t.update_video_texture=M,t.update_seq_video_texture=y,t.update_texture=F,t.calc_pot_size=K,t.is_texture=function(e){return!(!e||!e.w_texture&&!e.w_renderbuffer)},t.is_renderbuffer=z,t.is_float=function(e){return e.type==t.TT_RGBA_FLOAT||e.type==t.TT_RGB_FLOAT},t.get_texture_texel_size=function(e){var r=0;switch(e.type){case t.TT_RGBA_INT:case t.TT_RGB_INT:r=4;break;case t.TT_RGBA_FLOAT:case t.TT_RGB_FLOAT:r=32;break;case t.TT_DEPTH:r=3;break;case t.TT_RB_RGBA:case t.TT_RB_DEPTH:r=2;break;case t.TT_RB_RGBA_MS:r=4*ye.msaa_samples;break;case t.TT_RB_DEPTH_MS:r=3*ye.msaa_samples}return r},t.cleanup=function(){if(!ye.seq_video_fallback)for(var e in Ke)for(var t in Ke[e])Ke[e][t].video_file.pause(),Ke[e][t].video_file.src="",Ke[e][t].video_file.load();Ge.textures.length=0,Ge.loaded_status.length=0,ke={},Ke={}},t.pause=function(){for(var e in Ke)for(var t in Ke[e]){var r=Ke[e][t];te(r)&&$(r)}},t.reset=function(){for(var e in Ke)for(var t in Ke[e]){var r=Ke[e][t];ee(r)}},t.play=function(e){for(var t in Ke)for(var r in Ke[t]){var a=Ke[t][r];e&&!a.video_was_stopped||Z(a)}},t.get_video_texture=W,t.video_allow_nla=J,t.play_video=Z,t.pause_video=$,t.reset_video=ee,t.set_frame_video=function(e,t,r){if(r in Ke&&e in Ke[r]){var a=Ke[r][e];return a.video_file?a.video_file.currentTime=t/a.fps:a.seq_video&&(a.seq_cur_frame=t,y(a)),!0}return!1},t.video_is_played=te,t.video_update_is_available=re,t.video_get_current_frame=function(e){return e.video_file||e.seq_video?e.video_file?Math.round(e.video_file.currentTime*e.fps):e.seq_cur_frame:0},t.video_get_start_frame=function(e){return e.video_file||e.seq_video?e.video_file?e.frame_offset:ae(e,e.frame_offset):0},t.video_get_end_frame=function(e){if(!e.video_file&&!e.seq_video)return 0;var t=Math.min(e.frame_duration,e.movie_length-e.frame_offset);return e.video_file?e.frame_offset+t:ae(e,e.frame_offset+t)},t.seq_video_get_discrete_timemark=function(e,t){return Math.round(t*e.seq_fps*(Re.get_framerate()/e.fps))},t.video_get_duration=function(e){return Math.min(e.frame_duration,e.movie_length-e.frame_offset)},t.video_frame_to_seq_frame=ae,t.get_canvas_context_by_object=function(e,t){var r=_e(e,t);return r&&"CANVAS"==r.source?r.canvas_context:null},t.get_texture_by_name=_e,t.set_texture_by_name=ne,t.get_texture_names=function(e){var t=[];if(Ye.is_dynamic(e))se(e,t);else for(var r=e.meta_objects,a=0;a<r.length;a++)se(r[a],t);return t},t.share_batch_canvas_textures=function(e){for(var t={},r=0;r<e.length;r++){for(var a=e[r].textures,_=e[r].texture_names,n=[],o=[],i=0;i<a.length;i++){var s=a[i],c=_[i];"CANVAS"==s.source&&(c in t?s=t[c]:(s=ce(a[i]),Ee(s,a[i]),t[c]=s)),n.push(s),o.push(c)}e[r].textures=n}},t.extract_col_ramps_data=function(e,t){for(var r=[],a=0;a<e.length;a++){le(e[a].data.value.color_ramp,t,r)}return new Uint8Array(r.map(function(e){return u.M(255*e,0,255)}))},t.calc_color_ramp_data=le,t.extract_vec_curves_data=function(e,t){for(var r=new Float32Array(3),a=new Float32Array(3),_=[],n=0;n<e.length;n++){for(var o=e[n].data.value,i=[],s=o.curve_mapping.curves_data,c=o.curve_mapping.curve_extend,E=o.curve_mapping.curves_handle_types,l=0;l<s.length;l++){for(var T=c[l],d=s[l],f=[],P=E[l],A=0;A<d.length;A++)f.push([new Float32Array(3),new Float32Array(d[A].concat(0)),new Float32Array(3)]);Le.calchandle_curvemap(f[0],null,f[1],P[0],P[0]);for(var A=1;A<f.length-1;A++)Le.calchandle_curvemap(f[A],f[A-1],f[A+1],P[A],P[A]);if(Le.calchandle_curvemap(f[f.length-1],f[f.length-2],null,P[f.length-1],P[f.length-1]),f.length>2){if("AUTO"==P[0]){S.subtract(f[0][2],f[0][1],r);var p=S.length(r);S.copy(f[1][0],a),a[0]<f[0][1][0]&&(a[0]=f[0][1][0]),S.subtract(a,f[0][1],a);var v=S.length(a);v>1e-8&&(S.scale(a,p/v,a),S.add(f[0][1],a,f[0][2]),S.subtract(f[0][1],a,f[0][0]))}var m=f.length-1;if("AUTO"==P[0]){S.subtract(f[m][0],f[m][1],r);var p=S.length(r);S.copy(f[m-1][2],a),a[0]>f[m][1][0]&&(a[0]=f[m][1][0]),S.subtract(a,f[m][1],a);var v=S.length(a);v>1e-8&&(S.scale(a,p/v,a),S.add(f[m][1],a,f[m][0]),S.subtract(f[m][1],a,f[m][2]))}}for(var m=0;m<f.length-1;m++)Le.correct_bezpart(f[m][1],f[m][2],f[m+1][0],f[m+1][1]);var O=[];if(s.length<=3)var N=Math.round(-t/2),g=Math.round(t/2);else var N=0,g=t;for(var A=N;A<g;A++){var h=A/(g-1),R=ue(f,h,!1),I=de(f,h,!1);if(R&&I)O.push(Le.bezier(h,R[1],R[2],I[0],I[1],.001));else if(I&&!R)if("EXTRAPOLATED"==T){var b=I[1][0]==I[2][0]?I[1][1]:Le.linear(h,I[1],I[2]);O.push(b)}else O.push(I[1][1]);else if(R&&!I)if("EXTRAPOLATED"==T){var b=R[0][0]==R[1][0]?R[1][1]:Le.linear(h,R[0],R[1]);O.push(b)}else O.push(R[1][1])}i.push(O)}_.push(i)}for(var Y=[],A=0;A<_.length;A++)for(var i=_[A],l=0;l<i[0].length;l++){if(i.length<=3)var L=u.M(127.5*(i[0][l]+1),0,255),M=u.M(127.5*(i[1][l]+1),0,255),y=u.M(127.5*(i[2][l]+1),0,255),m=255;else var L=u.M(255*i[0][l],0,255),M=u.M(255*i[1][l],0,255),y=u.M(255*i[2][l],0,255),m=u.M(255*i[3][l],0,255);Y.push(L,M,y,m)}return new Uint8Array(Y)},t.create_color_ramp_texture=function(e,r){var a=h(t.TT_RGBA_INT,!1);return a.source="NODE_TEX",a.repeat=!1,F(a,{width:r,height:e.length/(4*r),data:e}),a},t.change_image=function(e,t,r,a,_){var n=Object(v.b)(_);if("WORLD"!=e.type){var o=Se(n,t);if(o)var i=o;else{var i=O(t);g(t,i),N(i,_,n),F(i,a,0)}ne(e,r,i)}else{var i=t;N(i,_,n),F(i,a,0),Me.update_cube_sky_dim(e,i),Me.update_sky_texture(e)}},t.cleanup_unused=fe,t.get_batch_texture=function(e){return e.texture._render},t.reset_mod=function(){Xe=null},t.get_img_textures=function(){return Ge.textures},t.get_cache_loaded_status=function(e){var t=Ge.textures.indexOf(e);return-1!=t&&Ge.loaded_status[t]},t.set_cache_loaded_status=function(e,t){var r=Ge.textures.indexOf(e);-1!=r&&(Ge.loaded_status[r]=t)}}var _=r(0),n=r(5),o=r(38),i=r(4),s=r(77),c=r(48),E=r(29),l=r(1),T=r(18),u=r(2),d=r(22),f=r(12),P=r(9),A=r(82),S=r(3),p=r(10),v=r(51),m=Object(_.a)("__textures",a);t.a=m},function(e,t,r){"use strict";function a(e,t){function r(){return s}function a(){return++l}function _(){return++T}function o(){return-1!==i.animation.framerate?i.animation.framerate:d}var i=Object(n.a)(e),s=0,c=0,E=[],l=0,T=0,u=[],d=-1,f=0;t.set_timeline=function(e){s=e,c=performance.now();for(var t=0;t<E.length;t++){var r=E[t];s>r.expire_time&&(E.splice(t,1),t--,r.callback())}for(var t=0;t<u.length;t++){var a=u[t],_=1-(a.expire_time-s)/a.duration;_=Math.min(_,1);var n=a.from+_*(a.to-a.from);a.callback(n),1==_&&(u.splice(t,1),t--)}},t.get_timeline=r,t.set_delta=function(e){f=e},t.get_delta=function(){return f},t.set_timeout=function(e,t){var r=a(),_={id:r,callback:e,expire_time:s+(performance.now()-c+t)/1e3};return E.push(_),r},t.clear_timeout=function(e){for(var t=0;t<E.length;t++){if(E[t].id==e){E.splice(t,1);break}}},t.clear_animation=function(e){for(var t=u.length;t--;){if(u[t].id==e){u.splice(t,1);break}}},t.animate=function(e,t,r,a){var n=r/1e3,o=_(),i={id:o,callback:a,from:e,to:t,expire_time:s+n,duration:n};return u.push(i),a(e),o},t.reset=function(e){s=0,c=0,E.length=0,u.length=0,l=0,T=0},t.get_framerate=o,t.set_framerate=function(e){d=e},t.get_frame=function(e){return e*o()}}var _=r(0),n=r(4),o=Object(_.a)("__time",a);t.a=o},function(e,t,r){"use strict";function a(e,t){function r(e,t){for(var a=e.cons_descends,_=0;_<a.length;_++)a[_].physics_settings.use_collision_compound&&t.push(a[_]),r(a[_],t);return null}function a(e,t,r){for(var a=e._physics.bundles,_=0;_<a.length;_++)for(var n=a[_].physics,o=0;o<n.collision_tests.length;o++){var i=n.collision_tests[o];"ANY"!=i.collision_id&&r!=i.collision_id||le(i,e,t)}}function _(e,t){for(var r=e._physics.bundles,a=0;a<r.length;a++){var _=r[a].batch;if(_&&_.id==t.id)return!0}return!1}function m(e,t,r){if(Le.is_active(e))switch(t){case Le.IN_LOADED:var a=O(e);a._physics.worker_loaded=!0;var _=Date.now()-performance.now();Le.post_msg(e,Le.OUT_INIT,_,Fe.max_fps,Fe.calc_fps?Ge.fps_measurement_interval:0);break;case Le.IN_LOG:ye.log_raw("URANIUM:",r.slice(1));break;case Le.IN_ERROR:ye.error(r);break;case Le.IN_FBMSG:Ye.fbmsg.apply(this,r.slice(1));break;case Le.IN_TRANSFORM:var n=g(r.body_id);n&&$e(n,r.time,r.trans,r.quat,r.linvel,r.angvel);break;case Le.IN_PROP_OFFSET:var o=g(r.chassis_hull_body_id);o&&R(o,r.prop_ind,r.trans,r.quat);break;case Le.IN_FLOATER_BOB_TRANSFORM:var i=g(r[1]);i&&I(i,r[2],r[3],r[4]);break;case Le.IN_VEHICLE_SPEED:var n=g(r[1]);n&&(n.vehicle.speed=r[2]);break;case Le.IN_COLLISION:var a=O(e);b(a,r.body_id_a,r.body_id_b,r.result,null,null,0);break;case Le.IN_COLLISION_POS_NORM:var a=O(e);b(a,r.body_id_a,r.body_id_b,r.result,r.coll_point,r.coll_norm,r.coll_dist);break;case Le.IN_COLLISION_IMPULSE:var n=g(r[1]);if(n){var s=n.physics;s.col_imp_test_cb&&s.col_imp_test_cb(r[2])}break;case Le.IN_RAY_HIT:case Le.IN_RAY_HIT_POS_NORM:var a=O(e),c=a._physics,E=c.ray_tests[r.id];if(E){var l=r.body_id_hit,T=g(l);t==Le.IN_RAY_HIT?M(E,r.hit_fract,T,r.hit_time,null,null):M(E,r.hit_fract,T,r.hit_time,r.hit_pos,r.hit_norm)}break;case Le.IN_REMOVE_RAY_TEST:pe(r.id);break;case Le.IN_PING:var u=Be.indexOf(e),d=(r[2]-r[1]).toFixed(3),f=(performance.now()-r[2]).toFixed(3),P=(performance.now()-r[1]).toFixed(3);ye.log("Physics #"+u+" Ping: OUT "+d+" ms, IN "+f+" ms, ALL "+P+" ms");break;case Le.IN_FPS:Ke=r[1];break;case Le.IN_DEBUG_STATS:var u=Be.indexOf(e);ye.log("Worker: #"+String(u)),ye.log(r[1]);break;default:ye.error("Wrong message: "+t)}}function O(e){for(var t=0;t<Be.length;t++)if(Be[t]==e)return Xe[t]}function N(e){for(var t=0;t<Xe.length;t++)if(Xe[t]==e)return Be[t]}function g(e){return je[e]||null}function h(e){for(var t in je)if(je[t]===e)return t;return-1}function R(e,t,r,a){var _=e.vehicle.prop_offsets[t];f.t(r,1,a,_)}function I(e,t,r,a){var _=e.floater.bobs[t];we.set_translation(_,r),we.set_rotation(_,a),we.update_transform(_)}function b(e,t,r,a,_,n,o){for(var i=e._physics.bundles,s=0;s<i.length;s++)for(var c=i[s].physics,E=0;E<c.collision_tests.length;E++){for(var l=c.collision_tests[E],T=l.pairs,u=!1,d=0;d<T.length;d++){var f=T[d];if(f[0]===t&&f[1]===r){l.pair_results[d]=a,u=!0;break}}if(u){var P=Y(l);if(_&&l.body_id_src!=t&&L(_,n,o),P)if(l.body_id_src==t)var A=g(r);else var A=g(t);else var A=null;l.callback(P,A,_,n,o)}}}function Y(e){for(var t=e.pair_results,r=!1,a=0;a<t.length;a++)r=r||t[a];return r}function L(e,t,r){e[0]=e[0]+t[0]*r,e[1]=e[1]+t[1]*r,e[2]=e[2]+t[2]*r,t[0]*=-1,t[1]*=-1,t[2]*=-1}function M(e,t,r,a,_,n){var o=e.callback;_?o(e.id,t,r,a,_,n):o(e.id,t,r,a)}function y(e,t,r){e&&Le.is_fallback(e)&&Le.post_msg(e,Le.OUT_UPDATE_WORLD,t,r);for(var a=0;a<He.length;a++){var _=He[a],n=_.physics;if(n.simulated&&n.curr_time){if(Le.is_fallback(e))var o=t-n.curr_time;else var o=performance.now()/1e3-n.curr_time;o=Math.min(o,10/Fe.max_fps),o-=1/Fe.max_fps,Ge.no_phy_interp_hack&&(o=0);var i=We;f.n(n.curr_tsr,o,n.linvel,n.angvel,We),we.set_tsr(_,i),we.update_transform(_),_e(_),_.vehicle&&x(_),_.vehicle&&_.vehicle.steering_wheel&&st(_),_.vehicle&&_.vehicle.speedometer&&ct(_),_.vehicle&&_.vehicle.tachometer&&Et(_)}}Le.post_msg_arr(e)}function x(e){for(var t=e.vehicle.props,r=e.render.world_tsr,a=We,_=0;_<t.length;_++){var n=t[_],o=e.vehicle.prop_offsets[_];f.q(r,o,a),we.set_tsr(n,a),we.update_transform(n)}}function U(){return++ze.body}function w(e,t,r){var a=t._render.water_params;if(Le.post_msg(r,Le.OUT_APPEND_WATER,a.water_level),e.water_dynamics){var _={};_.dst_noise_scale0=e.dst_noise_scale0,_.dst_noise_scale1=e.dst_noise_scale1,_.dst_noise_freq0=e.dst_noise_freq0,_.dst_noise_freq1=e.dst_noise_freq1,_.dir_min_shore_fac=e.dir_min_shore_fac,_.dir_freq=e.dir_freq,_.dir_noise_scale=e.dir_noise_scale,_.dir_noise_freq=e.dir_noise_freq,_.dir_min_noise_fac=e.dir_min_noise_fac,_.dst_min_fac=e.dst_min_fac,_.waves_hor_fac=e.waves_hor_fac;var n=a.waves_height,o=a.waves_length;if(a.shoremap_image){var i=a.shoremap_size[0],s=a.shoremap_size[1],c=a.shoremap_center[0],E=a.shoremap_center[1],l=a.max_shore_dist,T=a.shoremap_tex_size;Le.post_msg(r,Le.OUT_ADD_WATER_WRAPPER,_,i,s,c,E,l,n,o,T,t._render.shore_distances)}else Le.post_msg(r,Le.OUT_ADD_WATER_WRAPPER,_,0,0,0,0,0,n,o,0,null)}}function C(e,t,r){if(r)var a=e.physics.body_id;else var a=U();var _=t.submesh;return{body_id:a,submesh:_,positions:_.va_frames[0].a_position,indices:_.indices||null,trans:f.j(e.render.world_tsr,qe),friction:t.friction,restitution:t.elasticity,collision_id:t.collision_id,collision_id_num:G(t.collision_id),collision_margin:t.collision_margin,collision_group:t.collision_group,collision_mask:t.collision_mask}}function D(e,t,r){var a=C(e,t);Le.post_msg(r,Le.OUT_APPEND_STATIC_MESH_BODY,a.body_id,a.positions,a.indices,a.trans,a.friction,a.restitution,a.collision_id_num,a.collision_margin,a.collision_group,a.collision_mask);var _=k(a.body_id,"STATIC_MESH");return _.collision_id=a.collision_id,_.collision_id_num=a.collision_id_num,_}function F(e,t,r){var a=C(e,t,!0);Le.post_msg(r,Le.OUT_UPDATE_STATIC_MESH_BODY,a.body_id,a.positions,a.indices,a.trans,a.friction,a.restitution,a.collision_id_num,a.collision_margin,a.collision_group,a.collision_mask)}function G(e){var t=Qe.indexOf(e);return-1==t?(Qe.push(e),Qe.length-1):t}function k(e,t){return{body_id:e,type:t,mass:0,is_ghost:!1,simulated:!0,is_vehicle:!1,is_character:!1,is_floater:!1,cons_id:null,collision_id:"",collision_id_num:0,collision_callbacks:{},collision_tests:[],col_imp_test_cb:null,curr_time:0,curr_tsr:f.b(),linvel:new Float32Array(3),angvel:new Float32Array(3),cached_trans:new Float32Array(3),cached_quat:new Float32Array(4),navmesh:null}}function K(e,t,r){var a=tt(e,t,!1);Le.post_msg(r,Le.OUT_APPEND_BOUNDING_BODY,a.body_id,a.trans,a.quat,a.physics_type,a.is_ghost,a.disable_sleeping,a.mass,a.velocity_min,a.velocity_max,a.damping,a.rotation_damping,a.collision_id_num,a.collision_margin,a.collision_group,a.collision_mask,a.bounding_type,a.worker_bounding,a.size,a.friction,a.restitution,a.comp_children_params,a.correct_bound_offset),je[a.body_id]=e,He.push(e);var _=k(a.body_id,"BOUNDING");return _.type=a.physics_type,_.mass=a.mass,_.is_ghost=a.is_ghost,_.collision_id=a.collision_id,_.collision_id_num=a.collision_id_num,_}function B(e,t,r){var a=tt(e,t,!0);Le.post_msg(r,Le.OUT_UPDATE_BOUNDING_BODY,a.body_id,a.trans,a.quat,a.physics_type,a.is_ghost,a.disable_sleeping,a.mass,a.velocity_min,a.velocity_max,a.damping,a.rotation_damping,a.collision_id_num,a.collision_margin,a.collision_group,a.collision_mask,a.bounding_type,a.worker_bounding,a.size,a.friction,a.restitution,a.comp_children_params,a.correct_bound_offset)}function X(e,t){var r=U(),a=k(r,"NAVMESH"),_=Me.get_scene_data(e,t),n=_.batches;a.navmesh=null;for(var o=0;o<n.length;o++){var i=n[o];if("PHYSICS"==i.type){a.navmesh=Ce.navmesh_build_from_bufs_data(i.bufs_data);break}}return a}function j(e,t){switch(e){case"BOX":var r=t.bb_local;break;case"CYLINDER":var r=t.bcyl_local;break;case"CONE":var r=t.bcon_local;break;case"SPHERE":var r=t.bs_local;break;case"CAPSULE":var r=t.bcap_local}return r}function H(e,t,r){switch(t){case"BOX":e.min_x*=r[0],e.max_x*=r[0],e.min_y*=r[1],e.max_y*=r[1],e.min_z*=r[2],e.max_z*=r[2];break;case"CYLINDER":case"CONE":case"CAPSULE":e.height*=r[2],e.radius*=Math.max(r[0],r[1]);break;case"SPHERE":e.radius*=Math.max(r[0],r[1])}}function Q(e){if(!e)return null;var t=e,r={};return"number"===typeof t.min_x&&(r.min_x=t.min_x),"number"===typeof t.min_y&&(r.min_y=t.min_y),"number"===typeof t.min_z&&(r.min_z=t.min_z),"number"===typeof t.max_x&&(r.max_x=t.max_x),"number"===typeof t.max_y&&(r.max_y=t.max_y),"number"===typeof t.max_z&&(r.max_z=t.max_z),"object"===typeof t.center&&(r.center=t.center),"number"===typeof t.radius&&(r.radius=t.radius),"number"===typeof t.height&&(r.height=t.height),r}function z(e,t){var r=e.physics.body_id;if(Ne(e)){e.vehicle.type=Je;var a=e.vehicle.suspension_compression,_=e.vehicle.suspension_stiffness,n=e.vehicle.suspension_damping,o=e.vehicle.wheel_friction,i=e.vehicle.max_suspension_travel_cm;Le.post_msg(t,Le.OUT_APPEND_CAR,r,a,_,n,o,i)}else if(ge(e)){e.vehicle.type=Ze;var s=e.vehicle.floating_factor,c=e.vehicle.water_lin_damp,E=e.vehicle.water_rot_damp;Le.post_msg(t,Le.OUT_APPEND_BOAT,r,s,c,E)}if(e.vehicle.props){var l=e.vehicle.props;switch(e.vehicle.type){case Je:at(l[0],e,r,!0,t),at(l[1],e,r,!0,t),at(l[2],e,r,!1,t),at(l[3],e,r,!1,t);break;case Ze:for(var T=0;T<l.length;T++)at(l[T],e,r,!1,t)}}}function q(e,t){var r=e.render,a=e.physics,_=r.bb_local.max_z-r.bb_local.min_z,n=a.body_id,o=e.character_settings,i=o.walk_speed,s=o.run_speed,c=o.step_height,E=o.jump_strength,l=o.waterline,T=_t(e);Le.post_msg(t,Le.OUT_APPEND_CHARACTER,n,T,_,i,s,c,E,l),a.is_character=!0}function V(e){return Boolean(e._physics)}function W(e){return Boolean(e.physics)}function J(e){return e.physics&&e.physics.cons_id}function Z(e){return new Float32Array([e.pivot_x,e.pivot_y,e.pivot_z])}function $(e){var t=new Float32Array([e.axis_x,e.axis_y,e.axis_z]);return P.Y(t,new Float32Array(4))}function ee(e){var t={};return t.use_limit_x=e.use_limit_x,t.use_limit_y=e.use_limit_y,t.use_limit_z=e.use_limit_z,t.use_angular_limit_x=e.use_angular_limit_x,t.use_angular_limit_y=e.use_angular_limit_y,t.use_angular_limit_z=e.use_angular_limit_z,t.limit_max_x=e.limit_max_x,t.limit_min_x=e.limit_min_x,t.limit_max_y=e.limit_max_y,t.limit_min_y=e.limit_min_y,t.limit_max_z=e.limit_max_z,t.limit_min_z=e.limit_min_z,t.limit_angle_max_x=e.limit_angle_max_x,t.limit_angle_min_x=e.limit_angle_min_x,t.limit_angle_max_y=e.limit_angle_max_y,t.limit_angle_min_y=e.limit_angle_min_y,t.limit_angle_max_z=e.limit_angle_max_z,t.limit_angle_min_z=e.limit_angle_min_z,t}function te(e,t,r,a,_,n,o,i,s,c){var E=ae(),l=t.physics.body_id,T=_.physics.body_id,u=re(l);Le.post_msg(u,Le.OUT_APPEND_CONSTRAINT,E,e,i,l,r,a,T,n,o,s,c),t.physics.cons_id=E}function re(e){for(var t=0;t<Xe.length;t++)for(var r=Xe[t],a=r._physics.bundles,_=0;_<a.length;_++){var n=a[_].physics;if(n.body_id==e)return Be[t]}return null}function ae(){return ze.constraint++,ze.constraint.toString(16)}function _e(e){if(ie(e)&&se(e)){var t=e.physics,r=e.render,a=Le.get_msg_cache(Le.OUT_SET_TRANSFORM);a.body_id=t.body_id;var _=f.j(r.world_tsr,a.trans),n=f.g(r.world_tsr,a.quat);A.copy(_,t.cached_trans),l.copy(n,t.cached_quat),"DYNAMIC"==t.type&&l.identity(a.quat);var o=re(t.body_id);Le.post_msg(o,Le.OUT_SET_TRANSFORM)}for(var i=e.cons_descends,s=0;s<i.length;s++)_e(i[s])}function ne(e,t){var a=e.physics_settings,_=N(t),n=[];a.use_collision_compound&&r(e,n),(Ne(e)||ge(e)||e.is_character||Re(e)||e.use_obj_physics)&&(he(e)||B(e,n,_))}function oe(e,t){for(var r=(e.physics_settings,N(t)),_=e.scenes_data[0],n=_.batches,o=0;o<n.length;o++){var i=n[o];"PHYSICS"==i.type&&(De.update_batch_geometry(n[o],n[o].submesh,e.render.shape_keys_values),i.use_ghost?ye.error("The function is not implemented for ghost objects yet"):F(e,i,r),a(t,r,e.physics.collision_id))}}function ie(e){var t=e.physics;return!!t&&(0===t.mass||(!0===t.is_ghost||(!1===t.simulated||"RIGID_BODY"!==t.type&&"DYNAMIC"!==t.type)))}function se(e){var t=f.j(e.render.world_tsr,qe),r=f.g(e.render.world_tsr,Ve);return t[0]!=e.physics.cached_trans[0]||t[1]!=e.physics.cached_trans[1]||t[2]!=e.physics.cached_trans[2]||r[0]!=e.physics.cached_quat[0]||r[1]!=e.physics.cached_quat[1]||r[2]!=e.physics.cached_quat[2]||r[3]!=e.physics.cached_quat[3]}function ce(e,t,r,a,_){var n=qe;_?(n[0]=t,n[1]=r,n[2]=a):it(e,t,r,a,n);var o=e.physics.body_id,i=re(o);Le.post_msg(i,Le.OUT_APPLY_CENTRAL_FORCE,o,n[0],n[1],n[2])}function Ee(e,t,r,a){var _=qe;it(e,t,r,a,_);var n=e.physics.body_id,o=re(n);Le.post_msg(o,Le.OUT_APPLY_TORQUE,n,_[0],_[1],_[2])}function le(e,t,r){var a=e.pairs,_=e.pair_results,n=e.body_id_src,o=[];Se(e.collision_id,t,o,null);for(var i=0;i<o.length;i++){var s=o[i];n<s&&!Te(a,n,s)?(a.push([n,s]),_.push(!1)):n>s&&!Te(a,s,n)&&(a.push([s,n]),_.push(!1))}Le.post_msg(r,Le.OUT_ACTIVATE,n),Le.post_msg(r,Le.OUT_APPEND_COLLISION_TEST,a,e.calc_pos_norm)}function Te(e,t,r){for(var a=0;a<e.length;a++)if(e[a][0]==t&&e[a][1]==r)return!0;return!1}function ue(e,t,r){for(var a=e._physics.bundles,_=r,n=0;n<a.length;n++)for(var o=a[n].physics,i=0;i<o.collision_tests.length;i++)for(var s=o.collision_tests[i],c=0;c<s.pairs.length;c++)for(var E=s.pairs[c],l=0;l<_.length;l++){var T=_[l];E[0]==T[0]&&E[1]==T[1]&&(_.splice(l,1),l--)}_.length&&Le.post_msg(t,Le.OUT_REMOVE_COLLISION_TEST,_)}function de(e,t,r){for(var a=e._physics.bundles,_=[],n=0;n<a.length;n++)for(var o=a[n].physics,i=0;i<o.collision_tests.length;i++)for(var s=o.collision_tests[i],c=0;c<s.pairs.length;c++){var E=s.pairs[c],l=s.pair_results[c];if(E[0]==r||E[1]==r){if(s.pairs.splice(c,1),s.pair_results.splice(c,1),c--,l&&!Y(s)){var T=A.set(0,0,0,qe);s.callback(!1,null,T,T,0)}_.push(E)}}_.length&&Le.post_msg(t,Le.OUT_REMOVE_COLLISION_TEST,_)}function fe(e){if(Pe(e)){var t=e.physics,r=re(t.body_id);Le.post_msg(r,Le.OUT_CLEAR_COLLISION_IMPULSE_TEST,t.body_id),t.col_imp_test_cb=null}}function Pe(e){return!(!e.physics||!e.physics.col_imp_test_cb)}function Ae(){return++ze.ray_test}function Se(e,t,r,a){r||a||Ie.panic("At least one destination required");for(var _=0;_<t._physics.bundles.length;_++){var n=t._physics.bundles[_];if("ANY"==e||n.physics.collision_id==e&&"NAVMESH"!=n.physics.type){var o=n.physics.body_id;r&&-1==r.indexOf(o)&&r.push(o),a&&(a[o]=0)}}}function pe(e){var t=ve(e),r=me(e),a=t._physics;a.ray_tests[e]&&(delete a.ray_tests[e],a.ray_tests_arr.splice(a.ray_tests_arr.indexOf,1),Le.post_msg(r,Le.OUT_REMOVE_RAY_TEST,e))}function ve(e){for(var t=0;t<Xe.length;t++){var r=Xe[t];if(r._physics.ray_tests[e])return r}return null}function me(e){for(var t=0;t<Xe.length;t++){if(Xe[t]._physics.ray_tests[e])return Be[t]}return null}function Oe(e,t,r){if(t.steering_wheel){var a=e.physics.body_id,_=t.engine_force*t.force_max,n=t.brake_force*t.brake_max,o=-t.steering*t.steering_max*2*Math.PI/t.steering_ratio;switch(t.inverse_control&&(o*=-1),t.type){case Je:Le.post_msg(r,Le.OUT_UPDATE_CAR_CONTROLS,a,_,n,o);break;case Ze:Le.post_msg(r,Le.OUT_UPDATE_BOAT_CONTROLS,a,_,n,o)}}}function Ne(e){return e.is_vehicle&&"CHASSIS"==e.vehicle_settings.part}function ge(e){return e.is_vehicle&&"HULL"==e.vehicle_settings.part}function he(e){return"NAVMESH"==e.physics_settings.physics_type}function Re(e){return e.is_floating&&"MAIN_BODY"==e.floating_settings.part}var Ie=Object(n.a)(e),be=Object(o.a)(e),Ye=Object(i.a)(e),Le=Object(s.a)(e),Me=Object(c.a)(e),ye=Object(E.a)(e),xe=Object(T.a)(e),Ue=Object(u.a)(e),we=Object(d.a)(e),Ce=Object(p.a)(e),De=Object(v.a)(e),Fe=be.physics,Ge=be.defaults,ke=be.assets,Ke=0,Be=[],Xe=[],je={},He=[],Qe=["ANY"],ze={body:0,constraint:0,ray_test:0},qe=new Float32Array(3),Ve=(new Float32Array(3),new Float32Array(4)),We=f.b(),Je=(f.b(),10),Ze=20;t.init_scene_physics=function(e){e._physics={worker_loaded:!1,bundles:[],ray_tests:{},ray_tests_arr:[]};var t=Fe.uranium_path;ke.prevent_caching&&(t+="?v="+Object(S.c)()),ye.log("%cLOAD PHYSICS","color: #0a0",Fe.use_workers?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+Fe.max_fps),ye.log("%cPHYSICS PATH","color: #0a0",t);var r=Le.create_worker(t,!Fe.use_workers);Le.attach_handler(r,m),Be.push(r),Xe.push(e),Fe.ping&&setInterval(function(){Le.post_msg(r,Le.OUT_PING,performance.now())},1e3)},t.check_worker_loaded=function(e){return!e._physics||e._physics.worker_loaded},t.cleanup=function(){for(var e=0;e<Be.length;e++)Le.terminate(Be[e]);Be.length=0,Xe.length=0,je={},He.length=0,Qe=["ANY"];for(var t in ze)ze[t]=0},t.append_object=function(e,t){if(V(t)){var n=e.physics_settings,o=N(t),i=[];n.use_collision_compound&&r(e,i);var s=t._physics.bundles;if(Ne(e)||ge(e)||e.is_character||Re(e)||e.use_obj_physics){var c=he(e);if(c)var E=X(e,t);else var E=K(e,i,o);e.physics=E;var l={batch:null,physics:E};c||(s.push(l),a(t,o,E.collision_id))}else for(var T=Me.get_scene_data(e,t),u=T.batches,d=0;d<u.length;d++){var f=u[d];if("PHYSICS"==f.type&&!_(t,f))if(f.submesh.base_length)if(f.water&&t._render.water_params)w(f,t,o);else{if(f.use_ghost)var E=et(e,f,o);else var E=D(e,f,o);e.physics=E;var l={batch:f,physics:E};s.push(l),a(t,o,E.collision_id)}else ye.error("Object "+e.name+" has collision material with no assigned vertices")}Ne(e)||ge(e)?(z(e,o),Oe(e,e.vehicle,o)):e.is_character?q(e,o):Re(e)&&nt(e,o);for(var d=0;d<He.length;d++){var P=He[d];P.physics&&ot(P)}}},t.find_obj_by_body_id=g;var $e=function(){var e=A.create();return function(t,r,a,_,n,o){var i=t.physics;i.curr_time=r;var s=f.i(t.render.world_tsr,e);f.t(a,s,_,i.curr_tsr),A.copy(n,i.linvel),A.copy(o,i.angvel)}}();t.update=function(e,t){for(var r=0;r<Be.length;r++){y(Be[r],e,t);var a=Xe[r],_=a._render.water_params;if(_&&_.waves_height>0){var n=xe.get_subs(a,Ue.MAIN_OPAQUE),o=A.length(n.wind)||1;Le.post_msg(Be[r],Le.OUT_SET_WATER_TIME,n.time*o)}}},t.get_active_scene=function(){return Xe[0]},t.pause=function(){for(var e=0;e<Be.length;e++)Le.post_msg(Be[e],Le.OUT_PAUSE)},t.resume=function(){for(var e=0;e<Be.length;e++)Le.post_msg(Be[e],Le.OUT_RESUME)};var et=function(){var e=A.create();return function(t,r,a){var _=U(),n=r.submesh,o=n.va_frames[0].a_position,i=n.indices||null,s=r.collision_id,c=G(s),E=r.collision_margin,l=r.collision_group,T=r.collision_mask,u=f.j(t.render.world_tsr,e);Le.post_msg(a,Le.OUT_APPEND_GHOST_MESH_BODY,_,o,i,u,c,E,l,T);var d=k(_,"STATIC_MESH");return d.is_ghost=!0,d.collision_id=s,d.collision_id_num=c,d}}(),tt=function(){var e=l.create(),t=A.create();return function(r,a,_){var n=r.render,o=r.physics_settings,i=o.physics_type;if(_)var s=h(r);else var s=U();if(!(s<=0)){if("CAMERA"==r.type)var c=o.use_collision_bounds?o.collision_bounds_type:"BOX",E=j(c,n),l=.5,T=0;else if("EMPTY"==r.type)var c="EMPTY",E=null,l=0,T=0;else{var c=o.use_collision_bounds?o.collision_bounds_type:"BOX",E=j(c,n),u=f.i(n.world_tsr,t);1==u[0]&&1==u[1]&&1==u[2]||H(E,c,u);var l=n.friction,T=n.elasticity}var d=Q(E);return{body_id:s,trans:f.j(n.world_tsr,t),quat:f.g(n.world_tsr,e),is_ghost:o.use_ghost,disable_sleeping:o.use_sleep,mass:o.mass,velocity_min:o.velocity_min,velocity_max:o.velocity_max,damping:o.damping,rotation_damping:o.rotation_damping,collision_id:r.collision_id,collision_id_num:G(r.collision_id),collision_margin:o.collision_margin,collision_group:o.collision_group,collision_mask:o.collision_mask,size:n.bs_local.radius,worker_bounding:d,correct_bound_offset:r.correct_bounding_offset,restitution:T,friction:l,bounding_type:c,physics_type:i,comp_children_params:rt(n,a,c,d)}}}}(),rt=function(){var e=l.create(),t=l.create(),r=f.b(),a=A.create();return function(_,n,o,i){if(!n.length)return[];var s=[],c={};c.quat=new Float32Array([0,0,0,1]),c.trans=new Float32Array(3),c.worker_bounding=i,c.bounding_type=o,s.push(c);for(var E=f.p(_.world_tsr,r),T=f.g(_.world_tsr,e),u=l.invert(T,e),d=0;d<n.length;d++){var P={},A=n[d],S=A.physics_settings.collision_bounds_type,p=new Float32Array(4),v=new Float32Array(3),m=f.j(A.render.world_tsr,a),O=f.g(A.render.world_tsr,t);f.D(m,E,v),l.multiply(u,O,p),P.trans=v,P.quat=p,P.bounding_type=S,P.worker_bounding=Q(j(S,A.render)),s.push(P)}return s}}(),at=function(){var e=f.b(),t=A.create();return function(r,a,_,n,o){var i=f.j(r.render.world_tsr,t),s=f.p(a.render.world_tsr,e),c=new Float32Array(3);switch(f.D(i,s,c),a.vehicle.type){case Je:var E=a.vehicle_settings,l=E.suspension_rest_length,T=E.roll_influence,u=r.render.bb_local,d=(u.max_z-u.min_z)/2;Le.post_msg(o,Le.OUT_ADD_CAR_WHEEL,_,c,l,T,d,n);break;case Ze:Le.post_msg(o,Le.OUT_ADD_BOAT_BOB,_,c,r.bob_synchronize_pos)}}}(),_t=function(){var e=l.create(),t=A.create(),r=A.create();return function(a){var _=a.render,n=f.g(_.world_tsr,e),o=t,i=r;switch(a.type){case"CAMERA":o[0]=0,o[1]=-1,o[2]=0,A.transformQuat(o,n,o),i[0]=0,i[1]=0,i[2]=-1;break;case"MESH":o[0]=0,o[1]=0,o[2]=1,A.transformQuat(o,n,o),i[0]=0,i[1]=0,i[2]=1;break;case"EMPTY":o[0]=0,o[1]=1,o[2]=0,A.transformQuat(o,n,o),i[0]=0,i[1]=1,i[2]=0}o[1]=0,A.normalize(o,o);var s=A.dot(o,i),c=-o[0]*i[2]>0?-1:1;return Math.acos(s)*c}}(),nt=function(){var e=A.create(),t=f.b();return function(r,a){var _=r.floater.floating_factor,n=r.floater.water_lin_damp,o=r.floater.water_rot_damp,i=r.physics.body_id;if(Le.post_msg(a,Le.OUT_APPEND_FLOATER,i,_,n,o),r.floater.bobs)for(var s=r.floater.bobs,c=0;c<s.length;c++){var E=s[c],l=f.j(E.render.world_tsr,e),T=f.p(r.render.world_tsr,t),u=new Float32Array(3);f.D(l,T,u),Le.post_msg(a,Le.OUT_ADD_FLOATER_BOB,i,u,E.bob_synchronize_pos)}r.physics.is_floater=!0}}();t.enable_simulation=function(e){var t=e.physics;if(t||Ie.panic("No object physics"),!t.simulated){var r=t.body_id,a=re(r);t.simulated=!0,Le.post_msg(a,Le.OUT_ENABLE_SIMULATION,r)}},t.disable_simulation=function(e){var t=e.physics;if(t||Ie.panic("No object physics"),t.simulated){var r=t.body_id,a=re(r);t.simulated=!1,Le.post_msg(a,Le.OUT_DISABLE_SIMULATION,r)}},t.scene_has_physics=V,t.obj_has_physics=W,t.has_dynamic_physics=function(e){var t=e.physics;return!!(t&&t.simulated&&("RIGID_BODY"==t.type||"DYNAMIC"==t.type)&&t.mass>0&&0==t.is_ghost)},t.has_simulated_physics=function(e){var t=e.physics;return!(!t||!t.simulated)},t.set_gravity=function(e,t,r,a){var _=e.physics.body_id,n=re(_);Le.post_msg(n,Le.OUT_SET_GRAVITY,_,t,r,a)};var ot=function(){var e=l.create(),t=f.b(),r=f.b(),a=A.create();return function(_){if(!J(_))for(var n=0;n<_.physics_constraints.length;n++){var o=_.physics_constraints[n],i=o.target,s=o.pivot_type;if(i.physics){var c=Z(o),E=$(o);"HINGE"==s&&l.rotateY(E,Math.PI/2,E);var T=f.m(t);T=f.v(c,T),T=f.r(E,T);var u=f.q(_.render.world_tsr,T,t),d=f.p(i.render.world_tsr,r),P=f.q(d,u,d),A=f.j(P,a),S=f.g(P,e),p=ee(o);te(s,_,c,E,i,A,S,p,null,null)}}}}();t.has_constraint=J,t.apply_constraint=te,t.clear_constraint=function(e){var t=e.physics,r=t.cons_id,a=re(t.body_id);Le.post_msg(a,Le.OUT_REMOVE_CONSTRAINT,r),t.cons_id=null},t.pull_to_constraint_pivot=function(){var e=l.create(),r=f.b(),a=f.b(),_=f.b();return function(n,o,i,s,c,E){var l=f.t(o,1,i,r),T=f.t(c,1,E,a);f.p(l,l),f.q(T,l,l),we.get_tsr(s,T),f.q(T,l,l),we.set_tsr(n,l),we.update_transform(n);var u=f.j(n.render.world_tsr,_),d=f.g(n.render.world_tsr,e);t.set_transform(n,u,d)}}(),t.set_transform=function(e,t,r){var a=e.physics,_=Le.get_msg_cache(Le.OUT_SET_TRANSFORM),n=f.j(e.render.world_tsr,_.trans),o=f.g(e.render.world_tsr,_.quat);f.t(n,1,o,a.curr_tsr),_.body_id=a.body_id,A.copy(t,_.trans),l.copy(r,_.quat);var i=re(a.body_id);Le.post_msg(i,Le.OUT_SET_TRANSFORM)},t.sync_transform=_e,t.sync_bounding=ne,t.sync_mesh=oe,t.apply_velocity=function(e,t,r,a){var _=qe;it(e,t,r,a,_);var n=e.physics.body_id,o=Math.abs(0),i=Math.abs(0),s=Math.abs(0),c=Math.abs(_[0]),E=Math.abs(_[1]),l=Math.abs(_[2]);_[0]=c?_[0]/c*Math.max(c,o):0,_[1]=E?_[1]/E*Math.max(E,i):0,_[2]=l?_[2]/l*Math.max(l,s):0;var T=re(n);Le.post_msg(T,Le.OUT_SET_LINEAR_VELOCITY,n,_[0],_[1],_[2])},t.apply_velocity_world=function(e,t,r,a){var _=e.physics.body_id,n=re(_);Le.post_msg(n,Le.OUT_SET_LINEAR_VELOCITY,_,t,r,a)};var it=function(){var e=l.create();return function(t,r,a,_,n){var o=n||new Float32Array(3),i=f.g(t.render.world_tsr,e);return o[0]=r,o[1]=a,o[2]=_,A.transformQuat(o,i,o)}}();t.apply_force=ce,t.apply_torque=Ee,t.set_angular_velocity=function(e,t,r,a){var _=e.physics.body_id,n=re(_);Le.post_msg(n,Le.OUT_SET_ANGULAR_VELOCITY,_,t,r,a)},t.set_character_move_dir=function(e,t,r){var a=e.physics.body_id,_=re(a);Le.post_msg(_,Le.OUT_SET_CHARACTER_MOVE_DIR,a,t,r)},t.set_character_move_type=function(e,t){var r=e.physics.body_id,a=re(r);Le.post_msg(a,Le.OUT_SET_CHARACTER_MOVE_TYPE,r,t)},t.set_character_walk_velocity=function(e,t){var r=e.physics.body_id,a=re(r);Le.post_msg(a,Le.OUT_SET_CHARACTER_WALK_VELOCITY,r,t)},t.set_character_run_velocity=function(e,t){var r=e.physics.body_id,a=re(r);Le.post_msg(a,Le.OUT_SET_CHARACTER_RUN_VELOCITY,r,t)},t.set_character_fly_velocity=function(e,t){var r=e.physics.body_id,a=re(r);Le.post_msg(a,Le.OUT_SET_CHARACTER_FLY_VELOCITY,r,t)},t.character_jump=function(e){var t=e.physics.body_id,r=re(t);Le.post_msg(r,Le.OUT_CHARACTER_JUMP,t)},t.character_rotation_inc=function(e,t,r){var a=e.physics.body_id,_=re(a);Le.post_msg(_,Le.OUT_CHARACTER_ROTATION_INCREMENT,a,t,r)},t.set_character_rotation=function(e,t,r){var a=e.physics.body_id,_=re(a);Le.post_msg(_,Le.OUT_SET_CHARACTER_ROTATION,a,t,r)},t.set_character_rotation_h=function(e,t){var r=e.physics.body_id,a=re(r);Le.post_msg(a,Le.OUT_SET_CHARACTER_HOR_ROTATION,r,t)},t.set_character_rotation_v=function(e,t){var r=e.physics.body_id,a=re(r);Le.post_msg(a,Le.OUT_SET_CHARACTER_VERT_ROTATION,r,t)},t.set_character_vert_move_dir_angle=function(e,t){var r=e.physics.body_id,a=re(r);Le.post_msg(a,Le.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE,r,t)},t.append_collision_test=function(e,t,r,a){var _=e.physics;if(!_.navmesh){for(var n=_.body_id,o=0;o<_.collision_tests.length;o++){var i=_.collision_tests[o];if(i.collision_id==t&&i.callback==r)return}var i={body_id_src:n,calc_pos_norm:a||!1,collision_id:t,callback:r,pairs:[],pair_results:[]};_.collision_tests.push(i);var s=re(n);le(i,O(s),s)}},t.remove_collision_test=function(e,t,r){for(var a=e.physics,_=a.body_id,n=re(_),o=O(n),i=0;i<a.collision_tests.length;i++){var s=a.collision_tests[i];if(s.collision_id==t&&s.callback==r){if(Y(s)){var c=A.set(0,0,0,qe);s.callback(!1,null,c,c,0)}a.collision_tests.splice(i,1),i--,ue(o,n,s.pairs)}}},t.apply_collision_impulse_test=function(e,t){Pe(e)&&fe(e);var r=e.physics,a=re(r.body_id);Le.post_msg(a,Le.OUT_APPLY_COLLISION_IMPULSE_TEST,r.body_id),r.col_imp_test_cb=t},t.clear_collision_impulse_test=fe,t.append_ray_test=function(e,t,r,a,_,n,o,i,s){var c=Ae(),E={id:c,body_id:e?e.physics.body_id:0,from:new Float32Array(t),to:new Float32Array(r),collision_id:a,collision_id_num:G(a),autoremove:n,calc_all_hits:o,calc_pos_norm:i,ign_src_rot:s,callback:_},l=re(E.body_id)||Be[0],T=O(l),u=T._physics;return u.ray_tests[c]=E,u.ray_tests_arr.push(E),Le.post_msg(l,Le.OUT_APPEND_RAY_TEST,E.id,E.body_id,E.from,E.to,E.collision_id_num,E.autoremove,E.calc_all_hits,E.calc_pos_norm,E.ign_src_rot),c},t.remove_ray_test=pe,t.change_ray_test_from_to=function(e,t,r){var a=ve(e),_=me(e),n=a._physics,o=n.ray_tests[e];o&&!o.autoremove&&(o.from.set(t),o.to.set(r),Le.post_msg(_,Le.OUT_CHANGE_RAY_TEST_FROM_TO,e,t,r))},t.is_ray_test=function(e){return!!ve(e)._physics.ray_tests[e]},t.vehicle_throttle=function(e,t){var r=e.vehicle;r.engine_force=t,Oe(e,r,re(e.physics.body_id))},t.vehicle_steer=function(e,t){var r=e.vehicle;r.steering=t,Oe(e,r,re(e.physics.body_id))},t.vehicle_brake=function(e,t){var r=e.vehicle;r.brake_force=t,Oe(e,r,re(e.physics.body_id))};var st=function(){var e=l.create(),t=l.create(),r=A.create();return function(a){var _=a.vehicle,n=_.steering_wheel;if(n){var o=a.vehicle.steering_wheel_tsr,i=a.vehicle.steering_wheel_axis;f.q(a.render.world_tsr,o,n.render.world_tsr);var s=f.y(i,a.render.world_tsr,r),c=l.setAxisAngle(s,-_.steering*_.steering_max*2*Math.PI,e),E=f.g(n.render.world_tsr,t);l.multiply(c,E,E),l.normalize(E,E),f.r(E,n.render.world_tsr),we.update_transform(n)}}}(),ct=function(){var e=l.create(),t=l.create(),r=A.create();return function(a){var _=a.vehicle,n=_.speedometer;if(n){var o=a.vehicle.speedometer_tsr,i=a.vehicle.speedometer_axis;f.q(a.render.world_tsr,o,n.render.world_tsr);var s=r;f.y(i,a.render.world_tsr,s);var c=Math.abs(_.speed)*_.speed_ratio;c>_.max_speed_angle&&(c=_.max_speed_angle);var E=l.setAxisAngle(s,-c,e),T=f.g(n.render.world_tsr,t);l.multiply(E,T,T),l.normalize(T,T),f.r(T,n.render.world_tsr),we.update_transform(n)}}}(),Et=function(){var e=l.create(),t=l.create(),r=A.create();return function(a){var _=a.vehicle,n=_.tachometer;if(n){var o=a.vehicle.tachometer_tsr,i=a.vehicle.tachometer_axis;f.q(a.render.world_tsr,o,n.render.world_tsr);var s=r;f.y(i,a.render.world_tsr,s);var c=e;l.setAxisAngle(s,-Math.abs(_.engine_force)*_.delta_tach_angle,c);var E=f.g(n.render.world_tsr,t);l.multiply(c,E,E),l.normalize(E,E),f.r(E,n.render.world_tsr),we.update_transform(n)}}}();t.is_vehicle_chassis=Ne,t.is_vehicle_hull=ge,t.is_navigation_mesh=he,t.is_car_wheel=function(e){if(!e.is_vehicle)return!1;var t=e.vehicle_settings.part;return"WHEEL_FRONT_LEFT"==t||"WHEEL_FRONT_RIGHT"==t||"WHEEL_BACK_LEFT"==t||"WHEEL_BACK_RIGHT"==t},t.is_boat_bob=function(e){return!!e.is_vehicle&&"BOB"==e.vehicle_settings.part},t.is_floater_bob=function(e){return!!e.is_floating&&"BOB"==e.floating_settings.part},t.is_vehicle_steering_wheel=function(e){return!(!e.is_vehicle||"STEERING_WHEEL"!=e.vehicle_settings.part)},t.is_vehicle_speedometer=function(e){return!(!e.is_vehicle||"SPEEDOMETER"!=e.vehicle_settings.part)},t.is_vehicle_tachometer=function(e){return!(!e.is_vehicle||"TACHOMETER"!=e.vehicle_settings.part)},t.get_vehicle_speed=function(e){return e.vehicle.speed},t.wheel_index=function(e){switch(e){case"WHEEL_FRONT_RIGHT":return 0;case"WHEEL_FRONT_LEFT":return 1;case"WHEEL_BACK_LEFT":return 2;case"WHEEL_BACK_RIGHT":return 3}},t.has_character_physics=function(e){return e.physics&&e.physics.is_character},t.is_floater_main=Re,t.get_fps=function(){return Ke},t.debug_workers=function(){for(var e=0;e<Be.length;e++){var t=Be[e];Le.post_msg(t,Le.OUT_DEBUG)}},t.remove_object=function(e){var t=e.physics.body_id;if("BOUNDING"==e.physics.type){var r=He.indexOf(e);-1==r&&ye.error("Object "+e.name+" doesn't have bounding physics"),delete je[t],He.splice(r,1)}var a=re(t),_=O(a);de(_,a,t),Pe(e)&&fe(e);for(var n=_._physics.bundles,o=0;o<n.length;o++){n[o].physics.body_id==t&&(n.splice(o,1),o--)}Le.post_msg(a,Le.OUT_REMOVE_BODY,t)},t.has_dynamic_settings=function(e){var t=e.physics_settings;return e.is_vehicle||e.is_floating||e.is_character||e.use_obj_physics&&!t.use_ghost&&t.mass>0&&("DYNAMIC"==t.physics_type||"RIGID_BODY"==t.physics_type)}}var _=r(0),n=r(5),o=r(4),i=r(67),s=r(114),c=r(9),E=r(1),l=r(8),T=r(10),u=r(11),d=r(13),f=r(6),P=r(2),A=r(3),S=r(40),p=r(80),v=r(16),m=Object(_.a)("__physics",a);t.a=m},function(e,t,r){"use strict";function a(e,t){function r(){return{length:0,frames:1,num_comp:0,offset:0,divisor:0}}function a(e,t,r){var a=t.a_tbn,_=t.a_position,n=_.length,o=e.shape_keys.length;if(r)for(var i=e.shape_keys[0].geometry.a_position,s=0;s<n;s++)_[s]=i[s];for(var c=1;c<o;c++)for(var E=e.shape_keys[c].geometry,T=r?r[c].value:e.shape_keys[c].init_value,i=E.a_position,s=0;s<n;s++)_[s]+=T*i[s];if(o=l.f(a),r)for(var u=e.shape_keys[0].geometry.a_tbn,c=0;c<o;c++)l.n(a,u,c);for(var c=0;c<o;c++){for(var d=l.i(we),s=1;s<e.shape_keys.length;s++){var u=e.shape_keys[s].geometry.a_tbn,T=r?r[s].value:e.shape_keys[s].init_value;if(T){var f=l.e(u,c,Ce),P=l.p(l.i(De),f,T,Ce);l.k(P,d,d)}}var A=l.e(a,c,Ce),S=l.k(d,A,Ce);l.n(a,S,c)}}function _(e){return e.base_length>Xe&&!ye.get_elem_index_uint()}function P(e){return e.indices.length>0}function A(e,t,r){if(!P(e))return e;t=t||1,r||Ue.log('%cDEBUG max vertices exceeded for indexed submesh "'+e.name+'": '+e.base_length*t+", will use drawArrays","color: #aa0");var a=e.indices,_=e.base_length,n=e.va_common,o=e.va_frames;for(var i in n){var s=n[i],c=z(s,_);n[i]=S(a,s,c)}for(var E=0;E<o.length;E++){var l=o[E];for(var i in l){var s=l[i],c=z(s,_);l[i]=S(a,s,c)}}for(var E=0;E<e.shape_keys.length;E++){var T=e.shape_keys[E].geometry;for(var u in T){var s=T[u],c=z(s,_);T[u]=S(a,s,c)}}return e.base_length=a.length,e.indices=new Uint16Array(0),e}function S(e,t,r){if(0==t.length)return new Float32Array(0);for(var a=e.length*r,_=new Float32Array(a),n=0;n<e.length;n++)for(var o=e[n],i=0;i<r;i++)_[r*n+i]=t[r*o+i];return _}function p(){return{ibo_array:null,vbo_source_data:Pe(),ibo_type:0,count:0,pointers:{},usage:0,debug_ibo_bytes:0,debug_vbo_bytes:0,vbo_data:[],ibo:null,shape_keys:null,instance_count:1,cleanup_gl_data_on_unload:!0}}function v(e,t,a,_){if("a_normal"==t){return v(e,"a_tbn",a,l.d(_))}var n=e.pointers,o=n[t],i=Ne(t);if(o)a&&o.num_comp!=a&&Me.panic('invalid num_comp for "'+t+'"'),Re(e.vbo_source_data,t,_,o.offset);else{var s=pe(e.vbo_source_data,i);-1==s&&(e.vbo_source_data.push(Ae(i,0)),s=e.vbo_source_data.length-1);var c=e.vbo_source_data[s].vbo_source,E=new c.constructor(c.length+_.length);E.set(c),e.vbo_source_data[s].vbo_source=E,Re(e.vbo_source_data,t,_,c.length);var T=n[t]=r();T.num_comp=a,T.offset=c.length,T.length=_.length}return h(e),e}function m(e,t){if("a_normal"==t){for(var r=m(e,"a_tbn"),a=l.f(r),_=new Float32Array(3*a),n=0;n<a;n++){var o=l.g(r,n,Fe);_.set(o,3*n)}return _}var i=e.pointers[t];if(i){var s=Ne(t);return Ye(t,me(e.vbo_source_data,s).subarray(i.offset,i.offset+i.length),new Float32Array(i.length))}Me.panic("extract_array_float() failed; invalid name: "+t)}function O(e,r){var a;switch(r){case t.DM_DEFAULT:case t.DM_TRIANGLES:a=Je.STATIC_DRAW;break;case t.DM_DYNAMIC_TRIANGLES:a=Je.DYNAMIC_DRAW;break;default:Me.panic("Wrong draw_mode")}e.usage=a}function N(e,t,a,_,n,o){if(t.length){var i=t.length;if(n<=Xe)var s=new Uint16Array(t),c=Je.UNSIGNED_SHORT;else var s=new Uint32Array(t),c=Je.UNSIGNED_INT}else var i=n,s=null;for(var E=g(a,_,o),l=Pe(E),T={},u=0;u<l.length;u++)T[l[u].type]=0;var d={};for(var f in _){var P=_[f],A=P.length;if(A){var S=Ne(f),p=d[f]=r();p.length=A,p.num_comp=z(P,n),p.offset=T[S],Re(l,f,P,T[S]),T[S]+=A}}var v=a.length;for(var f in a[0]){var m=a[0][f],S=Ne(f),A=m.length,O=z(m,n);if(A){var p=d[f]=r();p.length=A,p.frames=v,p.num_comp=O,p.offset=T[S],v>1&&(p=d[f+"_next"]=r(),p.length=A,p.frames=v,p.num_comp=O,p.offset=T[S]+A);for(var u=0;u<v;u++){var N=a[u],P=N[f];S=Ne(f),Re(l,f,P,T[S]),T[S]+=A}}}o&&(tt(o,d,l,T),e.instance_count=o.tsr_array.length),e.count=i,e.ibo_array=s,e.vbo_source_data=l,e.ibo_type=c,e.pointers=d}function g(e,t,r){var a={},_=function(e,t){a[e]||(a[e]=0),a[e]+=t};for(var n in e[0]){var o=e[0][n],i=Ne(n);_(i,o.length*e.length)}for(var n in t){var o=t[n],i=Ne(n);_(i,o.length)}if(r){var s=r.tsr_array.length,i=Ne("a_part_ts");_(i,4*s),i=Ne("a_part_r"),_(i,4*s);var c=r.part_inh_attrs;for(var n in c)i=Ne(n),_(i,c[n].num_comp*s);var E=r.submesh_params;for(var n in E)i=Ne(n),_(i,s)}return a}function h(e){e.ibo_array?(e.ibo||(e.ibo=Je.createBuffer()),Je.bindBuffer(Je.ELEMENT_ARRAY_BUFFER,e.ibo),Je.bufferData(Je.ELEMENT_ARRAY_BUFFER,e.ibo_array,e.usage),e.debug_ibo_bytes=e.ibo_array.byteLength):e.debug_ibo_bytes=0,e.debug_vbo_bytes=0;for(var t=0;t<e.vbo_source_data.length;t++){var r=e.vbo_source_data[t].type,a=pe(e.vbo_data,r);-1==a&&(e.vbo_data.push({vbo:null,type:r,debug_id:xe.unique_id()}),a=e.vbo_data.length-1);var _=e.vbo_data[a];_.vbo||(_.vbo=Je.createBuffer()),Je.bindBuffer(Je.ARRAY_BUFFER,_.vbo),Je.bufferData(Je.ARRAY_BUFFER,e.vbo_source_data[t].vbo_source,e.usage),e.debug_vbo_bytes+=e.vbo_source_data[t].vbo_source.byteLength}}function R(e,t,r,a){var _=pe(e.vbo_data,t),n=e.vbo_data[_];Je.bindBuffer(Je.ARRAY_BUFFER,n.vbo),Je.bufferSubData(Je.ARRAY_BUFFER,u.h*a,r)}function I(e,t){e.bb_local=o.h(e.bb_local,t),e.be_local=o.i(e.be_local,t),e.bs_local=o.k(e.bs_local,t),e.bbr_local=o.j(e.bbr_local,t)}function b(e,t){var r=e.base_length;for(var a in t){var _=t[a].length;e.va_common[a]=new Float32Array(_*r);for(var n=0;n<r;n++)for(var o=0;o<_;o++)e.va_common[a][n*_+o]=t[a][o]}return e}function Y(e){var t=e[0],r=L(e),a=r.submesh_bd;a.bb_local=o.n(t.submesh_bd.bb_local);for(var _=0,n=0,i=[],s=0;s<e.length;s++){var c=e[s],E=c.indices,l=c.base_length,T=c.va_common,d=c.submesh_bd.bb_local,f=c.submesh_bd.bs_local;o.D(a.bb_local,d),o.E(a.bs_local,f),o.G(c.submesh_bd.bbr_local,i);for(var P=0;P<E.length;P++){var A=E[P];r.indices[_+P]=A+n}_+=E.length;for(var S in T){var p=T[S],v=n*z(p,l);r.va_common[S].set(p,v)}for(var P=0;P<c.va_frames.length;P++){var m=c.va_frames[P],O=r.va_frames[P];for(var S in m){var p=m[S],v=n*z(p,l);O[S].set(p,v)}}n+=l}if(a.be_local=o.z(u._1(i),!0),r.shape_keys.length>0)for(var s=0;s<r.shape_keys.length;s++)for(var N=r.shape_keys[s].geometry,g=0,h=0,P=0;P<e.length;P++){var R=e[P].shape_keys[s].geometry;N.a_position.set(R.a_position,g),N.a_tbn.set(R.a_tbn,h),g+=R.a_position.length,h+=R.a_tbn.length}return e[0].instanced_array_data&&(r.instanced_array_data={tsr_array:t.instanced_array_data.tsr_array,stat_part_em_tsr:t.instanced_array_data.stat_part_em_tsr,static_hair:!0,submesh_params:t.instanced_array_data.submesh_params,part_inh_attrs:t.instanced_array_data.part_inh_attrs,dyn_grass:t.instanced_array_data.dyn_grass}),r}function L(e){for(var t=e[0],r=fe("JOIN_"+e.length+"_SUBMESHES"),a=0,_=0;_<e.length;_++)a+=e[_].indices.length;r.indices=new Uint32Array(a);var n=0,o=0;if(e[0].shape_keys.length>0)for(var i=0;i<e[0].shape_keys.length;i++){for(var _=0;_<e.length;_++)n+=e[_].shape_keys[i].geometry.a_position.length,o+=l.f(e[_].shape_keys[i].geometry.a_tbn);var s={a_position:new Float32Array(n),a_tbn:l.c(o)},c={init_value:e[0].shape_keys[i].init_value,geometry:s};r.shape_keys.push(c)}a=0;for(var _=0;_<e.length;_++)a+=e[_].base_length;r.base_length=a;for(var E in t.va_common){a=0;for(var _=0;_<e.length;_++)a+=e[_].va_common[E].length;r.va_common[E]=new Float32Array(a)}for(var E in t.va_frames[0]){a=0;for(var _=0;_<e.length;_++)a+=e[_].va_frames[0][E].length;for(var _=0;_<t.va_frames.length;_++)r.va_frames[_]=r.va_frames[_]||{},r.va_frames[_][E]=new Float32Array(a)}return r}function M(e,t,r){for(var a=t.submesh_bd,_=o.w(),n=o.C(),i=[],s=0;s<r.length;s++)o.h(e.submesh_bd.bb_local,r[s],_),o.D(a.bb_local,_),o.j(e.submesh_bd.bbr_local,r[s],n),o.G(n,i);a.be_local=o.z(u._1(i),!0),a.bbr_local=o.x(a.be_local),a.bs_local=o.B(a.be_local)}function y(e,t,r,a,_,n){var o=e.submeshes[t],i=o.base_length,s=e.materials[t],c=fe("SUBMESH_"+e.name+"_"+s.name);c.base_length=i;var E=!1;if(X(r,"a_texcoord"))var l=w(e,t);else var l=new Float32Array(0);if(X(r,"a_orco_tex_coord"))var T=D(e,o);else var T=new Float32Array(0);var d=j(r,i,a,o.group);if(_)var f=u.O(_);else var f={};f.a_color={generate_buffer:!0},X(r,"a_color")&&e.active_vcol_name?f.a_color.src=[{name:e.active_vcol_name,mask:7}]:f.a_color.src=[],c.va_common.a_texcoord=l,c.va_common.a_influence=d,c.va_common.a_orco_tex_coord=T,G(c.va_common,f,o.vertex_colors,o.color,i,e.name),B(o,e.name,n,c.va_common),c.indices=new Uint32Array(o.indices);var P=o.position.length/i/He;if(X(r,"a_tbn")&&o.tbn.length)var S=!0;else var S=!1;if(X(r,"a_shade_tangs")&&o.shade_tangs.length)var p=!0;else var p=!1;e.b4w_shape_keys.length>0&&(E=!0);for(var v=0;v<P;v++){var m=U(o,i,S,p,v);if(E){var O={};if(O.name=e.b4w_shape_keys[v].name,c.shape_keys.push(O),0!=v){O.geometry=m,O.init_value=e.b4w_shape_keys[v].value;continue}O.geometry=U(o,i,S,p,v),O.init_value=1}c.va_frames.push(m)}if(P>1&&!E){var N=c.va_frames[0],m={};for(var g in N)m[g]=new Float32Array(N[g]);c.va_frames.push(m)}return X(r,"a_polyindex")&&(A(c,1,!0),c.va_common.a_polyindex=se(c)),x(o.boundings,c.submesh_bd),c}function x(e,t){t.bb_local=o.w(),t.bb_local.max_x=e.bb.max_x,t.bb_local.max_y=e.bb.max_y,t.bb_local.max_z=e.bb.max_z,t.bb_local.min_x=e.bb.min_x,t.bb_local.min_y=e.bb.min_y,t.bb_local.min_z=e.bb.min_z;var r=e.rbb,a=e.caxis_x,_=e.caxis_y,n=e.caxis_z,i=e.be_ax;t.be_local=o.e(a,_,n,e.be_cen),d.scale(t.be_local.axis_x,i[0],t.be_local.axis_x),d.scale(t.be_local.axis_y,i[1],t.be_local.axis_y),d.scale(t.be_local.axis_z,i[2],t.be_local.axis_z),t.bs_local=o.B(t.be_local),d.copy(r.rbb_c,t.bbr_local.center),d.copy(a,t.bbr_local.axis_x),d.copy(_,t.bbr_local.axis_y),d.copy(n,t.bbr_local.axis_z);var s=r.rbb_s;d.scale(t.bbr_local.axis_x,s[0],t.bbr_local.axis_x),d.scale(t.bbr_local.axis_y,s[1],t.bbr_local.axis_y),d.scale(t.bbr_local.axis_z,s[2],t.bbr_local.axis_z)}function U(e,t,r,a,_){var n={},o=new Float32Array(t*He),i=l.c(r?t:0),s=_*t*He,c=s+t*He;if(o.set(e.position.subarray(s,c),0),r&&(s=_*t,l.b(e.tbn,s,t,i)),a){var E=new Float32Array(t*Ve);c=t*Ve,E.set(e.shade_tangs.subarray(0,c),0),n.a_shade_tangs=E}return n.a_position=o,n.a_tbn=i,n}function w(e,t){var r=null,a=e.materials[t],_=e.submeshes[t];if(a.texture_slots.length){var n=a.texture_slots[0];switch(n.texture_coords){case"UV":r=C(_,n.uv_layer||e.active_uv_name,e.name);break;case"ORCO":r=F(e.b4w_boundings.bb_src,_)}}return null===r&&(r=new Float32Array(_.base_length*qe)),r}function C(e,t,r){var a=e.base_length*qe,_=e.uv_layers.indexOf(t);if(-1==_)return Ue.warn('uv layer "'+t+'" for mesh "'+r+'" not found'),new Float32Array(a);var n=_*a,o=n+a;return e.texcoord.subarray(n,o)}function D(e,t){for(var r=e.b4w_boundings.bb_src,a=new Float32Array(3*t.base_length),_=t.position,n=r.max_x-r.min_x,o=r.max_y-r.min_y,i=r.max_z-r.min_z,s=0,c=0;c<_.length;c+=3)a[s++]=0==n?.5:u.M(parseFloat(((_[c]-r.min_x)/n).toFixed(5)),0,1),a[s++]=0==o?.5:u.M(parseFloat(((_[c+1]-r.min_y)/o).toFixed(5)),0,1),a[s++]=0==i?.5:u.M(parseFloat(((_[c+2]-r.min_z)/i).toFixed(5)),0,1);return a}function F(e,t){for(var r=new Float32Array(t.base_length*qe),a=(e.max_x+e.min_x)/2,_=(e.max_y+e.min_y)/2,n=e.max_x-e.min_x,o=e.max_y-e.min_y,i=0,s=0;s<t.position.length;s+=3)r[i++]=(t.position[s]-a)/n+.5,r[i++]=(t.position[s+1]-_)/o+.5;return r}function G(e,t,r,a,_,n){var o=k(r);for(var i in t){var s=t[i].src;if(s.length){for(var c=0,E=0;E<s.length;E++)c+=u._43(s[E].mask);e[i]=new Float32Array(c*_);for(var l=0,E=0;E<s.length;E++){var T=s[E].name,d=s[E].mask,f=u._44(d),P=o.indexOf(T);if(-1==P){Ue.warn('vertex color "'+T+'" for mesh "'+n+'" not found');var A=7}else var A=r[P].mask,S=K(r,P,_);var p=u._43(A);(d&A)!==d&&Ue.error("Wrong color extraction from "+T+" to "+i+' for the mesh "'+n+'".');for(var v=0;v<_;v++)for(var m=0;m<ze;m++)if(f[m]){var O=l+u._42(d,m),N=u._42(A,m);e[i][v*c+O]=-1==P?0:a[S+v*p+N]}l+=p}}else e[i]=new Float32Array(0)}}function k(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].name);return t}function K(e,t,r){for(var a=0,_=0;_<t;_++)a+=u._43(e[_].mask);return a*r}function B(e,t,r,a){if(r)for(var _ in r)a[r[_]]=C(e,_,t)}function X(e,t){return e.indexOf(t)>-1}function j(e,t,r,a){if(X(e,"a_influence")&&r)for(var _=new Float32Array(t*We),n=a.length/t,o=H(r,n),i=n>3?n:4,s=new Float32Array(i),c=new Uint32Array(i),E=new Float32Array(We),l=new Float32Array(i),T=new Uint32Array(i),u=new Float32Array(We),d=0;d<t;d++)s.set(l),c.set(T),E.set(u),_.set(Q(a,n,d,t,o,s,c,E),d*We);else var _=new Float32Array(0);return _}function H(e,t){for(var r=new Float32Array(t),a=0;a<t;a++){r[a]=-1;for(var _ in e){var n=e[_];if(n.vgroup_index===a){r[a]=n.deform_bone_index;break}}}return r}function Q(e,r,a,_,n,o,i,s){for(var c=!0,E=0;E<r;E++){var l=e[E*_+a];if(-1!==l){var T=n[E];-1!==T&&(o[E]=l,i[E]=T,c=!1)}}if(c)return s;J(o,i,t.SORT_NUMERIC,!1);for(var u=0,E=0;E<We;E++)u+=o[E];if(u<.01)return s;for(var E=0;E<We;E++)o[E]/=u;if(Math.abs(o[0]-1)<.01)s[0]=i[0]+1;else for(var E=0;E<We;E++)s[E]=i[E]+o[E];return s}function z(e,t){if(0==t)return 0;var r=e.length,a=r/t;return a!=Math.floor(a)&&Me.panic("Array size mismatch during geometry calculation: array length="+r+", base length="+t),a}function q(e,t,r){for(var a=e.length/3,_=0;_<a;_++){var n=e[3*_],o=e[3*_+1],i=e[3*_+2],s=t[3*n],c=t[3*n+1],E=t[3*n+2],l=t[3*o],T=t[3*o+1],u=t[3*o+2],d=t[3*i],f=t[3*i+1],P=t[3*i+2];r[3*_]=(s+l+d)/3,r[3*_+1]=(c+T+f)/3,r[3*_+2]=(E+u+P)/3}return r}function V(e,t,r){for(var a=e.length/3,_=0;_<a;_++){var n=e[3*_]-t[0],o=e[3*_+1]-t[1],i=e[3*_+2]-t[2];r[_]=n*n+o*o+i*i}return r}function W(e,t){var r=e.length;if(r<2)return t;for(var a,_=r,n=!1;_>1||n;){_>1&&(_=Math.floor(_/je)),n=!1;for(var o=0;_+o<r;o++)e[o]-e[o+_]<0&&(a=e[o],e[o]=e[o+_],e[o+_]=a,Z(t,o,o+_),n=!0)}return t}function J(e,r,a,_){for(var n,o=e.length,i=o,s=!1,c=_?-1:1;i>1||s;){i>1&&(i=Math.floor(i/je)),s=!1;for(var E=0;i+E<o;E++){if(a==t.SORT_NUMERIC)var l=c*(e[E]-e[E+i])<0;else var l=e[E]<e[E+i]&&_;l&&(n=e[E],e[E]=e[E+i],e[E+i]=n,n=r[E],r[E]=r[E+i],r[E+i]=n,s=!0)}}}function Z(e,t,r){var a=e[3*t],_=e[3*t+1],n=e[3*t+2];e[3*t]=e[3*r],e[3*t+1]=e[3*r+1],e[3*t+2]=e[3*r+2],e[3*r]=a,e[3*r+1]=_,e[3*r+2]=n}function $(e,t,r){var a=[],_=[];d.subtract(t,e,a),d.subtract(r,e,_),d.normalize(a,a),d.normalize(_,_);var n=u.M(d.dot(a,_),-1,1);return Math.acos(n)}function ee(e,t,r,a,_,n,o,i,s,c){for(var E=te(a,_,n),l=0;l<Qe;l++){var T=Qe*e+l,u=Qe*t+l,d=Qe*r+l;c[T]=o*E[l],c[u]=i*E[l],c[d]=s*E[l]}}function te(e,t,r){var a=[],_=[],n=[];return d.subtract(t,e,a),d.subtract(r,e,_),d.cross(a,_,n),d.normalize(n,n),n}function re(e,t){for(var r in e)for(var a=e[r],_=0;_<Qe;_++){for(var n=Qe*a[0]+_,o=1;o<a.length;o++){var i=Qe*a[o]+_;t[n]+=t[i]}for(var o=1;o<a.length;o++){var i=Qe*a[o]+_;t[i]=t[n]}}}function ae(e,t){for(var r=new Float32Array(Qe),a=0;a<Qe;a++){var _=Qe*e+a;r[a]=t[_]}d.normalize(r,r);for(var a=0;a<Qe;a++){var _=Qe*e+a;t[_]=r[a]}}function _e(e,t,r){for(var a={},_=t.length/3,n=0;n<_;n++){var o=String(t[3*n])+String(t[3*n+1])+String(t[3*n+2]);a[o]=[]}for(var i=e.length,n=0;n<i;n++){var s=e[n],o=String(r[3*s])+String(r[3*s+1])+String(r[3*s+2]);o in a&&a[o].push(s)}return a}function ne(e,t){return t||(t=[]),ie(e.va_frames[0].a_position,e,t)}function oe(e,t){t||(t=[]);for(var r=e.va_frames[0].a_tbn,a=l.f(r),_=new Float32Array(3*a),n=0;n<a;n++){var o=l.h(r,n,Ke),i=d.transformQuat(u.e,o,Fe);_[3*n]=i[0],_[3*n+1]=i[1],_[3*n+2]=i[2]}return ie(_,e,t)}function ie(e,t,r){if(P(t))for(var a=t.indices,_=a.length/3,n=0;n<_;n++){var o=new Float32Array(9),i=a[3*n];o[0]=e[3*i],o[1]=e[3*i+1],o[2]=e[3*i+2];var s=a[3*n+1];o[3]=e[3*s],o[4]=e[3*s+1],o[5]=e[3*s+2];var c=a[3*n+2];o[6]=e[3*c],o[7]=e[3*c+1],o[8]=e[3*c+2],r[n]=o}else for(var _=e.length/9,n=0;n<e.length;n++){var o=new Float32Array(9);o[0]=e[9*n],o[1]=e[9*n+1],o[2]=e[9*n+2],o[3]=e[9*n+3],o[4]=e[9*n+4],o[5]=e[9*n+5],o[6]=e[9*n+6],o[7]=e[9*n+7],o[8]=e[9*n+8],r[n]=o}return r}function se(e){for(var t=new Float32Array(e.base_length),r=0;r<e.base_length;r++)t[r]=r%3/2;return t}function ce(e,t,r){return Math.sqrt(Ee(e,t,r))}function Ee(e,t,r){var a=d.dist(e,t),_=d.dist(e,r),n=d.dist(t,r),o=(a+_+n)/2;return o*(o-a)*(o-_)*(o-n)}function le(e,t,r){r||(r=new Float32Array(3));var a=e[0],_=e[1],n=e[2],o=e[3],i=e[4],s=e[5],c=e[6],E=e[7],l=e[8],T=u._40(t),d=u._40(t);T+d>1&&(T=1-T,d=1-d);var f=1-T-d,P=f*a+T*o+d*c,A=f*_+T*i+d*E,S=f*n+T*s+d*l;return r[0]=P,r[1]=A,r[2]=S,r}function Te(e){for(var t=new Float32Array([0,0,0,1,1,1,1,0]),r=new Float32Array(8*e),a=0;a<e;a++)r.set(t,8*a);return r}function ue(e,t,r,a){if(e){for(var _=e.offset,n=e.length+_,o=t.bufs_data.shape_keys[0].geometry.a_position,i=_;i<n;i++)r[i]=o[i-_];for(var i=1;i<t.bufs_data.shape_keys.length;i++){var s=t.bufs_data.shape_keys[i].geometry.a_position,c=a[i].value;if(c)for(var E=_;E<n;E++)r[E]+=c*s[E-_]}Je.bufferSubData(Je.ARRAY_BUFFER,u.h*_,r.subarray(_))}}function de(e,t,r,a){if(e){for(var _=e.offset,n=e.length+_,o=t.bufs_data.shape_keys,i=o[0].geometry.a_tbn,s=l.i(we),c=_;c<n;c+=l.a){for(var E=l.i(De),T=(c-_)/l.a,d=1;d<o.length;d++){var f=a[d].value;if(f){var P=o[d].geometry.a_tbn,A=l.e(P,T,Ce),S=l.p(s,A,f,Ce);l.k(S,s,E)}}var p=l.e(i,T,Ce),v=l.k(E,p,Ce);r[c]=u._3(v[0]),r[c+1]=u._3(v[1]),r[c+2]=u._3(v[2]),r[c+3]=u._3(v[3])}Je.bufferSubData(Je.ARRAY_BUFFER,u.h*_,r.subarray(_))}}function fe(e){return{name:e,base_length:0,indices:null,va_frames:[],va_common:{a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)},shape_keys:[],submesh_bd:{bb_local:o.w(),be_local:o.y(),bs_local:o.A(),bbr_local:o.C()},instanced_array_data:null}}function Pe(e){var t=[];for(var r in e)t.push(Ae(r,e[r]));return t}function Ae(e,t){var r=Oe(e);return{vbo_source:new r(t),type:e}}function Se(e){for(var t=[],r=0;r<e.length;r++){var a=e[r].vbo_source,_=e[r].type;t.push({vbo_source:new a.constructor(a),type:_})}return t}function pe(e,t){for(var r=0;r<e.length;r++)if(e[r].type==t)return r;return-1}function ve(e,t){var r=pe(e,t);return-1==r?null:e[r].vbo}function me(e,t){var r=pe(e,t);return-1==r?null:e[r].vbo_source}function Oe(e){switch(e){case Ze:return Float32Array;case $e:return Int16Array;case et:return Uint8Array;default:return Float32Array}}function Ne(e){switch(e=e.replace(/_next$/,""),e=e.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a")){case"a_tbn":case"a_shade_tangs":return $e;case"a_color":case"a_bending_col_main":case"a_bending_col_detail":case"a_grass_size":case"a_grass_color":case"param_GEOMETRY_VC_a":case"a_polyindex":case"a_p_bb_vertex":case"a_halo_bb_vertex":case"a_bb_vertex":return et;default:return Ze}}function ge(e){switch(Ne(e)){case Ze:return u.h;case $e:return u.l;case et:return u.g;default:return u.h}}function he(e){switch(Ne(e)){case Ze:return Je.FLOAT;case $e:return Je.SHORT;case et:return Je.UNSIGNED_BYTE;default:return Je.FLOAT}}function Re(e,t,r,a){Le(t,r,e[pe(e,Ne(t))].vbo_source.subarray(a))}function Ie(e,t){switch(Ne(e)){case Ze:return t;case $e:return u._49(t);case et:return u._65(t)}return t}function be(e,t){switch(Ne(e)){case Ze:return t;case $e:return u._3(t);case et:return u._66(t)}return t}function Ye(e,t,r){switch(Ne(e)){case Ze:r.set(t);break;case $e:for(var a=0;a<t.length;a++)r[a]=u._49(t[a]);break;case et:for(var a=0;a<t.length;a++)r[a]=u._65(t[a])}return r}function Le(e,t,r){switch(Ne(e)){case Ze:r.set(t);break;case $e:for(var a=0;a<t.length;a++)r[a]=u._3(t[a]);break;case et:for(var a=0;a<t.length;a++)r[a]=u._66(t[a])}return r}var Me=Object(n.a)(e),ye=Object(s.a)(e),xe=Object(i.a)(e),Ue=Object(c.a)(e),we=l.c(),Ce=l.c(),De=l.c(),Fe=new Float32Array(3),Ge=new Float32Array(3),ke=new Float32Array(3),Ke=E.create(),Be=T.b(),Xe=65536,je=1.247330950103979,He=3,Qe=3,ze=3,qe=2,Ve=3,We=4;t.DM_TRIANGLES=10,t.DM_DYNAMIC_TRIANGLES=20,t.SORT_NUMERIC=0,t.SORT_STRING=1,t.DM_DEFAULT=t.DM_TRIANGLES;var Je=null,Ze="float",$e="short",et="unsigned_byte";t.VBO_FLOAT=Ze,t.VBO_SHORT=$e,t.VBO_UBYTE=et,t.setup_context=function(e){Je=e},t.submesh_to_bufs_data=function(e,t,r){_(e)&&A(e);var n=e.indices,o=e.base_length,i=e.va_frames,s={};for(var c in e.va_common)c in r&&!r[c].generate_buffer||(s[c]=e.va_common[c]);var E=p();return e.shape_keys.length>0&&a(e,i[0]),N(E,n,i,s,o,e.instanced_array_data),O(E,t),h(E),E.shape_keys=e.shape_keys,E},t.submesh_init_shape_keys=a,t.is_long_submesh=_,t.is_indexed=P,t.submesh_drop_indices=A,t.update_bufs_data_index_array=function(e,t,r){return O(e,t),e.count=r.length,e.ibo_array=r,r instanceof Uint16Array?e.ibo_type=Je.UNSIGNED_SHORT:e.ibo_type=Je.UNSIGNED_INT,e},t.update_bufs_data_array=v,t.extract_array_float=m,t.make_static=function(e){e.usage=Je.STATIC_DRAW},t.make_dynamic=function(e){e.usage=Je.DYNAMIC_DRAW};var tt=function(){var e=f.create(),t=E.create();return function(a,_,n,o){var i=a.tsr_array,s=a.stat_part_em_tsr,c=a.part_inh_attrs,E=a.submesh_params,l=a.static_hair,u={a_part_ts:{data:[],num_comp:4},a_part_r:{data:[],num_comp:4}};for(var f in c)u[f]={data:[],num_comp:c[f].num_comp};for(var f in E)u[f]={data:[],num_comp:1};for(var P=0;P<i.length;P++){var A=i[P];l&&s&&!a.dyn_grass&&(A=T.q(s,i[P],Be)),!l&&a.dyn_grass&&d.subtract(i[P],s,i[P]);var S=T.l(A,e),p=T.g(A,t),v=u.a_part_ts.data,m=u.a_part_r.data;v.push.apply(v,S),m.push.apply(m,p);for(var f in c)for(var O=c[f].num_comp,N=0;N<O;N++)u[f].data.push(c[f].data[P*O+N]);for(var f in E)u[f].data.push(E[f][0])}for(var f in u){var g=Ne(f);Re(n,f,u[f].data,o[g]);var h=r();h.num_comp=u[f].num_comp,h.offset=o[g],h.divisor=1,h.length=u[f].data.length,_[f]=h,o[g]+=h.length}}}();t.update_gl_buffers=h,t.update_gl_buffer_sub_data=R,t.cleanup_bufs_data=function(e){e.ibo&&Je.deleteBuffer(e.ibo);for(var t=0;t<e.vbo_data.length;t++)e.vbo_data[t].vbo&&Je.deleteBuffer(e.vbo_data[t].vbo);e.vbo_data.length=0},t.has_empty_submesh=function(e,t){return!e.submeshes[t].base_length},t.submesh_apply_transform=function(e,t){for(var r=0;r<e.va_frames.length;r++){var a=e.va_frames[r].a_position;T.F(a,t,a,0);var _=e.va_frames[r].a_tbn;l.m(_,t,_);var n=e.va_frames[r].a_shade_tangs;n&&n.length>0&&T.z(n,t,n,0)}var o=e.va_common.au_center_pos;return o&&o.length&&T.F(o,t,o,0),I(e.submesh_bd,t),e},t.submesh_apply_particle_transform=function(e,t){var r=e.va_common.au_center_pos;if(r&&r.length){var a=new Float32Array(r);T.F(a,t,a,0);for(var _=0;_<e.va_frames.length;_++)for(var n=0;n<a.length;n++)e.va_frames[_].a_position[n]+=a[n]-r[n];r.set(a)}else Me.panic('Attribute "au_center_pos" is missing in particle submesh');return I(e.submesh_bd,t),e},t.bounding_data_apply_transform=I,t.submesh_apply_params=b,t.submesh_list_join=Y,t.make_propagated_submesh=function(e,t,r){if(!e.base_length)return fe("EMPTY");var a=r.length;e.base_length*a>Xe&&!ye.get_elem_index_uint()&&A(e,a);var _=e.indices,n=e.base_length,o=e.va_common,i=e.va_frames;for(var s in t){var c=t[s].length,E=c*n;o[s]=new Float32Array(E);for(var l=0;l<n;l++)for(var u=0;u<c;u++)o[s][l*c+u]=t[s][u]}var d=fe("CLONE_"+a+"_SUBMESHES");d.base_length=n*a,d.indices=new Uint32Array(_.length*a);for(var l=0;l<a;l++)for(var f=_.length*l,P=n*l,u=0;u<_.length;u++){var S=_[u];d.indices[f+u]=S+P}for(var p in o){var v=o[p],E=v.length*a,m=z(v,n);d.va_common[p]=new Float32Array(E);for(var l=0;l<a;l++){var P=n*m*l;d.va_common[p].set(v,P)}}for(var p in i[0])for(var l=0;l<i.length;l++){var v=i[l][p],E=v.length*a,m=z(v,n);d.va_frames[l]=d.va_frames[l]||{},d.va_frames[l][p]=new Float32Array(E);for(var u=0;u<a;u++){var O=r[u],P=n*m*u;switch(p){case"a_position":T.F(v,O,d.va_frames[l][p],P);break;case"a_tbn":T.B(v,O,d.va_frames[l][p],P);break;case"a_shade_tangs":T.C(v,O,d.va_frames[l][p],P);break;default:Me.panic("Wrong attribute name: "+p)}}}return M(e,d,r),d},t.calc_unit_boundings=M,t.extract_submesh=y,t.extract_halo_submesh=function(e){for(var t=e.base_length,r=e.va_frames[0].a_position,a=new Float32Array(12*t),_=new Uint32Array(4*e.indices.length),n=new Float32Array(4*t),o=0;o<t;o++){a[12*o]=r[3*o],a[12*o+1]=r[3*o+1],a[12*o+2]=r[3*o+2],a[12*o+3]=r[3*o],a[12*o+4]=r[3*o+1],a[12*o+5]=r[3*o+2],a[12*o+6]=r[3*o],a[12*o+7]=r[3*o+1],a[12*o+8]=r[3*o+2],a[12*o+9]=r[3*o],a[12*o+10]=r[3*o+1],a[12*o+11]=r[3*o+2],_[6*o]=4*o+2,_[6*o+1]=4*o+1,_[6*o+2]=4*o,_[6*o+3]=4*o+2,_[6*o+4]=4*o,_[6*o+5]=4*o+3;var i=Math.random();n[4*o]=i,n[4*o+1]=i,n[4*o+2]=i,n[4*o+3]=i}var s=fe("HALO");return s.va_frames[0]={},s.base_length=4*t,s.va_frames[0].a_position=a,s.va_common.a_halo_bb_vertex=Te(t),s.va_common.a_random_vals=n,s.indices=_,s},t.has_attr=X,t.extract_submesh_all_mats=function(e,t,r){for(var a=[],_=0;_<e.submeshes.length;_++){var n=y(e,_,t,null,r,null);n.base_length&&a.push(n)}if(0==a.length)var o=fe("EMPTY");else if(1==a.length)var o=a[0];else var o=Y(a);return o},t.update_buffers_movable=function(e,t,r,a){var _=e.ibo_array,n=m(e,"a_position"),o=t.median_cache,i=t.median_world_cache,s=t.dist_cache;q(_,n,o),T.F(o,r,i),V(i,a,s),_=W(s,_),Je.bindBuffer(Je.ELEMENT_ARRAY_BUFFER,e.ibo),Je.bufferData(Je.ELEMENT_ARRAY_BUFFER,_,Je.DYNAMIC_DRAW)},t.sort_two_arrays=J,t.calc_normals=function(e,t,r){for(var a=t.length/He,_=e.length/3,n=[],o=new Array(3),i=new Array(3),s=new Array(3),c=0;c<_;c++){for(var E=e[3*c],l=e[3*c+1],T=e[3*c+2],u=0;u<He;u++)o[u]=t[He*E+u],i[u]=t[He*l+u],s[u]=t[He*T+u];if(r)var d=$(o,i,s),f=$(i,s,o),P=Math.PI-d-f;else var d=1,f=1,P=1;ee(E,l,T,o,i,s,d,f,P,n)}r&&re(r,n);for(var c=0;c<a;c++)ae(c,n);return n},t.calc_shared_indices=_e,t.geometry_random_points=function(e,t,r,a){var _=ne(e,null);if(r)var n=oe(e,null);for(var o=_.length,i=new Float32Array(o),s=Fe,c=Ge,l=ke,T=0;T<o;T++){var f=_[T];s.set(f.subarray(0,3)),c.set(f.subarray(3,6)),l.set(f.subarray(6)),i[T]=ce(s,c,l)}var P=new Float32Array(o);P[0]=i[0];for(var T=1;T<o;T++)P[T]=P[T-1]+i[T];for(var A=P[i.length-1],S=[],T=0;T<t;T++){var p=A*u._40(a),v=u.F(P,p,0,P.length-1);if(r)var f=n[v];else var f=_[v];var m=le(f,a,Fe);if(r){S[T]=new Float32Array(4),d.normalize(m,m);var O=E.rotationTo(u.e,m,Ke);S[T][0]=O[0],S[T][1]=O[1],S[T][2]=O[2],S[T][3]=O[3]}else S[T]=new Float32Array(3),S[T][0]=m[0],S[T][1]=m[1],S[T][2]=m[2]}return S},t.extract_polyindices=se,t.triangle_area_squared=Ee,t.gen_bb_vertices=Te,t.scale_submesh_xyz=function(e,t,r){for(var a=e.va_frames[0].a_position,_=0;_<a.length;_+=3)a[_]=(a[_]-r[0])*t[0]+r[0],a[_+1]=(a[_+1]-r[1])*t[1]+r[1],a[_+2]=(a[_+2]-r[2])*t[2]+r[2]},t.apply_shape_key=function(e,t,r){for(var a=e.scenes_data[0].batches,_=e.render.shape_keys_values,n=1;n<_.length;n++)_[n].name==t&&(_[n].value=r);for(var n=0;n<a.length;n++)if(!a[n].forked_batch&&a[n].use_shape_keys&&!a[n].debug_sphere){var o=a[n].bufs_data,i=Ne("a_position"),s=ve(o.vbo_data,i),c=me(o.vbo_source_data,i);Je.bindBuffer(Je.ARRAY_BUFFER,s),ue(o.pointers.a_position,a[n],c,_);var E=Ne("a_tbn"),l=ve(o.vbo_data,E),T=me(o.vbo_source_data,E);Je.bindBuffer(Je.ARRAY_BUFFER,l),de(o.pointers.a_tbn,a[n],T,_)}},t.check_shape_keys=function(e){return e.render.use_shape_keys},t.get_shape_keys_names=function(e){var t=[];if(e.render)for(var r=1;r<e.render.shape_keys_values.length;r++)t.push(e.render.shape_keys_values[r].name);return t},t.get_shape_key_value=function(e,t){if(e.render)for(var r=1;r<e.render.shape_keys_values.length;r++)if(t==e.render.shape_keys_values[r].name)return e.render.shape_keys_values[r].value;return 0},t.has_shape_key=function(e,t){var r=e.render.shape_keys_values;if(r)for(var a=1;a<r.length;a++)if(r[a].name==t)return!0;return!1},t.has_dyn_geom=function(e){return!!(e&&e.render&&e.render.dynamic_geometry)},t.draw_line=function(e,r,a){var _=e.bufs_data;if(_){if(a)var n=r.length/3/2;else var n=r.length/3-1;for(var o=new Float32Array(4*n*3),i=new Float32Array(4*n*3),s=new Uint16Array(6*n),c=0;c<n;c++){if(a)var E=6*c,l=6*c+3;else var E=3*c,l=3*(c+1);var T=r[E],u=r[E+1],d=r[E+2],f=r[l],P=r[l+1],A=r[l+2],S=f-T,p=P-u,v=A-d;o[4*c*3]=T,o[4*c*3+1]=u,o[4*c*3+2]=d,i[4*c*3]=S,i[4*c*3+1]=p,i[4*c*3+2]=v,o[4*c*3+3]=f,o[4*c*3+4]=P,o[4*c*3+5]=A,i[4*c*3+3]=-S,i[4*c*3+4]=-p,i[4*c*3+5]=-v,o[4*c*3+6]=T,o[4*c*3+7]=u,o[4*c*3+8]=d,i[4*c*3+6]=-S,i[4*c*3+7]=-p,i[4*c*3+8]=-v,o[4*c*3+9]=f,o[4*c*3+10]=P,o[4*c*3+11]=A,i[4*c*3+9]=S,i[4*c*3+10]=p,i[4*c*3+11]=v,s[6*c]=4*c,s[6*c+1]=4*c+1,s[6*c+2]=4*c+2,s[6*c+3]=4*c,s[6*c+4]=4*c+3,s[6*c+5]=4*c+1}var m=0;for(var O in _.pointers){var N=_.pointers[O];m+=o.length/3*N.num_comp}var g={};g[Ze]=m;var R=_.vbo_source_data=Pe(g);t.update_bufs_data_index_array(_,e.draw_mode,s);var I=0;for(var O in _.pointers){var N=_.pointers[O];switch(O){case"a_position":Re(R,O,o,I),N.offset=I,N.length=o.length,I+=N.length;break;case"a_direction":Re(R,O,i,I),N.offset=I,N.length=i.length,I+=N.length;break;default:N.offset=I,N.length=o.length/3*N.num_comp;Re(R,O,new Float32Array(N.length),I),I+=N.length}}h(_)}},t.clone_bufs_data=function(e){if(e){var t=p();if(e.ibo_array)switch(e.ibo_type){case Je.UNSIGNED_SHORT:t.ibo_array=new Uint16Array(e.ibo_array);break;case Je.UNSIGNED_INT:t.ibo_array=new Uint32Array(e.ibo_array)}else t.ibo_array=null;t.vbo_source_data=Se(e.vbo_source_data),t.ibo_type=e.ibo_type,t.count=e.count,t.pointers=u.O(e.pointers),t.usage=e.usage,t.debug_ibo_bytes=e.debug_ibo_bytes,t.debug_vbo_bytes=e.debug_vbo_bytes,t.ibo=null,t.info_for_z_sort_updates=u.O(e.info_for_z_sort_updates),t.shape_keys=u.O(e.shape_keys),t.instance_count=e.instance_count,t.cleanup_gl_data_on_unload=e.cleanup_gl_data_on_unload}else var t=null;return t},t.init_submesh=fe,t.clone_submesh=function(e){var t=fe(e.name);return t.base_length=e.base_length,t.indices=u.O(e.indices),t.va_frames=u.O(e.va_frames),t.va_common=u.O(e.va_common),t.shape_keys=u.O(e.shape_keys),o.o(e.submesh_bd.bb_local,t.submesh_bd.bb_local),o.s(e.submesh_bd.be_local,t.submesh_bd.be_local),o.u(e.submesh_bd.bs_local,t.submesh_bd.bs_local),o.v(e.submesh_bd.bbr_local,t.submesh_bd.bbr_local),t.instanced_array_data=u.O(e.instanced_array_data),t},t.reset=function(){Je=null},t.init_vbo_source_data=Pe,t.search_vbo_index_by_type=pe,t.get_vbo_by_type=ve,t.get_vbo_source_by_type=me,t.get_constructor_by_type=Oe,t.get_vbo_type_by_attr_name=Ne,t.get_type_size_by_attr_name=ge,t.get_gl_type_by_attr_name=he,t.vbo_source_data_set_attr=Re,t.value_vbo_to_float=Ie,t.value_float_to_vbo=be,t.array_vbo_to_float=Ye,t.array_float_to_vbo=Le,t.create_empty_va_frame=function(){return{a_position:new Float32Array(0),a_tbn:l.c(0)}}}var _=r(0),n=r(5),o=r(25),i=r(34),s=r(29),c=r(1),E=r(8),l=r(39),T=r(6),u=r(2),d=r(3),f=r(7),P=Object(_.a)("__geometry",a);t.a=P},function(e,t,r){"use strict";function a(){var e=new C(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _(e){var t=new C(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function n(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e,t){if(t===e){var r=e[1],a=e[2],_=e[3],n=e[6],o=e[7],i=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=n,t[11]=e[14],t[12]=_,t[13]=o,t[14]=i}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function s(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=e[4],i=e[5],s=e[6],c=e[7],E=e[8],l=e[9],T=e[10],u=e[11],d=e[12],f=e[13],P=e[14],A=e[15],S=r*i-a*o,p=r*s-_*o,v=r*c-n*o,m=a*s-_*i,O=a*c-n*i,N=_*c-n*s,g=E*f-l*d,h=E*P-T*d,R=E*A-u*d,I=l*P-T*f,b=l*A-u*f,Y=T*A-u*P,L=S*Y-p*b+v*I+m*R-O*h+N*g;return L?(L=1/L,t[0]=(i*Y-s*b+c*I)*L,t[1]=(_*b-a*Y-n*I)*L,t[2]=(f*N-P*O+A*m)*L,t[3]=(T*O-l*N-u*m)*L,t[4]=(s*R-o*Y-c*h)*L,t[5]=(r*Y-_*R+n*h)*L,t[6]=(P*v-d*N-A*p)*L,t[7]=(E*N-T*v+u*p)*L,t[8]=(o*b-i*R+c*g)*L,t[9]=(a*R-r*b-n*g)*L,t[10]=(d*O-f*v+A*S)*L,t[11]=(l*v-E*O-u*S)*L,t[12]=(i*h-o*I-s*g)*L,t[13]=(r*I-a*h+_*g)*L,t[14]=(f*p-d*m-P*S)*L,t[15]=(E*m-l*p+T*S)*L,t):null}function c(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=e[4],i=e[5],s=e[6],c=e[7],E=e[8],l=e[9],T=e[10],u=e[11],d=e[12],f=e[13],P=e[14],A=e[15];return t[0]=i*(T*A-u*P)-l*(s*A-c*P)+f*(s*u-c*T),t[1]=-(a*(T*A-u*P)-l*(_*A-n*P)+f*(_*u-n*T)),t[2]=a*(s*A-c*P)-i*(_*A-n*P)+f*(_*c-n*s),t[3]=-(a*(s*u-c*T)-i*(_*u-n*T)+l*(_*c-n*s)),t[4]=-(o*(T*A-u*P)-E*(s*A-c*P)+d*(s*u-c*T)),t[5]=r*(T*A-u*P)-E*(_*A-n*P)+d*(_*u-n*T),t[6]=-(r*(s*A-c*P)-o*(_*A-n*P)+d*(_*c-n*s)),t[7]=r*(s*u-c*T)-o*(_*u-n*T)+E*(_*c-n*s),t[8]=o*(l*A-u*f)-E*(i*A-c*f)+d*(i*u-c*l),t[9]=-(r*(l*A-u*f)-E*(a*A-n*f)+d*(a*u-n*l)),t[10]=r*(i*A-c*f)-o*(a*A-n*f)+d*(a*c-n*i),t[11]=-(r*(i*u-c*l)-o*(a*u-n*l)+E*(a*c-n*i)),t[12]=-(o*(l*P-T*f)-E*(i*P-s*f)+d*(i*T-s*l)),t[13]=r*(l*P-T*f)-E*(a*P-_*f)+d*(a*T-_*l),t[14]=-(r*(i*P-s*f)-o*(a*P-_*f)+d*(a*s-_*i)),t[15]=r*(i*T-s*l)-o*(a*T-_*l)+E*(a*s-_*i),t}function E(e){var t=e[0],r=e[1],a=e[2],_=e[3],n=e[4],o=e[5],i=e[6],s=e[7],c=e[8],E=e[9],l=e[10],T=e[11],u=e[12],d=e[13],f=e[14],P=e[15];return(t*o-r*n)*(l*P-T*f)-(t*i-a*n)*(E*P-T*d)+(t*s-_*n)*(E*f-l*d)+(r*i-a*o)*(c*P-T*u)-(r*s-_*o)*(c*f-l*u)+(a*s-_*i)*(c*d-E*u)}function l(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3],i=e[4],s=e[5],c=e[6],E=e[7],l=e[8],T=e[9],u=e[10],d=e[11],f=e[12],P=e[13],A=e[14],S=e[15],p=t[0],v=t[1],m=t[2],O=t[3];return r[0]=p*a+v*i+m*l+O*f,r[1]=p*_+v*s+m*T+O*P,r[2]=p*n+v*c+m*u+O*A,r[3]=p*o+v*E+m*d+O*S,p=t[4],v=t[5],m=t[6],O=t[7],r[4]=p*a+v*i+m*l+O*f,r[5]=p*_+v*s+m*T+O*P,r[6]=p*n+v*c+m*u+O*A,r[7]=p*o+v*E+m*d+O*S,p=t[8],v=t[9],m=t[10],O=t[11],r[8]=p*a+v*i+m*l+O*f,r[9]=p*_+v*s+m*T+O*P,r[10]=p*n+v*c+m*u+O*A,r[11]=p*o+v*E+m*d+O*S,p=t[12],v=t[13],m=t[14],O=t[15],r[12]=p*a+v*i+m*l+O*f,r[13]=p*_+v*s+m*T+O*P,r[14]=p*n+v*c+m*u+O*A,r[15]=p*o+v*E+m*d+O*S,r}function T(e,t,r){var a,_,n,o,i,s,c,E,l,T,u,d,f=t[0],P=t[1],A=t[2];return e===r?(r[12]=e[0]*f+e[4]*P+e[8]*A+e[12],r[13]=e[1]*f+e[5]*P+e[9]*A+e[13],r[14]=e[2]*f+e[6]*P+e[10]*A+e[14],r[15]=e[3]*f+e[7]*P+e[11]*A+e[15]):(a=e[0],_=e[1],n=e[2],o=e[3],i=e[4],s=e[5],c=e[6],E=e[7],l=e[8],T=e[9],u=e[10],d=e[11],r[0]=a,r[1]=_,r[2]=n,r[3]=o,r[4]=i,r[5]=s,r[6]=c,r[7]=E,r[8]=l,r[9]=T,r[10]=u,r[11]=d,r[12]=a*f+i*P+l*A+e[12],r[13]=_*f+s*P+T*A+e[13],r[14]=n*f+c*P+u*A+e[14],r[15]=o*f+E*P+d*A+e[15]),r}function u(e,t,r){var a=t[0],_=t[1],n=t[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*_,r[5]=e[5]*_,r[6]=e[6]*_,r[7]=e[7]*_,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function d(e,t,r,a){var _,n,o,i,s,c,E,l,T,u,d,f,P,A,S,p,v,m,O,N,g,h,R,I,b=r[0],Y=r[1],L=r[2],M=Math.sqrt(b*b+Y*Y+L*L);return Math.abs(M)<w?null:(M=1/M,b*=M,Y*=M,L*=M,_=Math.sin(t),n=Math.cos(t),o=1-n,i=e[0],s=e[1],c=e[2],E=e[3],l=e[4],T=e[5],u=e[6],d=e[7],f=e[8],P=e[9],A=e[10],S=e[11],p=b*b*o+n,v=Y*b*o+L*_,m=L*b*o-Y*_,O=b*Y*o-L*_,N=Y*Y*o+n,g=L*Y*o+b*_,h=b*L*o+Y*_,R=Y*L*o-b*_,I=L*L*o+n,a[0]=i*p+l*v+f*m,a[1]=s*p+T*v+P*m,a[2]=c*p+u*v+A*m,a[3]=E*p+d*v+S*m,a[4]=i*O+l*N+f*g,a[5]=s*O+T*N+P*g,a[6]=c*O+u*N+A*g,a[7]=E*O+d*N+S*g,a[8]=i*h+l*R+f*I,a[9]=s*h+T*R+P*I,a[10]=c*h+u*R+A*I,a[11]=E*h+d*R+S*I,e!==a&&(a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a)}function f(e,t,r){var a=Math.sin(t),_=Math.cos(t),n=e[4],o=e[5],i=e[6],s=e[7],c=e[8],E=e[9],l=e[10],T=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=n*_+c*a,r[5]=o*_+E*a,r[6]=i*_+l*a,r[7]=s*_+T*a,r[8]=c*_-n*a,r[9]=E*_-o*a,r[10]=l*_-i*a,r[11]=T*_-s*a,r}function P(e,t,r){var a=Math.sin(t),_=Math.cos(t),n=e[0],o=e[1],i=e[2],s=e[3],c=e[8],E=e[9],l=e[10],T=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=n*_-c*a,r[1]=o*_-E*a,r[2]=i*_-l*a,r[3]=s*_-T*a,r[8]=n*a+c*_,r[9]=o*a+E*_,r[10]=i*a+l*_,r[11]=s*a+T*_,r}function A(e,t,r){var a=Math.sin(t),_=Math.cos(t),n=e[0],o=e[1],i=e[2],s=e[3],c=e[4],E=e[5],l=e[6],T=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=n*_+c*a,r[1]=o*_+E*a,r[2]=i*_+l*a,r[3]=s*_+T*a,r[4]=c*_-n*a,r[5]=E*_-o*a,r[6]=l*_-i*a,r[7]=T*_-s*a,r}function S(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function p(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function v(e,t,r){var a,_,n,o=t[0],i=t[1],s=t[2],c=Math.sqrt(o*o+i*i+s*s);return Math.abs(c)<w?null:(c=1/c,o*=c,i*=c,s*=c,a=Math.sin(e),_=Math.cos(e),n=1-_,r[0]=o*o*n+_,r[1]=i*o*n+s*a,r[2]=s*o*n-i*a,r[3]=0,r[4]=o*i*n-s*a,r[5]=i*i*n+_,r[6]=s*i*n+o*a,r[7]=0,r[8]=o*s*n+i*a,r[9]=i*s*n-o*a,r[10]=s*s*n+_,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function m(e,t){var r=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function O(e,t){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(e,t){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3],i=a+a,s=_+_,c=n+n,E=a*i,l=a*s,T=a*c,u=_*s,d=_*c,f=n*c,P=o*i,A=o*s,S=o*c;return r[0]=1-(u+f),r[1]=l+S,r[2]=T-A,r[3]=0,r[4]=l-S,r[5]=1-(E+f),r[6]=d+P,r[7]=0,r[8]=T+A,r[9]=d-P,r[10]=1-(E+u),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function h(e,t,r,a){var _=e[0],n=e[1],o=e[2],i=e[3],s=_+_,c=n+n,E=o+o,l=_*s,T=_*c,u=_*E,d=n*c,f=n*E,P=o*E,A=i*s,S=i*c,p=i*E,v=r[0],m=r[1],O=r[2];return a[0]=(1-(d+P))*v,a[1]=(T+p)*v,a[2]=(u-S)*v,a[3]=0,a[4]=(T-p)*m,a[5]=(1-(l+P))*m,a[6]=(f+A)*m,a[7]=0,a[8]=(u+S)*O,a[9]=(f-A)*O,a[10]=(1-(l+d))*O,a[11]=0,a[12]=t[0],a[13]=t[1],a[14]=t[2],a[15]=1,a}function R(e,t,r,a,_){var n=e[0],o=e[1],i=e[2],s=e[3],c=n+n,E=o+o,l=i+i,T=n*c,u=n*E,d=n*l,f=o*E,P=o*l,A=i*l,S=s*c,p=s*E,v=s*l,m=r[0],O=r[1],N=r[2],g=a[0],h=a[1],R=a[2];return _[0]=(1-(f+A))*m,_[1]=(u+v)*m,_[2]=(d-p)*m,_[3]=0,_[4]=(u-v)*O,_[5]=(1-(T+A))*O,_[6]=(P+S)*O,_[7]=0,_[8]=(d+p)*N,_[9]=(P-S)*N,_[10]=(1-(T+f))*N,_[11]=0,_[12]=t[0]+g-(_[0]*g+_[4]*h+_[8]*R),_[13]=t[1]+h-(_[1]*g+_[5]*h+_[9]*R),_[14]=t[2]+R-(_[2]*g+_[6]*h+_[10]*R),_[15]=1,_}function I(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=r+r,i=a+a,s=_+_,c=r*o,E=a*o,l=a*i,T=_*o,u=_*i,d=_*s,f=n*o,P=n*i,A=n*s;return t[0]=1-l-d,t[1]=E+A,t[2]=T-P,t[3]=0,t[4]=E-A,t[5]=1-c-d,t[6]=u+f,t[7]=0,t[8]=T+P,t[9]=u-f,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function b(e,t,r,a,_,n,o){var i=1/(t-e),s=1/(a-r),c=1/(_-n);return o[0]=2*_*i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*_*s,o[6]=0,o[7]=0,o[8]=(t+e)*i,o[9]=(a+r)*s,o[10]=(n+_)*c,o[11]=-1,o[12]=0,o[13]=0,o[14]=n*_*2*c,o[15]=0,o}function Y(e,t,r,a,_){var n=1/Math.tan(e/2),o=1/(r-a);return _[0]=n/t,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=n,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=(a+r)*o,_[11]=-1,_[12]=0,_[13]=0,_[14]=2*a*r*o,_[15]=0,_}function L(e,t,r,a){var _=Math.tan(e.upDegrees*Math.PI/180),n=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),i=Math.tan(e.rightDegrees*Math.PI/180),s=2/(o+i),c=2/(_+n);return a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c,a[6]=0,a[7]=0,a[8]=-(o-i)*s*.5,a[9]=(_-n)*c*.5,a[10]=r/(t-r),a[11]=-1,a[12]=0,a[13]=0,a[14]=r*t/(t-r),a[15]=0,a}function M(e,t,r,a,_,n,o){var i=1/(e-t),s=1/(r-a),c=1/(_-n);return o[0]=-2*i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*c,o[11]=0,o[12]=(e+t)*i,o[13]=(a+r)*s,o[14]=(n+_)*c,o[15]=1,o}function y(e,t,r,a){var _,n,i,s,c,E,l,T,u,d,f=e[0],P=e[1],A=e[2],S=r[0],p=r[1],v=r[2],m=t[0],O=t[1],N=t[2];return Math.abs(f-m)<w&&Math.abs(P-O)<w&&Math.abs(A-N)<w?o(a):(l=f-m,T=P-O,u=A-N,d=1/Math.sqrt(l*l+T*T+u*u),l*=d,T*=d,u*=d,_=p*u-v*T,n=v*l-S*u,i=S*T-p*l,d=Math.sqrt(_*_+n*n+i*i),d?(d=1/d,_*=d,n*=d,i*=d):(_=0,n=0,i=0),s=T*i-u*n,c=u*_-l*i,E=l*n-T*_,d=Math.sqrt(s*s+c*c+E*E),d?(d=1/d,s*=d,c*=d,E*=d):(s=0,c=0,E=0),a[0]=_,a[1]=s,a[2]=l,a[3]=0,a[4]=n,a[5]=c,a[6]=T,a[7]=0,a[8]=i,a[9]=E,a[10]=u,a[11]=0,a[12]=-(_*f+n*P+i*A),a[13]=-(s*f+c*P+E*A),a[14]=-(l*f+T*P+u*A),a[15]=1,a)}function x(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function U(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.clone=_,t.copy=n,t.identity=o,t.transpose=i,t.invert=s,t.adjoint=c,t.determinant=E,t.multiply=l,r.d(t,"mul",function(){return l}),t.translate=T,t.scale=u,t.rotate=d,t.rotateX=f,t.rotateY=P,t.rotateZ=A,t.fromTranslation=S,t.fromScaling=p,t.fromRotation=v,t.fromXRotation=m,t.fromYRotation=O,t.fromZRotation=N,t.fromRotationTranslation=g,t.fromRotationTranslationScale=h,t.fromRotationTranslationScaleOrigin=R,t.fromQuat=I,t.frustum=b,t.perspective=Y,t.perspectiveFromFieldOfView=L,t.ortho=M,t.lookAt=y,t.str=x,t.frob=U;var w=1e-7,C="undefined"!==typeof Float32Array?Float32Array:Array;Math.random},function(e,t,r){"use strict";function a(e,t){function r(e){for(var t=e.camera,r=t.color_attachment,a=r.w_texture,_=0;_<6;_++){var n=Y(_);t.view_matrix=e.cube_view_matrices[_],P.d(t.view_matrix,t.view_tsr),w.calc_sky_vp_inverse(t),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,n,a,0),N(e);for(var o=e.draw_data,i=0;i<o.length;i++)for(var s=0;s<o[i].bundles.length;s++){var c=o[i].bundles[s];c.do_render=c.do_render_cube[_]}v(e)}}function a(e){var t=e.camera;$.bindFramebuffer($.READ_FRAMEBUFFER,t.framebuffer_prev),$.bindFramebuffer($.DRAW_FRAMEBUFFER,t.framebuffer);var r=0;t.color_attachment&&(r|=$.COLOR_BUFFER_BIT),t.depth_attachment&&(r|=$.DEPTH_BUFFER_BIT),$.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,r,$.NEAREST)}function _(e){var t=e.camera;$.bindFramebuffer($.FRAMEBUFFER,t.framebuffer_prev);var r=t.color_attachment,a=r.w_texture;$.bindTexture($.TEXTURE_2D,a),$.copyTexSubImage2D($.TEXTURE_2D,0,0,0,0,0,t.width,t.height,0)}function v(e){for(var t=e.camera,r=e.draw_data,a=null,_=P.j(t.world_tsr,oe),n=0;n<r.length;n++){var o=r[n];if(o.do_render){var i=o.shader,s=o.bundles;i.program!=a&&($.useProgram(i.program),m(e,t,i),a=i.program),o.alpha_antialiasing?($.enable($.SAMPLE_ALPHA_TO_COVERAGE),e.blend||$.enable($.BLEND)):($.disable($.SAMPLE_ALPHA_TO_COVERAGE),e.blend||$.disable($.BLEND));for(var c=0;c<s.length;c++){var E=s[c];if(E.do_render){var l=E.obj_render,T=E.batch;G.start_batch(T),G.is_debug_view_render_time_mode()&&"DEBUG_VIEW"==T.type&&(T.debug_main_batch_render_time=A._51(U.batch_get_debug_storage(T.debug_main_batch_id),T.debug_main_batch_render_time,1,Z)),ce.alpha_sort&&T.z_sort&&h(T,l,E.info_for_z_sort_updates,_),g(e,l,T,i),G.stop_batch(T),G.is_debug_view_render_time_mode()&&"MAIN"==T.type&&U.batch_set_debug_storage(T.id,T.debug_render_time)}}}}}function m(e,t,r){for(var a=r.transient_sc_uniform_setters,_=a.length;_--;){var n=a[_];n.fun($,n.loc,e,t)}if(r.need_uniforms_update&&!r.no_permanent_uniforms){r.permanent_sc_uniform_setters.length||M(r);for(var o=r.permanent_sc_uniform_setters,i=o.length;i--;){var n=o[i];n.fun($,n.loc,e,t)}}}function O(e){var t=e.camera;if($.bindFramebuffer($.FRAMEBUFFER,t.framebuffer),e.assign_texture){var r=t.color_attachment;$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,r.w_target,r.w_texture,0)}switch($.viewport(0,0,t.width,t.height),e.type!=B.MAIN_CUBE_REFLECT&&e.type!=B.MAIN_CUBE_REFLECT_BLEND&&N(e),e.blend?$.enable($.BLEND):$.disable($.BLEND),e.depth_test?$.enable($.DEPTH_TEST):$.disable($.DEPTH_TEST),e.type){case B.SHADOW_CAST:$.enable($.POLYGON_OFFSET_FILL),$.polygonOffset(e.self_shadow_polygon_offset,e.self_shadow_polygon_offset),$.cullFace($.BACK);break;case B.MAIN_PLANE_REFLECT:case B.MAIN_PLANE_REFLECT_BLEND:$.disable($.POLYGON_OFFSET_FILL),$.cullFace($.FRONT);break;case B.DEBUG_VIEW:$.enable($.POLYGON_OFFSET_FILL),$.polygonOffset(-4,-4),$.cullFace($.BACK);break;case B.MAIN_GLOW:if(ce.msaa_samples>1||ce.safari_glow_hack){$.enable($.POLYGON_OFFSET_FILL),$.polygonOffset(-2,-2);break}default:$.disable($.POLYGON_OFFSET_FILL),$.cullFace($.BACK)}}function N(e){if(e){var t=(e.clear_color?$.COLOR_BUFFER_BIT:0)|(e.clear_depth?$.DEPTH_BUFFER_BIT:0);if(!t)return;switch(e.type){case B.MAIN_GLOW:var r=q;break;case B.SHADOW_CAST:var r=H;break;case B.SHADOW_RECEIVE:var r=Q;break;case B.COLOR_PICKING:case B.COLOR_PICKING_XRAY:case B.ANCHOR_VISIBILITY:var r=z;break;case B.MAIN_OPAQUE:case B.OUTLINE_MASK:case B.SMAA_BLENDING_WEIGHT_CALCULATION:case B.SMAA_EDGE_DETECTION:var r=q;break;default:var r=ce.background_color}}else var t=$.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT,r=ce.background_color;$.colorMask(!0,!0,!0,!0),$.depthMask(!0),$.clearColor(r[0],r[1],r[2],r[3]),$.clear(t)}function g(e,t,r,a){for(var _=a.transient_uniform_setters,n=_.length;n--;){var o=_[n];o.fun($,o.loc,t,r)}if(a.need_uniforms_update&&!a.no_permanent_uniforms){a.permanent_uniform_setters.length||M(a);for(var i=a.permanent_uniform_setters,s=i.length;s--;){var o=i[s];o.fun($,o.loc,t,r)}a.need_uniforms_update=!1}$.depthMask(r.depth_mask),j&&(r.use_backface_culling?$.enable($.CULL_FACE):$.disable($.CULL_FACE)),y(r.textures),e.type==B.SKY||e.type==B.IRRADIANCE?(R(e,r,a),e.debug_render_calls+=6):e.type==B.ROUGHNESS_CONVOLUTION?(I(e,r,a),e.debug_render_calls+=30):(ne(r,t.va_frame),e.debug_render_calls++)}function h(e,t,r,a){var _=e.bufs_data;(p.dist(a,r.zsort_eye_last)>ce.alpha_sort_threshold*Math.min(r.bb_min_side,1)||t.force_zsort)&&(K.update_buffers_movable(_,r,t.world_tsr,a),p.copy(a,r.zsort_eye_last),t.force_zsort=!1)}function R(e,t,r){for(var a=e.camera,_=r.uniforms,n=a.color_attachment,o=n.w_texture,i=n.w_target,s=e.cube_view_matrices,c=0;c<6;c++){var E=Y(c);if(ce.clear_procedural_sky_hack){var l=$.TEXTURE_CUBE_MAP;$.bindTexture(l,o),$.texImage2D(E,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,V)}else $.uniformMatrix4fv(_.u_cube_view_matrix,!1,s[c]),$.uniform4fv(_.u_sky_tex_fac,e.sky_tex_fac),$.uniform3fv(_.u_sky_tex_color,e.sky_tex_color),$.uniform1f(_.u_sky_tex_dvar,e.sky_tex_default_value),$.uniform3fv(_.u_horizon_color,e.horizon_color),$.uniform3fv(_.u_zenith_color,e.zenith_color),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,E,o,0),ne(t,0);e.need_fog_update&&c!=J&&b(e,c)}ce.texture_lod_available&&($.bindTexture(i,o),$.generateMipmap(i),$.texParameteri(i,$.TEXTURE_MIN_FILTER,X.TF_LINEAR_MIPMAP_LINEAR)),$.bindFramebuffer($.FRAMEBUFFER,null)}function I(e,t,r){var a=e.camera,_=r.uniforms,n=a.color_attachment,o=n.w_texture,i=n.w_target,s=e.cube_view_matrices;ce.texture_lod_available&&($.activeTexture($.TEXTURE7),$.bindTexture(i,o),$.generateMipmap(i),$.texParameteri(i,$.TEXTURE_MIN_FILTER,X.TF_LINEAR_MIPMAP_LINEAR));for(var c=0;c<5;++c){var E=128*Math.pow(.5,c),l=128*Math.pow(.5,c);$.viewport(0,0,E,l);for(var T=c/4,u=0;u<6;u++){var d=Y(u);$.uniformMatrix4fv(_.u_cube_view_matrix,!1,s[u]),$.uniform1f(_.u_roughness,T),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,d,o,c),ne(t,0)}}}function b(e,t){var r=se;ce.clear_procedural_sky_hack?r.set(V):($.readPixels(191,191,1,1,$.RGBA,$.UNSIGNED_BYTE,r),255!=r[0]&&255!=r[1]&&255!=r[2]||$.readPixels(191,220,1,1,$.RGBA,$.UNSIGNED_BYTE,r));var a=r[0],_=r[1],n=r[2];a/=255,_/=255,n/=255,t===W?(e.cube_fog[3]=a,e.cube_fog[7]=_,e.cube_fog[11]=n):(e.cube_fog[4*t]=a,e.cube_fog[4*t+1]=_,e.cube_fog[4*t+2]=n)}function Y(e){switch(e){case 0:return $.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return $.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return $.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return $.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return $.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return $.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function L(e){var t=k.get_vertex_array_object(),r=e.attribute_setters,a=e.bufs_data,_=a.pointers;e.vaos.length=0;var n=1;for(var o in _)n=Math.max(n,_[o].frames);for(var i=0;i<n;i++){var s=t.createVertexArray();_e(s),a.ibo&&$.bindBuffer($.ELEMENT_ARRAY_BUFFER,a.ibo);for(var c=0;c<a.vbo_data.length;c++){$.bindBuffer($.ARRAY_BUFFER,a.vbo_data[c].vbo);for(var E=0;E<r.length;E++){var l=r[E];if(l.vbo_type==a.vbo_data[c].type){$.enableVertexAttribArray(l.loc);var T=l.base_offset+l.frame_length*i,u=l.gl_type!=$.FLOAT;$.vertexAttribPointer(l.loc,l.num_comp,l.gl_type,u,0,T),re(l.loc,l.divisor)}}}_e(null),e.vaos.push(s)}}function M(e){var t=e.uniforms,r=e.transient_uniform_setters,a=e.permanent_uniform_setters,_=e.transient_sc_uniform_setters,n=e.permanent_sc_uniform_setters;r.length=0,a.length=0,_.length=0,n.length=0;for(var o in t){var i=!1,s=null,c=null;switch(o){case"u_proj_matrix":case"u_proj_matrix_frag":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,a.proj_matrix)},i=!0;break;case"u_view_refl_matrix":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,a.view_refl_matrix)},i=!0;break;case"u_view_tsr":case"u_view_tsr_frag":s=function(e,t,r,a){a.reflection_plane?e.uniformMatrix3fv(t,!1,a.real_view_tsr):e.uniformMatrix3fv(t,!1,a.view_tsr)},i=!0;break;case"u_view_tsr_inverse":s=function(e,t,r,a){a.reflection_plane?e.uniformMatrix3fv(t,!1,a.real_view_tsr_inv):e.uniformMatrix3fv(t,!1,a.view_tsr_inv)},i=!0;break;case"u_shadow_cast_billboard_view_tsr":s=function(e,t,r,a){e.uniformMatrix3fv(t,!1,a.shadow_cast_billboard_view_tsr)},i=!0;break;case"u_view_proj_prev":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,a.prev_view_proj_matrix)},i=!0;break;case"u_view_proj_matrix":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,a.view_proj_matrix)},i=!0;break;case"u_view_proj_inverse":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,a.view_proj_inv_matrix)},i=!0;break;case"u_sky_vp_inverse":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,a.sky_vp_inv_matrix)},i=!0;break;case"u_camera_eye":case"u_camera_eye_frag":s=function(e,t,r,a){e.uniform3fv(t,P.j(a.world_tsr,oe))},i=!0;break;case"u_camera_quat":s=function(e,t,r,a){e.uniform4fv(t,P.g(a.world_tsr,ie))},i=!0;break;case"u_view_max_depth":s=function(e,t,r,a){e.uniform1f(t,a.far)},i=!0;break;case"u_camera_range":s=function(e,t,r,a){e.uniform2f(t,a.near,a.far)},i=!0;break;case"u_csm_center_dists":s=function(e,t,r,a){e.uniform4fv(t,a.csm_center_dists)};break;case"u_height":s=function(e,t,r,a){e.uniform1f(t,a.height)},i=!0;break;case"u_pcf_blur_radii":s=function(e,t,r,a){e.uniform4fv(t,a.pcf_blur_radii)};break;case"u_dof_dist":s=function(e,t,r,a){a.dof_on?e.uniform1f(t,a.dof_distance):e.uniform1f(t,0)},i=!0;break;case"u_dof_front_start":s=function(e,t,r,a){e.uniform1f(t,a.dof_front_start)},i=!0;break;case"u_dof_front_end":s=function(e,t,r,a){e.uniform1f(t,a.dof_front_end)},i=!0;break;case"u_dof_rear_start":s=function(e,t,r,a){e.uniform1f(t,a.dof_rear_start)},i=!0;break;case"u_dof_rear_end":s=function(e,t,r,a){e.uniform1f(t,a.dof_rear_end)},i=!0;break;case"u_dof_bokeh_intensity":s=function(e,t,r,a){e.uniform1f(t,a.dof_bokeh_intensity)},i=!0;break;case"u_camera_direction":s=function(e,t,r,a){e.uniform3fv(t,a.direction)},i=!0;break;case"u_cam_water_depth":s=function(e,t,r,a){e.uniform1f(t,r.cam_water_depth)},i=!0;break;case"u_fog_color_density":s=function(e,t,r,a){e.uniform4fv(t,r.fog_color_density)};break;case"u_fog_params":s=function(e,t,r,a){e.uniform4fv(t,r.fog_params)};break;case"u_underwater_fog_color_density":s=function(e,t,r,a){e.uniform4fv(t,r.water_fog_color_density)};break;case"u_bloom_key":s=function(e,t,r,a){e.uniform1f(t,r.bloom_key)};break;case"u_average_lum_val":s=function(e,t,r,a){e.uniform1f(t,r.average_luminance)};break;case"u_mipmap_1x1":s=function(e,t,r,a){e.uniform1f(t,r.last_mip_map_ind)};break;case"u_bloom_edge_lum":s=function(e,t,r,a){e.uniform1f(t,r.bloom_edge_lum)};break;case"u_time":s=function(e,t,r,a){e.uniform1f(t,r.time)},i=!0;break;case"u_wind":s=function(e,t,r,a){e.uniform3fv(t,r.wind)},i=!0;break;case"u_sky_tex_dvar":s=function(e,t,r,a){e.uniform1f(t,r.sky_tex_default_value)};break;case"u_sky_tex_fac":s=function(e,t,r,a){e.uniform4fv(t,r.sky_tex_fac)};break;case"u_sky_tex_color":s=function(e,t,r,a){e.uniform3fv(t,r.sky_tex_color)};break;case"u_horizon_color":s=function(e,t,r,a){e.uniform3fv(t,r.horizon_color)};break;case"u_zenith_color":s=function(e,t,r,a){e.uniform3fv(t,r.zenith_color)};break;case"u_environment_energy":s=function(e,t,r,a){e.uniform1f(t,r.environment_energy)};break;case"u_bsdf_cube_sky_dim":s=function(e,t,r,a){e.uniform1f(t,r.bsdf_cube_sky_dim)},i=!0;break;case"u_sky_color":s=function(e,t,r,a){e.uniform3fv(t,r.sky_color)};break;case"u_rayleigh_brightness":s=function(e,t,r,a){e.uniform1f(t,r.rayleigh_brightness)};break;case"u_mie_brightness":s=function(e,t,r,a){e.uniform1f(t,r.mie_brightness)};break;case"u_spot_brightness":s=function(e,t,r,a){e.uniform1f(t,r.spot_brightness)};break;case"u_scatter_strength":s=function(e,t,r,a){e.uniform1f(t,r.scatter_strength)};break;case"u_rayleigh_strength":s=function(e,t,r,a){e.uniform1f(t,r.rayleigh_strength)};break;case"u_mie_strength":s=function(e,t,r,a){e.uniform1f(t,r.mie_strength)};break;case"u_rayleigh_collection_power":s=function(e,t,r,a){e.uniform1f(t,r.rayleigh_collection_power)};break;case"u_mie_collection_power":s=function(e,t,r,a){e.uniform1f(t,r.mie_collection_power)};break;case"u_mie_distribution":s=function(e,t,r,a){e.uniform1f(t,r.mie_distribution)};break;case"u_light_positions":s=function(e,t,r,a){e.uniform4fv(t,r.light_positions)};break;case"u_light_directions":s=function(e,t,r,a){e.uniform3fv(t,r.light_directions)};break;case"u_light_color_intensities":s=function(e,t,r,a){e.uniform4fv(t,r.light_color_intensities)};break;case"u_sun_quaternion":s=function(e,t,r,a){e.uniform4fv(t,r.sun_quaternion)};break;case"u_sun_intensity":s=function(e,t,r,a){e.uniform3fv(t,r.sun_intensity)};break;case"u_sun_direction":s=function(e,t,r,a){e.uniform3fv(t,r.sun_direction)};break;case"u_debug_view_mode":s=function(e,t,r,a){e.uniform1i(t,r.debug_view_mode)};break;case"u_debug_colors_seed":s=function(e,t,r,a){e.uniform1f(t,r.debug_colors_seed)};break;case"u_debug_render_time_threshold":s=function(e,t,r,a){e.uniform1f(t,r.debug_render_time_threshold)};break;case"u_subpixel_jitter":s=function(e,t,r,a){e.uniform2fv(t,r.jitter_projection_space)},i=!0;break;case"u_subsample_indices":s=function(e,t,r,a){e.uniform4fv(t,r.jitter_subsample_ind)},i=!0;break;case"u_radial_blur_step":s=function(e,t,r,a){e.uniform1f(t,r.radial_blur_step)};break;case"u_god_rays_intensity":s=function(e,t,r,a){e.uniform1f(t,r.god_rays_intensity)};break;case"u_ssao_radius_increase":s=function(e,t,r,a){e.uniform1f(t,r.ssao_radius_increase)};break;case"u_ssao_blur_discard_value":s=function(e,t,r,a){e.uniform1f(t,r.ssao_blur_discard_value)},i=!0;break;case"u_ssao_influence":s=function(e,t,r,a){e.uniform1f(t,r.ssao_influence)};break;case"u_ssao_dist_factor":s=function(e,t,r,a){e.uniform1f(t,r.ssao_dist_factor)};break;case"u_texel_size":s=function(e,t,r,a){e.uniform2fv(t,r.texel_size)},i=!0;break;case"u_normal_offset":s=function(e,t,r,a){e.uniform1f(t,r.self_shadow_normal_offset)};break;case"u_v_light_ts":s=function(e,t,r,a){e.uniform4fv(t,r.v_light_ts)},i=!0;break;case"u_v_light_r":s=function(e,t,r,a){e.uniform4fv(t,r.v_light_r)},i=!0;break;case"u_v_light_tsr":s=function(e,t,r,a){e.uniformMatrix3fv(t,!1,r.v_light_tsr)},i=!0;break;case"u_p_light_matrix0":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,r.p_light_matrix[0])},i=!0;break;case"u_p_light_matrix1":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,r.p_light_matrix[1])},i=!0;break;case"u_p_light_matrix2":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,r.p_light_matrix[2])},i=!0;break;case"u_p_light_matrix3":s=function(e,t,r,a){e.uniformMatrix4fv(t,!1,r.p_light_matrix[3])},i=!0;break;case"u_outline_color":s=function(e,t,r,a){e.uniform3fv(t,r.outline_color)};break;case"u_draw_outline":s=function(e,t,r,a){e.uniform1f(t,r.draw_outline_flag)},i=!0;break;case"u_glow_mask_small_coeff":s=function(e,t,r,a){e.uniform1f(t,r.small_glow_mask_coeff)},i=!0;break;case"u_glow_mask_large_coeff":s=function(e,t,r,a){e.uniform1f(t,r.large_glow_mask_coeff)},i=!0;break;case"u_brightness":s=function(e,t,r,a){e.uniform1f(t,r.brightness)};break;case"u_contrast":s=function(e,t,r,a){e.uniform1f(t,r.contrast)};break;case"u_exposure":s=function(e,t,r,a){e.uniform1f(t,r.exposure)};break;case"u_saturation":s=function(e,t,r,a){e.uniform1f(t,r.saturation)};break;case"u_enable_hmd_stereo":s=function(e,t,r,a){e.uniform1i(t,r.enable_hmd_stereo)};break;case"u_distortion_params":s=function(e,t,r,a){e.uniform4fv(t,r.distortion_params)};break;case"u_chromatic_aberration_coefs":s=function(e,t,r,a){e.uniform4fv(t,r.chromatic_aberration_coefs)};break;case"u_motion_blur_exp":s=function(e,t,r,a){e.uniform1f(t,r.motion_blur_exp)},i=!0;break;case"u_motion_blur_decay_threshold":s=function(e,t,r,a){e.uniform1f(t,r.mb_decay_threshold)},i=!0;break;case"u_model_tsr":c=function(e,t,r,a){e.uniformMatrix3fv(t,!1,r.world_tsr)},i=!0;break;case"u_model_tsr_inverse":c=function(e,t,r,a){e.uniformMatrix3fv(t,!1,r.world_tsr_inv)},i=!0;break;case"u_transb":c=function(e,t,r,a){e.uniform4fv(t,r.trans_before)},i=!0;break;case"u_transa":c=function(e,t,r,a){e.uniform4fv(t,r.trans_after)},i=!0;break;case"u_arm_rel_trans":c=function(e,t,r,a){e.uniform4fv(t,r.arm_rel_trans)},i=!0;break;case"u_arm_rel_quat":c=function(e,t,r,a){e.uniform4fv(t,r.arm_rel_quat)},i=!0;break;case"u_quat":c=function(e,t,r,a){e.uniform4fv(t,P.g(r.world_tsr,ie))},i=!0;break;case"u_quatsb":c=function(e,t,r,a){e.uniform4fv(t,r.quats_before)},i=!0;break;case"u_quatsa":c=function(e,t,r,a){e.uniform4fv(t,r.quats_after)},i=!0;break;case"u_frame_factor":c=function(e,t,r,a){e.uniform1f(t,r.frame_factor)},i=!0;break;case"au_center_pos":c=function(e,t,r,a){e.uniform3fv(t,r.center_pos)},i=!0;break;case"au_wind_bending_amp":c=function(e,t,r,a){e.uniform1f(t,r.wind_bending_amp)},i=!0;break;case"au_wind_bending_freq":c=function(e,t,r,a){e.uniform1f(t,r.wind_bending_freq)},i=!0;break;case"au_detail_bending_freq":c=function(e,t,r,a){e.uniform1f(t,r.detail_bending_freq)},i=!0;break;case"au_detail_bending_amp":c=function(e,t,r,a){e.uniform1f(t,r.detail_bending_amp)},i=!0;break;case"au_branch_bending_amp":c=function(e,t,r,a){e.uniform1f(t,r.branch_bending_amp)},i=!0;break;case"u_node_values":c=function(e,t,r,a){e.uniform4fv(t,a.node_values)},i=!0;break;case"u_node_rgbs":c=function(e,t,r,a){e.uniform3fv(t,a.node_rgbs)},i=!0;break;case"u_lod_coverage":c=function(e,t,r,a){e.uniform1f(t,a.lod_settings.coverage)},i=!0;break;case"u_lod_cmp_logic":c=function(e,t,r,a){e.uniform1f(t,a.lod_settings.cmp_logic)},i=!0;break;case"u_diffuse_color":c=function(e,t,r,a){e.uniform4fv(t,a.diffuse_color)},i=!0;break;case"u_diffuse_intensity":c=function(e,t,r,a){e.uniform1f(t,a.diffuse_intensity)},i=!0;break;case"u_diffuse_params":c=function(e,t,r,a){e.uniform2fv(t,a.diffuse_params)},i=!0;break;case"u_emit":c=function(e,t,r,a){e.uniform1f(t,a.emit)},i=!0;break;case"u_ambient":c=function(e,t,r,a){e.uniform1f(t,a.ambient)},i=!0;break;case"u_specular_color":c=function(e,t,r,a){e.uniform3fv(t,a.specular_color)},i=!0;break;case"u_specular_alpha":c=function(e,t,r,a){e.uniform1f(t,a.specular_alpha)},i=!0;break;case"u_specular_params":c=function(e,t,r,a){e.uniform3fv(t,a.specular_params)},i=!0;break;case"u_reflect_factor":c=function(e,t,r,a){e.uniform1f(t,a.reflect_factor)},i=!0;break;case"u_mirror_factor":c=function(e,t,r,a){e.uniform1f(t,a.mirror_factor)},i=!0;break;case"u_grass_map_dim":c=function(e,t,r,a){e.uniform3fv(t,a.grass_map_dim)},i=!0;break;case"u_grass_size":c=function(e,t,r,a){e.uniform1f(t,a.grass_size)},i=!0;break;case"u_scale_threshold":c=function(e,t,r,a){e.uniform1f(t,a.grass_scale_threshold)},i=!0;break;case"u_cube_fog":c=function(e,t,r,a){e.uniformMatrix4fv(t,!1,a.cube_fog)};break;case"u_jitter_amp":c=function(e,t,r,a){e.uniform1f(t,a.jitter_amp)},i=!0;break;case"u_jitter_freq":c=function(e,t,r,a){e.uniform1f(t,a.jitter_freq)},i=!0;break;case"u_wireframe_edge_color":c=function(e,t,r,a){e.uniform3fv(t,a.wireframe_edge_color)};break;case"u_cluster_id":c=function(e,t,r,a){e.uniform1f(t,a.cluster_id)},i=!0;break;case"u_batch_debug_id_color":c=function(e,t,r,a){e.uniform1f(t,a.debug_id_color)},i=!0;break;case"u_batch_debug_main_render_time":c=function(e,t,r,a){e.uniform1f(t,a.debug_main_batch_render_time)},i=!0;break;case"u_refr_bump":c=function(e,t,r,a){e.uniform1f(t,a.refr_bump)},i=!0;break;case"u_line_width":c=function(e,t,r,a){e.uniform1f(t,a.line_width)},i=!0;break;case"u_lamp_light_positions":c=function(e,t,r,a){e.uniform3fv(t,a.lamp_light_positions)};break;case"u_lamp_light_directions":c=function(e,t,r,a){e.uniform3fv(t,a.lamp_light_directions)};break;case"u_lamp_light_color_intensities":c=function(e,t,r,a){e.uniform3fv(t,a.lamp_light_color_intensities)};break;case"u_halo_size":c=function(e,t,r,a){e.uniform1f(t,a.halo_size)},i=!0;break;case"u_halo_hardness":c=function(e,t,r,a){e.uniform1f(t,a.halo_hardness)},i=!0;break;case"u_halo_rings_color":c=function(e,t,r,a){e.uniform3fv(t,a.halo_rings_color)},i=!0;break;case"u_halo_lines_color":c=function(e,t,r,a){e.uniform3fv(t,a.halo_lines_color)},i=!0;break;case"u_halo_stars_blend":c=function(e,t,r,a){e.uniform1f(t,a.halo_stars_blend)},i=!0;break;case"u_halo_stars_height":c=function(e,t,r,a){e.uniform1f(t,a.halo_stars_height)},i=!0;break;case"u_fresnel_params":c=function(e,t,r,a){e.uniform2fv(t,a.fresnel_params)},i=!0;break;case"u_texture_scale":c=function(e,t,r,a){e.uniform3fv(t,a.texture_scale)},i=!0;break;case"u_parallax_scale":c=function(e,t,r,a){e.uniform1f(t,a.parallax_scale)},i=!0;break;case"u_color_id":c=function(e,t,r,a){e.uniform3fv(t,r.color_id)},i=!0;break;case"u_diffuse_color_factor":c=function(e,t,r,a){e.uniform1f(t,a.diffuse_color_factor)},i=!0;break;case"u_alpha_factor":c=function(e,t,r,a){e.uniform1f(t,a.alpha_factor)},i=!0;break;case"u_specular_color_factor":c=function(e,t,r,a){e.uniform1f(t,a.specular_color_factor)},i=!0;break;case"u_normal_factor":c=function(e,t,r,a){e.uniform1f(t,a.normal_factor)},i=!0;break;case"u_normalmap0_scale":c=function(e,t,r,a){e.uniform2fv(t,a.normalmap_scales[0])},i=!0;break;case"u_normalmap1_scale":c=function(e,t,r,a){e.uniform2fv(t,a.normalmap_scales[1])},i=!0;break;case"u_normalmap2_scale":c=function(e,t,r,a){e.uniform2fv(t,a.normalmap_scales[2])},i=!0;break;case"u_normalmap3_scale":c=function(e,t,r,a){e.uniform2fv(t,a.normalmap_scales[3])},i=!0;break;case"u_foam_factor":c=function(e,t,r,a){e.uniform1f(t,a.foam_factor)},i=!0;break;case"u_foam_uv_freq":c=function(e,t,r,a){e.uniform2fv(t,a.foam_uv_freq)},i=!0;break;case"u_foam_mag":c=function(e,t,r,a){e.uniform2fv(t,a.foam_mag)},i=!0;break;case"u_foam_scale":c=function(e,t,r,a){e.uniform2fv(t,a.foam_scale)},i=!0;break;case"u_water_norm_uv_velocity":c=function(e,t,r,a){e.uniform1f(t,a.water_norm_uv_velocity)},i=!0;break;case"u_shallow_water_col":c=function(e,t,r,a){e.uniform3fv(t,a.shallow_water_col)},i=!0;break;case"u_shore_water_col":c=function(e,t,r,a){e.uniform3fv(t,a.shore_water_col)},i=!0;break;case"u_water_shallow_col_fac":c=function(e,t,r,a){e.uniform1f(t,a.shallow_water_col_fac)},i=!0;break;case"u_water_shore_col_fac":c=function(e,t,r,a){e.uniform1f(t,a.shore_water_col_fac)},i=!0;break;case"u_p_length":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.time_length)},i=!0;break;case"u_p_cyclic":c=function(e,t,r,a){e.uniform1i(t,a.particles_data.cyclic)},i=!0;break;case"u_p_max_lifetime":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.lifetime)},i=!0;break;case"u_p_fade_in":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.fade_in)},i=!0;break;case"u_p_fade_out":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.fade_out)},i=!0;break;case"u_p_size":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.size)},i=!0;break;case"u_p_alpha_start":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.alpha_start)},i=!0;break;case"u_p_alpha_end":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.alpha_end)},i=!0;break;case"u_p_nfactor":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.nfactor)},i=!0;break;case"u_p_gravity":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.gravity)},i=!0;break;case"u_p_mass":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.mass)},i=!0;break;case"u_p_color_ramp":c=function(e,t,r,a){e.uniform4fv(t,a.particles_data.color_ramp)},i=!0;break;case"u_p_wind_fac":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.wind_factor)},i=!0;break;case"u_p_time":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.time)},i=!0;break;case"u_p_tilt":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.tilt)},i=!0;break;case"u_p_tilt_rand":c=function(e,t,r,a){e.uniform1f(t,a.particles_data.tilt_rand)},i=!0;break;case"u_position":c=function(e,t,r,a){e.uniform3fv(t,a.anchor_positions)},i=!0;break;case"u_va_frame_factor":c=function(e,t,r,a){e.uniform1f(t,r.va_frame_factor)},i=!0;break;case"u_refl_plane":c=function(e,t,r,a){e.uniform4fv(t,r.reflection_plane)},i=!0;break;case"u_outline_intensity":c=function(e,t,r,a){e.uniform1f(t,r.outline_intensity)},i=!0;break;case"u_obj_info":c=function(e,t,r,a){e.uniform3fv(t,a.obj_info_params)},i=!0}if(c){var E={name:o,fun:c,loc:t[o]};i?r.push(E):a.push(E)}if(s){var E={name:o,fun:s,loc:t[o]};i?_.push(E):n.push(E)}}if(a.length||n.length){var l=e.permanent_uniform_setters_table;for(var T in l)delete l[T];for(var T=0;T<a.length;T++){var E=a[T];l[E.name]=E}for(var T=0;T<n.length;T++){var E=n[T];l[E.name]=E}}else e.no_permanent_uniforms=!0}function y(e){for(var t=$,r=0;r<e.length;r++){var a=e[r];t.activeTexture(t.TEXTURE0+r),t.bindTexture(a.w_target,a.w_texture),a.use_mipmap&&t.generateMipmap(a.w_target)}}function x(e,t,r,a,_,n){return $.bindFramebuffer($.FRAMEBUFFER,e),$.readPixels(t,r,a,_,$.RGBA,$.UNSIGNED_BYTE,n),$.bindFramebuffer($.FRAMEBUFFER,null),n}var U=Object(n.a)(e),w=Object(o.a)(e),C=Object(i.a)(e),D=Object(s.a)(e),F=Object(c.a)(e),G=Object(E.a)(e),k=Object(l.a)(e),K=Object(T.a)(e),B=Object(d.a)(e),X=Object(f.a)(e),j=!0,H=[1,0,0,1],Q=[1,1,1,1],z=[0,0,0,1],q=[0,0,0,0],V=new Uint8Array([91.8,142.8,.96*255,255]),W=4,J=5,Z=(new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([1,1,1,0]),new Float32Array([2,2,2,0]),15),$=null,ee=0,te=null,re=null,ae=null,_e=null,ne=null,oe=new Float32Array(3),ie=u.create(),se=new Uint8Array(4),ce=C.defaults;t.setup_context=function(e){var t=ce.background_color;e.clearColor(t[0],t[1],t[2],t[3]),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),j?(e.enable(e.CULL_FACE),e.frontFace(e.CCW),e.cullFace(e.BACK)):e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),$=e},t.draw=function(e){e.do_render&&!e.force_do_not_render&&(e.type==B.RESOLVE?(G.start_subs(e),a(e),G.stop_subs(e),F.gl("draw resolve")):e.type==B.COPY?(G.start_subs(e),_(e),G.stop_subs(e),F.gl("draw copy")):(G.start_subs(e),O(e),e.type==B.MAIN_CUBE_REFLECT||e.type==B.MAIN_CUBE_REFLECT_BLEND?r(e):v(e),G.stop_subs(e),F.gl("draw subscene: "+B.subs_label(e)),e.type==B.BRDF&&$.bindFramebuffer($.FRAMEBUFFER,null)))},t.clear=function(e){if(e){var t=e.camera;$.bindFramebuffer($.FRAMEBUFFER,t.framebuffer)}else{var r=ce.background_color;if(r[0]===q[0]&&r[1]===q[1]&&r[2]===q[2]&&r[3]===q[3])return}N(e)},t.assign_attribute_setters=function(e){var t=e.attribute_setters;t.length=0;var r=e.bufs_data,a=e.shader,_=r.pointers,n=a.attributes;for(var o in n){var i=_[o],s=K.get_vbo_type_by_attr_name(o),c=K.get_gl_type_by_attr_name(o),E=K.get_type_size_by_attr_name(o),l={vbo_type:s,gl_type:c,loc:n[o],base_offset:i.offset*E,frame_length:i.frames>1?i.length*E:0,num_comp:i.num_comp,divisor:i.divisor};t.push(l)}if("DEBUG"==Object(S.d)())for(var o in _){var s=K.get_vbo_type_by_attr_name(o),T=K.search_vbo_index_by_type(r.vbo_data,s),u=r.vbo_data[T],d=e.shaders_info.vert+" | "+e.shaders_info.frag,f=_[o].length*_[o].frames*K.get_type_size_by_attr_name(o);D.fill_vbo_garbage_info(u.debug_id,d,o,f,o in n)}ce.allow_vao_ext&&L(e)},t.assign_vao=L,t.cleanup_vao=function(e){for(var t=k.get_vertex_array_object(),r=0;r<e.vaos.length;r++)t.deleteVertexArray(e.vaos[r]);e.vaos.length=0},t.clone_attribute_setters=function(e){for(var t=[],r=0;r<e.length;r++){var a=e[r],_={vbo_type:a.vbo_type,gl_type:a.gl_type,loc:a.loc,base_offset:a.base_offset,frame_length:a.frame_length,num_comp:a.num_comp,divisor:a.divisor};t.push(_)}return t},t.assign_uniform_setters=M,t.assign_texture_uniforms=function(e){var t=e.shader,r=e.textures,a=e.texture_names;$.useProgram(t.program);for(var _=0;_<r.length;_++){var n=a[_];$.uniform1i(t.uniforms[n],_)}},t.read_pixels=x,t.update_batch_permanent_uniform=function(e,t){var r=e.shader;if(!r.no_permanent_uniforms){$.useProgram(r.program),r.permanent_uniform_setters.length||M(r);var a=r.permanent_uniform_setters_table[t];a.fun($,a.loc,null,e)}},t.render_target_create=function(e,t){var r=$.createFramebuffer();if($.bindFramebuffer($.FRAMEBUFFER,r),X.is_renderbuffer(e)){var a=e.w_renderbuffer;$.framebufferRenderbuffer($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.RENDERBUFFER,a)}else if(X.is_texture(e)){var _=e,n=_.w_texture,o=_.w_target==$.TEXTURE_CUBE_MAP?$.TEXTURE_CUBE_MAP_NEGATIVE_Z:_.w_target;$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,o,n,0)}if(X.is_renderbuffer(t)){var a=t.w_renderbuffer;$.framebufferRenderbuffer($.FRAMEBUFFER,$.DEPTH_ATTACHMENT,$.RENDERBUFFER,a)}else if(X.is_texture(t)){var _=t,n=_.w_texture,o=_.w_target;$.framebufferTexture2D($.FRAMEBUFFER,$.DEPTH_ATTACHMENT,o,n,0)}return F.bound_fb(),$.bindFramebuffer($.FRAMEBUFFER,null),r},t.render_target_cleanup=function(e,t,r,a,_){if(null==e)return $.bindFramebuffer($.FRAMEBUFFER,e),$.viewport(0,0,a,_),void $.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT);X.is_renderbuffer(t)?$.deleteRenderbuffer(t.w_renderbuffer):X.is_texture(t)&&$.deleteTexture(t.w_texture),X.is_renderbuffer(r)?$.deleteRenderbuffer(r.w_renderbuffer):X.is_texture(r)&&$.deleteTexture(r.w_texture),$.deleteFramebuffer(e)},t.increment_subpixel_index=function(){ee=(ee+1)%2},t.draw_resized_cubemap_texture=function(e,t,r,a,_,n){var o=e.w_texture;$.viewport(0,0,r,r),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,t,o,0);var i=U.create_postprocessing_batch("FLIP_CUBEMAP_COORDS"),s=i.shader;$.activeTexture($.TEXTURE0),$.bindTexture($.TEXTURE_2D,_);var c=0,E=0;r!=a&&(c=1/(6*a),E=1/(4*a)),$.uniform1i(s.uniforms.u_tex_number,n),$.uniform2fv(s.uniforms.u_delta,[c,E]),$.useProgram(s.program),ne(i,0),$.bindTexture($.TEXTURE_2D,null)},t.draw_resized_texture=function(e,t,r,a,_,n){$.bindFramebuffer($.FRAMEBUFFER,a);var o=e.w_texture,i=e.w_target;$.bindTexture(i,o),$.viewport(0,0,t,r),$.texImage2D(i,0,$.RGBA,t,r,0,$.RGBA,$.UNSIGNED_BYTE,null),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,i,o,0);var s=U.create_postprocessing_batch(n),c=s.shader;$.activeTexture($.TEXTURE0),$.bindTexture(i,_),$.useProgram(c.program),ne(s,0),$.bindFramebuffer($.FRAMEBUFFER,null),$.bindTexture(i,null)},t.cleanup=function(){ee=0},t.set_draw_methods=function(){var e=k.get_instanced_arrays(),t=k.get_vertex_array_object();ce.allow_instanced_arrays_ext=!!e,ce.allow_vao_ext=!!t,e?(te=function(t,r,a,_){e.drawElementsInstanced($.TRIANGLES,t,r,a,_)},re=function(t,r){e.vertexAttribDivisor(t,r)},ae=function(t,r,a){e.drawArraysInstanced($.TRIANGLES,t,r,a)}):(te=function(e,t,r){$.drawElements($.TRIANGLES,e,t,r)},re=function(e,t){},ae=function(e,t,r){$.drawArrays($.TRIANGLES,e,t)}),t?(_e=function(e){t.bindVertexArray(e)},ne=function(e,t){var r=e.bufs_data;_e(e.vaos[t]),r.ibo?te(r.count,r.ibo_type,0,r.instance_count):ae(0,r.count,r.instance_count),_e(null)}):ne=function(e,t){for(var r=e.bufs_data,a=e.attribute_setters,_=0;_<r.vbo_data.length;_++){$.bindBuffer($.ARRAY_BUFFER,r.vbo_data[_].vbo);for(var n=0;n<a.length;n++){var o=a[n];if(o.vbo_type==r.vbo_data[_].type){$.enableVertexAttribArray(o.loc);var i=o.base_offset+o.frame_length*t,s=o.gl_type!=$.FLOAT;$.vertexAttribPointer(o.loc,o.num_comp,o.gl_type,s,0,i),re(o.loc,o.divisor)}}}r.ibo?($.bindBuffer($.ELEMENT_ARRAY_BUFFER,r.ibo),te(r.count,r.ibo_type,0,r.instance_count)):ae(0,r.count,r.instance_count);for(var _=0;_<a.length;_++){var o=a[_];$.disableVertexAttribArray(o.loc)}}},t.reset=function(){$=null,te=null,re=null,ae=null,_e=null}}var _=r(0),n=r(16),o=r(14),i=r(4),s=r(78),c=r(48),E=r(79),l=r(29),T=r(20),u=r(8),d=r(11),f=r(17),P=r(6),A=r(2),S=r(40),p=r(3),v=Object(_.a)("__renderer",a);t.a=v},function(e,t,r){"use strict";function a(e,t){function r(){var e=window.AudioContext||window.webkitAudioContext;if(e){try{var t=new e}catch(e){return x.error('Unable to initialize AudioContext: "'+e+'". The audio is disabled.'),null}return t.createGain?t:(x.warn("deprecated WebAudio implementation"),null)}return x.warn("WebAudio is not supported"),null}function a(){return!!window.MediaElementAudioSourceNode||(x.warn("MediaElementAudioSourceNode not found"),!1)}function _(e,t){if(e.active>-1&&m(e.speakers[e.active]),-1==e.active&&e.random)var r=Math.round(Math.random()*(e.speakers.length-1));else if(e.random)var a=1+Math.round(Math.random()*(e.speakers.length-2)),r=(e.active+a)%e.speakers.length;else var r=(e.active+1)%e.speakers.length;d(e.speakers[r]),e.active=r,e.active_start_time=t}function u(e,t,r){var a=e.sfx;if("NONE"!=a.behavior){var _=a.loop,n=a.pitch;if(a.src&&(_||r>=0)){a.base_seed=Math.floor(5e4*Math.random());var o=V.currentTime+t;o=Math.max(0,o),a.start_time=o,a.state=F;var i=W._sfx;if("POSITIONAL"==a.behavior&&"none"==i.distance_model&&(a.behavior="BACKGROUND_SOUND"),ee(e,W._sfx),"POSITIONAL"==a.behavior||"BACKGROUND_SOUND"==a.behavior){var s=V.createBufferSource();if(s.buffer=a.src,s.playbackRate.value=n,_){if(a.source_node&&a.source_node.disconnect(),a.source_node2&&a.source_node2.disconnect(),s.loop=!0,s.loopStart=a.loop_start,s.loopEnd=a.loop_end,a.loop_end){var c=V.createBufferSource();c.buffer=a.src,c.playbackRate.value=n,a.source_node2=c,c.connect(a.proc_chain_in)}s.start(o),a.duration=0}else{var E=s.buffer?s.buffer.duration:0;if(r>E){var l=o+r+a.fade_out;s.loop=!0,s.start(o),s.stop(l),a.duration=r}else s.loop=!1,s.start(o),a.duration=E}s.connect(a.proc_chain_in),a.source_node=s,f(a),P(a),A(a)}else if("BACKGROUND_MUSIC"==a.behavior){U.clear_timeout(a.bgm_start_timeout),U.clear_timeout(a.bgm_stop_timeout);var T=function(){p(e)};if(0==t?T():a.bgm_start_timeout=U.set_timeout(T,1e3*t),_)a.duration=0;else{var u=L(e);a.duration=u}}S(a,o)}}}function d(e){var t=e.sfx,r=t.duration;u(e,t.delay+t.delay_random*Math.random(),r)}function f(e){var t=e.source_node2||e.source_node;l._17(t.onended)&&(t.onended=function(){e.state=K})}function P(e){e.volume_random&&e.rand_gain_node.gain.cancelScheduledValues(e.start_time),e.pitch_random&&(e.source_node.playbackRate.cancelScheduledValues(e.start_time),e.source_node2&&e.source_node2.playbackRate.cancelScheduledValues(e.start_time)),e.vp_rand_end_time=e.start_time}function A(e){if(e.volume_random||e.pitch_random){var t=e.rand_gain_node,r=e.source_node,a=r.buffer?r.buffer.duration:0;if(a){var _=e.start_time;Z[0]=e.base_seed;for(var n=0;n<X;){var o=e.pitch+e.pitch_random*l._40(Z);if(_>=e.vp_rand_end_time){if(e.volume_random){var i=1-l.M(e.volume_random,0,1)*Math.random();t.gain.setTargetAtTime(i,_,B)}e.pitch_random&&(r.playbackRate.setTargetAtTime(o,_,B),e.source_node2&&e.source_node2.playbackRate.setTargetAtTime(o,_,B)),n++}_+=a/o}e.vp_rand_end_time=_-.001}}}function S(e,t){if(e.fade_in||e.fade_out){var r=e.fade_gain_node;r.gain.cancelScheduledValues(t),e.fade_in?(r.gain.setTargetAtTime(0,t,B),r.gain.linearRampToValueAtTime(1,t+e.fade_in)):r.gain.setTargetAtTime(1,t,B),e.fade_out&&!e.loop&&(r.gain.setTargetAtTime(1,t+e.duration,B),r.gain.linearRampToValueAtTime(0,t+e.duration+e.fade_out))}}function p(e){var t=e.sfx,r=t.src;r&&(r.volume=1,r.loop=t.loop,t.source_node=t.source_node||V.createMediaElementSource(r),t.source_node.connect(t.proc_chain_in),t.state==F&&(r.currentTime&&(r.currentTime=0),r.play()))}function v(e){var t=e.sfx,r=t.src;r&&(r.currentTime&&(r.currentTime=0),r.pause())}function m(e){"SPEAKER"!=e.type&&M.panic("Wrong object type");var t=e.sfx;if(t.state==K)return void(t.state=G);if(t.state==F||t.state==k){var r=t.fade_gain_node,a=V.currentTime;if(t.fade_out&&(r.gain.setTargetAtTime(r.gain.value,a,B),r.gain.linearRampToValueAtTime(0,a+t.fade_out,B)),"BACKGROUND_MUSIC"==t.behavior){if(t.src){var _=function(){v(e)};U.clear_timeout(t.bgm_start_timeout),U.clear_timeout(t.bgm_stop_timeout),t.bgm_stop_timeout=U.set_timeout(_,1e3*t.fade_out)}}else{var n=t.source_node;n.onended=function(){},t.duration<n.buffer.duration?t.fade_out&&t.state==F?n.stop(a+t.fade_out):t.state==F&&(n.stop(0),n.disconnect()):n.disconnect(),t.start_time=0,t.pause_time=0,t.buf_offset=0}t.state=G}}function O(e){return e.sfx.state==F}function N(e){var t=e.sfx;if(t.state==F){var r=V.currentTime;if(t.pause_time=r,"BACKGROUND_MUSIC"==t.behavior){var a=t.src;a&&a.pause()}else r>t.start_time?t.buf_offset=g(t,r):t.buf_offset=0,t.source_node.onended=function(){},t.source_node.stop(0),t.source_node.disconnect(),P(t);t.state=k}}function g(e,t){Z[0]=e.base_seed;for(var r,a=e.source_node.buffer.duration,_=e.start_time;_<t;)r=e.pitch+e.pitch_random*l._40(Z),_+=a/r;return(a/r-(_-t))*r}function h(e){var t=e.sfx;if(t.state==k){var r=V.currentTime;if(t.start_time+=r-t.pause_time,"BACKGROUND_MUSIC"==t.behavior){t.src.play()}else{R(e),t.vp_rand_end_time=r;var a=t.source_node;f(t),a.start(t.start_time,t.buf_offset),A(t)}S(t,t.start_time),t.state=F}}function R(e){var t=e.sfx,r=V.createBufferSource();if(r.loop=t.source_node.loop,r.loopStart=t.source_node.loopStart,r.loopEnd=t.source_node.loopEnd,r.buffer=t.source_node.buffer,r.playbackRate.value=t.source_node.playbackRate.value,r.connect(t.proc_chain_in),t.source_node=r,t.source_node2){var a=V.createBufferSource();a.loop=t.source_node2.loop,a.buffer=t.source_node2.buffer,a.playbackRate.value=t.source_node2.playbackRate.value,a.connect(t.proc_chain_in),t.source_node2=a}}function I(e,t,r){var a=1,_=t.doppler_factor;if(_>0){var n=t.speed_of_sound;if(0!=T.dot(e.velocity,e.velocity)||0!=T.dot(t.listener_velocity,t.listener_velocity)){var o=T.subtract(e.last_position,t.listener_last_eye,j),i=T.length(o),s=T.dot(o,t.listener_velocity)/i,c=T.dot(o,e.velocity)/i;s=-s,c=-c;var E=n/_;s=Math.min(s,E),c=Math.min(c,E),a=(n-_*s)/(n-_*c),isFinite(a)||(a=0),a=Math.min(a,16),a=Math.max(a,.125),a=l._51(a,e.last_doppler_shift,r,D),e.source_node.playbackRate.value=a,e.last_doppler_shift=a}}}function b(e){var t=e.sfx;return!(!t||t.state!=F&&t.state!=k&&t.state!=G&&t.state!=K)}function Y(e){return e.muted?0:e.volume}function L(e){var t=e.sfx;if("POSITIONAL"==t.behavior||"BACKGROUND_SOUND"==t.behavior){var r=t.src;return r?r.duration:0}var a=t.src;return a?a.duration:0}var M=Object(n.a)(e),y=Object(o.a)(e),x=Object(i.a)(e),U=Object(c.a)(e),w=y.defaults,C=y.sfx,D=.3,F=20,G=30,k=40,K=50,B=.015,X=5,j=new Float32Array(3),H=new Float32Array(3),Q=s.create(),z=[],q=[],V=null,W=null,J=[],Z=[1],$=null;t.AST_NONE=10,t.AST_ARRAY_BUFFER=20,t.AST_HTML_ELEMENT=30,t.create_sfx=function(){return{uuid:-1,filepath:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1e4,cone_angle_inner:360,cone_angle_outer:360,cone_volume_outer:1,autoplay:!1,cyclic:!1,loop:!1,loop_start:0,loop_end:0,delay:0,delay_random:0,volume_random:0,pitch_random:0,fade_in:0,fade_out:0,start_time:0,pause_time:0,buf_offset:0,duration:0,vp_rand_end_time:0,base_seed:1,src:null,state:10,last_position:new Float32Array(3),velocity:new Float32Array(3),enable_doppler:!1,last_doppler_shift:1,bgm_start_timeout:-1,bgm_stop_timeout:-1,duck_time:0,proc_chain_in:null,source_node:null,source_node2:null,panner_node:null,filter_node:null,gain_node:null,fade_gain_node:null,rand_gain_node:null,update_counter:0}},t.init=function(){var e=document.createElement("audio"),t=document.createElement("video");e.canPlayType&&(""!=e.canPlayType("audio/ogg")&&(z.push("ogg"),z.push("ogv"),z.push("oga")),""!=e.canPlayType("audio/mpeg")&&z.push("mp3"),""!=e.canPlayType("audio/mp4")&&(z.push("mp4"),z.push("m4v"),z.push("m4a")),""!=e.canPlayType("audio/webm")&&z.push("webm")),t.canPlayType&&(""!=t.canPlayType("video/ogg")&&(q.push("ogv"),q.push("ogg"),q.push("oga")),""!=t.canPlayType("video/mp4")&&(q.push("m4v"),q.push("mp4")),""!=t.canPlayType("video/webm")&&q.push("webm"),""!=t.canPlayType("video/mpeg")&&q.push("mp3"))},t.attach_scene_sfx=function(e){if(C.webaudio&&!V&&(V=r())&&x.log("%cINIT WEBAUDIO: "+V.sampleRate+"Hz","color: #00a"),V){var t={listener_last_eye:new Float32Array(3),listener_velocity:new Float32Array(3),update_counter:0},a=V.createGain(),_=V.createGain();if(t.gain_node=a,t.fade_gain_node=_,a.connect(_),_.connect(V.destination),e.b4w_enable_dynamic_compressor){var n=V.createDynamicsCompressor(),o=e.b4w_dynamic_compressor_settings;n.threshold.value=o.threshold,n.knee.value=o.knee,n.ratio.value=o.ratio,n.attack.value=o.attack,n.release.value=o.release,n.connect(a),t.compressor_node=n,t.proc_chain_in=n}else t.compressor_node=null,t.proc_chain_in=a;switch(e.audio_distance_model){case"INVERSE":case"INVERSE_CLAMPED":t.distance_model="inverse";break;case"LINEAR":case"LINEAR_CLAMPED":t.distance_model="linear";break;case"EXPONENT":case"EXPONENT_CLAMPED":t.distance_model="exponential";break;case"NONE":t.distance_model="none";break;default:M.panic("Wrong audio distance model")}t.doppler_factor=e.audio_doppler_factor,t.speed_of_sound=e.audio_doppler_speed,t.muted=!1,t.volume=e.audio_volume,a.gain.value=Y(t),t.duck_time=0}else var t=null;e._sfx=t},t.set_active_scene=function(e){W=e},t.detect_audio_container=function(e){return e||(e="ogg"),z.indexOf(e)>-1?e:z.indexOf("m4a")>-1?"m4a":z.indexOf("oga")>-1?"oga":""},t.detect_video_container=function(e){return e||(e="webm"),q.indexOf(e)>-1?e:q.indexOf("m4v")>-1?"m4v":q.indexOf("webm")>-1?"webm":""},t.update_object=function(e,t){var r=e.data,_=t.sfx;if(e.data.sound){switch(_.uuid=e.data.sound.uuid,_.filepath=e.data.sound.filepath,r.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":_.behavior=V?r.b4w_behavior:"NONE";break;case"BACKGROUND_MUSIC":_.behavior=V?a()&&!w.chrome_html_bkg_music_hack?"BACKGROUND_MUSIC":"BACKGROUND_SOUND":"NONE";break;default:M.panic("Wrong speaker behavior")}r.sound||(_.behavior="NONE"),_.enable_doppler=r.b4w_enable_doppler,_.muted=r.muted,_.volume=r.volume,_.pitch=r.pitch,_.attenuation=r.attenuation,_.dist_ref=r.distance_reference,_.dist_max=r.distance_max||1e4,_.cone_angle_inner=r.cone_angle_inner,_.cone_angle_outer=r.cone_angle_outer,_.cone_volume_outer=r.cone_volume_outer,_.autoplay=r.b4w_auto_play,_.cyclic=r.b4w_cyclic_play,_.loop=r.b4w_loop,_.loop_start=r.b4w_loop_start,_.loop_end=r.b4w_loop_end,_.delay=r.b4w_delay,_.delay_random=r.b4w_delay_random,_.volume_random=r.b4w_volume_random,_.pitch_random=r.b4w_pitch_random,_.fade_in=r.b4w_fade_in,_.fade_out=r.b4w_fade_out,J.push(t)}},t.source_type=function(e){switch("SPEAKER"!=e.type&&M.panic("Wrong object type"),e.sfx.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":return t.AST_ARRAY_BUFFER;case"BACKGROUND_MUSIC":return t.AST_HTML_ELEMENT;case"NONE":return t.AST_NONE;default:M.panic("Wrong speaker behavior")}},t.update_spkobj=function(e,t){var r=e.sfx;switch(r.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":case"BACKGROUND_MUSIC":r.src=t;break;case"NONE":break;default:M.panic("Wrong speaker behavior")}},t.play_empty_sound=function(){var e=V.createBufferSource();e.buffer=V.createBuffer(1,22050,22050),e.connect(V.destination),e.start(0)},t.decode_audio_data=function(e,t,r){V?V.decodeAudioData(e,t,r):r()},t.speaker_remove=function(e){m(e),e.sfx=null,J.splice(J.indexOf(e),1)},t.cleanup=function(){for(var e=0;e<J.length;e++){var t=J[e],r=t.sfx;if("BACKGROUND_MUSIC"==r.behavior){var a=r.src;a&&a.pause()}else r.source_node&&r.source_node.disconnect(),r.source_node2&&r.source_node2.disconnect()}if(W&&W._sfx){var _=W._sfx;_.listener_last_eye[0]=0,_.listener_last_eye[1]=0,_.listener_last_eye[2]=0,_.listener_velocity[0]=0,_.listener_velocity[1]=0,_.listener_velocity[2]=0}W=null,J.splice(0),$=null},t.update=function(e,t){if(V&&0!=J.length){for(var r=0;r<J.length;r++){var a=J[r],n=a.sfx,o=n.source_node,i=V.currentTime;!n.loop&&n.state==F&&n.duration&&n.start_time+n.duration<i&&("BACKGROUND_MUSIC"==n.behavior||o&&!l._17(o.onended))&&(n.state=K),n.cyclic&&n.state==K&&d(a),n.state==F&&n.vp_rand_end_time-i<3&&A(n)}$&&$.speakers.length&&(-1==$.active||e>$.active_start_time+$.durations[$.active])&&_($,e)}};var ee=function(){var e=s.create(),t=T.create();return function(r,a){var _=r.sfx;if(!_.proc_chain_in){if(C.mix_mode){var n=V.createBiquadFilter();n.type="peaking"}else var n=null;var o=V.createGain();switch(_.behavior){case"POSITIONAL":var i=V.createPanner();"string"!=typeof i.panningModel?(i.panningModel=i.EQUALPOWER,i.distanceModel=i.INVERSE_DISTANCE):(i.panningModel="equalpower",i.distanceModel=a.distance_model);var s=E.j(r.render.world_tsr,t),c=E.g(r.render.world_tsr,e);i.setPosition(s[0],s[1],s[2]),T.copy(s,_.last_position);var u=t;l._34(c,l.c,u),i.setOrientation(u[0],u[1],u[2]),i.refDistance=_.dist_ref,i.maxDistance=_.dist_max,i.rolloffFactor=_.attenuation,i.coneInnerAngle=_.cone_angle_inner,i.coneOuterAngle=_.cone_angle_outer,i.coneOuterGain=_.cone_volume_outer;var d=V.createGain();if(d.gain.value=Y(_),n?(i.connect(n),n.connect(d)):i.connect(d),d.connect(o),_.proc_chain_in=i,_.volume_random){var f=V.createGain();o.connect(f),f.connect(a.proc_chain_in)}else{var f=null;o.connect(a.proc_chain_in)}break;case"BACKGROUND_SOUND":var i=null,d=V.createGain();if(d.gain.value=Y(_),n?(_.proc_chain_in=n,n.connect(d)):_.proc_chain_in=d,d.connect(o),_.volume_random){var f=V.createGain();o.connect(f),f.connect(a.proc_chain_in)}else{var f=null;o.connect(a.proc_chain_in)}break;case"BACKGROUND_MUSIC":var i=null,f=null,d=V.createGain();d.gain.value=Y(_),n?(_.proc_chain_in=n,n.connect(d)):_.proc_chain_in=d,d.connect(o),o.connect(a.proc_chain_in)}_.panner_node=i,_.filter_node=n,_.gain_node=d,_.fade_gain_node=o,_.rand_gain_node=f}}}();t.play=u,t.play_def=d,t.stop=m,t.is_playing=O,t.speaker_pause=N,t.speaker_resume=h,t.loop_stop=function(e,t,r){var a=e.sfx,_=a.source_node2;if(b(e)&&("POSITIONAL"==a.behavior||"BACKGROUND_SOUND"==a.behavior)&&_){var n=V.currentTime+t;a.source_node.stop(n),_.start(n,a.loop_end)}},t.playrate=function(e,t){var r=e.sfx;r.pitch=t,!b(e)||"POSITIONAL"!=r.behavior&&"BACKGROUND_SOUND"!=r.behavior||(r.source_node.playbackRate.value=t,r.source_node2&&(r.source_node2.playbackRate.value=t),P(r),A(r))},t.get_playrate=function(e){return e.sfx.pitch},t.cyclic=function(e,t){e.sfx.cyclic=Boolean(t)},t.is_autoplay=function(e){return e.sfx.autoplay},t.is_cyclic=function(e){return e.sfx.cyclic},t.listener_update_transform=function(e,t,r,a,_){var n=e._sfx;if(n){var o=j;o[0]=0,o[1]=0,o[2]=-1,T.transformQuat(o,r,o);var i=H;i[0]=0,i[1]=1,i[2]=0,T.transformQuat(i,r,i);var s=V.listener;if(s.setPosition(t[0],t[1],t[2]),s.setOrientation(o[0],o[1],o[2],i[0],i[1],i[2]),a&&n.update_counter!=_){if(n.listener_stride)n.listener_stride=!1,T.copy(t,n.listener_last_eye);else{var c=n.listener_velocity;c[0]=(t[0]-n.listener_last_eye[0])/a,c[1]=(t[1]-n.listener_last_eye[1])/a,c[2]=(t[2]-n.listener_last_eye[2])/a,T.copy(t,n.listener_last_eye);for(var E=0;E<J.length;E++){var l=J[E],u=l.sfx;b(l)&&"POSITIONAL"==u.behavior&&u.enable_doppler&&I(u,n,a)}}n.update_counter=_}else T.copy(t,n.listener_last_eye)}},t.listener_stride=function(){var e=W._sfx;e&&(e.listener_stride=!0)},t.speaker_update_transform=function(e,t,r){var a=e.sfx;if(b(e)&&"POSITIONAL"==a.behavior){var _=E.j(e.render.world_tsr,j),n=E.g(e.render.world_tsr,Q),o=a.panner_node;o.setPosition(_[0],_[1],_[2]);var i=H;if(l._34(n,l.c,i),o.setOrientation(i[0],i[1],i[2]),a.enable_doppler){var s=a.last_position;if(t&&a.update_counter!=r){if(a.stride)T.copy(_,s),a.stride=!1;else{var c=a.velocity;c[0]=(_[0]-s[0])/t,c[1]=(_[1]-s[1])/t,c[2]=(_[2]-s[2])/t,T.copy(_,s),I(a,W._sfx,t)}a.update_counter=r}else T.copy(_,s)}}},t.speaker_stride=function(e){var t=e.sfx;b(e)&&"POSITIONAL"==t.behavior&&t.enable_doppler&&(t.stride=!0)},t.get_spk_behavior=function(e){return e.sfx.behavior},t.check_active_speakers=function(){for(var e=0;e<J.length;e++)if(b(J[e]))return!0;return!1},t.set_master_volume=function(e){var t=W._sfx;t&&(t.volume=e,V&&(t.gain_node.gain.value=Y(t)))},t.get_master_volume=function(){var e=W._sfx;return e?e.volume:0},t.set_volume=function(e,t){var r=e.sfx;r.volume=t,b(e)&&(r.gain_node.gain.value=Y(r))},t.get_volume=function(e){return e.sfx.volume},t.mute=function(e,t){e.sfx.muted=Boolean(t),b(e)&&(e.sfx.gain_node.gain.value=Y(e.sfx))},t.is_muted=function(e){return e.sfx.muted},t.mute_master=function(e){var t=W._sfx;t&&(t.muted=Boolean(e),V&&(t.gain_node.gain.value=Y(t)))},t.is_master_muted=function(){var e=W._sfx;return!!e&&e.muted},t.get_speaker_objects=function(){return J},t.pause=function(){for(var e=0;e<J.length;e++)N(J[e])},t.resume=function(){for(var e=0;e<J.length;e++)h(J[e])},t.set_compressor_params=function(e,t){if(e._sfx&&e._sfx.compressor_node){var r=e._sfx.compressor_node;r.threshold.value=t.threshold,r.knee.value=t.knee,r.ratio.value=t.ratio,r.attack.value=t.attack,r.release.value=t.release}},t.get_compressor_params=function(e){if(!e._sfx||!e._sfx.compressor_node)return null;var t=e._sfx.compressor_node;return{threshold:t.threshold.value,knee:t.knee.value,ratio:t.ratio.value,attack:t.attack.value,release:t.release.value}},t.duck=function(e,t,r){if(b(e)){var a=e.sfx,_=a.fade_gain_node,n=V.currentTime;_.gain.setTargetAtTime(_.gain.value,n,B),_.gain.linearRampToValueAtTime(t,n+r),a.duck_time=r}},t.unduck=function(e){if(b(e)){var t=e.sfx,r=t.fade_gain_node,a=V.currentTime;r.gain.setTargetAtTime(r.gain.value,a,B),r.gain.linearRampToValueAtTime(1,a+t.duck_time),t.duck_time=0}},t.duck_master=function(e,t){if(V){var r=W._sfx,a=r.fade_gain_node,_=V.currentTime;a.gain.setTargetAtTime(a.gain.value,_,B),a.gain.linearRampToValueAtTime(e,_+t),r.duck_time=t}},t.unduck_master=function(){if(V){var e=W._sfx,t=e.fade_gain_node,r=V.currentTime;t.gain.setTargetAtTime(t.gain.value,r,B),t.gain.linearRampToValueAtTime(1,r+e.duck_time),e.duck_time=0}},t.apply_playlist=function(e,t,r){$={active:-1,active_start_time:0,random:r,speakers:[],durations:[]};for(var a=0;a<e.length;a++){var _=e[a],n=L(_);if(0!=n){m(_);_.sfx.cyclic=!1,$.speakers.push(_),$.durations.push(n+t)}else x.warn("Ignoring speaker with zero duration: "+_.name)}},t.get_duration=L,t.clear_playlist=function(){if($)for(var e=$.speakers,t=0;t<e.length;t++)m(e[t]);$=null},t.get_positional_params=function(e){var t=e.sfx;return t&&"POSITIONAL"==t.behavior?{dist_ref:t.dist_ref,dist_max:t.dist_max,attenuation:t.attenuation}:null},t.set_positional_params=function(e,t){var r=e.sfx;if(r&&"POSITIONAL"==r.behavior){r.dist_ref=t.dist_ref,r.dist_max=t.dist_max,r.attenuation=t.attenuation;var a=r.panner_node;a&&(a.refDistance=r.dist_ref,a.maxDistance=r.dist_max,a.rolloffFactor=r.attenuation)}},t.set_filter_params=function(e,t){var r=e.sfx;r&&r.filter_node&&(r.filter_node.frequency.value=t.freq,r.filter_node.Q.value=t.Q,r.filter_node.gain.value=t.gain)},t.get_filter_params=function(e){var t=e.sfx;return t&&t.filter_node?{freq:t.filter_node.frequency.value,Q:t.filter_node.Q.value,gain:t.filter_node.gain.value}:null},t.get_filter_freq_response=function(e,t,r,a){var _=e.sfx;if(!_||!_.filter_node)return null;_.filter_node.getFrequencyResponse(t,r,a)},t.reset=function(){z.length=0,q.length=0,V=null}}var _=r(0),n=r(5),o=r(4),i=r(1),s=r(8),c=r(18),E=r(6),l=r(2),T=r(3),u=Object(_.a)("__sfx",a);t.a=u},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e);t.CT_POSITIVE=r.CT_POSITIVE,t.CT_CONTINUOUS=r.CT_CONTINUOUS,t.CT_TRIGGER=r.CT_TRIGGER,t.CT_SHOT=r.CT_SHOT,t.CT_LEVEL=r.CT_LEVEL,t.CT_CHANGE=r.CT_CHANGE,t.KEY_BACKSPACE=8,t.KEY_TAB=9,t.KEY_ENTER=13,t.KEY_SHIFT=16,t.KEY_CTRL=17,t.KEY_ALT=18,t.KEY_PAUSE=19,t.KEY_CAPSLOCK=20,t.KEY_ESC=27,t.KEY_SPACE=32,t.KEY_LEFT=37,t.KEY_UP=38,t.KEY_RIGHT=39,t.KEY_DOWN=40,t.KEY_1=49,t.KEY_2=50,t.KEY_3=51,t.KEY_4=52,t.KEY_5=53,t.KEY_6=54,t.KEY_7=55,t.KEY_8=56,t.KEY_9=57,t.KEY_A=65,t.KEY_B=66,t.KEY_C=67,t.KEY_D=68,t.KEY_E=69,t.KEY_F=70,t.KEY_G=71,t.KEY_H=72,t.KEY_I=73,t.KEY_J=74,t.KEY_K=75,t.KEY_L=76,t.KEY_M=77,t.KEY_N=78,t.KEY_O=79,t.KEY_P=80,t.KEY_Q=81,t.KEY_R=82,t.KEY_S=83,t.KEY_T=84,t.KEY_U=85,t.KEY_V=86,t.KEY_W=87,t.KEY_X=88,t.KEY_Y=89,t.KEY_Z=90,t.KEY_NUM0=96,t.KEY_NUM1=97,t.KEY_NUM2=98,t.KEY_NUM3=99,t.KEY_NUM4=100,t.KEY_NUM5=101,t.KEY_NUM6=102,t.KEY_NUM7=103,t.KEY_NUM8=104,t.KEY_NUM9=105,t.KEY_MULT=106,t.KEY_ADD=107,t.KEY_SUB=109,t.KEY_DEC_POINT=110,t.KEY_DIV=111,t.KEY_SEMI_COLON=186,t.KEY_EQUAL_SIGN=187,t.KEY_COMMA=188,t.KEY_DASH=189,t.KEY_PERIOD=190,t.KEY_FORWARD_SLASH=191,t.KEY_GRAVE_ACCENT=192,t.KEY_LEFT_SQ_BRACKET=219,t.KEY_BACK_SLASH=220,t.KEY_RIGHT_SQ_BRACKET=221,t.KEY_SINGLE_QUOTE=222,t.PL_SINGLE_TOUCH_MOVE=r.PL_SINGLE_TOUCH_MOVE,t.PL_MULTITOUCH_MOVE_ZOOM=r.PL_MULTITOUCH_MOVE_ZOOM,t.PL_MULTITOUCH_MOVE_PAN=r.PL_MULTITOUCH_MOVE_PAN,t.PL_MULTITOUCH_MOVE_ROTATE=r.PL_MULTITOUCH_MOVE_ROTATE,t.default_AND_logic_fun=r.default_AND_logic_fun,t.default_OR_logic_fun=r.default_OR_logic_fun,t.create_gamepad_btn_sensor=r.create_gamepad_btn_sensor,t.create_gamepad_axis_sensor=r.create_gamepad_axis_sensor,t.create_gamepad_position_sensor=r.create_gamepad_position_sensor,t.create_gamepad_orientation_sensor=r.create_gamepad_orientation_sensor,t.create_custom_sensor=r.create_custom_sensor,t.create_keyboard_sensor=r.create_keyboard_sensor,t.create_collision_sensor=function(e,t,a){return t=t||"ANY",a=a||!1,r.create_collision_sensor(e,t,a)},t.create_collision_impulse_sensor=r.create_collision_impulse_sensor,t.create_ray_sensor=function(e,t,n,o,i,s,c){return e&&!a.obj_has_physics(e)?void _.error_once("No physics for object "+e.name):(o=o||"ANY",i=i||!1,s=s||!1,c=c||!1,r.create_ray_sensor(e,t,n,o,i,s,c))},t.create_mouse_click_sensor=r.create_mouse_click_sensor,t.create_mouse_wheel_sensor=r.create_mouse_wheel_sensor,t.create_mouse_move_sensor=r.create_mouse_move_sensor,t.create_plock_mouse_sensor=r.create_plock_mouse_sensor,t.create_plock_sensor=r.create_plock_sensor,t.create_touch_move_sensor=r.create_touch_move_sensor,t.create_touch_zoom_sensor=r.create_touch_zoom_sensor,t.create_touch_rotate_sensor=r.create_touch_rotate_sensor,t.create_touch_click_sensor=r.create_touch_click_sensor,t.create_motion_sensor=r.create_motion_sensor,t.create_vertical_velocity_sensor=r.create_vertical_velocity_sensor,t.create_gyro_angles_sensor=r.create_gyro_angles_sensor,t.create_gyro_quat_sensor=r.create_gyro_quat_sensor,t.create_gyro_delta_sensor=r.create_gyro_delta_sensor,t.create_hmd_quat_sensor=r.create_hmd_quat_sensor,t.create_hmd_position_sensor=r.create_hmd_position_sensor,t.create_timer_sensor=function(e,t){return r.create_timer_sensor(e,t||!1)},t.reset_timer_sensor=r.reset_timer_sensor,t.create_elapsed_sensor=r.create_elapsed_sensor,t.create_timeline_sensor=r.create_timeline_sensor,t.create_selection_sensor=function(e,t){return r.create_selection_sensor(e,t||!1)},t.create_callback_sensor=function(e,t){return r.create_callback_sensor(e,t||0)},t.set_custom_sensor=function(e,t){r.sensor_set_value(e,t)},t.get_custom_sensor=function(e){return e.value},t.get_sensor_value=r.get_sensor_value,t.get_sensor_payload=r.get_sensor_payload,t.create_sensor_manifold=function(e,t,a,_,n,o,i){i=void 0===i?null:i,n=n||r.default_AND_logic_fun,r.create_sensor_manifold(e,t,a,_,n,o,i)},t.create_kb_sensor_manifold=function(e,t,a,_,n,o){var i=r.create_keyboard_sensor(_);o=void 0===o?null:o;var s=r.default_AND_logic_fun;r.create_sensor_manifold(e,t,a,[i],s,n,o)},t.check_sensor_manifolds=function(e){return r.check_sensor_manifold(e,null)},t.check_sensor_manifold=r.check_sensor_manifold,t.remove_sensor_manifold=r.remove_sensor_manifold,t.reset=r.reset,t.set_plock_smooth_factor=r.set_plock_smooth_factor}var _=r(0),n=r(56),o=r(19),i=r(1),s=Object(_.a)("controls",a);t.a=s},function(e,t,r){"use strict";function a(){return{bb:n(),be:g(),bs:O()}}function _(e,t){return o(e.bb,t.bb),h(e.be,t.be),N(e.bs,t.bs),t}function n(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function o(e,t){return t.min_x=e.min_x,t.max_x=e.max_x,t.min_y=e.min_y,t.max_y=e.max_y,t.min_z=e.min_z,t.max_z=e.max_z,t}function i(){return{center:new Float32Array(3),axis_x:new Float32Array(3),axis_y:new Float32Array(3),axis_z:new Float32Array(3)}}function s(e,t){return V.copy(e.center,t.center),V.copy(e.axis_x,t.axis_x),V.copy(e.axis_y,t.axis_y),V.copy(e.axis_z,t.axis_z),t}function c(){return{max_x:1e12,min_x:-1e12,max_y:1e12,min_y:-1e12,max_z:1e12,min_z:-1e12}}function E(e){return e.max_x=0,e.min_x=0,e.max_y=0,e.min_y=0,e.max_z=0,e.min_z=0,e}function l(e){var t=n();return o(e,t),t}function T(e){var t=e.max_x-e.min_x,r=e.max_y-e.min_y;r<t&&(t=r);var a=e.max_z-e.min_z;return a<t&&(t=a),t}function u(e,t){var r=e.max_x,a=e.max_y,_=e.max_z,n=e.min_x,o=e.min_y,i=e.min_z;return e.max_x=Math.max(t.max_x,r),e.max_y=Math.max(t.max_y,a),e.max_z=Math.max(t.max_z,_),e.min_x=Math.min(t.min_x,n),e.min_y=Math.min(t.min_y,o),e.min_z=Math.min(t.min_z,i),e}function d(e,t,r,a){for(var _=e[t],n=e[t+1],o=e[t+2],i=e[t],s=e[t+1],c=e[t+2],E=t+3;E<r;E+=3){var l=e[E],T=e[E+1],u=e[E+2];_=Math.max(_,l),n=Math.max(n,T),o=Math.max(o,u),i=Math.min(i,l),s=Math.min(s,T),c=Math.min(c,u)}return a.max_x=_,a.max_y=n,a.max_z=o,a.min_x=i,a.min_y=s,a.min_z=c,a}function f(e,t,r){r||(r=n());var a=P(e,Z);return z.F(a,t,a),d(a,0,a.length,r)}function P(e,t){t||(t=new Float32Array(24));var r=e.max_x,a=e.max_y,_=e.max_z,n=e.min_x,o=e.min_y,i=e.min_z;return t[0]=n,t[1]=o,t[2]=i,t[3]=r,t[4]=o,t[5]=i,t[6]=r,t[7]=a,t[8]=i,t[9]=n,t[10]=a,t[11]=i,t[12]=n,t[13]=o,t[14]=_,t[15]=r,t[16]=o,t[17]=_,t[18]=r,t[19]=a,t[20]=_,t[21]=n,t[22]=a,t[23]=_,t}function A(e,t,r){r||(r=O()),z.D(e.center,t,r.center);var a=z.i(t);return r.radius=e.radius*(a<0?-a:a),r}function S(e,t,r){return r||(r=g()),z.D(e.center,t,r.center),V.copy(e.axis_x,r.axis_x),V.copy(e.axis_y,r.axis_y),V.copy(e.axis_z,r.axis_z),z.y(r.axis_x,t,r.axis_x),z.y(r.axis_y,t,r.axis_y),z.y(r.axis_z,t,r.axis_z),r}function p(e,t,r){return r||(r=i()),z.D(e.center,t,r.center),V.copy(e.axis_x,r.axis_x),V.copy(e.axis_y,r.axis_y),V.copy(e.axis_z,r.axis_z),z.y(r.axis_x,t,r.axis_x),z.y(r.axis_y,t,r.axis_y),z.y(r.axis_z,t,r.axis_z),r}function v(e,t){var r=O();return V.copy(t,r.center),r.radius=e,r}function m(e,t,r,a,_){var n=i();return V.copy(e,n.center),V.copy(t,n.axis_x),V.copy(r,n.axis_y),V.copy(a,n.axis_z),V.scale(n.axis_x,_[0],n.axis_x),V.scale(n.axis_y,_[1],n.axis_y),V.scale(n.axis_z,_[2],n.axis_z),n}function O(){return{center:new Float32Array(3),radius:0}}function N(e,t){return t.center[0]=e.center[0],t.center[1]=e.center[1],t.center[2]=e.center[2],t.radius=e.radius,t}function g(){return{axis_x:new Float32Array(3),axis_y:new Float32Array(3),axis_z:new Float32Array(3),center:new Float32Array(3)}}function h(e,t){return V.copy(e.axis_x,t.axis_x),V.copy(e.axis_y,t.axis_y),V.copy(e.axis_z,t.axis_z),V.copy(e.center,t.center),t}function R(e,t,r,a){return{axis_x:new Float32Array(e),axis_y:new Float32Array(t),axis_z:new Float32Array(r),center:new Float32Array([a[0],a[1],a[2]])}}function I(e){return e||(e=O()),V.set(0,0,0,e.center),e.radius=1e12,e}function b(e,t){var r=V.subtract(t.center,e.center,V.create());0==V.length(r)&&V.set(1,0,0,r);var a=V.normalize(r,V.create()),_=V.scale(a,e.radius,V.create());V.add(_,e.center,_);var n=V.scale(a,-e.radius,V.create());V.add(n,e.center,n);var o=V.scale(a,t.radius,V.create());V.add(o,t.center,o);var i=V.scale(a,-t.radius,V.create());V.add(i,t.center,i);var s=U([_,n,o,i],a),c=s[0],E=s[1];e.center=V.scale(V.add(c,E,V.create()),.5,V.create()),e.radius=V.length(V.subtract(E,c,V.create()))/2}function Y(e,t){V.add(e.center,e.axis_y,$),V.add($,e.axis_x,$),V.add($,e.axis_z,$),t.push($[0],$[1],$[2]),V.add(e.center,e.axis_y,$),V.add($,e.axis_x,$),V.subtract($,e.axis_z,$),t.push($[0],$[1],$[2]),V.add(e.center,e.axis_y,$),V.subtract($,e.axis_x,$),V.add($,e.axis_z,$),t.push($[0],$[1],$[2]),V.add(e.center,e.axis_y,$),V.subtract($,e.axis_x,$),V.subtract($,e.axis_z,$),t.push($[0],$[1],$[2]),V.subtract(e.center,e.axis_y,$),V.add($,e.axis_x,$),V.add($,e.axis_z,$),t.push($[0],$[1],$[2]),V.subtract(e.center,e.axis_y,$),V.add($,e.axis_x,$),V.subtract($,e.axis_z,$),t.push($[0],$[1],$[2]),V.subtract(e.center,e.axis_y,$),V.subtract($,e.axis_x,$),V.add($,e.axis_z,$),t.push($[0],$[1],$[2]),V.subtract(e.center,e.axis_y,$),V.subtract($,e.axis_x,$),V.subtract($,e.axis_z,$),t.push($[0],$[1],$[2])}function L(e,t){var r=W.g(e,re);if(t)var a=W.e(e,r,_e);else var a=J.identity(_e);var _=W.L(a,ie,ae);V.copy(e,$),V.transformMat3($,_,$);for(var n=$[0],o=n,i=$[1],s=i,c=$[2],E=c,l=0,T=0,u=0,d=0,f=0,P=0,A=3;A<e.length;A+=3){$[0]=e[A],$[1]=e[A+1],$[2]=e[A+2],V.transformMat3($,_,$);var S=$[0],p=$[1],v=$[2];S>n&&(n=S),S<o&&(o=S),p>i&&(i=p),p<s&&(s=p),v>c&&(c=v),v<E&&(E=v)}var m=n-o,O=i-s,N=c-E;m=Math.max(m,oe),O=Math.max(O,oe),N=Math.max(N,oe);var g=J.identity(_e);g[0]=0!=m?1/m:1/se,g[4]=0!=O?1/O:1/se,g[8]=0!=N?1/N:1/se,J.transpose(_,ne),$[0]=e[0],$[1]=e[1],$[2]=e[2],V.transformMat3($,_,$),V.transformMat3($,g,$),V.transformMat3($,ne,$),l=$[0],T=$[0],u=$[1],d=$[1],f=$[2],P=$[2];for(var A=3;A<e.length;A+=3)$[0]=e[A],$[1]=e[A+1],$[2]=e[A+2],V.transformMat3($,_,$),V.transformMat3($,g,$),V.transformMat3($,ne,$),l=Math.max(l,$[0]),T=Math.min(T,$[0]),u=Math.max(u,$[1]),d=Math.min(d,$[1]),f=Math.max(f,$[2]),P=Math.min(P,$[2]);var h=Math.sqrt((l-T)*(l-T)+(u-d)*(u-d)+(f-P)*(f-P))/2;h=Math.min(h,1),te[0]=(l+T)/2,te[1]=(u+d)/2,te[2]=(f+P)/2;var I=te;g=J.identity(_e),g[0]=m,g[4]=O,g[8]=N,V.transformMat3(I,_,I),V.transformMat3(I,g,I),V.transformMat3(I,ne,I);var b=[_[0],_[3],_[6]],Y=[_[1],_[4],_[7]],L=[_[2],_[5],_[8]];return V.scale(b,m*h,b),V.scale(Y,O*h,Y),V.scale(L,N*h,L),R(b,Y,L,I)}function M(e){var t=i();return V.copy(e.axis_x,t.axis_x),V.copy(e.axis_y,t.axis_y),V.copy(e.axis_z,t.axis_z),V.copy(e.center,t.center),t}function y(e){var t=O(),r=0,a=V.length(e.axis_x),_=V.length(e.axis_y),n=V.length(e.axis_z);return r=a>_?a:_,r=n>r?n:r,t.center=e.center,t.radius=r,t}function x(e,t){var r=V.length(e.axis_x),a=V.length(e.axis_y),_=V.length(e.axis_z),n=r*a*_;return t.radius*t.radius*t.radius*.75>n}function U(e,t){for(var r=V.normalize(t,V.create()),a=e[0],_=e[0],n=1;n<e.length;n++){var o=V.dot(e[n],r);o<V.dot(a,r)&&(a=e[n]),o>V.dot(_,r)&&(_=e[n])}return[a,_]}function w(){return{radius:0,height:0,center:new Float32Array(3)}}function C(e,t){var r=t.max_z,a=t.min_z,_=Math.max(0,r-a-2*e),n=w();return n.radius=e,n.height=_,n.center[0]=0,n.center[1]=0,n.center[2]=(r+a)/2,n}function D(e,t){var r=t.max_z,a=t.min_z,_=Math.max(0,r-a),n=w();return n.radius=e,n.height=_,n.center[0]=0,n.center[1]=0,n.center[2]=(r+a)/2,n}function F(e,t){var r=t.max_z,a=t.min_z,_=Math.max(0,r-a),n=w();return n.radius=e,n.height=_,n.center[0]=0,n.center[1]=0,n.center[2]=(r+a)/2,n}function G(e,t){return t.radius=e.radius,t.height=e.height,t.center.set(e.center),t}function k(e){for(var t=0,r=0,a=n(),_=0;_<e.submeshes.length;_++){for(var i=e.submeshes[_],s=i.position,c=0;c<s.length/3;c++){var E=s[3*c],l=s[3*c+1],T=s[3*c+2];t=Math.max(Math.sqrt(E*E+l*l+T*T),t),r=Math.max(Math.sqrt(E*E+l*l),r)}var f=i.boundings.bb,A=d(s,0,s.length,n());f.max_x=A.max_x,f.min_x=A.min_x,f.max_y=A.max_y,f.min_y=A.min_y,f.max_z=A.max_z,f.min_z=A.min_z;var S=P(A,Z),p=L(S,!1);i.boundings.be_cen=p.center,i.boundings.be_ax=[p.axis_x[0],p.axis_y[1],p.axis_z[2]],0==_?o(A,a):u(a,A)}var v=e.b4w_boundings.bb;v.max_x=a.max_x,v.min_x=a.min_x,v.max_y=a.max_y,v.min_y=a.min_y,v.max_z=a.max_z,v.min_z=a.min_z;var m=e.b4w_boundings.bb_src;m.max_x=a.max_x,m.min_x=a.min_x,m.max_y=a.max_y,m.min_y=a.min_y,m.max_z=a.max_z,m.min_z=a.min_z,e.b4w_boundings.bs_rad=t,e.b4w_boundings.bc_rad=r;var S=P(a,Z),p=L(S,!1);e.b4w_boundings.be_cen=p.center,e.b4w_boundings.be_ax=[p.axis_x[0],p.axis_y[1],p.axis_z[2]]}function K(e){var t=e.subarray(0,3),r=e.subarray(6,9),a=e.subarray(12,15),_=e.subarray(18,21),n=V.subtract(r,t,$);V.normalize(n,n);var o=q._10(t,r,a,ee),i=V.cross(o,n,o);V.normalize(i,i);var s=V.create(),c=V.create();V.subtract(r,t,te),c[0]=V.dot(te,n),c[1]=V.dot(te,i);var E=V.create();V.subtract(a,t,te),E[0]=V.dot(te,n),E[1]=V.dot(te,i);var l=V.create();V.subtract(_,t,te),l[0]=V.dot(te,n),l[1]=V.dot(te,i);var T=O();T=B([s,c,E,l],T);var u=V.scale(n,T.center[0],te);return V.scaleAndAdd(u,i,T.center[1],u),V.add(u,t,T.center),T}function B(e,t){t=H(t,e[0],e[1]);for(var r=2;r<e.length;r++)V.distance(t.center,e[r])>t.radius&&(t=X(t,e,e[r],r-1));return t}function X(e,t,r,a){e=H(e,r,t[0]);for(var _=1;_<=a;_++)V.distance(e.center,t[_])>e.radius&&(e=j(e,t,r,t[_],_-1));return e}function j(e,t,r,a,_){e=H(e,r,a);for(var n=0;n<=_;n++)V.distance(e.center,t[n])>e.radius&&(e=Q(e,r,a,t[n]));return e}function H(e,t,r){return V.add(t,r,e.center),V.scale(e.center,.5,e.center),e.radius=V.distance(e.center,t),e}function Q(e,t,r,a){var _=V.subtract(r,a,te),n=V.squaredLength(_),o=V.subtract(t,a,te),i=V.squaredLength(o),s=V.subtract(t,r,te),c=V.squaredLength(s),E=n*(i+c-n),l=i*(c+n-i),T=c*(n+i-c),u=E+l+T;return V.copy(t,e.center),V.scale(e.center,E/u,e.center),V.scaleAndAdd(e.center,r,l/u,e.center),V.scaleAndAdd(e.center,a,T/u,e.center),e.radius=V.distance(e.center,t),e}t.L=a,t.t=_,t.w=n,t.o=o,t.C=i,t.v=s,t.f=c,t.P=E,t.n=l,t.m=T,t.D=u,t.a=d,t.h=f,t.F=P,t.k=A,t.i=S,t.j=p,t.l=v,t.O=m,t.A=O,t.u=N,t.y=g,t.s=h,t.e=R,t.g=I,t.E=b,t.G=Y,t.z=L,t.x=M,t.B=y,t.M=x,r.d(t,"I",function(){return w}),r.d(t,"K",function(){return w}),r.d(t,"J",function(){return w}),t.b=C,t.d=D,t.c=F,r.d(t,"p",function(){return G}),r.d(t,"r",function(){return G}),r.d(t,"q",function(){return G}),t.N=k,t.H=K;var z=r(6),q=r(2),V=r(3),W=r(45),J=r(28),Z=new Float32Array(24),$=new Float32Array(3),ee=new Float32Array(3),te=new Float32Array(3),re=new Float32Array(3),ae=new Float32Array(9),_e=new Float32Array(9),ne=new Float32Array(9),oe=.001,ie=5e-4,se=oe/2},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),u=Object(s.a)(e);t.AXIS_X=new Float32Array([1,0,0]),t.AXIS_Y=new Float32Array([0,1,0]),t.AXIS_Z=new Float32Array([0,0,1]),t.AXIS_MX=new Float32Array([-1,0,0]),t.AXIS_MY=new Float32Array([0,-1,0]),t.AXIS_MZ=new Float32Array([0,0,-1]),t.XYX=l.o,t.YZY=l.v,t.ZXZ=l.x,t.XZX=l.q,t.YXY=l.s,t.ZYZ=l.z,t.XYZ=l.p,t.YZX=l.u,t.ZXY=l.w,t.XZY=l.r,t.YXZ=l.t,t.ZYX=l.y,t.f32=function(e){return e=e||0,l._1(e)},t.assert=r.assert,t.keyfind=l._18,t.keysearch=l._19,t.matrix_to_quat=function(e){return l._24(e)},t.euler_to_quat=function(e,t){return t||(t=new Float32Array(4)),l.Y(e,t)},t.ordered_angles_to_quat=function(e,t,r){return r||(r=c.create()),l._27(e,t,r)},t.quat_to_ordered_angles=function(e,t,r){return r||(r=T.create()),l._37(e,t,r)},t.quat_to_euler=function(e,t){return t||(t=new Float32Array(3)),l._36(e,t)},t.sign=l._50,t.clamp=l.M,t.quat_to_dir=l._34,t.ground_project_cam_quat=function(e,t){return l._30(e,l.c,l.f,l.e,t)},t.cam_quat_to_mesh_quat=function(e,t){return l.I(e,t)},t.quat_project=function(e,t,r,a,_){return 0!=T.dot(r,a)?(u.error("Wrong in-plane direction"),null):l._30(e,t,r,a,_)},t.hash_code=function(){return _.hash_code.apply(_,arguments)},t.smooth=l._51,t.smooth_v=l._54,t.is_vector=l._16,t.correct_cam_quat_up=l.R,t.quat_to_angle_axis=l._33,t.random_from_array=l._41,t.horizontal_direction=l._12,t.angle_wrap_0_2pi=l.A,t.angle_wrap_periodic=l.B,t.smooth_step=l._53,t.lerp=l._20,t.deg_to_rad=l.T,t.rad_to_deg=l._39,t.dir_to_quat=l.U,t.is_ie11=a.is_ie11,t.gen_tbn_quats=function(e,t){return u.error_once("util.gen_tbn_quats() deprecated. Do not use it anymore."),E.d(e,t)},t.trunc=l._64}var _=r(0),n=r(5),o=r(38),i=r(34),s=r(1),c=r(8),E=r(39),l=r(2),T=r(3),u=Object(_.a)("util",a);t.a=u},function(e,t,r){"use strict";e.exports=r(98)},function(e,t,r){"use strict";function a(){var e=new g(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function _(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function n(e){var t=new g(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function o(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function s(e,t){if(t===e){var r=e[1],a=e[2],_=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=a,t[7]=_}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function c(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=e[4],i=e[5],s=e[6],c=e[7],E=e[8],l=E*o-i*c,T=-E*n+i*s,u=c*n-o*s,d=r*l+a*T+_*u;return d?(d=1/d,t[0]=l*d,t[1]=(-E*a+_*c)*d,t[2]=(i*a-_*o)*d,t[3]=T*d,t[4]=(E*r-_*s)*d,t[5]=(-i*r+_*n)*d,t[6]=u*d,t[7]=(-c*r+a*s)*d,t[8]=(o*r-a*n)*d,t):null}function E(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=e[4],i=e[5],s=e[6],c=e[7],E=e[8];return t[0]=o*E-i*c,t[1]=_*c-a*E,t[2]=a*i-_*o,t[3]=i*s-n*E,t[4]=r*E-_*s,t[5]=_*n-r*i,t[6]=n*c-o*s,t[7]=a*s-r*c,t[8]=r*o-a*n,t}function l(e){var t=e[0],r=e[1],a=e[2],_=e[3],n=e[4],o=e[5],i=e[6],s=e[7],c=e[8];return t*(c*n-o*s)+r*(-c*_+o*i)+a*(s*_-n*i)}function T(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3],i=e[4],s=e[5],c=e[6],E=e[7],l=e[8],T=t[0],u=t[1],d=t[2],f=t[3],P=t[4],A=t[5],S=t[6],p=t[7],v=t[8];return r[0]=T*a+u*o+d*c,r[1]=T*_+u*i+d*E,r[2]=T*n+u*s+d*l,r[3]=f*a+P*o+A*c,r[4]=f*_+P*i+A*E,r[5]=f*n+P*s+A*l,r[6]=S*a+p*o+v*c,r[7]=S*_+p*i+v*E,r[8]=S*n+p*s+v*l,r}function u(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3],i=e[4],s=e[5],c=e[6],E=e[7],l=e[8],T=t[0],u=t[1];return r[0]=a,r[1]=_,r[2]=n,r[3]=o,r[4]=i,r[5]=s,r[6]=T*a+u*o+c,r[7]=T*_+u*i+E,r[8]=T*n+u*s+l,r}function d(e,t,r){var a=e[0],_=e[1],n=e[2],o=e[3],i=e[4],s=e[5],c=e[6],E=e[7],l=e[8],T=Math.sin(t),u=Math.cos(t);return r[0]=u*a+T*o,r[1]=u*_+T*i,r[2]=u*n+T*s,r[3]=u*o-T*a,r[4]=u*i-T*_,r[5]=u*s-T*n,r[6]=c,r[7]=E,r[8]=l,r}function f(e,t,r){var a=t[0],_=t[1];return r[0]=a*e[0],r[1]=a*e[1],r[2]=a*e[2],r[3]=_*e[3],r[4]=_*e[4],r[5]=_*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function P(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function A(e,t){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=-r,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function S(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function p(e,t){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function v(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=r+r,i=a+a,s=_+_,c=r*o,E=a*o,l=a*i,T=_*o,u=_*i,d=_*s,f=n*o,P=n*i,A=n*s;return t[0]=1-l-d,t[3]=E-A,t[6]=T+P,t[1]=E+A,t[4]=1-c-d,t[7]=u-f,t[2]=T-P,t[5]=u+f,t[8]=1-c-l,t}function m(e,t){var r=e[0],a=e[1],_=e[2],n=e[3],o=e[4],i=e[5],s=e[6],c=e[7],E=e[8],l=e[9],T=e[10],u=e[11],d=e[12],f=e[13],P=e[14],A=e[15],S=r*i-a*o,p=r*s-_*o,v=r*c-n*o,m=a*s-_*i,O=a*c-n*i,N=_*c-n*s,g=E*f-l*d,h=E*P-T*d,R=E*A-u*d,I=l*P-T*f,b=l*A-u*f,Y=T*A-u*P,L=S*Y-p*b+v*I+m*R-O*h+N*g;return L?(L=1/L,t[0]=(i*Y-s*b+c*I)*L,t[1]=(s*R-o*Y-c*h)*L,t[2]=(o*b-i*R+c*g)*L,t[3]=(_*b-a*Y-n*I)*L,t[4]=(r*Y-_*R+n*h)*L,t[5]=(a*R-r*b-n*g)*L,t[6]=(f*N-P*O+A*m)*L,t[7]=(P*v-d*N-A*p)*L,t[8]=(d*O-f*v+A*S)*L,t):null}function O(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function N(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.fromMat4=_,t.clone=n,t.copy=o,t.identity=i,t.transpose=s,t.invert=c,t.adjoint=E,t.determinant=l,t.multiply=T,r.d(t,"mul",function(){return T}),t.translate=u,t.rotate=d,t.scale=f,t.fromTranslation=P,t.fromRotation=A,t.fromScaling=S,t.fromMat2d=p,t.fromQuat=v,t.normalFromMat4=m,t.str=O,t.frob=N;var g="undefined"!==typeof Float32Array?Float32Array:Array;Math.random},function(e,t,r){"use strict";function a(e,t){function r(){return E.webgl2?i("OES_texture_float_linear"):_("OES_texture_float_linear")}function a(){return E.webgl2?i("EXT_color_buffer_float"):_("WEBGL_color_buffer_float")}function _(e){if(e in T)return T[e];var t=l.getExtension(e)||null;if(T[e]=t,t)var r="0a0";else var r="a00";return c.log("%cGET EXTENSION","color: #"+r,e),t}function i(e){if(e in T)return T[e];switch(e){case"WEBGL_depth_texture":case"OES_element_index_uint":case"OES_standard_derivatives":case"EXT_shader_texture_lod":case"OES_texture_float":case"OES_texture_half_float":var t={};break;case"ANGLE_instanced_arrays":case"OES_vertex_array_object":var t=l;break;default:var t=l.getExtension(e)||null}if(T[e]=t,t)var r="0a0";else var r="a00";return c.log("%cGET EXTENSION (WebGL 2)","color: #"+r,e),t}var s=Object(n.a)(e),c=Object(o.a)(e),E=s.defaults,l=null,T={};t.setup_context=function(e){l=e},t.get_s3tc=function(){return _("WEBGL_compressed_texture_s3tc")||_("WEBKIT_WEBGL_compressed_texture_s3tc")},t.get_pvr=function(){return _("WEBKIT_WEBGL_compressed_texture_pvrtc")||_("WEBGL_compressed_texture_pvrtc")},t.get_depth_texture=function(){return E.webgl2?i("WEBGL_depth_texture"):_("WEBGL_depth_texture")||_("WEBKIT_WEBGL_depth_texture")},t.get_texture_float=function(){return E.webgl2?i("OES_texture_float"):_("OES_texture_float")},t.get_texture_half_float=function(){return E.webgl2?i("OES_texture_half_float"):_("OES_texture_half_float")},t.get_texture_float_linear=r,t.get_texture_half_float_linear=function(){return E.webgl2?r():_("OES_texture_half_float_linear")},t.get_color_buffer_float=a,t.get_color_buffer_half_float=function(){return E.webgl2?a():_("EXT_color_buffer_half_float")},t.get_aniso=function(){return _("EXT_texture_filter_anisotropic")||_("WEBKIT_EXT_texture_filter_anisotropic")},t.get_texture_lod=function(){return E.webgl2?i("EXT_shader_texture_lod"):_("EXT_shader_texture_lod")},t.get_debug_shaders=function(){return _("WEBGL_debug_shaders")},t.get_renderer_info=function(){return _("WEBGL_debug_renderer_info")},t.get_elem_index_uint=function(){return E.webgl2?i("OES_element_index_uint"):_("OES_element_index_uint")},t.get_standard_derivatives=function(){return E.webgl2?i("OES_standard_derivatives"):_("OES_standard_derivatives")},t.get_disjoint_timer_query=function(){if(E.webgl2)var e=i("EXT_disjoint_timer_query_webgl2");else var e=_("EXT_disjoint_timer_query");if(null==e)return e;if(e.createQueryEXT)var t={createQuery:function(){return e.createQueryEXT()},beginQuery:function(t){e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)},endQuery:function(){e.endQueryEXT(e.TIME_ELAPSED_EXT)},getQueryAvailable:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT)},getQueryObject:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)},getDisjoint:function(){return l.getParameter(e.GPU_DISJOINT_EXT)}};else var t={createQuery:function(){return l.createQuery()},beginQuery:function(t){l.beginQuery(e.TIME_ELAPSED_EXT,t)},endQuery:function(){l.endQuery(e.TIME_ELAPSED_EXT)},getQueryAvailable:function(e){return l.getQueryParameter(e,l.QUERY_RESULT_AVAILABLE)},getQueryObject:function(e){return l.getQueryParameter(e,l.QUERY_RESULT)},getDisjoint:function(){return l.getParameter(e.GPU_DISJOINT_EXT)}};return t},t.get_instanced_arrays=function(){if(E.webgl2)return i("ANGLE_instanced_arrays");var e=_("ANGLE_instanced_arrays");return null==e?e:{drawElementsInstanced:function(t,r,a,_,n){e.drawElementsInstancedANGLE(t,r,a,_,n)},vertexAttribDivisor:function(t,r){e.vertexAttribDivisorANGLE(t,r)},drawArraysInstanced:function(t,r,a,_){e.drawArraysInstancedANGLE(t,r,a,_)}}},t.get_vertex_array_object=function(){if(E.webgl2)return i("OES_vertex_array_object");var e=_("OES_vertex_array_object");return null==e?e:{bindVertexArray:function(t){e.bindVertexArrayOES(t)},createVertexArray:function(){return e.createVertexArrayOES()},deleteVertexArray:function(t){e.deleteVertexArrayOES(t)},isVertexArray:function(t){return e.isVertexArrayOES(t)}}},t.cleanup=function(){T={}},t.reset=function(){l=null}}var _=r(0),n=r(4),o=r(1),i=Object(_.a)("__extensions",a);t.a=i},function(e,t,r){"use strict";function a(e,t){function r(e,t,r){r||(r=null),a(e,t)?k.panic("Graph already has node with given ID"):e.nodes.push(t,r)}function a(e,t){for(var r=e.nodes,a=0;a<r.length;a+=2)if(r[a]==t)return!0;return!1}function _(e,t,r,_){_||(_=null),a(e,t)&&a(e,r)?e.edges.push(t,r,_):k.panic("Wrong node IDs")}function i(e,t){a(e,t)||k.panic("Node not found");for(var r=e.nodes,_=0;_<r.length;_+=2)r[_]==t&&(r.splice(_,2),_-=2)}function s(e,t,r,a){x(e,t,r)||k.panic("Edge not found");for(var _=e.edges,n=0,o=0;o<_.length;o+=3)if(_[o]==t&&_[o+1]==r){if(-1==a)_.splice(o,3);else{if(a==n){_.splice(o,3);break}n++}o-=3}}function c(e,t,r,a){x(e,t,r)||k.panic("Edge not found");for(var _=e.edges,n=0;n<_.length;n+=3)if(_[n]==t&&_[n+1]==r&&_[n+2][0]==a[0]&&_[n+2][1]==a[1]){_.splice(n,3);break}}function E(e){for(var t=e.nodes,r=-1,a=0;a<t.length;a+=2)r=Math.max(r,t[a]);return++r}function l(e,t){for(var r=e.nodes,a=0;a<r.length;a+=2)if(r[a+1]==t)return r[a];return K}function T(e){var t=[],r={};u(e,r);for(var a=e.nodes,_=0;_<a.length;_+=2)0==L(e,a[_])&&d(e,a[_],r,t);return{nodes:t,edges:e.edges.slice(0)}}function u(e,t){for(var r=e.nodes,a=0;a<r.length;a+=2)t[r[a]]=!1}function d(e,t,r,a){if(!r[t]){r[t]=!0;for(var _=0;_<Y(e,t);_++){d(e,M(e,t,_),r,a)}a.unshift(t,b(e,t))}}function f(e,t,r,a){if(!r[t]){if(r[t]=!0,a==X||a==H)for(var _=0;_<Y(e,t);_++){var n=M(e,t,_);f(e,n,r,a)}if(a==j||a==H)for(var _=0;_<L(e,t);_++){var n=y(e,t,_);f(e,n,r,a)}}}function P(e){for(var t=e.edges,r=0;r<t.length;r+=3){var _=t[r],n=t[r+1];a(e,_)&&a(e,n)||(t.splice(r,3),r-=3)}}function A(e){for(var t=[],r=e.nodes,a=0;a<r.length;a+=2){var _=r[a];Y(e,_)||t.push(_)}return t}function S(e){return e.nodes.length/2}function p(e){for(var t=e.nodes,r=e.edges,a=[],_=[],n=[],o=0;o<t.length;o++)n[t[2*o]]=o,a.push(o,t[2*o+1]);for(var o=0;o<r.length;o+=3)_.push(n[r[o]],n[r[o+1]],r[o+2]);return{nodes:a,edges:_}}function v(e,t,r){if(m(r))return O(r,e,t),!0;if(N(r))return!1;for(var a=K,_=K,n=!1;!n&&g(r,Q,a,_);)if(a=Q[0],_=Q[1],h(r,a,_)){var o=G(r);D(o,a,_),n=v(e,t,o),F(o)}return n}function m(e){return e.core_len==e.n1}function O(e,t,r){for(var a=0,_=0;a<e.n1;a++)e.core_1[a]!=K&&(t[_]=a,r[_]=e.core_1[a],_++)}function N(e){return e.n1>e.n2||e.t1both_len>e.t2both_len||e.t1out_len>e.t2out_len||e.t1in_len>e.t2in_len}function g(e,t,r,a){r==K&&(r=0),a==K?a=0:a++;var _=e.t1both_len,n=e.t2both_len,o=e.t1out_len,i=e.t2out_len,s=e.t1in_len,c=e.t2in_len,E=e.core_len,l=e.n1,T=e.n2,u=e.core_1,d=e.core_2,f=e.in_1,P=e.in_2,A=e.out_1,S=e.out_2;if(_>E&&n>E)for(;r<l&&(u[r]!=K||0==A[r]||0==f[r]);)r++,a=0;else if(o>E&&i>E)for(;r<l&&(u[r]!=K||0==A[r]);)r++,a=0;else if(s>E&&c>E)for(;r<l&&(u[r]!=K||0==f[r]);)r++,a=0;else if(0==r&&e.order!=B){for(var p=0;p<l&&u[r=e.order[p]]!=K;)p++;p==l&&(r=l)}else for(;r<l&&u[r]!=K;)r++,a=0;if(_>E&&n>E)for(;a<T&&(d[a]!=K||0==S[a]||0==P[a]);)a++;else if(o>E&&i>E)for(;a<T&&(d[a]!=K||0==S[a]);)a++;else if(s>E&&c>E)for(;a<T&&(d[a]!=K||0==P[a]);)a++;else for(;a<T&&d[a]!=K;)a++;return r<l&&a<T&&(t[0]=r,t[1]=a,!0)}function h(e,t,r){var a=e.g1,_=e.g2,n=e.n1,o=e.n2,i=e.core_1,s=e.core_2,c=e.in_1,E=e.in_2,l=e.out_1,T=e.out_2;if(R(t<n),R(r<o),R(i[t]==K),R(s[r]==K),!I(e.node_comp,a,t,_,r))return!1;for(var u=0,d=0,f=0,P=0,A=0,S=0,p=0;p<Y(a,t);p++){var v=M(a,t,p);if(i[v]!=K){var m=i[v];if(!x(_,r,m)||!U(e.edge_comp,a,t,v,_,r,m))return!1}else c[v]&&f++,l[v]&&u++,c[v]||l[v]||A++}for(var p=0;p<L(a,t);p++){var v=y(a,t,p);if(i[v]!=K){var m=i[v];if(!x(_,m,r)||!U(e.edge_comp,a,v,t,_,m,r))return!1}else c[v]&&f++,l[v]&&u++,c[v]||l[v]||A++}for(var p=0;p<Y(_,r);p++){var m=M(_,r,p);if(s[m]!=K){var v=s[m];if(!x(a,t,v))return!1}else E[m]&&P++,T[m]&&d++,E[m]||T[m]||S++}for(var p=0;p<L(_,r);p++){var m=y(_,r,p);if(s[m]!=K){var v=s[m];if(!x(a,v,t))return!1}else E[m]&&P++,T[m]&&d++,E[m]||T[m]||S++}return f<=P&&u<=d&&A<=S}function R(e){e||k.panic("Assertion failed")}function I(e,t,r,a,_){return!!e(b(t,r),b(a,_))}function b(e,t){for(var r=e.nodes,a=0;a<r.length;a+=2)if(r[a]==t)return r[a+1];return null}function Y(e,t){for(var r=e.edges,a=0,_=0;_<r.length;_+=3)r[_]==t&&a++;return a}function L(e,t){for(var r=e.edges,a=0,_=0;_<r.length;_+=3)r[_+1]==t&&a++;return a}function M(e,t,r){for(var a=e.edges,_=0,n=0;n<a.length;n+=3)if(a[n]==t){if(_==r)return a[n+1];_++}return K}function y(e,t,r){for(var a=e.edges,_=0,n=0;n<a.length;n+=3)if(a[n+1]==t){if(_==r)return a[n];_++}return K}function x(e,t,r){for(var a=e.edges,_=0;_<a.length;_+=3)if(a[_]==t&&a[_+1]==r)return!0;return!1}function U(e,t,r,a,_,n,o){for(var i=w(t,r,a),s=w(_,n,o),c=0;c<i;c++){for(var E=!1,l=0;l<s;l++)if(e(C(t,r,a,c),C(_,n,o,l))){E=!0;break}if(!E)return!1}return!0}function w(e,t,r){for(var a=0,_=e.edges,n=0;n<_.length;n+=3)_[n]==t&&_[n+1]==r&&a++;return a}function C(e,t,r,a){for(var _=e.edges,n=0,o=0;o<_.length;o+=3)if(_[o]==t&&_[o+1]==r){if(n==a)return _[o+2];n++}return null}function D(e,t,r){var a=e.g1,_=e.g2,n=e.n1,o=e.n2,i=e.core_1,s=e.core_2,c=e.in_1,E=e.in_2,l=e.out_1,T=e.out_2;R(t<n),R(r<o),R(e.core_len<n),R(e.core_len<o);var u=++e.core_len;e.added_node1=t,c[t]||(c[t]=u,e.t1in_len++,l[t]&&e.t1both_len++),l[t]||(l[t]=u,e.t1out_len++,c[t]&&e.t1both_len++),E[r]||(E[r]=u,e.t2in_len++,T[r]&&e.t2both_len++),T[r]||(T[r]=u,e.t2out_len++,E[r]&&e.t2both_len++),i[t]=r,s[r]=t;for(var d=0;d<L(a,t);d++){var f=y(a,t,d);c[f]||(c[f]=u,e.t1in_len++,l[f]&&e.t1both_len++)}for(var d=0;d<Y(a,t);d++){var f=M(a,t,d);l[f]||(l[f]=u,e.t1out_len++,c[f]&&e.t1both_len++)}for(var d=0;d<L(_,r);d++){var f=y(_,r,d);E[f]||(E[f]=u,e.t2in_len++,T[f]&&e.t2both_len++)}for(var d=0;d<Y(_,r);d++){var f=M(_,r,d);T[f]||(T[f]=u,e.t2out_len++,E[f]&&e.t2both_len++)}}function F(e){R(e.core_len-e.orig_core_len<=1),R(e.added_node1!=K);var t=e.g1,r=e.g2,a=e.core_len,_=e.added_node1,n=e.core_1,o=e.core_2,i=e.in_1,s=e.in_2,c=e.out_1,E=e.out_2;if(e.orig_core_len<a){i[_]==a&&(i[_]=0);for(var l=0;l<L(t,_);l++){var T=y(t,_,l);i[T]==a&&(i[T]=0)}c[_]==a&&(c[_]=0);for(var l=0;l<Y(t,_);l++){var T=M(t,_,l);c[T]==a&&(c[T]=0)}var u=n[_];s[u]==a&&(s[u]=0);for(var l=0;l<L(r,u);l++){var T=y(r,u,l);s[T]==a&&(s[T]=0)}E[u]==a&&(E[u]=0);for(var l=0;l<Y(r,u);l++){var T=M(r,u,l);E[T]==a&&(E[T]=0)}n[_]=K,o[u]=K,e.core_len=e.orig_core_len,e.added_node1=K}}function G(e){var t={};return t.g1=e.g1,t.g2=e.g2,t.node_comp=e.node_comp,t.edge_comp=e.edge_comp,t.n1=e.n1,t.n2=e.n2,t.order=e.order,t.core_len=t.orig_core_len=e.core_len,t.t1in_len=e.t1in_len,t.t1out_len=e.t1out_len,t.t1both_len=e.t1both_len,t.t2in_len=e.t2in_len,t.t2out_len=e.t2out_len,t.t2both_len=e.t2both_len,t.added_node1=K,t.core_1=e.core_1,t.core_2=e.core_2,t.in_1=e.in_1,t.in_2=e.in_2,t.out_1=e.out_1,t.out_2=e.out_2,t.share_count=e.share_count,e.share_count[0]+=1,t}var k=Object(n.a)(e),K=-1,B=0,X=10,j=20,H=30,Q=[K,K];t.NULL_NODE=K,t.FORWARD_DIR=X,t.BACKWARD_DIR=j,t.TWO_WAY=H,t.create=function(){for(var e=arguments,t=[],r=[],a=0;a<e.length;a++){var _=e[a];switch(_.length){case 2:t.push(_[0],_[1]);break;case 3:r.push(_[0],_[1],_[2]);break;default:k.panic("Wrong graph constructor params")}}return{nodes:t,edges:r}},t.clone=function(e,t,r){if(t)for(var a=new Array(e.nodes.length),_=0;_<e.nodes.length;_+=2)a[_]=e.nodes[_],a[_+1]=t(e.nodes[_+1]);else var a=o.O(e.nodes);if(r)for(var n=new Array(e.edges.length),_=0;_<e.edges.length;_+=3)n[_]=e.edges[_],n[_+1]=e.edges[_+1],n[_+2]=r(e.edges[_+2]);else var n=o.O(e.edges);return e={nodes:a,edges:n}},t.create_node_edge_arr=function(e,t){for(var r=[],a=[],_=0;_<e.length;_++)r.push(e[_][0],e[_][1]);for(var _=0;_<t.length;_++)a.push(t[_][0],t[_][1],t[_][2]);return{nodes:r,edges:a}},t.append_node=r,t.has_node=a,t.append_edge=_,t.remove_node=i,t.remove_edge=s,t.remove_edge_by_attr=c,t.append_node_attr=function(e,t){if(l(e,t)==K){var a=E(e);return r(e,a,t),a}k.panic("Non-unique attribute")},t.replace_edge_attr=function(e,t,r,a,_){for(var n=e.edges,o=0;o<n.length;o+=3)n[o]==t&&n[o+1]==r&&n[o+2]==a&&(n[o+2]=_)},t.append_subgraph=function(e,t,a,n){a=a||[],n=n||[];for(var o={},i=0;i<e.nodes.length;i+=2){var s=e.nodes[i],c=e.nodes[i+1],l=E(t);r(t,l,c),o[s]=l}for(var i=0;i<e.edges.length;i+=3){var T=o[e.edges[i]],u=o[e.edges[i+1]],d=e.edges[i+2];_(t,T,u,d)}for(var i=0;i<a.length;i+=3){var T=o[a[i]],f=a[i+1],d=a[i+2];_(t,T,f,d)}for(var i=0;i<n.length;i+=3){var P=n[i],u=o[n[i+1]],d=n[i+2];_(t,P,u,d)}},t.gen_node_id=E,t.node_by_attr=l,t.append_edge_attr=function(e,t,r,a){var n=l(e,t),o=l(e,r);n!=K&&o!=K?_(e,n,o,a):k.panic("Attributes not found")},t.traverse=function(e,t){for(var r=e.nodes,a=0;a<r.length&&!t(r[a],r[a+1]);a+=2);},t.traverse_edges=function(e,t){for(var r=e.edges,a=0;a<r.length&&!t(r[a],r[a+1],r[a+2]);a+=3);},t.traverse_inputs=function(e,t,r){for(var a=e.edges,_=0;_<a.length;_+=3)if(a[_+1]==t){var n=a[_];if(r(n,b(e,n),a[_+2]))return}},t.traverse_outputs=function(e,t,r){for(var a=e.edges,_=0;_<a.length;_+=3)if(a[_]==t){var n=a[_+1];if(r(n,b(e,n),a[_+2]))return}},t.topsort=T,t.topsort_attr=function(e){for(var t=T(e).nodes,r=[],a=0;a<t.length;a+=2)r.push(t[a+1]);return r},t.is_connected=function(e){},t.subgraph_node_conn=function(e,t,r){a(e,t)||k.panic("No such node");var _={};u(e,_),f(e,t,_,r);var n=[];for(var o in _)if(_[o]){var o=Number(o);n.push(o,b(e,o))}var i={nodes:n,edges:e.edges.slice(0)};return P(i),i},t.cleanup_loose_edges=P,t.get_source_nodes=function(e){for(var t=[],r=e.nodes,a=0;a<r.length;a+=2){var _=r[a];L(e,_)||t.push(_)}return t},t.get_sink_nodes=A,t.match=function(e,t,r,a){var _={};_.g1=p(e),_.g2=p(t),_.node_comp=r||function(e,t){return e==t},_.edge_comp=a||function(e,t){return e==t};var n=S(e),o=S(t);_.n1=n,_.n2=o,_.order=B,_.core_len=_.orig_core_len=0,_.t1both_len=_.t1in_len=_.t1out_len=0,_.t2both_len=_.t2in_len=_.t2out_len=0,_.added_node1=K,_.core_1=Array(n),_.core_2=Array(o),_.in_1=new Array(n),_.in_2=new Array(o),_.out_1=new Array(n),_.out_2=new Array(o),_.share_count=[1];for(var i=0;i<n;i++)_.core_1[i]=K,_.in_1[i]=0,_.out_1[i]=0;for(var i=0;i<o;i++)_.core_2[i]=K,_.in_2[i]=0,_.out_2[i]=0;var s=new Array(n),c=new Array(n);if(v(s,c,_)){for(var i=0;i<s.length;i++)s[i]=e.nodes[2*s[i]],c[i]=t.nodes[2*c[i]];return[s,c]}return null},t.get_node_id=function(e,t){for(var r=e.nodes,a=1;a<r.length;a+=2)if(r[a]==t)return r[a-1];return null},t.get_node_attr=b,t.out_edge_count=Y,t.in_edge_count=L,t.get_out_edge=M,t.get_in_edge=y,t.get_edge_count=w,t.get_edge_attr=C,t.replace=function(e,t,a){for(var _=e.edges,n=E(e),o=0;o<t.length;o++){var s=t[o];i(e,s);for(var c=0;c<_.length;c+=3)_[c]==s&&(_[c]=n),_[c+1]==s&&(_[c+1]=n),_[c]==_[c+1]&&(_.splice(c,3),c-=3)}r(e,n,a)},t.reconnect_edges=function(e,t,r,a,_){x(e,t,r)||k.panic("Edge not found");for(var n=e.edges,o=0;o<n.length;o+=3)n[o]==t&&n[o+1]==r&&(n[o]=a,n[o+1]=_)},t.enforce_acyclic=function(e,t){function r(e,t){if(-1!=i.indexOf(e)){var a=i.slice(i.indexOf(e));if(-1!=_[a[a.length-1]].indexOf(a[0]))return void c.push([e,a[a.length-1]])}i.push(e);for(var n=0;n<t.length;n++)t[n]in _&&r(t[n],_[t[n]])}t||(t=A(e)[0]);var a=e.edges;if(!a.length||-1==a.indexOf(t))return e;for(var _={},n=0,o=0;o<a.length;o+=3)a[o+1]in _?_[a[o+1]].push(a[o]):_[a[o+1]]=[a[o]],n++;var i=[],c=[];r(t,_[t]);for(var o=0;o<c.length;o++){n=0;for(var E=0;E<a.length;E+=3)c[o][1]==a[E+1]&&c[o][0]==a[E]&&s(e,a[E],a[E+1],n),n++}return e},t.debug_dot=function(e,t,r){var a=e.nodes,_=e.edges,n="digraph debug {\n";n+="    ",n+="node [shape=box];\n";for(var o=0;o<a.length;o+=2){var i=a[o],s=a[o+1],c=t?t(i,s):String(i);n+="    ",n+=String(i)+' [label="'+c.replace(/\"/g,'\\"')+'"];\n'}for(var o=0;o<_.length;o+=3){var E=_[o],l=_[o+1],s=_[o+2];n+="    ",n+=String(E)+" -> "+String(l),r&&(n+=' [label="'+r(E,l,s)+'"]'),n+=";\n"}return n+="}"}}var _=r(0),n=r(5),o=r(2),i=Object(_.a)("__graph",a);t.a=i},function(e,t,r){"use strict";function a(e,t){function r(){var e=p.get_canvas(),t=e.clientHeight,r=e.clientWidth;return O.pick_object(r/2,t/2)}function a(e,t,r){var a=R.get_active(),_=e.draw_data[0].bundles[0],n=_.batch,o=t.draw_data[0].bundles[0],i=o.batch;if("quality"in r){var s=r.quality;8===s||16===s||24===s||32===s?(e.ssao_samples=s,A.set_batch_directive(n,"SSAO_QUALITY","SSAO_QUALITY_"+s),A.update_shader(n),I.append_draw_data(e,_)):g.error('set_ssao_params(): Wrong "quality" value.')}if("use_hemisphere"in r&&(e.ssao_hemisphere=r.use_hemisphere,A.set_batch_directive(n,"SSAO_HEMISPHERE",0|r.use_hemisphere),A.update_shader(n),I.append_draw_data(e,_)),"use_blur_depth"in r&&(t.ssao_blur_depth=r.use_blur_depth,A.set_batch_directive(i,"SSAO_BLUR_DEPTH",0|r.use_blur_depth),A.update_shader(i),I.append_draw_data(t,o),R.connect_render_targets_batch(a._render.graph,t,i,!1)),"ssao_white"in r&&(e.ssao_white=r.ssao_white,A.set_batch_directive(n,"SSAO_WHITE",0|r.ssao_white),A.update_shader(n),I.append_draw_data(e,_)),"blur_discard_value"in r&&(t.ssao_blur_discard_value=r.blur_discard_value),"radius_increase"in r&&(e.ssao_radius_increase=r.radius_increase),"influence"in r&&(e.ssao_influence=r.influence),"dist_factor"in r&&(e.ssao_dist_factor=r.dist_factor),"boolean"==typeof r.ssao_only){var c=R.get_subs(a,I.MAIN_OPAQUE);c.ssao_only=r.ssao_only;for(var E=c.draw_data,l=[],T=0;T<E.length;T++)for(var u=E[T].bundles,d=0;d<u.length;d++){var f=u[d].batch;A.set_batch_directive(f,"SSAO_ONLY",0|r.ssao_only),A.update_shader(f),l.push(u[d])}for(var T=0;T<l.length;T++)I.append_draw_data(c,l[T])}e.need_perm_uniforms_update=!0,t.need_perm_uniforms_update=!0}function _(e){return N.is_dynamic_mesh(e)||N.is_empty(e)||N.is_line(e)||N.is_lamp(e)}var A=Object(n.a)(e),S=Object(o.a)(e),p=Object(i.a)(e),v=Object(s.a)(e),m=Object(c.a)(e),O=Object(E.a)(e),N=Object(l.a)(e),g=Object(T.a)(e),h=Object(u.a)(e),R=Object(d.a)(e),I=Object(f.a)(e);t.DATA_ID_ALL=O.DATA_ID_ALL,t.set_active=function(e){var t=R.get_all_scenes();R.set_active(P._19("name",e,t))},t.get_active=function(){return R.check_active()?R.get_active().name:""},t.get_scenes=function(){for(var e=R.get_all_scenes(),t=[],r=0;r<e.length;r++)t.push(e[r].name);return t},t.get_active_camera=function(){return R.check_active()?R.get_camera(R.get_active()):(g.error("No active scene"),!1)},t.get_object_by_name=function(e,t){var r=O.get_object(O.GET_OBJECT_BY_NAME,e,0|t,!0);if(r)return r;g.error("get object "+e+": not found")},t.get_object_by_dupli_name=function(e,t,r){var a=O.get_object(O.GET_OBJECT_BY_DUPLI_NAME,e,t,0|r);if(a)return a;g.error("get object "+t+": not found")},t.get_object_by_dupli_name_list=function(e,t){var r=O.get_object(O.GET_OBJECT_BY_DUPLI_NAME_LIST,e,0|t);if(r)return r;g.error("get object "+e+": not found")},t.get_world_by_name=function(e,t){var r=O.get_world_by_name(e,0|t);if(r)return r;g.error("get object "+e+": not found")},t.get_object_data_id=function(e){return N.get_object_data_id(e)},t.pick_object=function(e,t){var a=R.get_main();if(!a)return g.error("No active scene"),null;var _=R.get_subs(a,I.STEREO);return _&&_.enable_hmd_stereo?(g.error_once("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),r()):O.pick_object(e,t)},t.pick_center=r,t.outlining_is_enabled=function(e){return e&&e.render&&e.render.outlining},t.set_outline_intensity=function(e,t){e&&e.render&&e.render.outlining?O.set_outline_intensity(e,t):g.error("set_outline_intensity(): wrong object")},t.get_outline_intensity=function(e){return e&&e.render&&e.render.outlining?e.render.outline_intensity:(g.error("get_outline_intensity(): wrong object"),0)},t.apply_outline_anim=function(e,t,r,a){e&&e.render&&e.render.outlining?O.apply_outline_anim(e,t,r,a):g.error("apply_outline_anim(): wrong object")},t.apply_outline_anim_def=function(e){if(e&&e.render&&e.render.outlining){var t=e.render.outline_anim_settings_default;O.apply_outline_anim(e,t.outline_duration,t.outline_period,t.outline_relapses)}else g.error("apply_outline_anim_def(): wrong object")},t.clear_outline_anim=function(e){e&&e.render&&e.render.outlining?O.clear_outline_anim(e):g.error("clear_outline_anim(): wrong object")},t.set_outline_color=R.set_outline_color,t.get_outline_color=function(e){var t=R.get_active(),r=R.get_subs(t,I.OUTLINE);if(r)return e=e||new Float32Array(3),e.set(r.outline_color),e},t.set_hmd_params=function(e){if(!R.check_active())return void g.error("No active scene");e&&(!e.distortion_coefs||e.distortion_coefs instanceof Array||(e.distortion_coefs=null),!e.chromatic_aberration_coefs||e.chromatic_aberration_coefs instanceof Array||(e.chromatic_aberration_coefs=null),"number"!=typeof e.base_line_factor&&(e.base_line_factor=null),"number"!=typeof e.inter_lens_factor&&(e.inter_lens_factor=null),"boolean"!=typeof e.enable_hmd_stereo&&(e.enable_hmd_stereo=null),R.set_hmd_params(e))},t.get_shadow_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active(),t=R.get_subs(e,I.SHADOW_CAST);if(!t)return null;var r=e._render.shadow_params,a=R.get_subs(e,I.MAIN_OPAQUE),_=R.get_subs(e,I.SHADOW_RECEIVE),n={};return n.csm_resolution=r.csm_resolution,n.self_shadow_polygon_offset=t.self_shadow_polygon_offset,_&&(n.self_shadow_normal_offset=_.self_shadow_normal_offset),n.enable_csm=r.enable_csm,n.csm_num=r.csm_num,n.csm_first_cascade_border=r.csm_first_cascade_border,n.first_cascade_blur_radius=r.first_cascade_blur_radius,n.csm_last_cascade_border=r.csm_last_cascade_border,n.last_cascade_blur_radius=r.last_cascade_blur_radius,n.fade_last_cascade=r.fade_last_cascade,n.blend_between_cascades=r.blend_between_cascades,r.enable_csm?(n.csm_borders=R.get_csm_borders(e,a.camera),n.blur_radii=new Float32Array(r.csm_num),n.blur_radii.set(a.camera.pcf_blur_radii.subarray(0,r.csm_num))):(n.csm_borders=null,n.blur_radii=null),n},t.set_shadow_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();"number"==typeof e.self_shadow_polygon_offset&&m.traverse(t._render.graph,function(t,r){r.type==I.SHADOW_CAST&&(r.self_shadow_polygon_offset=e.self_shadow_polygon_offset)});for(var r=R.subs_array(t,[I.SHADOW_RECEIVE]),a=0;a<r.length;a++){var _=r[a];"number"==typeof e.self_shadow_normal_offset&&(_.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(_.pcf_blur_radius=e.pcf_blur_radius)}for(var n=R.subs_array(t,[I.MAIN_BLEND]),a=0;a<n.length;a++){var o=n[a];"number"==typeof e.self_shadow_normal_offset&&(o.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(o.pcf_blur_radius=e.pcf_blur_radius),o.need_perm_uniforms_update=!0}var i=t._render.shadow_params;if("number"==typeof e.csm_first_cascade_border&&(i.csm_first_cascade_border=e.csm_first_cascade_border),"number"==typeof e.first_cascade_blur_radius&&(i.first_cascade_blur_radius=e.first_cascade_blur_radius),"number"==typeof e.csm_last_cascade_border&&(i.csm_last_cascade_border=e.csm_last_cascade_border),"number"==typeof e.last_cascade_blur_radius&&(i.last_cascade_blur_radius=e.last_cascade_blur_radius),_){for(var s=_.draw_data,a=0;a<s.length;a++)for(var c=s[a].bundles,E=0;E<c.length;E++){var l=c[E];if(l.obj_render.shadow_receive){var T=l.batch;A.assign_shadow_receive_dirs(T,i),A.update_shader(T),I.append_draw_data(_,l)}}_.need_perm_uniforms_update=!0}for(var u=N.get_scene_data(t._camera,t),d=u.cameras,a=0;a<d.length;a++)S.update_camera_shadows(d[a],i);R.schedule_shadow_update(t)},t.get_environment_colors=function(){if(!R.check_active())return g.error("No active scene"),[];var e=R.get_active();return R.get_environment_colors(e)},t.set_environment_colors=function(e,t,r){if(!R.check_active())return void g.error("No active scene");var a=R.get_active(),_=R.get_subs(a,I.MAIN_OPAQUE),n=e||0==e?parseFloat(e):_.environment_energy,o=t||0==t?t:_.horizon_color,i=r||0==r?r:_.zenith_color;R.set_environment_colors(a,n,o,i)},t.get_fog_color_density=function(e){if(!R.check_active())return g.error("No active scene"),!1;var t=R.get_active();return R.get_fog_color_density(t,e)},t.set_fog_color_density=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();R.set_fog_color_density(t,e)},t.get_fog_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active(),t={};return t.fog_intensity=R.get_fog_intensity(e),t.fog_depth=R.get_fog_depth(e),t.fog_start=R.get_fog_start(e),t.fog_height=R.get_fog_height(e),t},t.set_fog_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();"number"==typeof e.fog_intensity&&R.set_fog_intensity(t,e.fog_intensity),"number"==typeof e.fog_depth&&R.set_fog_depth(t,e.fog_depth),"number"==typeof e.fog_start&&R.set_fog_start(t,e.fog_start),"number"==typeof e.fog_height&&R.set_fog_height(t,e.fog_height)},t.get_ssao_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_ssao_params(e)},t.set_ssao_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active(),r=R.subs_array(t,[I.SSAO]),_=R.subs_array(t,[I.SSAO_BLUR]);if(!r.length)return g.error("SSAO is not enabled on the scene"),0;for(var n=0;n<r.length;n++)a(r[n],_[n],e)},t.get_color_correction_params=function(){if(!R.check_active())return g.error("No active scene"),null;var e=R.get_active(),t=R.get_subs(e,I.COMPOSITING);if(!t)return null;var r={};return r.brightness=t.brightness,r.contrast=t.contrast,r.exposure=t.exposure,r.saturation=t.saturation,r},t.set_color_correction_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active(),r=R.get_subs(t,I.COMPOSITING);r&&("brightness"in e&&(r.brightness=e.brightness),"contrast"in e&&(r.contrast=e.contrast),"exposure"in e&&(r.exposure=e.exposure),"saturation"in e&&(r.saturation=e.saturation),r.need_perm_uniforms_update=!0)},t.get_sky_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_sky_params(e)},t.set_sky_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active(),r=R.get_subs(t,I.SKY);r&&("color"in e&&r.sky_color.set(e.color),"rayleigh_brightness"in e&&(r.rayleigh_brightness=e.rayleigh_brightness),"mie_brightness"in e&&(r.mie_brightness=e.mie_brightness),"spot_brightness"in e&&(r.spot_brightness=e.spot_brightness),"scatter_strength"in e&&(r.scatter_strength=e.scatter_strength),"rayleigh_strength"in e&&(r.rayleigh_strength=e.rayleigh_strength),"mie_strength"in e&&(r.mie_strength=e.mie_strength),"rayleigh_collection_power"in e&&(r.rayleigh_collection_power=e.rayleigh_collection_power),"mie_collection_power"in e&&(r.mie_collection_power=e.mie_collection_power),"mie_distribution"in e&&(r.mie_distribution=e.mie_distribution),r.need_perm_uniforms_update=!0,r.need_fog_update=!0,R.update_sky(t,r))},t.get_dof_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_subs(e,I.DOF)?R.get_dof_params(e):null},t.set_dof_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();R.set_dof_params(t,e)},t.get_god_rays_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_subs(e,I.GOD_RAYS)?R.get_god_rays_params(e):null},t.set_god_rays_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();R.set_god_rays_params(t,e)},t.get_bloom_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_subs(e,I.BLOOM)?R.get_bloom_params(e):null},t.set_bloom_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();R.set_bloom_params(t,e)},t.get_glow_material_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_subs(e,I.GLOW_COMBINE)?R.get_glow_material_params(e):null},t.set_glow_material_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();R.set_glow_material_params(t,e)},t.get_wind_params=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_wind_params(e)},t.set_wind_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();O.set_wind_params(t,e)},t.get_water_surface_level=function(e,t){if(!R.check_active())return g.error("No active scene"),0;var r=R.get_active();return r._render.water_params?R.get_water_surface_level(r,e,t):(g.error("No water parameters on the active scene"),0)},t.set_water_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();R.set_water_params(t,e)},t.get_water_mat_params=function(e){if(!R.check_active())return void g.error("No active scene");var t=R.get_active();R.get_water_mat_params(t,e)},t.update_scene_materials_params=function(){if(!R.check_active())return void g.error("No active scene");var e=R.get_active();R.update_scene_permanent_uniforms(e)},t.hide_object=function(e,t){t=t||!1,_(e)?t?R.change_visibility(e,!0):R.change_visibility_rec(e,!0):g.error("show/hide is only supported for dynamic objects.")},t.show_object=function(e,t){t=t||!1,_(e)?t?R.change_visibility(e,!1):R.change_visibility_rec(e,!1):g.error("show/hide is only supported for dynamic objects.")},t.is_hidden=function(e){return _(e)?R.is_hidden(e):(g.error("show/hide is only supported for dynamic meshes/empties and lamps"),!1)},t.is_visible=function(e){return e.render.is_visible},t.check_object_by_name=function(e,t){return!!O.get_object(O.GET_OBJECT_BY_NAME,e,0|t,!0)},t.check_object_by_dupli_name=function(e,t,r){return!!O.get_object(O.GET_OBJECT_BY_DUPLI_NAME,e,t,0|r)},t.check_object_by_dupli_name_list=function(e,t){return!!O.get_object(O.GET_OBJECT_BY_DUPLI_NAME_LIST,e,0|t)},t.get_all_objects=function(e,t){var r=R.get_active();return e||(e="ALL"),t||0===t||(t=O.DATA_ID_ALL),O.get_scene_objs_derived(r,e,t)},t.get_object_name=function(e){return e?e.origin_name:(g.error("Wrong object name"),"")},t.get_object_name_hierarchy=function(e){if(!e)return g.error("Wrong object name"),null;for(var t=[],r=e;r;)t.push(r.origin_name),r=N.get_dg_parent(r);return t.reverse()},t.get_object_type=function(e){return e&&e.type?e.type:(g.error("Wrong object"),"UNDEFINED")},t.get_object_children=function(e){return e.cons_descends.slice(0)},t.get_first_character=function(){return O.get_first_character(R.get_active())},t.get_shore_dist=function(e,t){if(t||0===t||(t=1),!R.check_active())return g.error("No active scene"),0;var r=R.get_active();return R.get_shore_dist(r,e,t)},t.get_cam_water_depth=function(){return R.get_cam_water_depth()},t.get_type_mesh_object=function(e){return N.is_mesh(e)?e.render.type:""},t.get_meta_tags=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_meta_tags(e)},t.get_custom_prop=function(){if(!R.check_active())return g.error("No active scene"),!1;var e=R.get_active();return R.get_custom_prop(e)},t.append_object=function(e,t){if(t)var r=R.get_all_scenes(),a=P._19("name",t,r);else var a=R.get_active();R.append_object(a,e,!0),h.append_object(e,a)},t.remove_object=function(e){if(!N.is_dynamic_mesh(e)&&!N.is_empty(e)&&!N.is_line(e))return void g.error("Can't remove object \""+e.name+'". It must be dynamic and type of MESH or EMPTY.');O.obj_switch_cleanup_flags(e,e.render.is_copied_deep,!1,!1),v.prepare_object_unloading(e),O.obj_switch_cleanup_flags(e,!0,!0,!0),O.remove_object(e)},t.marker_frame=function(e){var t=R.get_active();return t.timeline_markers&&e in t.timeline_markers?R.marker_frame(t,e):(g.error('"'+e+'" marker not found.'),0)},t.get_mb_params=function(){var e=R.get_active(),t=R.get_subs(e,I.MOTION_BLUR);if(t){return{mb_factor:t.mb_factor,mb_decay_threshold:t.mb_decay_threshold}}return null},t.set_mb_params=function(e){var t=R.get_active(),r=R.subs_array(t,[I.MOTION_BLUR]);if(!r.length)return void g.error("The motion blur subscene doesn't exist.");for(var a=0;a<r.length;a++){var _=r[a];"number"==typeof e.mb_decay_threshold&&(_.mb_decay_threshold=e.mb_decay_threshold),"number"==typeof e.mb_factor&&(_.mb_factor=e.mb_factor)}},t.can_select_objects=function(){var e=R.get_active();return Boolean(R.get_subs(e,I.COLOR_PICKING))}}var _=r(0),n=r(16),o=r(14),i=r(15),s=r(46),c=r(30),E=r(12),l=r(9),T=r(1),u=r(19),d=r(10),f=r(11),P=r(2),A=Object(_.a)("scenes",a);t.a=A},function(e,t){function r(e,t){var r=e[1]||"",_=e[3];if(!_)return r;if(t&&"function"===typeof btoa){var n=a(_);return[r].concat(_.sources.map(function(e){return"/*# sourceURL="+_.sourceRoot+e+" */"})).concat([n]).join("\n")}return[r].join("\n")}function a(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var a=r(t,e);return t[2]?"@media "+t[2]+"{"+a+"}":a}).join("")},t.i=function(e,r){"string"===typeof e&&(e=[[null,e,""]]);for(var a={},_=0;_<this.length;_++){var n=this[_][0];"number"===typeof n&&(a[n]=!0)}for(_=0;_<e.length;_++){var o=e[_];"number"===typeof o[0]&&a[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="("+o[2]+") and ("+r+")"),t.push(o))}},t}},function(e,t,r){function a(e,t){for(var r=0;r<e.length;r++){var a=e[r],_=d[a.id];if(_){_.refs++;for(var n=0;n<_.parts.length;n++)_.parts[n](a.parts[n]);for(;n<a.parts.length;n++)_.parts.push(E(a.parts[n],t))}else{for(var o=[],n=0;n<a.parts.length;n++)o.push(E(a.parts[n],t));d[a.id]={id:a.id,refs:1,parts:o}}}}function _(e,t){for(var r=[],a={},_=0;_<e.length;_++){var n=e[_],o=t.base?n[0]+t.base:n[0],i=n[1],s=n[2],c=n[3],E={css:i,media:s,sourceMap:c};a[o]?a[o].parts.push(E):r.push(a[o]={id:o,parts:[E]})}return r}function n(e,t){var r=P(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var a=p[p.length-1];if("top"===e.insertAt)a?a.nextSibling?r.insertBefore(t,a.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),p.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!==typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var _=P(e.insertInto+" "+e.insertAt.before);r.insertBefore(t,_)}}function o(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=p.indexOf(e);t>=0&&p.splice(t,1)}function i(e){var t=document.createElement("style");return e.attrs.type="text/css",c(t,e.attrs),n(e,t),t}function s(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",c(t,e.attrs),n(e,t),t}function c(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function E(e,t){var r,a,_,n;if(t.transform&&e.css){if(!(n=t.transform(e.css)))return function(){};e.css=n}if(t.singleton){var c=S++;r=A||(A=i(t)),a=l.bind(null,r,c,!1),_=l.bind(null,r,c,!0)}else e.sourceMap&&"function"===typeof URL&&"function"===typeof URL.createObjectURL&&"function"===typeof URL.revokeObjectURL&&"function"===typeof Blob&&"function"===typeof btoa?(r=s(t),a=u.bind(null,r,t),_=function(){o(r),r.href&&URL.revokeObjectURL(r.href)}):(r=i(t),a=T.bind(null,r),_=function(){o(r)});return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else _()}}function l(e,t,r,a){var _=r?"":a.css;if(e.styleSheet)e.styleSheet.cssText=m(t,_);else{var n=document.createTextNode(_),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}function T(e,t){var r=t.css,a=t.media;if(a&&e.setAttribute("media",a),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function u(e,t,r){var a=r.css,_=r.sourceMap,n=void 0===t.convertToAbsoluteUrls&&_;(t.convertToAbsoluteUrls||n)&&(a=v(a)),_&&(a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(_))))+" */");var o=new Blob([a],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var d={},f=function(e){var t;return function(){return"undefined"===typeof t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),P=function(e){var t={};return function(r){if("undefined"===typeof t[r]){var a=e.call(this,r);if(a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[r]=a}return t[r]}}(function(e){return document.querySelector(e)}),A=null,S=0,p=[],v=r(105);e.exports=function(e,t){if("undefined"!==typeof DEBUG&&DEBUG&&"object"!==typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},t.attrs="object"===typeof t.attrs?t.attrs:{},t.singleton||(t.singleton=f()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=_(e,t);return a(r,t),function(e){for(var n=[],o=0;o<r.length;o++){var i=r[o],s=d[i.id];s.refs--,n.push(s)}if(e){a(_(e,t),t)}for(var o=0;o<n.length;o++){var s=n[o];if(0===s.refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete d[s.id]}}}};var m=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}()},function(e,t,r){"use strict";function a(e,t){function r(e,t){var n=t;switch(typeof e){case"object":if(e)switch(e.constructor){case Object:for(var o in e)n=r(e[o],n);break;case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:for(var s=0;s<e.length;s++)n=a(e[s],n);break;case Array:for(var s=0;s<e.length;s++)n=r(e[s],n);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:n=a(0,n);break;default:i.panic("Wrong object constructor:",e.constructor)}else n=a(0,n);return n;case"number":return a(e,n);case"boolean":return a(0|e,n);case"string":return _(e,n);case"function":case"undefined":return a(0,n)}}function a(e,t){var r=t;return T[0]=e,r=(r<<5)-r+u[0],r&=r,r=(r<<5)-r+u[1],r&=r}function _(e,t){for(var r=t,a=0;a<e.length;a++){r=(r<<5)-r+e.charCodeAt(a),r&=r}return r}var i=Object(n.a)(e),s=Object(o.a)(e),c=1,E=0,l={},T=new Float64Array(1),u=new Uint32Array(T.buffer);t.unique_name=function(e){l[e]||(l[e]=0);var t=e+l[e];return l[e]++,t},t.cleanup=function(){E=0,l={}},t.unique_id=function(){return E++,E.toString(10)},t.gen_color_id=function(e){++e>132651&&s.error("Color ID pool depleted");var t=Math.floor(e/2601);e%=2601;var r=Math.floor(e/51);e%=51;var a=e;return new Float32Array([t/51,r/51,a/51])},t.rand=function(){return c=(69069*c+5)%Math.pow(2,32),Math.round(c/65536)%32768/32767},t.srand=function(e){c=e},t.calc_variable_id=function(e,t){return r(e,t)},t.hash_code=r}var _=r(0),n=r(5),o=r(1),i=Object(_.a)("generator",a);t.a=i},function(e,t,r){"use strict";var a,_=!1;try{a=window.b4w}catch(e){a=self.b4w,_=!0}if(!a){var a={};_?self.b4w=a:window.b4w=a;var n={},o={};a.module=n,a._n_module=o;var i={};a.cleanup=function(e,t){t=t||"__b4w_default";var r=n[e];r&&(r._compiled=null),i[t]=null},a.register=function(e,t){n[e]||(n[e]=t)},a.require=function(e,t){if(!n[e]&&!o[e])throw new Error('Module "'+e+'" not found');return t=t||"__b4w_default",void 0!==o[e]?o[e](t):(i[t]||(i[t]=function(e){return function(t){if(!n[t]&&!o[t])throw new Error('Module "'+t+'" not found');if(void 0!==o[t])return o[t](e);var r=n[t];return r._compiled||(r._compiled={}),r._compiled[e]||(r._compiled[e]={},r(r._compiled[e],i[e])),r._compiled[e]}}(t)),i[t](e))},a.module_check=function(e){return void 0!==n[e]||void 0!==o[e]},a.get_namespace=function(e){for(var t in i)if(i[t]==e)return t;return""},a.worker_listeners=[],a.worker_namespaces=[]}t.a=a},function(e,t,r){"use strict";function a(e,t){function r(e,t){if(!S.is_camera(e))return v.error("get_view_vector(): Wrong camera object"),null;t=t||new Float32Array(3);var r=u.g(e.render.world_tsr,R);return d._34(r,d.c,t),t}var a=Object(n.a)(e),_=Object(o.a)(e),S=Object(s.a)(e),p=Object(c.a)(e),v=Object(E.a)(e),m=Object(l.a)(e),O=Object(T.a)(e),N=new Float32Array(2),g=new Float32Array(3),h=new Float32Array(3),R=(new Float32Array(4),A.create()),I={},b={};t.MS_STATIC=a.MS_STATIC,t.MS_TARGET_CONTROLS=a.MS_TARGET_CONTROLS,t.MS_EYE_CONTROLS=a.MS_EYE_CONTROLS,t.MS_HOVER_CONTROLS=a.MS_HOVER_CONTROLS,t.static_setup=function(e,t){if(!S.is_camera(e))return void v.error("static_setup(): Wrong camera object");if(a.wipe_move_style(e),e.render.move_style=a.MS_STATIC,t){var r=t.pos||u.j(e.render.world_tsr,g);t.look_at?a.set_look_at(e,r,t.look_at):O.set_translation(e,r)}O.update_transform(e),p.sync_transform(e),a.init_ortho_props(e)},t.static_set_look_at=function(e,t,r){if(!a.is_static_camera(e))return void v.error("static_set_look_at(): Wrong camera object or camera move style");t=t||u.j(e.render.world_tsr,g),r?a.set_look_at(e,t,r):O.set_translation(e,t),O.update_transform(e),p.sync_transform(e)},t.static_set_rotation=function(e,t){if(!a.is_static_camera(e))return void v.error("static_set_rotation(): Wrong camera object or camera move style");O.set_rotation(e,t),O.update_transform(e),p.sync_transform(e)},t.static_get_rotation=function(e,t){return a.is_static_camera(e)?(t=t||new Float32Array(4),O.get_rotation(e,t)):(v.error("static_get_rotation(): Wrong camera object or camera move style"),null)},t.eye_setup=function(e,t){if(!S.is_camera(e))return void v.error("eye_setup(): Wrong camera object");if(t&&t.horiz_rot_lim&&("number"!=typeof t.horiz_rot_lim.left||"number"!=typeof t.horiz_rot_lim.right))return void v.error("eye_setup(): Wrong horizontal limits object.");if(t&&t.vert_rot_lim&&("number"!=typeof t.vert_rot_lim.down||"number"!=typeof t.vert_rot_lim.up))return void v.error("eye_setup(): Wrong vertical limits object.");if(a.wipe_move_style(e),e.render.move_style=a.MS_EYE_CONTROLS,t){var r=t.pos||u.j(e.render.world_tsr,g);a.setup_eye_model(e,r,t.look_at,t.horiz_rot_lim,t.vert_rot_lim)}O.update_transform(e),p.sync_transform(e),a.init_ortho_props(e)},t.eye_set_look_at=function(e,t,r){if(!a.is_eye_camera(e))return void v.error("eye_set_look_at(): Wrong camera object or camera move style");t=t||u.j(e.render.world_tsr,g),r?a.set_look_at_corrected(e,t,r):O.set_translation(e,t),a.correct_up(e,e.render.vertical_axis,!0),O.update_transform(e),p.sync_transform(e)},t.eye_rotate=function(e,r,_,n){if(v.error_deprecated("eye_rotate","rotate_camera"),!a.is_eye_camera(e))return void v.error("eye_rotate(): Wrong camera object or camera move style");n=n||!1,t.rotate_camera(e,r,_,n)},t.eye_set_vertical_limits=function(e,t){return a.is_eye_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(a.set_vertical_rot_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("eye_set_vertical_limits(): Incorrect limits object."):void v.error("eye_set_vertical_limits(): Wrong camera object or camera move style")},t.eye_get_vertical_limits=function(e,t,r){if(!a.is_eye_camera(e))return v.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.vertical_limits?(t=t||{},r?(t.down=_.vertical_limits.down_local,t.up=_.vertical_limits.up_local):(t.down=_.vertical_limits.down,t.up=_.vertical_limits.up),t.camera_space=r||!1,t):null},t.eye_set_horizontal_limits=function(e,t){return a.is_eye_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(a.set_horizontal_rot_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("eye_set_horizontal_limits(): Incorrect limits object."):void v.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")},t.eye_get_horizontal_limits=function(e,t,r){if(!a.is_eye_camera(e))return v.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.horizontal_limits?(t=t||{},r?(t.left=_.horizontal_limits.left_local,t.right=_.horizontal_limits.right_local):(t.left=_.horizontal_limits.left,t.right=_.horizontal_limits.right),t.camera_space=r||!1,t):null},t.target_setup=function(e,t){if(!S.is_camera(e))return void v.error("target_setup(): Wrong camera object");if(t.horiz_rot_lim&&("number"!=typeof t.horiz_rot_lim.left||"number"!=typeof t.horiz_rot_lim.right))return void v.error("target_setup(): Wrong horizontal limits object");if(t.vert_rot_lim&&("number"!=typeof t.vert_rot_lim.down||"number"!=typeof t.vert_rot_lim.up))return void v.error("target_setup(): Wrong vertical limits object");if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void v.error("target_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.pivot_lim&&("number"!=typeof t.pivot_lim.min_y||"number"!=typeof t.pivot_lim.max_y||t.pivot_lim.min_y>t.pivot_lim.max_y))return void v.error("target_setup(): Wrong pivot limits object");a.wipe_move_style(e),e.render.move_style=a.MS_TARGET_CONTROLS;var _=t.pos||u.j(e.render.world_tsr,g),n=t.pivot;if(!n){var o=r(e,h);n=f.add(_,o,o)}a.setup_target_model(e,_,n,t.horiz_rot_lim,t.vert_rot_lim,t.dist_lim,t.pivot_lim,t.use_panning||!1),O.update_transform(e),p.sync_transform(e),a.init_ortho_props(e)},t.target_rotate=function(e,r,_,n){if(v.error_deprecated("target_rotate","rotate_camera"),!a.is_target_camera(e))return void v.error("target_rotate(): Wrong camera object or camera move style");n=n||!1,t.rotate_camera(e,r,_,n)},t.target_set_trans_pivot=function(e,t,r){if(!a.is_target_camera(e))return void v.error("target_set_trans_pivot(): Wrong camera object or camera move style");t=t||u.j(e.render.world_tsr,g),r=r||e.render.pivot,a.set_trans_pivot(e,t,r),O.update_transform(e),p.sync_transform(e)},t.target_set_pivot_translation=function(e,t){if(!a.is_target_camera(e))return void v.error("target_set_pivot_translation(): Wrong camera object or camera move style");a.set_target_pivot(e,t),O.update_transform(e),p.sync_transform(e)},t.target_set_distance=function(e,t){if(!a.is_target_camera(e))return void v.error("target_set_distance(): Wrong camera object or camera move style");var r=O.obj_point_distance(e,e.render.pivot),_=Math.max(0,t);O.move_local(e,0,0,_-r),O.update_transform(e),p.sync_transform(e)},t.target_get_distance=function(e){return a.is_target_camera(e)?O.obj_point_distance(e,e.render.pivot):(v.error("target_get_distance(): Wrong camera object or camera move style"),0)},t.target_zoom_object=function(e,t){if(!a.is_target_camera(e))return void v.error("target_zoom_object(): Wrong camera object or camera move style");var r=O.get_object_center(t,!1,g),_=O.get_object_size(t),n=m.get_active(),o=S.get_scene_data(e,n),i=o.cameras[0],s=a.get_angular_diameter(i)/2,c=_/Math.sin(s),E=O.obj_point_distance(e,r);a.set_trans_pivot(e,u.j(e.render.world_tsr,h),r),O.update_transform(e),O.move_local(e,0,0,c-E),O.update_transform(e),p.sync_transform(e)},t.target_get_pivot=function(e,t){return a.is_target_camera(e)?(t=t||new Float32Array(3),f.copy(e.render.pivot,t),t):(v.error("target_get_pivot(): Wrong camera object or camera move style"),null)},t.target_set_distance_limits=function(e,t){if(!a.is_target_camera(e))return void v.error("target_set_distance_limits(): Wrong camera object or camera move style");if(t){if("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)return void v.error("target_set_distance_limits(): Wrong limits object");t.min=Math.max(t.min,0),t.max=Math.max(t.max,0)}a.set_distance_limits(e,t),O.update_transform(e),p.sync_transform(e)},t.target_get_distance_limits=function(e,t){if(!a.is_target_camera(e))return v.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var r=e.render;return r.distance_limits?(t=t||{},t.min=r.distance_limits.min,t.max=r.distance_limits.max,t):null},t.target_set_vertical_limits=function(e,t){return a.is_target_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(a.set_vertical_rot_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("target_set_vertical_limits(): Wrong limits object"):void v.error("target_set_vertical_limits(): Wrong camera object or camera move style")},t.target_get_vertical_limits=function(e,t,r){if(!a.is_target_camera(e))return v.error("target_get_vertical_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.vertical_limits?(t=t||{},r?(t.down=_.vertical_limits.down_local,t.up=_.vertical_limits.up_local):(t.down=_.vertical_limits.down,t.up=_.vertical_limits.up),t.camera_space=r||!1,t):null},t.target_set_horizontal_limits=function(e,t){return a.is_target_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(a.set_horizontal_rot_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("target_set_horizontal_limits(): Wrong limits object"):void v.error("target_set_horizontal_limits(): Wrong camera object or camera move style")},t.target_get_horizontal_limits=function(e,t,r){if(!a.is_target_camera(e))return v.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.horizontal_limits?(t=t||{},r?(t.left=_.horizontal_limits.left_local,t.right=_.horizontal_limits.right_local):(t.left=_.horizontal_limits.left,t.right=_.horizontal_limits.right),t.camera_space=r||!1,t):null},t.target_set_pivot_limits=function(e,t){return a.is_target_camera(e)?t&&("number"!=typeof t.min_z||"number"!=typeof t.max_z||t.min_z>t.max_z)?void v.error("target_set_pivot_limits(): Wrong limits object"):(a.set_pivot_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("target_set_pivot_limits(): Wrong camera object or camera move style")},t.target_get_pivot_limits=function(e,t){if(!a.is_target_camera(e))return v.error("target_get_pivot_limits(): Wrong camera object or camera move style"),null;var r=e.render;return r.pivot_limits?(t=t||{},t.min_z=r.pivot_limits.min_z,t.max_z=r.pivot_limits.max_z,t):null},t.target_pan_pivot=function(e,t,r){if(!a.is_target_camera(e))return void v.error("target_pan_pivot(): wrong object");var _=e.render;if(_.use_panning){var n=g;n[0]=t,n[1]=-r,n[2]=0,u.y(n,_.world_tsr,n),f.add(_.pivot,n,_.pivot);var o=u.j(_.world_tsr,h);f.add(o,n,o),u.v(o,_.world_tsr),O.update_transform(e),p.sync_transform(e)}},t.target_switch_panning=function(e,t){if(!a.is_target_camera(e))return v.error("target_switch_panning(): Wrong camera object or camera move style"),null;e.render.use_panning=t},t.hover_setup_rel=function(e,r){if(t.hover_setup(e,{pos:r.pos,pivot:r.pivot}),"undefined"==typeof r.dist_interval)var _=0;else var _=Math.max(r.dist_interval,0);if("undefined"==typeof r.angle_interval)var n=0;else var n=Math.max(r.angle_interval,0);if("undefined"==typeof r.t)var o=.5;else var o=d.M(r.t,0,1);var i=t.hover_get_distance_limits(e,I);i.min=Math.max(i.min-o*_,0),i.max=i.max+(1-o)*_;var s=t.hover_get_vertical_limits(e,b);s.down=d.M(s.down+o*n,-Math.PI/2,0),s.up=d.M(s.up-(1-o)*n,-Math.PI/2,0),a.hover_set_distance_limits(e,i),a.hover_set_vertical_limits(e,s),O.update_transform(e),p.sync_transform(e),a.init_ortho_props(e)},t.hover_setup=function(e,t){if(!S.is_camera(e))return void v.error("hover_setup(): Wrong camera object");if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void v.error("hover_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.hover_angle_lim&&("number"!=typeof t.hover_angle_lim.down||"number"!=typeof t.hover_angle_lim.up||t.hover_angle_lim.down<t.hover_angle_lim.up))return void v.error("hover_setup(): Wrong hover angle limits object");if(t.horiz_trans_lim&&("number"!=typeof t.horiz_trans_lim.min||"number"!=typeof t.horiz_trans_lim.max||t.horiz_trans_lim.min>t.horiz_trans_lim.max))return void v.error("hover_setup(): Wrong horizontal translation limits object");if(t.vert_trans_lim&&("number"!=typeof t.vert_trans_lim.min||"number"!=typeof t.vert_trans_lim.max||t.vert_trans_lim.min>t.vert_trans_lim.max))return void v.error("hover_setup(): Wrong vertical translation limits object");a.wipe_move_style(e),e.render.move_style=a.MS_HOVER_CONTROLS;var r=t.pos||u.j(e.render.world_tsr,g);a.setup_hover_model(e,r,t.pivot,t.dist_lim,t.hover_angle_lim,t.horiz_trans_lim,t.vert_trans_lim,t.enable_horiz_rot||!1),O.update_transform(e),p.sync_transform(e),a.init_ortho_props(e)},t.hover_rotate=function(e,r,_,n){if(v.error_deprecated("hover_rotate","rotate_camera"),!a.is_hover_camera(e))return void v.error("hover_rotate(): Wrong camera object or camera move style");n=n||!1,t.rotate_camera(e,r,_,n)},t.hover_set_pivot_translation=function(e,t){if(!a.is_hover_camera(e))return void v.error("hover_set_pivot_translation(): Wrong camera object or camera move style");a.set_hover_pivot(e,t),O.update_transform(e),p.sync_transform(e)},t.hover_get_pivot=function(e,t){return a.is_hover_camera(e)?(t=t||new Float32Array(3),f.copy(e.render.hover_pivot,t),t):(v.error("hover_get_pivot(): Wrong camera object or camera move style"),null)},t.hover_get_distance=function(e){return a.is_hover_camera(e)?O.obj_point_distance(e,e.render.hover_pivot):(v.error("hover_get_distance(): Wrong camera object or camera move style"),0)},t.hover_set_vertical_limits=function(e,t){return a.is_hover_camera(e)?"number"!=typeof t.down||"number"!=typeof t.up||t.down<t.up?void v.error("hover_set_vertical_limits(): Wrong limits object"):(a.hover_set_vertical_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("hover_set_vertical_limits(): Wrong camera object or camera move style")},t.hover_get_vertical_limits=function(e,t){if(!a.is_hover_camera(e))return v.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var r=e.render;return t=t||{},t.down=r.vertical_limits.down,t.up=r.vertical_limits.up,t},t.hover_set_distance_limits=function(e,t){return a.is_hover_camera(e)?"number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max?void v.error("hover_set_distance_limits(): Wrong limits object"):(t.min=Math.max(t.min,0),t.max=Math.max(t.max,0),a.hover_set_distance_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("hover_set_distance_limits(): Wrong camera object or camera move style")},t.hover_get_distance_limits=function(e,t){if(!a.is_hover_camera(e))return v.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var r=e.render;return t=t||{},t.min=r.distance_limits.min,t.max=r.distance_limits.max,t},t.hover_set_vert_trans_limits=function(e,t){return a.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?void v.error("hover_set_vert_trans_limits(): Wrong limits object"):(a.set_vert_trans_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")},t.hover_get_vert_trans_limits=function(e,t){if(!a.is_hover_camera(e))return v.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var r=e.render;return r.hover_vert_trans_limits?(t=t||{},t.min=r.hover_vert_trans_limits.min,t.max=r.hover_vert_trans_limits.max,t):null},t.hover_set_horiz_trans_limits=function(e,t){return a.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?void v.error("hover_set_horiz_trans_limits(): Wrong limits object"):(a.set_hor_trans_limits(e,t),O.update_transform(e),void p.sync_transform(e)):void v.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")},t.hover_get_horiz_trans_limits=function(e,t){if(!a.is_hover_camera(e))return v.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var r=e.render;return r.hover_horiz_trans_limits?(t=t||{},t.min=r.hover_horiz_trans_limits.min,t.max=r.hover_horiz_trans_limits.max,t):null},t.hover_switch_horiz_rotation=function(e,t){if(!a.is_hover_camera(e))return v.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;e.render.enable_hover_hor_rotation=t},t.is_static_camera=a.is_static_camera,t.is_target_camera=a.is_target_camera,t.is_eye_camera=a.is_eye_camera,t.is_hover_camera=a.is_hover_camera,t.get_move_style=function(e){return S.is_camera(e)?a.get_move_style(e):(v.error("get_move_style(): Wrong camera object"),null)},t.set_translation=function(e,t){if(!S.is_camera(e))return void v.error("set_translation(): Wrong camera object");var r=e.render;if(a.is_target_camera(e)){var _=u.j(r.world_tsr,g),n=f.subtract(t,_,g);f.add(n,r.pivot,r.pivot)}else if(a.is_hover_camera(e)){var _=u.j(r.world_tsr,g),n=f.subtract(t,_,g);f.add(n,r.hover_pivot,r.hover_pivot)}O.set_translation(e,t),O.update_transform(e),p.sync_transform(e)},t.get_translation=function(e,t){return S.is_camera(e)?(t=t||new Float32Array(3),O.get_translation(e,t)):(v.error("get_translation(): Wrong camera object"),null)},t.rotate_camera=function(e,t,r,_){if(!S.is_camera(e))return void v.error("rotate_camera(): Wrong camera object");_=_||!1,_?a.set_rotation_angles(e,t,r):a.rotate_angles(e,t,r),O.update_transform(e),p.sync_transform(e)},t.set_velocities=function(e,t){if(!S.is_camera(e))return void v.error("set_velocities(): Wrong camera object");var r=e.render;"number"==typeof t.trans&&(r.velocity_trans=d.M(t.trans,0,1/0)),"number"==typeof t.rot&&(r.velocity_rot=d.M(t.rot,0,1/0)),"number"==typeof t.zoom&&(r.velocity_zoom=d.M(t.zoom,0,.99))},t.get_velocities=function(e,t){if(!S.is_camera(e))return v.error("get_velocities(): Wrong camera object"),null;var r=e.render;return t=t||{},t.trans=r.velocity_trans,t.rot=r.velocity_rot,t.zoom=r.velocity_zoom,t},t.is_look_up=function(e){if(!S.is_camera(e))return v.error("is_look_up(): Wrong camera object"),!1;var t=u.g(e.render.world_tsr,R);return d._34(t,d.c,g)[1]>=0},t.get_camera_angles=function(e,t){return S.is_camera(e)?(t=t||new Float32Array(2),a.get_camera_angles(e,t),t):(v.error("get_camera_angles(): Wrong camera object"),null)},t.get_camera_angles_char=function(e,t){return S.is_camera(e)?(t=t||new Float32Array(2),a.get_camera_angles_char(e,t),t):(v.error("get_camera_angles_char(): Wrong camera object"),null)},t.get_camera_angles_dir=function(e,t){t=t||new Float32Array(2);var r=f.normalize(e,g),_=d._48(d.c,r,R);return d.R(_,!0),a.get_camera_angles_from_quat(_,d.f,t),t},t.set_stereo_distance=function(e,t){if(!S.is_camera(e))return void v.error("set_stereo_distance(): Wrong camera object");for(var r=m.get_active(),_=S.get_scene_data(e,r),n=_.cameras,o=0;o<n.length;o++){var i=n[o];i.type!=a.TYPE_STEREO_LEFT&&i.type!=a.TYPE_STEREO_RIGHT&&i.type!=a.TYPE_HMD_LEFT&&i.type!=a.TYPE_HMD_RIGHT||a.set_stereo_params(i,t,i.stereo_eye_dist)}},t.get_stereo_distance=function(e){if(!S.is_camera(e))return v.error("get_stereo_distance(): Wrong camera object"),0;for(var t=m.get_active(),r=S.get_scene_data(e,t),_=r.cameras,n=0;n<_.length;n++){var o=_[n];if(o.type==a.TYPE_STEREO_LEFT||o.type==a.TYPE_STEREO_RIGHT)return o.stereo_conv_dist}return 0},t.set_eye_distance=function(e,t){if(!S.is_camera(e))return void v.error("set_eye_distance(): Wrong camera object");var r=m.get_active(),_=S.get_scene_data(e,r),n=_.cameras;a.set_eye_distance(n,t)},t.get_eye_distance=function(e){if(!S.is_camera(e))return v.error("get_eye_distance(): Wrong camera object"),0;for(var t=m.get_active(),r=S.get_scene_data(e,t),_=r.cameras,n=0;n<_.length;n++){var o=_[n];if(o.type==a.TYPE_STEREO_LEFT||o.type==a.TYPE_STEREO_RIGHT||o.type==a.TYPE_HMD_LEFT||o.type==a.TYPE_HMD_RIGHT)return o.stereo_eye_dist}return 0},t.set_vertical_axis=function(e,t){if(!S.is_camera(e))return void v.error("set_vertical_axis(): Wrong camera object");var r=e.render;f.copy(t,r.vertical_axis),O.update_transform(e),p.sync_transform(e)},t.get_vertical_axis=function(e,t){if(!S.is_camera(e))return void v.error("get_vertical_axis(): Wrong camera object");t||(t=f.create());var r=e.render;return f.copy(r.vertical_axis,t),t},t.translate_view=function(e,t,r,_){if(!S.is_camera(e))return void v.error("translate_view(): Wrong camera object");for(var n=m.get_active(),o=S.get_scene_data(e,n),i=o.cameras,s=0;s<i.length;s++){var c=i[s];f.set(-t,-r,0,c.view_transform_params.trans),c.reflection_plane?a.set_projection_reflect(c,!1):a.set_projection(c,!1)}},t.get_view_vector=r,t.get_fov=function(e){if(!S.is_camera(e))return v.error("get_fov(): Wrong camera object"),0;var t=m.get_active(),r=S.get_scene_data(e,t),_=r.cameras;return a.get_fov(_[0])},t.set_fov=function(e,t){if(!S.is_camera(e))return void v.error("set_fov(): Wrong camera object");for(var r=m.get_active(),_=S.get_scene_data(e,r),n=_.cameras,o=0;o<n.length;o++){var i=n[o];a.set_fov(i,t),i.reflection_plane?a.set_projection_reflect(i,!1):a.set_projection(i,!1)}},t.set_hmd_fov=function(e,t,r){v.error_once("set_hmd_fov() deprecated")},t.correct_up=function(e,t,r){if(!S.is_camera(e))return void v.error("correct_up(): Wrong camera object");t=t||e.render.vertical_axis,a.correct_up(e,t,r||!1),O.update_transform(e),p.sync_transform(e)},t.set_ortho_scale=function(e,t){if(!S.is_camera(e)||!a.is_ortho_camera(e))return void v.error("set_ortho_scale(): Wrong camera object");var r=e.render;if(a.is_target_camera(e)){var _=u.j(r.world_tsr,g),n=f.dist(_,r.pivot);r.init_fov=t/2*r.init_dist/n}else if(a.is_hover_camera(e)){var _=u.j(r.world_tsr,g),n=f.distance(_,r.hover_pivot);r.init_fov=t/2*r.init_dist/n}else{var o=m.get_active(),i=S.get_scene_data(e,o);i.cameras[0].fov=t/2}a.update_ortho_scale(e)},t.get_ortho_scale=function(e){if(!S.is_camera(e)||!a.is_ortho_camera(e))return v.error("get_ortho_scale(): Wrong camera object"),0;var t=m.get_active();return 2*S.get_scene_data(e,t).cameras[0].fov},t.is_ortho_camera=function(e){return S.is_camera(e)?a.is_ortho_camera(e):(v.error("is_ortho_camera(): Wrong camera object"),!1)},t.calc_ray=function(e,t,r,n){if(!S.is_camera(e))return v.error("calc_ray(): Wrong camera object"),null;var o=m.get_active(),s=S.get_scene_data(e,o),c=s.cameras[0];switch(n&&3==n.length?v.error_once('dest parameter in the function "calc_ray" should be type of parametric line.'):n=n||new Float32Array(6),c.type){case a.TYPE_PERSP:case a.TYPE_PERSP_ASPECT:case a.TYPE_STEREO_LEFT:case a.TYPE_STEREO_RIGHT:var E=Math.tan(a.get_vfov(c)/2),l=E*c.aspect,T=g,P=_.canvas_to_viewport_coords(t,r,N,c);if(T[0]=(2*P[0]/c.width-1)*l,T[1]=(1-2*P[1]/c.height)*E,T[2]=-1,u.y(T,e.render.world_tsr,T),f.normalize(T,T),3==n.length)f.copy(T,n);else{var A=O.get_translation(e,h);i.R(n,A),i.Q(n,T)}return n;case a.TYPE_ORTHO:var T=g,P=_.canvas_to_viewport_coords(t,r,N,c);T[0]=(2*P[0]/c.width-1)*c.top*c.aspect,T[1]=(1-2*P[1]/c.height)*c.top,T[2]=0,u.D(T,e.render.world_tsr,T),f.copy(T,n);var p=u.g(e.render.world_tsr,R);return f.transformQuat(d.c,p,T),i.Q(n,T),n;default:return v.error("calc_ray(): Non-compatible camera"),n}},t.project_point=function(e,t,r){return S.is_camera(e)?(r=r||new Float32Array(2),a.project_point(e,t,r)):(v.error("project_point(): Wrong camera object"),null)},t.has_distance_limits=function(e){return(a.is_target_camera(e)||a.is_hover_camera(e))&&null!==e.render.distance_limits},t.has_vertical_rot_limits=function(e){return(a.is_eye_camera(e)||a.is_target_camera(e)||a.is_hover_camera(e))&&null!==e.render.vertical_limits},t.has_horizontal_rot_limits=function(e){return(a.is_target_camera(e)||a.is_eye_camera(e))&&null!==e.render.horizontal_limits},t.has_vertical_trans_limits=function(e){return a.is_hover_camera(e)&&null!==e.render.hover_vert_trans_limits},t.has_horizontal_trans_limits=function(e){return a.is_hover_camera(e)&&null!==e.render.hover_horiz_trans_limits},t.get_frustum_planes=function(e,t){if(!S.is_camera(e))return v.error("get_frustum_planes(): Wrong camera object"),null;var r=m.get_active(),a=S.get_scene_data(e,r),_=a.cameras[0].frustum_planes;return P.copy(_.left,t.left),P.copy(_.right,t.right),P.copy(_.top,t.top),P.copy(_.bottom,t.bottom),P.copy(_.near,t.near),P.copy(_.far,t.far),t},t.set_projection=function(e,t){S.is_camera(e)?a.set_proj_mat(e,t):v.error("set_projection(): Wrong camera object")}}var _=r(0),n=r(14),o=r(15),i=r(45),s=r(9),c=r(19),E=r(1),l=r(10),T=r(13),u=r(6),d=r(2),f=r(3),P=r(7),A=r(8),S=Object(_.a)("camera",a);t.a=S},function(e,t,r){"use strict";function a(e,t){function r(){return{vert:"",frag:"",directives:[],node_elements:[],status:ee,attribute_count:0,texture_count:0}}function a(e){var t=r();return t.vert=e.vert,t.frag=e.frag,t.directives=T.O(e.directives),t.node_elements=T.O(e.node_elements),t.status=e.status,t.attribute_count=e.attribute_count,t.texture_count=e.texture_count,t}function _(e,t,r){var a=e.directives;if("string"==typeof r){var _=c(e,r);_&&(r=_[1])}else r=String(r);for(var n=0;n<a.length;n++)if(a[n][0]==t)return void(a[n][1]=r);V&&H.error("Incompatible directive '"+t+"' was set for shaders "+e.vert+"/"+e.frag+".")}function c(e,t){for(var r=e.directives,a=0;a<r.length;a++)if(r[a][0]==t)return r[a];return!1}function E(e,t){var r=e+t;if(!(r in Z)){var a=L(q.shaders_path,e),_=L(q.shaders_path,t),n=y(a),o=y(_);for(var i in o)n[i]=o[i];var s=[];for(var i in n)s.push([i,n[i]]);Z[r]=s}return Z[r]}function u(e){var t=JSON.stringify(e.vert)+JSON.stringify(e.frag)+JSON.stringify(e.directives)+JSON.stringify(e.node_elements),r=W[t];if(r)return r;var a=e.vert,_=e.frag,n=L(q.shaders_path,a),o=L(q.shaders_path,_);if(!n||!o)return null;var i=x("vert",n,e),s=x("frag",o,e);if(A(s,i,e),e.status===ee){W[t]=r=U(ve,i,s,t,e);var c=!ve.getShaderParameter(r.fshader,ve.COMPILE_STATUS),E=!ve.getShaderParameter(r.vshader,ve.COMPILE_STATUS),l=!ve.getProgramParameter(r.program,ve.LINK_STATUS);c?d(r.fshader,t,s):E?d(r.vshader,t,i):l&&P(r.program,t,i,s),(c||E||l)&&(e.status|=oe,r=null)}else r=null;return r}function d(e,t,r){Q.gl_debug&&(r=f(r),H.error("shader compilation failed:\n"+r+"\n"+ve.getShaderInfoLog(e)+" ("+t+")"))}function f(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+" "+t[r];return e=t.join("\n")}function P(e,t,r,a){Q.gl_debug&&(r=f(r),a=f(a),H.error("shader linking failed:\n"+r+"\n\n\n"+a+"\n"+ve.getProgramInfoLog(e)+" ("+t+")"))}function A(e,t,r){var a=ee,_=v(e,ie);r.texture_count=_,_>z.max_texture_image_units&&(a|=te),S(),g(e,fe,z.max_fragment_uniform_vectors)||(a|=re),g(t,Pe,z.max_vertex_uniform_vectors)||(a|=ae);var n=m(t);r.attribute_count=n,n>z.max_vertex_attribs&&(a|=_e),N(e)||(a|=ne),r.status=a}function S(){de||(de=new Uint32Array(z.max_varying_vectors)),fe||(fe=new Uint32Array(z.max_fragment_uniform_vectors)),Pe||(Pe=new Uint32Array(z.max_vertex_uniform_vectors))}function p(e,t){return e+t}function v(e,t){return(e.split(";").map(function(e){var r=e.match(t);return r&&(r[3]?parseInt(r[3],10):1)}).filter(function(e){return e})||[]).reduce(p,0)}function m(e){if(Q.webgl2){return(e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length}return(e.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length}function O(e,t){var r=Y(e.type),a=Y(t.type),_=e.array_size,n=t.array_size;return r>a?-1:r<a?1:_>n?-1:_<n?1:0}function N(e){if(Q.webgl2){e=e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var t=ce}else var t=Ee;return h(e.split(";").map(function(e){var r=e.match(t);return r&&{type:r[2],array_size:r[4]?parseInt(r[4],10):1}}).filter(function(e){return e}),de,z.max_varying_vectors)}function g(e,t,r){for(var a=e.split(";"),_=[],n=0;n<a.length;n++){var o=a[n].match(se);o&&_.push({type:o[2],array_size:o[4]?parseInt(o[4],10):1})}return h(_,t,r)}function h(e,t,r){if(!e.length)return!0;for(var a=0;a<r;a++)t[a]=0;Se=r,e.sort(O);var _=0,n=0,o=0;return function(){for(;o<e.length;){var r=e[o];if(4!=Y(r.type))break;n+=b(r.type)*r.array_size,o++}return!(n>Se)&&(Ae=n,I(t,0,n,0,4),!0)}()&&function(){for(var r=0;o<e.length;){var a=e[o];if(3!=Y(a.type))break;r+=b(a.type)*a.array_size,o++}return!((_=n+r)>Se)&&(I(t,n,r,0,3),!0)}()&&function(){for(var r=Se-_,a=r,n=r;o<e.length;){var i=e[o];if(2!=Y(i.type))break;var s=b(i.type)*i.array_size;if(s<=a)a-=s;else{if(!(s<=n))return!1;n-=s}o++}var c=r-a,E=r-n;return I(t,_,c,0,2),I(t,Se-E,E,2,2),!0}()&&function(){for(;o<e.length;){for(var a=e[o],_=b(a.type)*a.array_size,n=-1,i=r+1,s=-1,c=0;c<4;c++){var E=ue;E[0]=0,E[1]=1,R(t,c,_,E)&&E[1]<i&&(s=E[0],i=E[1],n=c)}if(n<0)return!1;I(t,s,_,n,1),o++}return!0}()}function R(e,t,r,a){for(;Ae<e.length&&e[Ae]===Te;)Ae++;for(;Se>0&&e[Se]===Te;)Se--;if(Se-Ae<r)return!1;for(var _=1<<t,n=0,o=-1,i=e.length+1,s=!1,c=Ae;c<=Se;c++){if(c<Se&&!(e[c]&_))s||(n=c,s=!0);else{if(s){var E=c-n;E>=r&&E<i&&(i=E,o=n)}s=!1}}return!(o<0)&&(a[0]=o,a[1]=i,!0)}function I(e,t,r,a,_){for(var n=0,o=0;o<_;o++)n|=1<<a+o;for(var o=0;o<r;o++)e[t+o]|=n}function b(e){var t=0;switch(e){case"mat4":t=4;break;case"mat3":t=3;break;case"mat2":t=2;break;default:t=1}return t}function Y(e){var t=0;switch(e){case"mat4":case"vec4":case"ivec4":case"bvec4":case"mat2":t=4;break;case"mat3":case"vec3":case"ivec3":case"bvec3":t=3;break;case"vec2":case"ivec2":case"bvec2":t=2;break;default:t=1}return t}function L(e,t){var r=e+t;if(J[r])return J[r];var a=n.a.require("shader_texts")[t];return a?(J[r]=a,a):null}function M(e,t){for(var r={},a=t.directives||[],_=0;_<a.length;_++)r[a[_][0]]=[a[_][1]];for(var _=0;_<t.node_elements.length;_++)r["USE_NODE_"+t.node_elements[_].id]=["1"];Q.webgl2?(r.GLSL1=["0"],r.GLSL3=["1"],r.GLSL_VERSION=["300 es"],r.GLSL_IN=["in"],r.GLSL_OUT=["out"],r.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],r.GLSL_TEXTURE=["texture"],r.GLSL_TEXTURE_CUBE=["texture"],r.GLSL_TEXTURE_PROJ=["textureProj"],r.GLSL_TEXTURE_LOD=["textureLod"],r.GLSL_TEXTURE_CUBE_LOD=["textureLod"]):(r.GLSL1=["1"],r.GLSL3=["0"],r.GLSL_VERSION=["100"],r.GLSL_IN="vert"==e?["attribute"]:["varying"],r.GLSL_OUT="vert"==e?["varying"]:[""],r.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],r.GLSL_TEXTURE=["texture2D"],r.GLSL_TEXTURE_CUBE=["textureCube"],r.GLSL_TEXTURE_PROJ=["texture2DProj"],r.GLSL_TEXTURE_LOD=["textureLod"],Q.texture_lod_available?(r.GLSL_TEXTURE_LOD=["texture2DLodEXT"],r.GLSL_TEXTURE_CUBE_LOD=["textureCubeLodEXT"]):(r.GLSL_TEXTURE_LOD=["texture2D"],r.GLSL_TEXTURE_CUBE_LOD=["textureCube"])),Q.compared_mode_depth&&!Q.rgba_fallback_shadows?r.GLSL_SMPLR2D_SHDW=["sampler2DShadow"]:r.GLSL_SMPLR2D_SHDW=["sampler2D"];for(var n in r)r[n][0].constructor!=String&&H.warn("Warning! The value of a directive '"+n+"' is not of type string.");return r}function y(e){function t(e,t,_){e instanceof Array?r(e,t,_):e instanceof Object&&e&&a(e,t,_)}function r(e,r,a){for(var _=0;_<e.length;_++)t(e[_],r,a)}function a(e,r,a){r&&r(e);for(var _ in e)t(e[_],r,a);a&&a(e)}var _={},n=function(e){if("var"==e.TYPE)_[e.NAME]=e.TOKENS.join("");else if("include"==e.TYPE){var r=L(q.shaders_path,q.shaders_include_dir+e.FILE);t(r,n)}};return t(e,n),_}function x(e,t,r){function a(e){for(var t=e.PARTS,r=0;r<t.length;r++){var a=t[r];switch(a.TYPE){case"cond":_(a);break;case"include":i(a);break;case"var":break;case"define":s(a);break;case"error":c(a);break;case"line":break;case"pragma":E(a);break;case"undef":l(a);break;case"warning":T(a);break;case"extension":u(a);break;case"version":d(a);case"#":break;case"node":f(a);break;case"nodes_global":A(Y);break;case"nodes_main":v(Y);break;case"txt":h(a.TOKENS);break;default:X.panic("Unknown element type: "+a.TYPE)}}}function _(e){for(var t=e.PARTS,r=0;r<t.length;r++){var _=t[r];switch(_.TYPE){case"if":case"elif":if(n(_.EXPRESSION))return void a(_.GROUP);break;case"else":return void a(_.GROUP);case"ifdef":_.NAME in x&&a(_.GROUP);break;case"ifndef":_.NAME in x||a(_.GROUP)}}}function n(e,t){return o(I(e,x,U,!0,t))}function o(e){for(var t=[],r=0;r<e.length;r++)if(e[r]instanceof Object)switch(e[r].TYPE){case"conditional_expr":var a=t.pop(),_=t.pop(),n=t.pop();n?t.push(_):t.push(a);break;case"logical_or_expr":for(var o=t.pop(),i=0;i<e[r].PLACES-1;i++){var s=t.pop();o=o||s}t.push(o);break;case"logical_and_expr":for(var o=t.pop(),i=0;i<e[r].PLACES-1;i++){var s=t.pop();o=o&&s}t.push(o);break;case"logical_bitor_expr":for(var o=t.pop(),i=0;i<e[r].PLACES-1;i++)o|=t.pop();t.push(o);break;case"logical_bitxor_expr":for(var o=t.pop(),i=0;i<e[r].PLACES-1;i++)o^=t.pop();t.push(o);break;case"logical_bitand_expr":for(var o=t.pop(),i=0;i<e[r].PLACES-1;i++)o&=t.pop();t.push(o);break;case"equal_expr":var c=t.pop(),E=t.pop();t.push(E==c);break;case"non_equal_expr":var c=t.pop(),E=t.pop();t.push(E!=c);break;case"le_expr":var c=t.pop(),E=t.pop();t.push(E<=c);break;case"ge_expr":var c=t.pop(),E=t.pop();t.push(E>=c);break;case"l_expr":var c=t.pop(),E=t.pop();t.push(E<c);break;case"g_expr":var c=t.pop(),E=t.pop();t.push(E>c);break;case"left_shift_expr":var E=t.pop(),c=t.pop();t.push(E<<c);break;case"right_shift_expr":var E=t.pop(),c=t.pop();t.push(E>>c);break;case"add_expr":var E=t.pop(),c=t.pop();t.push(E+c);break;case"sub_expr":var E=t.pop(),c=t.pop();t.push(E-c);break;case"mul_expr":var E=t.pop(),c=t.pop();t.push(E*c);break;case"div_expr":var E=t.pop(),c=t.pop();t.push(E/c);break;case"mod_expr":var E=t.pop(),c=t.pop();t.push(E%c);break;case"pre_inc_expr":case"post_inc_expr":var s=t.pop();t.push(++s);break;case"pre_dec_expr":case"post_dec_expr":var s=t.pop();t.push(--s);break;case"positive_expr":var s=t.pop();t.push(+s);break;case"negative_expr":var s=t.pop();t.push(-s);break;case"one_compl_expr":var s=t.pop();t.push(~s);break;case"logic_negative_expr":var s=t.pop();t.push(!s);break;default:X.panic("Unknown operation type: "+e[r].TYPE)}else{var s=e[r],l=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;if(l.test(s)){if(t.push(0),0!=s.indexOf("USE_NODE_")){var T=w[w.length-1];T in C||(C[T]=[]),-1==C[T].indexOf(s)&&(C[T].push(s),H.error("Undefined directive '"+s+"' in shader '"+T+"'. Should it be defined with #var/#node_var or #define?"))}}else t.push(parseFloat(e[r]))}if(1==t.length)return t[0];X.panic("Incorrect expression: "+e.join(" "))}function i(e){var t=e.FILE,r=L(q.shaders_path,q.shaders_include_dir+t);w.push("include/"+t),a(r),w.pop()}function s(e){var t=e.NAME,r=e.TOKENS;x[t]=r}function c(e){var t=e.TOKENS;X.panic("Shader error: #error "+t.join(" "))}function E(e){var t=e.NAME,r=e.TOKENS;y.push("#pragma "+t+" "+r.join(" "))}function l(e){var t=e.NAME;delete x[t]}function T(e){var t=e.TOKENS;H.warn("Shader warning: #warning "+t.join(" "))}function u(e){var t=e.TOKENS,r=I(t,x,U,!1);y.push("#extension "+r.join(" "))}function d(e){var t=e.TOKENS,r=I(t,x,U,!1);y.push("#version "+r.join(" "))}function f(e){D[e.NAME]=e}function P(e,t,r){if("PARTICLE_INFO"==e.id&&t.IS_OPTIONAL){if(1==x.PARTICLE_BATCH){var a=!1;switch(r){case 0:a=B(e.dirs,"PART_INFO_IND")||B(e.dirs,"PART_INFO_AGE")||B(e.dirs,"PART_INFO_LT")||B(e.dirs,"PART_INFO_SIZE");break;case 1:a=B(e.dirs,"PART_INFO_LOC");break;case 2:a=B(e.dirs,"PART_INFO_VEL");break;case 3:a=B(e.dirs,"PART_INFO_A_VEL");break;case 4:a=B(e.dirs,"PART_INFO_IND")}return a}return!1}return!0}function A(t){for(var r=0;r<t.length;r++){var a=t[r],_=D[a.id];if(_)for(var n=0,o=0;o<_.DECLARATIONS.length;o++){var i=_.DECLARATIONS[o];if("node_param"==i.TYPE){if(P(a,i,n)){var s=i.QUALIFIER.join(" ")+" ";"vert"==e?s+=a.vparams[n]:"frag"==e&&(s+=a.params[n],null!==a.param_values[n]&&(s+="="+a.param_values[n])),s+=";",h(g(s))}n++}}}}function S(e,t){for(var r=w[w.length-1],a=p(e),_=0;_<t.dirs.length;_++){var n=t.dirs[_][0];n in a?a[n]=[t.dirs[_][1]]:V&&H.error("Incompatible node directive '"+n+"' was set for node "+t.id+" in shader "+r+".")}for(var o=0,_=0;_<e.DECLARATIONS.length;_++){var i=e.DECLARATIONS[_];if("node_out"==i.TYPE){var s=t.outputs[o],c=F.indexOf(s)>-1|0;a["USE_OUT_"+i.NAME]=[c],o++}}return a}function p(e){for(var t={},r=0;r<e.NODE_VARS.length;r++){var a=e.NODE_VARS[r];t[a.NAME]=[a.TOKENS.join("")]}return t}function v(e){for(var t=0;t<e.length;t++){var r=e[t],a=D[r.id];if(a){var _={};z=0,W=0,J=0;var n=S(a,r);m(r,a.DECLARATIONS,_,n),y.push("{"),O(r,a.STATEMENTS,_,n),y.push("}")}}}function m(t,r,a,_){for(var n=0;n<r.length;n++){var o=r[n];switch(o.TYPE){case"node_in":var i=t.inputs[z];if(null!==t.input_values[z]){if(("MATERIAL_BEGIN"==t.id&&3===z||!_.MATERIAL_EXT&&("MATERIAL_BEGIN"==t.id&&4===z||"MATERIAL_END"==t.id&&3===z||"MATERIAL_END"==t.id&&4===z||"MATERIAL_END"==t.id&&5===z)||"TEXTURE_COLOR"==t.id||"TEXTURE_NORMAL"==t.id)&&o.IS_OPTIONAL){a[o.NAME]=t.input_values[z],z++;continue}var s=o.QUALIFIER.join(" ")+" ";s+=i+"="+t.input_values[z]+";",h(g(s))}a[o.NAME]=i,z++;break;case"node_out":var i=t.outputs[W];if(!o.IS_OPTIONAL||F.indexOf(i)>-1){var s=o.QUALIFIER.join(" ")+" ";s+=i+";",h(g(s)),a[o.NAME]=i}W++;break;case"node_param":if("vert"==e)var i=t.vparams[J];else if("frag"==e)var i=t.params[J];a[o.NAME]=i,J++}}return a}function O(e,t,r,a){for(var _=0;_<t.length;_++){var n=t[_];switch(n.TYPE){case"node_cond":N(e,n.PARTS,r,a);break;case"txt":for(var o=[],i=0;i<n.TOKENS.length;i++){var s=n.TOKENS[i];s in r?o.push(r[s]):o.push(s)}h(o,a)}}}function N(e,t,r,a){for(var _=0;_<t.length;_++){var o=t[_];switch(o.TYPE){case"node_if":case"node_elif":if(n(o.EXPRESSION,a))return void O(e,o.STATEMENTS,r,a);break;case"node_else":return void O(e,o.STATEMENTS,r,a);case"node_ifdef":(o.NAME in x||o.NAME in a)&&O(e,o.STATEMENTS,r,a);break;case"node_ifndef":o.NAME in x||o.NAME in a||O(e,o.STATEMENTS,r,a)}}}function g(e){return e.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function h(t,r){if(t=R(t,e),t.length){var a=I(t,x,U,!1,r);y.push(a.join(" "))}}function R(e,t){if(!Q.webgl2&&"frag"==t){var r=e.join(" ");K&&(r.match(/[^;]*;/)?(r=r.replace(/[^;]*;/,""),K=!1):r=""),r=r.replace(/GLSL_OUT [^;]*;/g,""),r.match(/GLSL_OUT(?:$| [^;]*)/)&&(r=r.replace(/GLSL_OUT(?:$| [^;]*)/,""),K=!0),r=r.replace(/ {2,}/g," "),r=r.trim(),e=r?r.split(" "):[]}return e}function I(e,t,r,a,_){var n=[];return b(e,t,r,a,n,_),n}function b(e,t,r,a,_,n){for(var o=0;o<e.length;o++){var i=e[o];if(n&&i in n)var s=n[i];else{if(!(i in t)){_.push(i);continue}var s=t[i]}0==s.length&&a?_.push(0):b(s,t,r,a,_,n)}}var Y=r.node_elements,y=[],x=M(e,r),U={},w=[r[e]],C={},D={},F=[];for(var G in Y)for(var k in Y[G].inputs)F.push(Y[G].inputs[k]);var K=!1;a(t);var j=y.join("\n"),z=0,W=0,J=0;return j}function U(e,t,r,_,n){var o=D(e,_,t,e.VERTEX_SHADER,n),i=D(e,_,r,e.FRAGMENT_SHADER,n),s=e.createProgram();e.attachShader(s,o),e.attachShader(s,i),e.linkProgram(s);for(var c={vshader:o,fshader:i,program:s,attributes:{},uniforms:{},permanent_uniform_setters:T.S(),permanent_sc_uniform_setters:T.S(),permanent_uniform_setters_table:{},need_uniforms_update:!0,no_permanent_uniforms:!1,transient_uniform_setters:T.S(),transient_sc_uniform_setters:T.S(),shaders_info:a(n),shader_id:_,has_discard:w(r),cleanup_gl_data_on_unload:!0},E=e.getProgramParameter(s,e.ACTIVE_ATTRIBUTES),l=0;l<E;l++){var u=e.getActiveAttrib(s,l),d=u.name,f=e.getAttribLocation(s,d);c.attributes[d]=f}for(var P=e.getProgramParameter(s,e.ACTIVE_UNIFORMS),l=0;l<P;l++){var A=e.getActiveUniform(s,l),S=A.name.split("[0]").join(""),p=e.getUniformLocation(s,S);c.uniforms[S]=p}return c}function w(e){return Boolean(e.match(le))}function C(e,t,r,a){if(r==ve.VERTEX_SHADER)var _=a.vert;else var _=a.frag;var n=T._11(t,0),o=pe[n];o?o.count++:(o={count:1,shader_filename:_,hc:n},pe[n]=o)}function D(e,t,r,a,_){$&&C(t,r,a,_);var n=e.createShader(a);return e.shaderSource(n,r),e.compileShader(n),n}function F(){for(var e in W)G(W[e]);for(var t in J)delete J[t];for(var r in pe)delete pe[r];de=null,fe=null,Pe=null,Z={}}function G(e){ve.deleteProgram(e.program),ve.deleteShader(e.vshader),ve.deleteShader(e.fshader),delete W[e.shader_id]}function k(e,t){switch(!t&&e.length?t=e.length:t||(t=1),t){case 1:return K(e);case 2:return"vec2("+K(e[0])+","+K(e[1])+")";case 3:return"vec3("+K(e[0])+","+K(e[1])+","+K(e[2])+")";case 4:return"vec4("+K(e[0])+","+K(e[1])+","+K(e[2])+","+K(e[3])+")";case 9:return"mat3("+K(e[0])+","+K(e[1])+","+K(e[2])+","+K(e[3])+","+K(e[4])+","+K(e[5])+","+K(e[6])+","+K(e[7])+","+K(e[8])+")";case 16:return"mat4("+K(e[0])+","+K(e[1])+","+K(e[2])+","+K(e[3])+","+K(e[4])+","+K(e[5])+","+K(e[6])+","+K(e[7])+","+K(e[8])+","+K(e[9])+","+K(e[10])+","+K(e[11])+","+K(e[12])+","+K(e[13])+","+K(e[14])+","+K(e[15])+")";default:X.panic("Wrong glsl value dimension")}}function K(e){return e%1?String(e):String(e)+".0"}function B(e,t){for(var r=0;r<e.length;r++)if(e[r][0]==t)return!0;return!1}var X=Object(o.a)(e),j=(Object(i.a)(e),Object(s.a)(e)),H=Object(l.a)(e),Q=j.defaults,z=j.context_limits,q=j.paths,V=!1,W={},J={},Z={},$=!1,ee=0,te=1,re=2,ae=4,_e=8,ne=16,oe=32;t.VALID=ee,t.INVALID_TEX_IMAGE_UNITS=te,t.INVALID_F_UNIFORM_VECTORS=re,t.INVALID_V_UNIFORM_VECTORS=ae,t.INVALID_VERTEX_ATTRIBS=_e,t.INVALID_VARYING_VECTORS=ne,t.COMPILATION_ERROR=oe;var ie=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,se=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ce=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,Ee=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,le=/(?:\W|^)discard(\W|$)/,Te=15,ue=new Int16Array(2),de=null,fe=null,Pe=null,Ae=0,Se=0,pe=[],ve=null,me=!1;t.setup_context=function(e){ve=e},t.init_shaders_info=r,t.clone_shaders_info=a,t.set_directive=_,t.get_directive=c,t.set_default_directives=function(e){e.directives=T.O(E(e.vert,e.frag)),_(e,"PRECISION",j.defaults.precision),"highp"==j.defaults.precision?_(e,"EPSILON",k(1e-6)):_(e,"EPSILON",k(1e-4)),_(e,"CONSTANTS_HACK",0|Q.shader_constants_hack),_(e,"SRGB",Q.srgb_type),_(e,"COMPARED_MODE",0|Q.compared_mode_depth)},t.get_vname=function(e){return e.vert},t.get_fname=function(e){return e.frag},t.get_compiled_shader=u,t.load_shaders=function(){me=!0},t.check_shaders_loaded=function(){return me},t.debug_get_compilation_stats=function(){return pe},t.get_compiled_shaders=function(){return W},t.cleanup=F,t.cleanup_shader=G,t.debug_shaders_info=function(e){var t=e.directives;H.log("Shader: "+e.vert+" "+e.frag+", "+String(t.length)+" directives: ");for(var r=0;r<t.length;r++)H.log("  "+t[r][0],t[r][1])},t.glsl_value=k,t.check_uniform=function(e,t){return t in e.uniforms},t.reset=function(){ve=null}}var _=r(0),n=r(35),o=r(5),i=r(47),s=r(4),c=r(40),E=(r(117),r(118)),l=r(1),T=r(2);r(51);c.d();var u=Object(_.a)("__shaders",a);t.a=u},function(e,t,r){"use strict";function a(e,t){function r(e){return navigator.userAgent.indexOf(e)>-1}function a(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function _(){return!window.ActiveXObject&&"ActiveXObject"in window}var E=Object(n.a)(e),l=Object(o.a)(e),T=Object(i.a)(e),u=Object(s.a)(e),d=Object(c.a)(e),f=["R600","RV610","RV630","RV620","RV635","RV670","RS780","RS880","RV770","RV730","RV710","RV740","CEDAR","REDWOOD","JUNIPER","CYPRESS","PALM (Wrestler/Ontario)","SUMO (Llano)","SUMO2 (Llano)","ARUBA (Trinity/Richland)","BARTS","TURKS","CAICOS","CAYMAN"];t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE=256;var P=E.animation,A=E.defaults,S=E.debug_subs,p=E.context,v=E.context_limits,m=E.sfx,O=E.physics,N=E.assets;t.detect_tegra_invalid_enum_issue=function(e){e.getError()==e.INVALID_ENUM&&u.warn("Possible Tegra invalid enum issue detected, ignoring")},t.set_hardware_defaults=function(e,n){var o=function(e){n&&u.warn(e)};v.max_combined_texture_image_units=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),v.max_fragment_uniform_vectors=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),v.max_texture_image_units=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),v.max_varying_vectors=e.getParameter(e.MAX_VARYING_VECTORS),v.max_vertex_attribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),v.max_vertex_texture_image_units=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v.max_vertex_uniform_vectors=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),v.max_cube_map_texture_size=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),v.max_renderbuffer_size=e.getParameter(e.MAX_RENDERBUFFER_SIZE),v.max_texture_size=e.getParameter(e.MAX_TEXTURE_SIZE),v.max_viewport_dims=e.getParameter(e.MAX_VIEWPORT_DIMS);var i=T.get_renderer_info();if(i){var s=e.getParameter(i.UNMASKED_VENDOR_WEBGL),c=e.getParameter(i.UNMASKED_RENDERER_WEBGL);s.indexOf("Qualcomm")>-1&&c.indexOf("330")>-1&&(r("Chrome")||r("Firefox"))&&(o("Chrome/Firefox and Qualcomm 330 detected, force enable WebGL 1, disable blending cascaded shadow maps."),A.webgl2=!1,A.chrome_csm_blend_hack=!0)}v.depth_bits=A.webgl2?24:16,A.webgl2&&!S.enabled&&(A.compared_mode_depth=!0),A.webgl2?(A.msaa_samples=Math.min(A.msaa_samples,e.getParameter(e.MAX_SAMPLES)),r("Firefox")&&(o("Firefox and WebGL 2 detected, applying framebuffer hack."),A.check_framebuffer_hack=!0),r("Windows")&&r("Chrome")&&(o("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),A.msaa_samples=1)):A.msaa_samples=1,r("Firefox")&&"NONE"!==A.stereo&&(o("Firefox and Stereo rendering detected, disable texture reusage"),A.firefox_tex_reuse_hack=!0),(A.webgl2&&l.multisample_issue()||r("Firefox"))&&(o("Firefox detected, disabling multisample"),A.msaa_samples=1),r("Mac OS X")&&r("Chrome/60")&&(o("macOS and Chrome 60 detected, disabling multisample"),A.msaa_samples=1),d.set_draw_methods();var g=Boolean(T.get_depth_texture());if(r("Firefox/28.0")&&(r("Linux")||r("Macintosh"))&&(o("Firefox 28 detected, applying depth hack"),g=!1),r("Windows Phone")||(r("iPad")||r("iPhone")?(o("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),p.alpha||(A.background_color[3]=1),A.ios_copy_tex_hack=!0,A.vert_anim_mix_normals_hack=!0,A.smaa=!1,A.ssao=!1,A.init_wa_context_hack=!0,Boolean(T.get_pvr())&&N.pvr_available&&(A.compress_format="pvr")):r("Mac OS X")&&r("Safari")&&!r("Chrome")&&(o("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),A.safari_canvas_alpha_hack=!0,m.audio_loading_hack=!0,m.clamp_playback_rate_hack=!0)),r("Windows")&&(r("Chrome/40")||r("Firefox/33")||r("Firefox/34")||r("Firefox/35")||r("Firefox/36"))&&(o("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),A.clear_procedural_sky_hack=!0),r("Chrome")&&!a()&&E.is_built_in_data()&&(o('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),A.chrome_html_bkg_music_hack=!0),r("Mac OS X")&&(A.mac_os_shadow_hack=!0,o("OS X detected, applying shadows hack")),a()&&(o("Mobile detected, applying various hacks for video textures."),A.is_mobile_device=!0,r("iPad")||r("iPhone")||r("Windows Phone")||(o("Mobile (not iOS) detected, disable playback rate for video textures."),m.disable_playback_rate_hack=!0)),r("iPad")&&(o('iPad detected, use "autoplay" hack for video textures.'),A.ipad_video_hack=!0),(r("Firefox/35.0")||r("Firefox/36.0"))&&r("Windows")&&(o("Windows/Firefox 35/36 detected, applying shadows slink hack"),A.shadows_color_slink_hack=!0),(r("iPhone")||_())&&(o("iPhone or IE11 detected. Enable sequential video fallback for video textures."),A.seq_video_fallback=!0),v.max_varying_vectors<10&&(o("Not enough varyings, disable shadows on blend objects"),A.disable_blend_shadows_hack=!0),r("Windows Phone")&&(o("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),A.debug_view=!1,A.glow_materials=!1,A.ssao=!1,A.smaa=!1,A.shadows=!1,A.reflections=!1,A.refractions=!1,A.quality_aa_method=!1),(r("UCBrowser")||r("Chrome")&&r("Nexus")&&A.is_mobile_device)&&(o("Mobile Nexus Chrome or UCBrowser detected, disable workers."),O.use_workers=!1),r("Firefox")&&(o("Firefox detected, disabling workers"),O.use_workers=!1),(_()||r("Edge"))&&(o("IE11 or Edge detected, disabling workers"),O.use_workers=!1),r("Chrome")&&r("Linux")&&(o("Chrome and Linux detected, disabling wasm physics."),O.use_wasm=!1),i){var s=e.getParameter(i.UNMASKED_VENDOR_WEBGL),c=e.getParameter(i.UNMASKED_RENDERER_WEBGL),h=/\b4\d{2}\b/;s.indexOf("Intel")&&(c.indexOf("3000")>-1||c.indexOf("2000")>-1)&&(A.reuse_depth_optimization=!1,o("Intel HD Graphics 2000/3000 detected, disable depth reuse.")),r("Chrome")&&c.indexOf("Mali-T720")>-1&&(o('Chrome and ARM Mali-T720 detected, changing "Alpha Anti-Aliasing" materials to "Alpha Clip".'),A.mali_alpha_antialias_hack=!0),c.indexOf("AMD")>-1&&r("Windows")&&r("Firefox")&&(o("AMD, Windows and Firefox detected, disabling depth textures."),g=!1),s.indexOf("ARM")>-1&&h.test(c)&&(o("ARM Mali-400 series detected, applying lamps, depth and frames blending hacks"),g=!1,P.frames_blending_hack=!0,A.mali4_lamps_hack=!0),s.indexOf("ARM")>-1&&c.indexOf("Mali-T604")>-1&&(o("ARM Mali-T604 detected, disabling shadows."),A.shadows=!1),s.indexOf("ARM")>-1&&c.indexOf("Mali-T760")>-1&&(o("ARM Mali-T760 detected, disabling SSAO."),A.ssao=!1,A.skinning_hack=!0,A.webgl2&&(A.msaa_samples=1,o("ARM Mali-T760 and WebGL 2 detected, switching MSAA samples to 1."))),s.indexOf("ARM")>-1&&c.indexOf("Mali-T720")>-1&&(o("ARM Mali-T720 detected, disabling depth textures."),g=!1,A.webgl2&&(A.msaa_samples=1,o("ARM Mali-T720 and WebGL 2 detected, switching MSAA samples to 1."))),s.indexOf("Qualcomm")>-1&&c.indexOf("Adreno")>-1&&(o("Qualcomm Adreno detected, applying shader constants hack."),A.shader_constants_hack=!0,c.indexOf("420")>-1&&(o("Qualcomm Adreno420 detected, setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),v.max_texture_size=Math.min(v.max_texture_size,4096),v.max_cube_map_texture_size=Math.min(v.max_cube_map_texture_size,4096)),r("Chrome")&&(c.match(/4../)||c.match(/5../))&&(o("Qualcomm Adreno 4xx or 5xx detected, switch MSAA samples to 1."),A.msaa_samples=1)),s.indexOf("NVIDIA")>-1&&c.indexOf("Tegra 3")>-1&&(o("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),A.force_low_quality_nodes=!0),r("Windows")&&r("Chrome")&&!r("Edge")&&(c.match(/NVIDIA GeForce 8..0/)||c.match(/NVIDIA GeForce 9..0/)||c.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(o("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 768x512, use canvas for resizing."),v.max_cube_map_texture_size=t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE,A.resize_cubemap_canvas_hack=!0),c.indexOf("PowerVR")>-1&&c.indexOf("SGX")>-1&&(o("PowerVR SGX series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),A.resize_cubemap_canvas_hack=!0,A.skinning_hack=!0,A.shadows=!1),r("Windows")&&c.indexOf("Direct3D9")>-1&&(o("DirectX 9.0 detected, using canvas for resizing textures/cubemap textures."),A.d3d9_canvas_resizing_hack=!0,A.resize_cubemap_canvas_hack=!0,A.resize_texture_canvas_hack=!0);for(var R="",I=0;I<f.length;I++)if(c.indexOf(f[I])>-1){R=f[I];break}R&&(o("Architecture "+R+" detected. Blending between frames and shadows on blend objects will be disabled."),A.skinning_hack=!0,A.disable_blend_shadows_hack=!0)}if(0==v.max_vertex_texture_image_units&&(o("Vertex textures are not allowed. Disabling vertex textures"),A.allow_vertex_textures=!1),g||(A.foam=!1,A.dynamic_grass=!1,A.water_dynamic=!1,A.shore_smoothing=!1,A.shore_distance=!1,A.smaa=!1,A.ssao=!1,A.rgba_fallback_shadows=!0),A.use_compression=Boolean(T.get_s3tc())||"pvr"==A.compress_format,A.depth_tex_available=g,e.getShaderPrecisionFormat)var b=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);e.getShaderPrecisionFormat&&0!==b.precision||(A.precision="mediump"),(_()&&r("Touch")||r("Edge"))&&(o("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),A.ie11_edge_touchscreen_hack=!0),(_()||r("Edge"))&&(A.ie_edge_anchors_floor_hack=!0,A.ie11_edge_mouseoffset_hack=!0,A.resize_cubemap_canvas_hack=!0),a()&&r("Firefox")&&(u.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),A.mobile_firefox_media_hack=!0,v.max_texture_size=Math.min(v.max_texture_size,4096),v.max_cube_map_texture_size=Math.min(v.max_cube_map_texture_size,4096));var Y=Boolean(T.get_aniso());A.anisotropic_available=Y;var L=Boolean(T.get_texture_lod());A.texture_lod_available=L;var M=Boolean(T.get_texture_float());A.tex_float_available=M;var y=Boolean(T.get_texture_half_float());A.tex_hfloat_available=y;var x=Boolean(T.get_texture_float_linear());A.tex_float_lin_available=x;var U=Boolean(T.get_texture_half_float_linear());A.tex_hfloat_lin_available=U;var w=Boolean(T.get_color_buffer_float());A.cbuffer_float_available=w;var C=Boolean(T.get_color_buffer_half_float());A.cbuffer_hfloat_available=C},t.check_user_agent=r,t.detect_mobile=a,t.apply_context_alpha_hack=function(){r("Firefox/35.0")&&r("Windows")&&(u.warn("Windows/Firefox 35 detected, forcing context's alpha"),E.context.alpha=!0)},t.is_ie11=_}var _=r(0),n=r(4),o=r(48),i=r(29),s=r(1),c=r(22),E=Object(_.a)("__compat",a);t.a=E},function(e,t,r){"use strict";function a(e,t,r){var a=!(!t||!t.length),_=e.length/3;r=r||T(_);for(var n=0;n<_;++n){var i=y;if(i[0]=e[3*n],i[1]=e[3*n+1],i[2]=e[3*n+2],g.normalize(i,i),a){var E=C;E[0]=t[b*n],E[1]=t[b*n+1],E[2]=t[b*n+2],E[3]=t[b*n+3],g.normalize(E,E);var l=g.cross(E,i,x);g.normalize(l,l);var u=O.rotationTo(R.f,l,L),d=g.transformQuat(R.e,u,U),f=O.rotationTo(d,i,M),P=O.multiply(f,u,L);O.normalize(P,P);var A=Y,S=g.cross(i,l,U);(Math.abs(S[0]-E[0])>I||Math.abs(S[1]-E[1])>I||Math.abs(S[2]-E[2])>I)&&(A=Math.acos(g.dot(i,E))/Math.PI),o(r,P,n),s(r,R._50(E[3]),n),c(r,A,n)}else{var P=O.rotationTo(R.e,i,L);o(r,P,n)}}return r}function _(e,t,r,a){if(0!==r){t=4*t||0,r=r||e.length;for(var _=0,n=0;_<4*r;_+=4,n+=4)a[n]=e[t+_],a[n+1]=e[t+_+1],a[n+2]=e[t+_+2],a[n+3]=e[t+_+3]}}function n(e,t,r){t=t||0;var a=d(e,t,r);return O.normalize(a,r),r}function o(e,t,r){r=r||0;var a=d(e,r,w),_=O.length(a),n=R._50(a[3])*R._50(t[3])||1;return O.scale(t,n*_,a),Math.abs(a[3])<I&&(a[3]>0?a[3]=I:a[3]=-I),f(e,a,r),e}function i(e,t){return t=t||0,R._50(e[4*t+3])}function s(e,t,r){r=r||0;var a=d(e,r,w);return R._50(a[3])*t<0&&O.scale(a,-1,a),f(e,a,r),e}function c(e,t,r){r=r||0;var a=d(e,r,w);return O.normalize(a,a),O.scale(a,t,a),Math.abs(a[3])<I&&(a[3]>0?a[3]+=I:a[3]-=I),f(e,a,r),e}function E(e,t){t=t||0;var r=d(e,t,w);return O.length(r)}function l(e,t,r){var a=n(e,t,L);return g.transformQuat(R.e,a,r)}function T(e){e=0!==e?e||1:0;for(var t=new Float32Array(4*e),r=0;r<e;r++)t[4*r+3]=Y;return t}function u(e){for(var t=0;t<e.length;t+=4)e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=Y;return e}function d(e,t,r){return r[0]=e[4*t],r[1]=e[4*t+1],r[2]=e[4*t+2],r[3]=e[4*t+3],r}function f(e,t,r){return e[4*r]=t[0],e[4*r+1]=t[1],e[4*r+2]=t[2],e[4*r+3]=t[3],e}function P(e){return e.length/4}function A(e,t,r){for(var a=P(e),_=0;_<a;_++){var l=i(e,_),T=E(e,_),u=n(e,_,M);o(r,O.multiply(t,u,M),_),c(r,T,_),s(r,l,_)}}function S(e,t,r){return A(e,N.g(t,L),r)}function p(e,t,r,a){var _=i(t,0),l=n(e,0,L),T=n(t,0,M),u=E(e),d=E(t),f=O.slerp(l,T,r,M);return O.normalize(f,f),o(a,f,0),c(a,r*(u-d)+d),s(a,_,0),a}function v(e,t,r){var a=i(t,0),_=n(e,0,L),l=n(t,0,M),T=E(e,0),u=E(t,0);return o(r,O.multiply(_,l,L),0),c(r,T+u-Y),s(r,a,0),r}function m(e,t,r){var a=i(t,0),_=n(e,0,L),l=n(t,0,M),T=E(e),u=E(t),d=O.invert(l,M);return o(r,O.multiply(_,d,L),0),c(r,T-u+Y),s(r,a,0),r}r.d(t,"a",function(){return b}),t.d=a,t.b=_,t.h=n,t.o=o,t.g=l,t.c=T,t.i=u,t.e=d,t.n=f,t.f=P,t.j=A,t.m=S,t.p=p,t.k=v,t.l=m;var O=r(8),N=r(6),g=r(3),h=r(7),R=r(2),I=31e-6,b=4,Y=.5,L=O.create(),M=O.create(),y=g.create(),x=g.create(),U=g.create(),w=h.create(),C=h.create()},function(e,t,r){"use strict";function a(){if("DEBUG"==c){var e=o();return[parseInt(String(e.getFullYear()).slice(-2),10),e.getMonth()+1]}return l}function _(){for(var e="",t=a(),r=0;r<t.length;r++)e+=1==r&&t[r]<10?"0"+t[r]:t[r],r!=t.length-1&&(e+=".");return e}function n(){return c}function o(){return"DEBUG"==c?new Date:E}function i(){var e=o(),t=e.getDate();t=t<10?"0"+String(t):String(t);var r=e.getMonth()+1;r=r<10?"0"+String(r):String(r);var a=String(e.getFullYear()),_=e.getHours();_=_<10?"0"+String(_):String(_);var n=e.getMinutes();n=n<10?"0"+String(n):String(n);var i=e.getSeconds();return i=i<10?"0"+String(i):String(i),t+"."+r+"."+a+" "+_+":"+n+":"+i}function s(){if("DEBUG"!=c)return T;var e=i();return e=e.split(" ").join("").split(":").join("").split(".").join("")}t.e=a,t.f=_,t.d=n,t.a=o,t.b=i,t.c=s;var c="DEBUG",E=null,l=null,T="_b4w_ver_"},function(e,t,r){"use strict";function a(e,t){function r(){return{type:We,num_pierced:0,pierce_step:0,params:null,bones:null,bflags:null,channels_mask:new Int8Array(8)}}function a(e,t){var r=e.anim_slots[t];r&&r.finish_callback&&r.exec_finish_callback&&(r.exec_finish_callback=!1,r.finish_callback(e,t))}function _(e,t,r){var a=e.anim_slots[r];a.type=$e;var _=t.frame_start,n=t.frame_end-_+1;a.start=_,a.length=n,a.current_frame_float=_,a.animation_name=t.name;for(var o=0,i=0;i<e.vertex_anim.length;i++){var s=e.vertex_anim[i];if(s==t)break;o+=s.frame_end-s.frame_start+1}a.va_frame_offset=o}function O(e,t,r){t.type=tt,t.animation_name=r.name,t.start=r.frame_start,t.length=r.frame_end-t.start,r.cyclic||(t.length+=r.lifetime_frames)}function N(e,t,r){for(var a=e.scenes_data,_=0;_<a.length;_++)for(var n=a[_].batches,o=0;o<n.length;o++){var i=n[o].particles_data;if(i&&i.name==t){var s=e.anim_slots[r];O(n[o],s,i)}}}function g(e,t){var r={type:null,animation_name:null,action_frame_range:null,action_step:0,action_bflags:null,channels_mask:new Int8Array(8),quats:null,scale:null,trans:null,bone_space_quats:null,bone_space_trans:null,skinning_data:[],play:!1,behavior:ct,current_frame_float:0,start:0,length:0,trans_smooth_period:0,quat_smooth_period:0,exec_finish_callback:!1,va_frame_offset:null,speed:1,volume:null,pitch:null,color:null,energy:null,zenith_color:null,horizon_color:null,fog_intensity:null,fog_depth:null,fog_start:null,fog_height:null,fog_color:null,nodemat_values:[],node_value_inds:[],nodemat_rgbs:[],node_rgb_inds:[],node_batches:null};if(!e.anim_slots.length)for(var a=0;a<8;a++)e.anim_slots.push(null);e.anim_slots[t]=r}function h(e){-1==xt.indexOf(e)&&xt.push(e)}function R(e){return e.replace(/_B4W_BAKED$/,"")}function I(e){for(var t=[],r=0;r<Ut.length;r++){var a=Ut[r],_=a._render;_.type==Ze?t.push(a):a._render.type!=rt||"MESH"!=e.type&&"WORLD"!=e.type?_.type==Je&&"ARMATURE"==e.type?t.push(a):_.type==et&&"SPEAKER"==e.type?t.push(a):_.type==_t&&"WORLD"==e.type&&t.push(a):t.push(a)}return t}function b(e){return e.def_action_slots.slice()}function Y(e){var t=[],r=e.node_tree;return r&&M(r,t,[e.name]),t}function L(e,t){return{name_list:e,action:t}}function M(e,t,r){if(e.animation_data){var a=e.animation_data,_=a.action;_&&_._render.type==rt&&t.push(L(r,_))}for(var n=e.nodes,o=0;o<n.length;o++){var i=n[o];if(i.node_group){var s=i.node_group.node_tree;if(s){var c=r.slice();c.push(i.name),M(s,t,c)}}}}function y(e){return!(!Fe.is_mesh(e)||!e.render.vertex_anim)}function x(e,t,r){var a=e.anim_slots;if(r==it)for(var _=0;_<8;_++){var n=a[_];n&&(n.current_frame_float=t,C(e,0,_,!0))}else{var n=a[r];n&&(n.current_frame_float=t,C(e,0,r,!0))}}function U(e,t){function r(r){x(e,r.start,t)}t=t||nt,w(e.anim_slots,t,r)}function w(e,t,r){if(t==it)for(var a=0;a<8;a++){var _=e[a];_&&r(_)}else{var _=e[t];_&&r(_)}}function C(e,t,r,_){Z(e,t,r,_),a(e,r),e.render.anim_mixing&&(ne(e,t),re(e,t))}function D(e){return Boolean(e.anim_slots.length)}function F(e,t,r,a,_){if(r)var n=v._19("uuid",r,Ut);else var n=v._19("name",a,Ut)||v._19("name",a+"_B4W_BAKED",Ut);if(n){g(e,_),h(e);var o=n.frame_range;if(o[0]>o[1])return Ke.warn('Incompatible action "'+n.name+'" has been applied to object "'+e.name+'"'),!1;var i=n._render;switch(i.type){case Je:if(Fe.is_armature(e)){var s=k(e,t,n);s||(s=oe(n,e.render.bone_pointers),B(e,t,n,s)),X(e,_,n,s)}break;case Ze:var c=i.params.tsr;if(!c)return Ke.warn('Incompatible action "'+n.name+'" has been applied to object "'+e.name+'"'),!1;var E=k(e,t,n);E||(E=wt(e,n,c),B(e,t,n,E))}}}function G(e,t,r,a){var _=r.frame_range;if(_[0]>_[1])return Ke.warn('Incompatible action "'+r.name+'" has been applied to object "'+e.name+'"'),!1;var n=r._render,o=e.anim_slots[a];switch(o.animation_name=r.name,o.action_frame_range=_,o.action_step=n.pierce_step,o.action_bflags=n.bflags,o.channels_mask.set(n.channels_mask),o.start=_[0],o.length=_[1]-_[0],o.current_frame_float=_[0],n.type){case Je:if(Fe.is_armature(e)){o.type=Je;var i=k(e,t,r);i||(i=oe(r,e.render.bone_pointers),B(e,t,r,i)),o.trans=i.trans,o.quats=i.quats,o.bone_space_quats=i.bone_space_quats,o.bone_space_trans=i.bone_space_trans,X(e,a,r,i)}break;case et:Fe.is_speaker(e)&&(o.volume=n.params.volume||null,o.pitch=n.params.pitch||null,o.type=et);break;case at:Fe.is_lamp(e)&&(o.color=n.params.color||null,o.energy=n.params.energy||null,o.type=at);break;case rt:if("MESH"==e.type||"WORLD"==e.type){o.type=rt;var s=Fe.is_world(e),c=V(e,t,r,s);o.node_value_inds=c.val_inds,o.nodemat_values=c.values,o.node_rgb_inds=c.rgb_inds,o.nodemat_rgbs=c.rgbs,o.node_batches=c.node_batches}break;case Ze:var E=n.params.tsr;if(!E)return Ke.warn('Incompatible action "'+r.name+'" has been applied to object "'+e.name+'"'),!1;o.type=Ze;var l=k(e,t,r);if(l||(l=wt(e,r,E),B(e,t,r,l)),o.trans=l.trans,o.scale=l.scale,o.quats=l.quats,Ge.obj_has_particles(e)){var T=o.trans[0],u=o.scale[0],d=o.quats[0];Ge.update_start_pos(e,T,u,d)}break;case _t:Fe.is_world(e)&&(o.energy=n.params["light_settings.environment_energy"]||null,o.horizon_color=n.params.horizon_color||null,o.zenith_color=n.params.zenith_color||null,o.fog_intensity=n.params["mist_settings.intensity"]||null,o.fog_depth=n.params["mist_settings.depth"]||null,o.fog_start=n.params["mist_settings.start"]||null,o.fog_height=n.params["mist_settings.height"]||null,o.fog_color=n.params.b4w_fog_color||null,o.type=_t)}return Fe.is_armature(e)&&n.type!=Je&&z(e,a),!0}function k(e,t,r){var a=e.action_anim_cache;if(t)var _=t.join("%join%");else var _=null;for(var n=0;n<a.length;n+=3)if(r==a[n]&&_==a[n+1])return a[n+2];return null}function K(e,t){for(var r=e.action_anim_cache,a=[],_=0;_<r.length;_+=3)(r[_]._render.type!=rt||null!==r[_+1]&&r[_+1].split("%join%")[0]!=t)&&a.push(r[_],r[_+1],r[_+2]);e.action_anim_cache=a}function B(e,t,r,a){var _=e.action_anim_cache;if(t)var n=t.join("%join%");else var n=null;_.push(r,n,a)}function X(e,t,r,a){var _=e.render,n=_.skinned_renders,o=e.anim_slots[t],i=o.skinning_data,s=j(_,r);if(s)o.skinning_data=s;else{for(var c=0;c<n.length;c++){var E=n[c],l=se(a,E.bone_skinning_info);i.push(l)}H(_,r,i)}if(_.anim_mixing){var T=_.blend_skel_slots;if(t>T[1]){var u=T[1];T[1]=t,T[0]=u}else t>T[0]&&t<T[1]&&(T[0]=t);Q(e)}}function j(e,t){for(var r=e.skinning_data_cache,a=0;a<r.length;a+=2)if(t==r[a])return r[a+1];return null}function H(e,t,r){e.skinning_data_cache.push(t,r)}function Q(e){var t=e.render.blend_skel_slots;if(-1!=t[0]&&-1!=t[1]){var r=t[1],a=e.anim_slots,_=a[r],n=_.current_frame_float,o=Math.floor(n),i=n-o,s=t[0],c=a[s];n=c.current_frame_float,o=Math.floor(n),c.current_frame_float=o+i}}function z(e,t){var r=e.render.blend_skel_slots,a=r[1];if(r[0]=-1,r[1]=-1,t!=it)for(var _=e.anim_slots,n=a;n>=nt;n--){var o=_[n];if(o&&o.type==Je){if(n>r[1]){r[1]=n;continue}n>r[0]&&(r[1]=n);break}}}function q(e,t){var r=e.match(/"(.*?)"/)[1];if(t&&t.length>1){for(var a=t[1],_=2;_<t.length;_++)a=a+"%join%"+t[_];a+="%join%"+r}else var a=r;return a}function V(e,t,r,a){var _=[],n=[],o=[],i=[],s=[],c=r._render,E=t?t[0]:null;for(var l in c.params)for(var T=q(l,t),u=0;u<e.scenes_data.length;u++)for(var d=e.scenes_data[u].batches,f=0;f<d.length;f++){var P=d[f];if(a||!E||-1!=P.material_names.indexOf(E)){var A=P.node_value_inds,S=P.node_rgb_inds,p=J(l,T,c,n,_,A),v=W(l,T,c,i,o,S);(p||v)&&s.push(P)}}return{val_inds:_,values:n,rgb_inds:o,rgbs:i,node_batches:s}}function W(e,t,r,a,_,n){if(!n)return!1;for(var o=!1,i=0;i<n.length;i+=2){if(t==n[i]){var s=n[i+1];_.push(s),a.push(new Float32Array(r.params[e])),o=!0}}return o}function J(e,t,r,a,_,n){if(!n)return!1;for(var o=!1,i=0;i<n.length;i+=3){t==n[i]&&(_.push(4*n[i+1]+n[i+2]),a.push(new Float32Array(r.params[e])),o=!0)}return o}function Z(e,t,r,a){var _=e.anim_slots[r];if(_&&null!=_.type&&(_.play||a)){var n=e.render,o=_.current_frame_float,i=_.start,c=_.length;o+=_.speed*t*He.get_framerate();var E=_.type,l=_.speed;if(l>=0&&o>=i+c||l<0&&o<i)switch(a||(_.exec_finish_callback=!0),_.behavior){case st:o=l>=0?(o-i)%c+i:i+c-Ve;break;case ct:o=l>=0?i:i+c-Ve,_.play=!1;break;case Et:o=l>=0?i+c-Ve:i,_.play=!1}switch(_.current_frame_float=o,E){case Je:if(!n.anim_mixing){var T=$(_),u=T[0],d=T[1],f=T[2];n.quats_before=_.quats[u],n.quats_after=_.quats[d],n.trans_before=_.trans[u],n.trans_after=_.trans[d],n.frame_factor=f,te(n,_,u,d),Qe.update_transform(e)}break;case Ze:var T=$(_),P=ge(_,0,T,vt),A=Re(_,0,T,mt),S=he(_,0,T,It);if(e.parent&&e.pinverse_tsr){var O=Mt;p.t(P,A,S,O),p.q(e.pinverse_tsr,O,O),p.j(O,P),p.i(O,A),p.g(O,S)}if(_.trans_smooth_period){var N=Qe.get_translation(e,Ot);v._54(P,N,t,_.trans_smooth_period,P)}if(_.quat_smooth_period){var g=bt;Qe.get_rotation(e,g),v._52(S,g,t,_.quat_smooth_period,S)}var h=_.channels_mask;h[0]&&Qe.set_translation_rel(e,P),h[1]&&Qe.set_rotation_rel(e,S),h[2]&&Qe.set_scale_rel(e,A),Qe.update_transform(e),ke.sync_transform(e);break;case $e:var T=ee(_);n.va_frame=T[0],n.va_frame_factor=T[2];break;case et:var T=$(_),R=T[0],I=T[1],b=T[2];if(_.volume){var Y=(1-b)*_.volume[R]+b*_.volume[I];Xe.set_volume(e,Y)}if(_.pitch){var L=(1-b)*_.pitch[R]+b*_.pitch[I];Xe.playrate(e,L)}break;case tt:if(_.behavior==st)var M=(o-i)/He.get_framerate();else var M=o/He.get_framerate();Ge.set_time(e,_.animation_name,M);break;case rt:for(var T=$(_),R=T[0],I=T[1],b=T[2],y=_.nodemat_values,x=_.node_value_inds,U=_.nodemat_rgbs,w=_.node_rgb_inds,C=_.node_batches,D=0;D<x.length;D++)for(var F=y[D],G=x[D],k=(1-b)*F[R]+b*F[I],K=0;K<C.length;K++)C[K].node_values[G]=k;for(var D=0;D<w.length;D++)for(var B=U[D],G=w[D],X=B.subarray(3*R,3*R+3),j=B.subarray(3*I,3*I+3),H=m.lerp(X,j,b,vt),K=0;K<C.length;K++)C[K].node_rgbs[3*G]=H[0],C[K].node_rgbs[3*G+1]=H[1],C[K].node_rgbs[3*G+2]=H[2];Fe.is_world(e)&&Be.update_sky_texture(e);break;case at:var T=$(_),R=T[0],I=T[1],b=T[2],h=_.channels_mask,Q=_.energy;if(Q&&h[0]){var z=(1-b)*Q[R]+b*Q[I];s.d(e.light,z)}var q=_.color;q&&h[1]&&(vt[0]=(1-b)*q[3*R]+b*q[3*I],vt[1]=(1-b)*q[3*R+1]+b*q[3*I+1],vt[2]=(1-b)*q[3*R+2]+b*q[3*I+2],s.b(e.light,vt));for(var V=e.scenes_data,D=0;D<V.length;D++)Be.update_lamp_scene_color_intensity(e,V[D].scene);break;case _t:var T=$(_),R=T[0],I=T[1],b=T[2],h=_.channels_mask,V=e.scenes_data,W=Be.get_subs(V[0].scene,je.MAIN_OPAQUE),Q=_.energy;if(h[lt])var J=(1-b)*Q[R]+b*Q[I];else var J=W.energy;var Z=_.horizon_color;if(h[Tt]){vt[0]=(1-b)*Z[3*R]+b*Z[3*I],vt[1]=(1-b)*Z[3*R+1]+b*Z[3*I+1],vt[2]=(1-b)*Z[3*R+2]+b*Z[3*I+2];var re=vt}else var re=W.horizon_color;var ae=_.zenith_color;if(h[ut]){mt[0]=(1-b)*ae[3*R]+b*ae[3*I],mt[1]=(1-b)*ae[3*R+1]+b*ae[3*I+1],mt[2]=(1-b)*ae[3*R+2]+b*ae[3*I+2];var _e=mt}else var _e=W.zenith_color;var ne=_.fog_intensity;if(h[dt])var oe=(1-b)*ne[R]+b*ne[I];var ie=_.fog_depth;if(h[ft])var se=(1-b)*ie[R]+b*ie[I];var ce=_.fog_start;if(h[Pt])var Ee=(1-b)*ce[R]+b*ce[I];var le=_.fog_height;if(h[At])var Te=(1-b)*le[R]+b*le[I];var ue=_.fog_color;if(h[St]){It[0]=(1-b)*ue[3*R]+b*ue[3*I],It[1]=(1-b)*ue[3*R+1]+b*ue[3*I+1],It[2]=(1-b)*ue[3*R+2]+b*ue[3*I+2];var de=It}for(var D=0;D<V.length;D++){var fe=e.scenes_data[D].scene;(h[lt]||h[Tt]||h[ut])&&Be.set_environment_colors(fe,J,re,_e),h[dt]&&Be.set_fog_intensity(fe,oe),h[ft]&&Be.set_fog_depth(fe,se),h[Pt]&&Be.set_fog_start(fe,Ee),h[At]&&Be.set_fog_height(fe,Te),h[St]&&Be.set_fog_color_density(fe,de)}break;default:Ce.panic("Unknown animation type:"+E)}}}function $(e){var t=e.current_frame_float,r=e.action_frame_range[0],a=e.action_frame_range[1],_=a-r,n=t-r;n<0&&(n=0),n>=_&&(n=_),n/=e.action_step;var o=Math.floor(n);if(e.action_bflags[o])var i=n-o;else var i=0;var s=Math.ceil(o+i);return pt[0]=o,pt[1]=s,pt[2]=i,pt}function ee(e){var t=e.current_frame_float,r=t-e.start;r<0&&(r=0),r>=e.length&&(r=e.length);var a=Math.floor(r),_=a+1,n=r-a;e.behavior!=st&&_==e.length&&(a-=1,_=a,n=1);var o=e.va_frame_offset;return pt[0]=a+o,pt[1]=_+o,pt[2]=n,pt}function te(e,t,r,a){for(var _=e.skinned_renders,n=t.skinning_data,o=0;o<_.length;o++){var i=_[o],s=n[o];i.quats_before=s.quats[r],i.quats_after=s.quats[a],i.trans_before=s.trans[r],i.trans_after=s.trans[a],i.frame_factor=e.frame_factor}}function re(e,t){var r=e.render,a=r.anim_mix_factor,_=r.blend_skel_slots,o=_[0],i=_[1];if(-1!=i){if(-1!=o){var s=e.anim_slots[o];if(s.play||0==t||r.mix_with_current){var c=$(s),E=c[0],l=c[1];r.frame_factor=c[2];var T=s.quats[E],u=s.quats[l],d=s.trans[E],f=s.trans[l]}else a=1}else a=1;var P=e.anim_slots[i];if(P.play||0==t||r.mix_with_current){var A=$(P),S=A[0],p=A[1];r.frame_factor=A[2]}else{if(-1==o||!s.play)return;a=0}var v=P.quats[S],m=P.quats[p],O=P.trans[S],N=P.trans[p];if(1!=a||r.mix_with_current)if(0!=a||r.mix_with_current){var g=r.bone_pointers;if(r.mix_with_current&&!r.trans_curr&&!r.quats_curr){r.trans_curr=new Float32Array(r.trans_before.length),r.quats_curr=new Float32Array(r.quats_before.length);for(var h in g){var R=g[h];R.parent_bone_ptr||_e(r,R)}}for(var h in g){var R=g[h];R.parent_bone_ptr||ae(r,R,s,P,E,l,S,p)}}else r.quats_before.set(T),r.quats_after.set(u),r.trans_before.set(d),r.trans_after.set(f);else r.quats_before.set(v),r.quats_after.set(m),r.trans_before.set(O),r.trans_after.set(N);Qe.update_transform(e),n.f(e)}}function ae(e,t,r,a,_,n,o,i){var s=t.parent_bone_ptr,c=e.anim_mix_factor,E=It,l=bt,T=Nt,d=gt,f=Yt,P=Lt,A=ht,S=Rt,m=4*t.bone_index,O=a.bone_space_quats[o],N=a.bone_space_trans[o],g=a.bone_space_quats[i],h=a.bone_space_trans[i];if(!e.mix_with_current)var R=r.bone_space_quats[_],I=r.bone_space_trans[_],b=r.bone_space_quats[n],Y=r.bone_space_trans[n];for(var L=0;L<4;L++)l[L]=O[m+L],d[L]=N[m+L],P[L]=g[m+L],S[L]=h[m+L],e.mix_with_current?(E[L]=e.quats_curr[m+L],T[L]=e.trans_curr[m+L],f[L]=e.quats_curr[m+L],A[L]=e.trans_curr[m+L]):(E[L]=R[m+L],T[L]=I[m+L],f[L]=b[m+L],A[L]=Y[m+L]);u.slerp(E,l,c,E),v.G(T,d,c,T),p.w(T,Mt),p.r(E,Mt),s&&p.q(s.tsr_local_pose_b,Mt,Mt),p.a(Mt,t.tsr_local_pose_b),p.q(Mt,t.tsr_local_rest_i,Mt),p.l(Mt,T),p.g(Mt,E),u.slerp(f,P,c,f),v.G(A,S,c,A),p.w(A,Mt),p.r(f,Mt),s&&p.q(s.tsr_local_pose_a,Mt,Mt),p.a(Mt,t.tsr_local_pose_a),p.q(Mt,t.tsr_local_rest_i,Mt),p.l(Mt,A),p.g(Mt,f);for(var L=0;L<4;L++)e.quats_before[m+L]=E[L],e.trans_before[m+L]=T[L],e.quats_after[m+L]=f[L],e.trans_after[m+L]=A[L];for(var M=t.descend_bones_ptrs,L=0;L<M.length;L++){ae(e,M[L],r,a,_,n,o,i)}}function _e(e,t){for(var r=4*t.bone_index,a=t.parent_bone_ptr,_=e.anim_mix_factor,n=Nt,o=It,i=gt,s=bt,c=0;c<4;c++)n[c]=e.trans_before[r+c],o[c]=e.quats_before[r+c],i[c]=e.trans_after[r+c],s[c]=e.quats_after[r+c];p.w(n,Mt),p.r(o,Mt),p.q(Mt,t.tsr_local_rest,Mt),p.a(Mt,t.tsr_local_pose_b),a&&(p.p(a.tsr_local_pose_b,yt),p.q(yt,Mt,Mt)),p.l(Mt,n),p.g(Mt,o),p.w(i,Mt),p.r(s,Mt),p.q(Mt,t.tsr_local_rest,Mt),p.a(Mt,t.tsr_local_pose_a),a&&(p.p(a.tsr_local_pose_a,yt),p.q(yt,Mt,Mt)),p.l(Mt,i),p.g(Mt,s),u.slerp(o,s,_,o),v.G(n,i,_,n);for(var c=0;c<4;c++)e.quats_curr[r+c]=o[c],e.trans_curr[r+c]=n[c];for(var E=t.descend_bones_ptrs,c=0;c<E.length;c++){_e(e,E[c])}}function ne(e,t){var r=e.render,a=r.anim_mix_factor,_=r.anim_mix_factor_change_speed;if(0!=_){!r.mix_with_current||r.trans_curr||r.quats_curr||(a=r.anim_mix_factor=0);var n=r.anim_destination_mix_factor,o=n-a,i=_*t;v._50(o)==v._50(_)&&Math.abs(i)<Math.abs(o)?r.anim_mix_factor+=i:(r.anim_mix_factor=r.anim_destination_mix_factor,r.anim_mix_factor_change_speed=0,r.anim_mix_cb&&(r.anim_mix_cb(),r.anim_mix_cb=null),r.mix_with_current&&(r.trans_curr=null,r.quats_curr=null,r.mix_with_current=!1))}}function oe(e,t){for(var r=[],a=[],_=[],n=[],o=e._render.num_pierced,i=0;i<o;i++){for(var s in t){var c=t[s],E=c.tsr_basis,l=e._render.bones[s];l?p.f(l,i,E):p.m(E),c.tsr_channel_cache_valid=!1}var T=ie(t);r.push(T.trans),a.push(T.quats),_.push(T.bone_space_trans),n.push(T.bone_space_quats)}return{trans:r,quats:a,bone_space_trans:_,bone_space_quats:n}}function ie(e){var t=[],r=[],a=[],_=[],n=new Float32Array(4),o=new Float32Array(4),i=new Float32Array(4),s=new Float32Array(4);for(var c in e){var E=e[c];Ee(E,n,o);var l=E.bone_index;p.q(E.tsr_bone_rest,E.tsr_basis,Mt),p.l(Mt,i),p.g(Mt,s);for(var T=0;T<4;T++){var u=4*l+T;t[u]=n[T],r[u]=o[T],a[u]=i[T],_[u]=s[T]}}return{trans:t,quats:r,bone_space_trans:a,bone_space_quats:_}}function se(e,t){for(var r=[],a=[],_=e.trans,n=e.quats,o=0;o<_.length;o++){var i=ce(_[o],n[o],t);r.push(i.trans),a.push(i.quats)}return{trans:r,quats:a}}function ce(e,t,r){var a=[],_=[];for(var n in r)for(var o=r[n],i=o.bone_index,s=o.deform_bone_index,c=0;c<4;c++){var E=4*s+c,l=4*i+c;a[E]=e[l],_[E]=t[l]}return a=new Float32Array(a),_=new Float32Array(_),{trans:a,quats:_}}function Ee(e,t,r){var a=e.chain,_=a[a.length-1],n=_.tsr_channel_cache;_.tsr_channel_cache_valid||p.m(n);for(var o=a.length-1;o>=0;o--){var i=a[o],s=i.tsr_channel_cache;if(i.tsr_channel_cache_valid)n=s;else{var c=i.tsr_local_rest,E=i.tsr_basis;p.p(c,Mt),p.q(E,Mt,Mt),p.q(c,Mt,Mt),p.q(n,Mt,s),n=s,i.tsr_channel_cache_valid=!0}}var l=i.tsr_channel_cache;p.l(l,t),p.g(l,r)}function le(e){var t=e._render;t.bones?t.type=Je:t.params?"volume"in t.params||"pitch"in t.params?t.type=et:Te(e)?t.type=rt:ue(e)?t.type=at:de(e)?t.type=_t:fe(e)?t.type=Ze:t.type=We:t.type=We}function Te(e){var t=e._render.params;if(t)for(var r in t)if(-1!=r.indexOf("nodes"))return!0;return!1}function ue(e){if(e._render.params){var t=e.fcurves;for(var r in t)if("color"==r&&!t[r][3])return!0;if("energy"==r)return!0}return!1}function de(e){var t=e._render.params;return"light_settings.environment_energy"in t||"horizon_color"in t||"zenith_color"in t||"mist_settings.intensity"in t||"mist_settings.depth"in t||"mist_settings.start"in t||"mist_settings.height"in t||"b4w_fog_color"in t}function fe(e){if(e._render.params){var t=e.fcurves;for(var r in t)if("location"==r||"rotation_quaternion"==r||"scale"==r)return!0}return!1}function Pe(e,t){t[0]=t[1]=t[2]=0;for(var r in e)"location"==r?t[0]=1:"rotation_quaternion"==r?t[1]=1:"scale"==r&&(t[2]=1)}function Ae(e,t){t[0]=t[1]=0;for(var r in e)"energy"==r?t[0]=1:"color"==r&&(t[1]=1)}function Se(e,t){t[lt]=t[Tt]=t[ut]=0,t[dt]=t[ft]=t[Pt]=0,t[At]=t[St]=0;for(var r in e)"light_settings.environment_energy"==r?t[lt]=1:"horizon_color"==r?t[Tt]=1:"zenith_color"==r?t[ut]=1:"mist_settings.intensity"==r?t[dt]=1:"mist_settings.depth"==r?t[ft]=1:"mist_settings.start"==r?t[Pt]=1:"mist_settings.height"==r?t[At]=1:"b4w_fog_color"==r&&(t[St]=1)}function pe(e,t,r){var a=t[0],_=t[1],n=r[0],o=r[1],i=(o-_)/(n-a);return i*e+(_-i*a)}function ve(e,t,r,a){var _,n,o,i,s=[],c=[];s[0]=e[0]-t[0],s[1]=e[1]-t[1],c[0]=a[0]-r[0],c[1]=a[1]-r[1],o=a[0]-e[0],_=Math.abs(s[0]),n=Math.abs(c[0]),_+n!=0&&_+n>o&&(i=o/(_+n),t[0]=e[0]-i*s[0],t[1]=e[1]-i*s[1],r[0]=a[0]-i*c[0],r[1]=a[1]-i*c[1])}function me(e,t,r,a,_){return Ne(Oe(0,1,e,t[0],r[0],a[0],_[0]),t[1],r[1],a[1],_[1])}function Oe(e,t,r,a,_,n,o){var i=e+(t-e)/2,s=Ne(i,a,_,n,o),c=s-r;return Math.abs(c)<.02?i:c>0?Oe(e,i,r,a,_,n,o):Oe(i,t,r,a,_,n,o)}function Ne(e,t,r,a,_){var n=1-e;return t*n*n*n+3*r*n*n*e+3*a*n*e*e+_*e*e*e}function ge(e,t,r,a){var _=r[0],n=r[1],o=r[2],i=e.trans,s=i[_][4*t],c=i[_][4*t+1],E=i[_][4*t+2],l=i[n][4*t],T=i[n][4*t+1],u=i[n][4*t+2];return a[0]=(1-o)*s+o*l,a[1]=(1-o)*c+o*T,a[2]=(1-o)*E+o*u,a}function he(e,t,r,a){var _=r[0],n=r[1],o=r[2],i=e.quats,s=bt;s[0]=i[_][4*t],s[1]=i[_][4*t+1],s[2]=i[_][4*t+2],s[3]=i[_][4*t+3];var c=Yt;return c[0]=i[n][4*t],c[1]=i[n][4*t+1],c[2]=i[n][4*t+2],c[3]=i[n][4*t+3],u.slerp(s,c,o,a),a}function Re(e,t,r,a){var _=r[0],n=r[1],o=r[2],i=e.scale,s=i[_][4*t],c=i[_][4*t+1],E=i[_][4*t+2],l=i[n][4*t],T=i[n][4*t+1],u=i[n][4*t+2];return a[0]=(1-o)*s+o*l,a[1]=(1-o)*c+o*T,a[2]=(1-o)*E+o*u,a}function Ie(e,t){g(e,t),h(e)}function be(e,t){Qe.update_transform(e),ke.sync_transform(e),C(e,0,t,!0)}function Ye(e,t,r,a){if(a=a||nt,Fe.is_mesh(e)){var n=ye(e,r);if(n)return Ie(e,a),_(e,n,a),be(e,a),!0;var o=xe(e,r);if(o&&"EMITTER"==o.p_type)return Ie(e,a),N(e,o.name,a),be(e,a),!0}var i=v._19("name",r,Ut)||v._19("name",r+"_B4W_BAKED",Ut);if(i){if(Ie(e,a),G(e,t,i,a))return be(e,a),!0;e.anim_slots[a]=null}return Ke.error('Unsupported object: "'+e.name+'" or animation name: "'+r+'"'),!1}function Le(e,t){for(var r=e.anim_slots,a=0;a<r.length;a++){var _=r[a];if(_&&R(_.animation_name)==R(t))return a}return-1}function Me(e,t){return e.anim_slots[t].start}function ye(e,t){for(var r=0;r<e.vertex_anim.length;r++){var a=e.vertex_anim[r];if(a.name===t)return a}return null}function xe(e,t){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var _=r[a].batches,n=0;n<_.length;n++){var o=_[n].particles_data;if(o&&o.name===t)return o}return null}function Ue(e){for(var t=e.modifiers,r=0;r<t.length;r++){var a=t[r];if("ARMATURE"==a.type)return a.object}return null}function we(e,t){for(var r=ot,a=We,_=0;_<Ut.length;_++){var n=Ut[_];if(n.name==t){a=n._render.type;break}}if(a==We)if(ye(e,t))a=$e;else{var o=xe(e,t);o&&"EMITTER"==o.p_type&&(a=tt)}for(var _=0;_<8;_++){var i=e.anim_slots[_];if(i){if(i.type==a)return _}else _<r&&(r=_)}return r}var Ce=Object(o.a)(e),De=Object(i.a)(e),Fe=Object(c.a)(e),Ge=Object(E.a)(e),ke=Object(l.a)(e),Ke=Object(T.a)(e),Be=Object(d.a)(e),Xe=Object(f.a)(e),je=Object(P.a)(e),He=Object(A.a)(e),Qe=Object(S.a)(e),ze=De.animation,qe=De.context_limits,Ve=1e-6;t.LAST_FRAME_EPSILON=Ve;var We=0,Je=10,Ze=20,$e=30,et=40,tt=50,rt=60,at=70,_t=80;t.OBJ_ANIM_TYPE_NONE=We,t.OBJ_ANIM_TYPE_ARMATURE=Je,t.OBJ_ANIM_TYPE_OBJECT=Ze,t.OBJ_ANIM_TYPE_VERTEX=$e,t.OBJ_ANIM_TYPE_SOUND=et,t.OBJ_ANIM_TYPE_PARTICLES=tt,t.OBJ_ANIM_TYPE_MATERIAL=rt,t.OBJ_ANIM_TYPE_LIGHT=at,t.OBJ_ANIM_TYPE_ENVIRONMENT=_t;var nt=0,ot=7,it=-1;t.SLOT_0=nt,t.SLOT_1=1,t.SLOT_2=2,t.SLOT_3=3,t.SLOT_4=4,t.SLOT_5=5,t.SLOT_6=6,t.SLOT_7=ot,t.SLOT_ALL=it;var st=10,ct=20,Et=30;t.AB_CYCLIC=st,t.AB_FINISH_RESET=ct,t.AB_FINISH_STOP=Et;var lt=0,Tt=1,ut=2,dt=3,ft=4,Pt=5,At=6,St=7,pt=new Array(3),vt=new Float32Array(3),mt=new Float32Array(3),Ot=new Float32Array(3),Nt=new Float32Array(4),gt=new Float32Array(4),ht=new Float32Array(4),Rt=new Float32Array(4),It=new Float32Array(4),bt=new Float32Array(4),Yt=new Float32Array(4),Lt=new Float32Array(4),Mt=p.b(),yt=p.b(),xt=[],Ut=[];t.get_max_bones=function(){return v._64((qe.max_vertex_uniform_vectors-50)/4)},t.frame_to_sec=function(e){return e/He.get_framerate()},t.update=function(e){for(var t=0;t<xt.length;t++){for(var r=xt[t],_=0;_<8;_++)Z(r,e,_);r.render.anim_mixing&&(ne(r,e),re(r,e))}for(var t=0;t<xt.length;t++)for(var r=xt[t],_=0;_<8&&r.anim_slots.length;_++)a(r,_)},t.get_all_actions=function(){return Ut},t.get_anim_names=function(e){var t=[];if(y(e))for(var r=0;r<e.vertex_anim.length;r++)t.push(e.vertex_anim[r].name);for(var a=I(e),r=0;r<a.length;r++)t.push(R(a[r].name));if(Ge.obj_has_particles(e)&&Ge.obj_has_anim_particles(e))for(var _=e.scenes_data,r=0;r<_.length;r++)for(var n=_[r].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&t.push(i.name)}return t},t.strip_baked_suffix=R,t.get_anim_type=function(e,t){var r=e.anim_slots[t];return r?r.type:We},t.apply_def=function(e){for(var t=nt,r=e.scenes_data,a=0;a<r.length;a++)for(var n=r[a].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&"EMITTER"==i.p_type&&!n[o].forked_batch&&(Ie(e,t),O(n[o],e.anim_slots[t],i),be(e,t),i.cyclic?e.anim_slots[t].behavior=st:e.anim_slots[t].behavior=e.anim_behavior_def,t++)}for(var s=b(e),a=0;a<s.length;a++){var c=s[a],E=c.name_list,l=c.action;Ie(e,t),G(e,E,l,t)?(be(e,t),e.anim_slots[t].behavior=e.anim_behavior_def,t++):e.anim_slots[t]=null}y(e)&&(Ie(e,t),_(e,e.vertex_anim[0],t),be(e,t),e.anim_slots[t].behavior=e.anim_behavior_def,t++)},t.anim_behavior_bpy_b4w=function(e){switch(e){case"CYCLIC":return st;case"FINISH_RESET":return ct;case"FINISH_STOP":return Et;default:Ce.panic("Wrong animation behavior")}},t.get_bpy_material_actions=function(e){for(var t=[],r=e.data.materials,a=0;a<r.length;a++){var _=r[a],n=_.node_tree;n&&M(n,t,[_.name])}return t},t.get_bpy_world_material_actions=Y,t.init_action_slot=L,t.play=function(e,t,r){function a(e){e.play=!0,e.finish_callback=t||null,e.exec_finish_callback=!1}w(e.anim_slots,r,a),e.render.anim_mixing&&Q(e)},t.stop=function(e,t){function r(e){e.play=!1,e.finish_callback=null,e.exec_finish_callback=!1}w(e.anim_slots,t,r)},t.is_play=function(e,t){var r=e.anim_slots;if(t==it){for(var a=0;a<8;a++)if(r[a]&&r[a].play)return!0}else{var _=r[t];if(_)return _.play}return!1},t.set_frame=x,t.set_first_frame=U,t.get_current_frame_float=function(e,t){var r=e.anim_slots[t];return r&&r.current_frame_float?r.current_frame_float:0},t.is_cyclic=function(e,t){var r=e.anim_slots[t];return r&&r.behavior==st},t.set_behavior=function(e,t,r){function a(e){e.behavior=t}w(e.anim_slots,r,a)},t.get_behavior=function(e,t){var r=e.anim_slots[t];return r&&r.behavior},t.apply_smoothing=function(e,t,r,a){function _(e){e.trans_smooth_period=t||0,e.quat_smooth_period=r||0}w(e.anim_slots,a,_)},t.remove_slot_animation=function(e,t){if(t==it)for(var r=0;r<8;r++)e.anim_slots[r]=null;else e.anim_slots[t]=null;e.render.anim_mixing&&z(e,t)},t.update_object_animation=C,t.obj_is_animatable=function(e){if("ARMATURE"==e.type)return!0;if(e.armobj)return!0;if("WORLD"==e.type)return!0;for(var t=0;t<e.def_action_slots.length;t++){var r=e.def_action_slots[t],a=r.action._render.type;if(a==Ze||a==Je||a==et&&"SPEAKER"==e.type||a==at&&"LAMP"==e.type||a==rt&&"MESH"==e.type)return!0}return!(!Ge.obj_has_particles(e)||!Ge.obj_has_anim_particles(e))||!("MESH"!=e.type||!e.vertex_anim.length)},t.bpy_mesh_empty_is_animatable=function(e){if(Ue(e))return!0;if(e._def_action_slots)for(var t=0;t<e._def_action_slots.length;t++){var r=e._def_action_slots[t],a=r.action,_=a._render.type;if(_==Ze||_==rt&&"MESH"==e.type)return!0}return!(!Ge.bpy_obj_has_particles(e)||!Ge.bpy_obj_has_anim_particles(e))||!("MESH"!=e.type||!e.data.b4w_vertex_anim.length)},t.is_animated=D,t.init_action_cache=F,t.delete_cached_anim_data_by_mat=K;var wt=function(){var e=p.b();return function(t,r,a){for(var _=r._render,n=_.num_pierced,o=[],i=[],s=[],c=0;c<n;c++){var E=p.f(a,c,e),l=p.j(E,m.create()),T=p.i(E,m.create()),d=p.g(E,u.create());o.push(l),i.push(T),s.push(d)}return{trans:o,scale:i,quats:s}}}();t.calc_pose_data=ie,t.extract_skinned_pose_data=ce,t.append_action=function(e){var t=new RegExp(/pose.bones\[\".+\"\]/g),a=p.b(),_=function(e,t){if("object"==typeof t&&t.length)for(var r=t.length,a=new Float32Array(e*r),_=0;_<e;_++)for(var n=0;n<r;n++)a[_*r+n]=t[n];else if("number"==typeof t)for(var a=new Float32Array(e),_=0;_<e;_++)a[_]=t;else Ce.panic("Wrong storage default value");return a},n=function(e,r,n,o,i){if(n.search(t)>-1)var s=r,c=n.split('"')[1],E=a;else{var s=e;if(8==i||9==i)var c="tsr",E=a;else if(i>1)var c=n,E=new Float32Array(i);else var c=n,E=0}return s[c]||(s[c]=_(o,E)),s[c]},o=e._render=r();o.pierce_step=1/ze.frame_steps;var i=e.fcurves,s={},c={},E=0;for(var l in i){var T=i[l];Object.keys(T);for(var u in T){var d=T[u],f=d._pierced_points,P=d.num_channels;E||(E=f.length);var A=n(s,c,l,E,P),S=A.length/E,m=function(e,t){if(e.indexOf("location")>-1)var r=0,a=t;else if(e.indexOf("rotation_quaternion")>-1)var r=6,a=0==t?NaN:t-1;else if(e.indexOf("scale")>-1)var r=3,a=t;else var r=0,a=t;return r+a}(l,0|u);if(m==m)if(l.indexOf("scale")>-1&&8===P)for(var O=0;O<E;O++)A[O*S+m]=f[O],A[O*S+m+1]=f[O],A[O*S+m+2]=f[O];else for(var O=0;O<E;O++)A[O*S+m]=f[O]}if(l.indexOf("rotation_quaternion")>-1&&0 in T)for(var d=T[0],f=d._pierced_points,P=d.num_channels,A=n(s,c,l,E,P),S=A.length/E,O=0;O<E;O++)f[O]<0&&(A[O*S+6]=-A[O*S+6],A[O*S+7]=-A[O*S+7],A[O*S+8]=-A[O*S+8])}v._8(s)&&(o.params=s),v._8(c)&&(o.bones=c),o.num_pierced=E,o.bflags=e._bflags,"tsr"in s&&Pe(i,o.channels_mask),("color"in s||"energy"in s)&&Ae(i,o.channels_mask),("light_settings.environment_energy"in s||"horizon_color"in s||"zenith_color"in s||"mist_settings.intensity"in s||"mist_settings.depth"in s||"mist_settings.start"in s||"mist_settings.height"in s||"b4w_fog_color"in s)&&Se(i,o.channels_mask),le(e),Ut.push(e)},t.get_approx_curve_length=function(e,t){return(t-e)*ze.frame_steps+1},t.approximate_curve=function(e,t,r,a,_,n){for(var o=new Float32Array(2),i=new Float32Array(2),s=new Float32Array(2),c=new Float32Array(2),E=t[1],l=t[2],T=t[e.last_frame_offset+1],u=t[e.last_frame_offset+2],d=0,f=0,P=null,A=_;A<=n;A++)if(A<E)for(var S=0;S<ze.frame_steps;S++)r[d++]=l;else if(A>T)for(var S=0;S<ze.frame_steps;S++)r[d++]=u;else{var p=t[f],v=3;0===p&&(v+=2),0===P&&(v+=2);var m=2===p?0:1;if(t[f+1]==t[f+v+1]){P=p,f+=v;continue}var O=0;if(A==t[f+1]&&(m&&(a[d]=1),r[d]=t[f+2],d++,O++),A==T)for(var S=O;S<ze.frame_steps;S++)r[d++]=u;else{o[0]=t[f+1],o[1]=t[f+2],0!==p?(i[0]=0,i[1]=0):0===P?(i[0]=t[f+5],i[1]=t[f+6]):(i[0]=t[f+3],i[1]=t[f+4]),0!==p?(s[0]=0,s[1]=0):(s[0]=t[f+v+3],s[1]=t[f+v+4]),c[0]=t[f+v+1],c[1]=t[f+v+2];for(var S=O;S<ze.frame_steps;S++){var N=A+S/ze.frame_steps;switch(p){case 0:ve(o,i,s,c),m&&(a[d]=1),r[d]=me(N,o,i,s,c),d++;break;case 1:m&&(a[d]=1),r[d]=pe(N,o,c),d++;break;case 2:m&&(a[d]=1),r[d]=t[f+2],d++;break;default:Ce.panic("Unknown keyframe interpolation mode: "+p)}}}A+1==t[f+v+1]&&(P=p,f+=v)}},t.apply=Ye,t.apply_by_uuid=function(e,t,r,a){a=a||nt;var _=v._19("uuid",r,Ut);if(_){if(Ie(e,a),G(e,t,_,a))return be(e,a),!0;e.anim_slots[a]=null}return Ke.error('Unsupported object: "'+e.name+'" or animation uuid: "'+r+'"'),!1},t.validate_action_by_name=function(e,t){var r=v._19("name",t,Ut)||v._19("name",t+"_B4W_BAKED",Ut);if(r){if(r._render.type==We)return!1}else{if(!xe(e,t)&&(!Fe.is_mesh(e)||!ye(e,t)))return!1}return!0},t.get_slot_num_by_anim=Le,t.get_anim_by_slot_num=function(e,t){var r=e.anim_slots[t];return r&&r.animation_name?R(r.animation_name):null},t.remove=function(e){e.anim_slots.length=0;var t=xt.indexOf(e);-1!=t&&xt.splice(t,1)},t.remove_actions=function(e){for(var t=Ut.length-1;t>=0;t--)Ut[t]._data_id==e&&Ut.splice(t,1)},t.apply_to_first_empty_slot=function(e,t){if(!e.anim_slots.length)return Ye(e,null,t,nt)?nt:-1;for(var r=0;r<e.anim_slots.length;r++)if(!e.anim_slots[r])return Ye(e,null,t,r)?r:-1},t.set_skel_mix_factor=function(e,t,r,a){var _=e.render,n=_.anim_mix_factor,o=(t-n)/r;_.anim_mix_factor_change_speed=o,_.anim_destination_mix_factor=t,_.anim_mix_cb&&_.anim_mix_cb(),_.anim_mix_cb=a},t.mix_from_cur_pos=function(e,t,r,a){var _=e.render;_.blend_skel_slots[1]=t;var n=1/r;_.anim_mix_factor_change_speed=n,_.anim_destination_mix_factor=1,_.anim_mix_cb&&_.anim_mix_cb(),_.anim_mix_cb=a,_.trans_curr=null,_.quats_curr=null,_.mix_with_current=!0},t.set_speed=function(e,t,r){function a(e){e.speed=t}w(e.anim_slots,r,a)},t.get_speed=function(e,t){return e.anim_slots[t].speed},t.get_anim_start_frame=Me,t.get_anim_length=function(e,t){return e.anim_slots[t].length},t.cleanup=function(){xt.length=0,Ut.length=0},t.fcurve_replace_euler_by_quat=function(e){var t=e[0]||e[1]||e[2],r=t._pierced_points.length,a=It,_=vt,n=Boolean(e[0]);n||(e[0]={_pierced_points:new Float32Array(r),num_channels:8});var o=Boolean(e[1]);o||(e[1]={_pierced_points:new Float32Array(r),num_channels:8});var i=Boolean(e[2]);i||(e[2]={_pierced_points:new Float32Array(r),num_channels:8}),e[3]={_pierced_points:new Float32Array(r),num_channels:8};for(var s=0;s<r;s++)_[0]=n?e[0]._pierced_points[s]:0,_[1]=o?e[1]._pierced_points[s]:0,_[2]=i?e[2]._pierced_points[s]:0,v.Y(_,a),e[0]._pierced_points[s]=a[3],e[1]._pierced_points[s]=a[0],e[2]._pierced_points[s]=a[1],e[3]._pierced_points[s]=a[2]},t.get_bpy_armobj=Ue,t.slot_by_anim_type=we}var _=r(0),n=r(59),o=r(5),i=r(4),s=r(60),c=r(9),E=r(50),l=r(19),T=r(1),u=r(8),d=r(10),f=r(23),P=r(11),A=r(18),S=r(13),p=r(6),v=r(2),m=r(3),O=(r(7),Object(_.a)("__animation",a));t.a=O},function(e,t,r){"use strict";function a(e,t){function r(e){var t=ee.detect_mobile();return!(!(e!=Ee||navigator.getVRDevices||navigator.getVRDisplays||t&&$())||!(e!=ce||t&&window.DeviceOrientationEvent))}function a(e,t){if(!r(e))return null;var a={type:e,registered:!1,orientation_quat_cb_list:[],orientation_angles_cb_list:[],mouse_down_which_cb_list:[],mouse_location_cb_list:[],mouse_up_which_cb_list:[],mouse_wheel_cb_list:[],keyboard_down_cb_list:[],keyboard_down_mod_cb_list:[],keyboard_up_cb_list:[],touch_start_cb_list:[],touch_move_cb_list:[],touch_end_cb_list:[],element:t,prevent_default:!0,registered_event_listeners:[],mouse_location:new Float32Array(2),mouse_which:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),registered_cb:null,webvr_hmd_device:null,webvr_sensor_devices:null,webvr_display:null,orientation:l.create(),position:u.create(),frame_data:window.VRFrameData?new VRFrameData:null,standing_tsr:E.b(),fov_left:new Float32Array(4),fov_right:new Float32Array(4),inter_lens_dist:0,base_line_dist:0,screen_to_lens_dist:0,width_dist:0,height_dist:0,bevel_size:0,gamepad_btns:[],gamepad_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_prev_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_mapping:[]};return a.fov_left[0]=a.fov_left[1]=a.fov_left[2]=a.fov_left[3]=Math.PI/4,a.fov_right[0]=a.fov_right[1]=a.fov_right[2]=a.fov_right[3]=Math.PI/4,e==le||e==Te||e==ue?(a.registered=Boolean(t),e==ue?document.addEventListener("touchstart",function(){}):e==Te&&(a.prevent_default=!1)):e==ce?a.registered=!0:e==Ee&&f(a),a}function _(e,t){e==ce||e==Ee?t=window:t||(t=e==Te?document:te.get_container());for(var r=0;r<He.length;r++)if(He[r].type==e&&He[r].element==t)return He[r];var _=a(e,t);return e!=de&&e!=fe&&e!=Pe&&e!=Ae||P(_),_&&He.push(_),_}function f(e){e.type==Ee&&(navigator.getVRDisplays?navigator.getVRDisplays().then(function(t){t.length>0&&(e.webvr_display=t[0],e.registered=!0,e.webvr_display.getFrameData(e.frame_data),e.registered_cb&&e.registered_cb())},function(t){ae.error_once("WebVR displays are not found."),e.registered=!1}):navigator.getVRDevices?(navigator.getVRDevices().then(function(t){v(e,t),t.length&&(e.registered=!0),e.registered_cb&&e.registered_cb()},function(t){ae.error_once("WebVR devices are not found."),e.registered=!1}),S(e,ne.webvr)):(A(e),e.registered=!0))}function P(e){e.gamepad_mapping.push(t.GMPD_BUTTON_0,t.GMPD_BUTTON_1,t.GMPD_BUTTON_2,t.GMPD_BUTTON_3,t.GMPD_BUTTON_4,t.GMPD_BUTTON_5,t.GMPD_BUTTON_6,t.GMPD_BUTTON_7,t.GMPD_BUTTON_8,t.GMPD_BUTTON_9,t.GMPD_BUTTON_10,t.GMPD_BUTTON_11,t.GMPD_BUTTON_12,t.GMPD_BUTTON_13,t.GMPD_BUTTON_14,t.GMPD_BUTTON_15,t.GMPD_BUTTON_16,t.GMPD_BUTTON_17,t.GMPD_BUTTON_18,t.GMPD_BUTTON_19,t.GMPD_BUTTON_20,t.GMPD_BUTTON_21,t.GMPD_BUTTON_22,t.GMPD_BUTTON_23,t.GMPD_BUTTON_24,t.GMPD_BUTTON_25,t.GMPD_AXIS_0,t.GMPD_AXIS_1,t.GMPD_AXIS_2,t.GMPD_AXIS_3,t.GMPD_AXIS_4,t.GMPD_AXIS_5,t.GMPD_AXIS_6,t.GMPD_AXIS_7,t.GMPD_AXIS_8,t.GMPD_AXIS_9,t.GMPD_AXIS_10,t.GMPD_AXIS_11)}function A(e){var t=ne.nonwebvr;e.width_dist=t.width_dist,e.height_dist=t.height_dist,e.bevel_size=t.bevel_size,S(e,t),e.inter_lens_dist=t.inter_lens_dist,e.base_line_dist=t.base_line_dist,e.screen_to_lens_dist=t.screen_to_lens_dist,p(e)}function S(e,t){e.distortion_coefs[0]=t.distortion_coefs[0],e.distortion_coefs[1]=t.distortion_coefs[1],e.chromatic_aberration_coefs[0]=t.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1]=t.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2]=t.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]=t.chromatic_aberration_coefs[3]}function p(e){var t=e.inter_lens_dist/2,r=t/e.screen_to_lens_dist,a=Math.atan(r*ne.nonwebvr.distor_scale),_=a,n=a,o=a;o&&(e.fov_left[0]=e.fov_right[0]=Math.min(o,Math.PI/3)),a&&(e.fov_left[1]=e.fov_right[3]=Math.min(a,Math.PI/3)),n&&(e.fov_left[2]=e.fov_right[2]=Math.min(n,Math.PI/3)),_&&(e.fov_left[3]=e.fov_right[1]=Math.min(_,Math.PI/3))}function v(e,t){var r=t.filter(function(e){return e instanceof HMDVRDevice}),a=null;r.length&&(a=r[0]);var _=null;a&&(_=t.filter(function(e){return-1!==e.deviceName.toLowerCase().indexOf("oculus")&&e.hardwareUnitId==a.hardwareUnitId&&e instanceof PositionSensorVRDevice})),e.webvr_hmd_device=a,e.webvr_sensor_devices=_}function m(e){switch(e.type){case Ee:if(e.registered)if(e.webvr_display)e.webvr_display.resetPose();else if(e.webvr_sensor_devices)for(var t=0;t<e.webvr_sensor_devices.length;t++){var r=e.webvr_sensor_devices[t];r.resetSensor()}break;default:return void ae.error("reset_device() is undefined for device: ",e.type)}}function O(e,t,r){switch(e.type){case Ee:var a=g(e,Ne);if(a&Se){if("left"==t)var _=e.fov_left;else var _=e.fov_right;d.copy(_,r)}else{var n=e.webvr_display||e.webvr_hmd_device;if(n){var o=n.getEyeParameters(t),_=o.fieldOfView||o.currentFieldOfView;if(_)r[0]=T.T(_.upDegrees),r[1]=T.T(_.rightDegrees),r[2]=T.T(_.downDegrees),r[3]=T.T(_.leftDegrees);else if(a&Oe){var i=se;"left"==t?s.copy(e.frame_data.leftProjectionMatrix,i):s.copy(e.frame_data.rightProjectionMatrix,i);var c=s.invert(i,i);c||(c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);u.transformMat4([1,1,-1],c,ke);r[0]=Math.atan(-ke[1]/ke[2]),r[1]=Math.atan(-ke[0]/ke[2]);u.transformMat4([-1,-1,-1],c,ke);r[2]=Math.atan(ke[1]/ke[2]),r[3]=Math.atan(ke[0]/ke[2])}}}break;default:ae.error("fov is undefined for device: ",e.type)}return r}function N(e,t,r){switch(e.type){case Ee:e.webvr_display&&("left"==t?s.copy(e.frame_data.leftProjectionMatrix,r):"right"==t?s.copy(e.frame_data.rightProjectionMatrix,r):ae.error("Unknown type of eye: ",t));break;default:ae.error("Projection matrix is undefined for device: ",e.type)}return r}function g(e,t){switch(t){case Ne:var r=0;return navigator.getVRDisplays&&(r|=me,e.frame_data&&(r|=Oe)),navigator.getVRDevices&&(_e.is_mobile_device?r|=ve:r|=pe),r=r||Se;case ge:var a=e.webvr_display||e.webvr_hmd_device;if(a){var _=a.getEyeParameters("left"),n=a.getEyeParameters("right");return e.webvr_display?n.offset[0]-_.offset[0]:n.eyeTranslation.x-_.eyeTranslation.x}return e.inter_lens_dist}}function h(e,t){if(e.webvr_display){var r=e.webvr_display;if(e.frame_data&&r.getFrameData(e.frame_data)){var a=e.frame_data.pose,_=T._26(e.frame_data.leftViewMatrix,ke);e.inter_lens_dist=2*u.length(_)}else if(r.getPose)var a=r.getPose();if(a){var n=l.setAxisAngle(T.d,Math.PI/2,Fe);if(r.stageParameters&&r.stageParameters.sittingToStandingTransform){var o=E.d(r.stageParameters.sittingToStandingTransform,oe);E.m(ie);var i=E.r(n,ie);o=E.q(i,o,e.standing_tsr)}else{E.m(oe);var o=E.r(n,e.standing_tsr)}a.orientation&&E.A(a.orientation,o,e.orientation),a.position&&E.D(a.position,o,e.position)}}}function R(e,t){if(e){for(var r=0;r<e.buttons.length;r++)t.gamepad_btns[r]=e.buttons[r].value||+e.buttons[r].pressed;if(e.axes)for(var r=0;r<e.axes.length;r++)t.gamepad_axes[r]=e.axes[r];var a=e.pose;if(a){var n=_(Ee),o=n.standing_tsr;a.position&&E.D(a.position,o,t.position),a.orientation&&E.A(a.orientation,o,t.orientation)}}}function I(e){for(var t=0;t<e.gamepad_btns;t++)e.gamepad_btns[t]=0;for(var t=0;t<e.gamepad_axes.length;t++)e.gamepad_prev_axes[t]=e.gamepad_axes[t],e.gamepad_axes[t]=0;e.position.set(T.m),e.orientation.set(T.k)}function b(e,t){var r=e.indexOf(t);r>=0&&(e[r]=null)}function Y(e){return null===e}function L(e,t,r,a){switch(t){case we:if(r&&b(e.orientation_quat_cb_list,r),a||e.orientation_angles_cb_list.every(Y)&&e.orientation_quat_cb_list.every(Y)){e.orientation_quat_cb_list.length=0,e.orientation_angles_cb_list.length=0,t=De;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("deviceorientation",C,!1))}break;case Ce:if(r&&b(e.orientation_angles_cb_list,r),a||e.orientation_angles_cb_list.every(Y)&&e.orientation_quat_cb_list.every(Y)){e.orientation_quat_cb_list.length=0,e.orientation_angles_cb_list.length=0,t=De;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("deviceorientation",C,!1))}break;case Ie:if(r&&b(e.mouse_down_which_cb_list,r),a||e.mouse_down_which_cb_list.every(Y)){e.mouse_down_which_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("mousedown",k,!1))}break;case he:if(r&&b(e.mouse_location_cb_list,r),a||e.mouse_location_cb_list.every(Y)){e.mouse_location_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("mousemove",F,!1))}break;case Re:if(r&&b(e.mouse_location_cb_list,r),a||e.mouse_location_cb_list.every(Y)){e.mouse_location_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("mousemove",G,!1))}break;case be:if(r&&b(e.mouse_up_which_cb_list,r),a||e.mouse_up_which_cb_list.every(Y)){e.mouse_up_which_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("mouseout",K,!1),e.element.removeEventListener("mouseup",B,!1));break}break;case Ye:if(r&&b(e.mouse_wheel_cb_list,r),a||e.mouse_wheel_cb_list.every(Y)){e.mouse_wheel_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("wheel",j,!1))}break;case Me:if(r&&b(e.keyboard_down_cb_list,r),a||e.keyboard_down_cb_list.every(Y)){e.keyboard_down_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("keydown",H,!1))}break;case Le:if(r&&b(e.keyboard_up_cb_list,r),a||e.keyboard_up_cb_list.every(Y)){e.keyboard_up_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("keyup",Q,!1))}break;case ye:if(r&&b(e.touch_start_cb_list,r),a||e.touch_start_cb_list.every(Y)){e.touch_start_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("touchstart",z,!1))}break;case xe:if(r&&b(e.touch_move_cb_list,r),a||e.touch_move_cb_list.every(Y)){e.touch_move_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("touchmove",q,!1))}break;case Ue:if(r&&b(e.touch_end_cb_list,r),a||e.touch_end_cb_list.every(Y)){e.touch_end_cb_list.length=0;var _=e.registered_event_listeners.indexOf(t);_>=0&&(e.registered_event_listeners.splice(_,1),e.element.removeEventListener("touchend",V,!1))}}}function M(){return/iPad|iPhone|iPod/.test(navigator.platform)}function y(e,t){switch(t){case Ie:M()||e.element.addEventListener("mousedown",k,!1);break;case he:e.element.addEventListener("mousemove",F,!1);break;case Re:e.element.addEventListener("mousemove",G,!1);break;case be:M()||(e.element!=window&&e.element.addEventListener("mouseout",K,!1),e.element.addEventListener("mouseup",B,!1));break;case Ye:e.element.addEventListener("wheel",j,!1);break;case Me:e.element.addEventListener("keydown",H,!1);break;case Le:e.element.addEventListener("keyup",Q,!1);break;case ye:e.element.addEventListener("touchstart",z,!1);break;case xe:e.element.addEventListener("touchmove",q,!1);break;case Ue:e.element.addEventListener("touchend",V,!1);break;case De:e.element.addEventListener("deviceorientation",C,!1)}}function x(e,t){switch(e.type){case Ee:if(u.copy(T.k,t),e.webvr_display)t[0]=e.orientation[0],t[1]=e.orientation[1],t[2]=e.orientation[2],t[3]=e.orientation[3];else if(e.webvr_sensor_devices)for(var r=0;r<e.webvr_sensor_devices.length;r++){var a=e.webvr_sensor_devices[r],_=a.getState&&a.getState()||a.getImmediateState&&a.getImmediateState();_.orientation&&(t[0]=_.orientation.x,t[1]=_.orientation.y,t[2]=_.orientation.z,t[3]=_.orientation.w)}return t;default:return ae.error("orientation_quat is undefined for device: ",e.type),t}}function U(e,t){switch(e.type){case Ee:if(u.copy(T.n,t),e.webvr_display)t[0]=e.position[0],t[1]=e.position[1],t[2]=e.position[2];else if(e.webvr_sensor_devices)for(var r=0;r<e.webvr_sensor_devices.length;r++){var a=e.webvr_sensor_devices[r],_=a.getState&&a.getState()||a.getImmediateState&&a.getImmediateState();_.position&&(t[0]=_.position.x,t[1]=-_.position.z,t[2]=_.position.y)}return t;default:return ae.error("position is undefined for device: ",e.type),t}}function w(e,t){if(T._27(e,T.w,t),"orientation"in window)var r=T.T(window.orientation);else if("orientation"in window.screen)var r=T.T(window.screen.orientation.angle);else var r=0;var a=l.setAxisAngle(T.c,r,Ge);return l.multiply(t,a,t),t}function C(e){var t=ke;null===e.alpha||null===e.beta||null===e.gamma?t[0]=t[1]=t[2]=0:(t[0]=T.T(e.alpha),t[1]=T.T(e.beta),t[2]=T.T(e.gamma));for(var r=_(ce,e.currentTarget),a=0;a<r.orientation_angles_cb_list.length;a++){var n=r.orientation_angles_cb_list[a];n&&(u.copy(t,Be),n(Be))}if(r.orientation_quat_cb_list.length)for(var o=w(t,Fe),a=0;a<r.orientation_quat_cb_list.length;a++){var n=r.orientation_quat_cb_list[a];n&&(l.copy(o,Xe),n(Xe))}for(var a=0;a<r.orientation_quat_cb_list.length;a++)r.orientation_quat_cb_list[a]||r.orientation_quat_cb_list.splice(a,1);for(var a=0;a<r.orientation_angles_cb_list.length;a++)r.orientation_angles_cb_list[a]||r.orientation_angles_cb_list.splice(a,1)}function D(e,t){switch(e.type){case le:e.mouse_location[0]=t.clientX,e.mouse_location[1]=t.clientY,e.mouse_which=t.which}}function F(e){if(je){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=_(le,e.currentTarget);D(t,e);for(var r=0;r<t.mouse_location_cb_list.length;r++){var a=t.mouse_location_cb_list[r];a&&(Ke[0]=e.clientX,Ke[1]=e.clientY,a(Ke))}t.prevent_default&&e.preventDefault();for(var r=0;r<t.mouse_location_cb_list.length;r++)t.mouse_location_cb_list[r]||t.mouse_location_cb_list.splice(r,1)}function G(e){if(je){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=_(le,e.currentTarget);D(t,e);for(var r=0;r<t.mouse_location_cb_list.length;r++){var a=t.mouse_location_cb_list[r];if(a){if("number"==typeof e.movementX)var n=e.movementX,o=e.movementY;else if("number"==typeof e.webkitMovementX)var n=e.webkitMovementX,o=e.webkitMovementY;else if("number"==typeof e.mozMovementX)var n=e.mozMovementX,o=e.mozMovementY;else var n=0,o=0;Ke[0]=n,Ke[1]=o,a(Ke)}}t.prevent_default&&e.preventDefault();for(var r=0;r<t.mouse_location_cb_list.length;r++)t.mouse_location_cb_list[r]||t.mouse_location_cb_list.splice(r,1)}function k(e){if(je){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=_(le,e.currentTarget);D(t,e);for(var r=0;r<t.mouse_down_which_cb_list.length;r++){var a=t.mouse_down_which_cb_list[r];a&&a(e.which)}t.prevent_default&&(window.frameElement&&window.frameElement.focus(),e.preventDefault());for(var r=0;r<t.mouse_down_which_cb_list.length;r++)t.mouse_down_which_cb_list[r]||t.mouse_down_which_cb_list.splice(r,1)}function K(e){!te.is_child(e.relatedTarget)&&e.which&&B(e)}function B(e){if(je){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=_(le,e.currentTarget);D(t,e);for(var r=0;r<t.mouse_up_which_cb_list.length;r++){var a=t.mouse_up_which_cb_list[r];a&&a(e.which)}t.prevent_default&&e.preventDefault();for(var r=0;r<t.mouse_up_which_cb_list.length;r++)t.mouse_up_which_cb_list[r]||t.mouse_up_which_cb_list.splice(r,1)}function X(e){var t=0;return e.wheelDelta?t=e.wheelDelta%120==0?e.wheelDelta/120:T._50(e.wheelDelta):e.deltaY&&(t=e.deltaY%3==0?-e.deltaY/3:-T._50(e.deltaY)),T.M(Qe*t,-ze,ze)}function j(e){for(var t=_(le,e.currentTarget),r=0;r<t.mouse_wheel_cb_list.length;r++){var a=t.mouse_wheel_cb_list[r];a&&a(X(e))}t.prevent_default&&e.preventDefault();for(var r=0;r<t.mouse_wheel_cb_list.length;r++)t.mouse_wheel_cb_list[r]||t.mouse_wheel_cb_list.splice(r,1)}function H(e){for(var t=_(Te,e.currentTarget),r=e.ctrlKey||e.altKey||e.metaKey?t.keyboard_down_mod_cb_list:t.keyboard_down_cb_list,a=0;a<r.length;a++){var n=r[a];n?n(e.keyCode):r.splice(a--,1)}t.prevent_default&&e.preventDefault()}function Q(e){for(var t=_(Te,e.currentTarget),r=0;r<t.keyboard_up_cb_list.length;r++){var a=t.keyboard_up_cb_list[r];a&&a(e.keyCode)}t.prevent_default&&e.preventDefault();for(var r=0;r<t.keyboard_up_cb_list.length;r++)t.keyboard_up_cb_list[r]||t.keyboard_up_cb_list.splice(r,1)}function z(e){for(var t=_(ue,e.currentTarget),r=0;r<t.touch_start_cb_list.length;r++){var a=t.touch_start_cb_list[r];a&&a(e.targetTouches)}for(var r=0;r<t.touch_start_cb_list.length;r++)t.touch_start_cb_list[r]||t.touch_start_cb_list.splice(r,1)}function q(e){for(var t=_(ue,e.currentTarget),r=0;r<t.touch_move_cb_list.length;r++){var a=t.touch_move_cb_list[r];a&&a(e.targetTouches)}t.prevent_default&&e.preventDefault();for(var r=0;r<t.touch_move_cb_list.length;r++)t.touch_move_cb_list[r]||t.touch_move_cb_list.splice(r,1)}function V(e){for(var t=_(ue,e.currentTarget),r=0;r<t.touch_end_cb_list.length;r++){var a=t.touch_end_cb_list[r];a&&a(e.targetTouches)}for(var r=0;r<t.touch_end_cb_list.length;r++)t.touch_end_cb_list[r]||t.touch_end_cb_list.splice(r,1)}function W(e){switch(e){case 0:var t=de;break;case 1:var t=fe;break;case 2:var t=Pe;break;case 3:var t=Ae;break;default:var t=de}return t}function J(e,t){return e.gamepad_mapping[t]}function Z(e){var t=e.element,r=function(){document.pointerLockElement===t||document.webkitPointerLockElement===t||document.mozPointerLockElement===t?e.value=1:(e.value=0,document.removeEventListener("pointerlockchange",r,!1),document.removeEventListener("webkitpointerlockchange",r,!1),document.removeEventListener("mozpointerlockchange",r,!1))};document.addEventListener("pointerlockchange",r,!1),document.addEventListener("webkitpointerlockchange",r,!1),document.addEventListener("mozpointerlockchange",r,!1);var a=t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock;"function"===typeof a&&a.apply(t)}function $(){return!!(window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled)}var ee=Object(n.a)(e),te=Object(o.a)(e),re=Object(i.a)(e),ae=Object(c.a)(e),_e=re.defaults,ne=re.hmd_params,oe=E.b(),ie=E.b(),se=s.create(),ce=10,Ee=20,le=30,Te=40,ue=50,de=60,fe=70,Pe=80,Ae=90;t.DEVICE_GYRO=ce,t.DEVICE_HMD=Ee,t.DEVICE_MOUSE=le,t.DEVICE_KEYBOARD=Te,t.DEVICE_TOUCH=ue,t.DEVICE_GAMEPAD0=de,t.DEVICE_GAMEPAD1=fe,t.DEVICE_GAMEPAD2=Pe,t.DEVICE_GAMEPAD3=Ae;var Se=1,pe=2,ve=4,me=8,Oe=16;t.HMD_WEBVR_DESKTOP=pe,t.HMD_WEBVR_MOBILE=ve,t.HMD_NON_WEBVR=Se,t.HMD_WEBVR1=me,t.HMD_WEBVR1_1=Oe;var Ne=0,ge=23,he=40,Re=41,Ie=50,be=60,Ye=70,Le=80,Me=90,ye=100,xe=110,Ue=120,we=130,Ce=140,De=141;t.HMD_WEBVR_TYPE=Ne,t.HMD_ORIENTATION_QUAT=10,t.HMD_POSITION=20,t.HMD_FOV_LEFT=21,t.HMD_FOV_RIGHT=22,t.HMD_EYE_DISTANCE=ge,t.HMD_DISTORTION=24,t.HMD_BASELINE_DIST=25,t.HMD_SCREEN_LENS_DIST=26,t.HMD_SCREEN_WIDTH=27,t.HMD_SCREEN_HEIGHT=28,t.HMD_BEVEL_SIZE=29,t.HMD_PROJ_LEFT=30,t.HMD_PROJ_RIGHT=31,t.MOUSE_LOCATION=he,t.MOUSE_LOCATION_PL=Re,t.MOUSE_DOWN_WHICH=Ie,t.MOUSE_UP_WHICH=be,t.MOUSE_WHEEL=Ye,t.KEYBOARD_UP=Le,t.KEYBOARD_DOWN=Me,t.KEYBOARD_DOWN_MODIFIED=91,t.TOUCH_START=ye,t.TOUCH_MOVE=xe,t.TOUCH_END=Ue,t.GYRO_ORIENTATION_QUAT=we,t.GYRO_ORIENTATION_ANGLES=Ce,t.GMPD_BUTTON_0=300,t.GMPD_BUTTON_1=301,t.GMPD_BUTTON_2=302,t.GMPD_BUTTON_3=303,t.GMPD_BUTTON_4=304,t.GMPD_BUTTON_5=305,t.GMPD_BUTTON_6=306,t.GMPD_BUTTON_7=307,t.GMPD_BUTTON_8=308,t.GMPD_BUTTON_9=309,t.GMPD_BUTTON_10=310,t.GMPD_BUTTON_11=311,t.GMPD_BUTTON_12=312,t.GMPD_BUTTON_13=313,t.GMPD_BUTTON_14=314,t.GMPD_BUTTON_15=315,t.GMPD_BUTTON_16=316,t.GMPD_BUTTON_17=317,t.GMPD_BUTTON_18=318,t.GMPD_BUTTON_19=319,t.GMPD_BUTTON_20=320,t.GMPD_BUTTON_21=321,t.GMPD_BUTTON_22=322,t.GMPD_BUTTON_23=323,t.GMPD_BUTTON_24=324,t.GMPD_BUTTON_25=325,t.GMPD_TRACKPAD_BUTTON=300,t.GMPD_TRIGGER_BUTTON=301,t.GMPD_GRIPS_BUTTON=302,t.GMPD_MENU_BUTTON=303,t.GMPD_AXIS_0=326,t.GMPD_AXIS_1=327,t.GMPD_AXIS_2=328,t.GMPD_AXIS_3=329,t.GMPD_AXIS_4=330,t.GMPD_AXIS_5=331,t.GMPD_AXIS_6=332,t.GMPD_AXIS_7=333,t.GMPD_AXIS_8=334,t.GMPD_AXIS_9=335,t.GMPD_AXIS_10=336,t.GMPD_AXIS_11=337;var Fe=l.create(),Ge=l.create(),ke=u.create(),Ke=new Float32Array(2),Be=u.create(),Xe=l.create(),je="ontouchstart"in document.documentElement,He=[],Qe=100,ze=2e3;t.can_use_device=r,t.init=function(){if("HMD"==_e.stereo||"NONE"==_e.stereo&&_e.is_mobile_device){var e=_(Ee);e&&document.addEventListener("onvrdisplayconnect",function(t){e.webvr_display=t.display,e.registered=!0,e.webvr_display.getFrameData(e.frame_data)})}},t.get_device_by_type_element=_,t.request_register_device=f,t.switch_prevent_default=function(e,t){e.prevent_default=t},t.reset_device=m,t.get_vector_param=function(e,t,r){switch(t){case 10:return x(e,r);case 20:return U(e,r);case 21:return O(e,"left",r);case 22:return O(e,"right",r);case 30:return N(e,"left",r);case 31:return N(e,"right",r);case he:case Re:return r[0]=e.mouse_location[0],r[1]=e.mouse_location[1],r}},t.get_value_param=g,t.set_config=function(e,t,r){switch(e.type){case Ee:if(g(e,Ne)&me)break;switch(t){case 24:e.distortion_coefs[0]=r[0],e.distortion_coefs[1]=r[1];break;case ge:e.inter_lens_dist=r,p(e);break;case 25:e.base_line_dist=r,p(e);break;case 26:e.screen_to_lens_dist=r,p(e);break;case 27:e.width_dist=r,p(e);break;case 28:e.height_dist=r,p(e);break;case 29:e.bevel_size=r,p(e)}break;case de:case fe:case Pe:case Ae:e.gamepad_mapping[t]=r}},t.get_gamepad_btn_value=function(e,t){var r=t-300;return r<e.gamepad_btns.length&&e.gamepad_btns[J(e,r)-300]},t.get_gamepad_axis_value=function(e,t){var r=t-300;return t-326<e.gamepad_axes.length?e.gamepad_axes[J(e,r)-326]:0},t.get_gamepad_position=function(e,t){return t.set(e.position),t},t.get_gamepad_orientation=function(e,t){return t.set(e.orientation),t},t.update=function(e){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],r=0;r<He.length;r++){var a=He[r];switch(a.type){case de:I(a),R(t[0],a);break;case fe:I(a),R(t[1],a);break;case Pe:I(a),R(t[2],a);break;case Ae:I(a),R(t[3],a);break;case Ee:h(a,e)}}},t.attach_param_cb=function(e,t,r){switch(t){case we:e.orientation_quat_cb_list.push(r),t=De;break;case Ce:e.orientation_angles_cb_list.push(r),t=De;break;case Ie:e.mouse_down_which_cb_list.push(r);break;case he:case Re:e.mouse_location_cb_list.push(r);break;case be:e.mouse_up_which_cb_list.push(r);break;case Ye:e.mouse_wheel_cb_list.push(r);break;case Me:e.keyboard_down_cb_list.push(r);break;case 91:e.keyboard_down_mod_cb_list.push(r),t=Me;break;case Le:e.keyboard_up_cb_list.push(r);break;case ye:e.touch_start_cb_list.push(r);break;case xe:e.touch_move_cb_list.push(r);break;case Ue:e.touch_end_cb_list.push(r)}-1==e.registered_event_listeners.indexOf(t)&&(e.registered_event_listeners.push(t),e.registered&&y(e,t))},t.detach_param_cb=function(e,t,r){L(e,t,r,!1)},t.gyro_angles_to_quat=w,t.cleanup=function(){for(var e=0;e<He.length;e++)for(var t=He[e],r=0;r<t.registered_event_listeners.length;r++){var a=t.registered_event_listeners[r];L(t,a,null,!0)}He.length=0},t.get_pressed_gmpd_btn=function(e){for(var t=W(e),r=_(t),a=0;a<r.gamepad_btns.length;a++)if(r.gamepad_btns[a])return a+300;return-1},t.get_moved_gmpd_axis=function(e){for(var t=W(e),r=_(t),a=0;a<r.gamepad_axes.length;a++)if(r.gamepad_prev_axes[a]-r.gamepad_axes[a])return a+326;return-1},t.get_first_gmpd_id=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)if(e[t])return t;return 0},t.get_webvr_display=function(){var e=_(Ee);return e&&e.webvr_display},t.activate_pointerlock=function(e){var t=e.element,r=function(t){e.value||Z(e)};t.addEventListener("mousedown",r,!1)},t.add_click_listener=function(e,t){_e.is_mobile_device?e.addEventListener("touchend",t):e.addEventListener("mouseup",t)},t.remove_click_listener=function(e,t){_e.is_mobile_device?e.removeEventListener("touchend",t):e.removeEventListener("mouseup",t)},t.check_fullscreen=$}var _=r(0),n=r(38),o=r(15),i=r(4),s=r(21),c=r(1),E=r(6),l=r(8),T=r(2),u=r(3),d=r(7),f=Object(_.a)("__input",a);t.a=f},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e);t.get_canvas=r.get_canvas,t.get_canvas_hud=r.get_canvas_hud,t.get_container=r.get_container,t.insert_to_container=function(e,t){if(2!=arguments.length)return void a.error("insert_to_container(): two arguments required");e&&t&&r.insert_to_container(e,t)},t.set_canvas_offsets=function(e,t){return a.error_once("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),r.set_canvas_offsets(e,t)},t.update_canvas_offsets=function(){a.error_once("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),r.update_canvas_offsets()},t.client_to_canvas_coords=function(e,t,a){return a||(a=new Float32Array(2)),r.client_to_canvas_coords(e,t,a)},t.client_to_element_coords=function(e,t,a,_){return _||(_=new Float32Array(2)),r.client_to_element_coords(e,t,a,_)},t.get_coords_target_space=function(e,t,a){return a||(a=new Float32Array(2)),r.get_coords_target_space(e,t,a)},t.force_offsets_updating=function(){a.error_once("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),r.force_offsets_updating()},t.resize=function(e,t,a){r.resize(e,t,a)},t.resize_to_container=function(e){e=e||!1,r.resize_to_container(e)}}var _=r(0),n=r(15),o=r(1),i=Object(_.a)("container",a);t.a=i},function(e,t,r){"use strict";function a(e,t){var r=Object(o.a)(e),a=Object(i.a)(e),_=Object(s.a)(e),d=Object(E.a)(e),f=l.b(),P=u.create(),A=u.create(),S=new Float32Array(4),p=c.create();t.set_translation=function(e,t,n,o){r.is_dynamic(e)?(P[0]=t,P[1]=n,P[2]=o,d.set_translation(e,P),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_rel=function(e,t,n,o){r.is_dynamic(e)?(P[0]=t,P[1]=n,P[2]=o,d.set_translation_rel(e,P),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_v=function(e,t){r.is_dynamic(e)?(d.set_translation(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_rel_v=function(e,t){r.is_dynamic(e)?(d.set_translation_rel(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_obj_rel=function(e,t,n,o,i){if(r.is_dynamic(e)){P[0]=t,P[1]=n,P[2]=o;var s=l.j(i.render.world_tsr,A),c=l.g(i.render.world_tsr,p);T._63(P,1,c,s,P),d.set_translation(e,P),d.update_transform(e),a.sync_transform(e)}else _.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_translation=function(e,t){return t||(t=new Float32Array(3)),d.get_translation(e,t),t},t.get_translation_rel=function(e,t){return t||(t=new Float32Array(3)),d.get_translation_rel(e,t),t},t.set_rotation=function(e,t,n,o,i){r.is_dynamic(e)?(S[0]=t,S[1]=n,S[2]=o,S[3]=i,d.set_rotation(e,S),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_rel=function(e,t,n,o,i){r.is_dynamic(e)?(S[0]=t,S[1]=n,S[2]=o,S[3]=i,d.set_rotation_rel(e,S),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_v=function(e,t){r.is_dynamic(e)?(d.set_rotation(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_rel_v=function(e,t){r.is_dynamic(e)?(d.set_rotation_rel(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation_rel_v=function(e,t){if(r.is_dynamic(e))return d.get_rotation_rel(e,t),t;_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation=function(e,t){return t||(t=new Float32Array(4)),d.get_rotation(e,t),t},t.get_rotation_rel=function(e,t){return t||(t=new Float32Array(4)),d.get_rotation_rel(e,t),t},t.set_rotation_euler=function(e,t,n,o){r.is_dynamic(e)?(P[0]=t,P[1]=n,P[2]=o,d.set_rotation_euler(e,P),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation_euler=function(e,t){return t||(t=new Float32Array(3)),d.get_rotation_euler(e,t),t},t.get_rotation_euler_rel=function(e,t){return t||(t=new Float32Array(3)),d.get_rotation_euler_rel(e,t),t},t.set_rotation_euler_rel=function(e,t,n,o){r.is_dynamic(e)?(P[0]=t,P[1]=n,P[2]=o,d.set_rotation_euler_rel(e,P),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_euler_v=function(e,t){r.is_dynamic(e)?(d.set_rotation_euler(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_euler_rel_v=function(e,t){r.is_dynamic(e)?(d.set_rotation_euler_rel(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_scale=function(e,t){r.is_dynamic(e)?(d.set_scale(e,t),d.update_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_scale_rel=function(e,t){r.is_dynamic(e)?(d.set_scale_rel(e,t),d.update_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_scale=function(e,t){return d.get_scale(e,t)},t.get_scale_rel=function(e,t){return d.get_scale_rel(e,t)},t.empty_reset_transform=function(e){if("EMPTY"!=e.type)return void _.error("Wrong object: "+e.name);for(var t=0;t<e.cons_descends.length;t++)if(!r.is_dynamic(e.cons_descends[t]))return void _.error('Wrong object: "'+e.cons_descends[t].name+'" is not dynamic.');d.set_translation(e,[0,0,0]),d.set_rotation(e,[0,0,0,1]),d.set_scale(e,1),d.update_transform(e),a.sync_transform(e)},t.get_object_size=function(e){return r.is_mesh(e)?d.get_object_size(e):(_.error("Wrong object: "+e.name),0)},t.get_object_center=function(e,t,a){return r.is_mesh(e)?(a||(a=new Float32Array(3)),d.get_object_center(e,t,a)):(_.error("Wrong object: "+e.name),null)},t.move_local=function(e,t,n,o){r.is_dynamic(e)?(d.move_local(e,t,n,o),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_x_local=function(e,t){if(r.is_dynamic(e)){var n=c.setAxisAngle(T.d,t,S);d.rotate_local(e,n),d.update_transform(e),a.sync_transform(e)}else _.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_y_local=function(e,t){if(r.is_dynamic(e)){var n=c.setAxisAngle(T.b,t,S);d.rotate_local(e,n),d.update_transform(e),a.sync_transform(e)}else _.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_z_local=function(e,t){if(r.is_dynamic(e)){var n=c.setAxisAngle(T.f,t,S);d.rotate_local(e,n),d.update_transform(e),a.sync_transform(e)}else _.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_object_bounding_box=function(e){return n.n(e.render.bb_world)},t.set_tsr=function(e,t){r.is_dynamic(e)?(d.set_tsr(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_tsr_rel=function(e,t){r.is_dynamic(e)?(d.set_tsr_rel(e,t),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_tsr=function(e,t){return t||(t=l.b()),d.get_tsr(e,t),t},t.get_tsr_rel=function(e,t){return t||(t=l.b()),d.get_tsr_rel(e,t),t},t.distance=function(e,t){return d.distance(e,t)},t.set_matrix=function(e,t){r.is_dynamic(e)?(l.d(t,f),d.set_tsr(e,f),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_matrix_rel=function(e,t){r.is_dynamic(e)?(l.d(t,f),d.set_tsr_rel(e,f),d.update_transform(e),a.sync_transform(e)):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_matrix=function(e,t){return t||(t=new Float32Array(16)),d.get_tsr(e,f),l.x(f,t),t},t.get_matrix_rel=function(e,t){return t||(t=new Float32Array(16)),d.get_tsr_rel(e,f),l.x(f,t),t}}var _=r(0),n=r(25),o=r(9),i=r(19),s=r(1),c=r(8),E=r(13),l=r(6),T=r(2),u=r(3),d=Object(_.a)("transform",a);t.a=d},function(e,t,r){"use strict";function a(e,t){return t=t||new Float32Array(3),t[0]=e[3],t[1]=e[4],t[2]=e[5],t}function _(e,t){return t=t||new Float32Array(3),Z.copy(e,t)}function n(e,t){Z.copy(t,e)}function o(e,t){Z.normalize(t,$),e[3]=$[0],e[4]=$[1],e[5]=$[2]}function i(e,t,r){return r=r||new Float32Array(3),r[0]=e[0]+e[3]*t,r[1]=e[1]+e[4]*t,r[2]=e[2]+e[5]*t,r}function s(e,t){t[0]=0,t[1]=0,t[2]=0;for(var r=0;r<e.length;r+=3)t[0]+=e[r],t[1]+=e[r+1],t[2]+=e[r+2];return Z.scale(t,3/e.length,t)}function c(e,t,r){for(var a=0;a<r.length;a++)r[a]=0;for(var a=0;a<e.length;a+=3){var _=e[a]-t[0],n=e[a+1]-t[1],o=e[a+2]-t[2];r[0]+=_*_,r[1]+=_*n,r[2]+=_*o,r[4]+=n*n,r[5]+=n*o,r[8]+=o*o}r[3]=r[1],r[6]=r[2],r[7]=r[5];for(var a=0;a<r.length;a++)r[a]*=3/e.length;return r}function E(e,t,r){var a=J.copy(e,ee);if(T(a)<t)return J.identity(r);var _=l(a,te),n=J.transpose(_,re);J.multiply(a,n,ae),J.multiply(_,ae,a);for(var o=J.copy(_,r),i=1;t<=T(a)&&i<_e;)_=l(a,te),n=J.transpose(_,re),J.multiply(a,n,ae),J.multiply(_,ae,a),J.multiply(_,o,o),i++;return o}function l(e,t){for(var r=e[1],a=1,_=2;_<e.length;_++)4!=_&&8!=_&&Math.abs(e[_])>Math.abs(r)&&(r=e[_],a=_);for(var n=Math.floor(a/3),o=a%3,i=.5*Math.atan(2*r/(e[3*n+n]-e[3*o+o])),_=0;_<t.length;_++)t[_]=0==_||4==_||8==_?1:0;return t[o+3*n]=-Math.sin(i),t[n+3*o]=Math.sin(i),t[n+3*n]=Math.cos(i),t[o+3*o]=Math.cos(i),t}function T(e){return Math.sqrt(e[1]*e[1]+e[2]*e[2]+e[5]*e[5])}function u(e,t){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]}function d(e){return{content:[],score_function:e}}function f(e,t){e.content.push(t),P(e,e.content.length-1)}function P(e,t){for(var r=e.content[t];t>0;){var a=(t+1>>1)-1,_=e.content[a];if(!(e.score_function(r)<e.score_function(_)))break;e.content[a]=r,e.content[t]=_,t=a}}function A(e){var t=e.content[0],r=e.content.pop();return e.content.length>0&&(e.content[0]=r,p(e,0)),t}function S(e,t){P(e,e.content.indexOf(t))}function p(e,t){for(var r=e.content.length,a=e.content[t],_=e.score_function(a);;){var n=t+1<<1,o=n-1,i=null;if(o<r){var s=e.content[o],c=e.score_function(s);c<_&&(i=o)}if(n<r){var E=e.content[n];e.score_function(E)<(null===i?_:c)&&(i=n)}if(null===i)break;e.content[t]=e.content[i],e.content[i]=a,t=i}}function v(e,t,r,a){return r*e/a+t}function m(e,t,r,a){return r*(e/=a)*e+t}function O(e,t,r,a){return-r*(e/=a)*(e-2)+t}function N(e,t,r,a){return(e/=a/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t}function g(e,t,r,a){return r*(e/=a)*e*e+t}function h(e,t,r,a){return r*((e=e/a-1)*e*e+1)+t}function R(e,t,r,a){return(e/=a/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t}function I(e,t,r,a){return r*(e/=a)*e*e*e+t}function b(e,t,r,a){return-r*((e=e/a-1)*e*e*e-1)+t}function Y(e,t,r,a){return(e/=a/2)<1?r/2*e*e*e*e+t:-r/2*((e-=2)*e*e*e-2)+t}function L(e,t,r,a){return r*(e/=a)*e*e*e*e+t}function M(e,t,r,a){return r*((e=e/a-1)*e*e*e*e+1)+t}function y(e,t,r,a){return(e/=a/2)<1?r/2*e*e*e*e*e+t:r/2*((e-=2)*e*e*e*e+2)+t}function x(e,t,r,a){return-r*Math.cos(e/a*(Math.PI/2))+r+t}function U(e,t,r,a){return r*Math.sin(e/a*(Math.PI/2))+t}function w(e,t,r,a){return-r/2*(Math.cos(Math.PI*e/a)-1)+t}function C(e,t,r,a){return 0==e?t:r*Math.pow(2,10*(e/a-1))+t}function D(e,t,r,a){return e==a?t+r:r*(1-Math.pow(2,-10*e/a))+t}function F(e,t,r,a){return 0==e?t:e==a?t+r:(e/=a/2)<1?r/2*Math.pow(2,10*(e-1))+t:r/2*(2-Math.pow(2,-10*--e))+t}function G(e,t,r,a){return-r*(Math.sqrt(1-(e/=a)*e)-1)+t}function k(e,t,r,a){return r*Math.sqrt(1-(e=e/a-1)*e)+t}function K(e,t,r,a){return(e/=a/2)<1?-r/2*(Math.sqrt(1-e*e)-1)+t:r/2*(Math.sqrt(1-(e-=2)*e)+1)+t}function B(e,t,r,a){var _=1.70158,n=0,o=r;return 0==e?t:1==(e/=a)?t+r:(n||(n=.3*a),o<Math.abs(r)?(o=r,_=n/4):_=n/(2*Math.PI)*Math.asin(r/o),-o*Math.pow(2,10*(e-=1))*Math.sin((e*a-_)*(2*Math.PI)/n)+t)}function X(e,t,r,a){var _=1.70158,n=0,o=r;return 0==e?t:1==(e/=a)?t+r:(n||(n=.3*a),o<Math.abs(r)?(o=r,_=n/4):_=n/(2*Math.PI)*Math.asin(r/o),o*Math.pow(2,-10*e)*Math.sin((e*a-_)*(2*Math.PI)/n)+r+t)}function j(e,t,r,a){var _=1.70158,n=0,o=r;return 0==e?t:2==(e/=a/2)?t+r:(n||(n=a*(.3*1.5)),o<Math.abs(r)?(o=r,_=n/4):_=n/(2*Math.PI)*Math.asin(r/o),e<1?o*Math.pow(2,10*(e-=1))*Math.sin((e*a-_)*(2*Math.PI)/n)*-.5+t:o*Math.pow(2,-10*(e-=1))*Math.sin((e*a-_)*(2*Math.PI)/n)*.5+r+t)}function H(e,t,r,a,_){return void 0==_&&(_=1.70158),r*(e/=a)*e*((_+1)*e-_)+t}function Q(e,t,r,a,_){return void 0==_&&(_=1.70158),r*((e=e/a-1)*e*((_+1)*e+_)+1)+t}function z(e,t,r,a,_){return void 0==_&&(_=1.70158),(e/=a/2)<1?r/2*(e*e*((1+(_*=1.525))*e-_))+t:r/2*((e-=2)*e*((1+(_*=1.525))*e+_)+2)+t}function q(e,t,r,a){return r-V(a-e,0,r,a)+t}function V(e,t,r,a){return(e/=a)<1/2.75?r*(7.5625*e*e)+t:e<2/2.75?r*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?r*(7.5625*(e-=2.25/2.75)*e+.9375)+t:r*(7.5625*(e-=2.625/2.75)*e+.984375)+t}function W(e,t,r,a){return e<a/2?.5*q(2*e,0,r,a)+t:.5*V(2*e-a,0,r,a)+.5*r+t}t.M=a,t.N=_,t.R=n,t.Q=o,t.f=i,t.g=s,t.e=c,t.L=E,t.P=u,t.a=d,t.c=f,t.b=A,t.d=S,t.O=v,t.x=m,t.H=O,t.t=N,t.k=g,t.E=h,t.q=R,t.y=I,t.I=b,t.u=Y,t.z=L,t.J=M,t.v=y,t.A=x,t.K=U,t.w=w,t.m=C,t.G=D,t.s=F,t.j=G,t.D=k,t.p=K,t.l=B,t.F=X,t.r=j,t.h=H,t.B=Q,t.n=z,t.i=q,t.C=V,t.o=W;var J=r(28),Z=r(3),$=new Float32Array(3),ee=new Float32Array(9),te=new Float32Array(9),re=new Float32Array(9),ae=new Float32Array(9),_e=100},function(e,t,r){"use strict";function a(e,t){function r(e,t){gr[t.id]=null,hr[t.id]=null}function a(e,t,r,a){var _,n;if(e instanceof ArrayBuffer){var o=zt.get_width_height(e,a);_=o.width,n=o.height}else _=e.width,n=e.height;var i;i=_>2048||n>2048?"a00":_>1024||n>1024?"aa0":"0a0",or.log("%cLOAD IMAGE "+_+"x"+n,"color: #"+i,t),-1==t.indexOf(Rr)&&r&&or.warn("image",t,"is not from app root.")}function _(e,t,r,a){if(a==Bt.AT_VIDEO_ELEMENT)var _=e.videoWidth,n=e.videoHeight;else var _=e.images[0].width,n=e.images[0].height;var o;o=_>2048||n>2048?"a00":_>1024||n>1024?"aa0":"0a0",or.log("%cLOAD VIDEO "+_+"x"+n,"color: #"+o,t),-1==t.indexOf(Rr)&&r&&or.warn("video",t,"is not from app root.")}function H(e,t,r,a,_,n){var o=t.filepath;o||Gt.panic("Nothing requested");var i=function(a,n,c,E){if(!a)return c==Bt.AT_JSON_ZIP?(or.warn("Compressed file ",E,"not found or invalid. Trying to load non-compressed",o),void Bt.enqueue([{id:o,type:Bt.AT_JSON,url:o,is_fetch:t.is_preloading}],i,null,s)):void Zt.abort_thread(t);or.log("%cLOAD METADATA","color: #616",E),J(a);for(var l in a)e[l]=a[l];Q(t,e),q(e,t),z(e,t),t.is_preloading&&we(e),_(t,r)},s=function(e){n(t,r,e)};if(Ar.assets_gzip_available)var c=o+".gz",E=Bt.AT_JSON_ZIP;else var c=o,E=Bt.AT_JSON;Bt.enqueue([{id:c,type:E,url:c,is_fetch:t.is_preloading}],i,null,s)}function Q(e,t){e.is_primary&&(Ir=cr.find_main_scene(t.scenes));var r=t.binaries[0].binfile;r?e.binary_name=r:(Zt.skip_stage_by_name(e,"load_binaries"),Zt.skip_stage_by_name(e,"prepare_bindata")),Ar.is_mobile_device||Zt.skip_stage_by_name(e,"mobile_media_start"),Ar.antialiasing&&Ar.smaa||Zt.skip_stage_by_name(e,"load_smaa_textures")}function z(e,t){if(e.b4w_export_warnings)for(var r=0;r<e.b4w_export_warnings.length;r++){var a=e.b4w_export_warnings[r];(t.is_primary&&"PRIMARY"==a.type||"ALL"==a.type)&&or.export_warn(a.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages")}}function q(e,t){if(e.b4w_export_errors)for(var r=0;r<e.b4w_export_errors.length;r++){var a=e.b4w_export_errors[r];(t.is_primary&&"PRIMARY"==a.type||"ALL"==a.type)&&or.export_error(a.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors")}}function V(e,t,r,a,_,n){var o=wt(t.filepath)+t.binary_name;o||Gt.panic("Binary data is missing");var i=function(a,n,c,E){if(!a)return c==Bt.AT_ARRAYBUFFER_ZIP?(or.warn("Compressed file ",E,"not found or invalid. Trying to load non-compressed",o),void Bt.enqueue([{id:o,type:Bt.AT_ARRAYBUFFER,url:o,is_fetch:t.is_preloading}],i,null,s)):void Zt.abort_thread(t);or.log("%cLOAD BINARY","color: #616",E),e.bin_data=a,$(a,e),_(t,r)},s=function(e){n(t,r,e)};if(Ar.assets_gzip_available)var c=o+".gz",E=Bt.AT_ARRAYBUFFER_ZIP;else var c=o,E=Bt.AT_ARRAYBUFFER;Bt.enqueue([{id:c,type:E,url:c,is_fetch:t.is_preloading}],i,null,s)}function W(e,t,r,a,_,n){lr.check_shaders_loaded()&&_(t,r)}function J(e){var t=K._58(e.b4w_format_version);switch(K._70(t,Ar.min_format_version)){case-1:t[0]<Ar.min_format_version[0]?Gt.panic("JSON version is too old relative to B4W engine: "+K._71(t)+", required: "+K._71(Ar.min_format_version)+". Reexport scene with the latest B4W addon to fix it."):or.warn("JSON version is a bit old relative to B4W engine: "+K._71(t)+", required: "+K._71(Ar.min_format_version)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:t[0]>Ar.min_format_version[0]?Gt.panic("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):or.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Ar.loaded_data_version=t}function Z(e,t,r,a,_,n){var o=e.bin_data,i=e.binaries[0],s=e.objects,c=e.meshes,E=e.actions,l=K.K();te(o,i,c,l,Kr),ae(o,i,s,l,Kr),_e(o,i,E,l,Kr),_(t,r)}function $(e,t){var r=ee(e),a=K._58(t.b4w_format_version);r[0]!=a[0]&&Gt.panic("BIN version does not match to JSON version: "+K._71(r)+", required: "+K._71(Ar.min_format_version)+". Couldn't load the scene. Reexport scene to fix it."),r[1]!=a[1]&&or.warn("BIN version does not match to JSON version: "+ +K._71(r)+", required: "+K._71(Ar.min_format_version)+". Some compatibility issues can occur. Reexport scene to fix it.")}function ee(e){return[new Uint32Array(e,4,1)[0],new Uint32Array(e,8,1)[0]]}function te(e,t,r,a,_){for(var n=["indices"],o=["position","texcoord","texcoord2","shade_tangs"],i=["normal","tangent"],s=["group"],c=["color"],E=0;E<r.length;E++)for(var l=r[E].submeshes,T=0;T<l.length;T++){for(var u in l[T]){var d=l[T][u][1];if(-1!=n.indexOf(u)){var f=l[T][u][0]*K.i+t.int+_;l[T][u]=oe(e,f,d,a)}else if(-1!=o.indexOf(u)){var f=l[T][u][0]*K.h+t.float+_;l[T][u]=ne(e,f,d,a)}else if(-1!=i.indexOf(u)){var f=l[T][u][0]*K.l+t.short+_;l[T][u]=ie(e,f,d)}else if(-1!=s.indexOf(u)){var f=l[T][u][0]*K.l+t.ushort+_;l[T][u]=se(e,f,d)}else if(-1!=c.indexOf(u)){var f=l[T][u][0]*K.g+t.uchar+_;l[T][u]=ce(e,f,d)}}if(re(r[E],l[T]),delete l[T].normal,delete l[T].tangent,"texcoord2"in l[T]){var P=new Float32Array(l[T].texcoord.length+l[T].texcoord2.length);P.set(l[T].texcoord),P.set(l[T].texcoord2,l[T].texcoord.length),l[T].texcoord=P,delete l[T].texcoord2}}}function re(e,t){if(e.b4w_shape_keys.length){var r=t.base_length,a=t.normal.length/r/Or,_=t.normal.length/Or;t.tbn=C.d(t.normal.subarray(0,r*Or),t.tangent.subarray(0,r*Nr),C.c(_));for(var n=1;n<a;n++)for(var o=n*r,i=0;i<r;i++){var s=t.normal.subarray(i*Or,(i+1)*Or),c=B.add(t.normal.subarray((o+i)*Or,(o+i+1)*Or),s,Yr),E=C.i(yr);if(t.tangent.length){var l=t.tangent.subarray(i*Nr,(i+1)*Nr),T=X.add(t.tangent.subarray((o+i)*Nr,(o+i+1)*Nr),l,Lr),u=C.d(s,l),d=C.d(c,T);C.l(d,u,E)}else{var f=Y.rotationTo(s,c,Mr);C.o(E,f,0)}C.n(t.tbn,E,o+i)}}else t.tbn=C.d(t.normal,t.tangent)}function ae(e,t,r,a,_){for(var n=0;n<r.length;n++)for(var o=r[n].particle_systems,i=0;i<o.length;i++){var s=o[i],c=s.transforms[0]*K.h+t.float+_,E=s.transforms[1];s.transforms=ne(e,c,E,a)}}function _e(e,t,r,a,_){for(var n=0;n<r.length;n++){var o=r[n],i=o.fcurves,s=o.frame_range,c=s[0],E=s[1],l=Kt.get_approx_curve_length(c,E),T=null;l<0&&(l=0);var u=!1,d=!1;for(var f in i)u|=f.indexOf("rotation_euler")>-1,d|=f.indexOf("rotation_quaternion")>-1;var P=[];for(var f in i)if(u&&d&&f.indexOf("rotation_euler")>-1)delete i[f];else{var A=i[f];for(var S in A){var p=A[S],v=t.float+p.bin_data_pos[0]*K.h+_,m=ne(e,v,p.bin_data_pos[1],a),O=new Float32Array(l);null===T&&(T=new Int8Array(l)),Kt.approximate_curve(p,m,O,T,c,E),p._pierced_points=O}f.indexOf("rotation_euler")>-1&&(Kt.fcurve_replace_euler_by_quat(i[f]),P.push(f))}for(var N=0;N<P.length;N++){var g=P[N];i[g.replace("euler","quaternion")]=i[g],delete i[g]}o._bflags=T}}function ne(e,t,r,a){if(a)var _=new Float32Array(e,t,r);else for(var _=new Float32Array(r),n=new DataView(e),o=0;o<r;o++)_[o]=n.getFloat32(t+o*K.h,!0);return _}function oe(e,t,r,a){if(a)var _=new Uint32Array(e,t,r);else for(var _=new Uint32Array(r),n=new DataView(e),o=0;o<r;o++)_[o]=n.getUint32(t+o*K.i,!0);return _}function ie(e,t,r){for(var a=new Float32Array(r),_=new DataView(e),n=0;n<r;n++)a[n]=_.getInt16(t+n*K.l,!0)/32767;return a}function se(e,t,r){for(var a=new Float32Array(r),_=new DataView(e),n=0;n<r;n++)a[n]=_.getUint16(t+n*K.l,!0)/65535;return a}function ce(e,t,r){for(var a=new Float32Array(r),_=new DataView(e),n=0;n<r;n++)a[n]=_.getUint8(t+n*K.g)/255;return a}function Ee(e){for(var t={},r=e.objects,a=0;a<r.length;a++){var _=r[a];if("MESH"===_.type&&!_.particle_systems.length)for(var n=_.data,o=n.name,i=n.submeshes,s=n.materials,c=0;c<i.length;c++)0!==i[c].base_length||t[o]||(s[c]&&or.warn('material "'+s[c].name+'" is not assigned to any face (object "'+_.name+'").'),t[o]=!0)}}function le(e,t,r,a,_,n){je(e),ir.check_bpy_data(e),we(e),ue(e,t),Ee(e),Tt(e),ut(e.actions,t.id),dt(e),de(e,t),Ne(e),Pe(e,t),Ae(e,t),Se(e),ge(e,t),mr&&or.log("%cDEBUG BPYDATA:","color: #a0a",e),_(t,r)}function Te(e,t,r,a,_,n){for(var o=wt(t.filepath),i=[],s=[],c=0;c<e.speakers.length;c++){var E=e.speakers[c],l=E.sound.uuid;if(-1==s.indexOf(l)){switch(s.push(l),E.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":var T=Bt.AT_AUDIOBUFFER;break;case"BACKGROUND_MUSIC":var T=Bt.AT_AUDIO_ELEMENT}ot(i,l,T,Object(j.b)(o+E.sound.filepath),t.is_preloading)}}var u=function(){_(t,r)};i.length?Bt.enqueue(i,function(){},u):_(t,r)}function ue(e,t){for(var r=wt(t.filepath),a=e.textures,_=Ge(e,t),n=0;n<a.length;n++){var o=a[n];t.is_primary||"SCENE"!=o.b4w_source_type||(o.b4w_source_id="");var i=ur.create_texture_bpy(o,_,e.scenes,t.id,r);o._render=i}}function de(e,t){if(!t.is_primary&&e.scenes.length>1&&(e.scenes=[cr.find_main_scene(e.scenes)],or.warn("loading data contains multiple scenes.","Only the first one will be loaded.")),t.is_primary)var r=Ir;else var r=cr.find_main_scene(e.scenes);if(dr.set_framerate(Ir.fps),e.scenes.length>1){var a=e.scenes.indexOf(Ir);e.scenes.splice(a,1),e.scenes.unshift(Ir)}for(var _=0;_<e.scenes.length;_++){var n=e.scenes[_];if(n._render=cr.create_scene_render(),n._is_main=n==r,n._is_primary_thread=t.is_primary,pr.enabled){if("OFF"==n.b4w_enable_physics||"AUTO"==n.b4w_enable_physics&&!fe(n))continue;(t.is_primary||!nr.scene_has_physics(Ir)&&n==cr.find_main_scene(e))&&nr.init_scene_physics(n)}}}function fe(e){for(var t=ve(e,"ALL"),r=0;r<t.length;r++){if(t[r].b4w_collision)return!0;var a=t[r].data;if(a.materials)for(var _=0;_<a.materials.length;_++){var n=a.materials[_];if(n.physics_settings.use_coll_physics)return!0}}return!1}function Pe(e,t){for(var r=0;r<e.scenes.length;r++){for(var a=e.scenes[r],_=ve(a,"ALL"),n=0;n<_.length;n++){var o=_[n];ar.check_bpy_obj_scene_compatibility(o,a,e)&&(o._scenes||(o._scenes=[]),o._scenes.push(t.is_primary?a:Ir))}Oe(_)}he(e,t);for(var i=Ie(t.id),r=0;r<i.length;r++){var o=i[r];if(!t.is_primary&&o.parent&&Gr.indexOf(o.parent.type)>-1&&(o.parent=""),"MESH"==o.type){var s=ir.apply_mesh_modifiers(o);s&&(e.meshes.push(s),o.data=s)}o._def_action_slots=ar.get_bpy_def_action_slots(o,!1),o._is_dynamic=ar.bpy_obj_is_dynamic(o)}for(var r=0;r<i.length;r++){for(var o=i[r],c=o._is_dynamic,n=0;n<o.lod_levels.length;n++){var E=o.lod_levels[n].object;E&&(c=c||E._is_dynamic)}if(c){o._is_dynamic=!0;for(var n=0;n<o.lod_levels.length;n++){var E=o.lod_levels[n].object;E&&(E._is_dynamic=!0)}}}}function Ae(e,t){for(var r=0;r<e.scenes.length;r++){var a=e.scenes[r],_=a.world;_._scenes||(_._scenes=[]),_._scenes.push(t.is_primary?a:Ir)}for(var n=[],r=0;r<e.worlds.length;r++){var _=e.worlds[r];_._scenes?(_._def_action_slots=ar.get_bpy_def_action_slots(_,!0),_._is_dynamic=ar.bpy_obj_is_dynamic(_)):n.push(_)}for(var r=0;r<n.length;r++){var _=n[r],o=e.worlds.indexOf(_);e.worlds.splice(o,1)}}function Se(e){for(var t=e.node_groups,r=e.materials,a=0;a<t.length;a++){var _=t[a],n=_.node_tree;if(n){var o=[];pe(n,o,!0),n._bsdf_types=o}}for(var a=0;a<r.length;a++){var i=r[a],n=i.node_tree;if(n){var o=[];pe(n,o,!1),n._bsdf_types=o}}}function pe(e,t,r){for(var a=e.nodes,_=0;_<a.length;_++){var n=a[_],o=n.type;if("GROUP"==o&&n.node_group){var i=n.node_group.node_tree;if(!i)continue;if(r)pe(i,t,!0);else for(var s=i._bsdf_types,c=0;c<s.length;c++){var E=s[c];-1==t.indexOf(E)&&t.push(E)}}else-1!=Br.indexOf(o)&&-1==t.indexOf(o)&&t.push(o)}}function ve(e,t){t||(t="ALL");var r=[];return-1==e.objects.indexOf(e.camera)&&e.objects.push(e.camera),me(e.objects,t,r),r}function me(e,t,r){for(var a=0;a<e.length;a++){var _=e[a];"ALL"!=t&&t!=_.type||r.push(_);var n=_.dupli_group;if(n){me(n.objects,t,r)}}}function Oe(e){for(var t=0;t<e.length;t++){var r=e[t];if(r._scenes&&"WORLD"!=r.type)for(var a=r.particle_systems,_=0;_<a.length;_++){var n=a[_].settings;if("HAIR"==n.type)if("OBJECT"==n.render_type){var o=n.dupli_object;o._scenes||(o._scenes=r._scenes.slice())}else if("GROUP"==n.render_type)for(var i=n.dupli_group,s=0;s<i.objects.length;s++){var o=i.objects[s];o._scenes||(o._scenes=r._scenes.slice())}}}}function Ne(e){for(var t=0;t<e.scenes.length;t++){var r=e.scenes[t];if(r.b4w_use_logic_editor){var a=ve(r,"ALL"),_=r.world;ir.assign_logic_nodes_object_params(a,_,r)}}}function ge(e,t){for(var r=0;r<e.scenes.length;r++){var a=e.scenes[r],_=t.is_primary?a:Ir;Boolean(be(t.id,_,"SPEAKER").length)&&!_._sfx&&Er.attach_scene_sfx(_)}}function he(e,t){for(var r=e.scenes,a=[],_=0;_<r.length;_++){Re(r[_].objects,0,t.is_primary,a)}hr[t.id]=[];for(var _=0;_<a.length;_++)for(var n=a[_],o=0;o<n.length;o++)for(var i=n[o],s=0;s<i.length;s++)hr[t.id].push(i[s]);for(var c=e.particles,_=0;_<c.length;_++){var E=c[_].dupli_object;E&&(E._is_hair_dupli=!0,hr[t.id].push(E));var l=c[_].dupli_group;if(l)for(var T=l.objects,o=0;o<T.length;o++)E=T[o],E._is_hair_dupli=!0,hr[t.id].push(E)}for(var u=hr[t.id],_=u.length-1;_>=0;_--)u[_]._scenes||u.splice(_,1)}function Re(e,t,r,a){a[t]=a[t]||[];for(var _=a[t],n=0;n<e.length;n++){var o=e[n],i=Dt(o);_[i]=_[i]||[],(r||-1==Gr.indexOf(o.type))&&-1==_[i].indexOf(o)&&_[i].push(o);var s=o.dupli_group;if(s){Re(s.objects,t+1,r,a)}}}function Ie(e){return hr[e]}function be(e,t,r){for(var a=[],_=Ie(e),n=0;n<_.length;n++){var o=_[n];if(o.type==r||"ALL"==r)for(var i=0;i<o._scenes.length;i++)t==o._scenes[i]&&a.push(o)}return a}function Ye(e,t,r,a,_,n){for(var o=Ie(t.id),i=0;i<o.length;i++){var s=ar.create_object_from_bpy(o[i]);s.render.data_id=t.id}for(var c=e.worlds,i=0;i<c.length;i++)ar.create_object_from_bpy(c[i],!0);for(var E=ar.get_all_objects("ALL",t.id),i=0;i<o.length;i++){var l=o[i],s=l._object;$t.update_object(l,s)}for(var i=0;i<c.length;i++){var T=c[i],u=T._object;$t.update_object(T,u)}t.is_primary&&Le(e,t.id);for(var i=0;i<o.length;i++){var l=o[i],s=l._object;s.is_hair_dupli||(Ht.prepare_object_relations(l,s),ar.update_object_relations(l,s),fr.update_transform(s)),"MESH"==s.type&&ar.generate_mesh_render_boundings(l,s)}At(o),Ue(E),Pt(E),St(E),pt(E),_(t,r)}function Le(e,t){for(var r=0;r<e.scenes.length;r++){for(var a=e.scenes[r],_=ar.get_scene_objs(a,"LAMP",t),n=new Array(_.length),o=0;o<_.length;o++)n[o]=o;n.sort(function(e,t){var r=_[e].light,a=_[t].light;return!a.use_diffuse||!a.use_specular||r.use_diffuse&&r.use_specular?!r.use_diffuse&&(a.use_diffuse||!r.use_specular&&a.use_specular)?1:0:1});for(var o=0;o<n.length;o++){var i=_[n[o]];_r.get_scene_data(i,a).light_index=o}}}function Me(e,t,r,a,_,n){ye(e);for(var o=0;o<e.scenes.length;o++){var i=t.is_primary?e.scenes[o]:Ir,s=t.is_primary?ar.get_scene_objs(i,"LAMP",t.id):ar.get_scene_objs(i,"LAMP",0),c=ar.get_scene_objs(i,"ALL",t.id),E=be(t.id,i,"MESH"),l=be(t.id,i,"EMPTY");t.is_primary&&cr.append_scene(i,c,s,E,l);for(var T=!1,u=0;u<l.length;u++)for(var d=l[u]._object,f=d.scenes_data,P=0;P<f.length;P++){var A=f[P].scene,S=cr.update_force_scene(A,d);i.name==A.name&&(T=T||S)}t.is_primary&&i._render.water_params&&!T&&or.warn('Scene "'+i.name+'" has water but has no wind. Using default settings.');var p=[];cr.set_active(i),Xt.generate_main_batches(i,E,s,p);var v=ar.get_scene_objs(i,"LINE",t.id);Xt.generate_line_batches(i,v);var m=cr.get_graph(i);if(t.is_primary){var O=i._render.sky_params,N=i.world;if(O.render_sky||O.procedural_skydome){var g=N._object;Xt.append_sky_batch_to_world(i,O,g),Xt.create_forked_batches(g,m,i)}cr.generate_auxiliary_batches(i,m);var h=i._render.world_light_set;h&&(h.use_environment_light||h.ngraph_proxy_id)&&Xt.append_cube_sky_batch_to_world(i,N._object)}if(!t.is_primary){var c=ar.get_scene_objs(Ir,"ALL",t.id);cr.update_scene_graph(e.scenes[o],i,c,s,E,l),c=ar.get_scene_objs(Ir,"ALL",ar.DATA_ID_ALL);for(var R=cr.subs_array(i,[Tr.MAIN_PLANE_REFLECT,Tr.MAIN_PLANE_REFLECT_BLEND,Tr.MAIN_CUBE_REFLECT,Tr.MAIN_CUBE_REFLECT_BLEND]),u=0;u<c.length;u++){var d=c[u];if(d.render.data_id!=t.id){switch(d.type){case"MESH":case"LINE":case"WORLD":for(var o=0;o<R.length;o++)cr.add_object_subs_reflect(R[o],d,m,R[o].type==Tr.MAIN_PLANE_REFLECT_BLEND||R[o].type==Tr.MAIN_CUBE_REFLECT_BLEND,i,!0);break;case"LAMP":cr.update_lamp_scene(d,i)}}}}for(var u=0;u<E.length;u++)Xt.create_forked_batches(E[u]._object,m,i);for(var u=0;u<p.length;u++)Xt.create_forked_batches(p[u],m,i),ar.objects_storage_add(p[u]);c=ar.get_scene_objs(i,"ALL",t.id),cr.assign_scene_data_subs(i,c,s);for(var u=0;u<c.length;u++){var d=c[u];d.render.use_shape_keys&&!d.is_boundings_overridden&&ar.update_boundings(d),_r.check_inv_zup_tsr_is_needed(d)&&(d.need_inv_zup_tsr=!0),ar.update_lod_scene(d,i)}}cr.append_scene_vtex(Ir,e.textures,t.id),t.is_primary&&Ir._render.video_textures.length&&(t.has_video_textures=!0),_(t,r)}function ye(e){for(var t=0;t<e.scenes.length;t++){var r=e.scenes[t];r._camera=r.camera._object}}function xe(e,t){for(var r=0;r<e.scenes.length;r++){e.scenes[r].camera=null}}function Ue(e){for(var t=0;t<e.length;t++){var r=e[t];if("MESH"==r.type){var a=r.armobj;if(a){var _=a.render,n=r.render,o=n.bone_skinning_info,i=[];for(var s in o){var c=o[s],E=c.bone_index,l=c.deform_bone_index,T=4*l,u=4*E;i.push(T,u)}_.mesh_to_arm_bone_maps.push(i),_.skinned_renders.push(r.render)}}}}function we(e){var t=e.materials;if(Fe(e.images),(Sr.dds_available&&"dds"==Ar.compress_format||Sr.pvr_available&&"pvr"==Ar.compress_format)&&Ar.use_compression)for(var r=0;r<t.length;r++){for(var a=t[r],_=a.texture_slots,n=0;n<_.length;n++){var o=_[n],i=o.texture;if("IMAGE"==i.type||"ENVIRONMENT_MAP"==i.type){var s=i.image;if(s&&!s._comp_method){var c=!i.b4w_disable_compression&&!o.use_map_normal&&"ENVIRONMENT_MAP"!=i.type&&!i.b4w_shore_dist_map&&"MOVIE"!=s.source;De(s,c)}}}var E=a.node_tree;if(E)for(var l=E.nodes,n=0;n<l.length;n++){var T=l[n],c=!1;if("TEXTURE"==T.type){var u=T.texture;if(u){var s=u.image;s&&!s._comp_method&&(c=!u.b4w_disable_compression&&"MOVIE"!=u.image.source&&"ENVIRONMENT_MAP"!=u.type&&!Ce(T))}}else if("TEX_IMAGE"==T.type){var s=T.image;s&&!s._comp_method&&(c="MOVIE"!=s.source)}else"TEX_ENVIRONMENT"==T.type&&(c=!1);s&&!s._comp_method&&De(s,c)}}}function Ce(e){for(var t=e.outputs,r=0;r<t.length;r++){var a=t[r];if(a.is_linked&&"Normal"==a.identifier)return!0}return!1}function De(e,t){e.filepath.indexOf(".dds")>-1?e._comp_method="dds":t?(e._comp_method=Ar.compress_format,"dds"==Ar.compress_format?e.filepath+=".dds":e.filepath+=".pvr"):e._comp_method=""}function Fe(e){for(var t=0;t<e.length;t++){var r=e[t],a=Boolean("FILE"==r.source&&r.filepath.indexOf(".dds")>-1&&"dds"==Ar.compress_format);r._comp_method=a?"dds":""}}function Ge(e,t){return t.is_primary?e.scenes[0].b4w_anisotropic_filtering:Ir.b4w_anisotropic_filtering}function ke(e,t,r,a,_,n){for(var o=e.groups,i=e.objects,s={},c={},E={},l={},T=0;T<o.length;T++){var u=o[T];s[u.uuid]=u,E[u.uuid]=u}for(var T=0;T<i.length;T++){var d=i[T];c[d.uuid]=d,l[d.uuid]=d}for(var f=e.scenes,T=0;T<f.length;T++){Ke(f[T].objects,null,l,E,null)}for(var P in E)P in s||o.push(E[P]);for(var P in l)P in c||i.push(l[P]);_(t,r)}function Ke(e,t,r,a,_){for(var n=[],o=0;o<e.length;o++){var i=e[o],s=r[i.uuid],c=s.proxy;if(c){t&&-1==n.indexOf(c.uuid)&&n.push(c.uuid);for(var E=r[c.uuid],l=E.constraints,T=0;T<l.length;T++){var u=K.O(l[T]);u.name=u.name+"_CLONE",s.constraints.push(u)}if(!("b4w_proxy_inherit_anim"in s)||s.b4w_proxy_inherit_anim){s.animation_data&&(E.animation_data=K.O(s.animation_data)),E.b4w_use_default_animation=s.b4w_use_default_animation,E.b4w_auto_skel_anim=s.b4w_auto_skel_anim,E.b4w_anim_behavior=s.b4w_anim_behavior,E.b4w_cyclic_animation=s.b4w_cyclic_animation}}}for(var o=0;o<n.length;o++){var d=n[o],f=K._9(e,"uuid",d);f>-1&&e.splice(f,1)}var P={};if(t)for(var o=0;o<e.length;o++){var i=e[o],s=r[i.uuid],A=K.O(s),S="origin_name"in s?s.origin_name:s.name;A.name=_r.gen_dupli_name(t.name,S),A.origin_name=S,A.dg_parent={uuid:t.uuid},Be(A),r[A.uuid]=A,P[i.uuid]=A.uuid,i.uuid=A.uuid,_&&_[s.uuid]&&(A.b4w_cluster_data=_[s.uuid])}for(var o=0;o<e.length;o++){var i=e[o],s=r[i.uuid];if(s.dupli_group){var p=s.dupli_group,v=a[p.uuid],m=K.O(v);m.name=qt.unique_name(v.name+"_CLONE"),Xe(m),a[m.uuid]=m,p.uuid=m.uuid;Ke(m.objects,s,r,a,s.b4w_cluster_data)}}if(t)for(var o=0;o<e.length;o++){var i=e[o],s=r[i.uuid];s.parent&&s.parent.uuid in P?s.parent.uuid=P[s.parent.uuid]:s.parent&&(or.warn("Object's \""+s.name+'" parent is not in dupli group. Disabling parenting.'),s.parent=null);for(var l=s.constraints,T=0;T<l.length;T++){var O=l[T];O.target&&O.target.uuid in P&&(O.target.uuid=P[O.target.uuid])}var N=s.pose;if(N)for(var g=N.bones,T=0;T<g.length;T++){var h=g[T],R=h.constraints;if(R)for(var I=0;I<R.length;I++){var O=R[I];O.target&&O.target.uuid in P&&(O.target.uuid=P[O.target.uuid])}}for(var b=s.modifiers,T=0;T<b.length;T++){var Y=b[T];Y.object&&Y.object.uuid in P&&(Y.object.uuid=P[Y.object.uuid])}var L=s.lod_levels;if(L&&L.length)for(var T=0;T<L.length;T++){var M=L[T];M.object&&M.object.uuid in P&&(M.object.uuid=P[M.object.uuid])}}for(var y in P)br[y]=P[y]}function Be(e){e.uuid=v.a("Object"+e.name)}function Xe(e){e.uuid=v.a("Group"+e.name)}function je(e){var t=e.cameras,r=e.groups,a=e.materials,_=e.meshes,n=e.node_groups,o=e.objects,i=e.particles,s=e.scenes,c=e.speakers,E=e.lamps,l=e.textures,T=e.worlds;n||(or.warn('"node_groups" datablock undefined. reexport main scene.'),n=e.node_groups=[]);for(var u=ze(e),d=0;d<s.length;d++){for(var f=s[d],P=f.objects,A=0;A<P.length;A++)qe(P,A,u);f.camera&&qe(f,"camera",u),f.world&&qe(f,"world",u)}for(var d=0;d<r.length;d++)for(var S=r[d],p=S.objects,A=0;A<p.length;A++)qe(p,A,u);for(var d=0;d<o.length;d++){var v=o[d];v.dupli_group&&qe(v,"dupli_group",u),v.parent&&qe(v,"parent",u),v.dg_parent&&qe(v,"dg_parent",u);var m=v.animation_data;switch(m&&He(m,u),v.type){case"MESH":v.data||Gt.panic("mesh not found for object "+v.name),qe(v,"data",u);for(var O=!1,N=v.modifiers,A=0;A<N.length;A++){var g=N[A];"ARMATURE"==g.type?(O&&or.warn('Object "'+v.name+'" has more than one armature modifiers. Only the first one will be used.'),O=!0,qe(g,"object",u)):"CURVE"==g.type&&qe(g,"object",u)}var h=v.particle_systems;if(h)for(var A=0;A<h.length;A++){var R=h[A];qe(R,"settings",u)}break;case"ARMATURE":qe(v,"data",u);for(var I=v.pose,b=I.bones,Y=v.data,L=Y.bones,A=0;A<b.length;A++){var M=b[A],y=M.bone,x=L[y];M.bone=x;var U=M.constraints;if(U)for(var w=0;w<U.length;w++){var C=U[w];C.target&&qe(C,"target",u)}for(var D=M.parent_recursive,w=0;w<D.length;w++){var F=D[w];D[w]=b[F]}}break;case"LAMP":case"CAMERA":case"SPEAKER":case"CURVE":qe(v,"data",u)}var U=v.constraints;if(U)for(var A=0;A<U.length;A++){var C=U[A];C.target&&qe(C,"target",u)}var G=v.lod_levels;if(G)for(var A=0;A<G.length;A++){var k=G[A];k.object&&qe(k,"object",u)}}for(var d=0;d<_.length;d++)for(var K=_[d],B=K.materials,A=0;A<B.length;A++)qe(B,A,u);for(var d=0;d<a.length;d++){for(var X=a[d],j=X.texture_slots,A=0;A<j.length;A++)qe(j[A],"texture",u);var H=X.node_tree;H&&Qe(H,u)}for(var d=0;d<n.length;d++){var Q=n[d],H=Q.node_tree;H&&Qe(H,u)}for(var d=0;d<l.length;d++){var z=l[d],q=z.type;"IMAGE"!=q&&"ENVIRONMENT_MAP"!=q||qe(z,"image",u)}for(var d=0;d<t.length;d++){var V=t[d];V.dof_object&&qe(V,"dof_object",u)}for(var d=0;d<c.length;d++){var W=c[d];W.sound&&qe(W,"sound",u);var m=W.animation_data;m&&He(m,u)}for(var d=0;d<i.length;d++){for(var J=i[d],j=J.texture_slots,A=0;A<j.length;A++)qe(j[A],"texture",u);J.dupli_group&&qe(J,"dupli_group",u),J.dupli_object&&qe(J,"dupli_object",u)}for(var d=0;d<E.length;d++){var Z=E[d],m=Z.animation_data;m&&He(m,u)}for(var d=0;d<T.length;d++){var $=T[d],j=$.texture_slots;if(j)for(var A=0;A<j.length;A++)qe(j[A],"texture",u);var m=$.animation_data;m&&He(m,u);var H=$.node_tree;H&&Qe(H,u)}}function He(e,t){if(e.action&&qe(e,"action",t),e.nla_tracks)for(var r=0;r<e.nla_tracks.length;r++)for(var a=e.nla_tracks[r],_=0;_<a.strips.length;_++)a.strips[_].action&&qe(a.strips[_],"action",t)}function Qe(e,t){for(var r=e.nodes,a=0;a<r.length;a++){var _=r[a];"TEXTURE"==_.type&&_.texture&&qe(_,"texture",t),"LAMP"==_.type&&_.lamp&&(_.lamp.uuid in br&&(_.lamp.uuid=br[_.lamp.uuid]),t[_.lamp.uuid]||(_.lamp=null)),"GROUP"==_.type&&_.node_group&&qe(_,"node_group",t),"TEX_IMAGE"!=_.type&&"TEX_ENVIRONMENT"!=_.type||!_.image||qe(_,"image",t)}for(var n=e.links,a=0;a<n.length;a++){var o=n[a];Ve(o,"from_node",r),Ve(o,"to_node",r),We(o,"from_socket",o.from_node.outputs),We(o,"to_socket",o.to_node.inputs)}var i=e.animation_data;i&&He(i,t)}function ze(e){for(var t=["actions","armatures","cameras","curves","groups","images","lamps","materials","meshes","node_groups","objects","particles","scenes","sounds","speakers","textures","worlds"],r={},a=0;a<t.length;a++)for(var _=e[t[a]],n=0;n<_.length;n++){var o=_[n];r[o.uuid]=o}return r}function qe(e,t,r){if(e[t]){var a=r[e[t].uuid];a||or.error("Dangling link found:",t,e),e[t]=a}}function Ve(e,t,r){var a=e[t],_=K._19("name",a.name,r);e[t]=_}function We(e,t,r){var a=e[t],_=K._19("identifier",a.identifier,r);e[t]=_}function Je(e,t,r,n,o,i){for(var s=[],c=[],E={},l=e.images,T=ur.get_img_textures(),u=wt(t.filepath),d=0;d<l.length;d++){var f=l[d],P=f.uuid;if(P){var A=Object(j.b)(u+f.filepath),S=Bt.split_extension(A),p=S[1].toLowerCase(),v=f.source;if("FILE"===v){if(f._comp_method)var m=Bt.AT_ARRAYBUFFER;else var m=Bt.AT_IMAGE_ELEMENT;if(!Bt.check_image_extension(p)){or.error('image "'+f.name+'" has unsupported format or broken path.');continue}Sr.min50_available&&Ar.use_min50&&(A=tt(S))}else{if("MOVIE"!==v){or.error('Image "'+f.name+'" has unsupported format "'+v+'".');continue}if(Ar.seq_video_fallback){A=S[0]+".altconv.seq";var m=Bt.AT_SEQ_VIDEO_ELEMENT}else{var O=Er.detect_video_container(p);if(""==O){or.error("failed to load video file (unsupported format)",A);continue}A=O!=p?S[0]+".altconv."+O:S[0]+"."+S[1];var m=Bt.AT_VIDEO_ELEMENT}}P in E||(E[P]=[]);for(var N=0;N<T.length;N++){var g=T[N];(!ur.get_cache_loaded_status(g)&&g.img_comp_method==f._comp_method&&g.img_uuid==P||t.is_preloading)&&E[P].push(g)}f._comp_method&&Ar.assets_gzip_available&&(m=Bt.AT_ARRAYBUFFER_ZIP,A+=".gz"),E[P].length&&s.push({id:P,type:m,url:A,is_fetch:t.is_preloading})}}if(s.length){var h=0,R=function(n,o,l,T){if(n){if(t.is_preloading)var u=l;else{for(var d=E[o],f=0;f<d.length;f++){var P=d[f];if(l==Bt.AT_SEQ_VIDEO_ELEMENT)P.seq_fps=n.fps,ur.update_texture(P,n.images,t.id);else if(ur.update_texture(P,n,t.id),"ENVIRONMENT_MAP"==P.source&&t.is_primary)for(var A=0;A<e.scenes.length;A++)cr.update_world_texture(e.scenes[A]);ur.set_cache_loaded_status(P,!0)}var u=d[0].img_comp_method}l==Bt.AT_VIDEO_ELEMENT||l==Bt.AT_SEQ_VIDEO_ELEMENT?_(n,T,!0,l):a(n,T,!0,u)}else{var S=Ze(o,T,t.is_preloading,E);S&&(or.warn("Trying to load fallback image",S.url),c.push(S))}var p=++h/(s.length+c.length);i(t,r,p)},I=function(){c.length?(Bt.enqueue(c,R,I),c.length=0):(or.log("%cLOADED ALL IMAGES","color: #0a0"),o(t,r))};Bt.enqueue(s,R,I)}else o(t,r)}function Ze(e,t,r,a){var _=$e(t),n=Bt.split_extension(_);if("gz"==n[1])var o=n[0],i=Bt.AT_ARRAYBUFFER;else if("dds"==n[1]||"pvr"==n[1]){var o=n[0],i=Bt.AT_IMAGE_ELEMENT;rt(a[e])}else{if(-1==_.indexOf(".min50"))return null;var o=et(_),i=Bt.AT_IMAGE_ELEMENT}return{id:e,type:i,url:o,is_fetch:r}}function $e(e){return e.split("?v")[0]}function et(e){var t=e.split(".min50");return t[0]+t[1]}function tt(e){if("dds"==e[1]){var t=Bt.split_extension(e[0]);return t[0]+".min50."+t[1]+".dds"}return e[0]+".min50."+e[1]}function rt(e){for(var t=0;t<e.length;t++)e[t].img_comp_method=""}function at(e,t,r,a,_,n){for(var o=cr.get_rendered_scenes(),i=0;i<o.length;i++){var s=o[i];if(s.b4w_use_nla){var c=s.b4w_nla_cyclic;s.b4w_use_logic_editor&&(c=!1),$t.update_scene(s,c,t.id)}}_(t,r)}function _t(e){for(var t=[],r=ur.get_img_textures(),a=0;a<r.length;a++){var _=r[a];_.uri===e&&t.push(_)}return t}function nt(e,t,r,a,_,n){for(var o=wt(t.filepath),i=[],s={},c=ar.get_all_objects("ALL",t.id),E=0;E<c.length;E++){var l=c[E];if(it(l)){var T=l.sfx.uuid;if("BACKGROUND_MUSIC"==Er.get_spk_behavior(l)?(T=K._4(),t.has_background_music=!0):"NONE"!=Er.get_spk_behavior(l)&&Ar.init_wa_context_hack&&(t.init_wa_context=!0),!(T in s)){s[T]=[];var u=Object(j.b)(o+l.sfx.filepath);switch(Er.source_type(l)){case Er.AST_ARRAY_BUFFER:var d=Bt.AT_AUDIOBUFFER;break;case Er.AST_HTML_ELEMENT:var d=Bt.AT_AUDIO_ELEMENT}ot(i,T,d,u,t.is_preloading)}s[T].push(l)}}if(i.length){var f=0,P=function(e,a,_,o){if(e){or.log("%cLOAD SOUND","color: #0aa",o),-1==o.indexOf(Rr)&&or.warn("sound",o,"is not from app root.");for(var c=s[a],E=0;E<c.length;E++)Er.update_spkobj(c[E],e)}var l=++f/i.length;n(t,r,l)},A=function(){or.log("%cLOADED ALL SOUNDS","color: #0aa"),_(t,r)};Bt.enqueue(i,P,A)}else _(t,r)}function ot(e,t,r,a,_){var n=Bt.split_extension(a),o=n[1].toLowerCase(),i=Er.detect_audio_container(o);""!=i?(a=i!=o?n[0]+".altconv."+i:n[0]+"."+n[1],e.push({id:t,type:r,url:a,is_fetch:_})):or.error("failed to load audio file (unsupported format)",a)}function it(e){return _r.is_speaker(e)&&Er.source_type(e)!=Er.AST_NONE}function st(e,t,r){for(var a=ar.get_scene_objs(e,"SPEAKER",t),_=0;_<a.length;_++){var n=a[_];_r.is_speaker(n)&&((Er.is_autoplay(n)||r)&&Er.play_def(n))}}function ct(e,t){for(var r=e._render.video_textures,a=0;a<r.length;a++){var _=r[a]._render;e.b4w_use_nla&&r[a].b4w_nla_video||!r[a].use_auto_refresh||t==_.vtex_data_id&&(ur.reset_video(_),ur.play_video(_))}}function Et(e,t,r,a,_,n){$t.prepare(),_(t,r)}function lt(e,t,r,a,_,n){$t.start(),or.log("%cSTART NLA","color: #0a0"),_(t,r)}function Tt(e){var t=[];e.materials=[];for(var r=e.meshes,a=0;a<r.length;a++){var _=r[a];if(0==_.materials.length){var n=p.b();_.materials.push(n),-1==t.indexOf(n.uuid)&&(t.push(n.uuid),e.materials.push(n))}else for(var o=0;o<_.materials.length;o++){var i=_.materials[o],s=p.c();p.d(i,s),_.materials[o]=s,-1==t.indexOf(s.uuid)&&(t.push(s.uuid),e.materials.push(s))}}}function ut(e,t){for(var r=0;r<e.length;r++){var a=e[r];a._data_id=t,Kt.append_action(a)}}function dt(e){for(var t={lod_parents:[],lod_levels_data:[]},r=e.scenes,a=0;a<r.length;a++)for(var _=r[a],n=r[a].objects,o=0;o<n.length;o++){var i=n[o];ft(_,n,i,null,t)}for(var a=0;a<t.lod_levels_data.length;a++)for(var s=t.lod_levels_data[a],o=0;o<s.old_lods.length;o++){var c=s.old_lods[o],E=s.new_lods[o],l=s.lod_levels[o],T=s.scene_arrays[o],u=s.objs_container_arrays[o];l.object=E;for(var d=0;d<u.length;d++)K.C(u[d],E);vt(c,T)}}function ft(e,t,r,a,_){for(var n=r.lod_levels.length,o=0;o<n;o++){var i=r.lod_levels[o],s=i.object;if(s){var c=_.lod_parents.indexOf(r);if(-1==c){_.lod_parents.push(r);var E={old_lods:[],new_lods:[],lod_levels:[],scene_arrays:[],objs_container_arrays:[]};_.lod_levels_data.push(E)}else var E=_.lod_levels_data[c];var l=E.old_lods.indexOf(s);if(-1!=c&&-1!=l)E.scene_arrays[l].push(e),E.objs_container_arrays[l].push(t);else{var T=K.N(s);T.name=r.name+"_LOD_"+String(o+1),T.b4w_cluster_data=r.b4w_cluster_data,Be(T),T.lod_levels=[],a&&(T.dg_parent=a),E.old_lods.push(s),E.new_lods.push(T),E.lod_levels.push(i),E.scene_arrays.push([e]),E.objs_container_arrays.push([t])}}}var u=r.dupli_group;if(u)for(var d=u.objects,f=0;f<d.length;f++){var P=d[f];ft(e,d,P,r,_)}}function Pt(e){for(var t=-1,r=-1,a=Kt.get_max_bones(),_=0;_<e.length;_++){var n=e[_],o=n.render;if(_r.is_mesh(n)&&o.is_skinning){var i=o.max_bones;i>t&&(t=i),a>=i&&i>r&&(r=i)}}for(var _=0;_<e.length;_++){var n=e[_],o=n.render;_r.is_mesh(n)&&o.is_skinning&&(o.frames_blending=!0,t<a?o.max_bones=t:o.max_bones<=a?o.max_bones=r:(or.warn('too many bones for "'+n.name+'" / '+o.max_bones+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),o.max_bones=t,o.frames_blending=!1),o.frames_blending=o.frames_blending&&!Pr.frames_blending_hack)}}function At(e){for(var t=0;t<e.length;t++){var r=e[t],a=r._object,_=a.render;if(_r.is_mesh(a)||_r.is_empty(a)){var n=r.lod_levels.length;if(n){for(var o=[r],i=[0],s=1/0,c=0;c<n;c++){var E=r.lod_levels[c].object,l=r.lod_levels[c].distance;if(!E){s=l;break}o.push(E),i.push(l)}i.push(s);for(var c=0;c<o.length;c++){var E=o[c],T=E._object,u=T.render;u.is_lod=!0,"DYNAMIC"==_.type&&c>0&&B.subtract(_.bs_world.center,u.bs_world.center,u.main_lod_offset),u.lod_dist_min=i[c],u.lod_dist_max=i[c+1];var d=0==c?0:i[c]-i[c-1],f=i[c+1]-i[c],P=c==o.length-1?1/0:i[c+2]-i[c+1];u.lod_lower_border_range=Math.min(d,f),u.lod_upper_border_range=Math.min(f,P)}}}}}function St(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.is_vehicle){var a=r.vehicle_settings;if("CHASSIS"==a.part){r.vehicle={},r.vehicle.force_max=a.force_max,r.vehicle.brake_max=a.brake_max,r.vehicle.suspension_compression=a.suspension_compression,r.vehicle.suspension_stiffness=a.suspension_stiffness,r.vehicle.suspension_damping=a.suspension_damping,r.vehicle.wheel_friction=a.wheel_friction,r.vehicle.roll_influence=a.roll_influence,r.vehicle.max_suspension_travel_cm=a.max_suspension_travel_cm,r.vehicle.engine_force=0,r.vehicle.brake_force=1,r.vehicle.steering=0,r.vehicle.speed=0,r.vehicle.props=[],r.vehicle.prop_offsets=[],r.vehicle.steering_wheel=null;var _=_r.get_dg_parent(r);if(_)var n=_r.get_dg_objects(_,e);else var n=e;for(var o=0;o<n.length;o++){var i=n[o];if(i.is_vehicle){var s=i.vehicle_settings;if(nr.is_car_wheel(i)&&a.name==s.name){var c=nr.wheel_index(i.vehicle_settings.part);r.vehicle.props[c]=i,r.vehicle.prop_offsets[c]=k.b()}else if(nr.is_vehicle_steering_wheel(i)&&a.name==s.name){r.vehicle.steering_wheel=i,r.vehicle.steering_max=s.steering_max,r.vehicle.steering_ratio=s.steering_ratio,r.vehicle.inverse_control=s.inverse_control;var E=k.p(r.render.world_tsr,k.b()),l=k.q(E,i.render.world_tsr,E);r.vehicle.steering_wheel_tsr=l;var T=new Float32Array([1,0,0]);k.y(T,l,T),r.vehicle.steering_wheel_axis=T}else if(nr.is_vehicle_speedometer(i)&&a.name==s.name){r.vehicle.speedometer=i,r.vehicle.speed_ratio=s.speed_ratio,r.vehicle.max_speed_angle=s.max_speed_angle;var E=k.p(r.render.world_tsr,k.b()),u=k.q(E,i.render.world_tsr,E);r.vehicle.speedometer_tsr=u;var d=new Float32Array([1,0,0]);k.y(d,u,d),r.vehicle.speedometer_axis=d}else if(nr.is_vehicle_tachometer(i)&&a.name==s.name){r.vehicle.tachometer=i,r.vehicle.delta_tach_angle=s.delta_tach_angle;var E=k.p(r.render.world_tsr,k.b()),f=k.q(E,i.render.world_tsr,E);r.vehicle.tachometer_tsr=f;var P=new Float32Array([1,0,0]);k.y(P,f,P),r.vehicle.tachometer_axis=P}}}4!=r.vehicle.props.length&&Gt.panic("Not enough wheels for chassis "+r.name)}else if("HULL"==a.part){r.vehicle={},r.vehicle.props=[],r.vehicle.prop_offsets=[],r.vehicle.force_max=a.force_max,r.vehicle.brake_max=a.brake_max,r.vehicle.floating_factor=a.floating_factor,r.vehicle.water_lin_damp=a.water_lin_damp,r.vehicle.water_rot_damp=a.water_rot_damp,r.vehicle.engine_force=0,r.vehicle.brake_force=1,r.vehicle.steering=0,r.vehicle.speed=0,r.vehicle.steering_wheel=null;var _=_r.get_dg_parent(r);if(_)var A=_r.get_dg_objects(_,e);else var A=e;for(var o=0;o<A.length;o++){var i=A[o];if(i.is_vehicle){var s=i.vehicle_settings;if(nr.is_boat_bob(i)&&a.name==s.name)r.vehicle.props.push(i),r.vehicle.prop_offsets.push(k.b());else if(nr.is_vehicle_steering_wheel(i)&&a.name==s.name){r.vehicle.steering_wheel=i,r.vehicle.steering_max=s.steering_max,r.vehicle.steering_ratio=s.steering_ratio,r.vehicle.inverse_control=s.inverse_control;var E=k.p(r.render.world_tsr,k.b()),l=k.q(E,i.render.world_tsr,E);r.vehicle.steering_wheel_tsr=l;var T=new Float32Array([1,0,0]);k.y(T,l,T),r.vehicle.steering_wheel_axis=T}else if(nr.is_vehicle_speedometer(i)&&a.name==s.name){r.vehicle.speedometer=i,r.vehicle.speed_ratio=s.speed_ratio,r.vehicle.max_speed_angle=s.max_speed_angle;var E=k.p(r.render.world_tsr,k.b()),u=k.q(E,i.render.world_tsr,E);r.vehicle.speedometer_tsr=u;var d=new Float32Array([1,0,0]);k.y(d,u,d),r.vehicle.speedometer_axis=d}else if(nr.is_vehicle_tachometer(i)&&a.name==s.name){r.vehicle.tachometer=i,r.vehicle.delta_tach_angle=s.delta_tach_angle;var E=k.p(r.render.world_tsr,k.b()),f=k.q(E,i.render.world_tsr,E);r.vehicle.tachometer_tsr=f;var P=new Float32Array([1,0,0]);k.y(P,f,P),r.vehicle.tachometer_axis=P}}}}}}}function pt(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.is_floating){var a=r.floating_settings;if("MAIN_BODY"==a.part){r.floater={},r.floater.floating_factor=a.floating_factor,r.floater.water_lin_damp=a.water_lin_damp,r.floater.water_rot_damp=a.water_rot_damp,r.floater.bobs=[];var _=_r.get_dg_parent(r);if(_)var n=_r.get_dg_objects(_,e);else var n=e;for(var o=0;o<n.length;o++){var i=n[o];if(i.is_floating){var s=i.floating_settings;nr.is_floater_bob(i)&&a.name==s.name&&(r.floater.bobs.push(i),i.bob_synchronize_pos=i.floating_settings.synchronize_position)}}}}}}function vt(e,t){for(var r=0;r<t.length;r++){for(var a=t[r].objects,_=0;_<a.length;_++){var n=a[_],o=n.dupli_group;o&&mt(e,o)}var i=a.indexOf(e);i>-1&&a.splice(i,1)}}function mt(e,t){var r=t.objects,a=r.indexOf(e);a>-1&&r.splice(a,1);for(var _=0;_<r.length;_++){t=r[_].dupli_group,t&&mt(e,t)}}function Ot(e,t,r,a,_,n){for(var o=!0,i=0;i<e.scenes.length;i++){var s=e.scenes[i];if(!nr.check_worker_loaded(s)){o=!1;break}}o&&(_(t,r),or.log("%cPHYSICS READY","color: #0a0"))}function Nt(e,t,r,a,_,n){for(var o=0;o<e.scenes.length;o++){var i=e.scenes[o];if(t.is_primary)var s=nr.scene_has_physics(i);else{var s=nr.scene_has_physics(Ir)||nr.scene_has_physics(i);i=Ir}if(pr.enabled&&s)for(var c=0;c<kr.length;c++)for(var E=kr[c],l=ar.get_scene_objs(i,E,t.id),T=0;T<l.length;T++){var u=l[T];u.render.data_id==t.id&&(nr.append_object(u,i),t.load_hidden&&nr.obj_has_physics(u)&&nr.disable_simulation(u))}}_(t,r)}function gt(e,t,r,_,n,o){for(var i={},s=[],c=e.scenes,E=0;E<e.scenes.length;E++){var l=c[E];if(l._render.water_params){var T=l._render.water_params.shoremap_image;if(T&&"FILE"===T.source){var u=T.uuid,d=wt(t.filepath),f=Object(j.b)(d+T.filepath);if(T._comp_method)var P=Bt.AT_ARRAYBUFFER;else var P=Bt.AT_IMAGE_ELEMENT;s.push({id:u,type:P,url:f}),i[u]=T}}}if(s.length){var A=function(e,r,_,n){if(e){a(e,n,!0);for(var o=_t(r),s=0;s<o.length;s++){var E=o[s];ur.update_texture(E,e,t.id)}for(var s=0;s<c.length;s++){var l=c[s];if(l._render.water_params){var u=l._render.water_params.shoremap_image;u===T&&ht(e,T,l)}}}else for(var d=i[r],s=0;s<c.length;s++){var l=c[s],u=l._render.water_params.shoremap_image;u===d&&(l._render.water_params.shoremap_image=null,or.warn("image",u.filepath," was not found. Disabling water shore effects."))}},S=function(){n(t,r)};Bt.enqueue(s,A,S)}else n(t,r)}function ht(e,t,r){var a=document.createElement("canvas"),_=t.size[0],n=t.size[1];a.width=_,a.height=n;var o=a.getContext("2d");o.drawImage(e,0,0);var i=o.getImageData(0,0,_,n),s=i.data,c=new Float32Array(4);c[0]=1/16581375,c[1]=1/65025,c[2]=1/255,c[3]=1;for(var E=_*n,l=new Float32Array(E),T=0;T<E;T++)l[T]=c[1]*s[4*T+2]+c[2]*s[4*T+3];r._render.shore_distances=l}function Rt(e,t,r,_,n,o){for(var i=e.scenes[0],s=[],c=[Tr.SMAA_EDGE_DETECTION,Tr.SMAA_BLENDING_WEIGHT_CALCULATION,Tr.SMAA_NEIGHBORHOOD_BLENDING,Tr.SMAA_RESOLVE],E=0;E<c.length;E++){var l=cr.get_subs(i,c[E]);l&&s.push(l)}if(!s.length)return void n(t,r);var T=[],u=Bt.AT_IMAGE_ELEMENT,d=jt.paths.smaa_search_texture_path;T.push({id:"SEARCH_TEXTURE",type:u,url:d,is_fetch:t.is_preloading});var f=jt.paths.smaa_area_texture_path;T.push({id:"AREA_TEXTURE",type:u,url:f,is_fetch:t.is_preloading});for(var E=0;E<s.length;E++){var P=s[E];if(P.type==Tr.SMAA_BLENDING_WEIGHT_CALCULATION){for(var A=P.slinks_internal,S=0;S<A.length;S++){var p=A[S];if("u_search_tex"==p.to)var v=p.texture;else if("u_area_tex"==p.to)var m=p.texture}break}}if(T.length){var O=function(e,r,_,n){if(e){if(a(e,n,!1),"SEARCH_TEXTURE"==r)var o=v;else var o=m;o.source="IMAGE",ur.update_texture(o,e,t.id),ur.set_filters(o,ur.TF_LINEAR,ur.TF_LINEAR)}},N=function(){n(t,r)};Bt.enqueue(T,O,N)}else n(t,r)}function It(e,t,r,a,_,n){for(var o=0;o<e.scenes.length;o++){var i=e.scenes[o];t.is_primary||(i=Ir);for(var s=ar.get_scene_objs(i,"LAMP",t.id),c=0;c<s.length;c++){var E=s[c];E.render.data_id==t.id&&a.added_objects.push({scene:i,obj:E})}for(var l=ar.get_scene_objs(i,"ALL",t.id),c=0;c<l.length;c++){var T=l[c];"LAMP"!=T.type&&(T.render.data_id==t.id&&(t.load_hidden&&_r.is_mesh(T)&&cr.change_visibility(T,!0),a.added_objects.push({scene:i,obj:T})))}}}function bt(e,t,r,a,_,n){if(t.is_primary){var o=cr.get_main();cr.update_world_texture(o);for(var i=cr.get_rendered_scenes(),s=0;s<i.length;s++){var c=i[s];cr.update_world_texture(c),cr.prepare_rendering(c,o)}cr.set_active(o)}else cr.update_scene_permanent_uniforms(Ir);var E=ar.get_all_objects("ALL",t.id);ar.update_objects_dynamics(E),_(t,r)}function Yt(e,t,r,a,_,n){if(t.is_primary)for(var o=cr.get_rendered_scenes(),i=0;i<o.length;i++)for(var s=o[i],c=ar.get_scene_objs(s,"WORLD",0),E=0;E<c.length;E++){var l=c[E];cr.init_cube_sky_dim(s,l),cr.update_world_texture(s)}_(t,r)}function Lt(e,t,r,a,_,n){if(t.is_primary)for(var o=cr.get_rendered_scenes(),i=0;i<o.length;i++){var s=o[i];s.b4w_use_logic_editor&&er.init_logic(s,t.id)}_(t,r)}function Mt(e,t,r,a,_,n){if(t.is_primary)for(var o=0;o<e.scenes.length;o++)ct(e.scenes[o],t.id),st(e.scenes[o],t.id,!1);else ct(Ir,t.id),st(Ir,t.id,!1);_(t,r)}function yt(e,t,r,a,_,n){xe(e,t),Ar.media_auto_activation&&(t.has_video_textures||t.has_background_music||t.init_wa_context)?Ur||xt(e,_,t,r):_(t,r)}function xt(e,t,r,a){var _=Xr.parentElement;Cr=_.style.zIndex,_.style.zIndex="999",Ur=document.createElement("div"),Ur.style.position="relative",Ur.style.height="88px",Ur.style.width="88px";var n=Math.round(Xr.offsetHeight/2-44),o=Math.round(Xr.offsetWidth/2-44);Ur.style.top=n.toString()+"px",Ur.style.left=o.toString()+"px",Ur.style.backgroundImage="url('"+xr+"')",Ur.style.backgroundSize="88px",wr=document.createElement("div"),wr.style.position="relative",wr.style.height=Xr.offsetHeight.toString()+"px",wr.style.width=Xr.offsetWidth.toString()+"px",wr.style.background="rgba(0, 0, 0, 0.5)",wr.style.zIndex="999",_.appendChild(wr),wr.appendChild(Ur),Fr=function(){if(r.has_video_textures&&(ur.play(),ur.pause(),ur.reset()),r.has_background_music){if(r.is_primary)for(var _=0;_<e.scenes.length;_++)st(e.scenes[_],r.id,!0);else st(Ir,r.id,!0);Er.pause()}r.init_wa_context&&Er.play_empty_sound(),Ut(),t(r,a)},Jt.add_click_listener(Ur,Fr)}function Ut(){if(Ur){var e=Xr.parentElement;e.style.zIndex=Cr,Jt.remove_click_listener(Ur,Fr),wr.removeChild(Ur),e.removeChild(wr),wr=null,Ur=null,Cr=0}}function wt(e){var t=e.split("/").slice(0,-1).join("/");return t&&(t+="/"),t}function Ct(e){Kt.is_animated(e)&&Kt.remove(e),tr.remove_obj_from_cache(e),ar.clear_outline_anim(e),Qt.check_sensor_manifold(e)&&Qt.remove_sensor_manifold(e),nr.obj_has_physics(e)&&nr.remove_object(e),ar.unload_plane_reflections(e),ar.unload_cube_reflections(e),cr.remove_object_bundles(e),_r.is_speaker(e)&&Er.speaker_remove(e),kt.is_anchor(e)&&kt.remove(e)}function Dt(e){var t=Ft(e);return t?1+Dt(t):0}function Ft(e){var t=Kt.get_bpy_armobj(e);return t&&t.parent==e?null:e.parent||t}var Gt=Object(i.a)(e),kt=Object(n.a)(e),Kt=Object(o.a)(e),Bt=Object(s.a)(e),Xt=Object(c.a)(e),jt=Object(E.a)(e),Ht=Object(l.a)(e),Qt=Object(T.a)(e),zt=Object(u.a)(e),qt=Object(P.a)(e),Vt=Object(d.a)(e),Wt=Object(f.a)(e),Jt=Object(A.a)(e),Zt=Object(S.a)(e),$t=Object(m.a)(e),er=Object(O.a)(e),tr=Object(N.a)(e),rr=Object(g.a)(e),ar=Object(h.a)(e),_r=Object(R.a)(e),nr=Object(I.a)(e),or=Object(b.a)(e),ir=Object(L.a)(e),sr=Object(M.a)(e),cr=Object(y.a)(e),Er=Object(x.a)(e),lr=Object(U.a)(e),Tr=Object(w.a)(e),ur=Object(D.a)(e),dr=Object(F.a)(e),fr=Object(G.a)(e),Pr=jt.animation,Ar=jt.defaults,Sr=jt.assets,pr=jt.physics,vr=jt.sfx,mr=!1,Or=3,Nr=4,gr=null,hr=null,Rr="",Ir=null,br={},Yr=new Float32Array(3),Lr=new Float32Array(4),Mr=new Float32Array(4),yr=C.c(),xr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC",Ur=null,wr=null,Cr=0,Dr=!1,Fr=null,Gr=["LAMP"],kr=["MESH","CAMERA","EMPTY"],Kr=12,Br=["BSDF_PRINCIPLED","BSDF_GLOSSY","BSDF_DIFFUSE","BSDF_TRANSPARENT"],Xr=null;t.is_primary_loaded=function(e){return Zt.is_primary_loaded(e)},t.update=function(){Zt.update_scheduler(gr)};var jr=function(){var e=Y.create(),t=B.create();return function(r,a,_,n,o,i){var s=n.added_objects,c=n.obj_counter;if(s.length){var E=s[c].obj,l=s[c].scene,T=_r.get_scene_data(E,l);cr.append_object(l,E),!E.anchor||l._render.anaglyph_use||l._render.sidebyside_use||kt.append(E);var u=++n.obj_counter/s.length;E.render.hide_children&&cr.change_visibility_rec(E,!0);var d=T.cube_refl_subs;if(-1!=E.render.cube_reflection_id&&d){var f=B.copy(E.render.bs_world.center,t);cr.update_cube_reflect_subs(d,f)}var P=E.reflective_objs;if(P.length&&l._render.reflection_params)for(var A=k.j(E.render.world_tsr,t),S=k.g(E.render.world_tsr,e),p=T.plane_refl_subs,v=0;v<p.length;v++)cr.update_plane_reflect_subs(p[v],A,S),_r.update_refl_objects(P,p[v].camera.reflection_plane)}else var u=1;i(a,_,u)}}();t.setup_canvas=function(e){Xr=e},t.update_media_controls=function(e,t){if(Ur){wr.style.height=t.toString()+"px",wr.style.width=e.toString()+"px";var r=Math.round(t/2-44),a=Math.round(e/2-44);Ur.style.top=r.toString()+"px",Ur.style.left=a.toString()+"px"}},t.load=function(e,t,a,_,n){var o={load_main:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:H},duplicate_objects:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:ke},load_binaries:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:V},wait_for_shaders:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:50,primary_only:!0,cb_loop:W},prepare_bindata:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects","load_binaries"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:Z},prepare_bpy_data:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects","prepare_bindata"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:le},process_objects:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["prepare_bpy_data"],is_resource:!1,relative_size:150,primary_only:!1,cb_before:Ye},process_scenes:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["process_objects","wait_for_shaders"],is_resource:!1,relative_size:300,primary_only:!1,cb_before:Me},load_smaa_textures:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],is_resource:!1,relative_size:30,primary_only:!0,cb_before:Rt},load_shoremap:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],is_resource:!1,relative_size:30,primary_only:!0,cb_before:gt},load_images:{priority:Zt.ASYNC_PRIORITY,background_loading:!0,inputs:["process_scenes"],is_resource:!0,relative_size:500,primary_only:!1,cb_before:Je},update_scenes_nla:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["process_scenes","load_images"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:at},wait_physics_workers:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["load_shoremap"],is_resource:!1,relative_size:20,primary_only:!1,cb_loop:Ot},add_physics_objects:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["wait_physics_workers"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Nt},add_objects:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["add_physics_objects"],is_resource:!1,relative_size:600,primary_only:!1,cb_before:It,cb_loop:jr,cb_after:bt,cb_param:{added_objects:[],obj_counter:0}},init_cube_sky_dynamic_props:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["add_objects","load_images"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Yt},init_logic_nodes:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["update_scenes_nla","add_objects"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Lt},load_speakers:{priority:Zt.ASYNC_PRIORITY,background_loading:!0,inputs:["add_objects"],is_resource:!0,relative_size:100,primary_only:!1,cb_before:nt},mobile_media_start:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],is_resource:!0,relative_size:5,primary_only:!1,cb_before:yt,cb_loop:yt},synchronize_media:{priority:Zt.SYNC_PRIORITY,background_loading:!0,inputs:["mobile_media_start"],is_resource:!0,relative_size:50,primary_only:!1,cb_before:Mt},prepare_nla:{priority:Zt.SYNC_PRIORITY,background_loading:!1,inputs:["mobile_media_start"],is_resource:!1,relative_size:5,primary_only:!0,cb_before:Et},start_nla:{priority:Zt.SYNC_PRIORITY,background_loading:!0,inputs:["prepare_nla"],is_resource:!1,relative_size:5,primary_only:!0,cb_before:lt}},i=Zt.get_scheduler();return i||(i=Zt.create_scheduler(),gr={},hr={},br={}),gr[i.threads.length]={},Zt.create_thread(o,e,t,a,r,_||vr.audio_loading_hack,Ar.do_not_load_resources,n,!1)},t.unload=function(e){var t=Zt.get_scheduler();if(!t||!t.threads.length||e&&!Zt.thread_is_finished(t.threads[e]))return void or.error("Unable to unload data!");if(0==e)or.log("%cUNLOAD ALL","color: #00a"),kt.cleanup(),Kt.cleanup(),Er.cleanup(),Xt.cleanup(),cr.cleanup(),Zt.cleanup(),Qt.cleanup(),nr.cleanup(),ar.cleanup(),qt.cleanup(),sr.cleanup(),rr.cleanup(),lr.cleanup(),Wt.cleanup(),Bt.cleanup(),ur.cleanup(),er.cleanup(),tr.cleanup(),Jt.cleanup(),Vt.cleanup(),hr=null,br={},Ir=null,gr=null,Dr=!1;else{or.log("%cUNLOAD DATA "+e,"color: #00a"),Kt.remove_actions(e);for(var r=ar.get_all_objects("ALL",ar.DATA_ID_ALL),a=0;a<r.length;a++){var _=r[a];_r.get_object_data_id(_)!=e&&ar.obj_switch_cleanup_flags(_,!1,!1,!1)}r=ar.get_all_objects("ALL",e);for(var a=r.length-1;a>=0;a--){var _=r[a];Ct(_),ar.remove_object(_)}r=ar.get_all_objects("ALL",ar.DATA_ID_ALL);for(var a=0;a<r.length;a++)ar.obj_switch_cleanup_flags(r[a],!0,!0,!0)}$t.cleanup(e),Ut()},t.prepare_object_unloading=Ct,t.set_debug_resources_root=function(e){Rr=e},t.activate_media=function(){Dr||Ar.media_auto_activation||(ur.play(),ur.pause(),ur.reset(),st(Ir,ar.DATA_ID_ALL,!0),Er.pause(),Ar.init_wa_context_hack&&Er.play_empty_sound(),Dr=!0)},t.reset=function(){Xr=null},t.prefetch=function(e,t,a){var _={load_main:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:H},load_binaries:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:V},load_images:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:Je},preload_sounds:{priority:Zt.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:Te}},n=Zt.get_scheduler();return n||(n=Zt.create_scheduler(),gr={},hr={},br={}),gr[n.threads.length]={},Zt.create_thread(_,e,t,a,r,!1,Ar.do_not_load_resources,!1,!0)},t.unfetch=function(){Bt.clear_cache()}}var _=r(0),n=r(58),o=r(41),i=r(5),s=r(47),c=r(16),E=r(4),l=r(62),T=r(56),u=r(77),d=r(49),f=r(29),P=r(34),A=r(42),S=r(69),p=r(81),v=r(119),m=r(55),O=r(63),N=r(50),g=r(66),h=r(12),R=r(9),I=r(19),b=r(1),Y=r(8),L=r(120),M=r(22),y=r(10),x=r(23),U=r(37),w=r(11),C=r(39),D=r(17),F=r(18),G=r(13),k=r(6),K=r(2),B=r(3),X=r(7),j=r(51),H=Object(_.a)("__data",a);t.a=H},function(e,t,r){"use strict";function a(e,t){function r(){return R.is_built_in_data()?b4w.require(R.paths.built_in_data_module).data:null}function a(){var e={_source_url:null,_parse_response:function(t){switch(e.responseType){case"json":case"text":return t;case"arraybuffer":for(var r=atob(t),a=r.length,_=new Int8Array(a),n=0;n<a;n++)_[n]=r.charCodeAt(n);return _.buffer;default:return t}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(t,r,a){e._source_url=r,e.readyState=1},send:function(){e.status=404,e.readyState=4;var t=r();t&&e._source_url in t&&(e.status=200,t[e._source_url]&&(e.response=e._parse_response(t[e._source_url]))),"[object Function]"==={}.toString.call(e.onreadystatechange)&&e.onreadystatechange()}};return e}function _(e){for(var r=0,a=0;a<e.length;a++){var _=e[a];if(_.state===x&&r++,r>=M.max_requests)break;if(_.state===y)switch(_.state=x,r++,_.type){case t.AT_JSON_ZIP:case t.AT_ARRAYBUFFER:case t.AT_ARRAYBUFFER_ZIP:d(_,"arraybuffer");break;case t.AT_JSON:d(_,"json");break;case t.AT_TEXT:d(_,"text");break;case t.AT_AUDIOBUFFER:f(_);break;case t.AT_IMAGE_ELEMENT:P(_);break;case t.AT_AUDIO_ELEMENT:A(_);break;case t.AT_VIDEO_ELEMENT:S(_);break;case t.AT_SEQ_VIDEO_ELEMENT:p(_);break;default:h.panic("Wrong asset type: "+_.type)}}}function d(e,_){var n=e.url.split("?v=")[0];if(n in G)return void("json"==_?e.asset_cb(l.O(G[n]),e.id,e.type,e.url,e.param):e.asset_cb(G[n],e.id,e.type,e.url,e.param));var o=r();if(o&&e.url in o)var i=new a;else var i=new XMLHttpRequest;var c=null;if("GET"==e.request_method)i.open("GET",e.url,!0);else if("POST"==e.request_method)switch(i.open("POST",e.url,!0),e.type){case t.AT_TEXT:c="text/plain";break;case t.AT_JSON:c="application/json"}if(e.overwrite_header)for(var E in e.overwrite_header)"Content-Type"==E?c=e.overwrite_header[E]:i.setRequestHeader(E,e.overwrite_header[E]);c&&i.setRequestHeader("Content-Type",c),"text"==_?(i.overrideMimeType("text/plain"),i.responseType="text"):"json"==_?(i.overrideMimeType("application/json"),i.responseType="text"):i.responseType=_,i.onreadystatechange=function(){if(e.state!=w&&4==i.readyState){if(200==i.status||0==i.status){var r=i.response;if(!r||"arraybuffer"==_&&0==r.byteLength)b.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param);else{switch(e.type){case t.AT_JSON_ZIP:try{r=s.a(r,{to:"string"})}catch(t){return b.error(t+" (parsing gzipped file "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}case t.AT_JSON:try{r=JSON.parse(r,e.json_reviver)}catch(t){return b.error(t+" (parsing JSON "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}break;case t.AT_ARRAYBUFFER_ZIP:try{r=s.a(r).buffer}catch(t){return b.error(t+" (parsing gzipped file "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}}e.is_fetch&&(e.type==t.AT_JSON||e.type==t.AT_JSON_ZIP?G[n]=l.O(r):G[n]=r),e.asset_cb(r,e.id,e.type,e.url,e.param)}}else b.error(i.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param);e.state=U}},i.addEventListener("progress",function(t){t.lengthComputable&&e.progress_cb(t.loaded/t.total)},!1),i.send(e.post_data)}function f(e){var t=e.url.split("?v=")[0];if(t in B)return e.asset_cb(B[t],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&h.panic("Unsupported request type for audio buffer");var _=r();if(_&&e.url in _)var n=new a;else var n=new XMLHttpRequest;n.open("GET",e.url,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){if(e.state!=w&&4==n.readyState)if(200==n.status||0==n.status){var t=n.response;if(t){var r=function(t){if(e.asset_cb(t,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch){var r=e.url.split("?v=")[0];B[r]=t}},a=function(){b.error("failed to decode "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U};Y.decode_audio_data(t,r,a)}else b.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U}else b.error(n.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U},n.send()}function P(e){var t=e.url.split("?v=")[0];if(t in k)return e.asset_cb(k[t],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&h.panic("Unsupported request type for image element");var a=document.createElement("img");L.allow_cors&&(a.crossOrigin="Anonymous"),a.onload=function(){if(e.state!=w&&(e.asset_cb(a,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch)){var t=e.url.split("?v=")[0];k[t]=a}},a.addEventListener("error",function(){e.state!=w&&(b.error("could not load image: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)},!1);var _=r();if(_&&e.url in _)if(_[e.url]){var n=m(e.url);a.src="data:"+n+";base64,"+_[e.url]}else{if(I.is_ie11()){var o=document.createEvent("CustomEvent");o.initCustomEvent("error",!1,!1,null)}else var o=new CustomEvent("error");a.dispatchEvent(o)}else a.src=e.url}function A(e){var t=e.url.split("?v=")[0];if(t in K)return e.asset_cb(K[t],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&h.panic("Unsupported request type for audio element");var a=document.createElement("audio");L.allow_cors&&(a.crossOrigin="Anonymous"),a.addEventListener("loadeddata",function(){if(e.state!=w&&(e.asset_cb(a,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch)){var t=e.url.split("?v=")[0];K[t]=a}},!1),a.addEventListener("error",function(){e.state!=w&&(b.error("could not load sound: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)},!1),a.addEventListener("stalled",function(){e.state!=w&&(b.error("could not load sound: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)},!1);var _=r();if(_&&e.url in _)if(_[e.url]){var n=O(e.url);a.src="data:"+n+";base64,"+_[e.url],e.state!=w&&(e.asset_cb(a,e.id,e.type,e.url,e.param),e.state=U)}else{if(I.is_ie11()){var o=document.createEvent("CustomEvent");o.initCustomEvent("error",!1,!1,null)}else var o=new CustomEvent("error");a.dispatchEvent(o)}else a.src=e.url,L.is_mobile_device&&a.load();L.mobile_firefox_media_hack&&(a.autoplay=!0,a.pause()),setTimeout(function(){a.some_prop_to_prevent_gc=1},5e3)}function S(e){function t(t){e.state!=w&&(b.error("could not load video: "+e.url,e.param),e.asset_cb(null,e.id,e.type,e.url),e.state=U)}var a=e.url.split("?v=")[0];if(a in k)return e.asset_cb(k[a],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&h.panic("Unsupported request type for video element");var _=document.createElement("video");_.muted=!0,L.allow_cors&&(_.crossOrigin="Anonymous"),_.addEventListener("loadeddata",function(){if(_.removeEventListener("error",t,!1),e.state!=w&&(e.asset_cb(_,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch)){var r=e.url.split("?v=")[0];k[r]=_}},!1),_.addEventListener("error",t,!1);var n=r();if(n&&e.url in n)if(n[e.url]){var o=N(e.url);_.src="data:"+o+";base64,"+n[e.url],e.state!=w&&_.addEventListener("loadeddata",function(){e.asset_cb(_,e.id,e.type,e.url,e.param),e.state=U},!1)}else{if(I.is_ie11()){var i=document.createEvent("CustomEvent");i.initCustomEvent("error",!1,!1,null)}else var i=new CustomEvent("error");_.dispatchEvent(i)}else _.src=e.url,L.is_mobile_device&&_.load();(L.mobile_firefox_media_hack||L.ipad_video_hack)&&(_.autoplay=!0,_.pause()),setTimeout(function(){_.some_prop_to_prevent_gc=1},1e4)}function p(e){function t(t){if(e.asset_cb(t,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch){var r=e.url.split("?v=")[0];k[r]=t}}var _=e.url.split("?v=")[0];if(_ in k)return e.asset_cb(k[_],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&h.panic("Unsupported request type for seq video element");var n=r();if(n&&e.url in n)var o=new a;else var o=new XMLHttpRequest;o.open("GET",e.url,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){if(e.state!=w&&4==o.readyState)if(200==o.status||0==o.status){var r=o.response;r?v(r,t):(b.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)}else b.error(o.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U},o.addEventListener("progress",function(t){t.lengthComputable&&e.progress_cb(t.loaded/t.total)},!1),o.send()}function v(e,t){for(var r=new Int32Array(e),a=new Int8Array(e),_=r[3],n={images:[],blobs:[],fps:r[4]},o=20,i=0;i<_;i++){var s=r[o/4],c=a.subarray(o+4,o+4+s),E=new Blob([c],{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(E),n.images.push(l),n.blobs.push(E),o+=s+8-s%4}l.onload=function(){for(var e=0;e<n.images.length;e++)window.URL.revokeObjectURL(n.images[e].src);delete n.blobs,t(n)}}function m(e){var t=T.a(e),r="image";switch(t.toLowerCase()){case"jpeg":case"jpg":r+="/jpeg";break;case"png":r+="/png"}return r}function O(e){var t=T.a(e),r="audio";switch(t.toLowerCase()){case"ogv":case"ogg":r+="/ogg";break;case"mp3":r+="/mpeg";break;case"m4v":case"mp4":r+="/mp4";break;case"webm":r+="/webm"}return r}function N(e){var t=T.a(e),r="video";switch(t.toLowerCase()){case"ogv":r+="/ogg";break;case"webm":r+="/webm";break;case"m4v":case"mp4":r+="/mp4"}return r}function g(e){for(var t=0,r=!0,a=0;a<e.length;a++){var _=e[a],n=e[t];if(_.pack_index===n.pack_index)_.state!==U&&(r=!1);else{if(r){e[a-1].pack_cb();var o=a-t;e.splice(t,o),a-=o}t=a,r=e[a].state===U}if(a===e.length-1&&r){var i=e[a];e.splice(t),i.pack_cb()}}}var h=Object(n.a)(e),R=Object(o.a)(e),I=Object(i.a)(e),b=Object(c.a)(e),Y=Object(E.a)(e),L=R.defaults,M=R.assets;t.AT_ARRAYBUFFER=10,t.AT_ARRAYBUFFER_ZIP=20,t.AT_JSON=30,t.AT_JSON_ZIP=40,t.AT_TEXT=50,t.AT_AUDIOBUFFER=60,t.AT_IMAGE_ELEMENT=70,t.AT_AUDIO_ELEMENT=80,t.AT_VIDEO_ELEMENT=90,t.AT_SEQ_VIDEO_ELEMENT=100;var y=10,x=20,U=30,w=40,C=[],D=0,F={},G={},k={},K={},B={};t.split_extension=function(e){var t=e.split("."),r=Array(2);return r[0]=t.slice(0,-1).join("."),r[1]=String(t.slice(-1)),r},t.get_text_sync=function(e){if(F[e])return F[e];if(M.prevent_caching)var t=e+"?v="+Object(u.c)();else var t=e;var r=new XMLHttpRequest;if(r.overrideMimeType("text/plain"),r.open("GET",t,!1),r.send(null),200==r.status||0==r.status){var a=r.responseText;if(a.length)return F[e]=a,a;h.panic("Error XHR: responce is empty, GET "+e)}else h.panic("Error XHR: "+r.status+", GET "+e)},t.cleanup=function(){for(var e=0;e<C.length;e++)C[e].state=w;C=[],D=0,F={}},t.enqueue=function(e,t,a,n,o){for(var i=0;i<e.length;i++){var s=e[i],c={id:s.id,type:s.type,url:s.url,is_fetch:s.is_fetch,request_method:s.request_method?s.request_method:"GET",overwrite_header:s.overwrite_header?s.overwrite_header:null,post_data:s.post_data?s.post_data:null,param:s.param?s.param:null,state:y,asset_cb:t||function(){},pack_cb:a||function(){},progress_cb:n||function(){},json_reviver:o||null,pack_index:D};if(M.prevent_caching){var E=r();E&&c.url in E||(c.url+="?v="+Object(u.c)())}C.push(c)}_(C),D++},t.update=function(){_(C),g(C)},t.check_image_extension=function(e){return"png"==e||"jpg"==e||"jpeg"==e||"gif"==e||"bmp"==e||"dds"==e||"pvr"==e},t.clear_cache=function(){G={},k={},K={},B={}}}var _=r(0),n=r(5),o=r(4),i=r(38),s=r(116),c=r(1),E=r(23),l=r(2),T=r(51),u=r(40),d=Object(_.a)("__assets",a);t.a=d},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),E=Object(s.a)(e),l=a.defaults,T=-1,u=-1,d=null,f=[];t.setup_context=function(e){for(var t=["INVALID_ENUM","INVALID_VALUE","INVALID_OPERATION","OUT_OF_MEMORY","INVALID_FRAMEBUFFER_OPERATION","CONTEXT_LOST_WEBGL"],r=0;r<t.length;r++){var a=t[r];a in e&&(f[e[a]]=a)}d=e},t.browser=function(e){switch(e.toLowerCase()){case"chrome":return P("mozilla")&&P("applewebkit")&&P("chrome");case"firefox":return P("mozilla")&&P("gecko")&&P("firefox");case"msie":return P("mozilla")&&P("trident")&&P("msie");case"opera":return P("opera")&&P("presto");case"safari":return P("mozilla")&&P("applewebkit")&&P("safari")&&!P("chrome");default:return!1}};var P=function(e){return navigator.userAgent.toLowerCase().indexOf(e)>-1};t.finite=function(e){if(c._16(e)){for(var t=0;t<e.length;t++)if(!isFinite(e[t]))return!1;return Boolean(e.length)}return!!isFinite(e)},t.gl=function(e){if(l.gl_debug){var t=d.getError();t!=d.NO_ERROR&&(t in f?r.panic("GL Error: "+t+", gl."+f[t]+" ("+e+")"):r.panic("Unknown GL error: "+t+" ("+e+")"))}},t.bound_fb=function(){if(!l.gl_debug&&!l.check_framebuffer_hack)return!0;switch(d.checkFramebufferStatus(d.FRAMEBUFFER)){case d.FRAMEBUFFER_COMPLETE:return!0;case d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return _.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT"),!1;case d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return _.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),!1;case d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return _.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),!1;case d.FRAMEBUFFER_UNSUPPORTED:return _.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED"),!1;case d.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return _.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE"),!1;default:return _.error("FRAMEBUFFER CHECK FAILED"),!1}},t.depth_only_issue=function(){if(-1!=u)return u;var e=d.createFramebuffer();d.bindFramebuffer(d.FRAMEBUFFER,e);var t=E.create_texture(E.TT_DEPTH,!1);E.resize(t,1,1);var r=t.w_texture,a=t.w_target;return d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,a,r,0),d.checkFramebufferStatus(d.FRAMEBUFFER)!=d.FRAMEBUFFER_COMPLETE?(u=!0,_.warn("depth-only issue was found")):u=!1,d.bindFramebuffer(d.FRAMEBUFFER,null),d.deleteFramebuffer(e),u},t.multisample_issue=function(){if(1==l.msaa_samples)return!1;if(-1!=T)return T;var e=d.createRenderbuffer();d.bindRenderbuffer(d.RENDERBUFFER,e),d.renderbufferStorageMultisample(d.RENDERBUFFER,l.msaa_samples,d.RGBA8,1,1);var t=d.getRenderbufferParameter(d.RENDERBUFFER,d.RENDERBUFFER_SAMPLES);return t!=l.msaa_samples?(T=!0,_.warn("multisample issue was found: requested "+l.msaa_samples+", got "+t),d.getError()==d.INVALID_OPERATION&&_.warn("the error from multisample issue detected, ignoring")):T=!1,d.bindRenderbuffer(d.RENDERBUFFER,null),T},t.ff_cubemap_out_of_memory=function(){return!(!P("firefox")||d.getError()!=d.OUT_OF_MEMORY)&&(_.warn("Firefox/old GPUs cubemap issue was found."),!0)},t.reset=function(){d=null}}var _=r(0),n=r(5),o=r(4),i=r(1),s=r(17),c=r(2),E=Object(_.a)("__debug_check",a);t.a=E},function(e,t,r){"use strict";function a(e,t){function r(e){_=e}function a(){return _}t.DV_NONE=0,t.DV_OPAQUE_WIREFRAME=1,t.DV_TRANSPARENT_WIREFRAME=2,t.DV_FRONT_BACK_VIEW=3,t.DV_BOUNDINGS=4,t.DV_CLUSTERS_VIEW=5,t.DV_BATCHES_VIEW=6,t.DV_RENDER_TIME=7;var _=null;t.set_debug_view_subs=r,t.get_debug_view_subs=a,t.cleanup=function(){_=null}}var _=r(0),n=Object(_.a)("__debug_subscene",a);t.a=n},function(e,t,r){"use strict";function a(e,t){function r(e,t){return{name:e,p_type:t,time:0,prev_time:-1,use_world_space:!1,count_factor:1,frame_start:0,frame_end:0,time_length:0,lifetime_frames:0,lifetime:0,cyclic:0,mass:0,nfactor:0,gravity:0,fade_in:0,fade_out:0,wind_factor:0,size:0,alpha_start:0,alpha_end:0,color_ramp_length:0,color_ramp:new Float32Array(16),need_buffers_update:!1,positions:null,positions_cache:null,tbn:null,tbn_cache:null,delay_attrs:null,delay_attrs_masked:null,emitter_tsr_snapshots:null,p_data:null,tilt:0,tilt_rand:0}}function a(e){var t=r(e.name,e.type);return t.time=e.time,t.prev_time=e.prev_time,t.use_world_space=e.use_world_space,t.count_factor=e.count_factor,t.frame_start=e.frame_start,t.frame_end=e.frame_end,t.time_length=e.time_length,t.lifetime_frames=e.lifetime_frames,t.lifetime=e.lifetime,t.cyclic=e.cyclic,t.mass=e.mass,t.nfactor=e.nfactor,t.gravity=e.gravity,t.fade_in=e.fade_in,t.fade_out=e.fade_out,t.wind_factor=e.wind_factor,t.size=e.size,t.alpha_start=e.alpha_start,t.alpha_end=e.alpha_end,t.color_ramp_length=e.color_ramp_length,t.color_ramp.set(e.color_ramp),t.need_buffers_update=e.need_buffers_update,t.positions=d.O(e.positions),t.positions_cache=d.O(e.positions_cache),t.tbn=d.O(e.tbn),t.tbn_cache=d.O(e.tbn_cache),t.delay_attrs=d.O(e.delay_attrs),t.delay_attrs_masked=d.O(e.delay_attrs_masked),t.emitter_tsr_snapshots=d.O(e.emitter_tsr_snapshots),t.p_data=d.O(e.p_data),t.tilt=e.tilt,t.tilt_rand=e.tilt_rand,t}function _(e,t,r,a,_,n){for(var o=e.delay_attrs,i=e.emitter_tsr_snapshots,s=e.time,c=e.prev_time,l=0;l<o.length;l+=4){var T=o[l];s>c&&s>=T&&T>c||s<c&&(T>c||s>=T)?(u.u(a,i,l),u.a(a,D)):u.f(i,l,D);var d=F;d[0]=t[3*l],d[1]=t[3*l+1],d[2]=t[3*l+2],u.D(d,D,d),_[3*l]=d[0],_[3*l+1]=d[1],_[3*l+2]=d[2];var f=E.e(r,l,C);E.m(f,D,f),E.n(n,f,l);for(var P=1;P<4;P++)_[3*(l+P)]=_[3*l],_[3*(l+P)+1]=_[3*l+1],_[3*(l+P)+2]=_[3*l+2],E.n(n,f,l+P)}}function P(e,t){for(var r=0;r<t.length;r++){var a=t[r],n=a.particles_data;if(n&&n.use_world_space&&!a.forked_batch){var o=n.positions_cache,i=n.tbn_cache;_(n,n.positions,n.tbn,e.render.world_tsr,o,i),n.need_buffers_update=!0}}}function A(e){e?(L.srand(e),k=function(){return L.rand()}):k=function(){return Math.random()}}function S(e){for(var t=[],r=0;r<e;r++)t.push(4*r,4*r+2,4*r+1,4*r,4*r+3,4*r+2);return new Uint16Array(t)}function p(e,t,r){switch(t){case"VERT":var a=r.va_frames[0].a_position,_=r.va_frames[0].a_tbn,n=v(e,a),o=m(n,a),i=O(n,_);break;case"FACE":var o=[],i=[],s=[];d._13(0,s);var c=M.geometry_random_points(r,e,!1,s);d._13(0,s);var l=M.geometry_random_points(r,e,!0,s);i=E.c(4*c.length);for(var T=0;T<c.length;T++)o.push(c[T][0],c[T][1],c[T][2]),o.push(c[T][0],c[T][1],c[T][2]),o.push(c[T][0],c[T][1],c[T][2]),o.push(c[T][0],c[T][1],c[T][2]),E.n(i,l[T],4*T),E.n(i,l[T],4*T+1),E.n(i,l[T],4*T+2),E.n(i,l[T],4*T+3);o=new Float32Array(o);break;case"VOLUME":I.panic("Particle emission from volume is not supported");break;default:I.panic("Wrong emit from option")}return[o,i]}function v(e,t){for(var r=t.length/3,a=[],_=0;_<e;_++){var n=Math.round((r-1)*k());a.push(n),a.push(n),a.push(n),a.push(n)}return a}function m(e,t){for(var r=[],a=0;a<e.length;a++)r.push(t[3*e[a]]),r.push(t[3*e[a]+1]),r.push(t[3*e[a]+2]);return new Float32Array(r)}function O(e,t){for(var r=E.c(e.length),a=0;a<e.length;a++){var _=E.e(t,e[a],C);E.n(r,_,a)}return r}function N(e,t,r,a,_){for(var n=[],o=(r-t)/e,i=0;i<e;i++){var s;s=a?o*i+U*o*(.5-k()):o*i,_||(s+=t),n.push(s),n.push(s),n.push(s),n.push(s)}return new Float32Array(n)}function g(e,t,r){for(var a=[],_=t*r,n=0;n<e;n++){var o=_*k();a.push(t-o),a.push(t-o),a.push(t-o),a.push(t-o)}return a}function h(e,t,r){for(var a=[],_=0;_<e;_++){var n=Math.random();a.push(t[4*_],r[4*_],n),a.push(t[4*_+1],r[4*_+1],n),a.push(t[4*_+2],r[4*_+2],n),a.push(t[4*_+3],r[4*_+3],n)}return new Float32Array(a)}function R(e,t,r,a){for(var _=[],n=0;n<e;n++){var o=[k()-.5,k()-.5,k()-.5];switch(f.normalize(o,o),_.push(t*o[0]),_.push(t*o[1]),_.push(t*o[2]),r){case"NONE":_.push(0);break;case"SPIN":case"VELOCITY":_.push(a);break;case"RAND":_.push(2*a*(k()-.5));break;default:I.panic("Undefined velocity factor")}for(var i=_.slice(-4),s=0;s<12;s++)_.push(i[s%4])}return new Float32Array(_)}var I=Object(n.a)(e),b=Object(o.a)(e),Y=Object(i.a)(e),L=Object(s.a)(e),M=Object(c.a)(e),y=Object(l.a)(e),x=Object(T.a)(e),U=10,w=b.defaults,C=E.c(),D=u.b(),F=new Float32Array(3),G=[];t.clone_particles_data=a;var k=function(){I.panic("_rand() undefined")};t.update=function(){for(var e=0;e<G.length;e++)for(var t=G[e],r=t.scenes_data,a=0;a<r.length;a++){var _=r[a],n=_.batches;P(t,n)}},t.obj_has_particles=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)for(var a=t[r].batches,_=0;_<a.length;_++)if(a[_].particles_data)return!0;return!1},t.obj_has_psys=function(e,t){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var _=r[a].batches,n=0;n<_.length;n++){var o=_[n].particles_data;if(o&&o.name==t)return!0}return!1},t.obj_has_anim_particles=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)for(var a=t[r].batches,_=0;_<a.length;_++){var n=a[_].particles_data;if(n&&"EMITTER"==n.p_type)return!0}return!1},t.bpy_obj_has_particles=function(e){return e.particle_systems.length>0},t.bpy_obj_has_anim_particles=function(e){for(var t=0;t<e.particle_systems.length;t++){if("EMITTER"==e.particle_systems[t].settings.type)return!0}return!1},t.has_dynamic_grass_particles=function(e){for(var t=0;t<e.particle_systems.length;t++){var r=e.particle_systems[t].settings;if("HAIR"==r.type&&r.b4w_dynamic_grass)return!0}return!1},t.create_particles_data=function(e,t,a){var _=e.particles_data=r(t.name,t.settings.type);_.frame_start=t.settings.frame_start,_.frame_end=t.settings.frame_end,_.time_length=(_.frame_end-_.frame_start)/x.get_framerate(),_.lifetime_frames=t.settings.lifetime,_.lifetime=_.lifetime_frames/x.get_framerate(),_.cyclic=t.settings.b4w_cyclic?1:0,_.mass=t.settings.mass,_.nfactor=t.settings.normal_factor,_.gravity=9.81*t.settings.effector_weights.gravity,_.fade_in=t.settings.b4w_fade_in/x.get_framerate(),_.fade_out=t.settings.b4w_fade_out/x.get_framerate(),_.wind_factor=t.settings.effector_weights.wind,_.use_world_space="WORLD"==t.settings.b4w_coordinate_system;var n,o,i;if(e.halo_particles){n=a.halo_settings.size;var s=a.halo_settings.hardness;s<30?(o=.5,i=.9):s<40?(o=.1,i=1):s<50?(o=0,i=.8):(o=0,i=.5)}else n=t.settings.particle_size,o=1,i=1;_.size=n,_.alpha_start=o,_.alpha_end=i,a.use_nodes&&"BILLBOARD"==t.settings.render_type&&(Y.set_batch_directive(e,"NODES",1),Y.set_batch_directive(e,"PARTICLE_BATCH",1),e.has_nodes=!0);var c=t.settings.texture_slots;if(c[0]&&c[0].use_map_size&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp&&w.allow_vertex_textures){var E=c[0].texture,l=[];y.calc_color_ramp_data(E.color_ramp,y.PART_COLORRAMP_TEXT_SIZE,l),l=new Uint8Array(l.map(function(e){return d.M(255*e,0,255)}));var T=y.create_color_ramp_texture(l,y.PART_COLORRAMP_TEXT_SIZE);Y.append_texture(e,T,"u_color_ramp_tex",E.name),Y.set_batch_directive(e,"USE_COLOR_RAMP",1)}var u=a.texture_slots,f=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(u[0]&&"STRAND"==u[0].texture_coords&&u[0].texture&&"BLEND"==u[0].texture.type&&u[0].texture.use_color_ramp){for(var P=u[0].texture.color_ramp.elements,A=Math.min(4*P.length,f.length),S=0;S<A;S+=4){var p=P[S/4];f[S]=p.position,f[S+1]=p.color[0],f[S+2]=p.color[1],f[S+3]=p.color[2]}_.color_ramp_length=P.length}_.color_ramp.set(f)},t.generate_emitter_particles_submesh=function(e,t,r,a){var n=e.particles_data,o=a.world_tsr,i=r.settings.count,s=r.settings.frame_start/x.get_framerate(),c=r.settings.frame_end/x.get_framerate(),E=r.settings.lifetime/x.get_framerate(),l=r.settings.lifetime_random,T=r.settings.emit_from,d=r.settings.factor_random;if(r.settings.use_rotations)var f=r.settings.angular_velocity_mode,P=r.settings.angular_velocity_factor;else var f="NONE",P=0;var v=r.settings.b4w_randomize_emission,m=r.settings.b4w_cyclic;n.tilt=r.settings.billboard_tilt,n.tilt_rand=r.settings.billboard_tilt_random,A(r.seed);var O=M.extract_submesh_all_mats(t,["a_position","a_tbn"],null,a),I=p(i,T,O),b=I[0],Y=I[1];n.positions=new Float32Array(b),n.tbn=new Float32Array(Y),n.positions_cache=new Float32Array(b.length),n.tbn_cache=new Float32Array(Y.length);var L=N(i,s,c,v,m);if(n.delay_attrs=new Float32Array(L),n.delay_attrs_masked=new Float32Array(L),n.use_world_space){n.emitter_tsr_snapshots=new Float32Array(L.length*D.length);for(var y=0;y<8*L.length;y++)u.u(o,n.emitter_tsr_snapshots,y);_(n,b,Y,o,b,Y)}var U=M.init_submesh("EMITTER_PARTICLES"),w=M.create_empty_va_frame();w.a_position=b,w.a_tbn=Y,U.va_frames[0]=w,e.draw_mode=M.DM_DYNAMIC_TRIANGLES,U.indices=S(i),U.va_common.a_p_bb_vertex=M.gen_bb_vertices(i),U.base_length=b.length/3;var C=g(i,E,l);return U.va_common.a_p_data=h(i,C,L),U.va_common.a_p_vels=R(i,d,f,P),n.p_data=new Float32Array(U.va_common.a_p_data),U},t.set_time=function(e,t,r){for(var a=e.scenes_data,_=0;_<a.length;_++)for(var n=a[_].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&i.name==t&&!n[o].forked_batch&&(i.prev_time=i.time,i.time=r)}},t.set_size=function(e,t,r){for(var a=e.scenes_data,_=0;_<a.length;_++)for(var n=a[_].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&i.name==t&&(i.size=r)}},t.set_normal_factor=function(e,t,r){for(var a=e.scenes_data,_=0;_<a.length;_++)for(var n=a[_].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&i.name==t&&(i.nfactor=r)}},t.get_normal_factor=function(e,t){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var _=r[a].batches,n=0;n<_.length;n++){var o=_[n].particles_data;if(o&&o.name==t)return o.nfactor}return 0},t.set_factor=function(e,t,r){for(var a=e.scenes_data,_=0;_<a.length;_++)for(var n=a[_].batches,o=0;o<n.length;o++){var i=n[o],s=i.particles_data;if(s&&s.name==t){s.count_factor=r;var c=s.delay_attrs;if(1==r)var E=c;else if(0==r)for(var E=s.delay_attrs_masked,l=0;l<E.length;l+=4)E[l]=1e4,E[l+1]=E[l],E[l+2]=E[l],E[l+3]=E[l];else for(var T=4/r,E=s.delay_attrs_masked,u=0,l=0;l<E.length;l+=4)l>=u?(E[l]=c[l],u+=T):E[l]=1e4,E[l+1]=E[l],E[l+2]=E[l],E[l+3]=E[l];var d=i.bufs_data,f=d.pointers,P=f.a_p_data;if(P){for(var A=s.p_data,l=0;l<A.length;l+=3)A[l+1]=E[Math.round(l/3)];M.update_bufs_data_array(d,"a_p_data",3,A)}}}},t.update_start_pos=function(){var e=u.b();return function(t,r,a,_){var n=t.scenes_data,o=u.v(r,e);o=u.s(a,e),o=u.r(_,e);for(var i=0;i<n.length;i++)for(var s=n[i].batches,c=0;c<s.length;c++){var E=s[c].particles_data;if(E&&E.use_world_space)for(var l=0;l<8*E.delay_attrs.length;l++)u.u(o,E.emitter_tsr_snapshots,l)}}}(),t.update_particles_submesh=function(e,t,r){if(e.va_common.a_tbn=E.c(4*r),E.i(e.va_common.a_tbn),t.part_node_data){for(var a=[],_=0;_<r;_++)a.push(_,_,_,_);e.va_common[t.part_node_data.name]=new Float32Array(a)}},t.update_particles_objs_cache=function(e){-1==G.indexOf(e)&&G.push(e)},t.remove_obj_from_cache=function(e){var t=G.indexOf(e);-1!=t&&G.splice(t,1)},t.cleanup=function(){G.length=0}}var _=r(0),n=r(5),o=r(4),i=r(16),s=r(34),c=r(20),E=r(39),l=r(17),T=r(18),u=r(6),d=r(2),f=r(3),P=Object(_.a)("__particles",a);t.a=P},function(e,t,r){"use strict";function a(e){if(""==e)return".";var t=0==e.indexOf("/")|0;t&&0==e.indexOf("//")&&0!=e.indexOf("///")&&(t=2);for(var r=e.split("/"),a=[],_=0;_<r.length;_++){var n=r[_];""!=n&&"."!=n&&(".."!=n||!t&&!a.length||a.length&&".."==a[a.length-1]?a.push(n):a.length&&a.pop())}r=a,e=r.join("/");for(var _=0;_<t;_++)e="/"+e;return e||"."}function _(e){var t=e.split("://",2);return t.length>1?(t[1]=a(t[1]),t.join("://")):a(e)}function n(e){return/(?:\.([^.]+))?$/.exec(e)[1]}t.b=_,t.a=n},function(e,t,r){"use strict";function a(e,t){function r(e){A.error_deprecated("enable_split_screen","screen.request_split_screen");var t=_.get_device_by_type_element(_.DEVICE_HMD);if(!t)return!1;if(m)return!0;var r=_.get_vector_param(t,_.HMD_FOV_LEFT,p),a=_.get_vector_param(t,_.HMD_FOV_RIGHT,v);u.set_hmd_fov(e,r,a);var n=_.get_value_param(t,g);if(n){var o=S.get_active(),i=P.get_scene_data(e,o),s=i.cameras;u.set_eye_distance(s,n)}var c={};if(c.base_line_factor=.5,c.inter_lens_factor=.5,c.enable_hmd_stereo=!0,_.get_value_param(t,_.HMD_WEBVR_TYPE)&(_.HMD_NON_WEBVR|_.HMD_WEBVR_MOBILE|_.HMD_WEBVR_DESKTOP)&&(c.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],c.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.webvr_hmd_device||(t.base_line_dist&&t.height_dist&&t.bevel_size?c.base_line_factor=(t.base_line_dist-t.bevel_size)/t.height_dist:t.bevel_size||(c.base_line_factor=t.base_line_dist/t.height_dist)),t.inter_lens_dist&&t.width_dist&&!t.webvr_hmd_device&&(c.inter_lens_factor=t.inter_lens_dist/t.width_dist),!O.enabled)){var E=1+t.distortion_coefs[0]+t.distortion_coefs[1];S.multiply_size_mult(E,E)}return S.set_hmd_params(c),f.resize_to_container(!0),_.reset_device(t),m=!0,!0}function a(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=[],r=0;r<e.length;r++)e[r]&&t.push(r);return t}var _=Object(n.a)(e),u=Object(o.a)(e),d=Object(i.a)(e),f=Object(s.a)(e),P=Object(c.a)(e),A=Object(E.a)(e),S=Object(l.a)(e),p=T.create(),v=T.create(),m=!1,O=d.debug_subs,N=d.defaults;t.GMPD_BUTTON_12=_.GMPD_BUTTON_12,t.GMPD_BUTTON_13=_.GMPD_BUTTON_13,t.GMPD_BUTTON_15=_.GMPD_BUTTON_15,t.GMPD_BUTTON_14=_.GMPD_BUTTON_14,t.GMPD_BUTTON_3=_.GMPD_BUTTON_3,t.GMPD_BUTTON_0=_.GMPD_BUTTON_0,t.GMPD_BUTTON_1=_.GMPD_BUTTON_1,t.GMPD_BUTTON_2=_.GMPD_BUTTON_2,t.GMPD_BUTTON_5=_.GMPD_BUTTON_5,t.GMPD_BUTTON_7=_.GMPD_BUTTON_7,t.GMPD_BUTTON_4=_.GMPD_BUTTON_4,t.GMPD_BUTTON_6=_.GMPD_BUTTON_6,t.GMPD_BUTTON_8=_.GMPD_BUTTON_8,t.GMPD_BUTTON_9=_.GMPD_BUTTON_9,t.GMPD_BUTTON_10=_.GMPD_BUTTON_10,t.GMPD_BUTTON_11=_.GMPD_BUTTON_11,t.GMPD_BUTTON_16=_.GMPD_BUTTON_16,t.GMPD_BUTTON_17=_.GMPD_BUTTON_17,t.GMPD_BUTTON_18=_.GMPD_BUTTON_18,t.GMPD_BUTTON_19=_.GMPD_BUTTON_19,t.GMPD_BUTTON_20=_.GMPD_BUTTON_20,t.GMPD_BUTTON_21=_.GMPD_BUTTON_21,t.GMPD_BUTTON_22=_.GMPD_BUTTON_22,t.GMPD_BUTTON_23=_.GMPD_BUTTON_23,t.GMPD_BUTTON_24=_.GMPD_BUTTON_24,t.GMPD_BUTTON_25=_.GMPD_BUTTON_25,t.GMPD_TRACKPAD_BUTTON=_.GMPD_TRACKPAD_BUTTON,t.GMPD_TRIGGER_BUTTON=_.GMPD_TRIGGER_BUTTON,t.GMPD_GRIPS_BUTTON=_.GMPD_GRIPS_BUTTON,t.GMPD_MENU_BUTTON=_.GMPD_MENU_BUTTON,t.GMPD_AXIS_0=_.GMPD_AXIS_0,t.GMPD_AXIS_1=_.GMPD_AXIS_1,t.GMPD_AXIS_2=_.GMPD_AXIS_2,t.GMPD_AXIS_3=_.GMPD_AXIS_3,t.GMPD_AXIS_4=_.GMPD_AXIS_4,t.GMPD_AXIS_5=_.GMPD_AXIS_5,t.GMPD_AXIS_6=_.GMPD_AXIS_6,t.GMPD_AXIS_7=_.GMPD_AXIS_7,t.GMPD_AXIS_8=_.GMPD_AXIS_8,t.GMPD_AXIS_9=_.GMPD_AXIS_9,t.GMPD_AXIS_10=_.GMPD_AXIS_10,t.GMPD_AXIS_11=_.GMPD_AXIS_11,t.HMD_ORIENTATION_QUAT=_.HMD_ORIENTATION_QUAT,t.HMD_POSITION=_.HMD_POSITION,t.HMD_WEBVR_TYPE=_.HMD_WEBVR_TYPE,t.HMD_WEBVR_DESKTOP=_.HMD_WEBVR_DESKTOP,t.HMD_WEBVR_MOBILE=_.HMD_WEBVR_MOBILE,t.HMD_NON_WEBVR=_.HMD_NON_WEBVR,t.HMD_WEBVR1=_.HMD_WEBVR1,t.HMD_WEBVR1_1=_.HMD_WEBVR1_1;var g=_.HMD_EYE_DISTANCE;t.HMD_EYE_DISTANCE=g,t.HMD_DISTORTION=_.HMD_DISTORTION,t.HMD_BASELINE_DIST=_.HMD_BASELINE_DIST,t.HMD_SCREEN_LENS_DIST=_.HMD_SCREEN_LENS_DIST,t.HMD_SCREEN_WIDTH=_.HMD_SCREEN_WIDTH,t.HMD_SCREEN_HEIGHT=_.HMD_SCREEN_HEIGHT,t.HMD_BEVEL_SIZE=_.HMD_BEVEL_SIZE,t.MOUSE_LOCATION=_.MOUSE_LOCATION,t.MOUSE_DOWN_WHICH=_.MOUSE_DOWN_WHICH,t.MOUSE_UP_WHICH=_.MOUSE_UP_WHICH,t.MOUSE_WHEEL=_.MOUSE_WHEEL,t.KEYBOARD_UP=_.KEYBOARD_UP,t.KEYBOARD_DOWN=_.KEYBOARD_DOWN,t.TOUCH_START=_.TOUCH_START,t.TOUCH_MOVE=_.TOUCH_MOVE,t.TOUCH_END=_.TOUCH_END,t.GYRO_ORIENTATION_QUAT=_.GYRO_ORIENTATION_QUAT,t.GYRO_ORIENTATION_ANGLES=_.GYRO_ORIENTATION_ANGLES;var h={};h[_.DEVICE_HMD]=[_.HMD_ORIENTATION_QUAT,_.HMD_POSITION],h[_.DEVICE_MOUSE]=[_.MOUSE_LOCATION];var R={};R[_.DEVICE_HMD]=[_.HMD_WEBVR_TYPE];var I={};I[_.DEVICE_MOUSE]=[_.MOUSE_LOCATION,_.MOUSE_DOWN_WHICH,_.MOUSE_UP_WHICH,_.MOUSE_WHEEL],I[_.DEVICE_KEYBOARD]=[_.KEYBOARD_UP,_.KEYBOARD_DOWN],I[_.DEVICE_TOUCH]=[_.TOUCH_START,_.TOUCH_MOVE,_.TOUCH_END],I[_.DEVICE_GYRO]=[_.GYRO_ORIENTATION_QUAT,_.GYRO_ORIENTATION_ANGLES];var b={};b[_.DEVICE_HMD]=[_.HMD_DISTORTION,_.HMD_EYE_DISTANCE,_.HMD_BASELINE_DIST,_.HMD_SCREEN_LENS_DIST,_.HMD_SCREEN_WIDTH,_.HMD_SCREEN_HEIGHT,_.HMD_BEVEL_SIZE],t.DEVICE_GYRO=_.DEVICE_GYRO,t.DEVICE_HMD=_.DEVICE_HMD,t.DEVICE_MOUSE=_.DEVICE_MOUSE,t.DEVICE_KEYBOARD=_.DEVICE_KEYBOARD,t.DEVICE_TOUCH=_.DEVICE_TOUCH,t.can_use_device=_.can_use_device,t.get_device_by_type_element=_.get_device_by_type_element,t.switch_prevent_default=function(e,t){e&&_.switch_prevent_default(e,t)},t.register_device=function(){A.error_once("input.register_device() deprecated")},t.reset_device=function(e){if(!e||e.type!=_.DEVICE_HMD)return void A.error("reset_device is undefined for device.");_.reset_device(e)},t.get_vector_param=function(e,t,r){return e&&e.type in h&&h[e.type].indexOf(t)>=0?_.get_vector_param(e,t,r):(A.error("device hasn't param: ",t),null)},t.get_value_param=function(e,t){return e&&e.type in R&&R[e.type].indexOf(t)>=0?_.get_value_param(e,t):(A.error("device hasn't param: ",t),null)},t.attach_param_cb=function(e,t,r){if(r=r||null,e&&e.type in I&&I[e.type].indexOf(t)>=0)return _.attach_param_cb(e,t,r);A.error("device hasn't param: ",t)},t.detach_param_cb=function(e,t,r){if(r=r||null,e&&e.type in I&&I[e.type].indexOf(t)>=0)return _.detach_param_cb(e,t,r);A.error("device hasn't param: ",t)},t.set_config=function(e,t,r){if(e&&e.type in b&&b[e.type].indexOf(t)>=0)return _.set_config(e,t,r);A.error("device hasn't config: ",t)},t.request_fullscreen_hmd=function(){if(A.error_deprecated("request_fullscreen_hmd","screen.request_fullscreen_hmd"),S.check_active()){var e=S.get_camera(S.get_active());if(e){r(e);var t=_.get_device_by_type_element(_.DEVICE_HMD);if(t){var a=t.webvr_display;if(a&&!a.isPresenting){if(a.capabilities.canPresent){var n=f.get_canvas();a.requestPresent([{source:n}]).then(function(){if(!N.is_mobile_device){var e=a.getEyeParameters("left"),t=a.getEyeParameters("right");f.resize(2*Math.max(e.renderWidth,t.renderWidth),Math.max(e.renderHeight,t.renderHeight),!1)}},function(){A.error("HMD fullscreen request failed.")})}else A.error("HMD fullscreen request failed.")}}}}},t.enable_split_screen=r,t.disable_split_screen=function(){A.error_deprecated("disable_split_screen","screen.exit_split_screen");var e=_.get_device_by_type_element(_.DEVICE_HMD);if(!m||!e||!e.registered)return!1;var t={};t.enable_hmd_stereo=!1,S.set_hmd_params(t);var r=1/(1+e.distortion_coefs[0]+e.distortion_coefs[1]);return S.multiply_size_mult(r,r),f.resize_to_container(!0),!0},t.set_gamepad_key=function(e,t,r){switch(e){case 0:var a=_.DEVICE_GAMEPAD0;break;case 1:var a=_.DEVICE_GAMEPAD1;break;case 2:var a=_.DEVICE_GAMEPAD2;break;case 3:var a=_.DEVICE_GAMEPAD3;break;default:var a=_.DEVICE_GAMEPAD0}var n=_.get_device_by_type_element(a);_.set_config(n,t,r)},t.get_pressed_gmpd_btn=_.get_pressed_gmpd_btn,t.get_moved_gmpd_axis=_.get_moved_gmpd_axis,t.get_gamepad_position=_.get_gamepad_position,t.get_gamepad_orientation=_.get_gamepad_orientation,t.check_enable_gamepad_indices=a,t.get_vr_controller_id=function(e){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],r=0,a=0;r<4;r++){var _=t[r];if(_&&(""==_.id||"OpenVR Gamepad"==_.id||"Oculus Touch (Left)"==_.id||"Oculus Touch (Right)"==_.id)){if(a==e)return a;a++}}return e},t.add_click_listener=function(e,t){e&&t&&_.add_click_listener(e,t)},t.remove_click_listener=function(e,t){e&&t&&_.remove_click_listener(e,t)}}var _=r(0),n=r(42),o=r(14),i=r(4),s=r(15),c=r(9),E=r(1),l=r(10),T=r(7),u=Object(_.a)("input",a);t.a=u},function(e,t,r){"use strict";function a(e,t){function r(e,t,r){function a(){document.fullscreenElement===e||document.webkitFullscreenElement===e||document.mozFullScreenElement===e||document.webkitIsFullScreen||document.msFullscreenElement===e?t():(document.removeEventListener("fullscreenchange",a,!1),document.removeEventListener("webkitfullscreenchange",a,!1),document.removeEventListener("mozfullscreenchange",a,!1),document.removeEventListener("MSFullscreenChange",a,!1),r())}e=e||A.get_container(),t=t||function(){},r=r||function(){},document.addEventListener("fullscreenchange",a,!1),document.addEventListener("webkitfullscreenchange",a,!1),document.addEventListener("mozfullscreenchange",a,!1),document.addEventListener("MSFullscreenChange",a,!1),e.requestFullScreen=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen,e.requestFullScreen?e.requestFullScreen():N.error("B4W App: request fullscreen method is not supported")}function a(){var e=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof e&&N.error("B4W App: exit fullscreen method is not supported"),e.apply(document)}function _(e,t){var r=v.get_device_by_type_element(v.DEVICE_HMD);if(!r)return!1;if(I)return!0;if(b=t,g.check_active()){var a=g.get_camera(g.get_active());a&&(r.registered?(f(a),e&&e()):(v.request_register_device(r),r.registered_cb=function(){f(a),e&&e()}))}}function f(e){var t=v.get_device_by_type_element(v.DEVICE_HMD);if(!t)return!1;if(I)return!0;var r=v.get_value_param(t,v.HMD_WEBVR_TYPE);if(r&v.HMD_WEBVR1_1){var a=t.webvr_display,_=a.getEyeParameters("left"),n=a.getEyeParameters("right");A.resize(2*Math.max(_.renderWidth,n.renderWidth),Math.max(_.renderHeight,n.renderHeight),!1)}else{var o=A.get_canvas(),i=Math.max(2*o.height,o.width),s=i/2;A.resize(i,s,!1)}var c=v.get_vector_param(t,v.HMD_FOV_LEFT,h),E=v.get_vector_param(t,v.HMD_FOV_RIGHT,R);P.set_hmd_fov(e,c,E,!Boolean(r&v.HMD_WEBVR1_1));var l={};l.base_line_factor=.5,l.inter_lens_factor=.5,l.enable_hmd_stereo=!0,r&(v.HMD_NON_WEBVR|v.HMD_WEBVR_MOBILE|v.HMD_WEBVR_DESKTOP)&&(l.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],l.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.webvr_hmd_device||(t.base_line_dist&&t.height_dist&&t.bevel_size?l.base_line_factor=(t.base_line_dist-t.bevel_size)/t.height_dist:t.bevel_size||(l.base_line_factor=t.base_line_dist/t.height_dist)),t.inter_lens_dist&&t.width_dist&&!t.webvr_hmd_device&&(l.inter_lens_factor=t.inter_lens_dist/t.width_dist)),L.enabled||g.multiply_size_mult(.5,1),g.set_hmd_params(l);var T=v.get_value_param(t,v.HMD_EYE_DISTANCE);if(T){var u=g.get_active(),d=O.get_scene_data(e,u),f=d.cameras;P.set_eye_distance(f,T)}return g.render_both_eyes(),I=!0,!0}var P=Object(n.a)(e),A=Object(o.a)(e),S=Object(i.a)(e),p=Object(s.a)(e),v=Object(c.a)(e),m=Object(E.a)(e),O=Object(l.a)(e),N=Object(T.a)(e),g=Object(u.a)(e),h=d.create(),R=d.create(),I=!1,b=function(){},Y=function(){},L=S.debug_subs;t.draw_mixer_strip=p.draw_mixer_strip,t.plot_array=p.plot_array,t.request_fullscreen=r,t.exit_fullscreen=a,t.check_fullscreen=v.check_fullscreen,t.request_fullscreen_hmd=function(e,t,a){if("HMD"!=!S.get("stereo")||"NONE"==S.get("stereo")&&S.get("is_mobile_device")){var _=v.get_device_by_type_element(v.DEVICE_HMD);if(_&&v.get_value_param(_,v.HMD_WEBVR_TYPE)&v.HMD_WEBVR1){var n=_.webvr_display;if(n&&!n.isPresenting){t=t||function(){},a=a||function(){},Y=function(){n.isPresenting?t():(window.removeEventListener("vrdisplaypresentchange",Y),a())},window.addEventListener("vrdisplaypresentchange",Y,!1);if(n.capabilities.canPresent){var o=A.get_canvas();n.requestPresent([{source:o}]).then(function(){},function(){N.error("HMD fullscreen request failed.")})}else N.error("HMD fullscreen request failed.")}}else r(e,t,a)}},t.exit_fullscreen_hmd=function(){if("HMD"!=!S.get("stereo")||"NONE"==S.get("stereo")&&S.get("is_mobile_device")){var e=v.get_device_by_type_element(v.DEVICE_HMD);if(e&&v.get_value_param(e,v.HMD_WEBVR_TYPE)&v.HMD_WEBVR1){var t=e.webvr_display;t&&t.isPresenting&&(t.exitPresent(),A.resize_to_container(!0))}else a()}},t.check_fullscreen_hmd=function(){var e=v.get_device_by_type_element(v.DEVICE_HMD),t=v.get_value_param(e,v.HMD_WEBVR_TYPE)&v.HMD_WEBVR1;return!(!e||!(t&&e.webvr_display||!t&&v.check_fullscreen()))},t.request_split_screen=_,t.exit_split_screen=function(){var e=v.get_device_by_type_element(v.DEVICE_HMD);if(!I||!e||!e.registered)return!1;var t={};return t.enable_hmd_stereo=!1,g.set_hmd_params(t),I=!1,b&&b(),g.render_one_eye(),L.enabled||g.multiply_size_mult(2,1),A.resize_to_container(!0),!0},t.shot=function(e,t){e=e||"image/png",t=t||1;var r=function(t){var r="screenshot."+e.split("/")[1];if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(t,r);else{var a=window.document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=t,a.download="screenshot."+e.split("/")[1],a.click(),document.body.removeChild(a)}};m.canvas_data_url(r,e,t,!0)}}var _=r(0),n=r(14),o=r(15),i=r(4),s=r(54),c=r(42),E=r(86),l=r(9),T=r(1),u=r(10),d=r(7),f=Object(_.a)("screen",a);t.a=f},function(e,t,r){"use strict";function a(e,t){function r(e){e.font="bold 15px Courier New",e.textBaseline="middle",e.shadowBlur=0,e.shadowColor=null}function a(e){if(s(' SCENE "'+e.name+'"'),s(" Active                 Subscene   Lamps   Size   RenderCalls   Time"),!e._render)return void s("No INFO");var t=0,r=0,a=0,_=e._render.graph;return p.traverse(_,function(e,_){var n=_;if(n.type!=v.SINK){for(var o=Math.round(n.camera.width)+"x"+Math.round(n.camera.height),i=0,c=0;c<n.draw_data.length;c++)i+=n.draw_data[c].bundles.length;var E=n.debug_render_calls;n.type!=v.MAIN_CUBE_REFLECT&&n.type!=v.MAIN_CUBE_REFLECT_BLEND||(i*=6);var l=n.do_render&&!n.force_do_not_render,T=l?n.debug_render_time:0;n.enqueue||(n.debug_render_time=0);s(l?" (\u2713)":" (\u2715)",v.subs_label(n),n.num_lights,o,E,"of",i,"  ",T.toFixed(3)),n.debug_render_calls=0,t+=i,l&&(r+=E,a+=T)}}),[t,r,a]}function _(){R[0]=0,R[1]=0}function i(){R[0]++}function s(){for(var e=m,t=O+R[0]*N,r=arguments[0],a=1;a<arguments.length;a++){var _=arguments[a];r+=c(g[a]-String(_).length)+arguments[a]}i(),h.fillText(r,e,t)}function c(e){for(var t="",r=0;r<e;r++)t+=" ";return t}function E(){return{x:0,y:0,w:0,h:0}}function l(e,t,r,a,_){return _.x=e,_.y=t,_.w=r,_.h=a,_}function T(e,t,r,a){var _=e.w/r;return a.x=e.x+_*t,a.y=e.y,a.w=_,a.h=e.h,a}function u(e,t,r,a){var _=e.h/r;return a.x=e.x,a.y=e.y+_*t,a.w=e.w,a.h=_,a}function d(e,t,r){var a=e.w*t;return r.x=e.x+a,r.y=e.y,r.w=e.w-2*a,r.h=e.h,r}function f(e,t,r){var a=e.h*t;return r.x=e.x,r.y=e.y+a,r.w=e.w,r.h=e.h-2*a,r}function P(e){return e.x+e.w/2}function A(e){var t=h,r=E();return l(0,0,t.canvas.width,t.canvas.height,r),d(r,.01,r),f(r,.02,r),T(r,e,8,r),d(r,.02,r),r}function S(e,t,r,a,_){var n=a[0],o=a[1],i=a[2],s=a[3],c=a[4],E=a[5],l=(s-i)/c;if(l<1)var T=Math.floor(1/l-1e-5).toFixed(0).length;else var T=0;if(E)var u=Math.log(o/i)/Math.log(s/i);else var u=(o-i)/(s-i);if(e.textAlign="center",_?e.fillText("["+n+"]",P(r),r.y):e.fillText(n,P(r),r.y),e.strokeStyle="#00FF00",e.lineWidth=t?3:1,t?(e.textAlign="right",e.fillText(s.toFixed(T),P(r)-10,r.y+15),e.textAlign="right",e.fillText(i.toFixed(T),P(r)-10,r.y+r.h-15)):(e.textAlign="right",e.fillText(i.toFixed(T),r.x+28,r.y+15),e.textAlign="left",e.fillText(s.toFixed(T),r.x+r.w-28,r.y+15)),e.beginPath(),t){var d=r.y+15+(r.h-30)*(1-u);e.moveTo(P(r),r.y+15),e.lineTo(P(r),r.y+r.h-15),e.moveTo(P(r)-5,r.y+15),e.lineTo(P(r)+5,r.y+15),e.moveTo(P(r)-5,r.y+r.h-15),e.lineTo(P(r)+5,r.y+r.h-15),e.moveTo(P(r)-5,d),e.lineTo(P(r)+5,d)}else{var f=r.x+30+(r.w-60)*u;e.moveTo(r.x+30,r.y+15),e.lineTo(r.x+r.w-30,r.y+15),e.moveTo(r.x+30,r.y+15-5),e.lineTo(r.x+30,r.y+15+5),e.moveTo(r.x+r.w-30,r.y+15-5),e.lineTo(r.x+r.w-30,r.y+15+5),e.moveTo(f,r.y+15-5),e.lineTo(f,r.y+15+5)}if(e.stroke(),"EQ_Q"==n){var A=o,S=1+1/(2*A*A)+Math.sqrt((2+1/(A*A))*(2+1/(A*A))/4-1),p=Math.log(S)/Math.log(2);t?(e.textAlign="left",e.fillText(o.toFixed(T),P(r)+10,d),e.textAlign="left",e.fillText("("+p.toFixed(T+1)+")",P(r)+10,d+10)):(e.textAlign="right",e.fillText(o.toFixed(T),f,r.y+30),e.textAlign="left",e.fillText("("+p.toFixed(T+1)+")",f,r.y+30))}else t?(e.textAlign="left",e.fillText(o.toFixed(T),P(r)+10,d)):(e.textAlign="center",e.fillText(o.toFixed(T),f,r.y+30))}var p=Object(n.a)(e),v=Object(o.a)(e),m=30,O=80,N=20,g=[5,30,4,10,5,3,5],h=null,R=[0,0];t.init=function(e){var t=e.getContext("2d");return r(t),h=t,t},t.update_dim=function(){h&&r(h)},t.reset=function(){var e=h;e&&(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,e.canvas.width,e.canvas.height),_())},t.show_debug_info=function(e,t){var r=h;if(r){r.textAlign="left",r.fillStyle="rgba(0,255,0,255)",s(" FPS",(1/t).toFixed(2)),i();for(var _=0,n=0,o=0,c=0;c<e.length;c++){var E=a(e[c]);_+=E[0],n+=E[1],o+=E[2],i()}s(" ----------------------------------------------------------------"),s("    ","TOTAL ACTIVE","","",n,"of",_,"  ",o.toFixed(3))}},t.print=function(){var e=h;e&&(e.textAlign="left",e.fillStyle="rgba(0,255,0,255)",s.apply(Math,arguments))},t.plot_array=function(e,t,r,a,_,n,o){var i=h;if(i){var s=A(t);if(u(s,4,5,s),i.textAlign="center",i.fillStyle="#00FF00",h.fillText(e,P(s),s.y-10),i.strokeStyle="#00FF00",i.lineWidth=.5,i.beginPath(),i.moveTo(s.x,s.y),i.lineTo(s.x+s.w,s.y),i.lineTo(s.x+s.w,s.y+s.h),i.lineTo(s.x,s.y+s.h),i.closePath(),i.stroke(),!n&&!o){n=1e6,o=-1e6;for(var c=0;c<r.length;c++)n=Math.min(n,r[c]),o=Math.max(o,r[c])}i.textAlign="right",h.fillText(String(n),s.x-10,s.y+s.h),h.fillText(String(o),s.x-10,s.y),i.textAlign="center",h.fillText(String(a),s.x,s.y+s.h+15),h.fillText(String(_),s.x+s.w,s.y+s.h+15),i.strokeStyle="#FF0000",i.lineWidth=1.5,i.beginPath();for(var E=s.w/(r.length-1),l=s.h/(o-n),c=0;c<r.length;c++){var T=s.x+E*c,d=s.y+s.h-(r[c]-n)*l;0==c?i.moveTo(T,d):i.lineTo(T,d)}i.stroke()}},t.draw_mixer_strip=function(e,t,r,a,_,n,o){var i=h;if(i){i.textAlign="center",i.fillStyle="#00FF00",i.font="bold 12px Courier";var s=A(r),c=t?"["+e+"]":e;h.fillText(c,P(s),s.y),n>=0&&h.fillText(n?"[M]":"[ ]",P(s)-15,s.y+30),o>=0&&h.fillText(o?"[S]":"[ ]",P(s)+15,s.y+30);for(var T=E(),u=0;u<a.length;u++){var d=a[u],f="VOLUME"==d[0];f?l(s.x,s.y+350,s.w,250,T):l(s.x,s.y+50+50*u,s.w,s.h,T),S(i,f,T,d,u==_)}}}}var _=r(0),n=r(30),o=r(11),i=Object(_.a)("__hud",a);t.a=i},function(e,t,r){"use strict";function a(e,t){function r(e){for(var t=null,r=e.scenes_data.length-1;r>=0;r--){var a=e.scenes_data[r];if(a.scene.b4w_use_nla&&(t=a,a.scene._is_main))break}return t}function a(e,t,r){for(var a=0;a<e.length;a++){var _=e[a];if(t.frame_start>_.frame_end||t.frame_end<_.frame_start){var n=r+" ["+_.frame_start+":"+_.frame_end+"]";B.warn("NLA: Strip is out of scene range: "+n),e.splice(a,1),a--}else _.anim_name||"CLIP"!=_.type||(B.warn('NLA: no action in strip for object "'+r+'".'),e.splice(a,1),a--)}}function _(e,t){for(var r=0;r<e.length;r++){for(var a=e[r],_=t.frame_start,n=t.frame_end+1,o=0;o<e.length;o++){var i=e[o];a.anim_slot==i.anim_slot&&(i.frame_end<=a.frame_start&&(_=a.frame_start),i.frame_start>=a.frame_end&&(n=Math.min(n,i.frame_start)))}a.ext_frame_start=_,a.ext_frame_end=n,d(a)}}function d(e){e.repeat%1===0?e.action_frame_final=e.action_frame_end:e.action_frame_final=e.action_frame_start+(e.action_frame_end-e.action_frame_start)*(e.repeat%1)}function f(e,t){for(var r=G.get_all_actions(),a=[],_=0,n=0;n<e.length;n++){var o=e[n];if(""!=o.anim_uuid)var i=u._19("uuid",o.anim_uuid,r);else var s=o.anim_name,i=u._19("name",s,r)||u._19("name",s+"_B4W_BAKED",r);if(i){var c=i.fcurves,E=[];for(var l in c)E.push(l);a.push(E)}}for(var n=0;n<a.length;n++){for(var T=!1,d=0;d<n;d++)if(u.E(a[n],a[d])){e[n].anim_slot=e[d].anim_slot,T=!0;break}T||(e[n].anim_slot=t+_++)}return _}function P(){return{type:"CLIP",frame_start:0,frame_end:0,scheduled:!1,paused:!1,anim_name:"",anim_uuid:"",anim_slot:0,name_list:null,action_frame_start:0,action_frame_end:0,ext_frame_start:0,ext_frame_end:0,use_reverse:!1,scale:1,repeat:1,action_frame_final:0}}function A(e,t,r){if(e.animation_data){var a=e.animation_data,_=a.nla_tracks;if(_)for(var n=0;n<_.length;n++)_[n].name_list=r,t.push(_[n])}for(var o=e.nodes,n=0;n<o.length;n++){var i=o[n];if(i.node_group){var s=i.node_group.node_tree;if(s){var c=r.slice();c.push(i.name),A(s,t,c)}}}}function S(e,t){e.is_stopped=!0,e.frame_offset-=t-e.range_end,e.user_callback&&e.user_callback()}function p(e,t){return e.user_callback&&e.user_callback(),U(e.range_start,t),e.rewinded_to_start=!0,h(e,t)}function v(e,t,r){for(var a=0;a<e.objects.length;a++){var _=e.objects[a];if(_)for(var n=0;n<_.length;n++){for(var o=_[n],i=o.nla_events,s=0;s<i.length;s++){var c=i[s];"SOUND"==c.type&&t<e.last_frame-V&&(c.scheduled=!1)}for(var s=0;s<i.length;s++){var c=i[s];switch(c.type){case"CLIP":if(c.ext_frame_start<=t&&t<c.ext_frame_end&&!c.scheduled){R(o,c,t,r);for(var a=0;a<i.length;a++)i[a]!=c&&i[a].anim_slot==c.anim_slot&&(i[a].scheduled=!1);c.scheduled=!0}c.scheduled&&I(o,c,t,r);break;case"SOUND":(t<e.last_frame-V||e.last_frame<c.frame_start)&&c.frame_start<=t&&t<c.frame_end&&(c.scheduled||(Y(o,c,t),c.scheduled=!0)),e.last_frame<c.frame_end&&c.frame_end<=t&&c.scheduled&&(c.scheduled=!1)}}}}}function m(e,t,r){for(var a=0;a<t.textures.length;a++){var _=t.textures[a];if(_.video_file||_.seq_video){var n=H.video_get_current_frame(_),o=N(r,_),i=H.video_get_start_frame(_),s=!1,c=!1;if((t.force_update||t.rewinded_to_start)&&(c=!0),!t.is_stopped){var E=g(r,_),l=H.video_is_played(_);_.use_cyclic&&o==i&&(c=!0),l||n==o||(c=!0),E&&!l?H.play_video(_):E&&l?s=!0:!E&&l&&(_.video_file&&n<o?s=!0:H.pause_video(_))}if(c)H.set_frame_video(_.video_tex_name,o,_.vtex_data_id),_.seq_video&&(_.seq_last_discrete_mark=H.seq_video_get_discrete_timemark(_,e));else if(s&&H.video_update_is_available(_))if(_.video_file)H.update_video_texture(_);else{var T=H.seq_video_get_discrete_timemark(_,e);T!=_.seq_last_discrete_mark&&(_.seq_cur_frame=o,H.update_seq_video_texture(_)),_.seq_last_discrete_mark=T}}}}function O(e,t){var r=Math.round(e)-t.frame_start;return t.use_cyclic&&(r%=t.frame_duration)<0&&(r+=t.frame_duration),t.frame_offset+r}function N(e,t){var r=O(e,t),a=u.M(r,t.frame_offset,t.frame_offset+H.video_get_duration(t)-1);return t.seq_video&&(a=H.video_frame_to_seq_frame(t,a))==t.seq_movie_length&&a--,a}function g(e,t){var r=O(e,t);return t.frame_offset<=r&&r<=t.frame_offset+H.video_get_duration(t)}function h(e,t){var r=(t-q)*Q.get_framerate()+e.frame_offset;if(r>e.frame_start){if(r-=e.frame_start,e.cyclic){r%=e.frame_end-e.frame_start+1}r+=e.frame_start}else r=e.frame_start;return r}function R(e,t,r,a){var _=t.name_list;""!=t.anim_uuid?G.apply_by_uuid(e,_,t.anim_uuid,t.anim_slot):G.apply(e,_,t.anim_name,t.anim_slot),G.set_behavior(e,G.AB_FINISH_STOP,t.anim_slot);var n=b(t.frame_start,t);G.set_frame(e,n,t.anim_slot)}function I(e,t,r,a){var _=b(r,t),n=G.get_current_frame_float(e,t.anim_slot);Math.abs(_-n)>V&&G.set_frame(e,_,t.anim_slot)}function b(e,t){if((e=u.M(e,t.frame_start,t.frame_end))==t.frame_end)var r=t.action_frame_final;else var a=(e-t.frame_start)/t.scale,_=t.action_frame_end-t.action_frame_start,n=a%_,r=t.action_frame_start+n;return t.use_reverse&&(r=t.action_frame_end-r+t.action_frame_start),r}function Y(e,t,r){var a=(t.frame_start-r)/Q.get_framerate(),_=(t.frame_end-t.frame_start)/Q.get_framerate();j.play(e,a,_)}function L(e,t){for(var r=[],a=0;a<e.length;a++){var _=e[a],n=_.strips;if(n)for(var o=0;o<n.length;o++){var i=n[o],s=P();s.type=i.type,s.frame_start=i.frame_start,s.frame_end=i.frame_end,s.anim_slot=t,s.action_frame_start=i.action_frame_start,s.action_frame_end=i.action_frame_end,s.use_reverse=i.use_reverse,s.scale=i.scale,s.repeat=i.repeat,i.action&&(s.anim_name=i.action.name,s.anim_uuid=i.action.uuid,s.name_list=_.name_list),r.push(s)}}return r}function M(e){return!("SPEAKER"!=e.type&&"LAMP"!=e.type||!e.data.animation_data||!e.data.animation_data.nla_tracks.length)}function y(e){if("MESH"!=e.type||!e.data)return!1;var t=e.data.materials;if(!t)return!1;for(var r=0;r<t.length;r++){var a=t[r],_=a.node_tree;if(a.use_nodes&&_&&x(_))return!0}return!1}function x(e,t){if(e.animation_data){var r=e.animation_data,a=r.nla_tracks;if(a&&a.length)return!0}for(var _=e.nodes,n=0;n<_.length;n++){var o=_[n];if(o.node_group){var i=o.node_group.node_tree;i&&x(i,t)}}return!1}function U(e,t){var r=X.get_active();if(r._nla){var a=h(r._nla,t);r._nla.frame_offset-=a-e,r._nla.force_update=!0}}function w(e){var t=X.get_active();return t._nla?h(t._nla,e):-1}function C(){var e=X.get_active();if(e._nla){e._nla.is_stopped=!0;for(var t=e._nla.textures,r=0;r<t.length;r++){var a=t[r];H.pause_video(a)}}}function D(e){var t=X.get_active();t._nla&&(t._nla.is_stopped=!1,t._nla.user_callback=e||null)}function F(){var e=X.get_active();if(!e._nla)return!1;var t=e._nla;t.range_start=t.frame_start,t.range_end=t.frame_end}var G=Object(n.a)(e),k=Object(o.a)(e),K=Object(i.a)(e),B=Object(s.a)(e),X=Object(c.a)(e),j=Object(E.a)(e),H=Object(l.a)(e),Q=Object(T.a)(e),z=[],q=-1,V=1e-6;t.update_object=function(e,t){var a=r(t);if(a){a.obj_has_nla_on_scene=!0;var _=0,n=e.animation_data;if(n&&n.nla_tracks.length){var o=n.nla_tracks;if(K.is_armature(t)||K.is_camera(t)||K.is_mesh(t)||K.is_empty(t)||K.is_line(t)||K.is_lamp(t)||K.is_speaker(t)||K.is_world(t)){var i=L(o,_);i.length&&(t.nla_events=t.nla_events.concat(i),_++)}}if(M(e)){var o=e.data.animation_data.nla_tracks,i=L(o,_);i.length&&(t.nla_events=t.nla_events.concat(i),_++)}if(K.is_mesh(t))for(var s=t.materials,c=0;c<s.length;c++){var E=s[c];if(E.use_nodes&&E.node_tree){var o=[];A(E.node_tree,o,[E.name]);var i=L(o,_);i.length&&(_+=f(i,_),t.nla_events=t.nla_events.concat(i))}}if(K.is_world(t)){if(e.use_nodes&&e.node_tree){var o=[];A(e.node_tree,o,[e.name]);var i=L(o,_);i.length&&(_+=f(i,_),t.nla_events=t.nla_events.concat(i))}}else{for(var c=0;c<e.particle_systems.length;c++){var l=e.particle_systems[c],T=l.settings;if("EMITTER"==T.type&&T.b4w_allow_nla){var u=P();u.type="CLIP",u.frame_start=a.scene.frame_start,u.frame_end=a.scene.frame_end+1,u.anim_name=l.name,u.anim_slot=_,u.action_frame_start=u.frame_start,u.action_frame_end=u.frame_end,t.nla_events.push(u),_++}}for(var d=_+1,c=0;c<t.vertex_anim.length;c++){var S=t.vertex_anim[c];if(S.allow_nla){_=d;var u=P();u.type="CLIP",u.frame_start=S.frame_start,u.frame_end=S.frame_end,u.anim_name=S.name,u.anim_slot=_,u.action_frame_start=u.frame_start,u.action_frame_end=u.frame_end,t.nla_events.push(u)}}}}},t.update_scene=function(e,t,r){e._nla||(e._nla={frame_start:e.frame_start,frame_end:e.frame_end,frame_offset:0,last_frame:-1,range_end:e.frame_end,range_start:e.frame_start,user_callback:null,cyclic:t,objects:[],textures:[],scene_name:e.name,is_stopped:!1,force_update:!1,rewinded_to_start:!0},z.push(e._nla));for(var n=e._nla,o=k.get_scene_objs_derived(e,"ALL",r),i=0;i<o.length;i++){var s=o[i];if(s.nla_events.length){n.objects[r]||(n.objects[r]=[]);for(var c=0;c<s.scenes_data.length;c++){var E=s.scenes_data[c];E.scene==e&&E.obj_has_nla_on_scene&&n.objects[r].push(s)}a(s.nla_events,n,s.name),_(s.nla_events,n)}}for(var l=e._render.video_textures,i=0;i<l.length;i++){var T=l[i]._render;if(T.use_nla&&(T.video_file||T.seq_video)&&T.vtex_data_id==r){var d=P();d.type="VIDEO",T.use_cyclic?(d.frame_start=0,d.frame_end=n.frame_end):(d.frame_start=u.M(T.frame_start,0,n.frame_end),d.frame_end=u.M(T.frame_start+T.frame_duration,0,n.frame_end)),d.anim_name=l[i].name,n.textures.push(T)}}},t.prepare=function(){for(var e=0;e<z.length;e++)for(var t=z[e],r=0;r<t.objects.length;r++){var a=t.objects[r];if(a)for(var e=0;e<a.length;e++)for(var _=a[e],n=_.nla_events,o=0;o<n.length;o++){var i=n[o];G.init_action_cache(_,i.name_list,i.uuid,i.anim_name,i.anim_slot)}}},t.start=function(){q=0},t.get_start_time=function(){return q},t.get_frame_offset=function(e){return e._nla?e._nla.frame_offset:null},t.set_frame_offset=function(e,t){return!!e._nla&&(e._nla.frame_offset=t,!0)},t.update=function(e,t){if(!(q<0)){0==q&&(q=e);for(var r=0;r<z.length;r++){var a=z[r];a.is_stopped&&(a.frame_offset-=Q.get_framerate()*t);var _=h(a,e);(!a.is_stopped||a.force_update)&&_>=a.range_end&&(a.cyclic?_=p(a,e):S(a,_)),a.is_stopped&&!a.force_update||(v(a,_,t),m(e,a,_),a.last_frame=_),a.force_update=!1,a.rewinded_to_start=!1}}},t.cleanup=function(e){if(0==e)z.length=0,q=-1;else for(var t=0;t<z.length;t++)z[t].objects[e]=null},t.bpy_obj_has_nla=function(e){var t=e.animation_data;return!!(t&&t.nla_tracks.length||M(e)||y(e))},t.set_frame=U,t.get_frame=w,t.stop_nla=C,t.play_nla=D,t.get_frame_start=function(){var e=X.get_active();return e._nla?e._nla.frame_start:-1},t.get_frame_end=function(){var e=X.get_active();return e._nla?e._nla.frame_end:-1},t.is_play=function(){var e=X.get_active();return!!e._nla&&!e._nla.is_stopped},t.check_nla=function(){var e=X.get_active();return!!e._nla&&e.b4w_use_nla},t.check_logic_nodes=function(){var e=X.get_active();return!!e._nla&&e.b4w_logic_nodes.length>0},t.set_range=function(e,t){var r=X.get_active();if(!r._nla)return!1;r._nla.range_start=e,r._nla.range_end=t},t.set_range_end=function(e){var t=X.get_active();if(!t._nla)return!1;t._nla.range_end=e},t.set_range_start=function(e){var t=X.get_active();if(!t._nla)return!1;t._nla.range_start=e},t.reset_range=F,t.set_cyclic=function(e){var t=X.get_active();if(!t._nla)return!1;t._nla.cyclic=e},t.clear_callback=function(){var e=X.get_active();e._nla&&(e._nla.user_callback=null)},t.set_offset_from_range_start=function(e){var t=X.get_active(),r=t._nla;r&&(r.frame_offset=-(e-q)*Q.get_framerate()+r.range_start,r.force_update=!0)},t.get_frame_end=function(){var e=X.get_active(),t=e._nla;return t?t.frame_end:null}}var _=r(0),n=r(41),o=r(12),i=r(9),s=r(1),c=r(10),E=r(23),l=r(17),T=r(18),u=r(2),d=Object(_.a)("__nla",a);t.a=d},function(e,t,r){"use strict";function a(e,t){function r(e,t){return t||(t=D.get_container()),{type:e,value:0,payload:null,element:t,do_activation:!1,key:0,collision_id:"",calc_pos_norm:!1,collision_obj:null,collision_cb:function(){},col_imp_obj:null,col_imp_cb:function(){},source_object:null,from:new Float32Array(3),to:new Float32Array(3),is_binary_value:!1,ign_src_rot:!1,ray_test_id:0,ray_test_cb:function(){},axis:"",time_last:0,trans_last:new Float32Array(3),quat_last:new Float32Array(4),threshold:0,quat_temp:new Float32Array(4),avg_linear_vel:0,avg_angular_vel:0,rotation_threshold:0,avg_vertical_vel:0,period:0,repeat:!1,enable_toggle_switch:!1,gamepad_id:0,position:P.create(),orientation:T.create(),callback:function(){}}}function a(e){e.mouse_select_data.is_updated||(e.mouse_select_data.obj=G.pick_object(e.mouse_select_data.coord[0],e.mouse_select_data.coord[1]),e.mouse_select_data.is_updated=!0,e.global_selected_obj=e.mouse_select_data.obj);for(var t=0;t<Ge;++t){var r=e.touch_select_dlist[t];r.is_updated||(r.obj=G.pick_object(r.coord[0],r.coord[1]),r.is_updated=!0,e.global_selected_obj=r.obj)}}function _(e){if(!e.is_updated_keyboard){for(var t=0;t<e.downed_keys.length;t++)e.downed_keys[t]==we?e.downed_keys[t]=Ce:e.downed_keys[t]==De&&(e.downed_keys[t]=Ue);e.is_updated_keyboard=!0}e.mouse_state==we?e.mouse_state=Ce:e.mouse_state==De&&(e.mouse_state=Ue);for(var r=0;r<e.touch_select_dlist.length;r++){var a=e.touch_select_dlist[r];a.touch_state==we?a.touch_state=Ce:a.touch_state==De&&(a.touch_state=Ue)}e.wheel_delta=0,e.mouse_last_x=e.mouse_curr_x,e.mouse_last_y=e.mouse_curr_y,e.downed_keys[0]=Ue,e.touches_last_x.set(e.touches_curr_x),e.touches_last_y.set(e.touches_curr_y),e.touch_zoom_last_dist=e.touch_zoom_curr_dist,e.gyro_gamma_last=e.gyro_gamma_new,e.gyro_beta_last=e.gyro_beta_new,e.gyro_alpha_last=e.gyro_alpha_new,e.is_updated_gyro_quat=!1}function A(e){function t(){return{coord:new Float32Array(2),is_updated:!0,obj:null,identifier:-1,touch_state:Ue}}e||(e=D.get_container());for(var r=0;r<V.length;r++){var a=V[r];if(e==a.element)return a}for(var a={element:e,is_updated_keyboard:!0,mouse_state:Ue,is_touch_ended:!0,mouse_last_x:0,mouse_last_y:0,mouse_curr_x:0,mouse_curr_y:0,pointerlock_dx:0,pointerlock_dy:0,touches_last_x:new Float32Array(2),touches_curr_x:new Float32Array(2),touches_last_y:new Float32Array(2),touches_curr_y:new Float32Array(2),touch_zoom_curr_dist:0,touch_zoom_last_dist:0,touch_start_rot:0,downed_keys:new Uint8Array(256),wheel_delta:0,global_selected_obj:null,mouse_select_data:t(),touch_select_dlist:new Array(Ge),is_updated_gyro_quat:!1,gyro_quat:T.create(),gyro_gamma_new:0,gyro_beta_new:0,gyro_alpha_new:0,gyro_gamma_last:0,gyro_beta_last:0,gyro_alpha_last:1/0,orientation_quat_cb:null,orientation_angles_cb:null,mouse_wheel_cb:null,mouse_down_which_cb:null,mouse_select_cb:null,touch_select_start_cb:null,touch_select_end_cb:null,mouse_up_which_cb:null,mouse_location_cb:null,pointerlock_cb:null,keyboard_downed_keys_cb:null,touch_start_cb:null,touch_move_cb:null,touch_end_cb:null,registered_accum_values:{}},r=0;r<Ge;++r)a.touch_select_dlist[r]=t();return a.orientation_quat_cb=function(e){a.is_updated_gyro_quat||(F.gyro_angles_to_quat(e,a.gyro_quat),a.is_updated_gyro_quat=!0)},a.orientation_angles_cb=function(e){var t=P.copy(e,Z);a.gyro_alpha_new=t[0],a.gyro_beta_new=t[1],a.gyro_gamma_new=t[2],a.gyro_alpha_last==1/0&&(a.gyro_alpha_last=t[0],a.gyro_beta_last=t[1],a.gyro_gamma_last=t[2])},a.mouse_wheel_cb=function(e){a.wheel_delta+=e*X.mouse_wheel_notch_multiplier},a.mouse_down_which_cb=function(e){var t=F.get_device_by_type_element(F.DEVICE_MOUSE,a.element),r=F.get_vector_param(t,F.MOUSE_LOCATION,W);a.mouse_last_x=r[0],a.mouse_last_y=r[1],a.mouse_curr_x=r[0],a.mouse_curr_y=r[1],a.mouse_state!=De&&a.mouse_state!=Ue||(a.mouse_state=we),a.which=e},a.mouse_select_cb=function(e){var t=F.get_device_by_type_element(F.DEVICE_MOUSE,a.element),r=F.get_vector_param(t,F.MOUSE_LOCATION,W),_=D.client_to_canvas_coords(r[0],r[1],W);a.mouse_select_data.is_updated=!1,a.mouse_select_data.coord[0]=_[0],a.mouse_select_data.coord[1]=_[1]},a.touch_select_start_cb=function(e){for(var t=0;t<e.length;++t){for(var r=e[t],_=null,n=null,o=0;o<a.touch_select_dlist.length;o++){var i=a.touch_select_dlist[o],s=i.touch_state==De||i.touch_state==Ue;if(i.identifier==r.identifier){s&&(n=i);break}!_&&s&&(_=i,_.identifier=r.identifier)}var c=n||_;if(c){var E=D.client_to_canvas_coords(e[t].clientX,e[t].clientY,W);c.is_updated=!1,c.touch_state=we,c.coord[0]=E[0],c.coord[1]=E[1]}}},a.touch_select_end_cb=function(e){for(var t=0;t<a.touch_select_dlist.length;++t){for(var r=a.touch_select_dlist[t],_=!1,n=0;n<e.length;++n){if(e[n].identifier==r.identifier){_=!0;break}}_||(r.touch_state!=Ue&&(r.touch_state=De),r.obj=null)}},a.mouse_up_which_cb=function(e){var t=F.get_device_by_type_element(F.DEVICE_MOUSE,a.element),r=F.get_vector_param(t,F.MOUSE_LOCATION,W);a.mouse_last_x=r[0],a.mouse_last_y=r[1],a.mouse_curr_x=r[0],a.mouse_curr_y=r[1],a.mouse_state!=Ue&&(a.mouse_state=De),a.which=e},a.mouse_location_cb=function(e){j.ie11_edge_touchscreen_hack&&a.mouse_state==Ue||(a.mouse_curr_x=e[0],a.mouse_curr_y=e[1])},a.pointerlock_cb=function(e){a.pointerlock_dx+=e[0],a.pointerlock_dy+=e[1]},a.keyboard_down_keys_cb=function(e){a.downed_keys[e]!=Ce&&(a.downed_keys[e]=we,a.is_updated_keyboard=!1)},a.keyboard_down_mod_keys_cb=function(e){for(var t=0;t<a.downed_keys.length;t++)a.downed_keys[t]!=Ue&&(a.downed_keys[t]=De,a.is_updated_keyboard=!1)},a.keyboard_up_keys_cb=function(e){a.is_updated_keyboard=!1,a.downed_keys[e]=De},a.touch_start_cb=function(e){if(a.is_touch_ended=!1,1==e.length)a.touches_last_x[0]=e[0].clientX,a.touches_last_x[1]=-1,a.touches_last_y[0]=e[0].clientY,a.touches_last_y[1]=-1;else if(e.length>1){var t=M(e);a.touch_zoom_curr_dist=a.touch_zoom_last_dist=t,a.touches_last_x[0]=e[0].clientX,a.touches_last_x[1]=e[1].clientX,a.touches_last_y[0]=e[0].clientY,a.touches_last_y[1]=e[1].clientY,a.touch_start_rot=y(e)}a.touches_curr_x.set(a.touches_last_x),a.touches_curr_y.set(a.touches_last_y)},a.touch_move_cb=function(e){if(1===e.length)a.touches_curr_x[0]=e[0].clientX,a.touches_curr_x[1]=-1,a.touches_curr_y[0]=e[0].clientY,a.touches_curr_y[1]=-1;else if(e.length>1){a.touches_curr_x[0]=e[0].clientX,a.touches_curr_x[1]=e[1].clientX,a.touches_curr_y[0]=e[0].clientY,a.touches_curr_y[1]=e[1].clientY;var t=M(e);a.touch_zoom_curr_dist=t}},a.touch_end_cb=function(e){0==e.length&&(a.is_touch_ended=!0)},V.push(a),a}function S(e,t){if(t in e.registered_accum_values&&e.registered_accum_values[t]>0)return void(e.registered_accum_values[t]+=1);switch(e.registered_accum_values[t]=1,t){case"orientation_quat":var r=F.get_device_by_type_element(F.DEVICE_GYRO);r&&F.attach_param_cb(r,F.GYRO_ORIENTATION_ANGLES,e.orientation_quat_cb);break;case"orientation_angles":var r=F.get_device_by_type_element(F.DEVICE_GYRO);r&&F.attach_param_cb(r,F.GYRO_ORIENTATION_ANGLES,e.orientation_angles_cb);break;case"mouse_wheel":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.attach_param_cb(r,F.MOUSE_WHEEL,e.mouse_wheel_cb);break;case"mouse_down_which":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.attach_param_cb(r,F.MOUSE_DOWN_WHICH,e.mouse_down_which_cb);break;case"mouse_select":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.attach_param_cb(r,F.MOUSE_DOWN_WHICH,e.mouse_select_cb);break;case"touch_select":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&(F.attach_param_cb(r,F.TOUCH_START,e.touch_select_start_cb),F.attach_param_cb(r,F.TOUCH_END,e.touch_select_end_cb));break;case"mouse_up_which":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.attach_param_cb(r,F.MOUSE_UP_WHICH,e.mouse_up_which_cb);break;case"mouse_location":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.attach_param_cb(r,F.MOUSE_LOCATION,e.mouse_location_cb);break;case"mouse_pointerlock":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.attach_param_cb(r,F.MOUSE_LOCATION_PL,e.pointerlock_cb);break;case"keyboard_downed_keys":var r=F.get_device_by_type_element(F.DEVICE_KEYBOARD,e.element);r&&(F.attach_param_cb(r,F.KEYBOARD_DOWN,e.keyboard_down_keys_cb),F.attach_param_cb(r,F.KEYBOARD_DOWN_MODIFIED,e.keyboard_down_mod_keys_cb),F.attach_param_cb(r,F.KEYBOARD_UP,e.keyboard_up_keys_cb));break;case"touch_start":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&F.attach_param_cb(r,F.TOUCH_START,e.touch_start_cb);break;case"touch_move":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&F.attach_param_cb(r,F.TOUCH_MOVE,e.touch_move_cb);break;case"touch_end":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&F.attach_param_cb(r,F.TOUCH_END,e.touch_end_cb)}}function p(e,t){if(t in e.registered_accum_values&&e.registered_accum_values[t]>0&&(e.registered_accum_values[t]-=1,!e.registered_accum_values[t]))switch(t){case"orientation_quat":var r=F.get_device_by_type_element(F.DEVICE_GYRO);r&&F.detach_param_cb(r,F.GYRO_ORIENTATION_QUAT,e.orientation_quat_cb);break;case"orientation_angles":var r=F.get_device_by_type_element(F.DEVICE_GYRO);r&&F.detach_param_cb(r,F.GYRO_ORIENTATION_ANGLES,e.orientation_angles_cb);break;case"mouse_wheel":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.detach_param_cb(r,F.MOUSE_WHEEL,e.mouse_wheel_cb);break;case"mouse_down_which":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.detach_param_cb(r,F.MOUSE_DOWN_WHICH,e.mouse_down_which_cb);break;case"mouse_select":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.detach_param_cb(r,F.MOUSE_DOWN_WHICH,e.mouse_select_cb);break;case"touch_select":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&(F.detach_param_cb(r,F.TOUCH_START,e.touch_select_start_cb),F.detach_param_cb(r,F.TOUCH_END,e.touch_select_end_cb));break;case"mouse_up_which":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.detach_param_cb(r,F.MOUSE_UP_WHICH,e.mouse_up_which_cb);break;case"mouse_location":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.detach_param_cb(r,F.MOUSE_LOCATION,e.mouse_location_cb);break;case"mouse_pointerlock":var r=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);r&&F.detach_param_cb(r,F.MOUSE_LOCATION_PL,e.pointerlock_cb);break;case"keyboard_downed_keys":var r=F.get_device_by_type_element(F.DEVICE_KEYBOARD,e.element);r&&(F.detach_param_cb(r,F.KEYBOARD_DOWN,e.keyboard_down_keys_cb),F.detach_param_cb(r,F.KEYBOARD_DOWN_MODIFIED,e.keyboard_down_mod_keys_cb),F.detach_param_cb(r,F.KEYBOARD_UP,e.keyboard_up_keys_cb));break;case"touch_start":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&F.detach_param_cb(r,F.TOUCH_START,e.touch_start_cb);break;case"touch_move":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&F.detach_param_cb(r,F.TOUCH_MOVE,e.touch_move_cb);break;case"touch_end":var r=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);r&&F.detach_param_cb(r,F.TOUCH_END,e.touch_end_cb)}}function v(e,t){e.value=Number(t)}function m(e){for(var t=e.sensors,r=e.sensor_values,a=0;a<t.length;a++)r[a]=t[a].value;return e.logic_fun(r)}function O(e,r,a){if(a)switch(e.type){case ue:var _=e.source_object,n=d.j(_.render.world_tsr,Z),o=d.g(_.render.world_tsr,$),i=P.dist(e.trans_last,n),s=e.quat_temp;T.invert(e.quat_last,s),T.multiply(o,s,s),T.normalize(s,s);var c=Math.abs(2*Math.acos(s[3])),E=i/a;e.avg_linear_vel=f._51(E,e.avg_linear_vel,a,Me),e.payload[0]=E;var l=c/a;e.avg_angular_vel=f._51(l,e.avg_angular_vel,a,Me),e.payload[1]=l,e.avg_linear_vel>=e.threshold||e.avg_angular_vel>=e.rotation_threshold?v(e,1):v(e,0),P.copy(n,e.trans_last),T.copy(o,e.quat_last),e.time_last=r;break;case de:var _=e.source_object,n=d.j(_.render.world_tsr,Z),u=Math.abs(n[1]-e.trans_last[1])/a;e.avg_vertical_vel=f._51(u,e.avg_vertical_vel,a,Me),e.payload=u,e.avg_vertical_vel>=e.threshold?v(e,1):v(e,0),P.copy(n,e.trans_last),e.time_last=r;break;case fe:!e.do_activation&&e.period>=0&&r-e.time_last>=e.period&&(v(e,1),e.repeat?e.time_last=r:e.period=-e.period);break;case Pe:e.time_last||(e.time_last=r),v(e,r-e.time_last),e.time_last=r;break;case Ae:v(e,r);break;case pe:var S=A(e.element);e.payload[0]=S.gyro_gamma_new-S.gyro_gamma_last,e.payload[1]=S.gyro_beta_new-S.gyro_beta_last,e.payload[2]=S.gyro_alpha_new-S.gyro_alpha_last;break;case ve:var S=A(e.element);e.payload[0]=S.gyro_gamma_new,e.payload[1]=S.gyro_beta_new,e.payload[2]=S.gyro_alpha_new;break;case me:var S=A(e.element);T.copy(S.gyro_quat,e.payload);break;case Oe:var p=F.get_device_by_type_element(F.DEVICE_HMD);F.get_vector_param(p,F.HMD_ORIENTATION_QUAT,e.payload);break;case Ne:var p=F.get_device_by_type_element(F.DEVICE_HMD);F.get_vector_param(p,F.HMD_POSITION,e.payload);break;case he:var p=x(e.gamepad_id);e.value=F.get_gamepad_btn_value(p,e.key);break;case Re:var p=x(e.gamepad_id);e.value=F.get_gamepad_axis_value(p,e.key);break;case Ie:var p=x(e.gamepad_id);F.get_gamepad_position(p,e.payload),v(e,1);break;case be:var p=x(e.gamepad_id);F.get_gamepad_orientation(p,e.payload),v(e,1);break;case ge:v(e,e.callback());break;case ae:var S=A(e.element);v(e,S.wheel_delta);break;case _e:var S=A(e.element);if(!j.ie11_edge_touchscreen_hack||S.mouse_state==we||S.mouse_state==Ce){var m=S.mouse_curr_x-S.mouse_last_x,O=S.mouse_curr_y-S.mouse_last_y;switch(e.payload.coords[0]=S.mouse_curr_x,e.payload.coords[1]=S.mouse_curr_y,e.axis){case"X":v(e,m);break;case"Y":v(e,O);break;case"XY":var N=Math.sqrt(m*m+O*O);v(e,N)}}break;case Ye:var S=A(e.element),m=S.pointerlock_dx,O=S.pointerlock_dy,g=f._51(m,0,a,U()),h=f._51(O,0,a,U());Math.abs(m)>xe||Math.abs(O)>xe?(S.pointerlock_dx-=g,S.pointerlock_dy-=h,e.payload.coords[0]=g,e.payload.coords[1]=h):(e.payload.coords[0]=0,e.payload.coords[1]=0),v(e,Math.sqrt(m*m+O*O));break;case ne:var S=A(e.element);v(e,S.mouse_state!=Ue|0),e.payload.which=S.which,e.payload.coords[0]=S.mouse_curr_x,e.payload.coords[1]=S.mouse_curr_y;break;case Se:var S=A(e.element);if(v(e,0),e.enable_toggle_switch)S.global_selected_obj==e.source_object&&v(e,1);else if(S.mouse_state!=Ue&&S.mouse_select_data.obj==e.source_object)v(e,1);else for(var R=0;R<Ge;++R){var I=S.touch_select_dlist[R];if(I.touch_state!=Ue&&I.obj==e.source_object){v(e,1);break}}break;case re:var S=A(e.element);e.payload=S.downed_keys[e.key],1==e.payload||S.downed_keys[0]&&e.key==Fe?v(e,1):e.payload||v(e,0);break;case oe:var S=A(e.element);if(-1==S.touches_curr_x[1]&&-1==S.touches_curr_y[1]){var m=S.touches_curr_x[0]-S.touches_last_x[0],O=S.touches_curr_y[0]-S.touches_last_y[0],N=Math.sqrt(m*m+O*O);if(-1!=S.touches_last_x[1]&&-1!=S.touches_last_y[1]){var b=S.touches_curr_x[0]-S.touches_last_x[1],Y=S.touches_curr_y[0]-S.touches_last_y[1],L=Math.sqrt(b*b+Y*Y);L<N&&(m=b,O=Y,N=L)}e.payload.gesture=t.PL_SINGLE_TOUCH_MOVE}else{var M=W;M[0]=(S.touches_curr_x[0]+S.touches_curr_x[1])/2,M[1]=(S.touches_curr_y[0]+S.touches_curr_y[1])/2;var y=J;y[0]=(S.touches_last_x[0]+S.touches_last_x[1])/2,y[1]=(S.touches_last_y[0]+S.touches_last_y[1])/2;var m=M[0]-y[0],O=M[1]-y[1],N=Math.sqrt(m*m+O*O);e.payload.gesture=t.PL_MULTITOUCH_MOVE_PAN}switch(e.payload.coords[0]=S.touches_curr_x[0],e.payload.coords[1]=S.touches_curr_y[0],e.axis){case"X":v(e,m);break;case"Y":v(e,O);break;case"XY":v(e,N)}break;case ie:var S=A(e.element),w=S.touch_zoom_curr_dist-S.touch_zoom_last_dist;e.payload=t.PL_MULTITOUCH_MOVE_ZOOM,v(e,w);break;case se:var S=A(e.element);if(-1!=S.touches_curr_x[1]){var C=S.touches_curr_x[0]-S.touches_curr_x[1],D=S.touches_curr_y[0]-S.touches_curr_y[1],G=Math.atan2(D,C);e.payload=t.PL_MULTITOUCH_MOVE_ROTATE,v(e,G-S.touch_start_rot)}break;case ce:var S=A(e.element);e.payload.coords[0]=S.touches_curr_x[0],e.payload.coords[1]=S.touches_curr_y[0],S.is_touch_ended?v(e,0):v(e,1)}}function N(e){var r=0;switch(e.type){case t.CT_POSITIVE:var a=m(e);r=a?1:0;break;case t.CT_CONTINUOUS:var _=e.last_pulse,a=m(e);a?(r=1,e.last_pulse=1):1==_?(r=-1,e.last_pulse=-1):r=0;break;case t.CT_TRIGGER:var _=e.last_pulse,a=m(e);a&&-1==_?(r=1,e.last_pulse=1):a||1!=_?r=0:(r=-1,e.last_pulse=-1);break;case t.CT_SHOT:var _=e.last_pulse,a=m(e);a&&-1==_?(r=1,e.last_pulse=1):a||1!=_?r=0:(r=0,e.last_pulse=-1);break;case t.CT_LEVEL:var a=m(e);e.last_logic_result!=a?(r=1,e.last_logic_result=a):r=0;break;case t.CT_CHANGE:for(var n=e.sensors,o=e.last_sensor_values,i=0;i<n.length;i++){var s=n[i].value;r||s==o[i]||(r=1),o[i]=s}break;default:w.panic("Wrong sensor manifold type: "+e.type)}return r}function g(e){for(var t=0;t<e.length;t++){var r=e[t];switch(r.type){case ae:case _e:case oe:case ie:case se:case ce:case fe:v(r,0)}}}function h(e){for(var t=0;t<e.length;t++)if(!e[t])return e[t];return e[e.length-1]}function R(e){if(e.do_activation){switch(e.type){case Ee:K.append_collision_test(e.collision_obj,e.collision_id,e.collision_cb,e.calc_pos_norm);break;case le:K.apply_collision_impulse_test(e.col_imp_obj,e.col_imp_cb);break;case Te:e.ray_test_id=K.append_ray_test(e.source_object,e.from,e.to,e.collision_id,e.ray_test_cb,!1,!1,e.calc_pos_norm,e.ign_src_rot),e.payload.ray_test_id=e.ray_test_id;break;case fe:e.time_last=B.get_timeline(),e.period<0&&(e.period=-e.period);break;case re:var t=A(e.element);S(t,"keyboard_downed_keys");break;case ae:var t=A(e.element);S(t,"mouse_wheel");break;case _e:var t=A(e.element);S(t,"mouse_down_which"),S(t,"mouse_up_which"),S(t,"mouse_location");break;case Ye:var t=A(e.element);S(t,"mouse_pointerlock");break;case Le:F.activate_pointerlock(e);break;case ne:var t=A(e.element);S(t,"mouse_down_which"),S(t,"mouse_up_which");break;case oe:var t=A(e.element);S(t,"touch_start"),S(t,"touch_move"),S(t,"touch_end");break;case ie:case se:var t=A(e.element);S(t,"touch_start"),S(t,"touch_move");break;case ce:var t=A(e.element);S(t,"touch_start"),S(t,"touch_end");break;case Se:var t=A(e.element);S(t,"mouse_select"),S(t,"touch_select"),S(t,"touch_start"),S(t,"touch_end"),S(t,"mouse_down_which"),S(t,"mouse_up_which");break;case pe:case ve:var t=A(e.element);S(t,"orientation_angles");break;case me:var t=A(e.element);S(t,"orientation_quat");break;case he:case Ie:case be:0==e.gamepad_id?F.get_device_by_type_element(F.DEVICE_GAMEPAD0):1==e.gamepad_id?F.get_device_by_type_element(F.DEVICE_GAMEPAD1):2==e.gamepad_id?F.get_device_by_type_element(F.DEVICE_GAMEPAD2):F.get_device_by_type_element(F.DEVICE_GAMEPAD3)}e.do_activation=!1}}function I(e,t){e=e||Q;var r=e.sensor_manifolds;if(r){var a=e.sensor_manifolds_arr;if(t){var _=r[t];if(_){for(var n=_.sensors,o=0;o<n.length;o++){var i=n[o],s=Y(i,z,q);if(1==s.length){L(i);var c=z.indexOf(i);c>-1?(z.splice(c,1),q.splice(c,1)):w.panic("Sensors cache is corrupted")}else s.length>1&&s.splice(s.indexOf(_),1)}delete r[t];var E=a.indexOf(_);E>-1?a.splice(E,1):w.panic("Incorrect manifolds array"),Object.getOwnPropertyNames(r).length||b(e)}}else{var l=[];for(var T in r)l.push(T);for(var o=0;o<l.length;o++)I(e,l[o])}ee=!0}}function b(e){var t=H.indexOf(e);if(!(t>-1))return void k.error("Wrong object");H.splice(t,1)}function Y(e,t,r){var a=t.indexOf(e);return a>-1?r[a]:[]}function L(e){switch(e.type){case Ee:K.remove_collision_test(e.collision_obj,e.collision_id,e.collision_cb),e.do_activation=!0;break;case le:K.clear_collision_impulse_test(e.col_imp_obj),e.do_activation=!0;break;case Te:K.remove_ray_test(e.ray_test_id),e.do_activation=!0;break;case fe:e.do_activation=!0;break;case re:var t=A(e.element);p(t,"keyboard_downed_keys"),e.do_activation=!0;break;case ae:var t=A(e.element);p(t,"mouse_wheel"),e.do_activation=!0;break;case _e:var t=A(e.element);p(t,"mouse_down_which"),p(t,"mouse_up_which"),p(t,"mouse_location"),e.do_activation=!0;break;case Ye:var t=A(e.element);p(t,"mouse_pointerlock"),e.do_activation=!0;break;case ne:var t=A(e.element);p(t,"mouse_down_which"),p(t,"mouse_up_which"),e.do_activation=!0;break;case oe:var t=A(e.element);p(t,"touch_start"),p(t,"touch_move"),p(t,"touch_end"),e.do_activation=!0;break;case ie:case se:var t=A(e.element);p(t,"touch_start"),p(t,"touch_move"),e.do_activation=!0;break;case ce:var t=A(e.element);p(t,"touch_start"),p(t,"touch_end"),e.do_activation=!0;break;case Se:var t=A(e.element);p(t,"mouse_select"),p(t,"touch_select"),p(t,"touch_start"),p(t,"touch_end"),p(t,"mouse_down_which"),p(t,"mouse_up_which"),e.do_activation=!0;break;case pe:case ve:var t=A(e.element);p(t,"orientation_angles"),e.do_activation=!0;break;case me:var t=A(e.element);p(t,"orientation_quat"),e.do_activation=!0;break;case Oe:case Ne:e.do_activation=!0}}function M(e){var t=e[0],r=e[1],a=t.clientX-r.clientX,_=t.clientY-r.clientY;return Math.sqrt(a*a+_*_)}function y(e){var t=e[0],r=e[1],a=t.clientX-r.clientX,_=t.clientY-r.clientY;return Math.atan2(_,a)}function x(e){if(0==e)var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD0);else if(1==e)var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD1);else if(2==e)var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD2);else var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD3);return t}function U(){return ye*ke}var w=Object(n.a)(e),C=Object(o.a)(e),D=Object(i.a)(e),F=Object(s.a)(e),G=Object(c.a)(e),k=Object(E.a)(e),K=Object(l.a)(e),B=Object(u.a)(e),X=C.controls,j=C.defaults,H=[],Q={},z=[],q=[],V=[],W=new Float32Array(2),J=new Float32Array(2),Z=P.create(),$=T.create(),ee=!1,te=0,re=20,ae=30,_e=40,ne=50,oe=60,ie=70,se=75,ce=80,Ee=90,le=100,Te=110,ue=120,de=130,fe=140,Pe=150,Ae=160,Se=170,pe=180,ve=190,me=200,Oe=210,Ne=220,ge=230,he=240,Re=250,Ie=260,be=270,Ye=280,Le=290;t.CT_POSITIVE=10,t.CT_CONTINUOUS=20,t.CT_TRIGGER=30,t.CT_SHOT=40,t.CT_LEVEL=50,t.CT_CHANGE=60,t.PL_SINGLE_TOUCH_MOVE=0,t.PL_MULTITOUCH_MOVE_ZOOM=1,t.PL_MULTITOUCH_MOVE_PAN=2,t.PL_MULTITOUCH_MOVE_ROTATE=3;var Me=.3,ye=.1,xe=.01,Ue=0,we=1,Ce=2,De=3,Fe=16,Ge=10,ke=1;t.update=function(e,t){for(var r=0;r<V.length;r++){var n=V[r];a(n)}for(var r=0;r<z.length;r++){O(z[r],e,t)}for(var r=0;r<H.length;r++)for(var o=H[r],i=o.sensor_manifolds_arr,s=0;s<i.length;s++){var c=i[s];if(c.update_counter!=te){c.update_counter=te;var E=N(c);if(E){var l=o==Q?null:o;if(ee=!1,c.callback(l,c.id,E,c.callback_param),ee){r=-1;break}}}}for(var r=0;r<H.length;r++)for(var o=H[r],i=o.sensor_manifolds_arr,s=0;s<i.length;s++){var c=i[s];g(c.sensors)}for(var r=0;r<V.length;r++){var n=V[r];_(n)}te++},t.create_custom_sensor=function(e){var t=r(10);return v(t,e),t},t.create_keyboard_sensor=function(e){var t=document,a=r(re,t);return a.key=e,a.do_activation=!0,a},t.create_gamepad_btn_sensor=function(e,t){var a=document,_=r(he,a);return t=t||F.get_first_gmpd_id(),_.gamepad_id=t,_.key=e,_.do_activation=!0,_},t.create_gamepad_axis_sensor=function(e,t){var a=document,_=r(Re,a);return t=void 0==t?F.get_first_gmpd_id():t,_.gamepad_id=t,_.key=e,_.do_activation=!0,_},t.create_gamepad_position_sensor=function(e){var t=document,a=r(Ie,t);return e=void 0===e?F.get_first_gmpd_id():e,a.gamepad_id=e,a.do_activation=!0,a.payload=P.create(),a},t.create_gamepad_orientation_sensor=function(e){var t=document,a=r(be,t);return e=void 0===e?F.get_first_gmpd_id():e,a.gamepad_id=e,a.do_activation=!0,a.payload=T.create(),a},t.create_collision_sensor=function(e,t,a){if(!e||!K.obj_has_physics(e))return k.error("Wrong collision object"),null;var _=r(Ee);return _.collision_obj=e,_.collision_id=t,_.calc_pos_norm=a,_.payload={coll_obj:null,coll_pos:a?new Float32Array(3):null,coll_norm:a?new Float32Array(3):null,coll_dist:0},_.collision_cb=function(e,t,r,a,n){v(_,e);var o=_.payload;o.coll_obj=t,_.calc_pos_norm&&(o.coll_pos.set(r),o.coll_norm.set(a),o.coll_dist=n)},_.do_activation=!0,_},t.create_collision_impulse_sensor=function(e){if(!e||!e.physics)return k.error("Wrong collision impulse object"),null;var t=r(le);return t.col_imp_obj=e,t.col_imp_cb=function(e){v(t,e)},t.do_activation=!0,t},t.create_ray_sensor=function(e,t,a,_,n,o,i){var s=r(Te);return s.source_object=e,s.from=t,s.to=a,s.collision_id=_,s.is_binary_value=n,s.calc_pos_norm=o,s.ign_src_rot=i,s.payload={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),ray_test_id:0},s.ray_test_cb=function(e,t,r,a,_,n){s.is_binary_value?v(s,-1==t?0:1):v(s,t),s.payload.hit_fract=t,s.payload.obj_hit=r,s.payload.hit_time=a,s.calc_pos_norm&&(s.payload.hit_pos.set(_),s.payload.hit_norm.set(n))},s.do_activation=!0,s},t.create_mouse_click_sensor=function(e){var t=r(ne,e);return t.do_activation=!0,t.payload={coords:new Float32Array(2),which:null},t},t.create_mouse_wheel_sensor=function(e){var t=r(ae,e);return t.do_activation=!0,t},t.create_mouse_move_sensor=function(e,t){var a=r(_e,t);return a.axis=e||"XY",a.payload={coords:new Float32Array(2)},a.do_activation=!0,a},t.create_touch_move_sensor=function(e,t){var a=r(oe,t);return a.axis=e||"XY",a.payload={coords:new Float32Array(2),gesture:0},a.do_activation=!0,a},t.create_touch_zoom_sensor=function(e){var t=r(ie,e);return t.payload=0,t.do_activation=!0,t},t.create_touch_rotate_sensor=function(e){var t=r(se,e);return t.payload=0,t.do_activation=!0,t},t.create_touch_click_sensor=function(e){var t=r(ce,e);return t.payload={coords:new Float32Array(2)},t.do_activation=!0,t},t.create_motion_sensor=function(){var e=T.create(),t=P.create();return function(a,_,n){if(!a)return k.error("Wrong collision object"),null;var o=r(ue);o.source_object=a;var i=d.j(a.render.world_tsr,t),s=d.g(a.render.world_tsr,e);return o.quat_temp=new Float32Array(4),o.trans_last=new Float32Array(i),o.quat_last=new Float32Array(s),o.avg_linear_vel=0,o.avg_angular_vel=0,o.threshold=_||.1,o.rotation_threshold=n||.1,o.time_last=0,o.payload=new Float32Array([0,0]),o}}(),t.create_vertical_velocity_sensor=function(){var e=T.create(),t=P.create();return function(a,_){if(!a)return k.error("Wrong collision object"),null;var n=r(de);n.source_object=a;var o=d.j(a.render.world_tsr,t),i=d.g(a.render.world_tsr,e);return n.trans_last=new Float32Array(o),n.quat_last=new Float32Array(i),n.avg_vertical_vel=0,n.threshold=_||1,n.time_last=0,n.payload=0,n}}(),t.create_timer_sensor=function(e,t){var a=r(fe);return a.period=e,a.repeat=t,a.do_activation=!0,a},t.reset_timer_sensor=function(e,t,r,a){e=e||Q;var _=e.sensor_manifolds;if(!_||!_[t])return k.error("reset_timer_sensor(): wrong object"),null;var n=_[t].sensors[r];if(!n)return k.error("reset_timer_sensor(): sensor not found"),null;n.time_last=B.get_timeline(),n.period=a},t.create_elapsed_sensor=function(){var e=r(Pe);return e.time_last=0,e},t.create_gyro_delta_sensor=function(){var e=r(pe,window);return e.payload=new Float32Array(3),F.get_device_by_type_element(F.DEVICE_GYRO)?v(e,1):v(e,0),e.do_activation=!0,e},t.create_gyro_angles_sensor=function(){var e=r(ve,window);return e.payload=new Float32Array(3),F.get_device_by_type_element(F.DEVICE_GYRO)?v(e,1):v(e,0),e.do_activation=!0,e},t.create_gyro_quat_sensor=function(){var e=r(me,window);return e.payload=T.create(),F.get_device_by_type_element(F.DEVICE_GYRO)?v(e,1):v(e,0),e.do_activation=!0,e},t.create_hmd_quat_sensor=function(){var e=r(Oe,window);return e.payload=T.create(),F.get_device_by_type_element(F.DEVICE_HMD)?v(e,1):v(e,0),e.do_activation=!0,e},t.create_hmd_position_sensor=function(){var e=r(Ne,window);return e.payload=P.create(),F.get_device_by_type_element(F.DEVICE_HMD)?v(e,1):v(e,0),e.do_activation=!0,e},t.create_timeline_sensor=function(){return r(Ae)},t.create_selection_sensor=function(e,t){var a=r(Se);return a.source_object=e,a.enable_toggle_switch=t,a.do_activation=!0,a},t.create_callback_sensor=function(e,t){var a=r(ge);return a.callback=e,v(a,t),a},t.create_plock_mouse_sensor=function(e){var t=r(Ye,e);return t.payload={coords:new Float32Array(2)},t.do_activation=!0,t},t.create_plock_sensor=function(e){var t=r(Le,e);return t.do_activation=!0,t},t.sensor_set_value=v,t.get_sensor_value=function(e,t,r){e=e||Q;var a=e.sensor_manifolds;if(!a||!a[t])return k.error("get_sensor_value(): wrong object"),null;var _=a[t].sensors[r];return _?_.value:(k.error("get_sensor_value(): sensor not found"),null)},t.get_sensor_payload=function(e,t,r){e=e||Q;var a=e.sensor_manifolds;if(!a||!a[t])return k.error("get_sensor_payload(): wrong object"),null;var _=a[t].sensors[r];return _?_.payload:(k.error("get_sensor_payload(): sensor not found"),null)},t.cleanup=function(){H=[],Q={};for(var e=0;e<z.length;e++)L(z[e]);z.length=0,q.length=0},t.check_sensor_manifold=function(e,t){if(e=e||Q,!e.sensor_manifolds)return!1;if(t&&e.sensor_manifolds[t])return!0;if(t)return!1;for(var r in e.sensor_manifolds)return!0;return!1},t.create_sensor_manifold=function(e,t,r,a,_,n,o){e=e||Q,e.sensor_manifolds_arr=e.sensor_manifolds_arr||[],e.sensor_manifolds=e.sensor_manifolds||{};var i=e.sensor_manifolds,s=e.sensor_manifolds_arr;i[t]&&I(e,t);var c={id:t,type:r,sensors:a.slice(0),logic_fun:_,sensor_values:new Array(a.length),callback:n,callback_param:o,last_pulse:-1,last_logic_result:0,last_sensor_values:new Array(a.length),update_counter:-1};i[t]=c,s.push(c),-1==H.indexOf(e)&&H.push(e);for(var E=0;E<c.sensors.length;E++){var l=c.sensors[E];R(l);var T=z.indexOf(l);-1==T?(z.push(l),q.push([c])):q[T].push(c)}ee=!0},t.default_AND_logic_fun=h,t.default_OR_logic_fun=function(e){for(var t=0;t<e.length;t++)if(e[t])return e[t];return e[e.length-1]},t.remove_sensor_manifold=I,t.reset=function(){for(var e=0;e<H.length;e++){var t=H[e],r=t.sensor_manifolds,a=t.sensor_manifolds_arr;for(var _ in r)delete r[_];a.length=0}for(var e=0;e<z.length;e++)L(z[e]);H.length=0,z.length=0,q.length=0},t.debug=function(){k.log(String(H.length)+" objects with manifolds",H),k.log(String(z.length)+" sensors",z);for(var e=[],t=[],r=0;r<z.length;r++){var a=z[r];a.type==Ee&&e.push(a),a.type==Te&&t.push(a)}k.log(String(e.length)+" collision sensors",e),k.log(String(t.length)+" ray sensors",t)},t.set_plock_smooth_factor=function(e){ke=e}}var _=r(0),n=r(5),o=r(4),i=r(15),s=r(42),c=r(12),E=r(1),l=r(19),T=r(8),u=r(18),d=r(6),f=r(2),P=r(3),A=Object(_.a)("__controls",a);t.a=A},function(e,t,r){"use strict";function a(e,t){function r(e,t,r,a,_){return i.V(e,a[r[0]],a[r[1]],a[r[2]])}function a(e,t,r,a,_){var n=Math.abs(e[2]-t[2]);return n<_&&l.is_vector_in_poly(e,r,a)?n:Number.MAX_VALUE}function _(e,t,a){if(a||(a=r),!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);var _=e.physics.navmesh;return _?l.navmesh_get_island(_,t,a):(E.error(e.name+" is not a navigation mesh object"),null)}var c=Object(n.a)(e),E=Object(o.a)(e),l=Object(s.a)(e);t.CM_WALK=0,t.CM_RUN=1,t.CM_CLIMB=2,t.CM_FLY=3,t.enable_simulation=function(e){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.enable_simulation(e)},t.disable_simulation=function(e){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.disable_simulation(e)},t.has_physics=function(e){return c.obj_has_physics(e)},t.has_simulated_physics=function(e){return c.has_simulated_physics(e)},t.has_dynamic_physics=function(e){return c.has_dynamic_physics(e)},t.set_gravity=function(e,t){if(E.error_deprecated("set_gravity","set_object_gravity"),!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_gravity(e,0,0,-t)},t.set_object_gravity=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_gravity(e,t[0],t[1],t[2])},t.set_transform=function(e,t,r){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_transform(e,t,r)},t.sync_transform=function(e){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.sync_transform(e)},t.apply_velocity=function(e,t,r,a){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.apply_velocity(e,t,r,a)},t.apply_velocity_world=function(e,t,r,a){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.apply_velocity_world(e,t,r,a)},t.apply_force=function(e,t,r,a){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.apply_force(e,t,r,a,!1)},t.apply_force_world=function(e,t,r,a){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.apply_force(e,t,r,a,!0)},t.apply_torque=function(e,t,r,a){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.apply_torque(e,t,r,a)},t.set_angular_velocity=function(e,t,r,a){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_angular_velocity(e,t,r,a)},t.vehicle_throttle=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)||E.error("Wrong object"),c.vehicle_throttle(e,i.M(t,-1,1))},t.vehicle_throttle_inc=function(e,t,r){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)||E.error("Wrong object"),t=i.M(t,0,1);var a=e.vehicle,_=a.engine_force;-1==r||1==r?(_+=r*t,_=Math.max(-1,Math.min(_,1))):0==r&&_>=0?(_-=t,_=Math.max(0,_)):0==r&&_<0?(_+=t,_=Math.min(0,_)):E.error("Wrong steering direction"),c.vehicle_throttle(e,i.M(_,-1,1))},t.vehicle_steer=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)||E.error("Wrong object"),c.vehicle_steer(e,i.M(t,-1,1))},t.vehicle_steer_inc=function(e,t,r){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)||E.error("Wrong object"),t=i.M(t,0,1);var a=e.vehicle,_=a.steering;-1==r||1==r?(_+=r*t,_=Math.max(-1,Math.min(_,1))):0==r&&_>=0?(_-=t,_=Math.max(0,_)):0==r&&_<0?(_+=t,_=Math.min(0,_)):E.error("Wrong steering direction"),c.vehicle_steer(e,i.M(_,-1,1))},t.vehicle_brake=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)||E.error("Wrong object"),c.vehicle_brake(e,i.M(t,0,1))},t.vehicle_brake_inc=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)||E.error("Wrong object"),t=i.M(t,-1,1);var r=e.vehicle,a=r.brake_force;a+=a*t,c.vehicle_brake(e,i.M(a,0,1))},t.is_vehicle_chassis=function(e){return c.is_vehicle_chassis(e)},t.is_vehicle_hull=function(e){return c.is_vehicle_hull(e)},t.get_vehicle_name=function(e){return c.obj_has_physics(e)?c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)?e.vehicle_settings.name:(E.error("Wrong object"),null):(E.error_once("No physics for object "+e.name),null)},t.get_vehicle_throttle=function(e){return c.obj_has_physics(e)?c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)?e.vehicle.engine_force:(E.error("Wrong object"),null):(E.error_once("No physics for object "+e.name),null)},t.get_vehicle_steering=function(e){return c.obj_has_physics(e)?c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)?e.vehicle.steering:(E.error("Wrong object"),0):(E.error_once("No physics for object "+e.name),0)},t.get_vehicle_brake=function(e){return c.obj_has_physics(e)?c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)?e.vehicle.brake_force:(E.error("Wrong object"),0):(E.error_once("No physics for object "+e.name),0)},t.get_vehicle_speed=function(e){return c.obj_has_physics(e)?c.is_vehicle_chassis(e)||c.is_vehicle_hull(e)?c.get_vehicle_speed(e):(E.error("Wrong object"),0):(E.error_once("No physics for object "+e.name),0)},t.is_character=function(e){return c.has_character_physics(e)},t.set_character_move_dir=function(e,t,r){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_move_dir(e,t,r)},t.set_character_move_type=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_move_type(e,t)},t.set_character_walk_velocity=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_walk_velocity(e,t)},t.set_character_run_velocity=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_run_velocity(e,t)},t.set_character_fly_velocity=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_fly_velocity(e,t)},t.character_jump=function(e){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.character_jump(e)},t.character_rotation_inc=function(e,t,r){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.character_rotation_inc(e,t,r)},t.set_character_rotation=function(e,t,r){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_rotation(e,t,r)},t.set_character_rotation_v=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_rotation_v(e,t)},t.set_character_rotation_h=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_rotation_h(e,t)},t.set_character_vert_move_dir_angle=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.set_character_vert_move_dir_angle(e,t)},t.append_collision_test=function(e,t,r,a){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);t=t||"ANY",a=a||!1,c.append_collision_test(e,t,r,a)},t.remove_collision_test=function(e,t,r){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);t=t||"ANY",c.remove_collision_test(e,t,r)},t.apply_collision_impulse_test=function(e,t){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.apply_collision_impulse_test(e,t)},t.clear_collision_impulse_test=function(e){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);c.clear_collision_impulse_test(e)},t.append_ray_test=function(e,t,r,a,_,n){if(null!=(e=e||null)&&!c.obj_has_physics(e))return E.error_once("No physics for object "+e.name),0;a=a||"ANY",n=n||!1;return c.append_ray_test(e,t,r,a,_,n,!1,!1,!1)},t.append_ray_test_ext=function(e,t,r,a,_,n,o,i,s){return null==(e=e||null)||c.obj_has_physics(e)?(a=a||"ANY",n=n||!1,o=o||!1,i=i||!1,s=s||!1,c.append_ray_test(e,t,r,a,_,n,o,i,s)):(E.error_once("No physics for object "+e.name),0)},t.remove_ray_test=function(e){if(!c.is_ray_test(e))return void E.error("Wrong ray test ID");c.remove_ray_test(e)},t.change_ray_test_from_to=function(e,t,r){if(!c.is_ray_test(e))return void E.error("Wrong ray test ID");c.change_ray_test_from_to(e,t,r)},t.apply_constraint=function(e,t,r,a,_,n,o,i,s,l){if(!c.obj_has_physics(t)||!c.obj_has_physics(_))return void E.error("Wrong objects");c.apply_constraint(e,t,r,a,_,n,o,i,s,l)},t.clear_constraint=function(e){if(!c.obj_has_physics(e)||!c.has_constraint(e))return void E.error("Wrong object");c.clear_constraint(e)},t.pull_to_constraint_pivot=function(e,t,r,a,_,n){if(!c.obj_has_physics(e)||!c.obj_has_physics(a))return void E.error("Wrong objects");c.pull_to_constraint_pivot(e,t,r,a,_,n)},t.navmesh_get_island=_,t.navmesh_find_path=function(e,t,_,n){if(!c.obj_has_physics(e))return void E.error_once("No physics for object "+e.name);var o=e.physics.navmesh;if(!o)return E.error(e.name+" is not a navigation mesh object"),null;n=n||{};var i={};return i.do_not_pull_string=Boolean(n.do_not_pull_string),i.distance_to_closest=n.distance_to_closest||r,i.distance_to_farthest=n.distance_to_farthest||a,i.island=n.island||0,i.allowed_distance=n.allowed_distance||Number.MAX_VALUE,i.return_normals=n.return_normals||!1,l.navmesh_find_path(o,t,_,i)},t.sync_bounding=function(e,t){t||(t=e.scenes_data[0].scene),c.scene_has_physics(t)&&c.sync_bounding(e,t)},t.sync_mesh=function(e,t){t||(t=e.scenes_data[0].scene),c.scene_has_physics(t)&&c.sync_mesh(e,t)}}var _=r(0),n=r(19),o=r(1),i=r(2),s=r(80),c=Object(_.a)("physics",a);t.a=c},function(e,t,r){"use strict";function a(e,t){function r(e){function t(){$=!1,o.style.visibility="visible"}if(!$&&!W){var r=J;if(r){if("visible"==r.lastElementChild.style.visibility)return _(),void(J=null);if(1==r.style.opacity){var a=r.lastElementChild,n=r.firstElementChild,o=a.firstElementChild,i=Math.ceil(a.getBoundingClientRect().width),s=Math.ceil(a.getBoundingClientRect().height),c=Math.ceil(n.getBoundingClientRect().width),E=Math.ceil(n.getBoundingClientRect().height);a.style.position="absolute",a.style.visibility="visible";var l=!0,T=!0;n.style.display="none",$=!0,c!=i?Q.animate(c,i,200,function(e){e==i&&(l=!1,T||t()),a.style.width=e+"px"}):(l=!1,T||($=!1)),E!=s?Q.animate(E,s,200,function(e){e==s&&(T=!1,l||t()),a.style.height=e+"px"}):(T=!1,l||($=!1))}}}}function a(){Z=!0,F.get_container().addEventListener("mouseup",r)}function _(){var e=J.lastElementChild;J.firstElementChild.style.display="",e.style.visibility="hidden",e.style.position="relative",e.firstElementChild.style.visibility="hidden"}function v(e){var t=e.obj,r=F.get_container(),a=k.get_meta_tags(t),_=t.name,n="",o=document.createElement("div"),i=o.cloneNode(!1),s=document.createElement("span");return O(o),m(i),o.style.visibility="hidden",a&&(n=a.description||n,_=a.title||_),s.innerHTML=_,h(s),N(s),s.style.whiteSpace="nowrap",i.appendChild(s),o.appendChild(i),n&&R(n,o,e.annotation_max_width),r.appendChild(o),o}function m(e){e.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;"}function O(e){e.style.cssText+="position:        absolute;height:          0;top:             0;left:            0;transform-style: preserve-3d;"}function N(e){e.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}function g(e){e.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;"}function h(e){e.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;"}function R(e,t,r){var a=document.createElement("div"),n=document.createElement("span");r&&(a.style.maxWidth=r+"px"),g(a),N(n),n.innerHTML=e,a.style.visibility="hidden",n.style.visibility="hidden",a.appendChild(n),t.appendChild(a),G.add_click_listener(t,function(e){$||t!=J&&1==t.style.opacity&&(W||(J&&"visible"==J.lastElementChild.style.visibility&&_(),J=t))})}function I(){for(var e=0,t=0;t<V.length;t++)V[t].detect_visibility&&e++;ee=new Float32Array(3*e)}function b(e,t){return t.depth-e.depth}function Y(e,t,r){var a=e.element;q.ie_edge_anchors_floor_hack&&(t=Math.floor(t),r=Math.floor(r)),"transform"in a.style?a.style.transform="translate3d("+t+"px, "+r+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+t+"px, "+r+"px, 0px)":(a.style.left=t+"px",a.style.top=r+"px")}function L(e){var t=j.get_subs(j.get_main(),H.ANCHOR_VISIBILITY),r=t.camera,a=F.canvas_to_viewport_coords(e.x,e.y,re,r);return X.read_pixels(r.framebuffer,a[0],r.height-a[1],2,2,te),te[0]+te[4]+te[8]+te[12]>=255?"visible":"out"==e.appearance||te[0]+te[4]+te[8]+te[12]==0?"covered":e.appearance}function M(e){F.get_container().removeChild(e.element)}function y(e){for(var t=0;t<V.length;t++)if(V[t].obj==e)return!0;return!1}function x(e,t,r){if(e.element)var a=Math.round(e.element.offsetWidth)||0,_=Math.round(e.element.offsetHeight)||0;else var a=0,_=0;var n=e.x,o=e.y;return t>=n&&t<=n+a&&r<o&&r>=o-_}function U(e,t){if(!e.is_lod)return!0;var r=e.lod_dist_min,a=e.lod_dist_max;return!(t<r)&&(a==K.LOD_DIST_MAX_INFINITY||t<a)}var w=Object(n.a)(e),C=Object(o.a)(e),D=Object(i.a)(e),F=Object(s.a)(e),G=Object(c.a)(e),k=Object(E.a)(e),K=Object(l.a)(e),B=Object(T.a)(e),X=Object(u.a)(e),j=Object(d.a)(e),H=Object(f.a)(e),Q=Object(P.a)(e),z=Object(A.a)(e),q=D.defaults,V=[],W=!1,J=null,Z=!1,$=!1,ee=new Float32Array(0),te=new Uint8Array(16),re=new Float32Array(2),ae=new Float32Array(3),_e=new Float32Array(3);t.append=function(e){if(!y(e)){var t=e.anchor.detect_visibility&&Boolean(j.get_subs(j.get_main(),H.ANCHOR_VISIBILITY)),r={type:e.anchor.type,obj:e,x:0,y:0,depth:0,appearance:"out",detect_visibility:t,element:null,move_cb:null,annotation_max_width:e.anchor.max_width,element_id:e.anchor.element_id};switch(r.type){case"ANNOTATION":r.element=v(r);break;case"ELEMENT":if(r.element=document.getElementById(e.anchor.element_id),r.element)for(var _=0;_<V.length;_++)"ELEMENT"==V[_].type&&V[_].element_id==e.anchor.element_id&&(B.warn("Anchor with the id '"+e.anchor.element_id+"' already exists, making the new anchor generic."),r.type="GENERIC");else B.warn("Anchor HTML element with the id '"+e.anchor.element_id+"' was not found, making it generic."),r.type="GENERIC"}V.push(r),I(),Z||a()}},t.remove=function(e){for(var t=0;t<V.length;t++){var r=V[t];if(r.obj==e){"ANNOTATION"==r.type&&M(r),V.splice(t,1),I(),t--;break}}},t.update=function(e){for(var t=0,r=V.length;r--;){var a=V[r];if(a.detect_visibility){var _=S.j(a.obj.render.world_tsr,ae);ee.set(_,3*t++)}var n=ne(a,ae),o=n[0],i=n[1],s=n[2];if(e||o!=a.x||i!=a.y||s!=a.depth){switch(a.type){case"ANNOTATION":var c=o,E=i;Y(a,c,E);break;case"ELEMENT":var l=a.element.getBoundingClientRect(),c=o-l.width/2,E=i-l.height/2;Y(a,c,E)}a.x=o,a.y=i,a.depth=s,a.move_cb&&a.move_cb(o,i,a.appearance,a.obj,a.element)}}V.sort(b);for(var r=0;r<V.length;r++){var a=V[r];"GENERIC"!=a.type&&(J==a.element?a.element.style.zIndex=V.length:a.element.style.zIndex=r)}if(t>0){var T=j.get_subs(j.get_main(),H.ANCHOR_VISIBILITY),u=T.draw_data[0].bundles[0],d=u.batch;w.update_anchor_visibility_batch(d,ee),H.append_draw_data(T,u)}};var ne=function(){var e=p.create();return function(t,r){var a=j.get_camera(j.get_main()),_=S.j(t.obj.render.world_tsr,e);return C.project_point(a,_,r),S.v(_,t.obj.render.world_tsr),r}}();t.update_visibility=function(){for(var e=F.get_container(),t=j.get_active(),r=j.get_subs(t,H.STEREO),a=Boolean(r&&r.enable_hmd_stereo),n=V.length;n--;){var o=V[n],i=o.obj,s=i.render,c=o.x,E=o.y,l=o.depth,T=j.get_camera(j.get_main()),u=z.get_translation(i,ae),d=z.get_translation(T,_e),f=p.dist(u,d);if(c<0||E<0||l<0||l>1||j.is_hidden(i)||c>=e.clientWidth||E>=e.clientHeight||!U(s,f))var P="out";else var P="visible";if(o.detect_visibility&&"out"!=P&&(P=L(o)),a&&(P="out"),P!=o.appearance){switch(o.type){case"ANNOTATION":case"ELEMENT":var A=o.element;if(!A)break;"out"==P?(A.style.visibility="hidden",A.children.length&&(A.children[0].style.visibility="hidden")):"visible"==P?(A.style.visibility="visible",A.children.length&&(A.children[0].style.visibility="visible"),A.style.opacity=1):(A.style.visibility="visible",A.style.opacity=.1,A.children.length&&(A.children[0].style.visibility="visible"),"ANNOTATION"==o.type&&A.children.length>1&&"visible"==A.lastElementChild.style.visibility&&(_(),A==J&&(J=null)))}o.appearance=P,o.move_cb&&o.move_cb(c,E,o.appearance,i,A)}}},t.attach_move_cb=function(e,t){for(var r=0;r<V.length;r++)V[r].obj==e&&(V[r].move_cb=t)},t.detach_move_cb=function(e){for(var t=0;t<V.length;t++)V[t].obj==e&&(V[t].move_cb=null)},t.cleanup=function(){for(var e=0;e<V.length;e++){var t=V[e];"ANNOTATION"==t.type&&M(t)}V.length=0},t.is_anchor=y,t.get_element_id=function(e){for(var t=0;t<V.length;t++)if(V[t].obj==e)return V[t].element_id;return!1},t.pause=function(){W=!0},t.resume=function(){W=!1},t.pick_anchor=function(e,t){for(var r=-1,a=0;a<V.length;a++)if("visible"==V[a].appearance&&x(V[a],e,t))if(r<0){var _=V[a].depth;r=a}else V[a].depth<_&&(r=a,_=V[a].depth);return r<0?null:V[r].obj}}var _=r(0),n=r(16),o=r(14),i=r(4),s=r(15),c=r(42),E=r(12),l=r(9),T=r(1),u=r(22),d=r(10),f=r(11),P=r(18),A=r(13),S=r(6),p=r(3),v=Object(_.a)("__anchors",a);t.a=v},function(e,t,r){"use strict";function a(){return{bone_index:0,vgroup_index:-1,parent_bone_ptr:null,descend_bones_ptrs:[],chain:[],constraint:null,tsr_bone_rest:E.b(),tsr_bone_pose:E.b(),tsr_local_rest:E.b(),tsr_local_rest_i:E.b(),tsr_local_pose:E.b(),tsr_local_pose_b:E.b(),tsr_local_pose_a:E.b(),tsr_basis:E.b(),tsr_channel_cache:E.b(),tsr_channel_cache_valid:!1,tail:new Float32Array(3)}}function _(e,t){for(var r=e.data.bones,_=e.pose.bones,n={},o=0;o<_.length;o++){var i=_[o],s=i.bone,l=s.name,d=n[l]=a(),P=new Float32Array(s.matrix_local),A=new Float32Array(16);T.invert(P,A);var S=new Float32Array(i.matrix_basis),p=d.tail;u.subtract(c._1(s.tail_local),c._1(s.head_local),p),c._68(p,A,p),E.d(P,d.tsr_local_rest),E.d(S,d.tsr_basis),E.a(d.tsr_local_rest,d.tsr_local_pose),E.p(d.tsr_local_rest,d.tsr_local_rest_i)}for(var o=0;o<r.length;o++){var v=r[o],l=v.name,i=c._19("name",l,_),d=n[l],m=i.parent_recursive;d.chain.push(d);for(var O=0;O<m.length;O++){var N=m[O],g=N.name,h=n[g];d.chain.push(h)}if(m.length){var N=m[0],g=N.name,h=n[g];d.parent_bone_ptr=h,E.p(h.tsr_local_rest,f),E.q(f,d.tsr_local_rest,d.tsr_bone_rest),h.descend_bones_ptrs.push(d)}else E.a(d.tsr_local_rest,d.tsr_bone_rest);d.bone_index=o,d.name=l,E.q(d.tsr_bone_rest,d.tsr_basis,d.tsr_bone_pose)}t.render.bone_pointers=n}function n(e,t,r,a,_){var n=e.render,o=n.frame_factor,i=n.bone_pointers[t],s=i.bone_index,c=i.tsr_local_rest,T=A,u=n.trans_before,d=n.trans_after,v=n.quats_before,m=n.quats_after,O=u[4*s],N=u[4*s+1],g=u[4*s+2],h=u[4*s+3],R=d[4*s],I=d[4*s+1],b=d[4*s+2],Y=d[4*s+3];T[0]=(1-o)*O+o*R,T[1]=(1-o)*N+o*I,T[2]=(1-o)*g+o*b,T[3]=(1-o)*h+o*Y;var L=S,M=p;L[0]=v[4*s],L[1]=v[4*s+1],L[2]=v[4*s+2],L[3]=v[4*s+3],M[0]=m[4*s],M[1]=m[4*s+1],M[2]=m[4*s+2],M[3]=m[4*s+3],l.slerp(L,M,o,L);var y=f;if(E.w(T,y),E.r(L,y),r){var x=P;E.G(c,i.tail,x),E.q(y,x,y)}else E.q(y,c,y);if(a){var U=i.parent_bone_ptr;if(U){var w=U.tsr_local_pose,C=P;E.p(w,C),E.q(C,y,y)}var D=i.tsr_bone_rest,F=P;E.p(D,F),E.q(F,y,y)}E.a(y,_)}function o(e,t,r,a){var _=e.render,n=_.bone_pointers[t],o=_.trans_before,s=_.quats_before;a?E.q(n.tsr_bone_rest,r,n.tsr_bone_pose):E.a(r,n.tsr_local_pose),v(n,a,o,s),_.frame_factor=0,i(e)}function i(e){for(var t=e.render,r=t.skinned_renders,a=t.mesh_to_arm_bone_maps,_=0;_<r.length;_++){for(var n=r[_],o=a[_],i=0;i<o.length;i+=2)for(var s=o[i],c=o[i+1],E=0;E<4;E++)n.quats_before[s+E]=t.quats_before[c+E],n.quats_after[s+E]=t.quats_after[c+E],n.trans_before[s+E]=t.trans_before[c+E],n.trans_after[s+E]=t.trans_after[c+E];n.frame_factor=t.frame_factor}}function s(e,t){return t in e.render.bone_pointers}t.e=_,t.b=n,t.c=o,t.f=i,r.d(t,"d",function(){return v}),t.a=s;var c=r(2),E=r(6),l=r(8),T=r(21),u=r(3),d=r(7),f=E.b(),P=E.b(),A=new Float32Array(4),S=new Float32Array(4),p=new Float32Array(4),v=function(){var e=l.create(),t=E.b(),r=E.b(),a=d.create();return function _(n,o,i,s){var c=n.tsr_bone_pose,l=n.tsr_local_rest,T=n.tsr_local_pose,u=n.parent_bone_ptr;if(u){var d=u.tsr_local_pose;if(o)E.q(d,c,T);else{var f=r;E.p(d,f),E.q(f,T,c)}}else o?E.a(c,T):E.a(T,c);var P=t;E.p(l,P),E.q(T,P,P);var A=n.bone_index;E.l(P,a),i[4*A]=a[0],i[4*A+1]=a[1],i[4*A+2]=a[2],i[4*A+3]=a[3],E.g(P,e),s[4*A]=e[0],s[4*A+1]=e[1],s[4*A+2]=e[2],s[4*A+3]=e[3];for(var S=n.descend_bones_ptrs,p=0;p<S.length;p++){var v=S[p];v.constraint||_(v,!0,i,s)}}}()},function(e,t,r){"use strict";function a(e){var t={name:"",type:e,use_diffuse:!1,use_specular:!1,prev_direction:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),color_intensity:new Float32Array(3),energy:0,default_energy:0,distance:0,use_sphere:!1,spot_size:0,spot_blend:0,clip_start:.1,clip_end:30,falloff_type:"",generate_shadows:!1,need_sun_fog_update:!1,dynamic_intensity:!1};return t.use_diffuse=!0,t.use_specular=!0,t.energy=1,t.distance=25,t.falloff_type="INVERSE_SQUARE",t}function _(e,t){e.color[0]=t[0],e.color[1]=t[1],e.color[2]=t[2],c(e)}function n(e,t){e.spot_blend=t}function o(e,t){e.distance=t}function i(e,t){e.spot_size=t}function s(e,t){e.energy=t,c(e)}function c(e){u.scale(e.color,e.energy,e.color_intensity)}r.d(t,"a",function(){return d}),t.b=_,t.e=n,t.c=o,t.f=i,t.d=s,r.d(t,"g",function(){return f});var E=r(8),l=r(6),T=r(2),u=r(3),d=(new Float32Array(3),function(){var e=E.create(),t=u.create();return function(r,_){var n=r.data,o=_.light=a(n.type);o.name=_.name,o.use_diffuse=n.use_diffuse,o.use_specular=n.use_specular;var i=l.g(_.render.world_tsr,e),s=T._34(i,T.f,t);u.normalize(s,s),o.direction.set(s),o.color[0]=n.color[0],o.color[1]=n.color[1],o.color[2]=n.color[2],o.energy=o.default_energy=n.energy,c(o),o.distance=n.distance,o.use_sphere=n.use_sphere,o.clip_start=n.clip_start,o.clip_end=n.clip_end,"POINT"!==o.type&&"SPOT"!==o.type||(o.distance=n.distance),"SPOT"===o.type?(o.spot_blend=n.spot_blend,o.spot_size=n.spot_size):"POINT"===o.type&&(o.spot_size=Math.PI/2),o.generate_shadows=n.b4w_generate_shadows,o.dynamic_intensity=n.b4w_dynamic_intensity}}()),f=function(){var e=E.create();return function(t){var r=t.light;if(r){var a=l.g(t.render.world_tsr,e);if(T._34(a,T.f,r.direction),u.normalize(r.direction,r.direction),"SUN"==r.type){var _=Math.acos(u.dot(r.prev_direction,T.n)),n=Math.acos(u.dot(r.direction,T.n)),o=Math.floor(_/.025),i=Math.floor(n/.025);r.need_sun_fog_update=o!=i}u.copy(r.direction,r.prev_direction)}}}()},function(e,t,r){"use strict";function a(e,t){function r(e,t){var r=[];J.traverse_edges(e,function(t,a,_){var n=_;r.indexOf(n)>-1?J.replace_edge_attr(e,t,a,n,w(n)):r.push(n)}),J.traverse(e,function(e,a){for(var _=a,n=0;n<_.slinks_internal.length;n++){var o=_.slinks_internal[n];t||_.type!=$.MAIN_PLANE_REFLECT&&_.type!=$.MAIN_CUBE_REFLECT&&_.type!=$.MAIN_XRAY||(o.use_renderbuffer=!0),r.indexOf(o)>-1?_.slinks_internal[n]=w(o):r.push(o)}})}function a(e,t){J.traverse(e,function(r,a){a.type==$.ANTIALIASING&&J.traverse_inputs(e,r,function(e,t,r){var a=t;if(a.type==$.MOTION_BLUR)for(var _=0;_<a.slinks_internal.length;_++){var n=a.slinks_internal[_];n.min_filter=ee.TF_LINEAR,n.mag_filter=ee.TF_LINEAR}}),t||J.traverse_inputs(e,r,function(e,t,r){var a=r;"DEPTH"==a.from&&(a.use_renderbuffer=!0)})}),J.traverse(e,function(t,r){var a={};_(e,t,a);for(var n in a){for(var o=a[n],i=o[0],s=0;s<o.length;s++)if(o[s].min_filter==ee.TF_LINEAR){i=o[s];break}for(var c=o[0],s=0;s<o.length;s++)if(o[s].mag_filter==ee.TF_LINEAR){c=o[s];break}for(var E=o[0],s=0;s<o.length;s++)if(!o[s].use_renderbuffer){E=o[s];break}for(var s=0;s<o.length;s++)o[s].min_filter=i.min_filter,o[s].mag_filter=c.mag_filter,o[s].use_renderbuffer=E.use_renderbuffer}})}function _(e,t,r){J.traverse_inputs(e,t,function(t,a,n){var o=n;o.active&&o.from==o.to&&(r[o.from]=r[o.from]||[],-1==r[o.from].indexOf(o)&&r[o.from].push(o),_(e,t,r))}),J.traverse_outputs(e,t,function(e,t,a){var _=a;_.active&&(r[_.from]=r[_.from]||[],-1==r[_.from].indexOf(_)&&r[_.from].push(_))});var a=J.get_node_attr(e,t);if(a.type==$.MOTION_BLUR)for(var n=0;n<a.slinks_internal.length;n++){var o=a.slinks_internal[n];r[o.from].push(o)}}function P(e){var t=[$.MOTION_BLUR,$.SMAA_RESOLVE,$.SMAA_NEIGHBORHOOD_BLENDING,$.MAIN_PLANE_REFLECT,$.MAIN_CUBE_REFLECT,$.PERFORMANCE];re.webgl2||t.push($.AVERAGE_LUMINANCE);var r=J.topsort(e),a=[];J.traverse(r,function(e,_){for(var n=_,o=0;o<n.slinks_internal.length;o++){var i=n.slinks_internal[o];t.indexOf(n.type)>-1&&(i.unique_texture=!0);var s=m(a,i,A(i));i.texture=s,n.textures_internal[o]=s}for(var o=0;o<n.textures_internal.length;o++){var s=n.textures_internal[o];v(a,s)}J.traverse_outputs(r,e,function(_,o,i){var s=i;if(!s.texture){if(t.indexOf(n.type)>-1)s.unique_texture=!0;else{var c=S(r,e,s.from);if(c&&s.active&&!s.texture)return p(a,c),void(s.texture=c)}c=m(a,s,A(s)),s.texture=c}}),J.traverse_inputs(r,e,function(e,t,r){v(a,r.texture)}),J.traverse_outputs(r,e,function(e,t,r){var _=r;_.texture&&"NONE"==_.to&&v(a,_.texture)})})}function A(e){var t=e.to,r=e.active,a=e.texture;e.to="",e.active=!1,e.texture=null;var _=W.calc_variable_id(e,0);return e.to=t,e.active=r,e.texture=a,_}function S(e,t,r){var a=null;return J.traverse_inputs(e,t,function(e,t,_){var n=_;if(n.active&&n.from==n.to&&n.from==r&&n.texture)return a=n.texture,!0}),J.traverse_outputs(e,t,function(e,t,_){var n=_;if(n.active&&n.from==r&&n.texture)return a=n.texture,!0}),a}function p(e,t){for(var r=0;r<e.length;r++){var a=e[r];a.tex===t&&a.ref++}}function v(e,t){for(var r=0;r<e.length;r++){var a=e[r];a.tex===t&&a.ref&&a.ref--}}function m(e,t,r){if(t.parent_slink)return p(e,t.parent_slink.texture),t.parent_slink.texture;if(t.unique_texture)return O(t);for(var a=null,_=0;_<e.length;_++){var n=e[_];if(n.id==r&&0===n.ref){a=n;break}}if(!a||_e||re.firefox_tex_reuse_hack){var o=O(t);return e.push({id:r,ref:1,tex:o}),o}return a.ref++,a.tex}function O(e){var t=e.size_mult_x*e.size,r=e.size_mult_y*e.size,a=e.use_comparison,_=e.use_mipmap;switch(e.from){case"COLOR":if(e.use_renderbuffer){var n=ee.create_texture(e.multisample?ee.TT_RB_RGBA_MS:ee.TT_RB_RGBA,a,_);ee.resize(n,t,r)}else{if(e.floating_point)var n=ee.create_texture(ee.TT_RGBA_FLOAT,a,_);else var n=ee.create_texture(ee.TT_RGBA_INT,a,_);ee.resize(n,t,r),ee.set_filters(n,e.min_filter,e.mag_filter)}return n;case"DEPTH":if(e.use_renderbuffer){var n=ee.create_texture(e.multisample?ee.TT_RB_DEPTH_MS:ee.TT_RB_DEPTH,a,_);ee.resize(n,t,r)}else{var n=ee.create_texture(ee.TT_DEPTH,a,_);ee.resize(n,t,r),ee.set_filters(n,e.min_filter,e.mag_filter)}return n;case"CUBEMAP":var n=ee.create_cubemap_texture(t,_);return n;case"SCREEN":case"NONE":return null;default:H.panic("Wrong slink param: "+e.from)}}function N(e,t){var r=!1;J.traverse_edges(e,function(a,_,n){var o=n;if(o){var i=J.get_node_attr(e,a),s=J.get_node_attr(e,_);return t(o,!1,i,s)?(r=!0,!0):void 0}}),r||J.traverse(e,function(e,r){for(var a=r,_=0;_<a.slinks_internal.length;_++){var n=a.slinks_internal[_];if(t(n,!0,a,null))return!0}})}function g(e){J.traverse(e,function(t,r){if(r.type!=$.SINK){var a=r.camera;J.traverse_outputs(e,t,function(e,t,r){r.texture&&r.active&&r.texture&&(Q.set_attachment(a,r.from,r.texture),r.from==r.to&&t.camera&&Q.set_attachment(t.camera,r.from,r.texture))});for(var _=0;_<r.slinks_internal.length;_++){var n=r.slinks_internal[_];if(n.active&&n.from==n.to){var o=r.textures_internal[_];Q.set_attachment(a,n.from,o)}}!a.color_attachment&&!a.depth_attachment||a.framebuffer||(a.framebuffer=Z.render_target_create(a.color_attachment,a.depth_attachment))}}),J.traverse(e,function(t,r){if(r.type==$.RESOLVE||r.type==$.COPY){var a=G(e,r);r.camera.framebuffer_prev=a[0].camera.framebuffer}})}function h(e,t,r,a,_,n,o,i){var s=o.cameras[0],c=r.lamps_number,E=r.water_params,l=r.world_fog_set,T=r.world_light_set,u=n.reflect_links_opaque,d=n.reflect_subscenes,f=_.subs_grass_map,P=_.slink_grass_map_d,A=_.slink_grass_map_c;if(e&&e.refl_plane_objs.length>0&&!i)for(var S=0;S<e.refl_plane_objs.length;S++){var p=Q.clone_camera(s,!0);p.reflection_plane=new Float32Array(4),o.cameras.push(p);var v=$.create_subs_main($.MAIN_PLANE_REFLECT,p,!1,E,c,l,T,null,r.sun_exist);v.refl_obj=e.refl_plane_objs[S],J.append_node_attr(a,v);var m=U("COLOR","u_plane_reflection",1,r.plane_refl_size,r.plane_refl_size,!0,!0);if(m.min_filter=ee.TF_LINEAR,m.mag_filter=ee.TF_LINEAR,u.push(m),e!=t){var O=U("COLOR","u_plane_reflection",1,r.plane_refl_size,r.plane_refl_size,!0,!0);O.min_filter=ee.TF_LINEAR,O.mag_filter=ee.TF_LINEAR,n.reflect_links_blend.push(O)}if(f&&(J.append_edge_attr(a,f,v,P),J.append_edge_attr(a,f,v,A)),e.has_blend_reflexible||t.has_blend_reflexible){var N=$.create_subs_main($.MAIN_PLANE_REFLECT_BLEND,p,!1,E,c,l,T,null,r.sun_exist);N.refl_obj=e.refl_plane_objs[S],J.append_node_attr(a,N);var g=U("DEPTH","DEPTH",1,r.plane_refl_size,r.plane_refl_size,!0,!0),h=U("COLOR","COLOR",1,r.plane_refl_size,r.plane_refl_size,!0,!0);h.min_filter=ee.TF_NEAREST,h.mag_filter=ee.TF_NEAREST,J.append_edge_attr(a,v,N,g),J.append_edge_attr(a,v,N,h),t.plane_refl_subs_blend.push([N]),d.push(N),f&&(J.append_edge_attr(a,f,N,P),J.append_edge_attr(a,f,N,A))}else{var R=U("DEPTH","DEPTH",1,r.plane_refl_size,r.plane_refl_size,!0,!0);v.slinks_internal.push(R),d.push(v)}t.plane_refl_subs.push([v])}}function R(e,t,r,a,_,n,o){var i=r.lamps_number,s=r.water_params,c=r.world_fog_set,E=r.world_light_set,l=_.subs_grass_map,T=_.slink_grass_map_d,u=_.slink_grass_map_c,d=n.cube_reflect_links,P=n.cube_refl_subscenes;if(e&&e.refl_cube_objs.length&&!o)for(var A=0;A<e.refl_cube_objs.length;A++){var S=Q.create_camera(Q.TYPE_PERSP);S.width=r.cubemap_refl_size,S.height=r.cubemap_refl_size,Q.set_frustum(S,Math.PI/2,.1,100),Q.set_projection(S,!1);var p=$.create_subs_main($.MAIN_CUBE_REFLECT,S,!1,s,i,c,E,null,r.sun_exist);p.refl_obj=e.refl_cube_objs[A],p.cube_view_matrices=f._6();for(var v=0;v<6;v++)p.cube_cam_frustums.push(Q.create_frustum_planes());J.append_node_attr(a,p);var m=U("CUBEMAP","u_cube_reflection",r.cubemap_refl_size,1,1,!1,!1);if(m.min_filter=ee.TF_LINEAR,m.mag_filter=ee.TF_LINEAR,d.push(m),e!=t){var O=U("CUBEMAP","u_cube_reflection",r.cubemap_refl_size,1,1,!1,!1);O.min_filter=ee.TF_LINEAR,O.mag_filter=ee.TF_LINEAR,n.cube_reflect_links_blend.push(O)}if(e==t&&!e.has_reflexible){var N=U("CUBEMAP","u_sky_reflection",1,1,1,!1);N.use_mipmap=!0,N.min_filter=ee.TF_LINEAR_MIPMAP_LINEAR,N.mag_filter=ee.TF_LINEAR,sky_reflect_links.push(N)}if(l&&(J.append_edge_attr(a,l,p,T),J.append_edge_attr(a,l,p,u)),e.has_blend_reflexible||t.has_blend_reflexible){var g=$.create_subs_main($.MAIN_CUBE_REFLECT_BLEND,S,!1,s,i,c,E,null,r.sun_exist);g.refl_obj=e.refl_cube_objs[A],g.cube_view_matrices=p.cube_view_matrices,g.cube_cam_frustums=p.cube_cam_frustums,J.append_node_attr(a,g);var h=U("DEPTH","DEPTH",r.cubemap_refl_size,1,1,!1,!1),R=U("COLOR","COLOR",r.cubemap_refl_size,1,1,!1,!1);J.append_edge_attr(a,p,g,h),J.append_edge_attr(a,p,g,R),P.push(g),t.cube_refl_subs_blend.push(g),l&&(J.append_edge_attr(a,l,g,T),J.append_edge_attr(a,l,g,u))}else{var I=U("DEPTH","DEPTH",r.cubemap_refl_size,1,1,!1,!1);p.slinks_internal.push(I),P.push(p)}t.cube_refl_subs.push(p)}}function I(e){var t=null,r=0;return J.traverse(e,function(e,a){if(a.type==te.subs_type){if(r==te.subs_number)return t=a,!0;r++}}),t}function b(e,t){var r=J.node_by_attr(e,t),a=$.create_subs_postprocessing("NONE"),_=J.append_node_attr(e,a),n=J.get_sink_nodes(e)[0];J.traverse_edges(e,function(t,r,a){r==n&&J.reconnect_edges(e,t,n,t,_)});var o=Y(t,e);J.traverse_edges(e,function(_,n,i){if(_==r){if(o){var s=$.create_subs_resolve();J.append_node_attr(e,s);var c=U("COLOR","RESOLVE",1,1,1,!0,!0);c.multisample=!0,c.use_renderbuffer=!0;var E=U("DEPTH","RESOLVE",1,1,1,!0,!0);E.multisample=!0,E.use_renderbuffer=!0,J.append_edge_attr(e,t,s,c),J.append_edge_attr(e,t,s,E),t=s}return J.append_edge_attr(e,t,a,U(te.slink_type,"u_color",i.size,i.size_mult_x,i.size_mult_y,i.update_dim,i.apply_resolution_factors)),!0}}),J.append_edge(e,_,n,U("SCREEN","NONE",.5,.5,.5,!0,!0))}function Y(e,t){var r=!1,a=J.node_by_attr(t,e);if(J.out_edge_count(t,a)){var _=J.get_out_edge(t,a,0),n=J.get_edge_attr(t,a,_,0);if("COLOR"==n.from&&"COLOR"==n.to||"DEPTH"==n.from&&"DEPTH"==n.to){r=Y(J.get_node_attr(t,_),t)}else r="RESOLVE"==n.to}return r}function L(e,t,r,a){var _=r.cameras,n=t.hmd_stereo_use,o=t.anaglyph_use,i=t.reflection_params.plane_refl_subs,s=t.reflection_params.plane_refl_subs_blend,c=J.get_node_id(e,a),E=a,l=J.subgraph_node_conn(e,c,J.BACKWARD_DIR),T=[],u=[],d=[],f=function(t){var a;if(ne.indexOf(t.type)>-1)u.push(t),a=t;else{if(a=$.clone_subs(t),a.type==$.MAIN_PLANE_REFLECT)for(var o=0;o<i.length;o++)if(i[o][0]==t){i[o]=[t,a],a.camera.reflection_plane=t.camera.reflection_plane,r.cameras.push(a.camera);break}if(t.type==$.MAIN_PLANE_REFLECT_BLEND){for(var o=0;o<i.length;o++)if(s[o][0]==t){s[o]=[t,a],a.camera=i[o][1].camera;break}}else _.indexOf(t.camera)>-1&&(n?(Q.make_stereo(t.camera,Q.TYPE_HMD_LEFT),Q.make_stereo(a.camera,Q.TYPE_HMD_RIGHT),a.force_do_not_render=!0):(Q.make_stereo(t.camera,Q.TYPE_STEREO_LEFT),Q.make_stereo(a.camera,Q.TYPE_STEREO_RIGHT)),_.push(a.camera));var c=J.node_by_attr(e,t);if(J.traverse_inputs(e,c,function(e,t,r){ne.indexOf(t.type)>-1&&T.push([t,a,r])}),t.type!==$.MOTION_BLUR)for(var o=0;o<t.slinks_internal.length;o++)a.slinks_internal[o].parent_slink=t.slinks_internal[o];for(var E=!0,o=0;o<J.in_edge_count(e,c);o++){var l=J.get_in_edge(e,c,o),f=J.get_node_attr(e,l);-1==ne.indexOf(f.type)&&(E=!1)}E&&d.push(a)}return a},P=function(e){var t=w(e,!0);return t.parent_slink=e,t};l=J.clone(l,f,P);for(var A=0;A<u.length;A++)J.remove_node(l,J.node_by_attr(l,u[A]));J.cleanup_loose_edges(l);var S=$.create_subs_stereo(n,o),p=J.append_node_attr(e,S);if(re.ios_copy_tex_hack)var v=$.create_subs_postprocessing("NONE"),m=U("COLOR","u_color",1,1,1,!0,!0);else var v=$.create_subs_copy(),m=U("COLOR","COPY",1,1,1,!0,!0);m.min_filter=ee.TF_LINEAR,m.mag_filter=ee.TF_LINEAR,J.append_node_attr(e,v),J.append_edge_attr(e,E,v,m);var O=U("COLOR","u_sampler_left",1,1,1,!0,!0);if(O.unique_texture=!0,O.min_filter=ee.TF_LINEAR,O.mag_filter=ee.TF_LINEAR,J.append_edge_attr(e,v,S,O),!E.is_pp){if(re.ios_copy_tex_hack)var N=$.create_subs_postprocessing("NONE"),g=U("COLOR","u_color",1,1,1,!0,!0);else var N=$.create_subs_copy(),g=U("COLOR","COPY",1,1,1,!0,!0);J.append_node_attr(l,N),g.parent_slink=m;var h=J.get_sink_nodes(l)[0],R=J.get_node_attr(l,h);J.append_edge_attr(l,R,N,g)}var I=U("COLOR","u_sampler_right",1,1,1,!0,!0);E.is_pp&&(I.parent_slink=m),I.min_filter=ee.TF_LINEAR,I.mag_filter=ee.TF_LINEAR,J.append_subgraph(l,e,[J.get_sink_nodes(l)[0],p,I]);for(var A=0;A<T.length;A++){var b=T[A][0],Y=T[A][1],L=T[A][2];J.append_edge_attr(e,b,Y,L)}for(var M=U("SCREEN","NONE",0,0,0,!1,!1),A=0;A<d.length;A++)J.append_edge_attr(e,v,d[A],M);return J.traverse_edges(e,function(t,r,a){J.get_node_attr(e,t).type===$.MOTION_BLUR&&(a.parent_slink=null)}),S}function M(e,t,r){var a=[];J.traverse(e,function(t,r){if(-1==ne.indexOf(r.type)&&r.slinks_internal.length&&D(e,r,$.STEREO))for(var _=0;_<r.slinks_internal.length;_++){var n=r.slinks_internal[_];-1==a.indexOf(n)&&a.push(n)}}),J.traverse_edges(e,function(t,r,_){var n=J.get_node_attr(e,t),o=J.get_node_attr(e,r);-1==ne.indexOf(n.type)&&D(e,o,$.STEREO)&&-1==a.indexOf(_)&&a.push(_)});for(var _=0;_<a.length;_++)a[_].size_mult_x*=t,a[_].size_mult_y*=r}function y(e,t,r){var a=e.texel_size_multiplier;e.texel_size[0]=t*e.texel_mask[0]*a,e.texel_size[1]=r*e.texel_mask[1]*a}function x(e,t){e.texel_size_multiplier=t}function U(e,t,r,a,_,n,o){return{from:e,to:t,size:r,size_mult_x:a,size_mult_y:_,update_dim:n,apply_resolution_factors:o,active:!0,texture:null,multisample:!1,floating_point:!1,use_renderbuffer:!1,min_filter:ee.TF_NEAREST,mag_filter:ee.TF_NEAREST,unique_texture:!1,use_comparison:!1,use_mipmap:!1}}function w(e,t){var r=U(e.from,e.to,e.size,e.size_mult_x,e.size_mult_y,e.update_dim,e.apply_resolution_factors);return r.active=e.active,!t&&e.texture&&H.panic("Failed to clone slink with attached texture"),r.texture=e.texture,r.multisample=e.multisample,r.use_renderbuffer=e.use_renderbuffer,r.min_filter=e.min_filter,r.mag_filter=e.mag_filter,r.unique_texture=e.unique_texture,r.use_comparison=e.use_comparison,r.use_mipmap=e.use_mipmap,r}function C(e,t){for(var r=0,a=G(e,t),_=0,n=0;n<a.length;n++){var o=a[n];if(o.type==$.SHADOW_CAST){_++,t.p_light_matrix=t.p_light_matrix||new Array;var i=o.shadow_lamp_index>0?o.shadow_lamp_index:r;t.p_light_matrix[i]=o.camera.proj_matrix,r++}}t.v_light_ts&&t.v_light_r||(re.mac_os_shadow_hack?t.v_light_tsr=new Float32Array(9*_):(t.v_light_ts=new Float32Array(4*_),t.v_light_r=new Float32Array(4*_)))}function D(e,t,r){if(t.type==r)return!0;for(var a=k(e,t),_=0;_<a.length;_++)if(D(e,a[_],r))return!0;return!1}function F(e,t,r){if(t.type==r)return!0;for(var a=G(e,t),_=0;_<a.length;_++)if(F(e,a[_],r))return!0;return!1}function G(e,t){var r=J.node_by_attr(e,t);r==J.NULL_NODE&&H.panic("Subscene not in graph");for(var a=[],_=J.in_edge_count(e,r),n=0;n<_;n++){var o=J.get_in_edge(e,r,n);o!=r&&a.push(J.get_node_attr(e,o))}return a}function k(e,t){var r=J.node_by_attr(e,t);r==J.NULL_NODE&&H.panic("Subscene not in graph");for(var a=[],_=J.out_edge_count(e,r),n=0;n<_;n++){var o=J.get_out_edge(e,r,n);o!=r&&a.push(J.get_node_attr(e,o))}return a}function K(e){var t=[],r=[];return N(e,function(e,a,_,n){if(e.texture){-1==t.indexOf(e.texture)&&(t.push(e.texture),r.push(e.texture,t.length-1))}}),r}function B(e,t,r){var a=$.subs_label(t);if(t.camera){a+="\\n";for(var _=0;_<r.length;_+=2){var n=t.camera.color_attachment;r[_]==n&&(ee.is_renderbuffer(n)?a+="CR"+r[_+1]+" ":a+="C"+r[_+1]+" ")}for(var _=0;_<r.length;_+=2){var o=t.camera.depth_attachment;r[_]==o&&(ee.is_renderbuffer(o)?a+="DR"+r[_+1]:a+="D"+r[_+1])}}t.slinks_internal.length&&(a+="\\n-----\\n");for(var _=0;_<t.slinks_internal.length;_++)a+=j(t.slinks_internal[_],e,null,r);if(t.type==$.SINK)var i="dotted";else if(t.enqueue)var i="solid";else var i="dashed";return i+=",bold",String(e)+' [label="'+a+'" color="black" style="'+i+'"];\n'}function X(e,t,r,a){var _=j(r,e,t,a);if(r.active)var n="solid";else var n="dotted";return String(e)+" -> "+String(t)+' [label="'+_+'" style="'+n+'"];\n'}function j(e,t,r,a){var _="";if(_+=e.from+"\\n",_+="NONE"!=e.to?e.to+"\\n":"",_+="(",e.update_dim){var n=e.size_mult_x,o=e.size_mult_y;Math.round(n)!=n&&(n=n.toFixed(2)),Math.round(o)!=o&&(o=o.toFixed(2));_+=(1==n?"":n)+"S"+"x"+((1==o?"":o)+"S"),_+=e.apply_resolution_factors?" FACT":" VIEW"}else{var n=e.size_mult_x,o=e.size_mult_y;_+=e.size*n+"x"+e.size*o}if("SCREEN"!=e.from){_+=" ",e.use_renderbuffer?_+="RR":_+=function(e){var t="";return e.min==ee.TF_LINEAR?t+="L":e.min==ee.TF_NEAREST&&(t+="N"),e.mag==ee.TF_LINEAR?t+="L":e.mag==ee.TF_NEAREST&&(t+="N"),t}({min:e.min_filter,mag:e.mag_filter});for(var i=0;i<a.length;i+=2)a[i]==e.texture&&(_+=" "+a[i+1])}return _+=")\\n"}var H=Object(n.a)(e),Q=Object(o.a)(e),z=Object(i.a)(e),q=Object(s.a)(e),V=Object(c.a)(e),W=Object(E.a)(e),J=Object(l.a)(e),Z=Object(T.a)(e),$=Object(u.a)(e),ee=Object(d.a)(e),te=z.debug_subs,re=z.defaults,ae=z.scenes,_e=!1,ne=[$.GRASS_MAP,$.SHADOW_CAST,$.MAIN_CUBE_REFLECT,$.MAIN_CUBE_REFLECT_BLEND];t.check_slink_tex_conn=function(e){switch(e.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"NONE":return!1;default:return!0}},t.traverse_slinks=N,t.update_rendering_graph=function(e,t,_,n,o){var i=e.graph,s=o.reflection_params,c=e.reflection_params,E=(t.cameras[0],e.lamps_number,e.water_params,e.world_fog_set,e.world_light_set,[]),l=[],T=[],u=[],d=[],f=[];if(e.dynamic_grass){var A=$.create_subs_grass_map();J.append_node_attr(i,A);var S=ae.grass_tex_size;A.camera.width=S,A.camera.height=S;var p=U("DEPTH","u_grass_map_depth",S,1,1,!1,!1);re.webgl2||(p.min_filter=ee.TF_LINEAR,p.mag_filter=ee.TF_LINEAR);var v=U("COLOR","u_grass_map_color",S,1,1,!1,!1);v.min_filter=ee.TF_LINEAR,v.mag_filter=ee.TF_LINEAR}else var A=null,p=null,v=null;var m={subs_grass_map:A,slink_grass_map_d:p,slink_grass_map_c:v};R(s,c,e,i,m,{cube_reflect_links:T,cube_refl_subscenes:f,cube_reflect_links_blend:u}),h(s,c,e,i,m,{reflect_links_opaque:E,reflect_subscenes:d,reflect_links_blend:l},t);var O=function(e,t,r){if(e.length)for(var a=0;a<e.length;a++)J.append_edge_attr(i,e[a],t,r[a])};O(f,oe,T),O(f,ie,u),O(d,oe,E),O(d,ie,l),e.queue=[];var N=e.depth_tex;if(r(i,N),a(i,N),te.enabled){var Y=I(i);Y&&b(i,Y)}P(i),g(i)};var oe=null,ie=null;t.create_rendering_graph=function(e,t,_,n){var o=J.create(),i=[],s=[],c=[],E=[],l=[],T=[],u=[],d=[],f=[],A=e.lamps_number,S=e.water_params,p=e.shore_smoothing,v=e.soft_particles,m=e.ssao,O=e.god_rays,N=e.reflection_params,Y=e.materials_params,M=e.bloom_params,y=e.motion_blur,D=e.compositing,F=e.antialiasing,G=e.world_light_set,K=e.world_fog_set,B=e.shadow_params,X=e.mb_params,j=e.cc_params,H=e.god_rays_params,z=e.outline_params,W=e.dof,Z=e.depth_tex,_e=e.refractions,ne=Boolean(n.length),se=re.msaa_samples>1;re.reuse_depth_optimization=re.reuse_depth_optimization&&Boolean(B)&&!(se&&m);var ce=re.reuse_depth_optimization,Ee=U("COLOR","COLOR",1,1,1,!0,!0),le=U("DEPTH","DEPTH",1,1,1,!0,!0);if(se){var Te=w(le);Ee.multisample=!0,Ee.use_renderbuffer=!0,le.multisample=!0,le.use_renderbuffer=!0}var ue=t.cameras[0];if(e.dynamic_grass){var de=$.create_subs_grass_map();J.append_node_attr(o,de);var fe=ae.grass_tex_size;de.camera.width=fe,de.camera.height=fe;var Pe=U("DEPTH","u_grass_map_depth",fe,1,1,!1,!1);re.webgl2||(Pe.min_filter=ee.TF_LINEAR,Pe.mag_filter=ee.TF_LINEAR);var Ae=U("COLOR","u_grass_map_color",fe,1,1,!1,!1);Ae.min_filter=ee.TF_LINEAR,Ae.mag_filter=ee.TF_LINEAR}else var de=null,Pe=null,Ae=null;if(B){Q.update_camera_shadows(ue,B);for(var Se=0;Se<B.lamp_types.length;Se++)for(var pe=B.csm_num,ve=0;ve<pe;ve++){var me=$.create_subs_shadow_cast(ve,Se,B,A);J.append_node_attr(o,me),c.push(me);var fe=B.csm_resolution,Oe=me.camera;t.shadow_cameras.push(Oe),Oe.width=fe,Oe.height=fe,me.clear_color=!0;var Ne=Se>0?Se:ve;if(re.rgba_fallback_shadows){var ge=U("COLOR","u_shadow_map"+Ne,fe,1,1,!1,!1);E.push(ge);var he=U("DEPTH","DEPTH",fe,1,1,!1,!1);he.use_renderbuffer=!0,me.slinks_internal.push(he)}else{var Re=U("DEPTH","u_shadow_map"+Ne,fe,1,1,!1,!1);re.compared_mode_depth&&(Re.min_filter=ee.TF_LINEAR,Re.mag_filter=ee.TF_LINEAR,Re.use_comparison=!0),E.push(Re),(q.depth_only_issue()||re.shadows_color_slink_hack)&&me.slinks_internal.push(U("COLOR","COLOR",fe,1,1,!1,!1))}de&&(J.append_edge_attr(o,de,me,Pe),J.append_edge_attr(o,de,me,Ae))}}var Ie={subs_grass_map:de,slink_grass_map_d:Pe,slink_grass_map_c:Ae};if(R(N,N,e,o,Ie,{cube_reflect_links:d,cube_refl_subscenes:u},ne),h(N,N,e,o,Ie,{reflect_links_opaque:T,reflect_subscenes:l},t),B){var be=Q.clone_camera(ue,!0);t.cameras.push(be);var Ye=$.create_subs_shadow_receive(o,be,A);J.append_node_attr(o,Ye),Ye.self_shadow_normal_offset=B.self_shadow_normal_offset;for(var ve=0;ve<c.length;ve++){var me=c[ve],Le=E[ve];J.append_edge_attr(o,me,Ye,Le)}if(ce){var Re=U("DEPTH","DEPTH",1,1,1,!0,!0);if(se){Re.multisample=!0,Re.use_renderbuffer=!0;var Me=$.create_subs_resolve();J.append_node_attr(o,Me);var ye=U("COLOR","RESOLVE",1,1,1,!0,!0);ye.multisample=!0,ye.use_renderbuffer=!0;var xe=U("DEPTH","RESOLVE",1,1,1,!0,!0);xe.multisample=!0,xe.use_renderbuffer=!0,J.append_edge_attr(o,Ye,Me,ye),J.append_edge_attr(o,Ye,Me,xe)}}else if(se)var Re=U("DEPTH","DEPTH",1,1,1,!0,!0);else if(re.rgba_fallback_shadows){var Re=U("DEPTH","DEPTH",1,1,1,!0,!0);Re.use_renderbuffer=!0}else var Re=le;if(m){var Ue=U("COLOR","u_color",1,1,1,!0,!0),we=U("DEPTH","u_depth",1,1,1,!0,!0),Ce=Q.clone_camera(ue,!0);t.cameras.push(Ce);var De=e.ssao_params,Fe=$.create_subs_ssao(Ce,K,De);J.append_node_attr(o,Fe);var Ge=U("COLOR","u_ssao_mask",1,1,1,!0,!0);J.append_edge_attr(o,Ye,Fe,Ue),J.append_edge_attr(o,Ye,Fe,we);var ke=Q.clone_camera(ue,!0);t.cameras.push(ke);var Ke=$.create_subs_ssao_blur(ke,De);J.append_node_attr(o,Ke);var Be=U("COLOR","u_shadow_mask",1,1,1,!0,!0);J.append_edge_attr(o,Fe,Ke,Ge),J.append_edge_attr(o,Ye,Ke,we)}de&&(J.append_edge_attr(o,de,Ye,Pe),J.append_edge_attr(o,de,Ye,Ae))}else var Ye=null;var Xe=$.create_subs_main($.MAIN_OPAQUE,ue,!ce,S,A,K,G,null,e.sun_exist);if(oe=Xe,J.append_node_attr(o,Xe),B&&(ce?J.append_edge_attr(o,Ye,Xe,Re):Ye.slinks_internal.push(Re)),se){var je=$.create_subs_resolve();J.append_node_attr(o,je),s.push(je);var He=U("COLOR","RESOLVE",1,1,1,!0,!0);He.multisample=!0,He.use_renderbuffer=!0;var Qe=U("DEPTH","RESOLVE",1,1,1,!0,!0);Qe.multisample=!0,Qe.use_renderbuffer=!0,J.append_edge_attr(o,Xe,je,He),J.append_edge_attr(o,Xe,je,Qe)}else s.push(Xe);if(Ye)if(Ge)J.append_edge_attr(o,Ke,Xe,Be);else{var ze=U("COLOR","u_shadow_mask",1,1,1,!0,!0);J.append_edge_attr(o,ce&&se?Me:Ye,Xe,ze)}if(de&&(J.append_edge_attr(o,de,Xe,Pe),J.append_edge_attr(o,de,Xe,Ae)),l.length)for(var qe=l.length,Se=0;Se<qe;Se++)J.append_edge_attr(o,l[Se],Xe,T[Se]);if(u.length)for(var Se=0;Se<u.length;Se++)J.append_edge_attr(o,u[Se],Xe,d[Se]);if(i=s,s=[],!ne&&e.color_picking){var Ve=te.enabled&&(te.subs_type===$.COLOR_PICKING||te.subs_type===$.COLOR_PICKING_XRAY),Oe=Q.clone_camera(ue,!0);Ve||(Oe.width=Oe.height=1),t.cameras.push(Oe);var We=$.create_subs_color_picking(Oe,!1,A);if(J.append_node_attr(o,We),e.xray){Oe=Q.clone_camera(ue,!0),Ve||(Oe.width=Oe.height=1),t.cameras.push(Oe);var Je=$.create_subs_color_picking(Oe,!0,A);J.append_node_attr(o,Je);var Ze=U("COLOR","COLOR",1,1,1,Ve,!0);J.append_edge_attr(o,We,Je,Ze);var $e=U("DEPTH","DEPTH",1,1,1,Ve,!0);J.append_edge_attr(o,We,Je,$e)}}else var We=null;if(!Y.refractions&&!_e||ne)var et=null;else{if(se)var et=je;else{if(re.ios_copy_tex_hack)var et=$.create_subs_postprocessing("NONE"),tt=U("COLOR","u_color",1,1,1,!0,!0);else var et=$.create_subs_copy(),tt=U("COLOR","COPY",1,1,1,!0,!0);J.append_node_attr(o,et),J.append_edge_attr(o,i[0],et,tt)}var rt=U("COLOR","u_refractmap",1,1,1,!0,!0);re.webgl2&&(rt.use_mipmap=!0,rt.min_filter=ee.TF_LINEAR_MIPMAP_LINEAR,rt.mag_filter=ee.TF_LINEAR)}if(Z&&(_e||p||v)){var at=Q.clone_camera(ue,!0);t.cameras.push(at);var _t=$.create_subs_depth_pack(at);J.append_node_attr(o,_t);var nt=U("DEPTH","u_depth",1,1,1,!0,!0);J.append_edge_attr(o,se?je:Xe,_t,nt);var ot=U("COLOR","u_scene_depth",1,1,1,!0,!0);ot.min_filter=ee.TF_NEAREST,ot.mag_filter=ee.TF_NEAREST}else var _t=null;var it=function(r){var a=Q.clone_camera(ue,!0);t.cameras.push(a);var _=$.create_subs_main(r,a,!1,S,A,K,G,B,e.sun_exist);if(J.append_node_attr(o,_),r==$.MAIN_XRAY){var n=U("COLOR","COLOR",1,1,1,!0,!0);J.append_edge_attr(o,i[0],_,n);var s=U("DEPTH","DEPTH",1,1,1,!0,!0);_.slinks_internal.push(s)}else{if(se&&i[0].type==$.RESOLVE)var f=Xe;else var f=i[0];J.append_edge_attr(o,Xe,_,le),J.append_edge_attr(o,f,_,Ee)}de&&(J.append_edge_attr(o,de,_,Pe),J.append_edge_attr(o,de,_,Ae));for(var P=0;P<c.length;P++){var p=c[P],v=E[P];J.append_edge_attr(o,p,_,v)}if(_t&&J.append_edge_attr(o,_t,_,ot),l.length)for(var m=l.length,P=0;P<m;P++)J.append_edge_attr(o,l[P],_,T[P]);if(u.length)for(var P=0;P<u.length;P++)J.append_edge_attr(o,u[P],_,d[P]);return et&&J.append_edge_attr(o,et,_,rt),_};if(e.glow_over_blend){var st=it($.MAIN_BLEND);ie=st,s.push(st),i=s,s=[]}if(e.glow_materials){var ct=Q.clone_camera(ue,!0);t.cameras.push(ct);var Et=$.create_subs_main($.MAIN_GLOW,ct,!1,S,A,K,G);if(J.append_node_attr(o,Et),_t&&J.append_edge_attr(o,_t,Et,ot),et&&J.append_edge_attr(o,et,Et,rt),de&&(J.append_edge_attr(o,de,Et,Pe),J.append_edge_attr(o,de,Et,Ae)),l.length)for(var qe=l.length,Se=0;Se<qe;Se++)J.append_edge_attr(o,l[Se],Et,T[Se]);if(u.length)for(var Se=0;Se<u.length;Se++)J.append_edge_attr(o,u[Se],Et,d[Se]);e.glow_over_blend&&J.append_edge_attr(o,Et,st,U("SCREEN","NONE",0,0,0,!1,!1)),J.append_edge_attr(o,se?je:Xe,Et,se?Te:le);var lt=$.create_subs_postprocessing("X_GLOW_BLUR");lt.subtype="GLOW_MASK_SMALL",x(lt,e.glow_params.small_glow_mask_width);var Tt=U("COLOR","u_color",1,1,1,!0,!0);Tt.min_filter=ee.TF_LINEAR,Tt.mag_filter=ee.TF_LINEAR,J.append_node_attr(o,lt),J.append_edge_attr(o,Et,lt,Tt);var ut=$.create_subs_postprocessing("Y_GLOW_BLUR");ut.subtype="GLOW_MASK_SMALL",x(ut,e.glow_params.small_glow_mask_width);var dt=U("COLOR","u_color",1,.5,.5,!0,!0);dt.min_filter=ee.TF_LINEAR,dt.mag_filter=ee.TF_LINEAR,J.append_node_attr(o,ut),J.append_edge_attr(o,lt,ut,dt);var ft=$.create_subs_postprocessing("X_GLOW_BLUR");ft.subtype="GLOW_MASK_LARGE",x(ft,e.glow_params.large_glow_mask_width);var Pt=U("COLOR","u_color",1,.5,.5,!0,!0);Pt.min_filter=ee.TF_LINEAR,Pt.mag_filter=ee.TF_LINEAR,J.append_node_attr(o,ft),J.append_edge_attr(o,ut,ft,Pt);var At=$.create_subs_postprocessing("Y_GLOW_BLUR");At.subtype="GLOW_MASK_LARGE",x(At,e.glow_params.large_glow_mask_width);var St=U("COLOR","u_color",1,.25,.25,!0,!0);St.min_filter=ee.TF_LINEAR,St.mag_filter=ee.TF_LINEAR,J.append_node_attr(o,At),J.append_edge_attr(o,ft,At,St);var pt=Q.clone_camera(ue,!0);t.cameras.push(pt);var vt=$.create_subs_glow_combine(pt,e);J.append_node_attr(o,vt);var mt=U("COLOR","u_src_color",1,1,1,!0,!0);if(mt.min_filter=ee.TF_LINEAR,mt.mag_filter=ee.TF_LINEAR,e.glow_over_blend)if(se){var Ot=$.create_subs_resolve();J.append_node_attr(o,Ot),J.append_edge_attr(o,st,Ot,He),J.append_edge_attr(o,st,Ot,Qe),J.append_edge_attr(o,Ot,vt,mt)}else J.append_edge_attr(o,st,vt,mt);else J.append_edge_attr(o,se?je:Xe,vt,mt);var Nt=U("COLOR","u_glow_mask_small",1,.5,.5,!0,!0);Nt.min_filter=ee.TF_LINEAR,Nt.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,ut,vt,Nt);var gt=U("COLOR","u_glow_mask_large",1,.25,.25,!0,!0);gt.min_filter=ee.TF_LINEAR,gt.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,At,vt,gt),i=[vt],s=[]}if(!e.glow_over_blend){var st=it($.MAIN_BLEND);ie=st,s.push(st),i=s,s=[]}if(re.debug_view){var Oe=Q.clone_camera(ue,!0);t.cameras.push(Oe);var ht=$.create_subs_debug_view(Oe);s.push(ht),J.append_node_attr(o,ht),J.append_edge_attr(o,i[0],ht,Ee),J.append_edge_attr(o,i[0],ht,le),de&&(J.append_edge_attr(o,de,ht,Pe),J.append_edge_attr(o,de,ht,Ae)),V.set_debug_view_subs(ht),i=s,s=[]}if(se){var Rt=$.create_subs_resolve();J.append_node_attr(o,Rt),s.push(Rt),J.append_edge_attr(o,i[0],Rt,He),J.append_edge_attr(o,i[0],Rt,Qe),i=s,s=[]}var It=i.slice(0);if(!ne&&e.anchor_visibility){var Oe=Q.clone_camera(ue,!0);t.cameras.push(Oe);var bt=$.create_subs_anchor_visibility(Oe);J.append_node_attr(o,bt),J.append_edge_attr(o,i[0],bt,se?Te:le)}if(O&&Z&&!ne){var Yt=H.max_ray_length,Lt=H.intensity,Mt=H.steps_per_pass,yt=i[0],xt=!!S,Ut=U("DEPTH","u_input",1,1,1,!0,!0),wt=U("COLOR","u_input",1,.25,.25,!0,!0);wt.min_filter=ee.TF_LINEAR,wt.mag_filter=ee.TF_LINEAR;var Ct=Yt/Mt,Dt=Q.clone_camera(ue,!0);t.cameras.push(Dt);var Ft=$.create_subs_god_rays(Dt,xt,Yt,!0,Ct,A,Mt);J.append_node_attr(o,Ft),J.append_edge_attr(o,yt,Ft,Ut),Ct=Yt/Mt*.5;var Gt=Q.clone_camera(ue,!0);t.cameras.push(Gt);var kt=$.create_subs_god_rays(Gt,xt,Yt,!1,Ct,A,Mt);J.append_node_attr(o,kt),J.append_edge_attr(o,Ft,kt,wt),Ct=Yt/Mt*.25;var Kt=Q.clone_camera(ue,!0);t.cameras.push(Kt);var Bt=$.create_subs_god_rays(Kt,xt,Yt,!1,Ct,A,Mt);J.append_node_attr(o,Bt),J.append_edge_attr(o,kt,Bt,wt);var Xt=$.create_subs_god_rays_comb(Lt,A);s.push(Xt),J.append_node_attr(o,Xt);var jt=U("COLOR","u_main",1,1,1,!0,!0);jt.min_filter=ee.TF_LINEAR,jt.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,yt,Xt,jt);var Ht=U("COLOR","u_god_rays",1,1,1,!0,!0);Ht.min_filter=ee.TF_LINEAR,Ht.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,Bt,Xt,Ht),i=s,s=[]}if(M&&!ne){var yt=i[0],Qt=$.create_subs_luminance();J.append_node_attr(o,Qt);var jt=U("COLOR","u_input",1,1,1,!0,!0);jt.min_filter=ee.TF_LINEAR,jt.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,yt,Qt,jt);var zt=M.key,qt=M.edge_lum,Vt=Q.clone_camera(ue,!0);t.cameras.push(Vt);var Wt=$.create_subs_luminance_truncated(zt,qt,A,Vt);J.append_node_attr(o,Wt);var Jt=U("COLOR","u_luminance",1,.25,.25,!0,!0);if(Jt.min_filter=ee.TF_LINEAR,Jt.mag_filter=ee.TF_LINEAR,M.adaptive){var Zt=$.create_subs_av_luminance();J.append_node_attr(o,Zt),Zt.camera.width=1,Zt.camera.height=1;var $t=U("COLOR","u_input",1,.25,.25,!0,!0);if($t.use_mipmap=!0,$t.min_filter=ee.TF_LINEAR_MIPMAP_LINEAR,$t.mag_filter=ee.TF_LINEAR,re.webgl2)Jt.use_mipmap=!0,Jt.min_filter=ee.TF_LINEAR_MIPMAP_LINEAR,J.append_edge_attr(o,Qt,Zt,$t);else{var er=$.create_resize_subs(),tr=U("COLOR","u_color",1,.25,.25,!0,!0);J.append_node_attr(o,er),J.append_edge_attr(o,Qt,er,tr),J.append_edge_attr(o,er,Zt,$t)}J.append_edge_attr(o,Zt,Wt,U("COLOR","u_average_lum",1,1,1,!1,!1)),Wt.adaptive_bloom=!0}else Wt.adaptive_bloom=!1,Wt.average_luminance=M.average_luminance;J.append_edge_attr(o,yt,Wt,U("COLOR","u_main",1,1,1,!0,!0)),J.append_edge_attr(o,Qt,Wt,Jt);for(var rr=Wt,ar=1,_r=[],ve=0;ve<5;ve++){var lt=$.create_subs_postprocessing("X_BLOOM_BLUR");x(lt,e.glow_params.small_glow_mask_width);var Tt=U("COLOR","u_color",1,ar,ar,!0,!0);Tt.min_filter=ee.TF_LINEAR,Tt.mag_filter=ee.TF_LINEAR,J.append_node_attr(o,lt),J.append_edge_attr(o,rr,lt,Tt),ar/=2;var ut=$.create_subs_postprocessing("Y_BLOOM_BLUR");x(ut,e.glow_params.small_glow_mask_width);var dt=U("COLOR","u_color",1,ar,ar,!0,!0);dt.min_filter=ee.TF_LINEAR,dt.mag_filter=ee.TF_LINEAR,J.append_node_attr(o,ut),J.append_edge_attr(o,lt,ut,dt),rr=ut,ut.bloom_blur_scale=ar,lt.bloom_blur_scale=ar,_r.push(ut,ar)}var nr=M.blur,or=$.create_subs_bloom_combine(nr,5);J.append_node_attr(o,or);for(var ve=0;ve<_r.length;ve+=2){var ut=_r[ve],ir=_r[ve+1],Nt=U("COLOR","u_bloom_level_"+(ve/2).toString(),1,ir,ir,!0,!0);Nt.min_filter=ee.TF_LINEAR,Nt.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,ut,or,Nt)}J.append_edge_attr(o,yt,or,U("COLOR","u_main",1,1,1,!0,!0)),s.push(or),i=s,s=[]}if(W&&Z&&!ne){var yt=i[0],sr=Q.clone_camera(ue,!0);t.cameras.push(sr);var cr=re.tex_float_available&&re.cbuffer_float_available,Er=_.dof_bokeh&&cr;if(Er){var lr=(re.tex_float_lin_available,ee.TF_NEAREST),Tr=U("COLOR","u_color",1,1,1,!0,!0);Tr.min_filter=lr,Tr.mag_filter=lr;var ur=U("DEPTH","u_depth",1,1,1,!0,!0),dr=U("COLOR","u_color",1,.5,.5,!0,!0);dr.floating_point=!0,dr.min_filter=ee.TF_NEAREST,dr.mag_filter=ee.TF_NEAREST;var fr=U("COLOR","u_color",1,.5,.5,!0,!0);fr.floating_point=!0,fr.min_filter=ee.TF_NEAREST,fr.mag_filter=ee.TF_NEAREST;var Pr=U("COLOR","u_blurred1",1,.5,.5,!0,!0);Pr.floating_point=!0,Pr.min_filter=lr,Pr.mag_filter=lr;var Ar=U("COLOR","u_blurred2",1,.5,.5,!0,!0);Ar.floating_point=!0,Ar.min_filter=lr,Ar.mag_filter=lr;var Sr=It[0];if(_.dof_foreground_blur){var pr=Q.clone_camera(ue,!0);t.cameras.push(pr);var vr=$.create_subs_coc(pr,"COC_FOREGROUND");pr.dof_distance=_.dof_distance,pr.dof_object=_.dof_object,pr.dof_front_start=_.dof_front_start,pr.dof_front_end=_.dof_front_end,pr.dof_rear_start=_.dof_rear_start,pr.dof_rear_end=_.dof_rear_end,pr.dof_power=_.dof_power,pr.dof_bokeh=_.dof_bokeh,pr.dof_bokeh_intensity=_.dof_bokeh_intensity,pr.dof_foreground_blur=_.dof_foreground_blur,pr.dof_on=!0,J.append_node_attr(o,vr),J.append_edge_attr(o,yt,vr,Tr),J.append_edge_attr(o,Sr,vr,ur);var mr=$.create_subs_postprocessing("X_ALPHA_BLUR");J.append_node_attr(o,mr),J.append_edge_attr(o,vr,mr,dr);var Or=$.create_subs_postprocessing("Y_ALPHA_BLUR");J.append_node_attr(o,Or),J.append_edge_attr(o,mr,Or,fr);var Nr=Q.clone_camera(ue,!0),gr=$.create_subs_coc(Nr,"COC_COMBINE");t.cameras.push(Nr),Nr.dof_distance=_.dof_distance,Nr.dof_object=_.dof_object,Nr.dof_front_start=_.dof_front_start,Nr.dof_front_end=_.dof_front_end,Nr.dof_rear_start=_.dof_rear_start,Nr.dof_rear_end=_.dof_rear_end,Nr.dof_power=_.dof_power,Nr.dof_bokeh=_.dof_bokeh,Nr.dof_bokeh_intensity=_.dof_bokeh_intensity,Nr.dof_foreground_blur=_.dof_foreground_blur,Nr.dof_on=!0,J.append_node_attr(o,gr),J.append_edge_attr(o,yt,gr,Tr),J.append_edge_attr(o,Sr,gr,ur),J.append_edge_attr(o,Or,gr,U("COLOR","u_coc_fg",1,.5,.5,!0,!0))}else{var Nr=Q.clone_camera(ue,!0);t.cameras.push(Nr);var gr=$.create_subs_coc(Nr,"COC_ALL");Nr.dof_distance=_.dof_distance,Nr.dof_object=_.dof_object,Nr.dof_front_start=_.dof_front_start,Nr.dof_front_end=_.dof_front_end,Nr.dof_rear_start=_.dof_rear_start,Nr.dof_rear_end=_.dof_rear_end,Nr.dof_power=_.dof_power,Nr.dof_bokeh=_.dof_bokeh,Nr.dof_bokeh_intensity=_.dof_bokeh_intensity,Nr.dof_foreground_blur=_.dof_foreground_blur,Nr.dof_on=!0,J.append_node_attr(o,gr),J.append_edge_attr(o,yt,gr,Tr),J.append_edge_attr(o,Sr,gr,ur)}var hr=$.create_subs_postprocessing("X_DOF_BLUR");hr.camera.dof_bokeh_intensity=_.dof_bokeh_intensity,J.append_node_attr(o,hr),J.append_edge_attr(o,gr,hr,dr);var Rr=$.create_subs_postprocessing("Y_DOF_BLUR");Rr.camera.dof_bokeh_intensity=_.dof_bokeh_intensity,J.append_node_attr(o,Rr),J.append_edge_attr(o,hr,Rr,fr);var Ir=$.create_subs_postprocessing("Y_DOF_BLUR");Ir.camera.dof_bokeh_intensity=_.dof_bokeh_intensity,J.append_node_attr(o,Ir),J.append_edge_attr(o,hr,Ir,fr);var br=$.create_subs_dof(sr,Er);sr.dof_distance=_.dof_distance,sr.dof_object=_.dof_object,sr.dof_front_start=_.dof_front_start,sr.dof_front_end=_.dof_front_end,sr.dof_rear_start=_.dof_rear_start,sr.dof_rear_end=_.dof_rear_end,sr.dof_power=_.dof_power,sr.dof_bokeh=_.dof_bokeh,sr.dof_bokeh_intensity=_.dof_bokeh_intensity,sr.dof_foreground_blur=_.dof_foreground_blur,sr.dof_on=!0,s.push(br),J.append_node_attr(o,br),J.append_edge_attr(o,yt,br,U("COLOR","u_sharp",1,1,1,!0,!0)),J.append_edge_attr(o,Rr,br,Pr),J.append_edge_attr(o,Ir,br,Ar)}else{var Yr=U("COLOR","u_color",1,1,1,!0,!0);Yr.min_filter=ee.TF_LINEAR,Yr.mag_filter=ee.TF_LINEAR;var Lr=U("COLOR","u_color",1,1,1,!0,!0);Lr.min_filter=ee.TF_LINEAR,Lr.mag_filter=ee.TF_LINEAR;var hr=$.create_subs_postprocessing("X_BLUR");J.append_node_attr(o,hr),J.append_edge_attr(o,yt,hr,Yr);var Mr=$.create_subs_postprocessing("Y_BLUR");J.append_node_attr(o,Mr),J.append_edge_attr(o,hr,Mr,Lr);var yr=It[0],br=$.create_subs_dof(sr,Er);sr.dof_distance=_.dof_distance,sr.dof_object=_.dof_object,sr.dof_front_start=_.dof_front_start,sr.dof_front_end=_.dof_front_end,sr.dof_rear_start=_.dof_rear_start,sr.dof_rear_end=_.dof_rear_end,sr.dof_power=_.dof_power,sr.dof_bokeh=_.dof_bokeh,sr.dof_bokeh_intensity=_.dof_bokeh_intensity,sr.dof_foreground_blur=_.dof_foreground_blur,sr.dof_on=!0,s.push(br),J.append_node_attr(o,br),J.append_edge_attr(o,yt,br,U("COLOR","u_sharp",1,1,1,!0,!0)),J.append_edge_attr(o,Mr,br,U("COLOR","u_blurred",1,1,1,!0,!0)),J.append_edge_attr(o,yr,br,U("DEPTH","u_depth",1,1,1,!0,!0))}i=s,s=[]}if(e.xray){var xr=it($.MAIN_XRAY);s.push(xr),i=s,s=[]}if(y&&!ne){var Ur=i[0],wr=$.create_subs_motion_blur(X.mb_decay_threshold,X.mb_factor);s.push(wr),J.append_node_attr(o,wr);var Cr=U("COLOR","u_mb_tex_curr",1,1,1,!0,!0);J.append_edge_attr(o,Ur,wr,Cr);var Dr=U("COLOR","u_mb_tex_accum",1,1,1,!0,!0);wr.slinks_internal.push(Dr),i=s,s=[]}if(!ne&&e.outline){var yt=i[0],Fr=Q.clone_camera(ue,!0);t.cameras.push(Fr);var Gr=$.create_subs_outline_mask(Fr,A);J.append_node_attr(o,Gr);var kr=$.create_subs_postprocessing("X_EXTEND"),Kr=U("COLOR","u_color",1,1,1,!0,!0),Br=U("COLOR","u_outline_mask",1,1,1,!0,!0);Br.min_filter=ee.TF_LINEAR,Br.mag_filter=ee.TF_LINEAR,kr.is_for_outline=!0,J.append_node_attr(o,kr),J.append_edge_attr(o,Gr,kr,Kr);var Xr=U("COLOR","u_color",1,.5,.5,!0,!0);Xr.min_filter=ee.TF_LINEAR,Xr.mag_filter=ee.TF_LINEAR;var jr=$.create_subs_postprocessing("Y_EXTEND");jr.is_for_outline=!0,J.append_node_attr(o,jr),J.append_edge_attr(o,kr,jr,Xr);var hr=$.create_subs_postprocessing("X_BLUR");hr.is_for_outline=!0,J.append_node_attr(o,hr),J.append_edge_attr(o,jr,hr,Xr);var Hr=U("COLOR","u_color",1,.25,.25,!0,!0);Hr.min_filter=ee.TF_LINEAR,Hr.mag_filter=ee.TF_LINEAR;var Qr=U("COLOR","u_outline_mask_blurred",1,.25,.25,!0,!0);Qr.min_filter=ee.TF_LINEAR,Qr.mag_filter=ee.TF_LINEAR;var Mr=$.create_subs_postprocessing("Y_BLUR");Mr.is_for_outline=!0,J.append_node_attr(o,Mr),J.append_edge_attr(o,hr,Mr,Hr);var zr=$.create_subs_outline(z);J.append_node_attr(o,zr);var qr=U("COLOR","u_outline_src",1,1,1,!0,!0);qr.min_filter=ee.TF_LINEAR,qr.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,yt,zr,qr),J.append_edge_attr(o,Gr,zr,Br),J.append_edge_attr(o,Mr,zr,Qr),s.push(zr),i=s,s=[]}if(r(o,Z),(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ne){var Vr=L(o,e,t,i[0]);s.push(Vr),i=s,s=[]}if(D&&!ne){var yt=i[0],Wr=j.brightness,Jr=j.contrast,Zr=j.exposure,$r=j.saturation,ea=$.create_subs_compositing(Wr,Jr,Zr,$r),ta=U("COLOR","u_color",1,1,1,!0,!0);ta.min_filter=ee.TF_LINEAR,ta.mag_filter=ee.TF_LINEAR,(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ne&&(ta.unique_texture=!0),J.append_node_attr(o,ea),J.append_edge_attr(o,yt,ea,ta),s.push(ea),i=s,s=[]}if(!i[0].is_pp||i[0].type==$.MOTION_BLUR||i[0].type==$.RESOLVE){var ra=$.create_subs_postprocessing("NONE");J.append_node_attr(o,ra);var aa=U("COLOR","u_color",1,1,1,!0,!0);aa.min_filter=ee.TF_LINEAR,aa.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,i[0],ra,aa),s.push(ra),i=s,s=[]}if(F){var yt=i[0];if(re.smaa){var _a=U("COLOR","u_color",1,1,1,!0,!1);_a.min_filter=ee.TF_LINEAR,_a.mag_filter=ee.TF_LINEAR;var na=$.create_subs_smaa($.SMAA_EDGE_DETECTION,e);J.append_node_attr(o,na),J.append_edge_attr(o,yt,na,_a);var oa=$.create_subs_smaa($.SMAA_BLENDING_WEIGHT_CALCULATION,e);J.append_node_attr(o,oa),J.append_edge_attr(o,na,oa,_a);var ia=U("COLOR","u_search_tex",1,1,1,!1,!1),sa=U("COLOR","u_area_tex",1,1,1,!1,!1);ia.min_filter=ee.TF_LINEAR,ia.mag_filter=ee.TF_LINEAR,sa.min_filter=ee.TF_LINEAR,sa.mag_filter=ee.TF_LINEAR,oa.slinks_internal.push(ia),oa.slinks_internal.push(sa);var ca=$.create_subs_smaa($.SMAA_NEIGHBORHOOD_BLENDING,e);J.append_node_attr(o,ca),J.append_edge_attr(o,yt,ca,_a);var Ea=U("COLOR","u_blend",1,1,1,!0,!1);Ea.min_filter=ee.TF_LINEAR,Ea.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,oa,ca,Ea),s.push(ca)}else{var la=$.create_subs_aa(e);J.append_node_attr(o,la);var Ta=U("COLOR","u_color",1,1,1,!0,!1);Ta.min_filter=ee.TF_LINEAR,Ta.mag_filter=ee.TF_LINEAR,(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ne&&(Ta.unique_texture=!0),J.append_edge_attr(o,yt,la,Ta),s.push(la)}i=s,s=[]}s.push(i[0]),We&&(Je?s.push(Je):s.push(We)),bt&&s.push(bt);var fe=1;if(e.sky_params.render_sky){var ua=e.sky_params,da=e.world_light_set,fa=da.sky_texture_param;fe=fa?fa.tex_size:fe;var Pa=$.create_subs_sky(da,A,ua,fe);if(J.append_node_attr(o,Pa),s.push(Pa),f.length&&(J.append_edge_attr(o,Pa,Xe,f[0]),st&&J.append_edge_attr(o,Pa,st,f[0]),Et&&J.append_edge_attr(o,Pa,Et,f[0]),xr&&J.append_edge_attr(o,Pa,xr,f[0])),N.has_pbr_reflexible)if(re.webgl2&&!re.is_mobile_device){var Aa=$.create_subs_irradiance(A,fe);J.append_node_attr(o,Aa);var Sa=U("CUBEMAP","u_sky_reflection",fe,1,1,!1);Sa.use_mipmap=!0,Sa.min_filter=ee.TF_LINEAR_MIPMAP_LINEAR,Sa.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,Pa,Aa,Sa);var pa=U("CUBEMAP","u_irradiance",32,1,1,!1);pa.use_mipmap=!1,pa.min_filter=ee.TF_LINEAR,pa.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,Aa,Xe,pa),st&&J.append_edge_attr(o,Aa,st,pa),Et&&J.append_edge_attr(o,Aa,Et,pa),xr&&J.append_edge_attr(o,Aa,xr,pa),s.push(Aa);var va=$.create_subs_rougness_convolution(A);J.append_node_attr(o,va),J.append_edge_attr(o,Pa,va,Sa);var ma=U("CUBEMAP","u_cube_r_convolution",128,1,1,!1);ma.use_mipmap=!1,ma.min_filter=ee.TF_LINEAR_MIPMAP_LINEAR,ma.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,va,Xe,ma),st&&J.append_edge_attr(o,va,st,ma),Et&&J.append_edge_attr(o,va,Et,ma),xr&&J.append_edge_attr(o,va,xr,ma);var Oa=$.create_subs_brdf();J.append_node_attr(o,Oa);var Na=U("COLOR","u_brdf",512,1,1,!1);Na.min_filter=ee.TF_LINEAR,Na.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,Oa,Xe,Na),st&&J.append_edge_attr(o,Oa,st,Na),Et&&J.append_edge_attr(o,Oa,Et,Na),xr&&J.append_edge_attr(o,Oa,xr,Na)}else{var Sa=U("CUBEMAP","u_sky_reflection",fe,1,1,!1);Sa.use_mipmap=!0,Sa.min_filter=ee.TF_LINEAR_MIPMAP_LINEAR,Sa.mag_filter=ee.TF_LINEAR,J.append_edge_attr(o,Pa,Xe,Sa),st&&J.append_edge_attr(o,Pa,st,Sa),Et&&J.append_edge_attr(o,Pa,Et,Sa),xr&&J.append_edge_attr(o,Pa,xr,Sa)}}var ga=$.create_subs_sink();J.append_node_attr(o,ga);for(var ve=0;ve<s.length;ve++){var ha=s[ve];switch(ha.blend=!0,ha.type){case $.COLOR_PICKING:case $.COLOR_PICKING_XRAY:J.append_edge_attr(o,ha,ga,U("COLOR","NONE",1,1,1,Ve,!1)),J.append_edge_attr(o,ha,ga,U("DEPTH","NONE",1,1,1,Ve,!1));break;case $.SKY:var Ra=U("CUBEMAP","u_sky",fe,1,1,!1);J.append_edge_attr(o,ha,ga,Ra);break;case $.IRRADIANCE:var Ia=U("CUBEMAP","u_irradiance",fe,1,1,!1);Ia.use_mipmap=!0,Ia.min_filter=ee.TF_NEAREST,Ia.mag_filter=ee.TF_NEAREST,J.append_edge_attr(o,Aa,ga,Ia);break;case $.ANCHOR_VISIBILITY:var ba=U("COLOR","NONE",1,1,1,!0,!1);J.append_edge_attr(o,ha,ga,ba);break;default:if(ne){var Ya=n[0],La=U("COLOR","OFFSCREEN",1,1,1,!0,!0);La.texture=Ya,J.append_edge_attr(o,s[ve],ga,La);for(var Se=1;Se<n.length;Se++){var Ma=n[Se],ya=$.create_subs_postprocessing("NONE");J.append_node_attr(o,ya);var xa=U("COLOR","SCALE",1,1,1,!0,!0);J.append_edge_attr(o,s[ve],ya,xa);var Ua=Ma.source_size/Ya.source_size;La=U("COLOR","OFFSCREEN",1,Ua,Ua,!0,!0),La.texture=Ma,J.append_edge_attr(o,ya,ga,La)}}else J.append_edge_attr(o,s[ve],ga,U("SCREEN","NONE",1,1,1,!0,!1))}}if(je&&!k(o,je).length&&(J.remove_node(o,J.node_by_attr(o,je)),J.cleanup_loose_edges(o)),r(o,Z),a(o,Z),te.enabled){var wa=I(o);wa&&b(o,wa)}if(P(o),g(o),B&&J.traverse(o,function(e,t){t.type!=$.SHADOW_RECEIVE&&t.type!=$.MAIN_BLEND&&t.type!=$.MAIN_XRAY||C(o,t)}),!N.has_reflexible)for(var ve=0;ve<d.length;ve++)d[ve].active=!1;return o},t.multiply_size_mult_by_graph=M,t.set_texel_size=y,t.set_texel_size_mult=x,t.create_performance_graph=function(){var e=J.create(),t=$.create_subs_perf(),r=Q.create_camera(Q.TYPE_NONE);r.width=512,r.height=512,t.camera=r,J.append_node_attr(e,t),t.slinks_internal.push(U("COLOR","u_color",512,1,1,!1,!1));var a=$.create_subs_sink();return J.append_node_attr(e,a),J.append_edge_attr(e,t,a,U("COLOR","NONE",512,1,1,!1,!1)),P(e),g(e),e},t.find_on_screen=function(e){var t=null;return J.traverse(e,function(e,r){return!(!r.camera||null!==r.camera.framebuffer)&&(t=r,!0)}),t},t.find_input=function(e,t,r){for(var a=G(e,t),_=0;_<a.length;_++)if(a[_].type==r)return a[_];return null},t.get_inputs_by_type=function(e,t,r){for(var a=G(e,t),_=[],n=0;n<a.length;n++)a[n].type==r&&_.push(a[n]);return _},t.has_lower_subs=D,t.has_upper_subs=F,t.get_inputs=G,t.get_outputs=k,t.find_subs=function(e,t){var r=null;return J.traverse(e,function(e,a){return a.type==t&&(r=a,!0)}),r},t.debug_convert_to_dot=function(e){var t="digraph scenegraph {\n";t+="    ",t+='size="11.7,16.5";\n',t+="    ",t+='ratio="fill";\n',t+="    ",t+='node [shape=box margin="0.25,0.055"];\n';var r=K(e);return J.traverse(e,function(e,a){t+="    ",t+=B(e,a,r)}),J.traverse_edges(e,function(e,a,_){t+="    ",t+=X(e,a,_,r)}),t+="}"},t.create_rendering_queue=function(e){for(var t=J.topsort_attr(e),r=[],a=0;a<t.length;a++){var _=t[a];_.enqueue&&r.push(_)}return r}}var _=r(0),n=r(5),o=r(14),i=r(4),s=r(48),c=r(49),E=r(34),l=r(30),T=r(22),u=r(11),d=r(17),f=r(2),P=Object(_.a)("__scenegraph",a);t.a=P},function(e,t,r){"use strict";function a(e,t){function r(e){return{type:e,obj_parent:null,target:null,use_offset:!1,tsr_restore:null,tsr_offset:null,euler_offset:null,axes:null,track_axis:null,vertical_axis:null,use_target_z:!1,influence:0,bone_name:"",softness:0,clamp_left:0,clamp_right:0,clamp_up:0,clamp_down:0,dist_min:0,dist_max:0,left_edge:!1,left_right_dist:0,top_edge:!1,top_bottom_dist:0,distance:0,hor_units:"",vert_units:""}}function a(e,t){e.constraint&&e.constraint.obj_parent&&u(e.constraint.obj_parent,e),t.obj_parent&&_(t.obj_parent,e),e.constraint=t}function _(e,t){-1==e.cons_descends.indexOf(t)?e.cons_descends.push(t):h.panic("Descendant object override is forbidden")}function u(e,t){var r=e.cons_descends.indexOf(t);-1!=r?e.cons_descends.splice(r,1):h.panic("No descendant object")}function d(e,t,_,n,o,i){var s=r(b);s.obj_parent=t,s.track_axis=new Float32Array(_),s.vertical_axis=new Float32Array(n),s.use_target_z=o,s.tsr_restore=new Float32Array(e.render.world_tsr),s.influence=i,a(e,s),k(e,s,0)}function f(e,t,_,n,o,i){var s=r(Y);s.obj_parent=t,s.tsr_offset=c.b(),c.v(_,s.tsr_offset),s.axes=new Float32Array(n),s.influence=i,s.use_offset=o,s.tsr_restore=new Float32Array(e.render.world_tsr),a(e,s),k(e,s,0)}function P(e,t,_){var n=r(L);n.obj_parent=t,n.tsr_offset=c.b(),c.a(e.render.world_tsr,n.tsr_offset),n.tsr_restore=new Float32Array(e.render.world_tsr),n.influence=_,a(e,n),k(e,n,0)}function A(e,t,_){var n=r(M);n.obj_parent=t,n.tsr_offset=new Float32Array(_),a(e,n),k(e,n,0)}function S(e,t,_,n){var o=r(y);o.obj_parent=t,o.bone_name=_,o.tsr_offset=new Float32Array(n),a(e,o),k(e,o,0)}function p(e,t,_){var n=r(x);if(n.obj_parent=t,n.tsr_restore=new Float32Array(e.render.world_tsr),n.tsr_offset=c.b(),E._17(_.right)?(n.left_edge=!1,n.left_right_dist=_.right):E._17(_.left)?(n.left_edge=!0,n.left_right_dist=_.left):(n.left_edge=!0,n.left_right_dist=0),E._17(_.bottom)?(n.top_edge=!1,n.top_bottom_dist=_.bottom):E._17(_.top)?(n.top_edge=!0,n.top_bottom_dist=_.top):(n.top_edge=!0,n.top_bottom_dist=0),E._17(_.distance)?n.distance=_.distance:n.distance=0,E._17(_.rotation))var o=new Float32Array(_.rotation);else var o=l.create();c.r(o,n.tsr_offset),E._17(_.hor_units)?n.hor_units=_.hor_units:n.hor_units="widths",E._17(_.vert_units)?n.vert_units=_.vert_units:n.vert_units="heights",a(e,n),k(e,n,0)}function v(e,t,a,_,n,o){var i=r(U);i.bone_name=a,i.target=t,i.tsr_offset=c.b(),c.v(new Float32Array(_),i.tsr_offset),c.r(new Float32Array(n),i.tsr_offset),c.s(o,i.tsr_offset),m(e,i),N(e,i)}function m(e,t){var r=t.target,a=t.bone_name,_=e.render.bone_pointers[a];O(r,e,a),r.cons_armat_bone_descends.push([e,a]),_.constraint=t}function O(e,t,r){for(var a=e.cons_armat_bone_descends,_=0;_<a;_++){var n=a[_];if(n[0]==t&&n[1]==r)return void a.splice(_,1)}}function N(e,t){switch(t.type){case U:var r=t.target,a=r.render.world_tsr,_=e.render.world_tsr,n=D;c.p(_,n),c.q(n,a,n),i.c(e,t.bone_name,n,!1)}e.need_update_transform=!0}function g(e,t){for(var r=0;r<e.length;r++){var a=e[r];if(!g(a.cons_descends,t)||a.name==t.name)return!1}return!0}var h=Object(n.a)(e),R=Object(o.a)(e),I=Object(s.a)(e),b=3,Y=8,L=11,M=13,y=14,x=17,U=18;t.CONS_TYPE_STIFF_OBJ=1,t.CONS_TYPE_STIFF_BONE=2,t.CONS_TYPE_TRACK_OBJ=b,t.CONS_TYPE_FOLLOW_OBJ=5,t.CONS_TYPE_STIFF_TRANS_OBJ=7,t.CONS_TYPE_COPY_LOC_OBJ=Y,t.CONS_TYPE_SEMI_STIFF_OBJ=12,t.CONS_TYPE_CHILD_OF=M,t.CONS_TYPE_CHILD_OF_BONE=y,t.CONS_TYPE_SEMI_SOFT_OBJ=15,t.CONS_TYPE_STIFF_TRANS_ROT_OBJ=16,t.CONS_TYPE_STIFF_VIEWPORT=x,t.BONE_CONS_TYPE_STIFF_OBJ=U;var w=(new Float32Array(2),new Float32Array(2),new Float32Array(3)),C=(new Float32Array(3),new Float32Array(4)),D=(new Float32Array(4),c.b()),F=new Float32Array(3);t.append_stiff_obj=function(e,t,_,n,o){var i=r(1);i.obj_parent=t,i.tsr_offset=c.b(),n=n||l.create(),c.v(_,i.tsr_offset),c.s(o,i.tsr_offset),c.r(n,i.tsr_offset),i.tsr_restore=new Float32Array(e.render.world_tsr),a(e,i),k(e,i,0)},t.append_stiff_bone=function(e,t,_,n,o,i){var s=r(2);s.obj_parent=t,s.bone_name=_,s.tsr_restore=new Float32Array(e.render.world_tsr),s.tsr_offset=c.b(),c.v(new Float32Array(n),s.tsr_offset),c.r(new Float32Array(o),s.tsr_offset),c.s(i,s.tsr_offset),a(e,s),k(e,s,0)},t.append_semi_stiff_obj=function(){var e=l.create(),t=l.create();return function(_,n,o,i,s,T,u,d){var f=r(12),P=c.g(n.render.world_tsr,t);if(i){var A=l.copy(i,e);l.multiply(P,A,A),c.r(A,_.render.world_tsr)}else i=l.create();f.obj_parent=n,f.tsr_offset=c.b(),c.v(o,f.tsr_offset),c.r(i,f.tsr_offset),f.parent_prev_rotation=new Float32Array(P),f.clamp_left=E.A(s),f.clamp_right=E.A(T),f.clamp_up=E.B(u,-Math.PI,Math.PI),f.clamp_down=E.B(d,-Math.PI,Math.PI),f.tsr_restore=new Float32Array(_.render.world_tsr),a(_,f),k(_,f,0)}}(),t.append_semi_soft_obj=function(e,t,_,n){var o=r(15);o.obj_parent=t,o.softness=n,o.tsr_restore=new Float32Array(e.render.world_tsr),o.tsr_offset=c.b(),c.v(new Float32Array(_),o.tsr_offset),a(e,o),k(e,o,0)},t.append_stiff_trans_rot_obj=function(e,t,_,n,o){var i=r(16);i.obj_parent=t,i.tsr_restore=new Float32Array(e.render.world_tsr),i.tsr_offset=c.b(),c.v(new Float32Array(_),i.tsr_offset),c.r(new Float32Array(n),i.tsr_offset),c.s(o,i.tsr_offset),a(e,i),k(e,i,0)},t.remove_parent_descendant=u,t.append_track_obj=d,t.append_follow_obj=function(e,t,_,n){var o=r(5);o.obj_parent=t,o.dist_min=_,o.dist_max=n,o.tsr_restore=new Float32Array(e.render.world_tsr),a(e,o),k(e,o,0)},t.append_stiff_trans_obj=function(e,t,_){var n=r(7);n.obj_parent=t,n.tsr_offset=c.b(),n.tsr_restore=new Float32Array(e.render.world_tsr),c.v(new Float32Array(_),n.tsr_offset),a(e,n),k(e,n,0)},t.append_copy_loc_obj=f;var G=function(){var e=l.create();return function(t,_,n,o,i){var s=r(9);s.obj_parent=_;var l=c.g(t.render.world_tsr,e);s.euler_offset=E._36(l,new Float32Array(3)),s.axes=new Float32Array(n),s.influence=i,s.use_offset=o,s.tsr_restore=new Float32Array(t.render.world_tsr),a(t,s),k(t,s,0)}}();t.append_copy_rot_obj=G,t.append_copy_trans_obj=P,t.append_child_of=A,t.append_child_of_bone=S,t.append_stiff_viewport=p,t.update_constraint=function(e,t){e.constraint&&k(e,e.constraint,t)};var k=function(){var e=l.create(),t=l.create(),r=l.create(),a=c.b(),_=T.create(),n=T.create(),o=T.create();return function(s,u,d){switch(u.type){case 1:c.q(u.obj_parent.render.world_tsr,u.tsr_offset,s.render.world_tsr);break;case 12:var f=c.j(s.render.world_tsr,_),P=c.g(s.render.world_tsr,e),A=c.j(u.tsr_offset,n),S=u.obj_parent.render.world_tsr,p=c.g(u.obj_parent.render.world_tsr,t);l.multiply(l.invert(u.parent_prev_rotation,u.parent_prev_rotation),P,P),l.multiply(p,P,P),c.r(P,s.render.world_tsr),c.D(A,S,f),c.v(f,s.render.world_tsr),l.copy(p,u.parent_prev_rotation),K(s,u);break;case 15:var f=c.j(s.render.world_tsr,_),P=c.g(s.render.world_tsr,e),S=u.obj_parent.render.world_tsr,v=c.j(S,n),m=u.softness,O=l.copy(P,t),A=c.j(u.tsr_offset,o),N=c.D(A,S,o);E._54(N,f,d,m,f),c.v(f,s.render.world_tsr),E._31(f,O,v,E.c),c.v(v,S),E._52(O,P,d,.16*m,P),c.r(P,s.render.world_tsr);break;case 2:var A=c.j(u.tsr_offset,n),g=c.i(u.tsr_offset),h=c.g(u.tsr_offset,t),R=i.b(u.obj_parent,u.bone_name,!0,!1,a);c.q(u.obj_parent.render.world_tsr,R,R);var P=c.g(R,e);l.multiply(P,h,P),c.r(P,s.render.world_tsr),c.s(g*c.i(R),s.render.world_tsr);var f=c.j(s.render.world_tsr,_);c.D(A,R,f),c.v(f,s.render.world_tsr);break;case b:var f=c.j(s.render.world_tsr,_),P=c.g(s.render.world_tsr,e),U=c.j(u.obj_parent.render.world_tsr,n),w=u.influence;if(u.use_target_z)var C=c.g(u.obj_parent.render.world_tsr,t),D=T.transformQuat(E.f,C,o);else var D=E.f;E._31(f,P,U,u.track_axis);var G=T.subtract(U,f,n);T.normalize(G,G),E._32(P,u.vertical_axis,D,G);var k=c.g(u.tsr_restore,t);l.slerp(k,P,w,P),c.r(P,s.render.world_tsr),c.v(f,u.tsr_restore);break;case 5:var f=c.j(s.render.world_tsr,_),P=c.g(s.render.world_tsr,e),U=c.j(u.obj_parent.render.world_tsr,n);E._31(f,P,U,E.c),c.v(U,u.obj_parent.render.world_tsr);var B=T.dist(f,U);if(B>u.dist_max)var X=B-u.dist_max;else if(B<u.dist_min)var X=B-u.dist_min;else var X=0;X&&(T.sub(U,f,o),T.normalize(o,o),T.scale(_,X,o),T.add(f,o,f),c.v(f,s.render.world_tsr));break;case 7:var S=u.obj_parent.render.world_tsr,f=c.j(s.render.world_tsr,_),A=c.j(u.tsr_offset,n);c.D(A,S,f),c.v(f,s.render.world_tsr),c.r(c.g(s.render.world_tsr,e),u.tsr_restore);break;case Y:var v=c.j(u.obj_parent.render.world_tsr,_),j=u.axes,H=c.j(u.tsr_offset,n),A=T.set(0,0,0,o);u.use_offset&&T.add(A,H,A);var w=u.influence,f=_;j[0]&&(f[0]=(1-w)*H[0]+w*(E._50(j[0])*v[0]+A[0])),j[1]&&(f[1]=(1-w)*H[1]+w*(E._50(j[1])*v[1]+A[1])),j[2]&&(f[2]=(1-w)*H[2]+w*(E._50(j[2])*v[2]+A[2])),c.v(f,s.render.world_tsr),c.r(c.g(s.render.world_tsr,e),u.tsr_restore);break;case 9:var j=u.axes,p=c.g(u.obj_parent.render.world_tsr,e),Q=E._35(p,u.euler_offset,n);if(E.Q(Q,u.euler_offset),j[0]){if(u.use_offset){var z=T.set(u.euler_offset[0],0,0,_);E._45(Q,z,Q)}Q[0]=E._50(j[0])*Q[0]}else Q[0]=u.euler_offset[0];if(j[1]){if(u.use_offset){var z=T.set(0,u.euler_offset[1],0,_);E._45(Q,z,Q)}Q[1]=E._50(j[1])*Q[1]}else Q[1]=u.euler_offset[1];if(j[2]){if(u.use_offset){var z=T.set(0,0,u.euler_offset[2],_);E._45(Q,z,Q)}Q[2]=E._50(j[2])*Q[2]}else Q[2]=u.euler_offset[2];E.Q(Q,u.euler_offset);var w=u.influence,q=E.Y(Q,e),V=c.g(u.tsr_restore,t),P=l.slerp(V,q,w,e);c.r(P,s.render.world_tsr),c.v(c.j(s.render.world_tsr,_),u.tsr_restore);break;case L:var w=u.influence,v=c.j(u.obj_parent.render.world_tsr,_),p=c.g(u.obj_parent.render.world_tsr,e),W=c.j(u.tsr_offset,n),k=c.g(u.tsr_offset,t),f=E.G(W,v,w,_);c.v(f,s.render.world_tsr);var P=l.slerp(k,p,w,e);c.r(P,s.render.world_tsr),c.v(c.j(s.render.world_tsr,_),u.tsr_restore);break;case 16:var P=c.g(s.render.world_tsr,e),S=u.obj_parent.render.world_tsr,p=c.g(u.obj_parent.render.world_tsr,t),A=c.j(u.tsr_offset,n),h=c.g(u.tsr_offset,r);l.multiply(p,h,P),c.r(P,s.render.world_tsr);var f=c.D(A,S,_);c.v(f,s.render.world_tsr);break;case M:var J=u.obj_parent.render,Z=s.render;c.q(J.world_tsr,u.tsr_offset,Z.world_tsr);break;case y:var $=u.tsr_offset,R=a;i.b(u.obj_parent,u.bone_name,!0,!1,R),c.q(u.obj_parent.render.world_tsr,R,R),c.q(R,$,s.render.world_tsr);break;case x:var ee=u.obj_parent,te=I.get_first_cam(ee),f=_,re=I.get_edge(te,"LEFT"),ae=I.get_edge(te,"RIGHT"),_e=I.get_edge(te,"TOP"),ne=I.get_edge(te,"BOTTOM");if("heights"==u.hor_units)var oe=_e-ne;else var oe=ae-re;if(u.left_edge?f[0]=re+oe*u.left_right_dist:f[0]=ae-oe*u.left_right_dist,"heights"==u.vert_units)var ie=_e-ne;else var ie=ae-re;if(u.top_edge?f[1]=_e-ie*u.top_bottom_dist:f[1]=ne+ie*u.top_bottom_dist,I.is_ortho(te))f[2]=-u.distance;else{f[2]=-1,T.normalize(f,f);var se=u.distance/Math.abs(f[2]);T.scale(f,se,f)}c.y(f,ee.render.world_tsr,f);var ce=c.j(ee.render.world_tsr,n);T.add(ce,f,f),c.v(f,s.render.world_tsr);var V=c.g(s.render.world_tsr,e),Ee=c.g(ee.render.world_tsr,t),h=c.g(u.tsr_offset,r);l.multiply(Ee,h,V),c.r(V,s.render.world_tsr)}if("CAMERA"==s.render.type&&s.render.move_style!=I.MS_STATIC){var le=s.render.vertical_axis;if(12==u.type){var p=c.g(u.obj_parent.render.world_tsr,e);le=T.transformQuat(le,p,F)}I.correct_up(s,le)}}}();t.update_bone_constraint=function(e,t){var r=e.render.bone_pointers[t];r.constraint&&N(e,r.constraint)};var K=function(){var e=l.create(),t=l.create(),r=l.create(),a=l.create(),_=new Float32Array(2),n=new Float32Array(2);return function(o,i){var s=c.g(o.render.world_tsr,e),T=c.g(i.obj_parent.render.world_tsr,t),u=c.g(i.tsr_offset,r),d=l.multiply(T,u,a),f=I.get_camera_angles_from_quat(d,o.render.vertical_axis,_),P=I.get_camera_angles_from_quat(s,o.render.vertical_axis,n),A=E.H(P[0],f[0]+i.clamp_right,f[0]+i.clamp_left),S=E.H(P[1],f[1]+i.clamp_down,f[1]+i.clamp_up);E._47(s,o.render.vertical_axis,A,S,s),c.r(s,o.render.world_tsr)}}();t.check_constraint=function(e){return!!e.constraint},t.remove=function(e,t){e.constraint.obj_parent&&u(e.constraint.obj_parent,e),t&&c.a(e.constraint.tsr_restore,e.render.world_tsr),e.constraint=null},t.get_type=function(e){return e.constraint?e.constraint.type:null},t.has_child_of=function(e){var t=e.constraint;return!(!t||t.type!=M&&t.type!=y)},t.get_child_of_parent_tsr=function(e){var t=e.constraint;if(t&&t.type==M)return t.obj_parent.render.world_tsr;if(t&&t.type==y){var r=D;return i.b(t.obj_parent,t.bone_name,!0,!1,r),c.q(t.obj_parent.render.world_tsr,r,r),r}return null},t.get_child_of_offset=function(e){var t=e.constraint;return!t||t.type!=M&&t.type!=y?null:t.tsr_offset},t.prepare_object_relations=function(e,t){for(var r=t.render,a=0;a<e.constraints.length;a++){var _=e.constraints[a],n=_.type;if(_.target){var o=_.target._object;if("COPY_LOCATION"==n){var i=new Float32Array(c.j(t.render.world_tsr,w)),s=new Float32Array(_.axes);f(t,o,i,s,_.use_offset,_.influence)}else if("COPY_ROTATION"==n){var s=new Float32Array(_.axes);G(t,o,s,_.use_offset,_.influence)}else if("COPY_TRANSFORMS"==n)P(t,o,_.influence);else if("TRACK_TO"==n){var l=_.track_axis;if("TRACK_Y"==l)var T=E.e;else if("TRACK_NEGATIVE_Y"==l)var T=E.b;else if("TRACK_X"==l)var T=E.d;else if("TRACK_NEGATIVE_X"==l)var T=E.a;else if("TRACK_Z"==l)var T=E.f;else if("TRACK_NEGATIVE_Z"==l)var T=E.c;var u=_.up_axis;if("UP_X"==u)var m=E.d;else if("UP_Y"==u)var m=E.e;else if("UP_Z"==u)var m=E.f;d(t,o,T,m,_.use_target_z,_.influence)}}}if(t.parent){!t.parent_is_dupli&&t.physics_settings.use_collision_compound&&t.parent.physics_settings.use_collision_compound&&(t.use_obj_physics=!1);for(var O=!1,a=0;a<t.scenes_data.length;a++)if(t.scenes_data[a].scene._physics){O=!0;break}if(O&&R.has_dynamic_settings(t)){if(t.parent_is_dupli)var N=c.a(r.world_tsr,c.b());else var N=r.world_tsr;c.q(t.parent.render.world_tsr,N,r.world_tsr)}else if(t.parent_is_dupli||!t.parent_bone){var N=c.a(r.world_tsr,c.b());if(t.viewport_alignment&&"CAMERA"==t.parent.type){var g={distance:t.viewport_alignment.distance,rotation:c.g(N,C)};switch(t.viewport_alignment.alignment){case"TOP_LEFT":g.top=0,g.left=0;break;case"TOP":g.top=0,g.left=.5;break;case"TOP_RIGHT":g.top=0,g.right=0;break;case"LEFT":g.top=.5,g.left=0;break;case"CENTER":g.top=.5,g.left=.5;break;case"RIGHT":g.top=.5,g.right=0;break;case"BOTTOM_LEFT":g.bottom=0,g.left=0;break;case"BOTTOM":g.bottom=0,g.left=.5;break;case"BOTTOM_RIGHT":g.bottom=0,g.right=0}p(t,t.parent,g)}else A(t,t.parent,N)}else{var N=c.a(r.world_tsr,c.b());S(t,t.parent,t.parent_bone,N)}}if("ARMATURE"==t.type)for(var h=e.pose.bones,a=0;a<h.length;a++){var I=h[a],b=I.constraints;if(b)for(var Y=0;Y<b.length;Y++){var L=b[Y];if("COPY_TRANSFORMS"==L.type&&!L.subtarget&&!L.mute){var o=L.target._object;v(t,o,I.name,E.m,E.k,1)}}}},t.check_compatibility=function(e,t){return g(e.cons_descends,t)},t.check_self_applying=function(e,t){return e.name!=t.name}}var _=r(0),n=r(5),o=r(19),i=r(59),s=r(14),c=r(6),E=r(2),l=r(8),T=r(3),u=Object(_.a)("__constraints",a);t.a=u},function(e,t,r){"use strict";function a(e,t){function r(e,t){return{name:e.name,type:e.type,label:e.label,slot_idx_order:e.slot_idx_order,slot_idx_jump:e.slot_idx_jump,frame_start:e.frame_range[0],frame_end:e.frame_range[1],frame_start_mask:!e.frame_range_mask||e.frame_range_mask[0],frame_end_mask:!e.frame_range_mask||e.frame_range_mask[1],param_name:e.param_name,op:e.operation,mute:e.mute,dupli_name_list:e.object,anim_name:e.anim_name,parse_json_vars:e.parse_json_vars,parse_json_paths:e.parse_json_paths,objects_paths:e.objects_paths,nodes_paths:e.nodes_paths,floats:e.floats,bools:e.bools,vars:e.variables,strings:e.strings,logic_functions:e.logic_functions,logic_node_trees:e.logic_node_trees,materials_names:e.materials_names,shader_nd_type:e.shader_nd_type,common_usage_names:e.common_usage_names,encode_json_vars:e.encode_json_vars,encode_json_paths:e.encode_json_paths,thread:t,process_node:Jt[e.type]?Jt[e.type]:L,processed:!1,links_dict:e.links,instances:[],func_id:-1,links_keys:null,select_object_idx:-1}}function a(e,t,r){var a=t.thread_index+1-e.instances.length;if(a>0)for(var _=0;_<a;_++)e.instances.push(0);return e.instances[t.thread_index]||(e.instances[t.thread_index]=function(){return{objects:{},slot_idx_jump:-1,state:tt,sel_obj_idxs:[],timer:-1,camera_state:{},anim_slot:Ie.SLOT_ALL,obj_state:null}}(),r&&r(e,e.instances[t.thread_index],t)),e.instances[t.thread_index]}function _(e,t,r){return e[0]?t[e[1]]:r[e[1]]}function b(e,t,r,a){e[0]?t[e[1]]=a:r[e[1]]=a}function Y(e,t,r,a,_,n){switch(t.state){case Ze:break;case $e:r.curr_node=e.slot_idx_order}}function L(e,t,r,a,_,n){switch(t.state){case Ze:xe.error("Unknown node type: "+e.type);break;case $e:r.curr_node=e.slot_idx_order}}function M(e){var t=e.thread_state.callstack,r=t.length,_=[];r<=1&&_.push(e.nodes);for(var n=1;n<r;n++)_.push(t[n].logic_func.func.nodes);for(var n=0;n<_.length;n++)for(var o=0;o<_[n].length;o++){var i=_[n][o];if("PLAY"==i.type){var s=a(i,e.thread_state);s.state=tt}}}function y(e,t){for(var r=e.nodes,_=0;_<r.length;_++){var n=r[_];if("SWITCH_SELECT"==n.type&&n!=t){a(n,e.thread_state).state=_t}}}function x(e,t,r,a){for(var _=Zt[e],n=0;n<Zt[e].logic_threads.length;n++)_.curr_thread=Zt[e].logic_threads[n],me(Zt[e].logic_threads[n],_,t,r,a)}function U(e,t,r){var a=we.get("url_params");if(a&&e in a)return Number(a[e]);var _=r?location.hash:location.search;if(!_)return 0;for(var n=_.slice(1).split("&"),o=0;o<n.length;o++){var i=n[o].split("=");if(i.length>1&&i[0]==e)return Ne(i[1],t)}return 0}function w(e){return ye.get_world_by_name(e.dupli_name_list[0],0)}function C(e,t,r,a,_,n){switch(t.state){case $e:0==r.callstack.length&&r.callstack.push({caller_node:null,variables:r.variables,logic_func:null}),r.curr_node=e.slot_idx_order}}function D(e,t,r,n,o,i){function s(e,t,r){c||(t.obj=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0))}var c=e.bools.id0;switch(t.state){case Ze:break;case $e:var E=a(e,r,s),l=c?_(e.vars.id0,t.variables,r.variables):E.obj;e.bools.ch?Ue.change_visibility_rec(l,!0):Ue.change_visibility(l,!0),r.curr_node=e.slot_idx_order}}function F(e,t,r,n,o,i){function s(e,t,r){c||(t.obj=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0))}var c=e.bools.id0;switch(t.state){case Ze:break;case $e:var E=a(e,r,s),l=c?_(e.vars.id0,t.variables,r.variables):E.obj;e.bools.ch?Ue.change_visibility_rec(l,!1):Ue.change_visibility(l,!1),r.curr_node=e.slot_idx_order}}function G(e,t,r,a,_,n){switch(t.state){case $e:b(e.vars.id0,t.variables,r.variables,U(e.param_name,e.floats.ptp,e.bools.hsh)),r.curr_node=e.slot_idx_order}}function k(e,t,r,a,_,n){switch(t.state){case Ze:xe.error("Logic script error: node is deprecated. Node: ",e.name),e.mute=!0}}function K(e,t,r){var n=ye.get_selectable_objects(),o=a(e,r.thread_state);o.sel_obj_idxs=[],o.links_idxs=[];for(var i in e.objects_paths){var s=e.bools[i]?_(e.vars[i],t.variables,r.thread_state.variables):ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[i],0),c=n.indexOf(s);if(-1==c)return xe.error("logic script error: non-selectable object:",e.objects_paths[i][e.objects_paths[i].length-1]),-1;o.sel_obj_idxs.push(c),o.links_idxs.push(e.links_dict[i])}o.sel_objs_len=n.length;for(var E=[],l=0;l<n.length;l++)E.push(Ce.create_selection_sensor(n[l],!1));var T=tr();Ce.create_sensor_manifold(null,"LOGIC_NODES_SWITCH_SELECT_"+he(e.label),Ce.CT_SHOT,E,Ce.default_OR_logic_fun,T,[e,t,r])}function B(e,t,r,_,n,o){function i(e,t,r){t.state=_t}switch(t.state){case Ze:break;case $e:var s=a(e,r,i);if(s.state==_t)s.state=nt,y(t.logic_threads[r.thread_index],e),K(e,t,t.logic_threads[r.thread_index]);else if(s.state==nt)s.state=ot;else if(s.state==it||s.state==st){if(e.vars.vd&&e.vars.vd[1]){var c=ye.get_selectable_objects();b(e.vars.vd,t.variables,r.variables,c[s.select_object_idx])}r.curr_node=s.state?s.slot_idx_jump:e.slot_idx_order,s.state=_t,Ce.remove_sensor_manifold(null,"LOGIC_NODES_SWITCH_SELECT_"+he(e.label));break}}}function X(e,t,r,a,n,o){switch(t.state){case Ze:var i=Object.keys(e.vars);for(var s in i)i[s].startsWith("id")||i.splice(s,1);e.links_keys=i;break;case $e:var c=_(e.vars.v,t.variables,r.variables);for(var s in e.links_keys){if(c==_(e.vars[e.links_keys[s]],t.variables,r.variables))return void(r.curr_node=e.links_dict[e.links_keys[s]])}r.curr_node=e.slot_idx_order}}function j(e,t,r,_,n,o){switch(t.state){case Ze:Me.stop_nla(),e.bools.not_wait||(e.bools.not_wait=!1);break;case $e:var i=a(e,r);switch(i.state){case tt:if(Me.is_play(t._nla)){if(t.curr_thread==t.nla_thread&&r.in_progress)break;var s=t.nla_thread;if(s){var c=le(s),E=c[s.thread_state.curr_node];s.thread_state.curr_node=E.slot_idx_order,M(t.nla_thread)}}if(r.in_progress=!e.bools.not_wait,t.nla_thread=t.curr_thread,i.state=rt,e.frame_start_mask&&(Me.set_range_start(e.frame_start),Me.set_offset_from_range_start(_)),e.frame_end_mask)Me.set_range_end(e.frame_end);else{var l=Me.get_frame(_),T=-1;for(var u in t.sorted_markers_values)if(l<t.sorted_markers_values[u]){T=u;break}T>=0?Me.set_range_end(t.sorted_markers_values[T]):Me.set_range_end(Me.get_frame_end())}Me.play_nla(null),e.bools.not_wait&&(r.curr_node=e.slot_idx_order,i.state=tt,r.in_progress=!1);break;case rt:Me.is_play()||(r.curr_node=e.slot_idx_order,i.state=tt,r.in_progress=!1);break;case at:r.curr_node=e.slot_idx_order,i.state=tt,t.nla_thread=null,r.in_progress=!1;break;default:be.panic("Unknown state of "+e.name),i.state=tt}}}function H(e,t,r,a,n,o){switch(t.state){case $e:var i=0,s="{";for(var c in e.vars){i>0&&(s+=", ");var E=e.vars[c][1],l=_(e.vars[c],t.variables,r.variables);s+='"'+E+'": ';try{s+=JSON.stringify(l)}catch(e){s+=l?'{"name": "'+l.name+'", "type": "'+l.type+'"}':"Object"}++i}s+="}",xe.log(e.common_usage_names.msg,s),r.curr_node=e.slot_idx_order}}function Q(e,t,r,a,_,n){switch(t.state){case $e:e.bools.rst&&Me.set_offset_from_range_start(a),Me.stop_nla(),r.curr_node=e.slot_idx_order}}function z(e,t,r,a,n,o){switch(t.state){case $e:var i=e.bools.url?Ne(_(e.vars.url,t.variables,r.variables),ut):e.strings.url;window.location.href=i,t.state=et}}function q(e,t,r,n,o,i){function s(e,r,_,n,o){var i=JSON.stringify(e),s=o[0],c=o[1],E=a(s,c);b(o[0].vars.dst,t.variables,c.variables,i),E.state=1}var c=a(e,r);switch(t.state){case $e:switch(c.state){case ct:c.state=Et;var E=e.bools.url?Ne(_(e.vars.url,t.variables,r.variables),ut):e.strings.url,l={};if(e.bools.ct&&(l["Content-Type"]=e.strings.ct),"GET"==e.common_usage_names.request_type)Ye.enqueue([{id:E,type:Ye.AT_JSON,url:E,overwrite_header:l,param:[e,r]}],s,null,null,null);else if("POST"==e.common_usage_names.request_type){var T=Ne(_(e.vars.dst1,t.variables,r.variables),ut);Ye.enqueue([{id:E,type:Ye.AT_JSON,url:E,overwrite_header:l,request_method:"POST",post_data:T,param:[e,r]}],s,null,null,null)}break;case Et:break;case lt:c.state=ct,r.curr_node=e.slot_idx_order}}}function V(e,t,r,_,n,o){function i(e,t,r){for(var a=0;a<2;a++)t.objects["id"+a]=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths["id"+a],0),t.objects["id"+a]||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}switch(t.state){case Ze:break;case $e:var s=a(e,r,i);ye.inherit_material(s.objects.id0,e.materials_names.id0,s.objects.id1,e.materials_names.id1),r.curr_node=e.slot_idx_order}}function W(e,t,r,n,o,i){var s=a(e,r);switch(t.state){case Ze:break;case $e:if(s.state==tt)return s.state=rt,s.timer=0,void(r.in_progress=!0);if(s.state==rt){s.timer+=o;(e.bools.dl?Ne(_(e.vars.dl,t.variables,r.variables),Tt):e.floats.dl)<s.timer&&(s.state=tt,r.curr_node=e.slot_idx_order,r.in_progress=!1)}}}function J(e,t,r,n,o,i){function s(e,t,r){var a=t.objects.id0=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0);a||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);var _=e.common_usage_names.sk;Fe.check_shape_keys(a)?Fe.has_shape_key(a,_)||(xe.error("Wrong key name:",_),e.mute=!0):(xe.error("No shape keys in object:",a.name),e.mute=!0)}switch(t.state){case Ze:break;case $e:var c=a(e,r,s);Fe.apply_shape_key(c.objects.id0,e.common_usage_names.sk,e.bools.skv?Ne(_(e.vars.skv,t.variables,r.variables),Tt):e.floats.skv),r.curr_node=e.slot_idx_order}}function Z(e,t,r,n,o,i){function s(e,t,r){c||(t.obj=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),t.obj&&t.obj.render&&t.obj.render.outlining||(xe.error("Can't evaluate 'Outline' logic node: wrong object"),e.mute=!0))}var c=e.bools.id0;switch(t.state){case Ze:break;case $e:var E=a(e,r,s),l=c?_(e.vars.id0,t.variables,r.variables):E.obj;switch(e.common_usage_names.outline_operation){case"PLAY":var T=l.render.outline_anim_settings_default;ye.apply_outline_anim(l,T.outline_duration,T.outline_period,T.outline_relapses);break;case"STOP":ye.clear_outline_anim(l);break;case"INTENSITY":ye.set_outline_intensity(l,e.bools.in?Ne(_(e.vars.in,t.variables,r.variables),Tt):e.floats.in)}r.curr_node=e.slot_idx_order}}function $(e,t,r,n,o,i){function s(e,t,r,a){switch(Le.get_move_style(e)){case Le.MS_TARGET_CONTROLS:Le.set_trans_pivot(e,t,r);break;case Le.MS_EYE_CONTROLS:case Le.MS_STATIC:Be.set_tsr(e,a);break;case Le.MS_HOVER_CONTROLS:R.sub(r,t,He),R.normalize(He,He),Le.set_hover_pivot(e,r);var _=0,n=0;Qe[0]=He[0],Qe[1]=0,Qe[2]=He[2];var o=R.dot(Qe,He);n=Math.acos(o/(R.length(Qe)*R.length(He))),_=He[2]?Math.atan(He[0]/He[2]):He[0]>0?0:Math.PI,He[2]>0&&He[0]>0?Ve[1]=-(Math.PI+Ve[1]):He[2]>0&&He[0]<0?Ve[1]=-(Math.PI+Ve[1]):He[2]<0&&He[0]<0?(Ve[0]+=Math.PI,_=-(Math.PI-_)):He[2]<0&&He[0]>0&&(Ve[0]+=Math.PI,_-=Math.PI),Le.set_rotation_hover_angles(e,_+Math.PI,-n)}Be.update_transform(e),Ge.sync_transform(e)}function c(e,t,r,a){S.lookAt(t,r,h.f,Je),S.invert(Je,Je);var _=We;A.fromMat4(Je,_),v.fromMat3(_,je),v.normalize(je,je);var n=g.i(e.render.world_tsr);g.t(t,n,je,a)}function E(e,r,a){var _=null;_=r.objects.ca=Ee(e,"id0",l,t.variables,a.variables),_||l||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.objects.tr=Ee(e,"id1",T,t.variables,a.variables),r.objects.tr||T||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.objects.ta=Ee(e,"id2",u,t.variables,a.variables),r.objects.ta||u||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.state=tt,r.camera_state={trans_start:new Float32Array(3),trans_end:new Float32Array(3),interp_trans:new Float32Array(3),target_start:new Float32Array(3),target_end:new Float32Array(3),interp_target:new Float32Array(3),tsr_start:g.b(),tsr_end:g.b(),interp_tsr:g.b()}}var l=e.bools.id0,T=e.bools.id1,u=e.bools.id2;switch(t.state){case Ze:break;case $e:var d=a(e,r,E),f=l?_(e.vars.id0,t.variables,r.variables):d.objects.ca,P=T?_(e.vars.id1,t.variables,r.variables):d.objects.tr,p=u?_(e.vars.id2,t.variables,r.variables):d.objects.ta,m=g.j(P.render.world_tsr,He),O=g.j(p.render.world_tsr,ze);switch(d.state){case tt:var N=e.bools.dur?Ne(_(e.vars.dur,t.variables,r.variables),Tt):e.floats.dur;if(0==N)return c(f,m,O,d.camera_state.tsr_end),s(f,m,O,d.camera_state.tsr_end),void(r.curr_node=e.slot_idx_order);var I=g.j(f.render.world_tsr,qe);R.copy(I,d.camera_state.trans_start);var b=Le.get_move_style(f);b==Le.MS_HOVER_CONTROLS?R.copy(f.render.hover_pivot,d.camera_state.target_start):b==Le.MS_STATIC||b==Le.MS_EYE_CONTROLS?(g.a(f.render.world_tsr,d.camera_state.tsr_start),c(f,m,O,d.camera_state.tsr_end)):R.copy(f.render.pivot,d.camera_state.target_start),R.copy(m,d.camera_state.trans_end),R.copy(O,d.camera_state.target_end),d.state=rt;var Y=Ke.animate(0,1,1e3*N,function(e){Ue.check_active()&&(b==Le.MS_STATIC||b==Le.MS_EYE_CONTROLS?g.o(d.camera_state.tsr_start,d.camera_state.tsr_end,h._53(e),d.camera_state.interp_tsr):(d.camera_state.interp_target=R.lerp(d.camera_state.target_start,d.camera_state.target_end,h._53(e),d.camera_state.interp_target),d.camera_state.interp_trans=R.lerp(d.camera_state.trans_start,d.camera_state.trans_end,h._53(e),d.camera_state.interp_trans)),s(f,d.camera_state.interp_trans,d.camera_state.interp_target,d.camera_state.interp_tsr),1==e&&(d.state=at))});break;case rt:break;case at:Ke.clear_animation(Y),d.state=tt,r.curr_node=e.slot_idx_order}}}function ee(e,t,r,n,o,i){function s(e,t,r){if(!c.id0){(t.objects.id0=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0))||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}c.pvo&&!c.id1&&(t.objects.id1=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id1,0))}var c=e.bools;switch(t.state){case Ze:break;case $e:var E=a(e,r,s),l=c.id0?_(e.vars.id0,t.variables,r.variables):E.objects.id0,T=l.render;if(E.cam_state={target_cam_upside_down:T.target_cam_upside_down,use_panning:T.use_panning,horizontal_limits:T.horizontal_limits,vertical_limits:T.vertical_limits,distance_limits:T.distance_limits,hover_horiz_trans_limits:T.hover_horiz_trans_limits,hover_vert_trans_limits:T.hover_vert_trans_limits,pivot_limits:T.pivot_limits,enable_hover_hor_rotation:T.enable_hover_hor_rotation},Xe.is_camera(l)){var u=l.render,d=E.cam_state;switch(Le.wipe_move_style(l),e.common_usage_names.camera_move_style){case Qt:u.move_style=Le.MS_STATIC;break;case qt:u.move_style=Le.MS_EYE_CONTROLS;var f=g.j(u.world_tsr,He);Le.setup_eye_model(l,f,null,d.horizontal_limits,d.vertical_limits);break;case Vt:u.move_style=Le.MS_HOVER_CONTROLS;var f=g.j(u.world_tsr,He),P=ze;if(e.bools.pvo){var A=c.id1?_(e.vars.id1,t.variables,r.variables):E.objects.id1;P=g.j(A.render.world_tsr,ze)}else P[0]=e.bools.pvx?Ne(_(e.vars.pvx,t.variables,r.variables),Tt):e.floats.pvx,P[1]=e.bools.pvy?Ne(_(e.vars.pvy,t.variables,r.variables),Tt):e.floats.pvy,P[2]=e.bools.pvz?Ne(_(e.vars.pvz,t.variables,r.variables),Tt):e.floats.pvz;Le.setup_hover_model(l,f,P,d.distance_limits,d.vertical_limits,d.hover_horiz_trans_limits,d.hover_vert_trans_limits,d.enable_hover_hor_rotation);break;case zt:u.move_style=Le.MS_TARGET_CONTROLS;var f=g.j(u.world_tsr,He),P=ze;if(e.bools.pvo){var A=c.id1?_(e.vars.id1,t.variables,r.variables):E.objects.id1;P=g.j(A.render.world_tsr,ze)}else P[0]=e.bools.pvx?Ne(_(e.vars.pvx,t.variables,r.variables),Tt):e.floats.pvx,P[1]=e.bools.pvy?Ne(_(e.vars.pvy,t.variables,r.variables),Tt):e.floats.pvy,P[2]=e.bools.pvz?Ne(_(e.vars.pvz,t.variables,r.variables),Tt):e.floats.pvz;Le.setup_target_model(l,f,P,d.horizontal_limits,d.vertical_limits,d.distance_limits,d.pivot_limits,d.use_panning)}var S=Qe;S[0]=e.bools.vtr?Ne(_(e.vars.vtr,t.variables,r.variables),Tt):e.floats.vtr,S[1]=e.bools.vro?Ne(_(e.vars.vro,t.variables,r.variables),Tt):e.floats.vro,S[2]=e.bools.vzo?Ne(_(e.vars.vzo,t.variables,r.variables),Tt):e.floats.vzo,S[0]=h.M(S[0],0,1/0),S[1]=h.M(S[1],0,1/0),S[2]=h.M(S[2],0,.99),u.velocity_trans=S[0],u.velocity_rot=S[1],u.velocity_zoom=S[2],Be.update_transform(l),Ge.sync_transform(l),Le.init_ortho_props(l)}else xe.error("Logic script error: object is not a Camera. Node: ",e.name);r.curr_node=e.slot_idx_order}}function te(e,t,r,n,o,i){function s(e,t,r){c.id0||(t.objects.id0=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0))||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var c=e.bools;switch(t.state){case Ze:break;case $e:var E=a(e,r,s),l=c.id0?_(e.vars.id0,t.variables,r.variables):E.objects.id0;if(Xe.is_camera(l)){switch(l.render.move_style){case Le.MS_TARGET_CONTROLS:if(e.bools.dsl){var T=e.bools.dslmin?Ne(_(e.vars.dslmin,t.variables,r.variables),Tt):e.floats.dslmin,u=e.bools.dslmax?Ne(_(e.vars.dslmax,t.variables,r.variables),Tt):e.floats.dslmax,d={};d.min=Math.max(T,0),d.max=Math.max(u,0),Le.set_distance_limits(l,d)}if(e.bools.vrl){var f=e.bools.vrldown?Ne(_(e.vars.vrldown,t.variables,r.variables),Tt):e.floats.vrldown,P=e.bools.vrlup?Ne(_(e.vars.vrlup,t.variables,r.variables),Tt):e.floats.vrlup,d={};d.down=f,d.up=P,d.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,Le.set_vertical_rot_limits(l,d)}if(e.bools.hrl){var A=e.bools.hrlleft?Ne(_(e.vars.hrlleft,t.variables,r.variables),Tt):e.floats.hrlleft,S=e.bools.hrlright?Ne(_(e.vars.hrlright,t.variables,r.variables),Tt):e.floats.hrlright,d={};d.left=A,d.right=S,d.camera_space="CAMERA"==e.common_usage_names.cam_lim_hor_rot_space_type,Le.set_horizontal_rot_limits(l,d)}if(e.bools.pvl){var p=e.bools.pvlmin?Ne(_(e.vars.pvlmin,t.variables,r.variables),Tt):e.floats.pvlmin,v=e.bools.pvlmax?Ne(_(e.vars.pvlmax,t.variables,r.variables),Tt):e.floats.pvlmax,d={};d.min_z=p,d.max_z=v,Le.set_pivot_limits(l,d)}break;case Le.MS_HOVER_CONTROLS:if(e.bools.htl){var m=e.bools.htlmin?Ne(_(e.vars.htlmin,t.variables,r.variables),Tt):e.floats.htlmin,O=e.bools.htlmax?Ne(_(e.vars.htlmax,t.variables,r.variables),Tt):e.floats.htlmax,d={};d.min=m,d.max=O,Le.set_hor_trans_limits(l,d)}if(e.bools.vtl){var N=e.bools.vtlmin?Ne(_(e.vars.vtlmin,t.variables,r.variables),Tt):e.floats.vtlmin,g=e.bools.vtlmax?Ne(_(e.vars.vtlmax,t.variables,r.variables),Tt):e.floats.vtlmax,d={};d.min=N,d.max=g,Le.set_vert_trans_limits(l,d)}if(e.bools.vrl){var f=e.bools.vrldown?Ne(_(e.vars.vrldown,t.variables,r.variables),Tt):e.floats.vrldown,P=e.bools.vrlup?Ne(_(e.vars.vrlup,t.variables,r.variables),Tt):e.floats.vrlup,d={};d.down=f,d.up=P,d.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,Le.hover_set_vertical_limits(l,d)}if(e.bools.dsl){var T=e.bools.dslmin?Ne(_(e.vars.dslmin,t.variables,r.variables),Tt):e.floats.dslmin,u=e.bools.dslmax?Ne(_(e.vars.dslmax,t.variables,r.variables),Tt):e.floats.dslmax,d={};d.min=Math.max(T,0),d.max=Math.max(u,0),Le.hover_set_distance_limits(l,d)}break;case Le.MS_EYE_CONTROLS:if(e.bools.vrl){var f=e.bools.vrldown?Ne(_(e.vars.vrldown,t.variables,r.variables),Tt):e.floats.vrldown,P=e.bools.vrlup?Ne(_(e.vars.vrlup,t.variables,r.variables),Tt):e.floats.vrlup,d={};d.down=f,d.up=P,d.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,Le.set_vertical_rot_limits(l,d)}if(e.bools.hrl){var A=e.bools.hrlleft?Ne(_(e.vars.hrlleft,t.variables,r.variables),Tt):e.floats.hrlleft,S=e.bools.hrlright?Ne(_(e.vars.hrlright,t.variables,r.variables),Tt):e.floats.hrlright,d={};d.left=A,d.right=S,d.camera_space="CAMERA"==e.common_usage_names.cam_lim_hor_rot_space_type,Le.set_horizontal_rot_limits(l,d)}break;case Le.MS_STATIC:}Be.update_transform(l),Ge.sync_transform(l)}else xe.error("Logic script error: object is not a Camera. Node: ",e.name);r.curr_node=e.slot_idx_order}}function re(e,t,r,n,o,i){function s(e,t){Be.set_tsr(e,t),Be.update_transform(e),Ge.sync_transform(e)}function c(e,r,a){r.objects.id0=Ee(e,"id0",l,t.variables,a.variables),r.objects.id0||l||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.objects.id1=Ee(e,"id1",T,t.variables,a.variables),r.objects.id1||T||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.state=tt,r.obj_state={dest_tsr_start:g.b(),dest_tsr_end:g.b(),interp_tsr_dest:g.b()}}var E=e.bools,l=E.id0,T=E.id1;switch(t.state){case Ze:break;case $e:var u=a(e,r,c),d=E.id0?_(e.vars.id0,t.variables,r.variables):u.objects.id0;if(d.is_dynamic){g.a(d.render.world_tsr,u.obj_state.dest_tsr_start);var f=E.id1?_(e.vars.id1,t.variables,r.variables):u.objects.id1;switch(g.a(f.render.world_tsr,u.obj_state.dest_tsr_end),u.state){case tt:var P=e.bools.dur?Ne(_(e.vars.dur,t.variables,r.variables),Tt):e.floats.dur;if(0==P)return s(d,u.obj_state.dest_tsr_end),void(r.curr_node=e.slot_idx_order);u.state=rt;var A=Ke.animate(0,1,1e3*P,function(e){Ue.check_active()&&(u.obj_state.interp_dest=g.o(u.obj_state.dest_tsr_start,u.obj_state.dest_tsr_end,h._53(e),u.obj_state.interp_tsr_dest),s(d,u.obj_state.interp_tsr_dest),1==e&&(u.state=at))});break;case rt:break;case at:Ke.clear_animation(A),u.state=tt,r.curr_node=e.slot_idx_order}break}xe.error("Logic script error: object '"+d.name+"' must be dynamic. Node: ",e.name),r.curr_node=e.slot_idx_order}}function ae(e,t,r,n,o,i){function s(e,t,r){r==Xt?Be.set_tsr(e,t):Be.set_tsr_rel(e,t),Be.update_transform(e),Ge.sync_transform(e)}function c(e,r,a){r.obj=Ee(e,"id0",E,t.variables,a.variables),r.obj||E||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.state=tt,r.obj_state={space:Xt,tsr_start:g.b(),tsr_end:g.b(),interp_tsr:g.b()}}var E=e.bools.id0;switch(t.state){case Ze:break;case $e:var l=a(e,r,c),T=E?_(e.vars.id0,t.variables,r.variables):l.obj;switch(l.state){case tt:var u=Qe;u[0]=e.bools.trx?Ne(_(e.vars.trx,t.variables,r.variables),Tt):e.floats.trx,u[1]=e.bools.try?Ne(_(e.vars.try,t.variables,r.variables),Tt):e.floats.try,u[2]=e.bools.trz?Ne(_(e.vars.trz,t.variables,r.variables),Tt):e.floats.trz;var d=He;d[0]=e.bools.rox?Ne(_(e.vars.rox,t.variables,r.variables),Tt)*Math.PI/180:e.floats.rox,d[1]=e.bools.roy?Ne(_(e.vars.roy,t.variables,r.variables),Tt)*Math.PI/180:e.floats.roy,d[2]=e.bools.roz?Ne(_(e.vars.roz,t.variables,r.variables),Tt)*Math.PI/180:e.floats.roz;var f=e.bools.sc?_(e.vars.sc,t.variables,r.variables):e.floats.sc;switch(h.Y(d,je),g.t(u,f,je,l.obj_state.tsr_end),l.obj_state.space=e.common_usage_names.space_type,l.obj_state.space){case Xt:Be.get_tsr(T,l.obj_state.tsr_start);break;case jt:Be.get_tsr_rel(T,l.obj_state.tsr_start);break;case Ht:Be.get_tsr_rel(T,l.obj_state.tsr_start),g.q(l.obj_state.tsr_start,l.obj_state.tsr_end,l.obj_state.tsr_end)}var P=e.bools.dur?Ne(_(e.vars.dur,t.variables,r.variables),Tt):e.floats.dur;if(0==P)return s(T,l.obj_state.tsr_end,l.obj_state.space),void(r.curr_node=e.slot_idx_order);l.state=rt;var A=Ke.animate(0,1,1e3*P,function(e){Ue.check_active()&&(g.o(l.obj_state.tsr_start,l.obj_state.tsr_end,h._53(e),l.obj_state.interp_tsr),s(T,l.obj_state.interp_tsr,l.obj_state.space),1==e&&(l.state=at))});break;case rt:break;case at:Ke.clear_animation(A),l.state=tt,r.curr_node=e.slot_idx_order}}}function _e(e,t,r,n,o,i){function s(e,r,a){r.obj=Ee(e,"id0",c,t.variables,a.variables),r.obj||c||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var c=e.bools.id0;switch(t.state){case Ze:void 0==e.bools.not_wait&&(e.bools.not_wait=!0);break;case $e:var E=a(e,r,s);switch(E.obj=c?_(e.vars.id0,t.variables,r.variables):E.obj,ke.is_playing(E.obj)||E.state==rt&&(E.state=at),E.state){case tt:for(var l in t.logic_threads){var T=t.logic_threads[l].thread_state.curr_node;if(-1!=T){var u=t.logic_threads[l].nodes[T];"SPEAKER_PLAY"==u.type&&u!=e&&E.state==rt&&u.obj==e.obj&&(u.state=at)}}e.bools.not_wait||(r.in_progress=!0),ke.play_def(E.obj),E.state=rt;break;case rt:e.bools.not_wait&&(r.curr_node=e.slot_idx_order,E.state=tt);break;case at:e.bools.not_wait||(r.in_progress=!1),r.curr_node=e.slot_idx_order,E.state=tt;break;default:be.panic("Unknown state of "+e.name),E.state=tt}}}function ne(e,t,r,n,o,i){function s(e,r,a){r.obj=Ee(e,"id0",c,t.variables,a.variables),r.obj||c||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var c=e.bools.id0;switch(t.state){case Ze:break;case $e:var E=a(e,r,s),l=c?_(e.vars.id0,t.variables,r.variables):E.obj;ke.stop(l),r.curr_node=e.slot_idx_order}}function oe(e,t,r,n,o,i){function s(e,t,r){e.objects_paths.id0&&(t.objects.id0=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),e.objects_paths.id0||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.nodes_paths.id0.unshift(e.materials_names.id0))}switch(t.state){case Ze:break;case $e:var c=a(e,r,s),E=c.objects.id0,l=e.nodes_paths.id0,T=l[0],u=De.name_list_to_node_name(l,1),d=De.find_batch_material(E,T,"MAIN");if(r.curr_node=e.slot_idx_order,null===d)return void xe.error('Material "'+T+'" was not found in the object "'+E.name+'".');"ShaderNodeRGB"==e.shader_nd_type&&ye.set_nodemat_rgb(E,T,u,e.bools.id0?Ne(_(e.vars.id0,t.variables,r.variables),Tt):e.floats.id0,e.bools.id1?Ne(_(e.vars.id1,t.variables,r.variables),Tt):e.floats.id1,e.bools.id2?Ne(_(e.vars.id2,t.variables,r.variables),Tt):e.floats.id2),"ShaderNodeValue"==e.shader_nd_type&&ye.set_nodemat_value(E,T,u,e.bools.id0?Ne(_(e.vars.id0,t.variables,r.variables),Tt):e.floats.id0)}}function ie(e,t,r,a,n,o){switch(t.state){case $e:var i=-1==e.vars.id0[1]?e.floats.inp1:Ne(_(e.vars.id0,t.variables,r.variables),Tt),s=-1==e.vars.id1[1]?e.floats.inp2:Ne(_(e.vars.id1,t.variables,r.variables),Tt),c=0;switch(e.op){case St:c=i+s;break;case At:c=i*s;break;case Pt:c=i-s;break;case ft:0==s&&be.panic("Division by zero in Logic script"),c=i/s;break;case pt:c=Math.random()*(s-i)+i;break;case vt:c=Math.sin(i);break;case mt:c=Math.cos(i);break;case Ot:c=Math.tan(i);break;case Nt:c=Math.asin(i);break;case gt:c=Math.acos(i);break;case ht:c=Math.atan(i);break;case Rt:c=Math.log(i);break;case It:c=Math.min(i,s);break;case bt:c=Math.max(i,s);break;case Yt:c=Math.round(i);break;case Lt:c=i%s;break;case Mt:c=Math.abs(i)}b(e.vars.vd,t.variables,r.variables,c),r.curr_node=e.slot_idx_order}}function se(e,t,r,a,n,o){switch(t.state){case $e:var i=e.common_usage_names.variable_type,s=Re(e,i),c=!1;if(i==dt){var E=e.bools.id0?_(e.vars.id0,t.variables,r.variables):ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),l=e.bools.id1?_(e.vars.id1,t.variables,r.variables):ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id1,0);switch(e.common_usage_names.condition){case Bt:E==l&&(c=!0);break;case Kt:E!=l&&(c=!0)}}else{var E=-1==e.vars.id0[1]?s.inp1:Ne(_(e.vars.id0,t.variables,r.variables),i),l=-1==e.vars.id1[1]?s.inp2:Ne(_(e.vars.id1,t.variables,r.variables),i);switch(e.common_usage_names.condition){case Bt:E==l&&(c=!0);break;case Kt:E!=l&&(c=!0);break;case kt:E<l&&(c=!0);break;case Gt:E>l&&(c=!0);break;case Ft:E<=l&&(c=!0);break;case Dt:E>=l&&(c=!0)}}r.curr_node=c?e.slot_idx_jump:e.slot_idx_order}}function ce(e,t,r,a,n,o){switch(t.state){case $e:if(e.bools.vs)var i=_(e.vars.vs,t.variables,r.variables);else{var s=e.common_usage_names.variable_type,c=Re(e,s);if(s==dt)var i=ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,c.id0,0);else var i=c.inp1}b([e.bools.new&&e.bools.gl||e.vars.vd[0],e.vars.vd[1]],t.variables,r.variables,i),r.curr_node=e.slot_idx_order}}function Ee(e,t,r,a,n){return r?_(e.vars[t],a,n):ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[t],0)}function le(e){var t=e.thread_state.callstack;if(t.length<=1)var r=e.nodes;else var r=t[t.length-1].logic_func.func.nodes;return r}function Te(e,t,r,n,o,i){function s(e,r,a){r.obj=E?w(e):Ee(e,"id0",c,t.variables,a.variables),r.obj||c||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var c=e.bools.id0,E=e.bools.env;switch(t.state){case Ze:break;case $e:var l=a(e,r,s);switch(E||(l.obj=c?_(e.vars.id0,t.variables,r.variables):l.obj),l.state!=rt||Ie.is_play(l.obj,l.anim_slot)||(l.state=at),l.state){case tt:for(var T in t.logic_threads){var u=t.logic_threads[T],d=le(u),f=u.thread_state.curr_node;if(-1!=f){var P=d[f],A=a(P,u.thread_state);"PLAY_ANIM"==P.type&&P!=e&&A.state==rt&&A.obj==l.obj&&(A.state=at)}}var S=e.common_usage_names.param_anim_behavior;if(""==e.anim_name)Ie.apply_def(l.obj),Ie.set_behavior(l.obj,S,Ie.SLOT_ALL);else{var p=function(e,t){for(var r=-1,a=0;a<8;a++){var _=e.anim_slots[a];if(_&&_.animation_name&&Ie.strip_baked_suffix(_.animation_name)==Ie.strip_baked_suffix(t)){if(-1==r)return-1;r=a}}return r}(l.obj,e.anim_name);-1==p?(l.anim_slot=Ie.slot_by_anim_type(l.obj,e.anim_name),Ie.apply(l.obj,null,e.anim_name,l.anim_slot)):l.anim_slot=p,Ie.set_behavior(l.obj,S,l.anim_slot)}e.bools.not_wait||(r.in_progress=!0),Ie.play(l.obj,null,l.anim_slot),l.state=rt,e.bools.not_wait&&(r.curr_node=e.slot_idx_order,l.state=tt);break;case rt:break;case at:e.bools.not_wait||(r.in_progress=!1),r.curr_node=e.slot_idx_order,l.state=tt;break;default:be.panic("Unknown state of "+e.name),l.state=tt}}}function ue(e,t,r,n,o,i){function s(e,r,a){r.obj=E?w(e):Ee(e,"id0",c,t.variables,a.variables),r.obj||c||(xe.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var c=e.bools.id0,E=e.bools.env;switch(t.state){case Ze:break;case $e:var l=a(e,r,s);l.obj=c?_(e.vars.id0,t.variables,r.variables):l.obj,Ie.stop(l.obj,Ie.SLOT_ALL),e.bools.rst&&Ie.set_first_frame(l.obj,Ie.SLOT_ALL),r.curr_node=e.slot_idx_order}}function de(e,t,r,a,n,o){switch(t.state){case $e:var i=e.bools.id0?Ne(_(e.vars.id0,t.variables,r.variables),ut):e.strings.id0,s=e.bools.id1?Ne(_(e.vars.id1,t.variables,r.variables),ut):e.strings.id1,c=0;switch(e.common_usage_names.string_operation){case yt:c=i+s;break;case xt:c=i.indexOf(s);break;case Ut:var E=e.bools.id2?Ne(_(e.vars.id2,t.variables,r.variables),ut):e.strings.id2;c=i.replace(s,E);break;case wt:var l=e.vars;c=i.substring(0,i.indexOf(s)),b(l.dst1,t.variables,r.variables,i.substring(i.indexOf(s)+1,i.length)),""==_(l.dst,t.variables,r.variables)&&(c=_(l.dst1,t.variables,r.variables),b(l.dst1,t.variables,r.variables,""));break;case Ct:switch(e.common_usage_names.condition){case Bt:c=i==s?1:0;break;case Kt:c=i!=s?1:0;break;case kt:c=i<s?1:0;break;case Gt:c=i>s?1:0;break;case Ft:c=i<=s?1:0;break;case Dt:c=i>=s?1:0}}b(e.vars.dst,t.variables,r.variables,c),r.curr_node=e.slot_idx_order}}function fe(e,t,r,a,_,n){switch(t.state){case $e:var o=e.bools.nla?Ne(Me.get_frame(a),Tt):Ne(Ke.get_frame(a),Tt);b(e.vars.vd,t.variables,r.variables,o),r.curr_node=e.slot_idx_order}}function Pe(e,t,r,a,n,o){switch(t.state){case $e:switch(e.common_usage_names.json_operation){case"PARSE":try{var i=Ne(_(e.vars.jsn,t.variables,r.variables),ut),s=JSON.parse(i);!function(e,t,r,a){for(var _=0;_<t.length;_++){for(var n=t[_],o=n.split("."),i=e,s=r[_],c=0;c<o.length&&void 0!==(i=i[o[c]])&&null!==i;c++);i=ge(i),a[s]=i}}(s,e.parse_json_paths,e.parse_json_vars,r.variables)}catch(e){xe.error("logic script error: non valid JSON string")}break;case"ENCODE":var c={};!function(e,t,r,a){a||(a={});for(var _=0;_<t.length;_++){var n=t[_],o=n.split("."),i=a,s=r[_];if(s in e){for(var c=0;c<o.length-1;c++)void 0===i[o[c]]&&(isNaN(o[c+1])?i[o[c]]={}:i[o[c]]=[]),i=i[o[c]];i[o[o.length-1]]=ge(e[s])}}}(r.variables,e.encode_json_paths,e.encode_json_vars,c);var E=Ne(JSON.stringify(c),ut);b(e.vars.jsn,t.variables,r.variables,E)}r.curr_node=e.slot_idx_order}}function Ae(e,t,r,a,n,o){switch(t.state){case $e:for(var i,s=e.bools.cb?Ne(_(e.vars.cb,t.variables,r.variables),ut):e.strings.cb,c=[],E=0,l="id"+E,T=e.common_usage_names.js_cb_params;l in T;)i=T[l]==Wt?ye.get_object(ye.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[l],0):_(e.vars[l],t.variables,r.variables),c.push(i),E++,l="id"+E;var u=[];for(E=0,l="out"+E;l in e.vars;)i=_(e.vars[l],t.variables,r.variables),u.push(i),E++,l="out"+E;var d=1;if(s in $t){if(d=!$t[s](c,u))for(var f=0;f<u.length;f++)(l="out"+f)in e.vars&&b(e.vars[l],t.variables,r.variables,ge(u[f]))}else xe.error("logic script error: no custom callback with id "+s);d&&(r.curr_node=e.slot_idx_order)}}function Se(e,t,r,a,_,n){switch(t.state){case $e:var o,i,s,c,E,l,T=e.common_usage_names.time_type,u=new Date;"L"==T?(o=u.getFullYear(),i=u.getMonth(),s=u.getDate(),c=u.getHours(),E=u.getMinutes(),l=u.getSeconds()):(o=u.getUTCFullYear(),i=u.getUTCMonth(),s=u.getUTCDate(),c=u.getUTCHours(),E=u.getUTCMinutes(),l=u.getUTCSeconds()),e.bools.y&&b(e.vars.y,t.variables,r.variables,o),e.bools.M&&b(e.vars.M,t.variables,r.variables,i),e.bools.d&&b(e.vars.d,t.variables,r.variables,s),e.bools.h&&b(e.vars.h,t.variables,r.variables,c),e.bools.m&&b(e.vars.m,t.variables,r.variables,E),e.bools.s&&b(e.vars.s,t.variables,r.variables,l),r.curr_node=e.slot_idx_order}}function pe(e,t,r,a,_,n){switch(t.state){case $e:b(e.vars.s,t.variables,r.variables,_),r.curr_node=e.slot_idx_order}}function ve(e,t,r,a,_,n){switch(t.state){case Ze:for(var o=e.logic_node_trees.id0,i=e.logic_functions.id0,s=0;s<t.logic_functions.length;s++){var c=t.logic_functions[s];if(c.id[0][0]==o[0]&&c.id[0][1]==o[1]&&c.id[1]==i){e.func_id=s;break}}break;case $e:var E={};r.variables_references={};for(var l in e.vars){var T=e.vars[l][1],u=e.strings[l];E[u]=e.vars[l][0]?t.variables[T]:r.variables[T],l.startsWith("out")&&(r.variables_references[T]=u)}r.callstack.push({caller_node:e,variables:E,logic_func:t.logic_functions[e.func_id]}),r.variables=E,r.update_script_cycle=!0,r.curr_node=t.logic_functions[e.func_id].func.nodes[0].slot_idx_order}}function me(e,t,r,a,_,n){e.thread_state.update_script_cycle=!1;var o=e.thread_state.callstack;if(o.length<=1)var i=e.nodes;else var i=o[o.length-1].logic_func.func.nodes;if(i.length){if(!n)for(var s=0;s<i.length;s++)i[s].processed=!1;for(var s=0;s<i.length;s++){if(!(e.thread_state.curr_node>=0)){if(e.thread_state.callstack.length>1){var c=e.thread_state.callstack.pop(),E=c.caller_node,l=o[o.length-1];if(l.logic_func)var T=l.logic_func.func.nodes;else var T=e.nodes;e.thread_state.curr_node=E.slot_idx_order;var u=T[E.slot_idx_order],d=e.thread_state.variables;e.thread_state.variables=l.variables;for(var f in e.thread_state.variables_references){var P=e.thread_state.variables_references[f];void 0===e.thread_state.variables[f]?t.variables[f]=d[P]:e.thread_state.variables[f]=d[P]}return void me(e,t,r,a,_,!0)}return}var u=i[e.thread_state.curr_node];if(u.processed)return;if(u.mute){if("ENTRYPOINT"==u.type)return;e.thread_state.curr_node=u.slot_idx_order,u.processed=!0}else if(u.process_node(u,t,e.thread_state,r,a,_),u.processed=!0,e.thread_state.update_script_cycle)return}o.splice(0,o.length)}}function Oe(e,t){function a(e,t){return e-t}var _=e.b4w_logic_nodes,n=t.logic_threads,o=t.logic_functions;t.state=Ze;for(var i=-1,s=0;s<_.length;s++){for(var c={nodes:[],thread_state:{scene:e,curr_node:0,in_progress:!1,update_script_cycle:!1,thread_index:s,callstack:[],variables:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}},E=_[s],l=0;l<E.length;l++){var T=E[l],u=r(T,c);c.nodes.push(u)}switch(c.nodes[0].type){case"ENTRYPOINT":i++,c.thread_state.thread_index=i,n.push(c);break;case"DEF_FUNC":var d=c.nodes[0];c.thread_state=null;var f={id:[d.logic_node_trees.id0,d.logic_functions.id0],func:c};o.push(f)}}for(var s=0;s<n.length;s++)for(var c=n[s],P=0;P<c.nodes.length;P++)u=c.nodes[P],u.mute||u.process_node(u,t,c.thread_state,0,0);for(var s=0;s<o.length;s++)for(var A=o[s].func,P=0;P<A.nodes.length;P++)u=A.nodes[P],u.mute||u.process_node(u,t,0,0,0);var S=e.timeline_markers;for(var p in S)t.sorted_markers_values.push(S[p]);t.sorted_markers_values.sort(a),t.state=$e,Zt.push(t)}function Ne(e,t){switch(t){case Tt:return Number(e)?Number(e):0;case ut:return String(e);case dt:return e;default:return null}}function ge(e){switch(typeof e){case"string":return Ne(e,ut);case"number":return Ne(e,Tt);default:return Ne(e,ut)}}function he(e){er[e]||(er[e]=0);var t=e+"_"+er[e];return t=t.replace(/ /g,"_").replace(/\//g,"_"),er[e]++,t}function Re(e,t){switch(t){case Tt:return e.floats;case ut:return e.strings;case dt:return e.objects_paths}}var Ie=Object(n.a)(e),be=Object(o.a)(e),Ye=Object(i.a)(e),Le=Object(s.a)(e),Me=Object(c.a)(e),ye=Object(E.a)(e),xe=Object(l.a)(e),Ue=Object(T.a)(e),we=Object(u.a)(e),Ce=Object(d.a)(e),De=Object(f.a)(e),Fe=Object(P.a)(e),Ge=Object(p.a)(e),ke=Object(m.a)(e),Ke=Object(O.a)(e),Be=Object(N.a)(e),Xe=Object(I.a)(e),je=new Float32Array(4),He=new Float32Array(3),Qe=new Float32Array(3),ze=R.create(),qe=R.create(),Ve=new Float32Array(2),We=new Float32Array(9),Je=new Float32Array(16),Ze=1,$e=2,et=3,tt=-1,rt=0,at=1,_t=-3,nt=-2,ot=-1,it=0,st=1,ct=-1,Et=0,lt=1,Tt=0,ut=1,dt=2;t.NT_NUMBER=Tt,t.NT_STRING=ut,t.NT_OBJECT=dt;var ft=0,Pt=1,At=2,St=3,pt=4,vt=5,mt=6,Ot=7,Nt=8,gt=9,ht=10,Rt=11,It=12,bt=13,Yt=14,Lt=15,Mt=16;t.NMO_DIV=ft,t.NMO_SUB=Pt,t.NMO_MUL=At,t.NMO_ADD=St,t.NMO_RAND=pt,t.NMO_SIN=vt,t.NMO_COS=mt,t.NMO_TAN=Ot,t.NMO_ARCSIN=Nt,t.NMO_ARCCOS=gt,t.NMO_ARCTAN=ht,t.NMO_LOG=Rt,t.NMO_MIN=It,t.NMO_MAX=bt,t.NMO_ROUND=Yt,t.NMO_MOD=Lt,t.NMO_ABS=Mt;var yt=0,xt=1,Ut=2,wt=3,Ct=4;t.NSO_JOIN=yt,t.NSO_FIND=xt,t.NSO_REPLACE=Ut,t.NSO_SPLIT=wt,t.NSO_COMPARE=Ct;var Dt=0,Ft=1,Gt=2,kt=3,Kt=4,Bt=5;t.NC_GEQUAL=Dt,t.NC_LEQUAL=Ft,t.NC_GREATER=Gt,t.NC_LESS=kt,t.NC_NOTEQUAL=Kt,t.NC_EQUAL=Bt;var Xt=0,jt=1,Ht=2;t.NST_WORLD=Xt,t.NST_PARENT=jt,t.NST_LOCAL=Ht;var Qt=0,zt=1,qt=2,Vt=3;t.NCMS_STATIC=Qt,t.NCMS_TARGET=zt,t.NCMS_EYE=qt,t.NCMS_HOVER=Vt;var Wt=0;t.NCPT_OBJECT=Wt,t.NCPT_VARIABLE=1;var Jt={ENTRYPOINT:C,HIDE:D,SHOW:F,PAGEPARAM:G,SWITCH_SELECT:B,SELECT:k,PLAY:j,REDIRECT:z,MATH:ie,CONDJUMP:se,REGSTORE:ce,PLAY_ANIM:Te,SELECT_PLAY:Y,SEND_REQ:q,INHERIT_MAT:V,SET_SHADER_NODE_PARAM:oe,DELAY:W,APPLY_SHAPE_KEY:J,OUTLINE:Z,MOVE_CAMERA:$,SET_CAMERA_MOVE_STYLE:ee,SET_CAMERA_LIMITS:te,MOVE_TO:re,TRANSFORM_OBJECT:ae,SPEAKER_PLAY:_e,SPEAKER_STOP:ne,STOP_ANIM:ue,STOP_TIMELINE:Q,CONSOLE_PRINT:H,STRING:de,GET_TIMELINE:fe,JSON:Pe,JS_CALLBACK:Ae,EMPTY:Y,DATE_TIME:Se,ELAPSED:pe,CALL_FUNC:ve,DEF_FUNC:Y,SWITCH:X},Zt=[],$t={},er={};t.init_logic=function(e,t){var r={data_id:t,scene_name:e.name,state:0,nla_thread:null,scene:e,curr_thread:null,logic_threads:[],logic_functions:[],sorted_markers_values:[],variables:{},variables_references:{}};e._logic=r,Oe(e,r)},t.update=function(e,t){var r=Me.get_start_time();if(!(r<=0))for(var a=0;a<Zt.length;a++)x(a,e,t,r)},t.append_custom_cb=function(e,t){$t[e]=t},t.remove_custom_cb=function(e){delete $t[e]},t.run_ep=function(e,t){for(var r=0;r<Zt.length;r++)if(Zt[r].scene_name==e){for(var a=Zt[r],_=0;_<a.logic_threads.length;_++){var n=a.logic_threads[_].nodes[0];if(n.name==t){n.bools.js&&[0,-1].indexOf(a.logic_threads[_].thread_state.curr_node)>=0&&(n.mute=!1,a.logic_threads[_].thread_state.curr_node=0);break}}break}};var tr=function(){return function(e,t,r,_){var n=_[0],o=_[1],i=_[2],s=a(n,i.thread_state);if(s.state==ot){for(var c=0;c<s.sel_objs_len;c++){if(Ce.get_sensor_value(e,t,c)){for(var E=0;E<s.sel_obj_idxs.length;E++)if(s.sel_obj_idxs[E]==c)return o.nla_thread==s.thread?(Me.is_play(o._nla)&&(s.state=_t),i.thread_state.in_progress||(s.state=st,s.slot_idx_jump=s.links_idxs[E])):(s.state=st,s.slot_idx_jump=s.links_idxs[E]),void(s.select_object_idx=c);s.select_object_idx=c}}s.state=it}}};t.cleanup=function(){Zt.length=0,$t={},er={}}}var _=r(0),n=r(41),o=r(5),i=r(47),s=r(14),c=r(55),E=r(12),l=r(1),T=r(10),u=r(4),d=r(56),f=r(16),P=r(20),A=r(28),S=r(21),p=r(19),v=r(8),m=r(23),O=r(18),N=r(13),g=r(6),h=r(2),R=r(3),I=r(9),b=Object(_.a)("__logic_nodes",a);t.a=b},function(e,t,r){"use strict";function a(e,t){function r(){window.performance||(ce.log("Apply performance workaround"),window.performance={});var e=Date.now();window.performance.now||(ce.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-e}),fe.set_timeline(0)}function a(e,t){for(var r=null,a=t?be:Ie,_=0;_<a.length;_++){var n=a[_];try{r=e.getContext(n,Se)}catch(e){}if(r)break}return r&&z.detect_tegra_invalid_enum_issue(r),r}function _(e,t,r){e.addEventListener("webglcontextlost",function(e){e.preventDefault(),ce.error("WebGL context lost"),F()},!1),ee.setup_context(r);var a=ee.get_renderer_info();a&&ce.log("%cRENDERER INFO:","color: #00a",r.getParameter(a.UNMASKED_VENDOR_WEBGL)+", "+r.getParameter(a.UNMASKED_RENDERER_WEBGL)),Ee.setup_context(r),te.setup_context(r),de.setup_context(r),ue.setup_context(r),q.setup_context(r),V.setup(r),Z.setup_context(r),J.setup_canvas(e),q.init(e,t),le.setup_dim(e.width,e.height,1),Te.init(),re.init(),he=B(),k()}function C(e){Re=e}function D(){Re=function(){}}function F(){G()||(me=performance.now()/1e3,Te.pause(),se.pause(),de.pause(),X.pause())}function G(){return Oe<me}function k(){var e="HMD"===pe.stereo&&re.get_webvr_display();e?e.requestAnimationFrame(k):Le(k);var t=performance.now()/1e3;ve||(ve=t);var r=t-ve;if(!(r<1/pe.max_fps)){for(var a=fe.get_timeline(),_=0;_<Ne.length;_++)Ne[_](a,r);G()||(Oe>ve&&(r-=Oe-Math.max(me,ve)),fe.set_delta(r),a+=r,fe.set_timeline(a),$.update(),H.update(),J.update(),K(a,r),he(r)),ve=t,e&&e.isPresenting&&e.submitFrame()}}function K(e,t){J.is_primary_loaded()&&(ae.reset(),Pe.update(t),oe.update(e,t),_e.update(e,t),Te.update(e,t),t&&j.update(t),J.is_primary_loaded()&&(se.update(e,t),J.is_primary_loaded()&&(re.update(e),W.update(e,t),J.is_primary_loaded()&&(X.update(!1),ie.update(e,t),Ae.update(),Re(t,e),J.is_primary_loaded()&&(le.update(e,t),X.update_visibility(),ne.frame())))))}function B(){var e=60,t=0,r=pe.fps_measurement_interval,a=pe.fps_callback_interval;return function(_){if(!(_<1/pe.max_fps)){e=x._51(1/_,e,_,r);var n=se.get_fps();t=(t+1)%a,0==t&&ge(Math.round(e),n)}}}var X=Object(n.a)(e),j=Object(o.a)(e),H=Object(i.a)(e),Q=Object(s.a)(e),z=Object(c.a)(e),q=Object(E.a)(e),V=Object(l.a)(e),W=Object(T.a)(e),J=Object(u.a)(e),Z=Object(d.a)(e),$=Object(f.a)(e),ee=Object(P.a)(e),te=Object(A.a)(e),re=Object(S.a)(e),ae=Object(p.a)(e),_e=Object(v.a)(e),ne=Object(m.a)(e),oe=Object(O.a)(e),ie=Object(N.a)(e),se=Object(g.a)(e),ce=Object(h.a)(e),Ee=Object(R.a)(e),le=Object(I.a)(e),Te=Object(b.a)(e),ue=Object(Y.a)(e),de=Object(L.a)(e),fe=Object(M.a)(e),Pe=Object(y.a)(e),Ae=Object(w.a)(e),Se=Q.context,pe=Q.defaults,ve=0,me=0,Oe=0,Ne=[],ge=function(){},he=function(){},Re=function(){},Ie=["webgl","experimental-webgl"],be=["webgl2","experimental-webgl2"],Ye=null,Le=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/pe.max_fps)}}();t.init=function(e,t){ce.set_verbose(pe.console_verbose);var n=Object(U.f)()+" "+Object(U.d)()+" ("+Object(U.b)()+")";if(ce.log("%cINIT ENGINE","color: #00a",n),ce.log("%cUSER AGENT:","color: #00a",navigator.userAgent),!window.WebGLRenderingContext)return null;r(),t?ae.init(t):(Q.defaults.show_hud_debug_info=!1,Q.sfx.mix_mode=!1),z.apply_context_alpha_hack(),z.check_user_agent("Chrome")||z.check_user_agent("Firefox")||(pe.webgl2=!1);var o=a(e,pe.webgl2);return!o&&pe.webgl2&&(pe.webgl2=!1,o=a(e,!1)),o?(ce.log("%cINIT WEBGL "+(pe.webgl2?"2":"1"),"color: #00a"),Ye=o,_(e,t,o),Q.apply_quality(),z.set_hardware_defaults(o,!0),Q.set_paths(),ue.load_shaders(),pe.ie11_edge_touchscreen_hack&&(e.style["touch-action"]="none"),ce.log("%cSET PRECISION:","color: #00a",pe.precision),o):null},t.set_fps_callback=function(e){ge=e},t.clear_fps_callback=function(){ge=function(){}},t.set_render_callback=function(e){C(e)},t.clear_render_callback=function(){D()},t.pause=F,t.resume=function(){G()&&(Oe=performance.now()/1e3,Te.resume(),se.resume(),de.play(!0),X.resume())},t.is_paused=G,t.reset=function(){J.unload(0),V.reset(),J.reset(),ee.reset(),Ee.reset(),te.reset(),de.reset_mod(),ue.reset(),Z.reset(),q.reset(),J.reset(),q.reset(),fe.reset(),Te.reset(),ve=0,me=0,Oe=0,ge=function(){},he=function(){},Re=function(){},Ne.length=0,Ye=null},t.canvas_data_url=function(e,t,r,a){ne.canvas_data_url(e,t,r,a)},t.detect_mobile=function(){return z.detect_mobile()},t.append_loop_cb=function(e){for(var t=0;t<Ne.length;t++)if(Ne[t]==e)return;Ne.push(e)},t.remove_loop_cb=function(e){for(var t=0;t<Ne.length;t++)if(Ne[t]==e){Ne.splice(t,1);break}},t.get_renderer_info=function(){var e=ee.get_renderer_info();return e?{vendor:Ye.getParameter(e.UNMASKED_VENDOR_WEBGL),renderer:Ye.getParameter(e.UNMASKED_RENDERER_WEBGL)}:null}}var _=r(0),n=r(58),o=r(41),i=r(47),s=r(4),c=r(38),E=r(15),l=r(70),T=r(56),u=r(46),d=r(48),f=r(67),P=r(29),A=r(20),S=r(42),p=r(54),v=r(55),m=r(86),O=r(63),N=r(12),g=r(19),h=r(1),R=r(22),I=r(10),b=r(23),Y=r(37),L=r(17),M=r(18),y=r(13),x=r(2),U=r(40),w=r(50),C=Object(_.a)("main",a);t.a=C},function(e,t,r){"use strict";function a(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var _=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,i,s=a(e),c=1;c<arguments.length;c++){r=Object(arguments[c]);for(var E in r)n.call(r,E)&&(s[E]=r[E]);if(_){i=_(r);for(var l=0;l<i.length;l++)o.call(r,i[l])&&(s[i[l]]=r[i[l]])}}return s}},function(e,t,r){"use strict";function a(e,t){function r(e,t,r,_,n,o,i,s){var c=a(e,t,r,o,i,s);return it&&Xe(c.graph,_,n),c}function a(e,t,r,n,o,i){if(t in rt)return rt[t];var s={graph:null,id:t,cleanup_on_unload:!0};if(r||(_t={},nt=0),"SHADOW"!=n&&"COLOR_ID"!=n){for(var c=Je.create(),E=e.nodes,l=0;l<E.length;l++){if(null==ae(c,E[l],0,n,o,i))return rt[t]=null,s}if(r&&-1==Z(e,c,"GROUP_OUTPUT","group"))return s;var T=ye(c),d=r?e.links:e.links.slice();if(!xe(c,d,T))return s;if(r)return s.graph=c,s;for(var l=0;l<d.length;l++)for(var f=d[l],P=w(f.from_node,c),A=w(f.to_node,c),p=0;p<P.length;p++)for(var v=0;v<A.length;v++){var m=P[p],O=A[v],N=Je.get_node_attr(c,m),L=Je.get_node_attr(c,O);if(!Ie(c,m,O,N,L,f))return rt[t]=null,s}U(c);var y=!1,D=-1;"GLOW"==n?D=Z(e,c,"B4W_GLOW_OUTPUT","material",!0):(D=Z(e,c,"OUTPUT","material",!1,!0),-1==D&&(D=Z(e,c,"OUTPUT_MATERIAL","material",!1,!0)),-1==D&&(D=Z(e,c,"OUTPUT_WORLD","material",!1,!0),y=!0)),-1==D&&(c=Y(),D=0),C(c);var F=Je.subgraph_node_conn(c,D,Je.BACKWARD_DIR);y?(g(F,n),h(F,n),R(F),I(F)):(_(F,n,i),S(F,n,i)),M(F),G(F),q(F),x(F,n),He(F)}else{var k=a(e,t,r,"MAIN",o,i),K=function(e){var t=u.N(e);return t.inputs=u.O(e.inputs),t.outputs=u.O(e.outputs),t},B=Je.clone(k.graph,K),D=Z(e,B,"OUTPUT","material",!1,!0);-1==D&&(D=Z(e,B,"OUTPUT_MATERIAL","material",!1,!0)),b(B,D);var F=Je.subgraph_node_conn(B,D,Je.BACKWARD_DIR);M(F)}return s.graph=F,rt[t]=s,s}function _(e,t,r){var a=[];Je.traverse(e,function(e,t){if("MATERIAL"==t.type||"MATERIAL_EXT"==t.type){var r={node_id:e,node:t};a.push(r)}});for(var _=0;_<a.length;++_){var n=a[_].node_id,o=a[_].node,i=Je.gen_node_id(e);Je.append_node(e,i,o.data.material_begin);var s=Je.gen_node_id(e);Je.append_node(e,s,o.data.material_end),Je.append_edge(e,i,s,[4,2]);for(var c={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},E=Je.in_edge_count(e,n),l=[],T=[],u=[],d={},f=0;f<E;f++){var A=Je.get_in_edge(e,n,f);A in d||(d[A]=0);var S=Je.get_edge_attr(e,A,n,d[A]++);l.push([A,n,S]);var p=c[S[1]];if(p)switch(p[0]){case"MATERIAL_END":T.push([A,s,[S[0],p[1]]]);break;case"LIGHTING_APPLY":u.push([A,[S[0],p[1]]])}else T.push([A,i,S])}P(e,o.data.value,i,s,u,r);for(var f=0;f<l.length;f++)Je.remove_edge_by_attr(e,l[f][0],l[f][1],l[f][2]);for(var f=0;f<T.length;f++)Je.append_edge(e,T[f][0],T[f][1],T[f][2]);for(var v=Je.out_edge_count(e,n),m=[],O=[],N={},f=0;f<v;f++){var g=Je.get_out_edge(e,n,f);g in N||(N[g]=0);var S=Je.get_edge_attr(e,n,g,N[g]++);m.push([n,g,S]),O.push([s,g,S])}for(var f=0;f<m.length;f++)Je.remove_edge_by_attr(e,m[f][0],m[f][1],m[f][2]);for(var f=0;f<O.length;f++)Je.append_edge(e,O[f][0],O[f][1],O[f][2]);Je.remove_node(e,n)}}function P(e,t,r,a,_,n){var o={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},i=ae(e,o,0,null,null,[]),s=i;if(A(e,r,i,"E"),A(e,r,i,"A"),A(e,r,i,"D"),!t.use_shadeless)for(var c,E,l,T,u=0;u<n.length;u++){var d=n[u];o={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},c=ae(e,o,0,null,null,[]),o={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},E=ae(e,o,0,null,null,[]),A(e,s,E,"color"),A(e,s,E,"specular"),A(e,c,E,"ldir"),A(e,r,E,"normal"),A(e,r,E,"D"),A(e,r,E,"S"),A(e,c,E,"lcolorint"),A(e,r,c,"shadow_factor");var f="SPECULAR_"+t.specular_shader;if(o={name:f,type:f,use_tangent_shading:t.use_tangent_shading},l=ae(e,o,0,null,null,[]),A(e,c,l,"ldir"),A(e,c,l,"lfac"),A(e,r,l,"normal"),A(e,l,E,"sfactor"),A(e,c,l,"norm_fac"),A(e,r,l,"sp_params"),"HEMI"==d.type)var P="DIFFUSE_LAMBERT";else var P="DIFFUSE_"+t.diffuse_shader;o={name:P,type:P,use_tangent_shading:t.use_tangent_shading},T=ae(e,o,0,null,null,[]),A(e,c,T,"ldir"),A(e,c,T,"lfac"),A(e,r,T,"normal"),A(e,c,T,"norm_fac"),A(e,T,E,"lfactor"),"DIFFUSE_LAMBERT"!=P&&A(e,r,T,"dif_params");for(var S=0;S<_.length;S++){var p=_[S][0],v=_[S][1];Je.append_edge(e,p,E,v)}s=E}A(e,s,a,"color"),A(e,s,a,"specular")}function A(e,t,r,a){for(var _=Je.get_node_attr(e,t),n=Je.get_node_attr(e,r),o=-1,i=n.inputs,s=0;s<i.length;s++){if(a==i[s].identifier){o=s;break}}if(-1!=o){for(var c=-1,E=_.outputs,s=0;s<E.length;s++){if(a==E[s].identifier){c=s;break}}-1!=c&&(Je.append_edge(e,t,r,[c,o]),E[c].is_linked=!0,i[o].is_linked=!0)}}function S(e,t,r){var a=[];Je.traverse(e,function(e,t){if("OUTPUT_MATERIAL"==t.type){var r={node_id:e,node:t};a.push(r)}});for(var _=0;_<a.length;++_){var n=a[_].node_id,o=a[_].node,i=!1,s=!1,c=Je.gen_node_id(e);Je.append_node(e,c,o.data.output_surface);for(var E=Je.in_edge_count(e,n),l=[],T=[],u={},d=0;d<E;d++){var f=Je.get_in_edge(e,n,d);f in u||(u[f]=0);var P=Je.get_edge_attr(e,f,n,u[f]++);switch(l.push([f,n,P]),P[1]){case bt:i=!0,T.push([f,c,P]);break;case Yt:s=!0;var A=Je.gen_node_id(e);Je.append_node(e,A,o.data.displacement_bump),T.push([f,A,[P[0],0]])}}for(var d=0;d<l.length;d++)Je.remove_edge_by_attr(e,l[d][0],l[d][1],l[d][2]);for(var d=0;d<T.length;d++)Je.append_edge(e,T[d][0],T[d][1],T[d][2]);if(Je.remove_node(e,n),i)s&&p(e,c,A),O(e,t,r);else{var S=Je.get_node_attr(e,c);e.nodes=[0,S],e.edges=[]}}}function p(e,t,r){var a=Je.subgraph_node_conn(e,t,Je.BACKWARD_DIR),_=m(a);if(_.length){var n=Je.subgraph_node_conn(e,r,Je.BACKWARD_DIR),o=L(n);Je.traverse(o,function(e,t){var r="displacement%join%"+t.name;t.name=r}),Je.append_subgraph(o,a,[],[]);var i=-1;Je.traverse(a,function(e,t){if("DISPLACEMENT_BUMP"==t.type)return i=e,1});for(var s=0;s<_.length;s++){var c=_[s],E=Je.get_node_attr(a,c);A(a,i,c,"Normal"),v(E,"USE_NORMAL_IN",1)}}e.nodes=a.nodes,e.edges=a.edges}function v(e,t,r){for(var a=e.dirs,_=0;_<a.length;_++){var n=a[_];n[0]==t&&(n[1]=r)}}function m(e){var t=[];return Je.traverse(e,function(e,r){for(var a=!1,_=r.inputs,n=0;n<_.length;n++)if("Normal"==_[n].identifier){a=!_[n].is_linked;break}a&&t.push(e)}),t}function O(e,t,r){var a=[];Je.traverse(e,function(e,t){if("OUTPUT_SURFACE"==t.type){var r={node_id:e,node:t};a.push(r)}});var _=[];a.length&&Je.traverse(e,function(e,t){if("MIX_SHADER"==t.type){var r={node_id:e,node:t};_.push(r)}});for(var n=0;n<a.length;++n){var o=a[n].node_id,i=a[n].node,s=Je.gen_node_id(e);Je.append_node(e,s,i.data.bsdf_begin);var c=Je.gen_node_id(e);Je.append_node(e,c,i.data.bsdf_end),Je.append_edge(e,s,c,[4,2]);for(var E=Je.in_edge_count(e,o),l=[],T=[],u=[],d={},f=0;f<E;f++){var P=Je.get_in_edge(e,o,f),A=Je.get_node_attr(e,P);P in d||(d[P]=0);var S=Je.get_edge_attr(e,P,o,d[P]++);if(l.push([P,o,S]),T.push([P,s,S]),"BSDF_GLOSSY"==A.type||"BSDF_DIFFUSE"==A.type||"MIX_SHADER"==A.type||"EMISSION"==A.type||"BSDF_TRANSPARENT"==A.type||"BSDF_PRINCIPLED"==A.type){T.push([P,s,[1,1]]),T.push([P,s,[2,2]]),T.push([P,s,[3,3]]),T.push([P,s,[4,4]]),T.push([P,s,[5,5]]),T.push([P,s,[6,6]]),T.push([P,s,[7,7]]),T.push([P,s,[8,8]]),T.push([P,s,[9,9]]),T.push([P,s,[10,10]]),T.push([P,s,[11,11]]),T.push([P,s,[12,12]]);for(var p=0;p<_.length;++p)for(var v=_[p].node_id,m=Je.in_edge_count(e,v),O=0;O<m;O++){var g=Je.get_in_edge(e,v,O),h=Je.get_node_attr(e,g),R=Je.get_edge_attr(e,g,v,0);if(0!=R[1]&&("BSDF_GLOSSY"==h.type||"BSDF_DIFFUSE"==h.type||"MIX_SHADER"==h.type||"EMISSION"==h.type||"BSDF_TRANSPARENT"==h.type||"BSDF_PRINCIPLED"==h.type)){var I=1==R[1]?3:15;T.push([g,v,[1,I]]),T.push([g,v,[2,I+1]]),T.push([g,v,[3,I+2]]),T.push([g,v,[4,I+3]]),T.push([g,v,[5,I+4]]),T.push([g,v,[6,I+5]]),T.push([g,v,[7,I+6]]),T.push([g,v,[8,I+7]]),T.push([g,v,[9,I+8]]),T.push([g,v,[10,I+9]]),T.push([g,v,[11,I+10]]),T.push([g,v,[12,I+11]])}}}}N(e,i.data.value,s,c,u,r),T.push([c,o,[0,0]]),T.push([c,o,[1,1]]);for(var f=0;f<l.length;f++)Je.remove_edge_by_attr(e,l[f][0],l[f][1],l[f][2]);for(var f=0;f<T.length;f++)Je.append_edge(e,T[f][0],T[f][1],T[f][2])}}function N(e,t,r,a,_,n){var o={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},i=ae(e,o,0,null,null,[]),s=i;A(e,r,i,"E"),A(e,r,i,"A"),A(e,r,i,"D");for(var c,E,l,T=0;T<n.length;T++){o={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},c=ae(e,o,0,null,null,[]),o={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},E=ae(e,o,0,null,null,[]),A(e,s,E,"color"),A(e,s,E,"specular"),A(e,c,E,"ldir"),A(e,r,E,"normal"),A(e,r,E,"D"),A(e,r,E,"S"),A(e,c,E,"lcolorint"),A(e,r,c,"shadow_factor");var u=t.bsdf_shader;o={name:u,type:u},l=ae(e,o,0,null,null,[]),A(e,c,l,"ldir"),A(e,c,l,"lfac"),A(e,r,l,"normal"),A(e,c,l,"norm_fac"),A(e,r,l,"bsdf_params"),A(e,l,E,"lfactor"),A(e,l,E,"sfactor");for(var d=0;d<_.length;d++){var f=_[d][0],P=_[d][1];Je.append_edge(e,f,E,P)}s=E}A(e,r,a,"bsdf_params"),A(e,r,a,"refract_params"),A(e,r,a,"d_color"),A(e,r,a,"s_color"),A(e,r,a,"e_color"),A(e,r,a,"emission"),A(e,r,a,"a_color"),A(e,r,a,"alpha"),A(e,s,a,"color"),A(e,s,a,"specular")}function g(e,t){var r=[];Je.traverse(e,function(e,t){if("OUTPUT_WORLD"==t.type){var a={node_id:e,node:t};r.push(a)}});for(var a=0;a<r.length;++a){var _=r[a].node_id,n=r[a].node,o=Je.gen_node_id(e);Je.append_node(e,o,n.data.output_world_surface);for(var i=Je.in_edge_count(e,_),s=[],c=[],E={},l=0;l<i;l++){var T=Je.get_in_edge(e,_,l);T in E||(E[T]=0);var u=Je.get_edge_attr(e,T,_,E[T]++);switch(s.push([T,_,u]),u[1]){case bt:c.push([T,o,u])}}for(var l=0;l<s.length;l++)Je.remove_edge_by_attr(e,s[l][0],s[l][1],s[l][2]);for(var l=0;l<c.length;l++)Je.append_edge(e,c[l][0],c[l][1],c[l][2]);Je.remove_node(e,_)}}function h(e,t){var r=[];if(Je.traverse(e,function(e,t){if("MIX_SHADER"==t.type||"ADD_SHADER"==t.type){var a={node_id:e,node:t};r.push(a)}}),r.length)for(var a={name:"RGB_WORLD_NODE",type:"RGB_WORLD_NODE",factor:.5},_=0;_<r.length;_++){var n=r[_].node_id,o=r[_].node;switch(a.name=o.name,a.fac=o.inputs[0].default_value,a.fac_is_linked=o.inputs[0].is_linked,a.color1_is_linked=o.inputs[1].is_linked,a.color2_is_linked=o.inputs[2].is_linked,o.type){case"ADD_SHADER":a.type="ADD_WORLD_RGB";break;case"MIX_SHADER":a.type="MIX_WORLD_RGB"}for(var i=ae(e,a,0,t,null,[]),s=Je.in_edge_count(e,n),c=[],E=[],l={},T=0;T<s;T++){var u=Je.get_in_edge(e,n,T);u in l||(l[u]=0);var d=Je.get_edge_attr(e,u,n,l[u]++);c.push([u,n,d]),E.push([u,i,d])}for(var T=0;T<c.length;T++)Je.remove_edge_by_attr(e,c[T][0],c[T][1],c[T][2]);for(var T=0;T<E.length;T++)Je.append_edge(e,E[T][0],E[T][1],E[T][2]);for(var f=Je.out_edge_count(e,n),P=[],A=[],S={},T=0;T<f;T++){var p=Je.get_out_edge(e,n,T);p in S||(S[p]=0);var d=Je.get_edge_attr(e,n,p,S[p]++);P.push([n,p,d]),A.push([i,p,d])}for(var T=0;T<P.length;T++)Je.remove_edge_by_attr(e,P[T][0],P[T][1],P[T][2]);for(var T=0;T<A.length;T++)Je.append_edge(e,A[T][0],A[T][1],A[T][2]);Je.remove_node(e,n)}}function R(e){var t=-1,r=[],a=[],_=["OUTPUT_WORLD_SURFACE","BACKGROUND","RGB","VALUE","ADD_WORLD_RGB","MIX_WORLD_RGB","TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","TEXTURE_ENVIRONMENT_MIRROR_BALL","GEOMETRY_NO","GEOMETRY_TRN","GEOMETRY_GL","GEOMETRY_IN","TEXTURE_COLOR","TEX_COORD_GE","TEX_COORD_OB","TEX_COORD_NO","COMBRGB","COMBHSV","CURVE_RGB","CURVE_VEC","B4W_LINEAR_TO_SRGB","B4W_NORMAL_VIEW","B4W_VECTOR_VIEW","B4W_SRGB_TO_LINEAR","B4W_REFLECT","B4W_CLAMP","B4W_TIME","B4W_SMOOTHSTEP","NORMAL","MAPPING","MATH_ADD","MATH_SUBTRACT","MATH_MULTIPLY","MATH_DIVIDE","MATH_SINE","MATH_COSINE","MATH_TANGENT","MATH_ARCSINE","MATH_ARCCOSINE","MATH_ARCTANGENT","MATH_POWER","MATH_LOGARITHM","MATH_MINIMUM","MATH_MAXIMUM","MATH_ROUND","MATH_LESS_THAN","MATH_GREATER_THAN","MATH_MODULO","MATH_ABSOLUTE","MIX_RGB_MIX","MIX_RGB_ADD","MIX_RGB_MULTIPLY","MIX_RGB_SUBTRACT","MIX_RGB_SCREEN","MIX_RGB_DIVIDE","MIX_RGB_DIFFERENCE","MIX_RGB_DARKEN","MIX_RGB_LIGHTEN","MIX_RGB_OVERLAY","MIX_RGB_DODGE","MIX_RGB_BURN","MIX_RGB_HUE","MIX_RGB_SATURATION","MIX_RGB_VALUE","MIX_RGB_COLOR","MIX_RGB_SOFT_LIGHT","MIX_RGB_LINEAR_LIGHT","SEPRGB","SEPHSV","VALTORGB","VECT_TRANSFORM","VECT_MATH_ADD","VECT_MATH_SUBTRACT","VECT_MATH_AVERAGE","VECT_MATH_DOT_PRODUCT","VECT_MATH_CROSS_PRODUCT","VECT_MATH_NORMALIZE"];Je.traverse(e,function(e,a){var n=a.type;switch(_.indexOf(n)){case-1:var o={node_id:e,node:a};r.push(o);break;case 0:t=e}});for(var n=0;n<r.length;n++)for(var o=r[n].node_id,i=Je.out_edge_count(e,o),s={},c=0;c<i;c++){var E=Je.get_out_edge(e,o,c);E in s||(s[E]=0);var l=Je.get_edge_attr(e,o,E,s[E]++);a.push([o,E,l])}for(var n=0;n<a.length;n++)Je.remove_edge_by_attr(e,a[n][0],a[n][1],a[n][2]);if(a.length){var T=Je.subgraph_node_conn(e,t,Je.BACKWARD_DIR);e.nodes=T.nodes,e.edges=T.edges}}function I(e){var t=-1,r=[],a=[];Je.traverse(e,function(e,a){switch(a.type){case"ADD_WORLD_RGB":case"MIX_WORLD_RGB":var _={node_id:e,node:a};r.push(_);break;case"OUTPUT_WORLD_SURFACE":t=e;var _={node_id:e,node:a};r.push(_)}});for(var _=0;_<r.length;_++)for(var n=r[_].node_id,o=r[_].node,i=Je.in_edge_count(e,n),s={},c=0;c<i;c++){var E=Je.get_in_edge(e,n,c),l=Je.get_node_attr(e,E);E in s||(s[E]=0);var T=Je.get_edge_attr(e,E,n,s[E]++);"OUTPUT_WORLD_SURFACE"!=o.type&&0==T[1]||"ADD_WORLD_RGB"==l.type||"MIX_WORLD_RGB"==l.type||"BACKGROUND"==l.type||a.push([E,n,T])}for(var _=0;_<a.length;_++)Je.remove_edge_by_attr(e,a[_][0],a[_][1],a[_][2]);if(a.length){var u=Je.subgraph_node_conn(e,t,Je.BACKWARD_DIR);e.nodes=u.nodes,e.edges=u.edges}}function b(e,t){Je.traverse_edges(e,function(r,a,_){var n=Je.get_node_attr(e,a);a==t&&"Color"==n.inputs[_[1]].identifier&&Je.remove_edge_by_attr(e,r,a,_)})}function Y(){var e=Je.create(),t={default_value:new Float32Array([0,0,0]),identifier:"Color",is_linked:!1,name:"Color"},r={default_value:1,identifier:"Alpha",is_linked:!1,name:"Alpha"},a={data:null,dirs:[],params:[],inputs:[t,r],outputs:[],type:"OUTPUT",vparams:[]};return Je.append_node(e,0,a),e}function L(e){return Je.clone(e,re,Re)}function M(e){Je.traverse(e,function(t,r){for(var a=r.inputs,_=r.outputs,n=0;n<a.length;n++)y(e,a[n],t,n,1);for(var n=0;n<_.length;n++)y(e,_[n],t,n,0)})}function y(e,t,r,a,_){if(t.is_linked){var n=!0;Je.traverse_edges(e,function(e,t,o){(!_&&e==r&&o[0]==a||_&&t==r&&o[1]==a)&&(n=!1)}),n&&(t.is_linked=!1)}}function x(e,t){var r=[];Je.traverse_edges(e,function(a,_,n){var o=Je.get_node_attr(e,a),i=Je.get_node_attr(e,_),s=u._16(o.outputs[n[0]].default_value),c=u._16(i.inputs[n[1]].default_value);if(s!=c){var E,l={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},T={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};s&&!c?E=$("vector_to_scalar","B4W_VECTOSCAL",[l],[T]):!s&&c&&(E=$("scalar_to_vector","B4W_SCALTOVEC",[T],[l])),ae(e,E,0,t,null,[]),r.push([a,_,e.nodes[e.nodes.length-2],n])}});for(var a=0;a<r.length;++a)Je.remove_edge_by_attr(e,r[a][0],r[a][1],r[a][3]),Je.append_edge(e,r[a][0],r[a][2],[r[a][3][0],0]),Je.append_edge(e,r[a][2],r[a][1],[0,r[a][3][1]])}function U(e){var t=[];Je.traverse(e,function(r,a){switch(a.type){case"B4W_TRANSLUCENCY":Je.traverse_edges(e,function(_,n,o){var i=Je.get_node_attr(e,n);if(_==r&&"MATERIAL_EXT"==i.type){var s=o[0];"Translucency"==a.outputs[s].name&&t.push(_,n,[o[0]+1,o[1]+1])}})}});for(var r=0;r<t.length;r+=3)Je.append_edge(e,t[r],t[r+1],t[r+2])}function w(e,t){var r=[];if(Je.traverse(t,function(t,a){a.name==e.name&&r.push(t)}),r.length)return r;qe.panic("Node not found")}function C(e){var t=[];Je.traverse(e,function(e,r){"B4W_PARALLAX"!=r.type&&"REROUTE"!=r.type||t.push(e,r)});for(var r=0;r<t.length;r+=2){var a=t[r],_=t[r+1];if("B4W_PARALLAX"==_.type)D(e,a,_);else if("REROUTE"==_.type){for(var n=Je.get_in_edge(e,a,0),o=Je.out_edge_count(e,a),i=[],s=[],c=[],E=0;E<o;E++){var l=Je.get_out_edge(e,a,E),T=s.indexOf(l),u=T>=0?c[T]:0,d=Je.get_edge_attr(e,a,l,u);if(d){var f=d[1],P=_.inputs[0].default_value,A=Je.get_node_attr(e,l),S=A.inputs[f];switch(typeof P){case"number":if("object"==typeof S.default_value)for(var p=S.default_value,v=0;v<p.length;v++)p[v]=P;else"number"==typeof S.default_value&&(S.default_value=P);break;case"object":if("object"==typeof S.default_value)for(var p=S.default_value,v=0;v<p.length;v++)p[v]=P[v];else"number"==typeof S.default_value&&(S.default_value=.35*P[0]+.45*P[1]+.2*P[2])}}for(var m=_.outputs,v=0;v<m.length;v++)m[v].default_value=_.inputs[0].default_value;-1!=T?c[T]+=1:(s.push(l),c.push(1),i.push(a,l))}if(-1!=n)for(var O=Je.get_edge_attr(e,n,a,0)[0],E=0;E<s.length;E++)for(var v=0;v<c[E];v++){var N=Je.get_edge_attr(e,a,s[E],v)[1];Je.append_edge(e,n,s[E],[O,N])}for(var E=0;E<i.length;E+=2)Je.remove_edge(e,i[E],i[E+1],-1)}}}function D(e,t,r){var a=F(e,t,1);if(-1!=a){var _=Je.get_node_attr(e,a);if(r.data=_.data,Je.remove_edge(e,a,t,-1),0==Je.out_edge_count(e,a)){var n=Je.get_in_edge(e,a,0);-1!=n&&Je.remove_edge(e,n,a,-1),Je.remove_node(e,a)}}r.inputs.splice(1,1)}function F(e,t,r){for(var a=e.edges,_=0;_<a.length;_+=3)if(a[_+1]==t){var n=a[_+2][1];if(n==r)return a[_]}return-1}function G(e){B(e),H(e),k(e)}function k(e,t){var r={};Je.traverse(e,function(e,t){if("GEOMETRY_UV"==t.type||"UVMAP"==t.type||"TEX_COORD_UV"==t.type){var a=t.data.value;a in r||(r[a]=[]),r[a].push(e,t)}});for(var a in r){var _=r[a];if(_.length>2)for(var n=K(a),o=ae(e,n,0,t,null,[]),i=Je.get_node_attr(e,o),s=0;s<_.length;s+=2){for(var c=_[s],E=_[s+1],l=[],T={},u=Je.out_edge_count(e,c),d=0;d<u;d++){var f=Je.get_out_edge(e,c,d);f in T||(T[f]=0);var P=Je.get_edge_attr(e,c,f,T[f]);T[f]++,l.push(c,f,P);var A=P.splice(0,P.length);switch(E.type){case"GEOMETRY_UV":A[0]=0,i.outputs[0].is_linked=!0;break;case"UVMAP":case"TEX_COORD_UV":A[0]=1,i.outputs[1].is_linked=!0}Je.append_edge(e,o,f,A)}for(var d=0;d<l.length;d+=3)Je.remove_edge(e,l[d],l[d+1],0);Je.remove_node(e,c)}}}function K(e){var t={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},r={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"},a=$("merged_uv","UV_MERGED",[],[t,r]);return a.uv_layer=e,a}function B(e){var t=[];Je.traverse(e,function(e,r){"GEOMETRY_VC"!=r.type&&"GEOMETRY_NO"!=r.type&&"GEOMETRY_FB"!=r.type&&"GEOMETRY_VW"!=r.type&&"GEOMETRY_GL"!=r.type&&"GEOMETRY_LO"!=r.type&&"GEOMETRY_OR"!=r.type&&"GEOMETRY_BF"!=r.type&&"GEOMETRY_IN"!=r.type||t.push(e,r)});for(var r=[],a=0;a<t.length;a+=2){for(var _=t[a],n=t[a+1],o=!0,i=0;i<r.length;i++){var s=r[i];if(Q(n,s.attr)){for(var c=[],E=Je.out_edge_count(e,_),l=0;l<E;l++){var T=Je.get_out_edge(e,_,l),u=Je.get_edge_attr(e,_,T,0);c.push(_,T,u),Je.append_edge(e,s.id,T,u)}for(var l=0;l<c.length;l+=3)Je.remove_edge(e,c[l],c[l+1],0);Je.remove_node(e,_),o=!1;break}}if(o){var s={id:_,attr:n};r.push(s)}}}function X(e){for(var t={},r=0;r<e.nodes.length;r+=2){var a=e.nodes[r];t[a]={ascs_ids:{},is_completed:!1}}for(var r=0;r<e.edges.length;r+=3){var _=e.edges[r];t[e.edges[r+1]].ascs_ids[_]=!0}for(var a in t)j(a,t);for(var a in t)t[a]=Object.keys(t[a].ascs_ids).map(function(e){return parseInt(e,10)});return t}function j(e,t){var r=t[e];if(!r.is_completed){var a=u.O(r);for(var _ in r.ascs_ids){j(_,t);var n=t[_];for(var o in n.ascs_ids)a.ascs_ids[o]=!0}a.is_completed=!0,t[e]=a}}function H(e){var t=[];if(Je.traverse(e,function(e,r){"TEXTURE_COLOR"!=r.type&&"TEXTURE_NORMAL"!=r.type||t.push(e,r)}),t.length){for(var r=X(e),a=[],_=0;_<t.length;_+=2){for(var n=t[_],o=t[_+1],i=!0,s=0;s<a.length;s++){var c=a[s];if(!(c.merged_nodes.length>=3)&&(Q(o,c.attr)&&!(r[n].indexOf(c.id)>-1||r[c.id].indexOf(n)>-1))){for(var E=!1,l=0;l<c.merged_nodes.length;l++){var T=c.merged_nodes[l].id;if(r[n].indexOf(T)>-1||r[T].indexOf(n)>-1){E=!0;break}}if(!E){var u=[],d=Je.in_edge_count(e,n),f={};for(l=0;l<d;l++){var P=Je.get_in_edge(e,n,l);P in f||(f[P]=0);var A=Je.get_edge_attr(e,P,n,f[P]++);u.push(P,n,A)}var S=[],p=Je.out_edge_count(e,n),v={};for(l=0;l<p;l++){var m=Je.get_out_edge(e,n,l);m in v||(v[m]=0);var A=Je.get_edge_attr(e,n,m,v[m]++);S.push(n,m,A)}for(var O=u.concat(S),l=0;l<O.length;l+=3)Je.remove_edge(e,O[l],O[l+1],0);Je.remove_node(e,n);var N={id:n,attr:o,edges_in:u,edges_out:S};c.merged_nodes.push(N),i=!1;break}}}if(i){var c={id:n,attr:o,merged_nodes:[]};a.push(c)}}for(var _=0;_<a.length;_++){for(var c=a[_],g=c.merged_nodes.length,s=0;s<g;s++){var h=c.merged_nodes[s],N=h.attr,R=h.edges_in,I=h.edges_out;c.attr.inputs[s+1].is_linked=N.inputs[0].is_linked,c.attr.inputs[s+1].default_value=N.inputs[0].default_value,c.attr.outputs[2*(s+1)].is_linked=N.outputs[0].is_linked,c.attr.outputs[2*(s+1)].default_value=N.outputs[0].default_value,c.attr.outputs[2*(s+1)+1].is_linked=N.outputs[1].is_linked,c.attr.outputs[2*(s+1)+1].default_value=N.outputs[1].default_value;for(var l=0;l<R.length;l+=3){var P=R[l],A=R[l+2];A[1]+=s+1,Je.append_edge(e,P,c.id,A)}for(var l=0;l<I.length;l+=3){var m=I[l+1],A=I[l+2];A[0]+=2*(s+1),Je.append_edge(e,c.id,m,A)}c.attr.dirs.push(["USE_uv"+(s+2),1])}Je.remove_node(e,c.id),Je.append_node(e,c.id,c.attr)}}}function Q(e,t){if(e.type!==t.type)return!1;switch(e.type){case"GEOMETRY_VC":return e.data.value==t.data.value;case"GEOMETRY_NO":return z(e,t,"USE_NORMAL_IN");case"GEOMETRY_FB":case"GEOMETRY_VW":case"GEOMETRY_GL":case"GEOMETRY_LO":case"GEOMETRY_OR":case"GEOMETRY_BF":case"GEOMETRY_IN":return!0;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":return e.data.bpy_uuid==t.data.bpy_uuid&&e.data.value.img_uuid==t.data.value.img_uuid;case"VALUE":case"RGB":return e.origin_name==t.origin_name;default:return!1}}function z(e,t,r){for(var a=e.dirs,_=-1,n=0;n<a.length;n++){var o=a[n];if(o[0]==r){_=o[1];break}}for(var i=t.dirs,s=-1,n=0;n<i.length;n++){var c=i[n];if(c[0]==r){s=c[1];break}}return _===s}function q(e){var t=[],r=[];Je.traverse(e,function(e,a){"GEOMETRY_VC"==a.type&&t.push(e,a),"GEOMETRY_VW"==a.type&&r.push(e,a)}),V(e,t),W(e,r)}function V(e,t){for(var r=0;r<t.length;r+=2){for(var a=t[r],_=t[r+1],n=!1,o=[],i=[],s=[[],[],[]],c=Je.out_edge_count(e,a),E=0;E<c;E++){var l=Je.get_out_edge(e,a,E);if("SEPRGB"!=Je.get_node_attr(e,l).type){n=!1;break}o.push(a,l);for(var T={},d=Je.out_edge_count(e,l),f=0;f<d;f++){var P=Je.get_out_edge(e,l,f);P in T||(T[P]=0);var A=Je.get_edge_attr(e,l,P,T[P]++);o.push(l,P),s[A[0]].push(a,P,A)}i.push(l),n=!0}if(n){for(var S=0,p=0,E=0;E<s.length;E++)s[E].length&&(S++,p|=1<<2-E);if(S){_.type+=S,_.outputs=[];for(var E=0;E<s.length;E++)if(s[E].length){_.outputs.push({default_value:0,identifier:"RGB"[E],is_linked:!0,name:"RGB"[E]});for(var f=0;f<s[E].length;f+=3)s[E][f+2][0]=u._42(p,E)}for(var E=0;E<o.length;E+=2)Je.remove_edge(e,o[E],o[E+1],0);for(var E=0;E<i.length;E++)Je.remove_node(e,i[E]);for(var E=0;E<s.length;E++)for(var f=0;f<s[E].length;f+=3)Je.append_edge(e,s[E][f],s[E][f+1],s[E][f+2])}}}}function W(e,t){for(var r=0;r<t.length;r+=2){for(var a=t[r],_=!0,n=[],o=Je.out_edge_count(e,a),i=0;i<o;i++){var s=Je.get_out_edge(e,a,i);if("B4W_REFLECT"==Je.get_node_attr(e,s).type){var c=Je.get_edge_attr(e,a,s,0),E=Je.get_edge_attr(e,a,s,1);c&&1==c[1]||E&&1==E[1]?_=!1:n.push(a,s)}else _=!1}for(var i=0;i<n.length;i+=2)J(e,n[i],n[i+1]);_&&Je.remove_node(e,a)}}function J(e,t,r){var a=Je.get_node_attr(e,r);a.type+="_WORLD",Je.remove_edge(e,t,r,0),a.inputs.splice(0,1);var _=Je.get_in_edge(e,r,0);if(_!=Je.NULL_NODE){Je.get_edge_attr(e,_,r,0)[1]=0}}function Z(e,t,r,a,_,n){for(var o=e.nodes,i=null,s=0;s<o.length;s++){var c=o[s];_?"GROUP"==c.type&&c.node_tree_name==r&&(i=c):c.type==r&&(i=c)}return i?w(i,t)[0]:(n||Ze.error('No "'+r+'" node in node '+a),-1)}function $(e,t,r,a){return{name:e,type:t,inputs:r,outputs:a}}function ee(e,t,r,a){return{from_node:e,from_socket:t,to_node:r,to_socket:a}}function te(){return{name:"",origin_name:"",type:"",vparams:[],inputs:[],outputs:[],params:[],data:null,dirs:[]}}function re(e){var t=te();t.name=e.name,t.origin_name=e.origin_name,t.type=e.type;for(var r=t.vparams,a=e.vparams,_=0;_<a.length;_++){var n=a[_];r.push(ge(n))}for(var o=t.params,i=e.params,_=0;_<i.length;_++){var s=i[_];o.push(ge(s))}for(var c=t.inputs,E=e.inputs,_=0;_<E.length;_++){var l=E[_];c.push(pe(l))}for(var T=t.outputs,u=e.outputs,_=0;_<u.length;_++){var d=u[_];T.push(pe(d))}for(var f=t.dirs,P=e.dirs,_=0;_<P.length;_++){var A=P[_];f.push(A.slice())}return t.data=e.data,t}function ae(e,t,r,a,_,n){var o=t.name,i=t.name,s=t.type,l=[],T=[],f=[],P=[],A=null,S="uv_layer"in t?t.uv_layer||_&&_.uv_name||"":"",p="color_layer"in t?t.color_layer||_&&_.vc_name||"":"",v=[];switch(s){case"BSDF_ANISOTROPIC":case"BSDF_GLASS":case"BSDF_HAIR":case"BSDF_TRANSLUCENT":case"BSDF_REFRACTION":case"BSDF_TOON":case"BSDF_VELVET":case"SUBSURFACE_SCATTERING":case"AMBIENT_OCCLUSION":case"VOLUME_ABSORPTION":case"VOLUME_SCATTER":case"BLACKBODY":case"WAVELENGTH":case"SEPXYZ":case"COMBXYZ":case"LIGHT_FALLOFF":case"TEX_SKY":case"TEX_NOISE":case"TEX_WAVE":case"TEX_MUSGRAVE":case"TEX_GRADIENT":case"TEX_MAGIC":case"TEX_CHECKER":case"TEX_BRICK":case"WIREFRAME":case"TANGENT":case"LIGHT_PATH":case"HOLDOUT":case"HAIR_INFO":case"SCRIPT":T=me(t),f=Oe(t),Ze.warn(s+" node is not fully supported.");break;case"BRIGHTCONTRAST":case"ADD_SHADER":T=me(t),f=Oe(t);break;case"MIX_SHADER":T.push(fe(t,"Fac"));var m=fe(t,"Shader"),O=m.is_linked;T.push(m);var N=fe(t,"Shader_001");N||(N=fe(t,"Shader.001"));var g=N.is_linked;T.push(N),T.push(Se("d_color1","d_color1",[0,0,0],O)),T.push(Se("d_roughness1","d_roughness1",0,O)),T.push(Se("s_color1","s_color1",[0,0,0],O)),T.push(Se("s_roughness1","s_roughness1",0,O)),T.push(Se("metalness1","metalness1",0,O)),T.push(Se("normal1","normal1",[0,0,0],O)),T.push(Se("ior1","ior1",0,O)),T.push(Se("transmission1","transmission1",0,O)),T.push(Se("e_color1","e_color1",[0,0,0],O)),T.push(Se("emission1","emission1",0,O)),T.push(Se("a_color1","a_color1",[0,0,0],O)),T.push(Se("alpha1","alpha1",1,O)),T.push(Se("d_color2","d_color2",[0,0,0],g)),T.push(Se("d_roughness2","d_roughness2",0,g)),T.push(Se("s_color2","s_color2",[0,0,0],g)),T.push(Se("s_roughness2","s_roughness2",0,g)),T.push(Se("metalness2","metalness2",0,g)),T.push(Se("normal2","normal2",[0,0,0],g)),T.push(Se("ior2","ior2",0,g)),T.push(Se("transmission2","transmission2",0,g)),T.push(Se("e_color2","e_color2",[0,0,0],g)),T.push(Se("emission2","emission2",0,g)),T.push(Se("a_color2","a_color2",[0,0,0],g)),T.push(Se("alpha2","alpha2",1,g));var h=Pe(t,"Shader"),R=h.is_linked;f=[h,Se("d_color","d_color",[0,0,0],R),Se("d_roughness","d_roughness",0,R),Se("s_color","s_color",[0,0,0],R),Se("s_roughness","s_roughness",0,R),Se("metalness","metalness",0,R),Se("normal","normal",[0,0,0],R),Se("ior","ior",0,R),Se("transmission","transmission",0,R),Se("e_color","e_color",[0,0,0],R),Se("emission","emission",0,R),Se("a_color","a_color",[0,0,0],R),Se("alpha","alpha",1,R)];break;case"OBJECT_INFO":T=me(t),f=[];var I=Pe(t,"Location"),b=Pe(t,"Object Index"),Y=Pe(t,"Material Index"),L=Pe(t,"Random");f.push(I),f.push(b),f.push(Y),f.push(L),v.push(["USE_LOCATION_OUT",0|I.is_linked]),v.push(["USE_OBJ_IND_OUT",0|b.is_linked]),v.push(["USE_MAT_IND_OUT",0|Y.is_linked]),v.push(["USE_RANDOM_OUT",0|L.is_linked]);break;case"UVMAP":if(S||(s="EMPTY_UV"),"EMPTY_UV"!=s){var M=ce("param_"+s+"_a"),y=ce("param_"+s+"_v");l.push(Ne(M)),l.push(Ne(y)),P.push(Ne(y)),A={name:M,value:S}}f=Oe(t);break;case"UV_MERGED":var M=ce("param_UV_MERGED_a"),y=ce("param_UV_MERGED_v");l.push(Ne(M)),l.push(Ne(y)),f.push(Pe(t,"UV_geom")),f.push(Pe(t,"UV_cycles")),P.push(Ne(y)),A={name:M,value:S};break;case"CAMERA":T=[],f=Oe(t);break;case"COMBRGB":case"COMBHSV":T=me(t),f=Oe(t);break;case"CURVE_RGB":case"CURVE_VEC":"CURVE_RGB"==s?(ze(t,0,0,1)&&v.push(["READ_R",1]),ze(t,1,0,1)&&v.push(["READ_G",1]),ze(t,2,0,1)&&v.push(["READ_B",1]),ze(t,3,0,1)&&v.push(["READ_A",1])):(ze(t,0,-1,1)&&v.push(["READ_R",1]),ze(t,1,-1,1)&&v.push(["READ_G",1]),ze(t,2,-1,1)&&v.push(["READ_B",1])),T=me(t),f=Oe(t),A={value:t};break;case"PARTICLE_INFO":T=me(t),f=Oe(t);for(var x=0;x<t.outputs.length;x++){var U=t.outputs[x],w=U.identifier,C=Ne("v_param_PART_INFO_"+w.replace(" ",""));if(U.is_linked)switch(w){case"Size":v.push(["PART_INFO_SIZE",$e.glsl_value(1)]);break;case"Age":v.push(["PART_INFO_AGE",$e.glsl_value(1)]);break;case"Lifetime":v.push(["PART_INFO_LT",$e.glsl_value(1)]);break;case"Location":v.push(["PART_INFO_LOC",$e.glsl_value(1)]);break;case"Index":var D=Ne("a_param_PART_INFO_"+U.identifier.replace(" ",""));A=D,v.push(["PART_INFO_IND",$e.glsl_value(1)]);break;case"Velocity":v.push(["PART_INFO_VEL",$e.glsl_value(1)]);break;case"Angular Velocity":v.push(["PART_INFO_A_VEL",$e.glsl_value(1)])}"Age"!=w&&"Lifetime"!=w&&"Size"!=w&&(l.push(C),P.push(C))}D&&l.push(D);break;case"NEW_GEOMETRY":case"GEOMETRY":if(!Ee(t))return!0;if(!(s=le(t,r)))return Ze.error("Geometry output is not supported"),null;switch(s){case"GEOMETRY_UV":if(S||(s="EMPTY_UV"),"EMPTY_UV"!=s){var M=ce("param_GEOMETRY_UV_a"),y=ce("param_GEOMETRY_UV_v");l.push(Ne(M)),l.push(Ne(y)),P.push(Ne(y)),A={name:M,value:S}}f.push(Pe(t,"UV"));break;case"GEOMETRY_VC":if(p||(s="EMPTY_VC"),"EMPTY_VC"!=s){var F=ce("param_GEOMETRY_VC_a"),G=ce("param_GEOMETRY_VC_v");l.push(Ne(F)),l.push(Ne(G)),P.push(Ne(G)),A={name:F,value:p}}f.push(Pe(t,"Vertex Color"));break;case"GEOMETRY_NO":T.push(Se("Normal","Normal",[0,0,0],!1)),v.push(["USE_NORMAL_IN",0]),f.push(Pe(t,"Normal"));break;case"GEOMETRY_TRN":s="GEOMETRY_NO",T.push(Se("Normal","Normal",[0,0,0],!1)),f.push(Pe(t,"True Normal")),v.push(["USE_NORMAL_IN",0]),Ze.warn("Geometry True Normal output is not fully supported.");break;case"GEOMETRY_FB":f.push(Pe(t,"Front/Back"));break;case"GEOMETRY_VW":f.push(Pe(t,"View"));break;case"GEOMETRY_GL":f.push(Pe(t,"Global")||Pe(t,"Position"));break;case"GEOMETRY_LO":f.push(Pe(t,"Local"));break;case"GEOMETRY_OR":var k=ce("param_GEOMETRY_OR_v");l.push(Ne(k)),f.push(Pe(t,"Orco")),P.push(Ne(k));break;case"GEOMETRY_IN":f.push(Pe(t,"Incoming"));break;case"GEOMETRY_BF":f.push(Pe(t,"Backfacing"))}break;case"ATTRIBUTE":if(!Ee(t))return!0;if("EMPTY_VC"!=(s=p?"GEOMETRY_VC":"EMPTY_VC")){var F=ce("param_GEOMETRY_VC_a"),G=ce("param_GEOMETRY_VC_v");l.push(Ne(F)),l.push(Ne(G)),P.push(Ne(G)),A={name:F,value:p}}f.push(Pe(t,"Color"));break;case"TEX_COORD":if(!Ee(t))return!0;switch(s=Te(t,r)){case"TEX_COORD_UV":if(S||(s="EMPTY_UV"),"EMPTY_UV"!=s){var M=ce("param_TEX_COORD_UV_a"),y=ce("param_TEX_COORD_UV_v");l.push(Ne(M)),l.push(Ne(y)),P.push(Ne(y)),A={name:M,value:S}}f.push(Pe(t,"UV"));break;case"TEX_COORD_NO":f.push(Pe(t,"Normal"));break;case"TEX_COORD_GE":var K=ce("param_TEX_COORD_GE_v");l.push(Ne(K)),f.push(Pe(t,"Generated")),P.push(Ne(K));break;case"TEX_COORD_OB":f.push(Pe(t,"Object"));break;case"TEX_COORD_CA":f.push(Pe(t,"Camera"));break;case"TEX_COORD_WI":f.push(Pe(t,"Window"));break;case"TEX_COORD_RE":f.push(Pe(t,"Reflection"))}break;case"GROUP":var B=t.node_tree_name;switch(B){case"B4W_LINEAR_TO_SRGB":if(!_e(t,[1],[1])){A=ne(t,a,_,[]);break}s="B4W_LINEAR_TO_SRGB";break;case"B4W_NORMAL_VIEW":case"B4W_VECTOR_VIEW":if(!_e(t,[1],[1])){A=ne(t,a,_,[]);break}s="B4W_VECTOR_VIEW";break;case"B4W_SRGB_TO_LINEAR":if(!_e(t,[1],[1])){A=ne(t,a,_,[]);break}s="B4W_SRGB_TO_LINEAR";break;case"B4W_REFLECT":if(!_e(t,[1,1],[1])){A=ne(t,a,_,[]);break}s="B4W_REFLECT";break;case"B4W_REFRACTION":if(!_e(t,[1,0],[1])){A=ne(t,a,_,[]);break}s="B4W_REFRACTION";break;case"B4W_PARALLAX":if(!_e(t,[1,1,0,0,0],[1])){A=ne(t,a,_,[]);break}var X=ce("param_B4W_PARALLAX_texture");P.push(Ne(X)),s="B4W_PARALLAX";break;case"B4W_CLAMP":if(!_e(t,[1],[1])){A=ne(t,a,_,[]);break}s="B4W_CLAMP";break;case"B4W_TRANSLUCENCY":if(!_e(t,[0,0,0,0,0],[0])){A=ne(t,a,_,[]);break}s="B4W_TRANSLUCENCY";break;case"B4W_TIME":if(!_e(t,[],[0])){A=ne(t,a,_,[]);break}s="B4W_TIME";break;case"B4W_SMOOTHSTEP":if(!_e(t,[0,0,0],[0])){A=ne(t,a,_,[]);break}s="B4W_SMOOTHSTEP";break;case"B4W_GLOW_OUTPUT":s="B4W_GLOW_OUTPUT";break;default:A=ne(t,a,_,n)}if(T=me(t),f=Oe(t),"B4W_TRANSLUCENCY"==B){var j=Se("TranslucencyParams","TranslucencyParams",[0,0,0,0]);j.is_linked=f[0].is_linked,f.push(j)}break;case"LAMP":var H=t.lamp;H?(H.uuid in _t?v.push(["LAMP_INDEX",String(_t[H.uuid])]):(_t[H.uuid]=nt,v.push(["LAMP_INDEX",String(nt++)])),A=_t):(Ze.error("There is no lamp in node: "+t.name),v.push(["LAMP_INDEX",-1])),f.push(Pe(t,"Color")),f.push(Pe(t,"Light Vector")),f.push(Pe(t,"Distance")),f.push(Pe(t,"Visibility Factor"));break;case"LIGHTING_AMBIENT":T=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0)],f=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0)];break;case"LIGHTING_BEGIN":f=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("dif_params","dif_params",[0,0],!0),Se("sp_params","sp_params",[0,0],!0),Se("shadow_factor","shadow_factor",0,!0),Se("translucency_color","translucency_color",0,!0),Se("translucency_params","translucency_params",[0,0,0,0],!0)];break;case"LIGHTING_END":T=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0)];break;case"LIGHTING_LAMP":T=[Se("shadow_factor","shadow_factor",0,!0)],f=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("lcolorint","lcolorint",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0)];break;case"DIFFUSE_LAMBERT":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0)],f=[Se("lfactor","lfactor",0,!0)],v.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"DIFFUSE_FRESNEL":case"DIFFUSE_MINNAERT":case"DIFFUSE_OREN_NAYAR":case"DIFFUSE_TOON":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("dif_params","dif_params",[0,0],!0)],f=[Se("lfactor","lfactor",0,!0)],v.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_BLINN":case"SPECULAR_PHONG":case"SPECULAR_COOKTORR":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("sp_params","sp_params",[0,0],!0)],f=[Se("sfactor","sfactor",0,!0)],v.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_TOON":case"SPECULAR_WARDISO":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("sp_params","sp_params",[0,0],!0)],f=[Se("sfactor","sfactor",0,!0)],v.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"BSDF_COMPUTE":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("bsdf_params","bsdf_params",[0,0,0,0],!0)],f=[Se("lfactor","lfactor",0,!0),Se("sfactor","sfactor",0,!0)];break;case"LIGHTING_APPLY":T=[Se("color","color",[0,0,0,0],!0),Se("specular","specular",[0,0,0],!0),Se("lfactor","lfactor",0,!0),Se("sfactor","sfactor",0,!0),Se("ldir","ldir",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("translucency_params","translucency_params",[0,0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("lcolorint","lcolorint",[0,0,0],!0),Se("translucency_color","translucency_color",0,!0)],f=[Se("color","color",[0,0,0,0],!0),Se("specular","specular",[0,0,0],!0)];break;case"NORMAL":T=me(t),f=Oe(t);var Q=Pe(t,"Normal");P.push(Ne(ce("param_NORMAL_Normal"),Q.default_value,3));break;case"MAPPING":var z=t.vector_type;s="MAPPING",T.push(fe(t,"Vector")),f.push(Pe(t,"Vector"));var q=u._1(t.rotation),V=u._1(t.scale),W=u._1(t.translation),J=c.create(),Z=u.Z(q,c.create());"TEXTURE"!=z&&"NORMAL"!=z||(V[0]=V[0]||1,V[1]=V[1]||1,V[2]=V[2]||1);var $=new Float32Array([V[0],0,0,0,V[1],0,0,0,V[2]]);switch(c.multiply(Z,$,J),J=u._23(J,E.create()),z){case"POINT":J[12]=W[0],J[13]=W[1],J[14]=W[2];break;case"TEXTURE":J[12]=W[0],J[13]=W[1],J[14]=W[2],J=E.invert(J,J);break;case"NORMAL":E.invert(J,J),E.transpose(J,J)}switch(z){case"NORMAL":v.push(["MAPPING_IS_NORMAL",1]);case"TEXTURE":v.push(["MAPPING_TRS_MATRIX_DEF",1]),v.push(["MAPPING_TRS_MATRIX",$e.glsl_value(J,16)]);break;case"POINT":0!==d.length(q)?(v.push(["MAPPING_TRS_MATRIX_DEF",1]),v.push(["MAPPING_TRS_MATRIX",$e.glsl_value(J,16)])):(0!==d.sqrDist(V,u.n)&&(v.push(["MAPPING_SCALE_DEF",1]),v.push(["MAPPING_SCALE",$e.glsl_value(V,3)])),0!==d.length(W)&&(v.push(["MAPPING_TRANS_DEF",1]),v.push(["MAPPING_TRANS",$e.glsl_value(W,3)])));break;case"VECTOR":0!==d.length(q)?(v.push(["MAPPING_TRS_MATRIX_DEF",1]),v.push(["MAPPING_TRS_MATRIX",$e.glsl_value(J,16)])):0!==d.sqrDist(V,u.n)&&(v.push(["MAPPING_SCALE_DEF",1]),v.push(["MAPPING_SCALE",$e.glsl_value(V,3)]))}t.use_min&&(v.push(["MAPPING_MIN_CLIP_DEF",1]),v.push(["MAPPING_MIN_CLIP",$e.glsl_value(t.min,3)])),t.use_max&&(v.push(["MAPPING_MAX_CLIP_DEF",1]),v.push(["MAPPING_MAX_CLIP",$e.glsl_value(t.max,3)]));break;case"MATERIAL":case"MATERIAL_EXT":var ee=[],te=[],re=[],oe=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("dif_params","dif_params",[0,0],!0),Se("sp_params","sp_params",[0,0],!0),Se("shadow_factor","shadow_factor",0,!0)],ie=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0),Se("normal","normal",[0,0,0],!0)],se=[Pe(t,"Color"),Pe(t,"Alpha"),Pe(t,"Normal")],Ae=[],pe=fe(t,"Color");pe.default_value.splice(3),re.push(pe),T.push(pe),pe=fe(t,"Spec"),pe.default_value.splice(3),re.push(pe),T.push(pe),pe=fe(t,"DiffuseIntensity"),pe||(pe=fe(t,"Refl")),pe.default_value=t.diffuse_intensity,re.push(pe),T.push(pe);var ve=fe(t,"Normal");if(ve.default_value.splice(3),re.push(ve),T.push(ve),"MATERIAL_EXT"==s){pe=fe(t,"Emit"),pe||(pe=Se("Emit","Emit",0)),re.push(pe),T.push(pe),pe=fe(t,"Translucency"),pe?(pe.default_value=0,pe.name="Translucency",pe.identifier="Translucency"):pe=Se("Translucency","Translucency",0),T.push(pe),pe=fe(t,"Translucency"),pe?(pe.default_value=[0,0,0,0],pe.name="TranslucencyParams",pe.identifier="TranslucencyParams"):pe=Se("TranslucencyParams","TranslucencyParams",[0,0,0,0]),T.push(pe);var ge=fe(t,"Reflectivity"),he=fe(t,"Ray Mirror");if(ge){pe=ge;var Re="Reflectivity"}else if(he){pe=he;var Re="Ray Mirror"}else{pe=ge;var Re="Reflectivity"}pe||(pe=Se(Re,Re,0)),T.push(pe),ie.push(pe),pe=fe(t,"SpecTra"),pe||(pe=Se("SpecTra","SpecTra",0)),T.push(pe),ie.push(pe),pe=fe(t,"Alpha"),pe||(pe=Se("Alpha","Alpha",t.alpha)),T.push(pe),ie.push(pe),se.push(Pe(t,"Diffuse")),se.push(Pe(t,"Spec")),ee.push(["MATERIAL_EXT",1]),te.push(["MATERIAL_EXT",1])}else re.push(Se("emit_intensity","emit_intensity",0)),ie.push(Se("reflect_factor","reflect_factor",0)),ie.push(Se("specular_alpha","specular_alpha",0)),ie.push(Se("alpha_in","alpha_in",0)),se.push(Se("diffuse_out","diffuse_out",0)),se.push(Se("spec_out","spec_out",0)),ee.push(["MATERIAL_EXT",0]),te.push(["MATERIAL_EXT",0]);Ae.push(Ne(ce("param_MATERIAL_alpha"),t.alpha)),Ae.push(Ne(ce("param_MATERIAL_spec_alpha"),t.specular_alpha)),f=se,ee.push(["USE_MATERIAL_NORMAL",0|ve.is_linked]),t.use_diffuse&&(ee.push(["USE_MATERIAL_DIFFUSE",1]),te.push(["USE_MATERIAL_DIFFUSE",1])),t.use_specular&&te.push(["USE_MATERIAL_SPECULAR",1]);var Ie,be=[],Ye=0;switch(t.specular_shader){case"COOKTORR":case"PHONG":Ie=t.specular_hardness;break;case"WARDISO":Ie=t.specular_slope;break;case"TOON":Ie=t.specular_toon_size,Ye=t.specular_toon_smooth;break;case"BLINN":Ie=t.specular_ior,Ye=t.specular_hardness;break;default:Ze.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.material_name+'")'),Ie=t.specular_hardness}var Le,Me;switch(t.diffuse_shader){case"LAMBERT":Le=0,Me=0;break;case"OREN_NAYAR":Le=t.roughness,Me=0;break;case"FRESNEL":Le=t.diffuse_fresnel,Me=t.diffuse_fresnel_factor;break;case"MINNAERT":Le=t.darkness,Me=0;break;case"TOON":Le=t.diffuse_toon_size,Me=t.diffuse_toon_smooth;break;default:Ze.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.material_name+'")'),Le=0,Me=0}be.push(Ne(ce("param_MATERIAL_diffuse"),[Le,Me],2)),be.push(Ne(ce("param_MATERIAL_spec"),[t.specular_intensity,Ie,Ye],3)),ee.push(["SHADELESS_MAT",t.use_shadeless?1:0]);var ye={name:t.name,value:{specular_shader:t.specular_shader,diffuse_shader:t.diffuse_shader,use_shadeless:t.use_shadeless,use_tangent_shading:t.use_tangent_shading}},xe={name:"material_begin",type:"MATERIAL_BEGIN",inputs:re,outputs:oe,params:be,data:ye,dirs:ee,vparams:[]},Ue={name:"material_end",type:"MATERIAL_END",inputs:ie,outputs:se,params:Ae,data:ye,dirs:te,vparams:[]};A={name:t.name,value:{specular_shader:t.specular_shader,diffuse_shader:t.diffuse_shader,use_shadeless:t.use_shadeless,use_tangent_shading:t.use_tangent_shading},material_begin:xe,material_end:Ue};break;case"BSDF_PRINCIPLED":T=me(t);var we=fe(t,"Base Color"),Ce=fe(t,"Metallic"),De=fe(t,"Roughness"),Fe=fe(t,"IOR"),Ge=fe(t,"Transmission"),ke=fe(t,"Normal");T=[we,Ce,De,Fe,Ge,ke],v.push(["USE_NORMAL_IN",0|ke.is_linked]);var Ke=Pe(t,"BSDF"),Be=Ke.is_linked;f=[Ke,Se("d_color","d_color",[0,0,0],Be),Se("d_roughness","d_roughness",0,Be),Se("s_color","s_color",[0,0,0],Be),Se("s_roughness","s_roughness",0,Be),Se("metalness","metalness",1,Be),Se("normal","normal",[0,0,0],Be),Se("ior","ior",0,Be),Se("transmission","transmission",0,Be),Se("e_color","e_color",[0,0,0],Be),Se("emisson","emisson",0,Be),Se("a_color","a_color",[0,0,0],Be),Se("alpha","alpha",1,Be)];A={value:{use_refract:Ge.is_linked||Ge.default_value}};break;case"BSDF_DIFFUSE":T=me(t),v.push(["USE_NORMAL_IN",0|T[2].is_linked]);var Ke=Pe(t,"BSDF"),Be=Ke.is_linked;f=[Ke,Se("d_color","d_color",[0,0,0],Be),Se("d_roughness","d_roughness",0,Be),Se("s_color","s_color",[0,0,0],Be),Se("s_roughness","s_roughness",0,Be),Se("metalness","metalness",0,Be),Se("normal","normal",[0,0,0],Be),Se("ior","ior",0,Be),Se("transmission","transmission",0,Be),Se("e_color","e_color",[0,0,0],Be),Se("emisson","emisson",0,Be),Se("a_color","a_color",[0,0,0],Be),Se("alpha","alpha",1,Be)];break;case"BSDF_GLOSSY":T=me(t),v.push(["USE_NORMAL_IN",0|T[2].is_linked]);var Ke=Pe(t,"BSDF"),Be=Ke.is_linked;f=[Ke,Se("d_color","d_color",[0,0,0],Be),Se("d_roughness","d_roughness",0,Be),Se("s_color","s_color",[0,0,0],Be),Se("s_roughness","s_roughness",0,Be),Se("metalness","metalness",1,Be),Se("normal","normal",[0,0,0],Be),Se("ior","ior",0,Be),Se("transmission","transmission",0,Be),Se("e_color","e_color",[0,0,0],Be),Se("emisson","emisson",0,Be),Se("a_color","a_color",[0,0,0],Be),Se("alpha","alpha",1,Be)];break;case"BSDF_TRANSPARENT":var Xe=t.b4w_use_alpha;T=me(t);var Ke=Pe(t,"BSDF"),Be=Ke.is_linked;f=[Ke,Se("d_color","d_color",[0,0,0],Be),Se("d_roughness","d_roughness",0,Be),Se("s_color","s_color",[0,0,0],Be),Se("s_roughness","s_roughness",0,Be),Se("metalness","metalness",0,Be),Se("normal","normal",[0,0,0],Be),Se("ior","ior",0,Be),Se("transmission","transmission",0,Be),Se("e_color","e_color",[0,0,0],Be),Se("emisson","emisson",0,Be),Se("a_color","a_color",[0,0,0],Be),Se("alpha","alpha",Xe?0:1,Be)],A={value:{use_alpha:Xe}},v.push(["USE_ALPHA",0|Xe]);break;case"EMISSION":T=me(t);var je=Pe(t,"Emission"),He=je.is_linked;f=[je,Se("d_color","d_color",[0,0,0],He),Se("d_roughness","d_roughness",0,He),Se("s_color","s_color",[0,0,0],He),Se("s_roughness","s_roughness",0,He),Se("metalness","metalness",1,He),Se("normal","normal",[0,0,0],He),Se("ior","ior",0,Be),Se("transmission","transmission",0,Be),Se("e_color","e_color",[0,0,0],He),Se("emisson","emisson",1,He),Se("a_color","a_color",[0,0,0],Be),Se("alpha","alpha",1,Be)];break;case"MATH":switch(t.operation){case"ADD":s="MATH_ADD";break;case"SUBTRACT":s="MATH_SUBTRACT";break;case"MULTIPLY":s="MATH_MULTIPLY";break;case"DIVIDE":s="MATH_DIVIDE";break;case"SINE":s="MATH_SINE";break;case"COSINE":s="MATH_COSINE";break;case"TANGENT":s="MATH_TANGENT";break;case"ARCSINE":s="MATH_ARCSINE";break;case"ARCCOSINE":s="MATH_ARCCOSINE";break;case"ARCTANGENT":s="MATH_ARCTANGENT";break;case"POWER":s="MATH_POWER";break;case"LOGARITHM":s="MATH_LOGARITHM";break;case"MINIMUM":s="MATH_MINIMUM";break;case"MAXIMUM":s="MATH_MAXIMUM";break;case"ROUND":s="MATH_ROUND";break;case"LESS_THAN":s="MATH_LESS_THAN";break;case"GREATER_THAN":s="MATH_GREATER_THAN";break;case"MODULO":s="MATH_MODULO";break;case"ABSOLUTE":s="MATH_ABSOLUTE";break;default:return Ze.error("Unsupported MATH operation: "+t.operation),null}v.push(["MATH_USE_CLAMP",Number(t.use_clamp)]),T=me(t),f=Oe(t);break;case"MIX_RGB":switch(t.blend_type){case"MIX":s="MIX_RGB_MIX";break;case"ADD":s="MIX_RGB_ADD";break;case"MULTIPLY":s="MIX_RGB_MULTIPLY";break;case"SUBTRACT":s="MIX_RGB_SUBTRACT";break;case"SCREEN":s="MIX_RGB_SCREEN";break;case"DIVIDE":s="MIX_RGB_DIVIDE";break;case"DIFFERENCE":s="MIX_RGB_DIFFERENCE";break;case"DARKEN":s="MIX_RGB_DARKEN";break;case"LIGHTEN":s="MIX_RGB_LIGHTEN";break;case"OVERLAY":s="MIX_RGB_OVERLAY";break;case"DODGE":s="MIX_RGB_DODGE";break;case"BURN":s="MIX_RGB_BURN";break;case"HUE":s="MIX_RGB_HUE";break;case"SATURATION":s="MIX_RGB_SATURATION";break;case"VALUE":s="MIX_RGB_VALUE";break;case"COLOR":s="MIX_RGB_COLOR";break;case"SOFT_LIGHT":s="MIX_RGB_SOFT_LIGHT";break;case"LINEAR_LIGHT":s="MIX_RGB_LINEAR_LIGHT";break;default:return Ze.error("Unsupported MIX_RGB blend type: "+t.blend_type),null}v.push(["MIX_RGB_USE_CLAMP",Number(t.use_clamp)]),T=me(t),f=Oe(t);break;case"MIX_WORLD_RGB":case"ADD_WORLD_RGB":T=[Se("Factor","Factor",t.fac,t.fac_is_linked),Se("Color1","Color1",[0,0,0],t.color1_is_linked),Se("Color2","Color1",[0,0,0],t.color2_is_linked)],f=[Se("Color","Color",[0,0,0],!0)];break;case"OUTPUT":T=me(t),f=[];break;case"OUTPUT_MATERIAL":T=me(t),f=[];var Qe=fe(t,"Surface"),qe=Qe.is_linked,Ve=[],We=[],tt=[Qe,Se("d_color","d_color",[0,0,0],qe),Se("d_roughness","d_roughness",0,qe),Se("s_color","s_color",[0,0,0],qe),Se("s_roughness","s_roughness",0,qe),Se("metalness","metalness",0,qe),Se("normal","normal",[0,0,0],qe),Se("ior","ior",0,qe),Se("transmission","transmission",0,qe),Se("e_color","e_color",[0,0,0],qe),Se("emission","emission",0,qe),Se("a_color","a_color",[0,0,0],qe),Se("alpha","alpha",0,qe)],rt=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("bsdf_params","bsdf_params",[0,0,0,0],!0),Se("refract_params","refract_params",[0,0,0,0],!0),Se("shadow_factor","shadow_factor",0,!0),Se("d_color","d_color",[0,0,0],!0),Se("s_color","s_color",[0,0,0],!0),Se("e_color","e_color",[0,0,0],!0),Se("emission","emission",0,!0),Se("a_color","a_color",[0,0,0],!0),Se("alpha","alpha",0,!0)],at=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("bsdf_params","bsdf_params",[0,0,0,0],!0),Se("refract_params","refract_params",[0,0,0,0],!0),Se("d_color","d_color",[0,0,0],!0),Se("s_color","s_color",[0,0,0],!0),Se("e_color","e_color",[0,0,0],!0),Se("emission","emission",0,!0),Se("a_color","a_color",[0,0,0],!0),Se("alpha","alpha",0,!0)],it=[Se("color","color",[0,0,0],qe),Se("alpha","alpha",1,qe)],st=[],ct=[],Et={name:"bsdf_begin",type:"BSDF_BEGIN",inputs:tt,outputs:rt,params:st,data:null,dirs:Ve,vparams:[]},bt={name:"bsdf_end",type:"BSDF_END",inputs:at,outputs:it,params:ct,data:null,dirs:We,vparams:[]},Yt=[Qe,Se("alpha","alpha",1,qe)],Lt=[],Mt=[],yt=[],xt={name:"output_surface",type:"OUTPUT_SURFACE",inputs:Yt,outputs:Lt,params:Mt,data:{value:{bsdf_shader:"BSDF_COMPUTE"},bsdf_begin:Et,bsdf_end:bt},dirs:yt,vparams:[]},Ut=[Se("Height","Height",0,!0)],wt=[Se("Normal","Normal",[0,0,0],!1)],Ct=[],Dt=[],Ft={name:"displacement_bump",type:"DISPLACEMENT_BUMP",inputs:Ut,outputs:wt,params:Ct,data:null,dirs:Dt,vparams:[]};A={name:t.name,output_surface:xt,displacement_bump:Ft};break;case"OUTPUT_WORLD":T=me(t),f=Oe(t);var Qe=fe(t,"Surface"),Gt=[Qe],kt=[],Kt=[],Bt=[],xt={name:"output_world_surface",type:"OUTPUT_WORLD_SURFACE",inputs:Gt,outputs:kt,params:Kt,data:null,dirs:Bt,vparams:[]};A={name:t.name,output_world_surface:xt};break;case"RGB":var Xt=t.name,jt={name:"-1",value:Xt};P.push(jt),f.push(Pe(t,"Color"));break;case"SEPRGB":case"SEPHSV":T=me(t),f=Oe(t);break;case"TEX_ENVIRONMENT":var Ht=t.image;if(Ht){s="TEXTURE_ENVIRONMENT_"+t.projection,"NONE"==t.color_space?v.push(["NON_COLOR",1]):v.push(["NON_COLOR",0]),T.push(fe(t,"Vector")),v.push(["USE_VECTOR_IN",0|T[0].is_linked]),f.push(Pe(t,"Color"));var X=ce("param_TEXTURE_texture");P.push(Ne(X));var Qt=et.create_texture(et.TT_RGBA_INT,!1);Qt.repeat=!0,Qt.source="IMAGE",ot.anisotropic_available&&(Qt.anisotropic_filtering=16),et.append_img_info(Qt,Ht),A={bpy_name:t.name,bpy_uuid:"",name:X,value:Qt}}else s="TEXTURE_EMPTY";break;case"TEX_IMAGE":var Ht=t.image;if(Ht){s="TEXTURE_COLOR","NONE"==t.color_space?v.push(["NON_COLOR",1]):v.push(["NON_COLOR",0]),v.push(["CONVERT_UV",0]);for(var zt=0;zt<4;++zt){var pe,qt,Vt;zt?(pe=Se("Vector"+zt,"Vector"+zt,[0,0,0],!1),qt=Se("Color"+zt,"Color"+zt,[0,0,0],!1),Vt=Se("Alpha"+zt,"Alpha"+zt,0,!1)):(pe=fe(t,"Vector"),qt=Pe(t,"Color"),Vt=Pe(t,"Alpha")),T.push(pe),f.push(qt),f.push(Vt)}var X=ce("param_TEXTURE_texture");P.push(Ne(X));var Qt=et.create_texture(et.TT_RGBA_INT,!1);Qt.repeat="REPEAT"==t.extension,Qt.source="IMAGE",et.append_img_info(Qt,Ht),A={bpy_name:t.name,bpy_uuid:"",name:X,value:Qt}}else s="TEXTURE_EMPTY";break;case"TEXTURE":if("TEXTURE_EMPTY"==(s=de(t)))f.push(Pe(t,"Color")),f.push(Pe(t,"Normal")),f.push(Pe(t,"Value"));else if("TEXTURE_ENVIRONMENT_CUBE"==s)T.push(fe(t,"Vector")),f.push(Pe(t,"Color")),f.push(Pe(t,"Value"));else{if("TEXTURE_NORMAL"==s&&"ENVIRONMENT_MAP"==t.texture.type)return Ze.error("Wrong output for ENVIRONMENT_MAP texture: "+t.name),null;if("TEXTURE_COLOR"==s){var Wt=!1,Jt=t.texture.image;!Jt||"Non-Color"!=Jt.colorspace_settings_name&&"Non-Colour Data"!=Jt.colorspace_settings_name||(Wt=!0),v.push(["NON_COLOR",Number(Wt)]),v.push(["CONVERT_UV",1])}for(var zt=0;zt<4;++zt){var pe,qt,Vt,Zt="TEXTURE_COLOR"==s?"Color":"Normal";zt?(pe=Se("Vector"+zt,"Vector"+zt,[0,0,0],!1),qt=Se(Zt+zt,Zt+zt,[0,0,0],!1),Vt=Se("Value"+zt,"Value"+zt,0,!1)):(pe=fe(t,"Vector"),qt=Pe(t,Zt),Vt=Pe(t,"Value")),T.push(pe),f.push(qt),f.push(Vt)}}if("TEXTURE_EMPTY"!=s){var X=ce("param_TEXTURE_texture");P.push(Ne(X));var Qt=t.texture._render;A={bpy_name:t.texture.name,bpy_uuid:t.texture.uuid,name:X,value:Qt}}break;case"VALTORGB":T=me(t),f=Oe(t),A={value:t};var $t=t.color_ramp.interpolation;"CONSTANT"!=$t&&"LINEAR"!=$t&&Ze.warn("Color Ramp node is not fully supported.");break;case"VALUE":s="VALUE";var Xt=t.name,jt={name:"-1",value:Xt};P.push(jt),f.push(Pe(t,"Value"));break;case"VECT_MATH":switch(t.operation){case"ADD":s="VECT_MATH_ADD";break;case"SUBTRACT":s="VECT_MATH_SUBTRACT";break;case"AVERAGE":s="VECT_MATH_AVERAGE";break;case"DOT_PRODUCT":s="VECT_MATH_DOT_PRODUCT";break;case"CROSS_PRODUCT":s="VECT_MATH_CROSS_PRODUCT";break;case"NORMALIZE":s="VECT_MATH_NORMALIZE";break;default:return Ze.error("Unsupported VECT_MATH operation: "+t.operation),null}T=me(t),f=Oe(t);break;case"VECT_TRANSFORM":switch(t.vector_type){case"POINT":v.push(["VECTOR_TYPE",$e.glsl_value(lt)]);break;case"VECTOR":v.push(["VECTOR_TYPE",$e.glsl_value(Tt)]);break;case"NORMAL":v.push(["VECTOR_TYPE",$e.glsl_value(ut)]);break;default:return Ze.error("Unsupported VECT_TRANSFORM vector_type: "+t.vector_type),null}var er=t.convert_from,tr=t.convert_to,rr=dt;if("WORLD"==er)if("WORLD"==tr)rr=dt;else if("OBJECT"==tr)rr=ft;else{if("CAMERA"!=tr)return Ze.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;rr=Pt}else if("OBJECT"==er)if("WORLD"==tr)rr=At;else if("OBJECT"==tr)rr=St;else{if("CAMERA"!=tr)return Ze.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;rr=pt}else{if("CAMERA"!=er)return Ze.error("Unsupported VECT_TRANSFORM convert_from: "+t.convert_from),null;if("WORLD"==tr)rr=vt;else if("OBJECT"==tr)rr=mt;else{if("CAMERA"!=tr)return Ze.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;rr=Ot}}v.push(["CONVERT_TYPE",$e.glsl_value(rr)]),T=me(t),f=Oe(t);break;case"NORMAL_MAP":var ar=Nt;switch(t.space){case"TANGENT":ar=Nt;break;case"OBJECT":ar=gt;break;case"WORLD":ar=ht;break;case"BLENDER_OBJECT":ar=Rt;break;case"BLENDER_WORLD":ar=It;break;default:return Ze.error("Unsupported NORMAL_MAP space: "+t.space),null}v.push(["SPACE",$e.glsl_value(ar)]),T.push(fe(t,"Strength")),T.push(fe(t,"Color")),T.push(Se("Normal","Normal",[0,0,0],!1)),v.push(["USE_NORMAL_IN",0]),f.push(Pe(t,"Normal"));break;case"FRESNEL":var ve=fe(t,"Normal");T.push(fe(t,"IOR")),T.push(ve),f.push(Pe(t,"Fac")),v.push(["USE_FRESNEL_NORMAL",0|ve.is_linked]);break;case"LAYER_WEIGHT":var ve=fe(t,"Normal");T.push(fe(t,"Blend")),T.push(ve),f=Oe(t),v.push(["USE_NORMAL_IN",0|ve.is_linked]);break;case"BUMP":var ve=fe(t,"Normal");v.push(["INVERT",t.invert?1:0]),v.push(["USE_NORMAL_IN",0|ve.is_linked]),T=me(t),f=Oe(t);break;case"BACKGROUND":default:T=me(t),f=Oe(t)}var _r={name:o,origin_name:i,type:s,vparams:l,inputs:T,outputs:f,params:P,data:A,dirs:v},nr=Je.gen_node_id(e);return Je.append_node(e,nr,_r),"GEOMETRY"!=t.type&&"TEX_COORD"!=t.type&&"NEW_GEOMETRY"!=t.type||!ue(t,r)||null!=ae(e,t,++r,a,_,n)?nr:null}function _e(e,t,r){for(var a=e.inputs,_=e.outputs,n=e.node_tree_name,o=0;o<t.length;o++){var i=a[o],s=t[o];if(!i||i.default_value instanceof Array!=s)return Ze.warn('Wrong inputs for custom node group "'+e.name+'" of type: "',n,'".Processing as general node group.'),!1}for(var o=0;o<r.length;o++){var c=_[o],E=r[o];if(!c||c.default_value instanceof Array!=E)return Ze.warn('Wrong outputs for custom node group "'+e.name+'" of type: "',n,'".Processing as general node group.'),!1}return!0}function ne(e,t,r,_){var n=se(e.node_group.node_tree),o=e.node_tree_name;if("B4W_REPLACE"==o||"B4W_LEVELS_OF_QUALITY"==o){var i=$("Group input","GROUP_INPUT",[],e.inputs),s=$("Group output","GROUP_OUTPUT",e.outputs,[]),c=null;c="B4W_REPLACE"==o||"B4W_LEVELS_OF_QUALITY"==o&&(ot.quality==Ve.P_LOW||ot.force_low_quality_nodes)?ee(i,i.outputs[1],s,s.inputs[0]):ee(i,i.outputs[0],s,s.inputs[0]),n.nodes=[i,s],n.links=[c]}return Me(e.name,n),{node_group_graph:a(n,e.node_group.uuid,!0,t,r,_).graph,node_group_links:n.links}}function oe(){tt={}}function ie(e){var t=typeof e;return"string"!=t&&"number"!=t&&"boolean"!=t&&e?u.N(e):e}function se(e){var t={};for(var r in e)if("links"==r||"nodes"==r){t[r]=[];for(var a=0;a<e[r].length;a++){t[r][a]={};for(var _ in e[r][a])if("links"==r){t[r][a][_]={};for(var n in e[r][a][_])t[r][a][_][n]=ie(e[r][a][_][n])}else t[r][a][_]=ie(e[r][a][_])}}else t[r]=ie(e[r]);return t}function ce(e){tt[e]||(tt[e]=0);var t=e+"_"+tt[e];return t=t.replace(/ /g,"_").replace(/\//g,"_"),tt[e]++,t}function Ee(e){for(var t=e.outputs,r=0;r<t.length;r++){if(t[r].is_linked)return!0}return!1}function le(e,t){for(var r=e.outputs,a=0,_=0;_<r.length;_++){var n=r[_];if(n.is_linked&&!(a++<t))switch(n.identifier){case"UV":return"GEOMETRY_UV";case"Vertex Color":return"GEOMETRY_VC";case"Normal":return"GEOMETRY_NO";case"True Normal":return"GEOMETRY_TRN";case"Front/Back":return"GEOMETRY_FB";case"View":return"GEOMETRY_VW";case"Global":case"Position":return"GEOMETRY_GL";case"Local":return"GEOMETRY_LO";case"Orco":return"GEOMETRY_OR";case"Incoming":return"GEOMETRY_IN";case"Backfacing":return"GEOMETRY_BF";default:return null}}}function Te(e,t){for(var r=e.outputs,a=0,_=0;_<r.length;_++){var n=r[_];if(n.is_linked&&!(a++<t))switch(n.identifier){case"Camera":return"TEX_COORD_CA";case"Generated":return"TEX_COORD_GE";case"Normal":return"TEX_COORD_NO";case"Object":return"TEX_COORD_OB";case"Reflection":return"TEX_COORD_RE";case"UV":return"TEX_COORD_UV";case"Window":return"TEX_COORD_WI";default:return null}}}function ue(e,t){for(var r=e.outputs,a=0,_=0;_<r.length;_++){if(r[_].is_linked&&a++>t)return!0}return!1}function de(e){if(!e.texture||!e.texture._render)return"TEXTURE_EMPTY";for(var t=e.outputs,r=!1,a=!1,_=!1,n=0;n<t.length;n++){var o=t[n];if(o.is_linked){switch(o.identifier){case"Color":r=!0;break;case"Normal":a=!0;break;case"Value":_=!0;break;default:qe.panic("Unknown texture output")}}}return r?(a&&Ze.warn('Node "'+e.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR"):a?"TEXTURE_NORMAL":_?"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR":void 0}function fe(e,t){for(var r=e.inputs,a=0;a<r.length;a++){var _=r[a];if(_.identifier==t)return Ae(_)}return null}function Pe(e,t){for(var r=e.outputs,a=0;a<r.length;a++){var _=r[a];if(_.identifier==t)return Ae(_)}return null}function Ae(e){return{name:e.name,identifier:e.identifier,is_linked:e.is_linked,default_value:ve(e.default_value)}}function Se(e,t,r,a){return{name:e,identifier:t,is_linked:a,default_value:r}}function pe(e){return Se(e.name,e.identifier,e.default_value,e.is_linked)}function ve(e){return u._16(e)?e.slice(0):e}function me(e){for(var t=[],r=0;r<e.inputs.length;r++){var a=Ae(e.inputs[r]);a.default_value.length&&a.default_value.splice(3),t.push(a)}return t}function Oe(e){for(var t=[],r=0;r<e.outputs.length;r++){var a=Ae(e.outputs[r]);t.push(a)}return t}function Ne(e,t,r){if(null===t||void 0===t)var a=null;else var a=$e.glsl_value(t,r);return{name:e,value:a}}function ge(e){return{name:e.name,value:e.value}}function he(e){return e=e.replace(/(,)/g,"$1 "),e=e.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),e=e.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),e=e.replace(/\s+/g,"")}function Re(e){return e.slice()}function Ie(e,t,r,a,_,n){for(var o=[],i=n.from_socket.identifier,s=n.to_socket.identifier,c=a.outputs,E=0;E<c.length;E++){if(c[E].identifier==i){o.push(E);break}}for(var l=_.inputs,E=0;E<l.length;E++){if(l[E].identifier==s){o.push(E);break}}return 2==o.length&&Je.append_edge(e,t,r,o),!0}function be(e){for(var t=[],r=[],a=[],_=[],n=[],o=[],i=0;i<e.inputs.length;i++){var s=e.inputs[i];if(s.is_linked)t.push(null),r.push(null);else{t.push(ce("in_"+e.type+"_"+Ye(s.identifier)));var c=$e.glsl_value(s.default_value,0);ot.shader_constants_hack&&(e.type.indexOf("MIX_RGB_")>=0&&("Color1"==s.identifier||"Color2"==s.identifier||"Fac"==s.identifier)||e.type.indexOf("MATH_")>=0&&("Value"==s.identifier||"Value_001"==s.identifier||"Value.001"==s.identifier)||e.type.indexOf("VECT_MATH_")>=0&&("Vector_001"==s.identifier||"Vector.001"==s.identifier)||e.type.indexOf("LIGHTING_APPLY")>=0||e.type.indexOf("MATERIAL_END")>=0||e.type.indexOf("MATERIAL_BEGIN")>=0)&&(c=he(c)),r.push(c)}}for(var i=0;i<e.outputs.length;i++){var E=e.outputs[i];E.is_linked?a.push(null):a.push(ce("out_"+e.type+"_"+Ye(E.identifier)))}for(var i=0;i<e.params.length;i++){var l=e.params[i];_.push(l.name),n.push(l.value)}for(var i=0;i<e.vparams.length;i++){var T=e.vparams[i];o.push(T.name)}return{id:e.type,inputs:t,input_values:r,outputs:a,params:_,param_values:n,vparams:o,dirs:JSON.parse(JSON.stringify(e.dirs))}}function Ye(e){return e.replace(/\./g,"")}function Le(e,t,r){return"GROUP_INPUT"==e?t+"*GI*"+r:"GROUP_OUTPUT"==e?t+"*GO*"+r:t+"%join%"+r}function Me(e,t){for(var r=t.nodes,a=t.links,_=0;_<r.length;_++)r[_].name=Le(r[_].type,e,r[_].name);for(var _=0;_<a.length;_++)a[_].from_node.name=Le(a[_].from_node.type,e,a[_].from_node.name),a[_].to_node.name=Le(a[_].to_node.type,e,a[_].to_node.name)}function ye(e){var t=[];return Je.traverse(e,function(e,r){"GROUP"==r.type&&t.push(r)}),t}function xe(e,t,r){for(var a=0;a<r.length;a++){var _=r[a].data.node_group_graph,n=r[a].data.node_group_links;if(!_)return!1;Je.traverse(_,function(t,r){Je.append_node(e,Je.gen_node_id(e),r)});for(var o=0;o<n.length;o++)t.push(n[o]);Be(r[a],t,e)}return!0}function Ue(e,t,r,a,_,n){switch(e.type){case"GROUP":e.name==t&&a.push(r);break;case"GROUP_INPUT":e.name.indexOf(t+"*GI*")||_.push(r);break;case"GROUP_OUTPUT":e.name.indexOf(t+"*GO*")||n.push(r)}}function we(e,t,r){for(var a=[],_=0;_<r.length;_++){for(var n=r[_],o=null,i=0;i<t.length;i++)if(n.from_socket.identifier==t[i].to_socket.identifier){o=t[i];break}o?(n.from_node=o.from_node,n.from_socket=o.from_socket):a.push(n)}for(var _=0;_<t.length;_++)e.splice(e.indexOf(t[_]),1);return a}function Ce(e,t){if(t.length)for(var r=t[0].from_node.name,a=0;a<e.length;a++)e[a].from_node.name==r&&t.push(e[a])}function De(e,t,r){for(var a=w(e.to_node,t),_=0;_<a.length;_++)for(var n=Je.get_node_attr(t,a[_]),o=0;o<n.inputs.length;o++){var i=n.inputs[o];if(i.identifier==e.to_socket.identifier){var s=Ge(i.default_value),c=Ge(r);if(c==s)i.default_value=r;else switch(s){case st:ke(r,i.default_value);break;case ct:i.default_value=Ke(r)}break}}}function Fe(e,t,r,a){for(var _=0;_<a.length;_++){for(var n,o=a[_],i=0;i<r.inputs.length;i++)if(o.from_socket.identifier==r.inputs[i].identifier){n=r.inputs[i].default_value;break}De(o,t,n);var s=e.indexOf(o);-1!=s&&e.splice(s,1)}}function Ge(e){return e instanceof Object?st:ct}function ke(e,t){return t[0]=t[1]=t[2]=e,t}function Ke(e){return(e[0]+e[1]+e[2])/3}function Be(e,t,r){for(var a=e.name,_=[],n=[],o=[],i=[],s=0;s<t.length;s++){var c=t[s];Ue(c.from_node,a,c,_,o,i),Ue(c.to_node,a,c,n,o,i)}var E=we(t,n,o),l=we(t,i,_);if(Ce(t,E),Fe(t,r,e,E),l.length){var T;Je.traverse(r,function(e,t){"GROUP_OUTPUT"!=t.type||t.name.indexOf(a+"*GO*")||(T=t)}),Fe(t,r,T,l)}}function Xe(e,t,r){Ze.log("\n====== USER: "+t+", MATERIAL: "+r+" ======\n"+We.nodegraph_to_dot(e,!0)+"\n=============================================================")}function je(){for(var e in rt)delete rt[e];for(var e in at)delete at[e];for(var t in _t)delete _t[t];nt=0}function He(e){var t=[],r=[];Je.traverse(e,function(e,a){switch(a.type){case"VALTORGB":t.push(a);break;case"CURVE_VEC":case"CURVE_RGB":r.push(a)}});var a=0,_=null,n=null,o=t.length+r.length;if(t.length){_=et.extract_col_ramps_data(t,et.COLORRAMP_TEXT_SIZE);for(var i=0;i<t.length;i++)t[i].dirs.push(["NODE_TEX_ROW",$e.glsl_value((a+.5)/o)]),a++}if(r.length){n=et.extract_vec_curves_data(r,et.CURVE_NODES_TEXT_SIZE);for(var i=0;i<r.length;i++)r[i].dirs.push(["NODE_TEX_ROW",$e.glsl_value((a+.5)/o)]),a++}var s=null;if(_&&n?(s=new Uint8Array(_.length+n.length),s.set(_),s.set(n,_.length)):s=_||n,s)var c=et.create_color_ramp_texture(s,et.CURVE_NODES_TEXT_SIZE);else var c=null;for(var i=0;i<t.length;i++)t[i].data.texture=c;for(var i=0;i<r.length;i++)r[i].data.texture=c}function Qe(e){var t=-1;return Je.traverse(e,function(e,r){if("TEXTURE_ENVIRONMENT_EQUIRECTANGULAR"==r.type||"TEXTURE_ENVIRONMENT_MIRROR_BALL"==r.type){var a=r.data.value.height;t=Math.max(t,a)}}),t}function ze(e,t,r,a){var _=e.curve_mapping.curves_data[t];return!(2==_.length&&_[0][0]<r+Et&&_[0][1]<r+Et&&_[1][0]>a-Et&&_[1][1]>a-Et)}var qe=Object(n.a)(e),Ve=Object(o.a)(e),We=Object(i.a)(e),Je=Object(s.a)(e),Ze=Object(l.a)(e),$e=Object(T.a)(e),et=Object(f.a)(e),tt={},rt={},at={},_t={},nt=0,ot=Ve.defaults,it=!1,st=0,ct=1,Et=.01,lt=0,Tt=1,ut=2,dt=0,ft=1,Pt=2,At=3,St=4,pt=5,vt=6,mt=7,Ot=8;t.VT_WORLD_TO_WORLD=dt,t.VT_WORLD_TO_OBJECT=ft,t.VT_WORLD_TO_CAMERA=Pt,t.VT_OBJECT_TO_WORLD=At,t.VT_OBJECT_TO_OBJECT=St,t.VT_OBJECT_TO_CAMERA=pt,t.VT_CAMERA_TO_WORLD=vt,t.VT_CAMERA_TO_OBJECT=mt,t.VT_CAMERA_TO_CAMERA=Ot;var Nt=0,gt=1,ht=2,Rt=3,It=4;t.NM_TANGENT=Nt,t.NM_OBJECT=gt,t.NM_WORLD=ht,t.NM_BLENDER_OBJECT=Rt,t.NM_BLENDER_WORLD=It;var bt=0,Yt=2;t.get_ngraph_proxy_cached=function(e){return rt[e]},t.cleanup_ngraph_proxy=function(e){delete rt[e]},t.compose_ngraph_proxy=r,t.create_lighting_graph=function(e,t,r){if(e in at)return at[e];var a=Je.create(),_={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},n=ae(a,_,0,null,null,r);return _={name:"LIGHTING_END",type:"LIGHTING_END"},P(a,t,n,ae(a,_,0,null,null,r),[[n,[8,10]],[n,[9,6]]],r),M(a),at[e]=a,a},t.generate_graph_id=function(e,t,r,a){switch(e+=r,t){case"GLOW":e+="11";case"COLOR_ID":case"SHADOW":e+="00";default:e+="10"}return a&&a.vc_name&&(e+=a.vc_name),a&&a.uv_name&&(e+=a.uv_name),e},t.compose_node_elements=function(e){var t=[],r={};oe();var a=Je.topsort(e);return Je.traverse(a,function(e,a){var _=be(a);t.push(_),r[e]=_}),Je.traverse_edges(a,function(e,t,_){var n=Je.get_node_attr(a,e),o=n.outputs[_[0]],i=r[e].outputs,s=r[t].inputs,c=i[_[0]]||ce("out_"+n.type+"_"+Ye(o.identifier));i[_[0]]=c,s[_[1]]=c}),t},t.check_material_glow_output=function(e){if(e.node_tree)for(var t=0;t<e.node_tree.nodes.length;t++){var r=e.node_tree.nodes[t];if("GROUP"==r.type&&"B4W_GLOW_OUTPUT"==r.node_tree_name)return!0}return!1},t.print_node_graph=Xe,t.cleanup=je,t.get_max_env_texture_height=Qe}var _=r(0),n=r(5),o=r(4),i=r(113),s=r(30),c=r(28),E=r(21),l=r(1),T=r(37),u=r(2),d=r(3),f=r(17),P=Object(_.a)("__nodemat",a);t.a=P},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=[],_={},i=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];t.fbmsg=function(){for(var e=[performance.now()],t=0;t<arguments.length;t++){var r=arguments[t];if(o._16(r))for(var _=0;_<r.length;_++)e.push(r[_]);else e.push(arguments[t])}a.push(e)},t.msg=function(){for(var e=1,t=0;t<a.length;t++){var r=a[t];r[1]==arguments[0]&&e++}for(var r=[e],t=0;t<arguments.length;t++){var _=arguments[t];if(o._16(_))for(var n=0;n<_.length;n++)r.push(_[n]);else r.push(arguments[t])}a.push(r)},t.print_telemetry=function(e){e||(e=1);for(var t=0,_={},n=Math.max(0,performance.now()-1e3*e),o=0;o<a.length;o++){var s=a[o];if(!((e=s[0])<n)){var c=String(s[1]);_[c]||(_[c]=i[t++%i.length]);for(var E=_[c],l=["%c"+(e/1e3).toFixed(6),E,c],T=2;T<s.length;T++)l.push(s[T]);r.log.apply(this,l)}}a.splice(0)},t.plot_telemetry=function(e){e||(e=1);for(var t={},_=Math.max(0,performance.now()-1e3*e),n=0;n<a.length;n++){var o=a[n];if(!((e=o[0])<_))for(var i=2;i<o.length;i++){var s=String(o[1]);o.length>3&&(s+="_"+String(i-2)),t[s]||(t[s]=s+"\n"),t[s]+=String(e)+" "+o[i]+"\n"}}var c="";for(var s in t)c+=t[s]+"\n\n";r.log(c),a.splice(0)},t.exec_count=function(e){e in _?_[e]+=1:_[e]=1},t.update=function(){for(var e in _)r.log(e,_[e]),_[e]=0}}var _=r(0),n=r(1),o=r(2),i=Object(_.a)("__debug_telemetry",a);t.a=i},function(e,t,r){"use strict";function a(e,t){function r(e,t,r,a){for(var _=[],n=[],o=[],i=e*t,c=2*r/(e-1),E=2*a/(t-1),l=0;l<e;l++)for(var T=l*c-r,d=0;d<t;d++){var f=d*E-a;if(n.push(T,f,0),o.push(l/(e-1),d/(t-1)),l&&d){var P=l*t+d,A=P-1,S=(l-1)*t+d,p=S-1;_.push(P,A,S),_.push(A,p,S)}}var v=u.create_empty_va_frame();v.a_position=new Float32Array(n),v.a_tbn=s.c(i);var m=u.init_submesh("GRID_PLANE");return m.va_frames[0]=v,m.va_common.a_texcoord=new Float32Array(o),m.indices=new Uint32Array(_),m.base_length=n.length/3,m}function a(e){var t=e.length;t%4&&l.panic("Wrong array");for(var r=[],a=[],_=0;_<t;_+=4){var n=e[_],o=e[_+1],i=e[_+2],c=e[_+3];E(n,a),E(o,a),E(i,a),E(c,a),r.push(_,_+1,_+2),r.push(_,_+2,_+3)}var T=u.create_empty_va_frame();T.a_position=new Float32Array(a),T.a_tbn=s.c(t/4);var d=u.init_submesh("FROM_QUADS");return d.va_frames[0]=T,d.indices=new Uint32Array(r),d.base_length=a.length/3,d}function _(e,t){var r=3*t;return[e[r],e[r+1],e[r+2]]}function E(e,t){t.push(e[0],e[1],e[2])}var l=Object(n.a)(e),T=Object(o.a)(e),u=Object(i.a)(e),d=T.defaults;t.generate_line=function(){var e=u.init_submesh("LINE"),t=u.create_empty_va_frame();return t.a_position=new Float32Array(3),t.a_direction=new Float32Array(3),e.va_frames[0]=t,e.indices=new Uint32Array(1),e.base_length=1,e},t.generate_plane=function(e,t){var a=r(2,2,e,t);return a.name="PLANE",a},t.generate_grid=r,t.generate_cascaded_grid=function(e,t,r){function a(e,t){return e%2==1&&(0==t||t==c-1)||t%2==1&&(0==e||e==i-1)}for(var _=r/Math.pow(2,e-1),n=_,o=_,i=t+1,c=t+1,E=[],l=[],T=0,f=0,P=0,A=-1,S=[],p=0;p<e;p++){for(var v=2*n/(i-1),m=2*o/(c-1),O=[],N=[],g=0,h=0;h<i;h++){for(var R=h*v-n,I=[],b=0;b<c;b++){var Y=b*m-o;if(R>-f&&R<f&&Y>-P&&Y<P)I.push(-1),g++;else{for(var L=null,M=0;M<S.length;M+=3)if(R==S[M]&&Y==S[M+1]){L=S[M+2];break}if(null!==L)var y=L;else var y=A+1;if(a(h,b))I.push(-2),g++;else{if(null==L){if(0==b||b==c-1||0==h||h==i-1){if(p==e-1)var x=v;else var x=2*v;O.push(R,Y,y)}else var x=v;l.push(R,Y,x),T++,A++}I.push(y)}if(h&&b)if(1==h){if(a(h-1,b))if(b>1){var U=y-1,w=N[h-1][b+1],C=w-1;E.push(C,U,y),E.push(w,C,y)}else{var w=N[h-1][b+1],C=w-1;E.push(w,C,y)}else if(!a(h,b)){var U=y-1,w=N[h-1][b];E.push(w,U,y)}}else if(h==i-1){if(!a(h,b))if(b==c-1){var U=y-1,w=N[h-1][b-1],C=N[h-2][b];E.push(w,U,y),E.push(C,w,y)}else{var U=y-1,w=N[h-1][b],C=w-1,D=w+1;E.push(C,U,y),E.push(w,C,y),E.push(D,w,y),2==b&&(D=N[h-2][b-2],E.push(C,D,U))}}else if(1==b)if(a(h,b-1)){var U=N[h-1][b],w=N[h-1][b-1];E.push(U,w,y)}else{var U=I[b-1],w=N[h-1][b],C=N[h-2][b-1];E.push(w,U,y),E.push(w,C,U)}else if(b==c-1){if(!a(h,b)){var U=I[b-1],w=N[h-1][b-1],C=N[h-2][b];E.push(w,U,y),E.push(C,w,y)}}else if(-1!=N[h-1][b]&&-1!=N[h-1][b-1]&&-1!=I[b-1]){var U=I[b-1],w=N[h-1][b],C=N[h-1][b-1];if(E.push(w,U,y),E.push(w,C,U),b==c-2&&a(h,b+1)){var D=N[h-1][b+1];E.push(D,w,y)}}else if(b==c-2&&a(h,b+1)){var w=N[h-1][b],D=N[h-1][b+1];E.push(D,w,y)}}}N.push(I)}S=O,f=n,P=o,n*=2,o*=2}if(f<2e4){var F=-2*f/(i-1);l.push(-2e4,-2e4,F),l.push(-2e4,2e4,F),l.push(-f,-P,F),l.push(-f,P,F),l.push(2e4,-2e4,F),l.push(2e4,2e4,F),l.push(f,-P,F),l.push(f,P,F);var y=A+1;E.push(y+1,y+2,y+3,y+1,y+0,y+2,y+2,y+4,y+6,y+2,y+0,y+4,y+1,y+7,y+5,y+1,y+3,y+7,y+7,y+4,y+5,y+6,y+4,y+7),T+=8}var G=u.create_empty_va_frame();G.a_position=new Float32Array(l),G.a_tbn=s.c(T),s.j(G.a_tbn,[.707,0,0,.707],G.a_tbn);var k=u.init_submesh("MULTIGRID_PLANE");return k.va_frames[0]=G,k.indices=new Uint32Array(E),k.base_length=l.length/3,d.water_wireframe_debug&&(u.submesh_drop_indices(k,1,!0),G.a_polyindex=u.extract_polyindices(k)),k},t.generate_from_triangles=function(e){var t=e.length;t%3&&l.panic("Wrong array");for(var r=[],a=[],_=0;_<t;_+=3){var n=e[_],o=e[_+1],i=e[_+2];E(n,a),E(o,a),E(i,a),r.push(_,_+1,_+2)}var s=u.create_empty_va_frame();s.a_position=new Float32Array(a);var c=u.init_submesh("FROM_TRIANGLES");return c.va_frames[0]=s,c.indices=new Uint32Array(r),c.base_length=a.length/3,c},t.generate_from_quads=a,t.generate_frustum=function(e){e=c._69(e,[]);var t=[];t.push(e[0],e[1],e[2],e[3]),t.push(e[0],e[3],e[5],e[4]),t.push(e[3],e[2],e[6],e[5]),t.push(e[1],e[7],e[6],e[2]),t.push(e[0],e[4],e[7],e[1]),t.push(e[4],e[5],e[6],e[7]);var r=a(t);return r.name="FRUSTUM",r},t.generate_fullscreen_tri=function(){var e=u.init_submesh("FULLSCREEN_TRI"),t=u.create_empty_va_frame();return t.a_position=new Float32Array([0,0,1,0,0,1]),e.va_frames[0]=t,e.indices=new Uint32Array([0,1,2]),e.base_length=3,e},t.generate_fullscreen_quad=function(){var e=u.init_submesh("FULLSCREEN_QUAD"),t=u.create_empty_va_frame();return t.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]),e.va_frames[0]=t,e.indices=new Uint32Array([0,2,1,1,2,3]),e.base_length=4,e},t.generate_billboard=function(){var e=u.init_submesh("BILLBOARD"),t=u.create_empty_va_frame();return t.a_bb_vertex=u.gen_bb_vertices(1),e.va_frames[0]=t,e.indices=new Uint32Array([0,2,1,0,3,2]),e.base_length=4,e},t.generate_uv_sphere=function(e,t,r,a,n,o){var i,c,l=u.init_submesh("UV_SPHERE"),T=[],d=[],f=[];for(c=0;c<=t;c++)for(i=0;i<=e;i++){var P=i/e,A=c/t,S=-r*Math.cos(2*P*Math.PI)*Math.sin(A*Math.PI),p=r*Math.cos(A*Math.PI),v=r*Math.sin(2*P*Math.PI)*Math.sin(A*Math.PI);if(n){S=Math.abs(S)<1e-5?0:S,p=Math.abs(p)<1e-5?0:p,v=Math.abs(v)<1e-5?0:v}d.push(S+a[0],p+a[1],v+a[2])}var m=0;for(c=0;c<t;c++)for(i=0;i<e;i++){var O=_(d,(e+1)*c+i+1),N=_(d,(e+1)*c+i),g=_(d,(e+1)*(c+1)+i),h=_(d,(e+1)*(c+1)+i+1);Math.abs(O[1])==r+a[1]?(E(O,T),E(g,T),E(h,T),o?f.push(m,m+1,m+1,m+2,m+2,m):f.push(m,m+1,m+2),m+=3):Math.abs(g[1])==r+a[1]?(E(O,T),E(N,T),E(g,T),o?f.push(m,m+1,m+1,m+2,m+2,m):f.push(m,m+1,m+2),m+=3):(E(O,T),E(N,T),E(g,T),E(h,T),o?(f.push(m,m+1),f.push(m+1,m+2),f.push(m+2,m+3),f.push(m+3,m)):(f.push(m,m+1,m+2),f.push(m,m+2,m+3)),m+=4)}var R={};if(R.a_position=T,o)R.a_tbn=s.c();else{var I=u.calc_shared_indices(f,d,T),b=u.calc_normals(f,T,I);R.a_tbn=s.d(b)}return l.va_frames[0]=R,l.indices=f,l.base_length=T.length/3,l},t.generate_index=function(e){var t=u.init_submesh("INDEX"),r=u.create_empty_va_frame();r.a_index=new Float32Array(3*e);for(var a=new Uint16Array(3*e),_=0;_<3*e;_++)r.a_index[_]=_,a[_]=_;return t.va_frames[0]=r,t.indices=a,t.base_length=3*e,t}}var _=r(0),n=r(5),o=r(4),i=r(20),s=r(39),c=r(2),E=Object(_.a)("__primitives",a);t.a=E},function(e,t,r){"use strict";function a(e,t){function r(){return D}function a(e){D=e}function _(e,a,_,n){var o=r(),i=h.create();for(var s in a){var E=c(a[s]);(n&&E.is_resource||!e&&E.primary_only)&&m(E),h.append_node_attr(i,E)}for(var s in a){var E=a[s];E.name=s;for(var l=0;l<E.inputs.length;l++)h.append_edge_attr(i,a[E.inputs[l]],E,null)}var T=function(e,t,r,a,_,n){t.is_primary&&(o.start_secondary_threads=!0),g(t)||(t.status=Y),t.loaded_cb(t.id,!0),_(t,r),R.log("%cTHREAD "+t.id+": LOADED CALLBACK",C)},u=c({name:"out",priority:t.FINISH_PRIORITY,cb_before:T,relative_size:5});if(_)var d=h.get_sink_nodes(i);else{var d,f,P=h.clone(i);do{d=h.get_sink_nodes(P),f=[];for(var l=0;l<d.length;l++){var A=d[l],S=h.get_node_attr(P,A);S.background_loading&&f.push(A)}for(var l=0;l<f.length;l++)h.remove_node(P,f[l]);f.length&&h.cleanup_loose_edges(P)}while(f.length)}h.append_node_attr(i,u);for(var l=0;l<d.length;l++){var A=d[l],S=h.get_node_attr(i,A);u.inputs.push(S.name),h.append_edge_attr(i,S,u,null)}return i}function c(e){return e.background_loading=e.background_loading||!1,e.priority||0===e.priority||(e.priority=e.SYNC_PRIORITY),e.inputs=e.inputs||[],e.is_finished=e.is_finished||!1,e.skip=e.skip||!1,e.relative_size=e.relative_size||0,e.is_resource=e.is_resource||!1,e.primary_only=e.primary_only||!1,e.status=y,e.loop_index=0,e.load_rate=0,e.cb_param=e.cb_param||null,e}function E(e,t,r){if(t.complete_load_cb(r,t),t.status=L,e.active_threads--,b.debug_loading){var a=Math.round(performance.now()-t.time_load_start);R.log("%cTHREAD "+t.id+": 100% LOADING END "+a+"ms",C)}O(t)}function l(e,r){var a=e.stages_queue.length;do{var _=e.stages_queue[0],n=h.get_node_attr(e.stage_graph,_),o=d(e,n,r);n.priority==t.ASYNC_PRIORITY&&(e.reset_time_cycle=!0);var i=e.stages_queue.shift();e.stages_queue.push(i),a--}while(!o&&0!=a)}function T(e,t){for(var r=[],a=[],_=0;_<t.length;_++){var n=t[_];h.get_node_attr(e.stage_graph,n).is_finished&&(h.traverse_outputs(e.stage_graph,n,function(a,_,n){var o=!0;h.traverse_inputs(e.stage_graph,a,function(e,t,r){if(!t.is_finished)return o=!1,1}),o&&-1==r.indexOf(a)&&-1==t.indexOf(a)&&r.push(a)}),a.push(_))}for(var _=a.length-1;_>=0;_--)t.splice(a[_],1);return r}function u(e){var t=[],r=e.stages_queue,a=!1;do{var _=T(e,r);t.push.apply(t,r),_.length>0&&(a=!0),r=_}while(_.length>0);var n=function(t,r){var a=h.get_node_attr(e.stage_graph,t),_=h.get_node_attr(e.stage_graph,r),n=_.priority-a.priority;return 0==n&&(n=a.background_loading-_.background_loading),n};return a&&t.sort(n),e.stages_queue=t,e.stages_queue.length}function d(e,t,r){if(t.skip)return t.is_finished=!0,b.debug_loading&&R.log("%cTHREAD "+e.id+": SKIP STAGE "+t.name,C),A(e,t),!1;if(b.debug_loading&&t.status==y){var a=f(e),_="LOADING START "+t.name,n=Math.round(performance.now()-e.time_load_start);R.log("%cTHREAD "+e.id+": "+a+"% "+_+" "+n+"ms ",C)}if(!t.cb_before&&!t.cb_loop&&!t.cb_after)return A(e,t),!1;if(t.status==y&&(t.status++,t.cb_before))return t.cb_before(r,e,t,t.cb_param,A,S),!0;if(t.status==x){if(t.cb_loop)return t.cb_loop(r,e,t,t.cb_param,A,S),!0;t.status++}return!(t.status!=U||(t.status++,!t.cb_after))&&(t.cb_after(r,e,t,t.cb_param,A,S),!0)}function f(e){if(0==e.stages_size_total)return 100;var t=0;return h.traverse(e.stage_graph,function(r,a){P(e,a)&&(t+=a.load_rate*a.relative_size)}),i._64(100*t/e.stages_size_total)}function P(e,t){return!(e.do_not_load_resources&&t.is_resource)}function A(e,t){if(t.is_finished=!0,t.status=w,p(e,t,1),b.debug_loading){var r=f(e),a="LOADING END "+t.name,_=Math.round(performance.now()-e.time_load_start);R.log("%cTHREAD "+e.id+": "+r+"% "+a+" "+_+"ms ",C)}}function S(e,t,r){r<1?p(e,t,r):t.status++}function p(e,t,a){var _=r();if(t.cb_before||t.cb_loop||t.cb_after){t.load_rate=a;var n=f(e);e.curr_percents==n&&1!=a||(e.stageload_cb(n,performance.now()-e.time_load_start,e.id),e.curr_percents=n,_.make_idle_iteration=!0)}}function v(e,t){var r=null;return h.traverse(e.stage_graph,function(e,a){if(a.name==t)return r=a,1}),r}function m(e){e.skip=!0}function O(e){e.stageload_cb=null,e.complete_load_cb=null,b.debug_loading||(e.stage_graph=null),e.stages_queue=null}function N(){return 0==r().active_threads}function g(e){return e&&(e.status==L||e.status==M)}var h=Object(n.a)(e),R=Object(o.a)(e),I=Object(s.a)(e),b=I.defaults,Y=2,L=3,M=4,y=0,x=1,U=2,w=3,C="color: #f0f;";t.SYNC_PRIORITY=0,t.ASYNC_PRIORITY=1,t.FINISH_PRIORITY=2;var D=null;t.get_scheduler=r,t.create_scheduler=function(){var e={threads:[],current_thread_index:0,active_threads:0,start_secondary_threads:!1,make_idle_iteration:!1};return a(e),e},t.create_thread=function(e,t,a,n,o,i,s,c,E){var l=r(),T=l.threads.length,u={id:T,is_primary:0==T,status:0,filepath:t,binary_name:"",loaded_cb:a||function(){},load_hidden:c||!1,wait_complete_loading:i,time_load_start:0,curr_percents:0,stages_size_total:0,reset_time_cycle:!1,stageload_cb:n||function(){},complete_load_cb:o||function(){},stage_graph:null,stages_queue:null,has_video_textures:!1,has_background_music:!1,init_wa_context:!1,is_preloading:E},d=_(u.is_primary,e,i,s);u.stage_graph=d;for(var f=[],A=h.get_source_nodes(d),S=0;S<A.length;S++)f.push(A[S]);return u.stages_queue=f,h.traverse(d,function(e,t){(t.cb_before||t.cb_loop||t.cb_after)&&P(u,t)&&(u.stages_size_total+=t.relative_size)}),l.threads.push(u),l.active_threads++,u.id},t.update_scheduler=function(e){var t=r();if(t&&!N()){if(t.make_idle_iteration)return void(t.make_idle_iteration=!1);var a=performance.now();do{var _=t.threads[t.current_thread_index],n=e[_.id];if(g(_)||(0==_.status&&(_.status=1,_.time_load_start=performance.now(),_.stageload_cb(0,0,_.id),b.debug_loading&&R.log("%cTHREAD "+_.id+": 0% LOADING START 0ms",C)),u(_)?l(_,n):E(t,_,n)),t.start_secondary_threads&&(t.current_thread_index=(t.current_thread_index+1)%t.threads.length),_.reset_time_cycle)return void(_.reset_time_cycle=!1)}while(performance.now()-a<16)}},t.abort_thread=function(e){var t=r();E(t,e,null),e.status=M,e.is_primary&&(t.start_secondary_threads=!0),e.loaded_cb(e.id,!1)},t.stage_part_finish_cb=S,t.skip_stage_by_name=function(e,t){var r=v(e,t);null!==r&&m(r)},t.is_finished=N,t.thread_is_finished=g,t.is_primary_loaded=function(e){var t=r();return!!t&&(e|=0,t.threads[e]&&(t.threads[e].status==L||t.threads[e].status==Y))},t.graph_to_dot=function(e){if(!b.debug_loading)return void R.error("Debug mode isn't enabled. Can not retrieve the graph.");var a=r();return a&&a.threads[e]&&a.threads[e].stage_graph?h.debug_dot(a.threads[e].stage_graph,function(e,r){if(r.skip)return"SKIPPED\n("+r.name+")";var a=r.name+"\n",_=[];return _.push(r.priority==t.ASYNC_PRIORITY?"ASYNC":"SYNC"),r.background_loading&&_.push("BKG"),r.is_resource&&_.push("RES"),a+_.join(" | ")},null):null},t.cleanup=function(){a(null)}}var _=r(0),n=r(30),o=r(1),i=r(2),s=r(4),c=Object(_.a)("__loader",a);t.a=c},function(e,t,r){"use strict";function a(e,t){var r=null;t.setup=function(e){r=e},t.get_gl=function(){return r},t.reset=function(){r=null}}var _=r(0),n=Object(_.a)("__context",a);t.a=n},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),u=Object(s.a)(e),d=Object(c.a)(e),f=Object(E.a)(e);t.append_stiff=function(e,t,r,n,o){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?(r=r||new Float32Array(3),o=o||1,n=n||[0,0,0,1],t instanceof Array&&2==t.length?a.append_stiff_bone(e,t[0],t[1],r,n,o):a.append_stiff_obj(e,t,r,n,o),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_semi_stiff=function(e,t,r,n,o,i,s,c){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?(o=l._17(o)?o:Math.PI/2,i=l._17(i)?i:-Math.PI/2,s=l._17(s)?s:Math.PI/2,c=l._17(c)?c:-Math.PI/2,r=r||new Float32Array(3),n=n?new Float32Array(n):null,a.append_semi_stiff_obj(e,t,r,n,o,i,s,c),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_semi_stiff_cam=function(e,a,_,n,o,i,s,c){if(d.error_deprecated("append_semi_stiff_cam","append_semi_stiff"),!r.is_eye_camera(e))return void d.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.");t.append_semi_stiff(e,a,_,n,o,i,s,c)},t.append_semi_soft_cam=function(e,a,_,n){if(d.error_deprecated("append_semi_soft_cam","append_semi_soft"),!r.is_eye_camera(e))return void d.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.");t.append_semi_soft(e,a,_,n)},t.append_semi_soft=function(e,t,r,n){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?((!l._17(n)||n<0)&&(n=.25),r=r||new Float32Array(3),a.append_semi_soft_obj(e,t,r,n),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_stiff_trans=function(e,t,r){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?(r=r||new Float32Array(3),a.append_stiff_trans_obj(e,t,r),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_copy_loc=function(e,t,r,n,o){if(!_.is_dynamic(e))return void d.error('Wrong object: "'+e.name+'" is not dynamic.');if(!a.check_self_applying(e,t))return void d.error("Can not apply constraint. Object and target must be different.");if(!a.check_compatibility(e,t))return void d.error("Constraint recursion is forbidden.");n=n||!1,r=r||"XYZ",o=o||1;var i=f.get_translation(e,new Float32Array(3)),s=new Float32Array(3);s[0]=-1!=r.indexOf("-X")?-1:-1!=r.indexOf("X")?1:0,s[1]=-1!=r.indexOf("-Y")?-1:-1!=r.indexOf("Y")?1:0,s[2]=-1!=r.indexOf("-Z")?-1:-1!=r.indexOf("Z")?1:0,a.append_copy_loc_obj(e,t,i,s,n,o),f.update_transform(e),u.sync_transform(e)},t.append_copy_trans=function(e,t,r){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?(r=r||1,a.append_copy_trans_obj(e,t,r),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_copy_rot=function(e,t,r,n,o){if(!_.is_dynamic(e))return void d.error('Wrong object: "'+e.name+'" is not dynamic.');if(!a.check_self_applying(e,t))return void d.error("Can not apply constraint. Object and target must be different.");if(!a.check_compatibility(e,t))return void d.error("Constraint recursion is forbidden.");n=n||!1,r=r||"XYZ",o=o||1;var i=new Float32Array(3);i[0]=-1!=r.indexOf("-X")?-1:-1!=r.indexOf("X")?1:0,i[1]=-1!=r.indexOf("-Y")?-1:-1!=r.indexOf("Y")?1:0,i[2]=-1!=r.indexOf("-Z")?-1:-1!=r.indexOf("Z")?1:0,a.append_copy_rot_obj(e,t,i,n,o),f.update_transform(e),u.sync_transform(e)},t.append_stiff_trans_rot=function(e,t,r,n){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?(r=r||new Float32Array(3),n=n?new Float32Array(n):[0,0,0,1],a.append_stiff_trans_rot_obj(e,t,r,n,1),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_track=function(e,t,r,n,o,i){if(!_.is_dynamic(e))return void d.error('Wrong object: "'+e.name+'" is not dynamic.');if(!a.check_self_applying(e,t))return void d.error("Can not apply constraint. Object and target must be different.");if(!a.check_compatibility(e,t))return void d.error("Constraint recursion is forbidden.");var s=l.e;"-Y"==r?s=l.b:"Y"==r?s=l.e:"-X"==r?s=l.a:"X"==r?s=l.d:"-Z"==r?s=l.c:"Z"==r&&(s=l.f);var c=l.f;if("X"==n?c=l.d:"Y"==n&&(c=l.e),1==Math.abs(T.dot(s,c)))return void d.error("Can not use parallel vectors for track and up axes.");i=i||1,o=o||!1,a.append_track_obj(e,t,s,c,o,i),f.update_transform(e),u.sync_transform(e)},t.append_follow=function(e,t,r,n){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?(a.append_follow_obj(e,t,r,n),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_stiff_viewport=function(e,t,r){return _.is_dynamic(e)?a.check_self_applying(e,t)?a.check_compatibility(e,t)?(r=r||{},a.append_stiff_viewport(e,t,r),f.update_transform(e),void u.sync_transform(e)):void d.error("Constraint recursion is forbidden."):void d.error("Can not apply constraint. Object and target must be different."):void d.error('Wrong object: "'+e.name+'" is not dynamic.')},t.remove=function(e,t){t=t||!1,e.constraint&&a.remove(e,t),t&&f.update_transform(e)}}var _=r(0),n=r(14),o=r(62),i=r(9),s=r(19),c=r(1),E=r(13),l=r(2),T=r(3),u=Object(_.a)("constraints",a);t.a=u},function(e,t,r){"use strict";function a(e,t){function r(){return a.get_framerate()}var a=Object(n.a)(e);t.set_timeout=a.set_timeout,t.clear_timeout=a.clear_timeout,t.get_timeline=a.get_timeline,t.animate=a.animate,t.clear_animation=a.clear_animation,t.get_framerate=r}var _=r(0),n=r(18),o=Object(_.a)("time",a);t.a=o},function(e,t,r){"use strict";function a(e,t){function r(e){e?"b4w"!==e?i=e:o.error("b4w prefix denied"):o.warn("Prefix should be a string. Last declared storage prefix will be used.")}function a(e){return s[e||i]?JSON.parse(s[e||i]):{}}function _(e,t){s[t||i]=JSON.stringify(e)}var o=Object(n.a)(e),i="b4w",s=null;t.init=r,t.set=function(e,t,r){var n=a(r);n[e]=String(t),_(n,r)},t.cleanup=function(e){delete s[e||i]},t.get=function(e,t){var r=a(t);return r[e]?r[e]:""},t.debug=function(e){o.log(a(e||i))},function(){try{s=window.localStorage;try{s.tmp=null,delete s.tmp}catch(e){o.warn("localStorage quota is limited. Disabling localStorage"),s=null}}catch(e){o.warn("Applying chrome localStorage bug workaround"),s=null}s||(o.warn("localStorage is not available, initializing temporary storage"),s={})}()}var _=r(0),n=r(1),o=Object(_.a)("storage",a);t.a=o},function(e,t,r){"use strict";function a(){}function _(e){try{return e.then}catch(e){return A=e,S}}function n(e,t){try{return e(t)}catch(e){return A=e,S}}function o(e,t,r){try{e(t,r)}catch(e){return A=e,S}}function i(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,e!==a&&f(e,this)}function s(e,t,r){return new e.constructor(function(_,n){var o=new i(a);o.then(_,n),c(e,new d(t,r,o))})}function c(e,t){for(;3===e._83;)e=e._18;if(i._47&&i._47(e),0===e._83)return 0===e._75?(e._75=1,void(e._38=t)):1===e._75?(e._75=2,void(e._38=[e._38,t])):void e._38.push(t);E(e,t)}function E(e,t){P(function(){var r=1===e._83?t.onFulfilled:t.onRejected;if(null===r)return void(1===e._83?l(t.promise,e._18):T(t.promise,e._18));var a=n(r,e._18);a===S?T(t.promise,A):l(t.promise,a)})}function l(e,t){if(t===e)return T(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"===typeof t||"function"===typeof t)){var r=_(t);if(r===S)return T(e,A);if(r===e.then&&t instanceof i)return e._83=3,e._18=t,void u(e);if("function"===typeof r)return void f(r.bind(t),e)}e._83=1,e._18=t,u(e)}function T(e,t){e._83=2,e._18=t,i._71&&i._71(e,t),u(e)}function u(e){if(1===e._75&&(c(e,e._38),e._38=null),2===e._75){for(var t=0;t<e._38.length;t++)c(e,e._38[t]);e._38=null}}function d(e,t,r){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.promise=r}function f(e,t){var r=!1,a=o(e,function(e){r||(r=!0,l(t,e))},function(e){r||(r=!0,T(t,e))});r||a!==S||(r=!0,T(t,A))}var P=r(94),A=null,S={};e.exports=i,i._47=null,i._71=null,i._44=a,i.prototype.then=function(e,t){if(this.constructor!==i)return s(this,e,t);var r=new i(a);return c(this,new d(e,t,r)),r}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(r=window)}e.exports=r},function(e,t,r){e.exports=r(107)},function(e,t,r){"use strict";function a(e,t){function r(e,t,r,a){for(var _=new Uint16Array(4),n=new Uint16Array(r*a),o=0,i=0,s=0,c=0,E=0,l=0,T=0,u=0,d=0,f=r/4,P=a/4,A=0;A<P;A++)for(var S=0;S<f;S++)s=t+4*(A*f+S),_[0]=e[s],_[1]=e[s+1],c=31&_[0],E=2016&_[0],l=63488&_[0],T=31&_[1],u=2016&_[1],d=63488&_[1],_[2]=5*c+3*T>>3|5*E+3*u>>3&2016|5*l+3*d>>3&63488,_[3]=5*T+3*c>>3|5*u+3*E>>3&2016|5*d+3*l>>3&63488,o=e[s+2],i=4*A*r+4*S,n[i]=_[3&o],n[i+1]=_[o>>2&3],n[i+2]=_[o>>4&3],n[i+3]=_[o>>6&3],i+=r,n[i]=_[o>>8&3],n[i+1]=_[o>>10&3],n[i+2]=_[o>>12&3],n[i+3]=_[o>>14],o=e[s+3],i+=r,n[i]=_[3&o],n[i+1]=_[o>>2&3],n[i+2]=_[o>>4&3],n[i+3]=_[o>>6&3],i+=r,n[i]=_[o>>8&3],n[i+1]=_[o>>10&3],n[i+2]=_[o>>12&3],n[i+3]=_[o>>14];return n}function a(e,t,a,_){var n,o,i,c,R,I,b,Y,L,M,y,x=new Int32Array(a,0,A);if(x[S]!=l)return E.error("Invalid magic number in DDS header"),0;if(!x[g]&u)return E.error("Unsupported format, must contain a FourCC code"),0;switch(n=x[h]){case d:o=8,i=t?t.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case f:o=16,i=t?t.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case P:o=16,i=t?t.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return E.error("Unsupported FourCC code:",s(n)),null}if(M=1,x[v]&T&&!1!==_&&(M=Math.max(1,x[N])),c=x[O],R=x[m],b=x[p]+4,t)for(y=0;y<M;++y)I=Math.max(4,c)/4*Math.max(4,R)/4*o,L=new Uint8Array(a,b,I),e.compressedTexImage2D(e.TEXTURE_2D,y,i,c,R,0,L),b+=I,c=Math.max(.5*c,1),R=Math.max(.5*R,1);else{if(n!=d)return E.error("No manual decoder for",s(n),"and no native support"),0;I=Math.max(4,c)/4*Math.max(4,R)/4*o,L=new Uint16Array(a),Y=r(L,b/2,c,R),e.texImage2D(e.TEXTURE_2D,0,e.RGB,c,R,0,e.RGB,e.UNSIGNED_SHORT_5_6_5,Y),_&&e.generateMipmap(e.TEXTURE_2D)}return M}function _(e,t,r,_,n,o){var i=new XMLHttpRequest;return i.open("GET",r,!0),i.responseType="arraybuffer",i.onload=function(){if(200==i.status){e.bindTexture(e.TEXTURE_2D,_);var r=a(e,t,i.response,n);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r>1?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)}o&&o(_)},i.send(null),_}function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function s(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}var c=Object(n.a)(e),E=Object(o.a)(e),l=542327876,T=131072,u=4,d=i("DXT1"),f=i("DXT3"),P=i("DXT5"),A=31,S=0,p=1,v=2,m=3,O=4,N=7,g=20,h=21;t.upload_dds_levels=a,t.upload_pvr_levels=function(e,t,r){var a=new Uint32Array(r,0,13);if(55727696==a[0]){var _=a[7],n=a[6],o=a[11],i=52+a[12];switch(a[2]){case 0:var s=2,E=1;break;case 1:var s=2,E=3;break;case 2:var s=4,E=0;break;case 3:var s=4,E=2;break;default:c.panic("Unsupported PVR V3 format.")}}else if(559044176==a[11]){var _=a[2],n=a[1],o=a[3],i=a[0];o++;var l=a[4],T=255&l,u=a[10],d=u>0;if(25==T)var s=4,E=d?2:0;else if(24==T)var s=2,E=d?3:1;else c.panic("Unsupported PVR V2 format.")}else c.panic("Unsupported PVR version.");if(2==s)var f=8,P=4;else var f=4,P=4;switch(E){case 0:var A=t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:var A=t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:var A=t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:var A=t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}for(var S=f*P*s/8,p=0;p<o;p++){var v=Math.max(_>>p,1),m=Math.max(n>>p,1),O=v/f,N=m/P;O<2&&(O=2),N<2&&(N=2);var g=O*N*S,h=new Uint8Array(r,i,g);e.compressedTexImage2D(e.TEXTURE_2D,p,A,v,m,0,h),i+=g}},t.get_width_height=function(e,t){switch(t){case"dds":var r=new Int32Array(e,0,A);return{width:r[O],height:r[m]};case"pvr":var r=new Uint32Array(e,0,13);if(55727696==r[0])var a=r[7],_=r[6];else var a=r[2],_=r[1];return{width:a,height:_}}},t.get_compress_ratio=function(e,t){var r=1;if("dds"==t){var a=new Int32Array(e,0,A),_=a[h];switch(_){case d:r=6;break;case f:case P:r=4;break;default:E.error("Unsupported FourCC code:",s(_))}}else if("pvr"==t){var a=new Uint32Array(e,0,13);if(55727696==a[0]){var n=a[2];switch(n){case 0:r=12;break;case 1:r=16;break;case 2:r=6;break;case 3:r=8}}else{var o=255&a[4],i=a[10]>0;25==o?r=i?8:6:24==o&&(r=i?16:12)}}return r},t.load_dds_texture=function(e,t,r,a){var n=e.createTexture();return _(e,t,r,n,!0,a),n}}var _=r(0),n=r(5),o=r(1),i=(r(2),Object(_.a)("__texcomp",a));t.a=i},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a={};t.fill_vbo_garbage_info=function(e,t,r,_,n){a[e]||(a[e]={shaders:t,attrs:{}}),r in a[e].attrs||(a[e].attrs[r]=_),n&&(a[e].attrs[r]=0)},t.calc_vbo_garbage_byte_size=function(){var e=0;for(var t in a)for(var r in a[t].attrs)e+=a[t].attrs[r];return e},t.show_vbo_garbage_info=function(){var e={};for(var t in a)for(var _ in a[t].attrs){var n=a[t].attrs[_];if(n){var o=a[t].shaders;o in e||(e[o]={total_size:0,attrs:{}}),_ in e[o].attrs||(e[o].attrs[_]=0),e[o].attrs[_]+=n,e[o].total_size+=n}}for(var o in e){r.groupCollapsed(o,e[o].total_size);for(var _ in e[o].attrs)r.log_raw(_,e[o].attrs[_]);r.groupEnd()}},t.cleanup=function(){a={}}}var _=r(0),n=r(1),o=Object(_.a)("__debug",a);t.a=o},function(e,t,r){"use strict";function a(e,t){function r(){var e=T.get_disjoint_timer_query();if(e){var t=e.createQuery();e.beginQuery(t)}else var t=performance.now();return t}function a(){var e=l.get_debug_view_subs();return e&&e.debug_view_mode==l.DV_RENDER_TIME}function _(e,t,r){var a=T.get_disjoint_timer_query(),_=0;if(a){r&&a.endQuery();for(var n=0;n<e.length;n++){var o=e[n],i=a.getQueryAvailable(o),s=a.getDisjoint();if(i&&!s){_=a.getQueryObject(o)/1e6,t&&(_=c._51(_,t,1,f)),e.splice(n,1),n--}}}else _=performance.now()-e.pop(),t&&(_=c._51(_,t,1,f));return _}var E=Object(n.a)(e),l=Object(o.a)(e),T=Object(i.a)(e),u=Object(s.a)(e),d=E.defaults,f=10;t.start_subs=function(e){(d.show_hud_debug_info||e.type==u.PERFORMANCE)&&(e.do_not_debug||e.debug_render_time_queries.push(r()))},t.start_batch=function(e){"MAIN"==e.type&&a()&&e.debug_render_time_queries.push(r())},t.stop_subs=function(e){if((d.show_hud_debug_info||e.type==u.PERFORMANCE)&&!e.do_not_debug){var t=_(e.debug_render_time_queries,e.debug_render_time,!0);t&&(e.debug_render_time=t)}},t.stop_batch=function(e){if("MAIN"==e.type&&a()){var t=_(e.debug_render_time_queries,e.debug_render_time,!0);t&&(e.debug_render_time=t)}},t.is_debug_view_render_time_mode=a,t.process_timer_queries=function(e){var t=_(e.debug_render_time_queries,e.debug_render_time,!1);t&&(e.debug_render_time=t)}}var _=r(0),n=r(4),o=r(49),i=r(29),s=r(11),c=r(2),E=Object(_.a)("__debug_rendertime",a);t.a=E},function(e,t,r){"use strict";function a(e,t){function r(e){var t,r,a,_,n,o,i={},s=[],c=[],E=Math.pow(10,4);for(a=0,_=e.vertices.length;a<_;a++)t=e.vertices[a],r=Math.round(t[0]*E)+"_"+Math.round(t[1]*E)+"_"+Math.round(t[2]*E),void 0===i[r]?(i[r]=a,s.push(t),c[a]=s.length-1):c[a]=c[i[r]];var l=[];for(a=0,_=e.faces.length;a<_;a++){n=e.faces[a],n.indices[0]=c[n.indices[0]],n.indices[1]=c[n.indices[1]],n.indices[2]=c[n.indices[2]],o=[n.indices[0],n.indices[1],n.indices[2]];for(var T=0;T<3;T++)if(o[T]==o[(T+1)%3]){l.push(a);break}}for(a=l.length-1;a>=0;a--){var u=l[a];e.faces.splice(u,1)}var d=e.vertices.length-s.length;for(e.vertices.length=0,a=0;a<s.length;a++)e.vertices.push(s[a]);return d}function a(e,t){return e>t?t+"-"+e:e+"-"+t}function _(e){for(var t=[],r=e.vertices,_=0,n=0;n<e.faces.length;n++){var o=e.faces[n];t.push({id:_++,vertex_ids:o.indices,centroid:o.centroid,normal:o.normal,neighbours:[]})}for(var i={polygons:t,vertices:r},s={},n=0;n<t.length;n++)for(var c=0;c<3;c++){var E=a(t[n].vertex_ids[c],t[n].vertex_ids[(c+1)%3]);E in s||(s[E]=[]),s[E].push(t[n])}for(var l=Object.keys(s),n=0,T=l.length;n<T;n++)for(var E=l[n],c=0;c<s[E].length;c++)for(var u=c+1;u<s[E].length;u++)s[E][c].neighbours.push(s[E][u]),s[E][u].neighbours.push(s[E][c]);return i}function l(e){var t,r;for(t=0;t<e.faces.length;t++)r=e.faces[t],c.add(e.vertices[r.indices[0]],e.vertices[r.indices[1]],w),c.add(w,e.vertices[r.indices[2]],w),c.scale(w,1/3,r.centroid)}function T(e){for(var t=0;t<e.faces.length;t++){var r=e.faces[t],a=c.subtract(e.vertices[r.indices[1]],e.vertices[r.indices[0]],w),_=c.subtract(e.vertices[r.indices[2]],e.vertices[r.indices[0]],C),n=c.cross(a,_,w);c.normalize(n,n),c.copy(n,r.normal)}}function u(e){return l(e),T(e),r(e),_(e)}function d(e,t){return parseFloat(e.toFixed(t))}function f(e){for(var t=e.polygons,r=[],a=0,_=function(e){for(var t=e.neighbours,r=0;r<t.length;r++){var a=t[r];void 0==a.island&&(a.island=e.island,_(a))}},n=0;n<t.length;n++){var o=t[n];void 0==o.island&&(o.island=a++,_(o)),r[o.island]||(r[o.island]=[]),r[o.island].push(t[n])}return r}function P(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]==t)return r;return-1}function A(e){for(var t={},r=e.vertices,a=0;a<r.length;a++)r[a][0]=d(r[a][0],2),r[a][1]=d(r[a][1],2),r[a][2]=d(r[a][2],2);t.vertices=e.vertices;var _=f(e);t.islands=[];for(var n=function(e,t){for(var r=0;r<e.length;r++)if(t===e[r])return r},a=0;a<_.length;a++){for(var o=[],i=_[a],s=0;s<i.length;s++){for(var c=[],E=i[s],l=0;l<E.neighbours.length;l++)c.push(n(i,E.neighbours[l]));for(var T=[],l=0;l<E.neighbours.length;l++)T.push(q(E,E.neighbours[l]));E.centroid[0]=d(E.centroid[0],2),E.centroid[1]=d(E.centroid[1],2),E.centroid[2]=d(E.centroid[2],2),o.push({id:n(i,E),neighbours:c,vertex_ids:E.vertex_ids,centroid:E.centroid,normal:E.normal,portals:T,f:0,g:0,h:0,cost:1,visited:!1,closed:!1,parent:null})}t.islands.push(o)}return t}function S(e,t,r,a,_,n){function i(e,t){return c.subtract(e,t,w),c.dot(w,w)}!function(e){for(var t=0;t<e.length;t++){var r=e[t];r.f=0,r.g=0,r.h=0,r.cost=1,r.visited=!1,r.closed=!1,r.parent=null}}(e);var s=o.a(function(e){return e.f});for(o.c(s,t);s.content.length>0;){var E=o.b(s);if(E===r){for(var l=E,T=[];l.parent;)T.push(l),l=l.parent;return T.push(t),T.reverse()}E.closed=!0;for(var u=function(e,t){for(var r=[],a=0;a<t.neighbours.length;a++)r.push(e[t.neighbours[a]]);return r}(e,E),d=0,f=u.length;d<f;d++){var P=u[d];if(!P.closed){var A=E.g+c.dist(P.centroid,E.centroid),S=P.visited;(!S||A<P.g)&&(P.visited=!0,P.parent=E,P.h=P.h||i(P.centroid,_)+i(P.centroid,a),P.g=A,P.f=P.g+P.h,S?o.d(s,P):o.c(s,P))}}}return[]}function p(e,t){e.push(t[0]),e.push(t[1]),e.push(t[2])}function v(e,t,r,a){var _=c.subtract(t,e,w),n=c.subtract(r,e,C),o=c.cross(_,n,w);return s._50(c.dot(a,o))}function m(e,t){return c.subtract(e,t,w),c.dot(w,w)<1e-5}function O(e,t,r){var a=c.subtract(t.right,t.left,w),_=r.normal,n=t.normal,o=Math.acos(c.dot(_,n));o*=-s._50(c.dot(a,c.cross(_,n,C)));var E=i.identity(B);return i.translate(E,t.left,E),i.rotate(E,o,a,E),i.translate(E,c.scale(t.left,-1,C),E),i.multiply(e,E,e),e}function N(e,t,r,a,_,n,o){var i=c.transformMat4(r,n,D);i[3]=1;var s=c.transformMat4(a,n,w),l=c.subtract(s,i,F),T=c.subtract(t,e,w),u=c.cross(_,T,G);if(Math.abs(c.dot(u,l))<.01)var d=.5;else{c.normalize(u,u),u[3]=-c.dot(u,t);var d=-E.dot(u,i)/E.dot(u,l)}var f=c.subtract(a,r,w);return c.scaleAndAdd(r,f,d,o)}function g(e,t,r,a,_,n,o,s,E){for(var l=i.identity(k),T=_;T<r;T++)if(e[T].is_crucial&&(T>_||!T)){var u=N(t,a,e[T].left,e[T].right,n,l,c.create());p(o,u),s&&p(E,e[T].normal),T&&O(l,e[T],e[T-1])}}function h(e,t){function r(t,r){u=r,d=u,f=u,a=t,_=a,n=a,c.copy(t,o),c.copy(t,s),c.copy(e[u].normal,E)}var a,_,n,o,s,E,l=[],T=[],u=0,d=0,f=0;a=e[0].right,_=e[0].left,n=e[0].right,o=c.copy(_,X),s=c.copy(n,j),E=c.copy(e[0].normal,z),p(l,a),t&&p(T,e[0].normal);for(var P=i.identity(K),A=1;A<e.length;A++){var S=e[A].left,N=e[A].right,h=c.transformMat4(S,P,H),R=c.transformMat4(N,P,Q);if(e[A].is_crucial&&O(P,e[A],e[A-1]),v(a,s,R,E)<=0){var I=m(a,n);if(!(I||v(a,o,R,E)>0)){var b=m(o,a);b||g(e,o,d,a,u,E,l,t,T),P=i.identity(P),r(_,d),A=u,b||(p(l,a),t&&p(T,e[A].normal));continue}n=N,c.copy(R,s),f=A}if(v(a,o,h,E)>=0){var I=m(a,_);if(!(I||v(a,s,h,E)<0)){var Y=m(s,a);Y||g(e,s,f,a,u,E,l,t,T),P=i.identity(P),r(n,f),A=u,Y||(p(l,a),t&&p(T,e[A].normal));continue}_=S,c.copy(h,o),d=A}}var L=e.length-1,M=e[L].left,y=m(a,M);return y||g(e,o,L,a,u,E,l,t,T),y&&u||p(l,M),t?(p(T,e[L].normal),{positions:new Float32Array(l),normals:new Float32Array(T)}):{positions:new Float32Array(l),normals:null}}function R(e,t){for(var r=!1,a=-1,_=e.length,n=_-1;++a<_;n=a)(e[a][1]<=t[1]&&t[1]<e[n][1]||e[n][1]<=t[1]&&t[1]<e[a][1])&&t[0]<(e[n][0]-e[a][0])*(t[1]-e[a][1])/(e[n][1]-e[a][1])+e[a][0]&&(r=!r);return r}function I(e,t,r){for(var a=[],_=0;_<t.length;_++){var n=t[_];a.push(r[n])}return!!R(a,e)}function b(e,t,r,a,_){for(var n=null,o=Number.MAX_VALUE,i=0;i<e.length;i++){var s=e[i],c=_(r,s.centroid,s.vertex_ids,t,o);c<o&&(n=s,o=c)}return a>0&&o>a?null:n}function Y(e,t){for(var r=0;r<e.neighbours.length;r++)if(e.neighbours[r]===t.id)return e.portals[r]}function L(e,t,r,a,_){e.push({left:t,right:r,is_crucial:a,normal:_})}function M(e,t,r,a,_){var n=[];L(n,t,t,!1,e[0]&&e[0].normal||s.f);for(var o=0;o<e.length;o++){var i=e[o],E=e[o+1];if(E){var l=Math.abs(c.dot(i.normal,E.normal))<.999,T=Y(i,E);L(n,a[T[0]],a[T[1]],l,E.normal)}}return L(n,r,r,!1,n[n.length-1].normal),h(n,_)}function y(e,t){if(t){for(var r=new Float32Array(3*e.length),a=0;a<e.length;a++)r.set(e[a].centroid,3*a);return{positions:r,normals:null}}for(var _=new Float32Array(3*e.length),n=new Float32Array(3*e.length),a=0;a<e.length;a++)_.set(e[a].centroid,3*a),n.set(e[a].normal,3*a);return{positions:_,normals:n}}function x(e,t,r,a){var _=a.island,n=e.islands[_],o=e.vertices,i=b(n,o,t,a.allowed_distance,a.distance_to_closest);if(!i)return null;var s=b(n,o,r,a.allowed_distance,a.distance_to_farthest);return s?S(n,i,s,t,r,o):null}var U=Object(n.a)(e),w=c.create(),C=c.create(),D=E.create(),F=E.create(),G=E.create(),k=i.create(),K=i.create(),B=i.create(),X=c.create(),j=c.create(),H=c.create(),Q=c.create(),z=c.create(),q=function(e,t){function r(e){var t=e[0];e[0]=e[1],e[1]=e[2],e[2]=t}for(var a=e.vertex_ids,_=t.vertex_ids,n=[],o=0;o<a.length;o++)P(_,a[o])>=0&&n.push(a[o]);if(n.length<2)return[];P(n,a[0])>=0&&P(n,a[a.length-1])>=0&&r(a),P(n,_[0])>=0&&P(n,_[_.length-1])>=0&&r(_),n=[];for(var o=0;o<a.length;o++)P(_,a[o])>=0&&n.push(a[o]);return n};t.navmesh_build_from_bufs_data=function(e){for(var t=U.get_vbo_source_by_type(e.vbo_source_data,U.VBO_FLOAT),r=e.ibo_array,a=[],_=0;_<r.length;_+=3)a.push({indices:new Uint32Array([r[_],r[_+1],r[_+2]]),centroid:new Float32Array(3),normal:new Float32Array(3)});for(var n=[],_=0;_<t.length;_+=3){var o=new Float32Array(3);o[0]=t[_],o[1]=t[_+1],o[2]=t[_+2],n.push(o)}return A(u({vertices:n,faces:a}))},t.navmesh_get_island=function(e,t,r){for(var a=null,_=Number.MAX_VALUE,n=e.islands,o=0;o<n.length;o++)for(var i=0;i<n[o].length;i++){var s=n[o][i];c.subtract(s.centroid,t,w);var E=r(t,s.centroid,s.vertex_ids,e.vertices,_);E<_&&(a=o,_=E)}return a},t.is_vector_in_poly=I,t.navmesh_find_path=function(e,t,r,a){var _=x(e,t,r,a);return _&&_.length?a.do_not_pull_string?y(_,a.return_normals):M(_,t,r,e.vertices,a.return_normals):null}}var _=r(0),n=r(20),o=r(45),i=r(21),s=r(2),c=r(3),E=r(7),l=Object(_.a)("__navmesh",a);t.a=l},function(e,t,r){"use strict";function a(){return{name:"",type:"",uuid:"",use_nodes:!1,node_tree:null,texture_slots:[],blend_mode:"",use_shadeless:!1,use_transparency:!1,use_backface_culling:!1,use_tangent_shading:!1,use_orco_tex_coord:!1,use_vertex_color_paint:!1,use_double_sided_lighting:!1,do_not_render:!1,render_above_all:!1,is_lens_flares:!1,is_wettable:!1,is_refractive:!1,refr_bump:0,pass_index:0,offset_z:0,diffuse_shader:"",diffuse_color:new Float32Array(3),diffuse_intensity:0,diffuse_toon_size:0,diffuse_toon_smooth:0,roughness:0,diffuse_fresnel:0,diffuse_fresnel_factor:0,darkness:0,alpha:0,specular_shader:"",specular_color:new Float32Array(3),specular_intensity:0,specular_toon_size:0,specular_toon_smooth:0,specular_hardness:0,specular_ior:0,specular_slope:0,specular_alpha:0,emit:0,ambient:0,water_settings:{is_water:!1,shore_smoothing:!1,absorb_factor:0,foam_factor:0,shallow_col:new Float32Array(3),shore_col:new Float32Array(3),shallow_col_fac:0,shore_col_fac:0,fog_color:new Float32Array(3),fog_density:0,sss_strength:0,sss_width:0,norm_uv_velocity:0,is_dynamic:!1,waves_height:0,waves_length:0,dst_noise_scale0:0,dst_noise_scale1:0,dst_noise_freq0:0,dst_noise_freq1:0,dir_min_shore_fac:0,dir_freq:0,dir_noise_scale:0,dir_noise_freq:0,dir_min_noise_fac:0,dst_min_fac:0,waves_hor_fac:0,is_generated_mesh:!1,num_cascads:0,num_subdivs:0,detailed_dist:0,enable_caust:!1,caust_scale:0,caust_brightness:0},terrain_settings:{is_terrain:!1,dynamic_grass_size:"",dynamic_grass_color:""},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:0},halo_settings:{size:0,hardness:0,rings_color:new Float32Array(3),lines_color:new Float32Array(3),ring_count:0,line_count:0,star_tip_count:0,is_sky_stars:!1,stars_blend_height:0,stars_min_height:0},physics_settings:{use_coll_physics:!1,use_ghost:!1,friction:0,elasticity:0,collision_id:"",collision_margin:0,collision_group:0,collision_mask:0}}}function _(){var e=a();return e.name="DEFAULT",e.type="SURFACE",e.uuid=i._4(),e.use_nodes=!1,e.node_tree=null,e.texture_slots=[],e.blend_mode="OPAQUE",e.use_shadeless=!1,e.use_transparency=!1,e.use_backface_culling=!0,e.use_vertex_color_paint=!1,e.use_double_sided_lighting=!1,e.render_above_all=!1,e.is_refractive=!1,e.refr_bump=0,e.pass_index=0,e.offset_z=0,e.diffuse_shader="LAMBERT",e.diffuse_color.set([.8,.8,.8]),e.diffuse_intensity=.8,e.alpha=1,e.specular_shader="COOKTORR",e.specular_color.set([1,1,1]),e.specular_intensity=.5,e.specular_hardness=50,e.specular_alpha=1,e.emit=0,e.ambient=1,e.water_settings.is_water=!1,e.terrain_settings.is_terrain=!1,e.raytrace_mirror.reflect_factor=0,e.raytrace_mirror.fresnel=0,e.raytrace_mirror.fresnel_factor=1.25,e.physics_settings.use_coll_physics=!1,e}function n(e,t){t.name=e.name,t.type=e.type,t.uuid=e.uuid,t.use_nodes=e.use_nodes,t.node_tree=e.node_tree,t.texture_slots=e.texture_slots,t.blend_mode=e.game_settings.alpha_blend,t.use_shadeless=e.use_shadeless,t.use_transparency=e.use_transparency,t.use_backface_culling=e.game_settings.use_backface_culling,t.use_tangent_shading=e.use_tangent_shading,t.use_orco_tex_coord=e.use_orco_tex_coord,t.use_vertex_color_paint=e.use_vertex_color_paint,t.use_double_sided_lighting=e.b4w_double_sided_lighting,t.do_not_render=e.b4w_do_not_render,t.render_above_all=e.b4w_render_above_all,t.is_lens_flares=e.b4w_lens_flares,t.is_wettable=e.b4w_wettable,t.is_refractive=e.b4w_refractive,t.refr_bump=e.b4w_refr_bump,t.pass_index=e.pass_index,t.offset_z=e.offset_z,t.diffuse_shader=e.diffuse_shader,t.diffuse_color.set(e.diffuse_color),t.diffuse_intensity=e.diffuse_intensity,t.diffuse_toon_size=e.diffuse_toon_size,t.diffuse_toon_smooth=e.diffuse_toon_smooth,t.roughness=e.roughness,t.diffuse_fresnel=e.diffuse_fresnel,t.diffuse_fresnel_factor=e.diffuse_fresnel_factor,t.darkness=e.darkness,t.alpha=e.alpha,t.specular_shader=e.specular_shader,t.specular_color.set(e.specular_color),t.specular_intensity=e.specular_intensity,t.specular_toon_size=e.specular_toon_size,t.specular_toon_smooth=e.specular_toon_smooth,t.specular_hardness=e.specular_hardness,t.specular_ior=e.specular_ior,t.specular_slope=e.specular_slope,t.specular_alpha=e.specular_alpha,t.emit=e.emit,t.ambient=e.ambient;var r=t.water_settings;r.is_water=e.b4w_water,r.shore_smoothing=e.b4w_water_shore_smoothing,r.absorb_factor=e.b4w_water_absorb_factor,r.foam_factor=e.b4w_foam_factor,r.shallow_col.set(e.b4w_shallow_water_col),r.shore_col.set(e.b4w_shore_water_col),r.shallow_col_fac=e.b4w_shallow_water_col_fac,r.shore_col_fac=e.b4w_shore_water_col_fac,r.fog_color.set(e.b4w_water_fog_color),r.fog_density=e.b4w_water_fog_density,r.sss_strength=e.b4w_water_sss_strength,r.sss_width=e.b4w_water_sss_width,r.norm_uv_velocity=e.b4w_water_norm_uv_velocity,r.is_dynamic=e.b4w_water_dynamic,r.waves_height=e.b4w_waves_height,r.waves_length=e.b4w_waves_length,r.dst_noise_scale0=e.b4w_water_dst_noise_scale0,r.dst_noise_scale1=e.b4w_water_dst_noise_scale1,r.dst_noise_freq0=e.b4w_water_dst_noise_freq0,r.dst_noise_freq1=e.b4w_water_dst_noise_freq1,r.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,r.dir_freq=e.b4w_water_dir_freq,r.dir_noise_scale=e.b4w_water_dir_noise_scale,r.dir_noise_freq=e.b4w_water_dir_noise_freq,r.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,r.dst_min_fac=e.b4w_water_dst_min_fac,r.waves_hor_fac=e.b4w_water_waves_hor_fac,r.is_generated_mesh=e.b4w_generated_mesh,r.num_cascads=e.b4w_water_num_cascads,r.num_subdivs=e.b4w_water_subdivs,r.detailed_dist=e.b4w_water_detailed_dist,r.enable_caust=e.b4w_water_enable_caust,r.caust_scale=e.b4w_water_caust_scale,r.caust_brightness=e.b4w_water_caust_brightness;var a=t.terrain_settings;a.is_terrain=e.b4w_terrain,a.dynamic_grass_size=e.b4w_dynamic_grass_size,a.dynamic_grass_color=e.b4w_dynamic_grass_color;var _=t.raytrace_mirror;_.reflect_factor=e.raytrace_mirror.reflect_factor,_.fresnel=e.raytrace_mirror.fresnel,_.fresnel_factor=e.raytrace_mirror.fresnel_factor;var n=t.halo_settings;n.size=e.halo.size,n.hardness=e.halo.hardness,n.rings_color.set(e.halo.b4w_halo_rings_color),n.lines_color.set(e.halo.b4w_halo_lines_color),n.ring_count=e.halo.ring_count,n.line_count=e.halo.line_count,n.star_tip_count=e.halo.star_tip_count,n.is_sky_stars=e.b4w_halo_sky_stars,n.stars_blend_height=e.b4w_halo_stars_blend_height,n.stars_min_height=e.b4w_halo_stars_min_height;var o=t.physics_settings;o.use_coll_physics=e.b4w_collision,o.use_ghost=e.b4w_use_ghost,o.friction=e.physics.friction,o.elasticity=e.physics.elasticity,o.collision_id=e.b4w_collision_id,o.collision_margin=e.b4w_collision_margin,o.collision_group=e.b4w_collision_group,o.collision_mask=e.b4w_collision_mask}function o(e){var t=e;t.name=e.name,t.type=e.type,t.uuid=e.uuid,t.use_nodes=e.use_nodes,t.node_tree=e.node_tree,t.texture_slots=e.texture_slots.slice(),t.blend_mode=e.blend_mode,t.use_shadeless=e.use_shadeless,t.use_transparency=e.use_transparency,t.use_backface_culling=e.use_backface_culling,t.use_tangent_shading=e.use_tangent_shading,t.use_orco_tex_coord=e.use_orco_tex_coord,t.use_vertex_color_paint=e.use_vertex_color_paint,t.use_double_sided_lighting=e.use_double_sided_lighting,t.do_not_render=e.do_not_render,t.render_above_all=e.render_above_all,t.is_lens_flares=e.is_lens_flares,t.is_wettable=e.is_wettable,t.is_refractive=e.is_refractive,t.refr_bump=e.refr_bump,t.pass_index=e.pass_index,t.offset_z=e.offset_z,t.diffuse_shader=e.diffuse_shader,t.diffuse_color.set(e.diffuse_color),t.diffuse_intensity=e.diffuse_intensity,t.diffuse_toon_size=e.diffuse_toon_size,t.diffuse_toon_smooth=e.diffuse_toon_smooth,t.roughness=e.roughness,t.diffuse_fresnel=e.diffuse_fresnel,t.diffuse_fresnel_factor=e.diffuse_fresnel_factor,t.darkness=e.darkness,t.alpha=e.alpha,t.specular_shader=e.specular_shader,t.specular_color.set(e.specular_color),t.specular_intensity=e.specular_intensity,t.specular_toon_size=e.specular_toon_size,t.specular_toon_smooth=e.specular_toon_smooth,t.specular_hardness=e.specular_hardness,t.specular_ior=e.specular_ior,t.specular_slope=e.specular_slope,t.specular_alpha=e.specular_alpha,t.emit=e.emit,t.ambient=e.ambient;var r=e.water_settings,a=t.water_settings;a.is_water=r.is_water,a.shore_smoothing=r.shore_smoothing,a.absorb_factor=r.absorb_factor,a.foam_factor=r.foam_factor,a.shallow_col.set(r.shallow_col),a.shore_col.set(r.shore_col),a.shallow_col_fac=r.shallow_col_fac,a.shore_col_fac=r.shore_col_fac,a.fog_color=r.fog_color,a.fog_density=r.fog_density,a.sss_strength=r.sss_strength,a.sss_width=r.sss_width,a.norm_uv_velocity=r.norm_uv_velocity,a.is_dynamic=r.is_dynamic,a.waves_height=r.waves_height,a.waves_length=r.waves_length,a.dst_noise_scale0=r.dst_noise_scale0,a.dst_noise_scale1=r.dst_noise_scale1,a.dst_noise_freq0=r.dst_noise_freq0,a.dst_noise_freq1=r.dst_noise_freq1,a.dir_min_shore_fac=r.dir_min_shore_fac,a.dir_freq=r.dir_freq,a.dir_noise_scale=r.dir_noise_scale,a.dir_noise_freq=r.dir_noise_freq,a.dir_min_noise_fac=r.dir_min_noise_fac,a.dst_min_fac=r.dst_min_fac,a.waves_hor_fac=r.waves_hor_fac,a.is_generated_mesh=r.is_generated_mesh,a.num_cascads=r.num_cascads,a.num_subdivs=r.num_subdivs,a.detailed_dist=r.detailed_dist,a.enable_caust=r.enable_caust,a.caust_scale=r.caust_scale,a.caust_brightness=r.caust_brightness;var _=e.terrain_settings,n=t.terrain_settings;n.is_terrain=_.is_terrain,n.dynamic_grass_size=_.dynamic_grass_size,n.dynamic_grass_color=_.dynamic_grass_color;var o=e.raytrace_mirror,i=t.raytrace_mirror;i.reflect_factor=o.reflect_factor,i.fresnel=o.fresnel,i.fresnel_factor=o.fresnel_factor;var s=e.halo_settings,c=t.halo_settings;c.size=s.size,c.hardness=s.hardness,c.rings_color.set(s.rings_color),c.lines_color.set(s.lines_color),c.ring_count=s.ring_count,c.line_count=s.line_count,c.star_tip_count=s.star_tip_count,c.is_sky_stars=s.is_sky_stars,c.stars_blend_height=s.stars_blend_height,c.stars_min_height=s.stars_min_height;var E=e.physics_settings,l=t.physics_settings;return l.use_coll_physics=E.use_coll_physics,l.use_ghost=E.use_ghost,l.friction=E.friction,l.elasticity=E.elasticity,l.collision_id=E.collision_id,l.collision_margin=E.collision_margin,l.collision_group=E.collision_group,l.collision_mask=E.collision_mask,t}t.c=a,t.b=_,t.d=n,t.a=o;var i=r(2)},function(e,t,r){"use strict";function a(e,t){function r(e,t,r){r||(r=[]);var a=e+t,_=e+2;r[0]=0;for(var n=2;n<=a;n++)r[n-1]=n>t&&n<_?r[n-2]+1:r[n-2];return r}function a(e,t,r,a,_){var n=a.length;_||(_=new Float32Array(n));for(var o=n+e,i=new Float32Array(o),s=1;s<=o-1;s++)t>=r[s-1]&&t<r[s+1-1]?i[s-1]=1:i[s-1]=0;for(var c=2;c<=e;c++)for(var s=1;s<=o-c;s++){if(0!=i[s-1])var E=(t-r[s-1])*i[s-1]/(r[s+c-1-1]-r[s-1]);else var E=0;if(0!=i[s+1-1])var l=(r[s+c-1]-t)*i[s+1-1]/(r[s+c-1]-r[s+1-1]);else var l=0;i[s-1]=E+l}t==r[o-1]&&(i[n-1]=1);for(var T=0,s=1;s<=n;s++)T+=i[s-1]*a[s-1];for(var s=1;s<=n;s++)_[s-1]=0!=T?i[s-1]*a[s-1]/T:0;return _}function _(e,t,r,a,_){var n=a.length;_||(_=new Float32Array(n));var o=new Float32Array(n),i=new Float32Array(n);s(n,e,t,r,o,i);for(var c=0,E=1;E<=n;E++)c+=o[E-1]*a[E-1];for(var l=0,E=1;E<=n;E++)l+=i[E-1]*a[E-1];for(var E=1;E<=n;E++)if(0!=c){var T=i[E-1]*a[E-1]/c,u=o[E-1]*a[E-1]*l/(c*c);_[E-1]=T+u}else _[E-1]=0;return _}function s(e,t,r,a,_,n){_||(_=new Float32Array(e)),n||(n=new Float32Array(e));for(var o=e+t,i=new Float32Array(o),s=new Float32Array(o),c=1;c<=o-1;c++)r>=a[c-1]&&r<a[c+1-1]?i[c-1]=1:i[c-1]=0;r==a[o-1]&&(i[e-1]=1);for(var E=2;E<=t;E++)for(var c=1;c<=o-E;c++){if(0!=i[c-1])var l=(r-a[c-1])*i[c-1]/(a[c+E-1-1]-a[c-1]);else var l=0;if(0!=i[c+1-1])var T=(a[c+E-1]-r)*i[c+1-1]/(a[c+E-1]-a[c+1-1]);else var T=0;if(0!=i[c-1])var u=i[c-1]/(a[c+E-1-1]-a[c-1]);else var u=0;if(0!=i[c+1-1])var d=-i[c+1-1]/(a[c+E-1]-a[c+1-1]);else var d=0;if(0!=s[c-1])var f=(r-a[c-1])*s[c-1]/(a[c+E-1-1]-a[c-1]);else var f=0;if(0!=s[c+1-1])var P=(a[c+E-1]-r)*s[c+1-1]/(a[c+E-1]-a[c+1-1]);else var P=0;i[c-1]=l+T,s[c-1]=u+d+f+P}for(var c=1;c<=e;c++)_[c-1]=i[c-1],n[c-1]=s[c-1];return _}function c(e,t,r){r||(r=[]);for(var _=e.cpoints,n=e.is_3d?4:3,o=e.weights,i=e.knot,s=e.order,c=_.length/n,E=c+s,l=0,T=i[E-1]/(t-1),u=0;u<t;u++){i[E-1]-l<5e-6&&(l=i[E-1]);for(var d=a(s,l,i,o),f=0;f<n;f++){r[n*u+f]=0;for(var P=0;P<c;P++){var A=d[P]*_[n*P+f];r[n*u+f]+=A}}l+=T}return r}function E(e,t){var r=(Math.max(t,0),l(e));return Math.min(t,r)}function l(e){var t=e.knot;return t[t.length-1]}function T(e){var t=e.cumulative_length;return t[t.length-1]}function u(e,t,r,a,_,n,o,i){var s=e+(t-e)/2,c=d(s,a,_,n,o),E=c-r;return i=i||.01,Math.abs(E)<i?s:E>0?u(e,s,r,a,_,n,o,i):u(s,t,r,a,_,n,o,i)}function d(e,t,r,a,_){var n=1-e;return t*n*n*n+3*r*n*n*e+3*a*n*e*e+_*e*e*e}var f=Object(n.a)(e);t.create_spline=function(e){var t={},a=e.data,_=a.splines[0];if(!_||"NURBS"!=_.type||!_.use_endpoint_u)return null;var n=_.order_u;t.order=n;var o=_.points,i=r(o.length/5,n,[]);t.knot=i,"2D"==a.dimensions?t.is_3d=!1:"3D"==a.dimensions?t.is_3d=!0:f.panic("Wrong curve dimensions");for(var s=[],E=[],l=0;l<o.length;l+=5)s.push(o[l]),s.push(o[l+1]),s.push(o[l+2]),t.is_3d&&s.push(o[l+3]),E.push(o[l+4]);t.cpoints=s,t.weights=E,o=c(t,1e3,[]);var T=t.is_3d?4:3,u=new Float32Array(1e3);u[0]=0;for(var l=1;l<1e3;l+=1){var d=o[(l-1)*T],P=o[(l-1)*T+1],A=o[(l-1)*T+2],S=o[l*T],p=o[l*T+1],v=o[l*T+2],m=Math.sqrt((S-d)*(S-d)+(p-P)*(p-P)+(v-A)*(v-A));u[l]=u[l-1]+m}return t.cumulative_length=u,t},t.spline_point=function(e,t,r){r||(r=[]),t=E(e,t);var _=e.cpoints,n=e.is_3d?4:3,o=e.weights,i=e.knot,s=e.order,c=_.length/n,l=c+s;i[l-1]-t<5e-6&&(t=i[l-1]);var T=new Float32Array(c);a(s,t,i,o,T);for(var u=0;u<n;u++){r[u]=0;for(var d=0;d<c;d++)r[u]+=T[d]*_[n*d+u]}return r},t.spline_derivative=function(e,t,r){r||(r=[]);var a=e.cpoints,n=e.is_3d?4:3,o=e.weights,i=e.knot,s=e.order,c=a.length/n,E=c+s;i[E-1]-t<5e-6&&(t=i[E-1]);var l=new Float32Array(c);_(s,t,i,o,l);for(var T=0;T<n;T++){r[T]=0;for(var u=0;u<c;u++)r[T]+=l[u]*a[n*u+T]}return r},t.spline_max_t=l,t.spline_length=T,t.spline_len_to_t=function(e,t){if(t<=0)return 0;var r=l(e);if(t>=T(e))return r;var a=e.cumulative_length,_=o.F(a,t,0,a.length-1);return r*(_+(t-a[_])/(a[_+1]-a[_]))/1e3},t.linear_interpolation=function(e,t,r,a,_){return r+(_-a)*(e-r)/(t-a)},t.linear=function(e,t,r){var a=t[0],_=t[1],n=r[0],o=r[1],i=(o-_)/(n-a);return i*e+(_-i*a)},t.bezier=function(e,t,r,a,_,n){return d(u(0,1,e,t[0],r[0],a[0],_[0],n),t[1],r[1],a[1],_[1])},t.calchandle_curvemap=function(e,t,r,a,_){var n=new Float32Array(3),o=new Float32Array(3),s=new Float32Array(3),c=new Float32Array(3),E=new Float32Array(3),l=new Float32Array(3);i.copy(e[1],o),null==t?(i.copy(r[1],s),n[0]=2*o[0]-s[0],n[1]=2*o[1]-s[1]):i.copy(t[1],n),null==r?(i.copy(t[1],n),s[0]=2*o[0]-n[0],s[1]=2*o[1]-n[1]):i.copy(r[1],s),i.subtract(o,n,c),i.subtract(s,o,E);var T=i.length(c),u=i.length(E);if(0==T&&(T=1),0==u&&(u=1),"AUTO"==a||"AUTO"==_){l[0]=E[0]/u+c[0]/T,l[1]=E[1]/u+c[1]/T;var d=2.5614*i.length(l);0!=d&&("AUTO"==a&&(T/=d,i.scaleAndAdd(o,l,-T,e[0])),"AUTO"==_&&(u/=d,i.scaleAndAdd(o,l,u,e[2])))}"VECTOR"==a&&i.scaleAndAdd(o,c,-1/3,e[0]),"VECTOR"==_&&i.scaleAndAdd(o,E,1/3,e[2])},t.correct_bezpart=function(e,t,r,a){var _,n,o,i,s=[],c=[];s[0]=e[0]-t[0],s[1]=e[1]-t[1],c[0]=a[0]-r[0],c[1]=a[1]-r[1],o=a[0]-e[0],_=Math.abs(s[0]),n=Math.abs(c[0]),_+n!=0&&_+n>o&&(i=o/(_+n),t[0]=e[0]-i*s[0],t[1]=e[1]-i*s[1],r[0]=a[0]-i*c[0],r[1]=a[1]-i*c[1])}}var _=r(0),n=r(5),o=r(2),i=r(3),s=Object(_.a)("__curve",a);t.a=s},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(i.a)(e),_=Object(o.a)(e),E=Object(s.a)(e),l=Object(c.a)(e);t.P_LOW=r.P_LOW,t.P_HIGH=r.P_HIGH,t.P_ULTRA=r.P_ULTRA,t.P_CUSTOM=r.P_CUSTOM,t.P_AUTO=r.P_AUTO,t.set=r.set,t.get=r.get,t.reset=r.reset,t.reset_limits=r.reset_limits,t.get_std_assets_path=r.get_assets_path,t.get_assets_path=r.get_assets_path,t.apply_quality=function(e){if(E.is_primary_loaded())return void l.error("Cannot change quality profile after a scene is loaded.");r.set("quality",e),_.get_gl()&&(r.apply_quality(),a.set_hardware_defaults(_.get_gl(),!1))}}var _=r(0),n=r(4),o=r(70),i=r(38),s=r(46),c=r(1),E=Object(_.a)("config",a);t.a=E},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e);t.load=r.load,t.unload=function(e){e|=0,r.unload(e)},t.set_debug_resources_root=r.set_debug_resources_root,t.is_primary_loaded=r.is_primary_loaded,t.is_idle=a.is_finished,t.load_and_add_new=r.load,t.cleanup=t.unload,t.activate_media=r.activate_media,t.prefetch=r.prefetch,t.unfetch=r.unfetch}var _=r(0),n=r(46),o=r(69),i=Object(_.a)("data",a);t.a=i},function(e,t,r){"use strict";function a(e,t){function r(e,t,r,a){Te.group(Se.subs_label(e),a);for(var _=0;_<r.length;_++){var n=r[_],o=n.render;if(o.type==a)for(var i=!1,s=0;s<t.length;s++){for(var c=t[s].bundles,E=0;E<c.length;E++){var l=c[E];if(l.do_render&&l.obj_render==o){"STATIC"==a?Te.log_raw(n.origin_name,n):Te.log_raw(n.name,n),i=!0;break}}if(i)break}}Te.groupEnd()}function a(e,t){var r=oe.get_debug_shaders();if(!r)return void Te.warn("WEBGL_debug_shaders extension not found");var a=r.getTranslatedShaderSource(e),_=r.getTranslatedShaderSource(t);if(V.detect_mobile()){a=a.replace("#version","#version 300 //"),_=_.replace("#version","#version 300 //");var o=G("/analyze_shader/vert_gles",a),i=G("/analyze_shader/frag_gles",_)}else{a=a.replace("#version","#version 400 //"),_=_.replace("#version","#version 400 //");var o=G("/analyze_shader/vert",a),i=G("/analyze_shader/frag",_)}var s=n(o),c=n(i);return{vsrc:Z.get_gl().getShaderSource(e),vsrc_trans:a,vout:o,vstats:s,fsrc:Z.get_gl().getShaderSource(t),fsrc_trans:_,fout:i,fstats:c}}function n(e){var t={};if(!e)return t;for(var r=e.split("\n"),a=0;a<r.length;a++){var _=r[a];if(-1!=_.search(new RegExp(/^[A-Z.]+ ?/))){var n=_.split(" ")[0];n in t||(t[n]=0),t[n]++}}var o=0,i=0,s=0;for(var n in t)switch(n){case"KIL":case"TEX":case"TXB":case"TXP":case"KIL.F":case"TEX.F":case"TXB.F":case"TXD.F":case"TXL.F":case"TXQ.F":case"TXP.F":i+=t[n],o+=t[n];break;case"ATTRIB":s+=t[n];break;case"ADDRESS":case"PARAM":case"TEMP":case"ALIAS":case"OUTPUT":case"END":break;default:o+=t[n]}return t.ALL_OPS=o,t.TEX_OPS=i,t.ATTRIBS=s,t}function G(e,t){var r=new XMLHttpRequest;if(r.open("POST",e,!1),r.send(t),200==r.status)return r.responseText;throw Te.error(r.responseText),"Error POST XHR: "+r.status}function k(e){e.sort(function(e,t){return t.fstats.ALL_OPS-e.fstats.ALL_OPS});for(var t=0;t<e.length;t++){var r=e[t],a=r.fstats,_=r.vstats,n=K(r.cshader);n=n.length?"\t\t("+n.join(", ")+")":"\t\t(NA)",Te.groupCollapsed("VERT ->","OPS",_.ALL_OPS,"ATT",_.ATTRIBS,"TEX",_.TEX_OPS,"\t\tFRAG ->","OPS",a.ALL_OPS,"TEX",a.TEX_OPS,n),Te.groupCollapsed("directives");for(var o=r.shaders_info.directives.slice().sort(),i=0;i<o.length;i++){var s=o[i];Te.log_raw(s[0],s[1])}Te.groupEnd(),Te.groupCollapsed("node elements");for(var c=r.shaders_info.node_elements,i=0;i<c.length;i++)Te.log_raw(c[i]);Te.groupEnd(),Te.groupCollapsed("vert source"),Te.log_raw(r.vsrc),Te.groupEnd(),Te.groupCollapsed("vert translated source"),Te.log_raw(r.vsrc_trans),Te.groupEnd();var E=["ALL_OPS","TEX_OPS","ATTRIBS"];Te.groupCollapsed("vert ops stats");for(var l in _)-1==E.indexOf(l)&&Te.log_raw(l,_[l]);Te.groupEnd(),Te.groupCollapsed("vert assembly"),Te.log_raw(r.vout),Te.groupEnd(),Te.groupCollapsed("frag source"),Te.log_raw(r.fsrc),Te.groupEnd(),Te.groupCollapsed("frag translated source"),Te.log_raw(r.fsrc_trans),Te.groupEnd(),Te.groupCollapsed("frag ops stats");for(var l in a)-1==E.indexOf(l)&&Te.log_raw(l,a[l]);Te.groupEnd(),Te.groupCollapsed("frag assembly"),Te.log_raw(r.fout),Te.groupEnd(),Te.groupEnd()}}function K(e){for(var t=[],r=de.get_all_scenes(),a=0;a<r.length;a++)for(var _=r[a],n=ce.get_scene_objs(_,"MESH",ce.DATA_ID_ALL),o=0;o<n.length;o++){var i=n[o],s=Ee.get_scene_data(i,_);if(s&&s.batches.length)for(var c=s.batches,E=0;E<c.length;E++){var l=c[E];if(l.shader==e)for(var T=0;T<l.material_names.length;T++){var u=l.material_names[T];-1==t.indexOf(u)&&t.push(u)}}}return t}function B(e,t){var r=function(){return Le.push(r),e.apply(e,arguments)};return r}function X(e,t,r,a,_){if(typeof t!=typeof e)throw"debug.eqv: wrong expected data type";if(e.length!=t.length)throw"debug.eqv: wrong expected vector length";r=r||Ye;for(var n=0;n<e.length;n++){if("number"!=typeof t[n]||isNaN(t[n]))throw"debug.eqv: wrong expected data type";if("number"!=typeof e[n]||isNaN(e[n]))throw"debug.eqv: wrong result data type";if(t[n]>e[n]+r||t[n]<e[n]-r)throw"debug.eqv: wrong result"}j(a,_,"eqv")}function j(e,t,r){if(e=e||"",t=t||"",Ue){if(""==e)throw"debug."+r+': no error is expected, but got "'+ye+'"';if(ye!=e)throw"debug."+r+': error "'+e+'" is expected, but got "'+ye+'"'}else if(""!=e)throw"debug."+r+': error "'+e+'" is expected, but got nothing';if(xe){if(""==t)throw"debug."+r+': no warning is expected, but got "'+Me+'"';if(Me!=t)throw"debug."+r+': warning "'+t+'" is expected, but got "'+Me+'"'}else if(""!=t)throw"debug."+r+': warning "'+t+'" is expected, but got nothing';xe=!1,Ue=!1}function H(){Ie&&(ce.obj_switch_cleanup_flags(Ie,!1,!1,!1),$.prepare_object_unloading(Ie),ce.obj_switch_cleanup_flags(Ie,!0,!0,!0),ce.remove_object(Ie),Ie=null)}var Q=Object(o.a)(e),z=Object(i.a)(e),q=Object(s.a)(e),V=Object(E.a)(e),W=Object(l.a)(e),J=Object(T.a)(e),Z=Object(c.a)(e),$=Object(u.a)(e),ee=Object(d.a)(e),te=Object(f.a)(e),re=Object(P.a)(e),ae=Object(A.a)(e),_e=Object(S.a)(e),ne=Object(p.a)(e),oe=Object(v.a)(e),ie=Object(m.a)(e),se=Object(O.a)(e),ce=Object(N.a)(e),Ee=Object(g.a)(e),le=Object(h.a)(e),Te=Object(R.a)(e),ue=Object(I.a)(e),de=Object(b.a)(e),fe=Object(Y.a)(e),Pe=Object(L.a)(e),Ae=Object(M.a)(e),Se=Object(y.a)(e),pe=Object(U.a)(e),ve=Object(x.a)(e),me=Object(w.a)(e),Oe=C.b(),Ne=new Float32Array(2),ge=F.create(),he=F.create(),Re=F.create(),Ie=null,be=q.defaults,Ye=1e-6,Le=[],Me="",ye="",xe=!1,Ue=!1,we=!0,Ce=new Uint8Array(4);t.DV_NONE=ae.DV_NONE,t.DV_OPAQUE_WIREFRAME=ae.DV_OPAQUE_WIREFRAME,t.DV_TRANSPARENT_WIREFRAME=ae.DV_TRANSPARENT_WIREFRAME,t.DV_FRONT_BACK_VIEW=ae.DV_FRONT_BACK_VIEW,t.DV_BOUNDINGS=ae.DV_BOUNDINGS,t.DV_CLUSTERS_VIEW=ae.DV_CLUSTERS_VIEW,t.DV_BATCHES_VIEW=ae.DV_BATCHES_VIEW,t.DV_RENDER_TIME=ae.DV_RENDER_TIME,t.physics_stats=function(){le.debug_workers()},t.physics_id=function(e){Te.log("O",le.find_obj_by_body_id(e));var t=le.get_active_scene();if(!t)return void Te.error("No active physics scene.");for(var r=t._physics.bundles,a=0;a<r.length;a++){var _=r[a];_.physics.body_id==e&&Te.log("B",_)}},t.visible_objects=function(){for(var e=de.get_active(),t=ce.get_scene_objs(e,"MESH",ce.DATA_ID_ALL),a=de.subs_array(e,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),_=0;_<a.length;_++){var n=a[_],o=n.draw_data;o.length&&(r(n,o,t,"DYNAMIC"),r(n,o,t,"STATIC"))}},t.object_info=function(e){for(var t=de.get_active(),r=ce.get_scene_objs(t,"MESH",ce.DATA_ID_ALL),a=0;a<r.length;a++){var _=r[a];if(_.name==e){Te.log("Object",_);for(var n=de.get_all_subscenes(t),o=0;o<n.length;o++){for(var i=n[o],s=[],c=i.draw_data,E=0;E<c.length;E++)for(var l=c[E].bundles,T=0;T<l.length;T++)l[T].obj_render==_.render&&s.push(l[T]);Te.log("Subscene "+i.type,s)}}}},t.objects_stat=function(){var e=de.get_active();Te.log("Armatures: "+ce.get_scene_objs(e,"ARMATURE",ce.DATA_ID_ALL).length),Te.log("Cameras: "+ce.get_scene_objs(e,"CAMERA",ce.DATA_ID_ALL).length),Te.log("Curves: "+ce.get_scene_objs(e,"CURVE",ce.DATA_ID_ALL).length),Te.log("Empties: "+ce.get_scene_objs(e,"EMPTY",ce.DATA_ID_ALL).length),Te.log("Lamps: "+ce.get_scene_objs(e,"LAMP",ce.DATA_ID_ALL).length),Te.log("Meshes: "+ce.get_scene_objs(e,"MESH",ce.DATA_ID_ALL).length),Te.log("Speakers: "+ce.get_scene_objs(e,"SPEAKER",ce.DATA_ID_ALL).length)},t.num_vertices=function(){for(var e=0,t=de.get_active(),r=de.subs_array(t,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),a=0;a<r.length;a++)for(var _=r[a],n=_.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var c=i[s].batch;c&&(e+=c.num_vertices)}return e},t.num_triangles=function(){for(var e=0,t=de.get_active(),r=de.subs_array(t,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),a=0;a<r.length;a++)for(var _=r[a],n=_.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var c=i[s].batch;c&&(e+=c.num_triangles)}return e},t.num_draw_calls=function(){for(var e=de.get_active(),t=de.subs_array(e,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW,Se.MAIN_PLANE_REFLECT,Se.MAIN_PLANE_REFLECT_BLEND]),r=0,a=0;a<t.length;a++)for(var _=t[a],n=_.draw_data,o=0;o<n.length;o++)r+=n[o].bundles.length;for(var i=de.subs_array(e,[Se.MAIN_CUBE_REFLECT,Se.MAIN_CUBE_REFLECT_BLEND]),a=0;a<i.length;a++)for(var _=i[a],n=_.draw_data,o=0;o<n.length;o++)r+=6*n[o].bundles.length;return r},t.num_shaders=function(){var e=Ae.get_compiled_shaders();return D._8(e)},t.geometry_stats=function(){for(var e=de.get_active(),t=de.get_all_subscenes(e),r={},a=0;a<t.length;a++){var _=t[a];if(_.type!=Se.SINK&&_.type!=Se.DEBUG_VIEW)for(var n=_.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var c=i[s].batch,E=i[s].obj_render;c&&(_.type!=Se.COLOR_PICKING&&_.type!=Se.OUTLINE_MASK||E.origin_selectable||E.origin_outlining)&&(r[c.id]=c)}}var l=0,T=0;for(var u in r){var d=r[u].bufs_data;d.debug_ibo_bytes&&(T+=d.debug_ibo_bytes/1048576),l+=d.debug_vbo_bytes/1048576}return{vbo_memory:l,ibo_memory:T}},t.num_textures=function(){for(var e=[],t=0,r=de.get_active(),a=de.subs_array(r,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),_=0;_<a.length;_++)for(var n=a[_],o=n.draw_data,i=0;i<o.length;i++)for(var s=o[i].bundles,c=0;c<s.length;c++){var E=s[c].batch;if(E)for(var l=E.textures,T=0;T<l.length;T++){var u=l[T];if("IMAGE"===u.source||"ENVIRONMENT_MAP"===u.source){var d=u.w_texture;if(-1===e.indexOf(d)){e.push(d);var f=u.width*u.height*4/1048576/u.compress_ratio;f*=1.3333,t+=f}}}}return{number:e.length,memory:t}},t.num_render_targets=function(){for(var e=[],t=0,r=de.get_active(),a=de.get_all_subscenes(r),_=0;_<a.length;_++){var n=a[_];if(n.type!=Se.SINK){var o=n.camera,i=[o.color_attachment,o.depth_attachment];i.push.apply(i,n.textures_internal);for(var s=0;s<i.length;s++){var c=i[s];ve.is_texture(c)&&-1==e.indexOf(c)&&(e.push(c),t+=o.width*o.height*ve.get_texture_texel_size(c))}}}return{number:e.length,memory:t/1024/1024}},t.make_camera_frustum_shot=function(){var e=de.get_active(),t=de.get_subs(e,Se.MAIN_OPAQUE);t&&de.make_frustum_shot(t.camera,t,[1,1,0])},t.make_light_frustum_shot=function(){var e=de.get_active(),t=de.get_subs(e,Se.MAIN_OPAQUE),r=de.subs_array(e,[Se.SHADOW_CAST]);if(t)for(var a=0;a<r.length;a++){var _,n=r[a];switch(a){case 0:_=[1,0,0];break;case 1:_=[0,1,0];break;case 2:_=[0,0,1];break;default:_=[1,0,1]}de.make_frustum_shot(n.camera,t,_)}},t.scenegraph_to_dot=function(){for(var e=de.get_all_scenes(),t=0;t<e.length;t++){var r=e[t],a=de.get_graph(r);Te.log("\n"+fe.debug_convert_to_dot(a))}},t.loading_graph_to_dot=function(e){e|=0,Te.log("\n"+se.graph_to_dot(e))},t.controls_info=W.debug,t.object_distance=function(e,t){var r=C.j(e.render.world_tsr,ge),a=C.j(t.render.world_tsr,he);return F.dist(r,a)},t.msg=function(){_e.msg.apply(_e,arguments)},t.fbmsg=function(){_e.fbmsg.apply(_e,arguments)},t.print_telemetry=function(){_e.print_telemetry.apply(_e,arguments)},t.plot_telemetry=function(){_e.plot_telemetry.apply(_e,arguments)},t.fbres=function(e,t){t||(t=16);var r=function(){_e.fbmsg("FBRES",e()),setTimeout(r,t)};r()},t.assert_constants=function(){var e=new Float32Array(3),t=new Float32Array([0,0,0,1]),r=new Float32Array([1,0,0]),a=new Float32Array([0,1,0]),_=new Float32Array([0,0,1]),n=new Float32Array([-1,0,0]),o=new Float32Array([0,-1,0]),i=new Float32Array([0,0,-1]);if(!D.P(e,D.m))throw"Wrong VEC3_IDENT";if(!D.P(t,D.k))throw"Wrong QUAT4_IDENT";if(!D.P(r,D.d))throw"Wrong AXIS_X";if(!D.P(a,D.e))throw"Wrong AXIS_Y";if(!D.P(_,D.f))throw"Wrong AXIS_Z";if(!D.P(n,D.a))throw"Wrong AXIS_MX";if(!D.P(o,D.b))throw"Wrong AXIS_MY";if(!D.P(i,D.c))throw"Wrong AXIS_MZ"},t.mute_music=function(){for(var e=Pe.get_speaker_objects(),t=0;t<e.length;t++){var r=e[t];"BACKGROUND_MUSIC"==Pe.get_spk_behavior(r)&&Pe.mute(r,!0)}},t.check_finite=function(e){return re.finite(e)},t.set_debug_params=function(e){var t=de.get_active(),r=de.subs_array(t,[Se.DEBUG_VIEW]);if(!r.length)return void Te.error("Debugging is not available on the scene.");for(var a=0;a<r.length;a++){var _=r[a];if("number"==typeof e.debug_view_mode)switch(e.debug_view_mode){case ae.DV_NONE:case ae.DV_OPAQUE_WIREFRAME:case ae.DV_TRANSPARENT_WIREFRAME:case ae.DV_FRONT_BACK_VIEW:case ae.DV_BOUNDINGS:case ae.DV_CLUSTERS_VIEW:case ae.DV_BATCHES_VIEW:case ae.DV_RENDER_TIME:de.set_debug_view_mode(_,e.debug_view_mode);break;default:Te.error("set_debug_params(): Wrong debug view mode")}"number"==typeof e.debug_colors_seed&&de.set_debug_colors_seed(_,e.debug_colors_seed),"number"==typeof e.render_time_threshold&&de.set_render_time_threshold(_,e.render_time_threshold),"object"==typeof e.wireframe_edge_color&&de.set_wireframe_edge_color(_,D._1(e.wireframe_edge_color))}},t.get_error_quantity=function(){return Te.get_error_count()},t.get_warning_quantity=function(){return Te.get_warning_count()},t.clear_errors_warnings=function(){return Te.clear_errors_warnings()},t.analyze_shaders=function(e){var t=Ae.get_compiled_shaders(),r=0;for(var _ in t)e&&-1===_.indexOf(e)||r++;var n="of "+r+" analyzing...",o={};for(var _ in t)if(!e||-1!==_.indexOf(e)){var i=t[_],s=a(i.vshader,i.fshader);if(s){var c=i.shaders_info,E=c.vert+" + "+c.frag;s.cshader=i,s.shaders_info=c;var l=o[E]=o[E]||[];l.push(s),Te.log_raw(n)}}for(var E in o){Te.group("%c"+E,"color: #800");var l=o[E];k(l),Te.groupEnd()}},t.fake_load=function(e,t,r,a,_){e=e||null,e||Q.panic("Stage load callback is undefined"),t=t||5e3,r=r||0,a=a||100,a>100&&Q.panic("Max percentage must be less than 100"),r<0&&Q.panic("Min percentage must be greater than 0"),r>a&&Q.panic("Max percentage must be greater than min percentage");var n=pe.animate(r,a,t,function(t){var r=t.toFixed();if(e(r),100==r)return pe.clear_animation(n),void(_&&_())})},t.test_performance=function(e){if(!Ae.check_shaders_loaded())return void window.setTimeout(function(){t.test_performance(e)},100);if(!oe.get_disjoint_timer_query())return void e(0,0);var r=be.gl_debug;be.gl_debug=!0;var a=fe.create_performance_graph();de.generate_auxiliary_batches(null,a);for(var _=fe.find_subs(a,Se.PERFORMANCE),n=_.camera,o=0;o<5;o++)ue.draw(_);be.gl_debug=r,window.setTimeout(function(){ne.process_timer_queries(_);var t=_.debug_render_time,r=n.width*n.height*4*10/(t/1e3)/Math.pow(10,9);e(t,r)},100)},t.calc_vbo_garbage_byte_size=ee.calc_vbo_garbage_byte_size,t.show_vbo_garbage_info=ee.show_vbo_garbage_info,t.print_batches_stat=function(){te.print_batches_stat()},t.start_debug=function(e){Le=[],we=!0,"string"===typeof e&&(e=_.a.require(e));for(var t in e)"function"===typeof e[t]&&(e[t]=B(e[t],t))},t.check_debug_result=function(){return we},t.test=function(e,t){var r=Te.error,a=Te.error_once,_=Te.warn;Te.error=Te.error_once=function(){var e=Te.compose_args_prefix(arguments,"B4W ERROR");ye=e.join(" "),Ue=!0},Te.warn=function(){var e=Te.compose_args_prefix(arguments,"B4W WARN");Me=e.join(" "),xe=!0},xe=!1,Ue=!1;try{t();var n=!0}catch(t){we=!1,console.error('Test "'+e+'" failed with exception: "'+t+'"');var n=!1;xe=!1,Ue=!1}return Te.error=r,Te.error_once=a,Te.warn=_,n},t.pix=function(e){var t=J.get_viewport_width(),r=J.get_viewport_height(),a=t/2,_=r/2;J.resize(t,r,!1);var n=de.get_active(),o=n._render.graph,i=fe.find_on_screen(o);i||Q.panic("Couldn't find onscreen subscene");var s=i.camera,c=J.canvas_to_viewport_coords(a,_,Ne,i.camera);c[1]=s.height-c[1],X(e,ue.read_pixels(s.framebuffer,c[0],c[1],1,1,Ce),1)},t.eqs=function(e,t,r,a){if(JSON.stringify(e)!=JSON.stringify(t))throw"debug.eqs: wrong result";j(r,a,"eqs")},t.eqv=X,t.eqf=function(e,t,r,a,_){if("number"!=typeof t||isNaN(t))throw"debug.eqf: wrong expected data type";if("number"!=typeof e||isNaN(e))throw"debug.eqf: wrong result data type";if(r=r||Ye,t>e+r||t<e-r)throw"debug.eqf: wrong result";j(a,_,"eqf")},t.eq=function(e,t,r,a){if(e!==t)throw"debug.eq: wrong result";j(r,a,"eq")},t.ok=function(e,t,r){if(!Boolean(e))throw"debug.ok: wrong result";j(t,r,"ok")},t.stat=function(e){var t=[];"string"===typeof e&&(e=_.a.require(e));for(var r in e)-1==Le.indexOf(e[r])&&"function"===typeof e[r]&&t.push(r);if(t.length){Te.groupCollapsed(t.length+" function(s) not tested.");for(var a=0;a<t.length;a++)Te.log_raw(t[a]);Te.groupEnd()}else Te.group("All functions were tested.")},t.show_normals=function(e,t,r,a){H();var _=z.find_batch_material(e,t,"MAIN");if(!ie.has_dyn_geom(e)||!_)return Te.error("Normals are not avaliable for the dynamic object:",e.name),!1;var n=_.bufs_data;if(!(n&&n.pointers&&n.pointers.a_position&&n.pointers.a_tbn))return Te.error("Normals are not avaliable for the object:",e.name),!1;var o=ie.extract_array_float(n,"a_position"),i=ie.extract_array_float(n,"a_normal"),s=me.get_tsr(e,Oe),c=C.i(s,Re),E=F.inverse(c,Re),l=F.multiply(E,E,Re);Ie=ce.create_line("normal_line");for(var T=new Float32Array(2*o.length),u=0;u<o.length;u+=3){var d=ge;d[0]=o[u+0],d[1]=o[u+1],d[2]=o[u+2];var f=C.D(d,s,he);T[2*u+0]=f[0],T[2*u+1]=f[1],T[2*u+2]=f[2];var P=i.subarray(u,u+3),A=F.multiply(P,l,he);A=F.normalize(A,A),P=F.scale(A,r,he);var S=F.add(d,P,he),p=C.D(S,s,he);T[2*u+3]=p[0],T[2*u+4]=p[1],T[2*u+5]=p[2]}var v=z.get_first_batch(Ie);ie.draw_line(v,T,!0),ue.assign_attribute_setters(v),v.diffuse_color.set([1,1,1,1]),v.line_width=a},t.hide_normals=H}var _=r(35),n=r(0),o=r(5),i=r(16),s=r(4),c=r(70),E=r(38),l=r(56),T=r(15),u=r(46),d=r(78),f=r(121),P=r(48),A=r(49),S=r(67),p=r(79),v=r(29),m=r(20),O=r(69),N=r(12),g=r(9),h=r(19),R=r(1),I=r(22),b=r(10),Y=r(61),L=r(23),M=r(37),y=r(11),x=r(17),U=r(18),w=r(13),C=r(6),D=r(2),F=r(3),G=Object(n.a)("debug",a);t.a=G},function(e,t,r){"use strict";function a(e,t){function r(e,t,r){var _=a.get_canvas();if(_.toBlob)_.toBlob(e,t,r);else{for(var n=atob(_.toDataURL(t,r).split(",")[1]),o=new Uint8Array(n.length),i=0;i<n.length;i++)o[i]=n.charCodeAt(i);e(new Blob([o],{type:t||"image/png"}))}}var a=Object(n.a)(e),_={callback:null,format:"image/png",quality:1,blob_url:"",last_auto_revoke:!1,curr_auto_revoke:!1};t.canvas_data_url=function(e,t,r,a){_.curr_auto_revoke="undefined"!==typeof a||a,_.last_auto_revoke=_.curr_auto_revoke,_.callback=e,_.format=t||_.format,_.quality=r||_.quality},t.frame=function(e,t){var a=_.callback;a&&(_.last_auto_revoke&&_.blob_url&&URL.revokeObjectURL(_.blob_url),r(function(e){navigator.msSaveOrOpenBlob?a(e):(_.blob_url=URL.createObjectURL(e),a(_.blob_url))},_.format,_.quality),_.callback=null,_.format="image/png",_.quality=1)}}var _=r(0),n=r(15),o=Object(_.a)("__main",a);t.a=o},function(e,t,r){"use strict";function a(e,t){var r=Object(i.a)(e);t.create=o.b,t.from_values=o.e,t.copy=o.a,t.identity=o.m,t.set_sep=o.t,t.set_trans=o.v,t.set_scale=o.s,t.set_transcale=function(e,t){return r.error_once("set_transcale is deprecated, use the tsr.set_trans and tsr.set_scale functions instead."),o.w(e,t)},t.set_quat=o.r,t.get_trans_view=function(e){return r.error_once("get_trans_view is deprecated, use the tsr.get_trans functions."),o.k(e)},t.get_trans=o.j,t.get_scale=o.i,t.get_quat_view=function(e){return r.error_once("get_quat_view is deprecated, use the tsr.get_quat functions."),o.h(e)},t.get_quat=o.g,t.invert=o.p,t.to_mat4=function(e,t){return t||(t=n.create()),o.x(e,t),t},t.from_mat4=o.d,t.multiply=o.q,t.transform_vec3=o.D,t.transform_vec3_inv=o.E,t.transform_vectors=o.F,t.transform_dir_vectors=o.z,t.transform_dir_vec3=o.y,t.transform_tangents=o.C,t.translate=o.G,t.interpolate=function(e,t,r,a){return a||(a=o.b()),o.o(e,t,r,a),a}}var _=r(0),n=r(21),o=r(6),i=r(1),s=Object(_.a)("tsr",a);t.a=s},function(e,t,r){"use strict";function a(e,t){function r(){d.remove_sensor_manifold(null,"VR_CONTROLLERS")}function a(e,t){function r(t,r,a){if(a>0){var n=P.get_active_camera();if(!n)return;if(_.is_eye_camera(n)){var o=d.get_sensor_payload(t,r,1),i=d.get_sensor_payload(t,r,2),c=u.add(i,x,h);if(S.set_translation_v(n,c),o)if(e==w){o=s.multiply(y,o,M);var E=u.transformQuat(p.AXIS_MY,o,h);_.set_vertical_axis(n,E),S.set_rotation_v(n,o)}else if(e==C||e==D){var l=S.get_rotation(n,Y),T=s.invert(l,Y),f=s.multiply(v,T,Y),A=_.get_vertical_axis(n,h);if(Math.abs(A[2])<Math.PI/4)var O=u.cross(A,p.AXIS_MY,R);else if(Math.abs(A[1])<Math.PI/4)var O=u.cross(A,p.AXIS_Z,R);u.normalize(O,O);var N=u.transformQuat(O,f,I),g=u.dot(A,N),U=u.scaleAndAdd(N,A,-g,I);u.normalize(U,U);var F=u.cross(A,O,h),G=Math.acos(p.clamp(u.dot(O,U),0,1)),k=p.sign(u.dot(U,F)),K=G*k;m+=K;var B=s.setAxisAngle(p.AXIS_Z,-m,Y);if(e==D)var X=s.multiply(B,o,b);else var j=p.quat_project(o,p.AXIS_MZ,p.AXIS_Z,p.AXIS_Y,L),H=s.invert(j,L),Q=s.multiply(H,o,L),X=s.multiply(B,Q,b);var E=u.transformQuat(p.AXIS_MY,X,h);_.set_vertical_axis(n,E),S.set_rotation_v(n,X),s.copy(X,v)}}}}if(t){var a=P.get_active_camera();a&&A.request_split_screen(function(){_.is_eye_camera(a)||(O=_.is_target_camera(a),N=_.is_hover_camera(a),g=_.is_static_camera(a),_.eye_setup(a));var e=d.create_elapsed_sensor(),n=d.create_hmd_position_sensor();v=S.get_rotation(a,v),d.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",d.CT_CONTINUOUS,[e,t,n],null,r)})}}var _=Object(n.a)(e),d=Object(o.a)(e),f=Object(i.a)(e),P=Object(c.a)(e),A=Object(E.a)(e),S=Object(l.a)(e),p=Object(T.a)(e),v=s.create(),m=0,O=!1,N=!1,g=!1,h=u.create(),R=u.create(),I=u.create(),b=s.create(),Y=s.create(),L=s.create(),M=s.create(),y=s.create(),x=u.create(),U={pivot:u.create()};t.HMD_NONE_MOUSE_ALL_AXES=0;var w=1;t.HMD_ALL_AXES_MOUSE_NONE=w;var C=2;t.HMD_ROLL_PITCH_MOUSE_YAW=C;var D=3;t.HMD_ALL_AXES_MOUSE_YAW=D,t.enable_hmd=function(e){var t=null,r=f.get_device_by_type_element(f.DEVICE_HMD);r&&(t=f.get_value_param(r,f.HMD_WEBVR_TYPE)&(f.HMD_WEBVR_MOBILE|f.HMD_WEBVR_DESKTOP|f.HMD_WEBVR1)?d.create_hmd_quat_sensor():d.create_gyro_quat_sensor(),a(e,t))},t.check_browser_support=function(){return Boolean(f.can_use_device(f.DEVICE_HMD))},t.enable_controllers=function(e,t){function a(r,a,_){if(e){var n=d.get_sensor_payload(r,a,0),o=d.get_sensor_payload(r,a,2);u.add(x,n,n),S.set_translation_v(e,n),S.set_rotation_v(e,o)}if(t){var i=d.get_sensor_payload(r,a,1),s=d.get_sensor_payload(r,a,3);u.add(x,i,i),S.set_translation_v(t,i),S.set_rotation_v(t,s)}}if(r(),e||t){var _=f.get_vr_controller_id(0),n=d.create_gamepad_position_sensor(_),o=d.create_gamepad_orientation_sensor(_),i=f.get_vr_controller_id(1),s=d.create_gamepad_position_sensor(i),c=d.create_gamepad_orientation_sensor(i);d.create_sensor_manifold(null,"VR_CONTROLLERS",d.CT_CONTINUOUS,[n,s,o,c],null,a)}},t.disable_controllers=r,t.disable_hmd=function(){if(d.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){d.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA"),A.exit_split_screen();var e=P.get_active_camera();O?_.target_setup(e,U):N?_.hover_setup(e,U):g&&_.static_setup(e,U),_.set_vertical_axis(e,p.AXIS_Z);var t=S.get_rotation(e,b);S.set_rotation_v(e,t)}},t.set_rotate_quat=function(e){s.copy(e,y)},t.get_rotate_quat=function(e){return s.copy(y,e),e},t.set_position=function(e){s.copy(e,x)},t.get_position=function(e){return s.copy(x,e),e}}var _=r(0),n=r(36),o=r(24),i=r(52),s=r(8),c=r(31),E=r(53),l=r(44),T=r(26),u=r(3),d=Object(_.a)("hmd",a);t.a=d},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),c=Object(s.a)(e);t.play=function(e,t,r){t=t||0,r=r||0,_.play(e,t,r)},t.play_def=function(e){_.play_def(e)},t.is_playing=function(e){return _.is_playing(e)},t.stop=function(e){_.stop(e)},t.pause=function(e){_.speaker_pause(e)},t.resume=function(e){_.speaker_resume(e)},t.loop_stop=function(e,t,r){t=t||0,r=r||!1,_.loop_stop(e,t,r)},t.playrate=function(e,t){_.playrate(e,t)},t.get_playrate=function(e){return _.get_playrate(e)},t.cyclic=function(e,t){_.cyclic(e,t)},t.is_cyclic=function(e){return _.is_cyclic(e)},t.listener_reset_speed=function(e,t){_.listener_stride()},t.listener_stride=function(){_.listener_stride()},t.speaker_reset_speed=function(e,t,r){_.speaker_stride(e)},t.speaker_stride=function(e){_.speaker_stride(e)},t.get_volume=function(e){return e&&"object"===typeof e?_.get_volume(e):_.get_master_volume()},t.set_volume=function(e,t){e&&"object"===typeof e?_.set_volume(e,t):_.set_master_volume(t)},t.mute=function(e,t){e&&"object"===typeof e?_.mute(e,t):_.mute_master(t)},t.is_muted=function(e){return e&&"object"===typeof e?_.is_muted(e):_.is_master_muted()},t.get_speaker_objects=function(){return _.get_speaker_objects().slice(0)},t.check_active_speakers=_.check_active_speakers,t.set_compressor_params=function(e){_.set_compressor_params(a.get_active(),e)},t.get_compressor_params=function(){return _.get_compressor_params(a.get_active())},t.duck=function(e,t,r){e&&"object"===typeof e?_.duck(e,t,r):_.duck_master(t,r)},t.unduck=function(e){e&&"object"===typeof e?_.unduck(e):_.unduck_master()},t.apply_playlist=_.apply_playlist,t.clear_playlist=_.clear_playlist,t.detect_audio_container=_.detect_audio_container,t.detect_video_container=_.detect_video_container,t.set_positional_params=_.set_positional_params,t.get_positional_params=_.get_positional_params,t.set_filter_params=_.set_filter_params,t.get_filter_params=_.get_filter_params,t.get_filter_freq_response=_.get_filter_freq_response,t.get_duration=function(e){return e&&r.is_speaker(e)?_.get_duration(e):(c.error('Object "'+(e?e.name:void 0)+'" is not a valid speaker'),0)}}var _=r(0),n=r(9),o=r(10),i=r(23),s=r(1),c=Object(_.a)("sfx",a);t.a=c},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e);t.SLOT_0=r.SLOT_0,t.SLOT_1=r.SLOT_1,t.SLOT_2=r.SLOT_2,t.SLOT_3=r.SLOT_3,t.SLOT_4=r.SLOT_4,t.SLOT_5=r.SLOT_5,t.SLOT_6=r.SLOT_6,t.SLOT_7=r.SLOT_7,t.SLOT_ALL=r.SLOT_ALL,t.OBJ_ANIM_TYPE_NONE=r.OBJ_ANIM_TYPE_NONE,t.OBJ_ANIM_TYPE_ARMATURE=r.OBJ_ANIM_TYPE_ARMATURE,t.OBJ_ANIM_TYPE_OBJECT=r.OBJ_ANIM_TYPE_OBJECT,t.OBJ_ANIM_TYPE_VERTEX=r.OBJ_ANIM_TYPE_VERTEX,t.OBJ_ANIM_TYPE_SOUND=r.OBJ_ANIM_TYPE_SOUND,t.OBJ_ANIM_TYPE_PARTICLES=r.OBJ_ANIM_TYPE_PARTICLES,t.OBJ_ANIM_TYPE_MATERIAL=r.OBJ_ANIM_TYPE_MATERIAL,t.OBJ_ANIM_TYPE_STATIC=r.OBJ_ANIM_TYPE_STATIC,t.AB_CYCLIC=r.AB_CYCLIC,t.AB_FINISH_RESET=r.AB_FINISH_RESET,t.AB_FINISH_STOP=r.AB_FINISH_STOP,t.is_animated=function(e){return r.is_animated(e)},t.get_anim_names=function(e){return r.obj_is_animatable(e)?r.get_anim_names(e):[]},t.get_current_anim_name=function(e,t){return r.is_animated(e)?(t=t||r.SLOT_0,r.get_anim_by_slot_num(e,t)):null},t.apply=function(e,t,a){if(a>r.SLOT_7)return void _.error("Can't apply animation to slot "+a+' for object "'+e.name+'". Object can have maximum of 8 animation slots');if(a=a||r.SLOT_0,r.is_animated(e)){var n=r.get_slot_num_by_anim(e,t);if(-1!=n&&n!=a)return void _.error('Animation "'+t+'" is already applied to object "'+e.name+'" (slot "'+n+'").')}if(!r.validate_action_by_name(e,t))return void _.error('No fcurves in action "'+t+'"');r.apply(e,null,t,a)},t.apply_ext=function(e,t,a){if(a>r.SLOT_7)return void _.error("Can't apply animation to slot "+a+' for object "'+e.name+'". Object can have maximum of 8 animation slots');a=a||r.SLOT_0;var n=t[0];if(!r.validate_action_by_name(e,n))return void _.error('No fcurves in action "'+n+'"');var o=t.slice(1);r.apply(e,o,n,a)},t.remove=function(e){r.remove(e)},t.remove_slot_animation=function(e,t){r.is_animated(e)&&(t=t||r.SLOT_0,r.remove_slot_animation(e,t))},t.apply_def=function(e){r.apply_def(e)},t.play=function(e,t,a){if(!r.is_animated(e))return void _.error('Object "'+e.name+'" has no applied animation');a=a||r.SLOT_0,r.play(e,t,a),r.update_object_animation(e,0,a,!0)},t.stop=function(e,t){r.is_animated(e)&&(t=t||r.SLOT_0,r.stop(e,t))},t.is_play=function(e,t){return!!r.is_animated(e)&&(t=t||r.SLOT_0,r.is_play(e,t))},t.set_frame=function(e,t,a){r.is_animated(e)&&(a=a||r.SLOT_0,r.set_frame(e,t,a))},t.set_first_frame=function(e,t){r.is_animated(e)&&r.set_first_frame(e,t)},t.set_last_frame=function(e,t){if(r.is_animated(e)){t=t||r.SLOT_0;var a=r.get_anim_start_frame(e,t),_=r.get_anim_length(e,t);r.set_frame(e,a+_-r.LAST_FRAME_EPSILON,t)}},t.get_frame=function(e,t){return r.is_animated(e)?(t=t||r.SLOT_0,r.get_current_frame_float(e,t)):0},t.set_speed=function(e,t,a){r.is_animated(e)&&(a=a||r.SLOT_0,t=t||1,r.set_speed(e,t,a))},t.get_speed=function(e,t){return r.is_animated(e)?(t=t||r.SLOT_0,e.anim_slots[t]?r.get_speed(e,t):0):0},t.get_anim_start_frame=function(e,t){return r.is_animated(e)?(t=t||r.SLOT_0,e.anim_slots[t]?r.get_anim_start_frame(e,t):-1):-1},t.get_anim_length=function(e,t){return r.is_animated(e)?(t=t||r.SLOT_0,e.anim_slots[t]?r.get_anim_length(e,t):-1):-1},t.set_behavior=function(e,t,a){r.is_animated(e)&&(a=a||r.SLOT_0,r.set_behavior(e,t,a))},t.get_behavior=function(e,t){return r.is_animated(e)?(t=t||r.SLOT_0,r.get_behavior(e,t)):null},t.apply_smoothing=function(e,t,a,_){_=_||r.SLOT_0,r.is_animated(e)&&r.apply_smoothing(e,t,a,_)},t.frame_to_sec=function(e){return r.frame_to_sec(e)},t.get_slot_num_by_anim=function(e,t){return r.is_animated(e)&&t?r.get_slot_num_by_anim(e,t):-1},t.get_anim_type=function(e,t){return r.is_animated(e)?r.get_anim_type(e,t):null},t.apply_to_first_empty_slot=function(e,t){return r.apply_to_first_empty_slot(e,t)},t.get_skel_mix_factor=function(e){return e.render.anim_mix_factor},t.set_skel_mix_factor=function(e,t,n,o){if(!a.is_armature(e))return void _.error("Can't blend animation. Object \""+e.name+'" is not armature');t=Math.min(Math.max(t,0),1),e.render.anim_mix_factor!=t&&(n=n||0,o=o||null,r.set_skel_mix_factor(e,t,n,o))},t.set_skeletal_slots=function(e,t,r,a){t=void 0==t?-1:t,r=void 0==t?-1:r,a=a||0;var _=e.render,n=_.blend_skel_slots;t>=0&&(n[0]=t),r>=0&&(n[1]=r),e.render.anim_mix_factor=a},t.get_first_skeletal_slot=function(e){return e.render.blend_skel_slots[0]},t.get_second_skeletal_slot=function(e){return e.render.blend_skel_slots[1]},t.mix_from_cur_pos=function(e,t,a,_){_=_||null,a=a||0,r.mix_from_cur_pos(e,t,a,_)}}var _=r(0),n=r(41),o=r(9),i=r(1),s=Object(_.a)("animation",a);t.a=s},function(e,t,r){r(92),e.exports=r(97)},function(e,t,r){"use strict";"undefined"===typeof Promise&&(r(93).enable(),window.Promise=r(95)),r(96),Object.assign=r(65)},function(e,t,r){"use strict";function a(){c=!1,i._47=null,i._71=null}function _(e){function t(t){(e.allRejections||o(l[t].error,e.whitelist||s))&&(l[t].displayId=E++,e.onUnhandled?(l[t].logged=!0,e.onUnhandled(l[t].displayId,l[t].error)):(l[t].logged=!0,n(l[t].displayId,l[t].error)))}function r(t){l[t].logged&&(e.onHandled?e.onHandled(l[t].displayId,l[t].error):l[t].onUnhandled||(console.warn("Promise Rejection Handled (id: "+l[t].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+l[t].displayId+".")))}e=e||{},c&&a(),c=!0;var _=0,E=0,l={};i._47=function(e){2===e._83&&l[e._56]&&(l[e._56].logged?r(e._56):clearTimeout(l[e._56].timeout),delete l[e._56])},i._71=function(e,r){0===e._75&&(e._56=_++,l[e._56]={displayId:null,error:r,timeout:setTimeout(t.bind(null,e._56),o(r,s)?100:2e3),logged:!1})}}function n(e,t){console.warn("Possible Unhandled Promise Rejection (id: "+e+"):"),((t&&(t.stack||t))+"").split("\n").forEach(function(e){console.warn("  "+e)})}function o(e,t){return t.some(function(t){return e instanceof t})}var i=r(74),s=[ReferenceError,TypeError,RangeError],c=!1;t.disable=a,t.enable=_},function(e,t,r){"use strict";(function(t){function r(e){o.length||(n(),i=!0),o[o.length]=e}function a(){for(;s<o.length;){var e=s;if(s+=1,o[e].call(),s>c){for(var t=0,r=o.length-s;t<r;t++)o[t]=o[t+s];o.length-=s,s=0}}o.length=0,s=0,i=!1}function _(e){return function(){function t(){clearTimeout(r),clearInterval(a),e()}var r=setTimeout(t,0),a=setInterval(t,50)}}e.exports=r;var n,o=[],i=!1,s=0,c=1024,E="undefined"!==typeof t?t:self,l=E.MutationObserver||E.WebKitMutationObserver;n="function"===typeof l?function(e){var t=1,r=new l(e),a=document.createTextNode("");return r.observe(a,{characterData:!0}),function(){t=-t,a.data=t}}(a):_(a),r.requestFlush=n,r.makeRequestCallFromTimer=_}).call(t,r(75))},function(e,t,r){"use strict";function a(e){var t=new _(_._44);return t._83=1,t._18=e,t}var _=r(74);e.exports=_;var n=a(!0),o=a(!1),i=a(null),s=a(void 0),c=a(0),E=a("");_.resolve=function(e){if(e instanceof _)return e;if(null===e)return i;if(void 0===e)return s;if(!0===e)return n;if(!1===e)return o;if(0===e)return c;if(""===e)return E;if("object"===typeof e||"function"===typeof e)try{var t=e.then;if("function"===typeof t)return new _(t.bind(e))}catch(e){return new _(function(t,r){r(e)})}return a(e)},_.all=function(e){var t=Array.prototype.slice.call(e);return new _(function(e,r){function a(o,i){if(i&&("object"===typeof i||"function"===typeof i)){if(i instanceof _&&i.then===_.prototype.then){for(;3===i._83;)i=i._18;return 1===i._83?a(o,i._18):(2===i._83&&r(i._18),void i.then(function(e){a(o,e)},r))}var s=i.then;if("function"===typeof s){return void new _(s.bind(i)).then(function(e){a(o,e)},r)}}t[o]=i,0===--n&&e(t)}if(0===t.length)return e([]);for(var n=t.length,o=0;o<t.length;o++)a(o,t[o])})},_.reject=function(e){return new _(function(t,r){r(e)})},_.race=function(e){return new _(function(t,r){e.forEach(function(e){_.resolve(e).then(t,r)})})},_.prototype.catch=function(e){return this.then(null,e)}},function(e,t){!function(e){"use strict";function t(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!==typeof e&&(e=String(e)),e}function a(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return A.iterable&&(t[Symbol.iterator]=function(){return t}),t}function _(e){this.map={},e instanceof _?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function n(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function o(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function i(e){var t=new FileReader,r=o(t);return t.readAsArrayBuffer(e),r}function s(e){var t=new FileReader,r=o(t);return t.readAsText(e),r}function c(e){for(var t=new Uint8Array(e),r=new Array(t.length),a=0;a<t.length;a++)r[a]=String.fromCharCode(t[a]);return r.join("")}function E(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"===typeof e)this._bodyText=e;else if(A.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(A.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(A.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(A.arrayBuffer&&A.blob&&p(e))this._bodyArrayBuffer=E(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!A.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!v(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=E(e)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):A.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},A.blob&&(this.blob=function(){var e=n(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?n(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(i)}),this.text=function(){var e=n(this);if(e)return e;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},A.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function T(e){var t=e.toUpperCase();return m.indexOf(t)>-1?t:e}function u(e,t){t=t||{};var r=t.body;if(e instanceof u){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new _(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new _(t.headers)),this.method=T(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function d(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),a=r.shift().replace(/\+/g," "),_=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(_))}}),t}function f(e){var t=new _;return e.split(/\r?\n/).forEach(function(e){var r=e.split(":"),a=r.shift().trim();if(a){var _=r.join(":").trim();t.append(a,_)}}),t}function P(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new _(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var A={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(A.arrayBuffer)var S=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(e){return e&&DataView.prototype.isPrototypeOf(e)},v=ArrayBuffer.isView||function(e){return e&&S.indexOf(Object.prototype.toString.call(e))>-1};_.prototype.append=function(e,a){e=t(e),a=r(a);var _=this.map[e];this.map[e]=_?_+","+a:a},_.prototype.delete=function(e){delete this.map[t(e)]},_.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},_.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},_.prototype.set=function(e,a){this.map[t(e)]=r(a)},_.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},_.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),a(e)},_.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),a(e)},_.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),a(e)},A.iterable&&(_.prototype[Symbol.iterator]=_.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.prototype.clone=function(){return new u(this,{body:this._bodyInit})},l.call(u.prototype),l.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _(this.headers),url:this.url})},P.error=function(){var e=new P(null,{status:0,statusText:""});return e.type="error",e};var O=[301,302,303,307,308];P.redirect=function(e,t){if(-1===O.indexOf(t))throw new RangeError("Invalid status code");return new P(null,{status:t,headers:{location:e}})},e.Headers=_,e.Request=u,e.Response=P,e.fetch=function(e,t){return new Promise(function(r,a){var _=new u(e,t),n=new XMLHttpRequest;n.onload=function(){var e={status:n.status,statusText:n.statusText,headers:f(n.getAllResponseHeaders()||"")};e.url="responseURL"in n?n.responseURL:e.headers.get("X-Request-URL");var t="response"in n?n.response:n.responseText;r(new P(t,e))},n.onerror=function(){a(new TypeError("Network request failed"))},n.ontimeout=function(){a(new TypeError("Network request failed"))},n.open(_.method,_.url,!0),"include"===_.credentials&&(n.withCredentials=!0),"responseType"in n&&A.blob&&(n.responseType="blob"),_.headers.forEach(function(e,t){n.setRequestHeader(t,e)}),n.send("undefined"===typeof _._bodyInit?null:_._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!==typeof self?self:this)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(27),_=r.n(a),n=r(99),o=r.n(n),i=r(103),s=(r.n(i),r(106)),c=r(174);o.a.render(_.a.createElement(s.a,null),document.getElementById("root")),Object(c.a)()},function(e,t,r){"use strict";function a(e,t,r,a,_,n,o,i){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[r,a,_,n,o,i],c=0;e=Error(t.replace(/%s/g,function(){return s[c++]})),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function _(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,_=0;_<t;_++)r+="&args[]="+encodeURIComponent(arguments[_+1]);a(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}function n(e,t,r){this.props=e,this.context=t,this.refs=C,this.updater=r||w}function o(){}function i(e,t,r){this.props=e,this.context=t,this.refs=C,this.updater=r||w}function s(e,t,r){var a=void 0,_={},n=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(n=""+t.key),t)G.call(t,a)&&!k.hasOwnProperty(a)&&(_[a]=t[a]);var i=arguments.length-2;if(1===i)_.children=r;else if(1<i){for(var s=Array(i),c=0;c<i;c++)s[c]=arguments[c+2];_.children=s}if(e&&e.defaultProps)for(a in i=e.defaultProps)void 0===_[a]&&(_[a]=i[a]);return{$$typeof:O,type:e,key:n,ref:o,props:_,_owner:F.current}}function c(e,t){return{$$typeof:O,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===O}function l(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}function T(e,t,r,a){if(B.length){var _=B.pop();return _.result=e,_.keyPrefix=t,_.func=r,_.context=a,_.count=0,_}return{result:e,keyPrefix:t,func:r,context:a,count:0}}function u(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>B.length&&B.push(e)}function d(e,t,r,a){var n=typeof e;"undefined"!==n&&"boolean"!==n||(e=null);var o=!1;if(null===e)o=!0;else switch(n){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case O:case N:o=!0}}if(o)return r(a,e,""===t?"."+P(e,0):t),1;if(o=0,t=""===t?".":t+":",Array.isArray(e))for(var i=0;i<e.length;i++){n=e[i];var s=t+P(n,i);o+=d(n,s,r,a)}else if(null===e||"object"!==typeof e?s=null:(s=U&&e[U]||e["@@iterator"],s="function"===typeof s?s:null),"function"===typeof s)for(e=s.call(e),i=0;!(n=e.next()).done;)n=n.value,s=t+P(n,i++),o+=d(n,s,r,a);else"object"===n&&(r=""+e,_("31","[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return o}function f(e,t,r){return null==e?0:d(e,"",t,r)}function P(e,t){return"object"===typeof e&&null!==e&&null!=e.key?l(e.key):t.toString(36)}function A(e,t){e.func.call(e.context,t,e.count++)}function S(e,t,r){var a=e.result,_=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?p(e,a,r,function(e){return e}):null!=e&&(E(e)&&(e=c(e,_+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(K,"$&/")+"/")+r)),a.push(e))}function p(e,t,r,a,_){var n="";null!=r&&(n=(""+r).replace(K,"$&/")+"/"),t=T(t,n,a,_),f(e,S,t),u(t)}var v=r(65),m="function"===typeof Symbol&&Symbol.for,O=m?Symbol.for("react.element"):60103,N=m?Symbol.for("react.portal"):60106,g=m?Symbol.for("react.fragment"):60107,h=m?Symbol.for("react.strict_mode"):60108,R=m?Symbol.for("react.profiler"):60114,I=m?Symbol.for("react.provider"):60109,b=m?Symbol.for("react.context"):60110,Y=m?Symbol.for("react.concurrent_mode"):60111,L=m?Symbol.for("react.forward_ref"):60112,M=m?Symbol.for("react.suspense"):60113,y=m?Symbol.for("react.memo"):60115,x=m?Symbol.for("react.lazy"):60116,U="function"===typeof Symbol&&Symbol.iterator,w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C={};n.prototype.isReactComponent={},n.prototype.setState=function(e,t){"object"!==typeof e&&"function"!==typeof e&&null!=e&&_("85"),this.updater.enqueueSetState(this,e,t,"setState")},n.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},o.prototype=n.prototype;var D=i.prototype=new o;D.constructor=i,v(D,n.prototype),D.isPureReactComponent=!0;var F={current:null,currentDispatcher:null},G=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0},K=/\/+/g,B=[],X={Children:{map:function(e,t,r){if(null==e)return e;var a=[];return p(e,a,null,t,r),a},forEach:function(e,t,r){if(null==e)return e;t=T(null,null,t,r),f(e,A,t),u(t)},count:function(e){return f(e,function(){return null},null)},toArray:function(e){var t=[];return p(e,t,null,function(e){return e}),t},only:function(e){return E(e)||_("143"),e}},createRef:function(){return{current:null}},Component:n,PureComponent:i,createContext:function(e,t){return void 0===t&&(t=null),e={$$typeof:b,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider={$$typeof:I,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:L,render:e}},lazy:function(e){return{$$typeof:x,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:y,type:e,compare:void 0===t?null:t}},Fragment:g,StrictMode:h,Suspense:M,createElement:s,cloneElement:function(e,t,r){(null===e||void 0===e)&&_("267",e);var a=void 0,n=v({},e.props),o=e.key,i=e.ref,s=e._owner;if(null!=t){void 0!==t.ref&&(i=t.ref,s=F.current),void 0!==t.key&&(o=""+t.key);var c=void 0;e.type&&e.type.defaultProps&&(c=e.type.defaultProps);for(a in t)G.call(t,a)&&!k.hasOwnProperty(a)&&(n[a]=void 0===t[a]&&void 0!==c?c[a]:t[a])}if(1===(a=arguments.length-2))n.children=r;else if(1<a){c=Array(a);for(var E=0;E<a;E++)c[E]=arguments[E+2];n.children=c}return{$$typeof:O,type:e.type,key:o,ref:i,props:n,_owner:s}},createFactory:function(e){var t=s.bind(null,e);return t.type=e,t},isValidElement:E,version:"16.6.3",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:F,assign:v}};X.unstable_ConcurrentMode=Y,X.unstable_Profiler=R;var j={default:X},H=j&&X||j;e.exports=H.default||H},function(e,t,r){"use strict";function a(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}a(),e.exports=r(100)},function(e,t,r){"use strict";function a(e,t,r,a,_,n,o,i){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[r,a,_,n,o,i],c=0;e=Error(t.replace(/%s/g,function(){return s[c++]})),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function _(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,_=0;_<t;_++)r+="&args[]="+encodeURIComponent(arguments[_+1]);a(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}function n(e,t,r,a,_,n,o,i,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(e){this.onError(e)}}function o(e,t,r,a,_,o,i,s,c){Ua=!1,wa=null,n.apply(Fa,arguments)}function i(e,t,r,a,n,i,s,c,E){if(o.apply(this,arguments),Ua){if(Ua){var l=wa;Ua=!1,wa=null}else _("198"),l=void 0;Ca||(Ca=!0,Da=l)}}function s(){if(Ga)for(var e in ka){var t=ka[e],r=Ga.indexOf(e);if(-1<r||_("96",e),!Ka[r]){t.extractEvents||_("97",e),Ka[r]=t,r=t.eventTypes;for(var a in r){var n=void 0,o=r[a],i=t,s=a;Ba.hasOwnProperty(s)&&_("99",s),Ba[s]=o;var E=o.phasedRegistrationNames;if(E){for(n in E)E.hasOwnProperty(n)&&c(E[n],i,s);n=!0}else o.registrationName?(c(o.registrationName,i,s),n=!0):n=!1;n||_("98",a,e)}}}}function c(e,t,r){Xa[e]&&_("100",e),Xa[e]=t,ja[e]=t.eventTypes[r].dependencies}function E(e,t,r){var a=e.type||"unknown-event";e.currentTarget=za(r),i(a,t,void 0,e),e.currentTarget=null}function l(e,t){return null==t&&_("30"),null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function T(e,t,r){Array.isArray(e)?e.forEach(t,r):e&&t.call(r,e)}function u(e){if(e){var t=e._dispatchListeners,r=e._dispatchInstances;if(Array.isArray(t))for(var a=0;a<t.length&&!e.isPropagationStopped();a++)E(e,t[a],r[a]);else t&&E(e,t,r);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function d(e,t){var r=e.stateNode;if(!r)return null;var a=Ha(r);if(!a)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(a=!a.disabled)||(e=e.type,a=!("button"===e||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}return e?null:(r&&"function"!==typeof r&&_("231",t,typeof r),r)}function f(e){if(null!==e&&(qa=l(qa,e)),e=qa,qa=null,e&&(T(e,u),qa&&_("95"),Ca))throw e=Da,Ca=!1,Da=null,e}function P(e){if(e[Ja])return e[Ja];for(;!e[Ja];){if(!e.parentNode)return null;e=e.parentNode}return e=e[Ja],5===e.tag||6===e.tag?e:null}function A(e){return e=e[Ja],!e||5!==e.tag&&6!==e.tag?null:e}function S(e){if(5===e.tag||6===e.tag)return e.stateNode;_("33")}function p(e){return e[Za]||null}function v(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function m(e,t,r){(t=d(e,r.dispatchConfig.phasedRegistrationNames[t]))&&(r._dispatchListeners=l(r._dispatchListeners,t),r._dispatchInstances=l(r._dispatchInstances,e))}function O(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,r=[];t;)r.push(t),t=v(t);for(t=r.length;0<t--;)m(r[t],"captured",e);for(t=0;t<r.length;t++)m(r[t],"bubbled",e)}}function N(e,t,r){e&&r&&r.dispatchConfig.registrationName&&(t=d(e,r.dispatchConfig.registrationName))&&(r._dispatchListeners=l(r._dispatchListeners,t),r._dispatchInstances=l(r._dispatchInstances,e))}function g(e){e&&e.dispatchConfig.registrationName&&N(e._targetInst,null,e)}function h(e){T(e,O)}function R(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}function I(e){if(t_[e])return t_[e];if(!e_[e])return e;var t,r=e_[e];for(t in r)if(r.hasOwnProperty(t)&&t in r_)return t_[e]=r[t];return e}function b(){if(E_)return E_;var e,t,r=c_,a=r.length,_="value"in s_?s_.value:s_.textContent,n=_.length;for(e=0;e<a&&r[e]===_[e];e++);var o=a-e;for(t=1;t<=o&&r[a-t]===_[n-t];t++);return E_=_.slice(e,1<t?1-t:void 0)}function Y(){return!0}function L(){return!1}function M(e,t,r,a){this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=r,e=this.constructor.Interface;for(var _ in e)e.hasOwnProperty(_)&&((t=e[_])?this[_]=t(r):"target"===_?this.target=a:this[_]=r[_]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Y:L,this.isPropagationStopped=L,this}function y(e,t,r,a){if(this.eventPool.length){var _=this.eventPool.pop();return this.call(_,e,t,r,a),_}return new this(e,t,r,a)}function x(e){e instanceof this||_("279"),e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function U(e){e.eventPool=[],e.getPooled=y,e.release=x}function w(e,t){switch(e){case"keyup":return-1!==u_.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function C(e){return e=e.detail,"object"===typeof e&&"data"in e?e.data:null}function D(e,t){switch(e){case"compositionend":return C(t);case"keypress":return 32!==t.which?null:(v_=!0,S_);case"textInput":return e=t.data,e===S_&&v_?null:e;default:return null}}function F(e,t){if(m_)return"compositionend"===e||!d_&&w(e,t)?(e=b(),E_=c_=s_=null,m_=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return A_&&"ko"!==t.locale?null:t.data;default:return null}}function G(e){if(e=Qa(e)){"function"!==typeof N_&&_("280");var t=Ha(e.stateNode);N_(e.stateNode,e.type,t)}}function k(e){g_?h_?h_.push(e):h_=[e]:g_=e}function K(){if(g_){var e=g_,t=h_;if(h_=g_=null,G(e),t)for(e=0;e<t.length;e++)G(t[e])}}function B(e,t){return e(t)}function X(e,t,r){return e(t,r)}function j(){}function H(e,t){if(R_)return e(t);R_=!0;try{return B(e,t)}finally{R_=!1,(null!==g_||null!==h_)&&(j(),K())}}function Q(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!I_[e.type]:"textarea"===t}function z(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function q(e){if(!$a)return!1;e="on"+e;var t=e in document;return t||(t=document.createElement("div"),t.setAttribute(e,"return;"),t="function"===typeof t[e]),t}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){var t=V(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var _=r.get,n=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return _.call(this)},set:function(e){a=""+e,n.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function J(e){e._valueTracker||(e._valueTracker=W(e))}function Z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=V(e)?e.checked?"true":"false":e.value),(e=a)!==r&&(t.setValue(e),!0)}function $(e){return null===e||"object"!==typeof e?null:(e=X_&&e[X_]||e["@@iterator"],"function"===typeof e?e:null)}function ee(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case F_:return"ConcurrentMode";case x_:return"Fragment";case y_:return"Portal";case w_:return"Profiler";case U_:return"StrictMode";case k_:return"Suspense"}if("object"===typeof e)switch(e.$$typeof){case D_:return"Context.Consumer";case C_:return"Context.Provider";case G_:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case K_:return ee(e.type);case B_:if(e=1===e._status?e._result:null)return ee(e)}return null}function te(e){var t="";do{e:switch(e.tag){case 2:case 16:case 0:case 1:case 5:case 8:case 13:var r=e._debugOwner,a=e._debugSource,_=ee(e.type),n=null;r&&(n=ee(r.type)),r=_,_="",a?_=" (at "+a.fileName.replace(Y_,"")+":"+a.lineNumber+")":n&&(_=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+_;break e;default:n=""}t+=n,e=e.return}while(e);return t}function re(e){return!!H_.call(z_,e)||!H_.call(Q_,e)&&(j_.test(e)?z_[e]=!0:(Q_[e]=!0,!1))}function ae(e,t,r,a){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}function _e(e,t,r,a){if(null===t||"undefined"===typeof t||ae(e,t,r,a))return!0;if(a)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ne(e,t,r,a,_){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=_,this.mustUseProperty=r,this.propertyName=e,this.type=t}function oe(e){return e[1].toUpperCase()}function ie(e,t,r,a){var _=q_.hasOwnProperty(t)?q_[t]:null;(null!==_?0===_.type:!a&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(_e(t,r,_,a)&&(r=null),a||null===_?re(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):_.mustUseProperty?e[_.propertyName]=null===r?3!==_.type&&"":r:(t=_.attributeName,a=_.attributeNamespace,null===r?e.removeAttribute(t):(_=_.type,r=3===_||4===_&&!0===r?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}function se(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function ce(e,t){var r=t.checked;return ya({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Ee(e,t){var r=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;r=se(null!=t.value?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function le(e,t){null!=(t=t.checked)&&ie(e,"checked",t,!1)}function Te(e,t){le(e,t);var r=se(t.value),a=t.type;if(null!=r)"number"===a?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?de(e,t.type,r):t.hasOwnProperty("defaultValue")&&de(e,t.type,se(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ue(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,""!==r&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function de(e,t,r){"number"===t&&e.ownerDocument.activeElement===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}function fe(e,t,r){return e=M.getPooled(W_.change,e,t,r),e.type="change",k(r),h(e),e}function Pe(e){f(e)}function Ae(e){if(Z(S(e)))return e}function Se(e,t){if("change"===e)return t}function pe(){J_&&(J_.detachEvent("onpropertychange",ve),Z_=J_=null)}function ve(e){"value"===e.propertyName&&Ae(Z_)&&(e=fe(Z_,e,z(e)),H(Pe,e))}function me(e,t,r){"focus"===e?(pe(),J_=t,Z_=r,J_.attachEvent("onpropertychange",ve)):"blur"===e&&pe()}function Oe(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ae(Z_)}function Ne(e,t){if("click"===e)return Ae(t)}function ge(e,t){if("input"===e||"change"===e)return Ae(t)}function he(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=rn[e])&&!!t[e]}function Re(){return he}function Ie(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function be(e,t){if(Ie(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++)if(!Tn.call(t,r[a])||!Ie(e[r[a]],t[r[a]]))return!1;return!0}function Ye(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if(0!==(2&t.effectTag))return 1;for(;t.return;)if(t=t.return,0!==(2&t.effectTag))return 1}return 3===t.tag?2:3}function Le(e){2!==Ye(e)&&_("188")}function Me(e){var t=e.alternate;if(!t)return t=Ye(e),3===t&&_("188"),1===t?null:e;for(var r=e,a=t;;){var n=r.return,o=n?n.alternate:null;if(!n||!o)break;if(n.child===o.child){for(var i=n.child;i;){if(i===r)return Le(n),e;if(i===a)return Le(n),t;i=i.sibling}_("188")}if(r.return!==a.return)r=n,a=o;else{i=!1;for(var s=n.child;s;){if(s===r){i=!0,r=n,a=o;break}if(s===a){i=!0,a=n,r=o;break}s=s.sibling}if(!i){for(s=o.child;s;){if(s===r){i=!0,r=o,a=n;break}if(s===a){i=!0,a=o,r=n;break}s=s.sibling}i||_("189")}}r.alternate!==a&&_("190")}return 3!==r.tag&&_("188"),r.stateNode.current===r?e:t}function ye(e){if(!(e=Me(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function xe(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Ue(e,t){var r=e[0];e=e[1];var a="on"+(e[0].toUpperCase()+e.slice(1));t={phasedRegistrationNames:{bubbled:a,captured:a+"Capture"},dependencies:[r],isInteractive:t},gn[e]=t,hn[r]=t}function we(e){var t=e.targetInst,r=t;do{if(!r){e.ancestors.push(r);break}var a;for(a=r;a.return;)a=a.return;if(!(a=3!==a.tag?null:a.stateNode.containerInfo))break;e.ancestors.push(r),r=P(a)}while(r);for(r=0;r<e.ancestors.length;r++){t=e.ancestors[r];var _=z(e.nativeEvent);a=e.topLevelType;for(var n=e.nativeEvent,o=null,i=0;i<Ka.length;i++){var s=Ka[i];s&&(s=s.extractEvents(a,t,n,_))&&(o=l(o,s))}f(o)}}function Ce(e,t){if(!t)return null;var r=(In(e)?Fe:Ge).bind(null,e);t.addEventListener(e,r,!1)}function De(e,t){if(!t)return null;var r=(In(e)?Fe:Ge).bind(null,e);t.addEventListener(e,r,!0)}function Fe(e,t){X(Ge,e,t)}function Ge(e,t){if(Yn){var r=z(t);if(r=P(r),null===r||"number"!==typeof r.tag||2===Ye(r)||(r=null),bn.length){var a=bn.pop();a.topLevelType=e,a.nativeEvent=t,a.targetInst=r,e=a}else e={topLevelType:e,nativeEvent:t,targetInst:r,ancestors:[]};try{H(we,e)}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>bn.length&&bn.push(e)}}}function ke(e){return Object.prototype.hasOwnProperty.call(e,yn)||(e[yn]=Mn++,Ln[e[yn]]={}),Ln[e[yn]]}function Ke(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Be(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xe(e,t){var r=Be(e);e=0;for(var a;r;){if(3===r.nodeType){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Be(r)}}function je(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?je(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function He(){for(var e=window,t=Ke();t instanceof e.HTMLIFrameElement;){try{e=t.contentDocument.defaultView}catch(e){break}t=Ke(e.document)}return t}function Qe(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ze(e,t){var r=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Fn||null==wn||wn!==Ke(r)?null:(r=wn,"selectionStart"in r&&Qe(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Dn&&be(Dn,r)?null:(Dn=r,e=M.getPooled(Un.select,Cn,e,t),e.type="select",e.target=wn,h(e),e))}function qe(e){var t="";return Ma.Children.forEach(e,function(e){null!=e&&(t+=e)}),t}function Ve(e,t){return e=ya({children:void 0},t),(t=qe(t.children))&&(e.children=t),e}function We(e,t,r,a){if(e=e.options,t){t={};for(var _=0;_<r.length;_++)t["$"+r[_]]=!0;for(r=0;r<e.length;r++)_=t.hasOwnProperty("$"+e[r].value),e[r].selected!==_&&(e[r].selected=_),_&&a&&(e[r].defaultSelected=!0)}else{for(r=""+se(r),t=null,_=0;_<e.length;_++){if(e[_].value===r)return e[_].selected=!0,void(a&&(e[_].defaultSelected=!0));null!==t||e[_].disabled||(t=e[_])}null!==t&&(t.selected=!0)}}function Je(e,t){return null!=t.dangerouslySetInnerHTML&&_("91"),ya({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ze(e,t){var r=t.value;null==r&&(r=t.defaultValue,t=t.children,null!=t&&(null!=r&&_("92"),Array.isArray(t)&&(1>=t.length||_("93"),t=t[0]),r=t),null==r&&(r="")),e._wrapperState={initialValue:se(r)}}function $e(e,t){var r=se(t.value),a=se(t.defaultValue);null!=r&&(r=""+r,r!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=a&&(e.defaultValue=""+a)}function et(e){var t=e.textContent;t===e._wrapperState.initialValue&&(e.value=t)}function tt(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rt(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?tt(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}function at(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}function _t(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||Xn.hasOwnProperty(e)&&Xn[e]?(""+t).trim():t+"px"}function nt(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var a=0===r.indexOf("--"),_=_t(r,t[r],a);"float"===r&&(r="cssFloat"),a?e.setProperty(r,_):e[r]=_}}function ot(e,t){t&&(Hn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&_("137",e,""),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&_("60"),"object"===typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML||_("61")),null!=t.style&&"object"!==typeof t.style&&_("62",""))}function it(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function st(e,t){e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument;var r=ke(e);t=ja[t];for(var a=0;a<t.length;a++){var _=t[a];if(!r.hasOwnProperty(_)||!r[_]){switch(_){case"scroll":De("scroll",e);break;case"focus":case"blur":De("focus",e),De("blur",e),r.blur=!0,r.focus=!0;break;case"cancel":case"close":q(_)&&De(_,e);break;case"invalid":case"submit":case"reset":break;default:-1===i_.indexOf(_)&&Ce(_,e)}r[_]=!0}}}function ct(){}function Et(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function lt(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}function Tt(e){for(e=e.nextSibling;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}function ut(e){for(e=e.firstChild;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}function dt(e){0>Jn||(e.current=Wn[Jn],Wn[Jn]=null,Jn--)}function ft(e,t){Jn++,Wn[Jn]=e.current,e.current=t}function Pt(e,t){var r=e.type.contextTypes;if(!r)return Zn;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var _,n={};for(_ in r)n[_]=t[_];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function At(e){return null!==(e=e.childContextTypes)&&void 0!==e}function St(e){dt(eo,e),dt($n,e)}function pt(e){dt(eo,e),dt($n,e)}function vt(e,t,r){$n.current!==Zn&&_("168"),ft($n,t,e),ft(eo,r,e)}function mt(e,t,r){var a=e.stateNode;if(e=t.childContextTypes,"function"!==typeof a.getChildContext)return r;a=a.getChildContext();for(var n in a)n in e||_("108",ee(t)||"Unknown",n);return ya({},r,a)}function Ot(e){var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||Zn,to=$n.current,ft($n,t,e),ft(eo,eo.current,e),!0}function Nt(e,t,r){var a=e.stateNode;a||_("169"),r?(t=mt(e,t,to),a.__reactInternalMemoizedMergedChildContext=t,dt(eo,e),dt($n,e),ft($n,t,e)):dt(eo,e),ft(eo,r,e)}function gt(e){return function(t){try{return e(t)}catch(e){}}}function ht(e){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var r=t.inject(e);ro=gt(function(e){return t.onCommitFiberRoot(r,e)}),ao=gt(function(e){return t.onCommitFiberUnmount(r,e)})}catch(e){}return!0}function Rt(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.firstContextDependency=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function It(e,t,r,a){return new Rt(e,t,r,a)}function bt(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Yt(e){if("function"===typeof e)return bt(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===G_)return 11;if(e===K_)return 14}return 2}function Lt(e,t){var r=e.alternate;return null===r?(r=It(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.effectTag=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.childExpirationTime=e.childExpirationTime,r.expirationTime=e.expirationTime,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,r.firstContextDependency=e.firstContextDependency,r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Mt(e,t,r,a,n,o){var i=2;if(a=e,"function"===typeof e)bt(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case x_:return yt(r.children,n,o,t);case F_:return xt(r,3|n,o,t);case U_:return xt(r,2|n,o,t);case w_:return e=It(12,r,t,4|n),e.elementType=w_,e.type=w_,e.expirationTime=o,e;case k_:return e=It(13,r,t,n),e.elementType=k_,e.type=k_,e.expirationTime=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C_:i=10;break e;case D_:i=9;break e;case G_:i=11;break e;case K_:i=14;break e;case B_:i=16,a=null;break e}_("130",null==e?e:typeof e,"")}return t=It(i,r,t,n),t.elementType=e,t.type=a,t.expirationTime=o,t}function yt(e,t,r,a){return e=It(7,e,a,t),e.expirationTime=r,e}function xt(e,t,r,a){return e=It(8,e,a,t),t=0===(1&t)?U_:F_,e.elementType=t,e.type=t,e.expirationTime=r,e}function Ut(e,t,r){return e=It(6,e,null,t),e.expirationTime=r,e}function wt(e,t,r){return t=It(4,null!==e.children?e.children:[],e.key,t),t.expirationTime=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ct(e,t){e.didError=!1;var r=e.earliestPendingTime;0===r?e.earliestPendingTime=e.latestPendingTime=t:r<t?e.earliestPendingTime=t:e.latestPendingTime>t&&(e.latestPendingTime=t),Gt(t,e)}function Dt(e,t){e.didError=!1;var r=e.latestPingedTime;0!==r&&r>=t&&(e.latestPingedTime=0),r=e.earliestPendingTime;var a=e.latestPendingTime;r===t?e.earliestPendingTime=a===t?e.latestPendingTime=0:a:a===t&&(e.latestPendingTime=r),r=e.earliestSuspendedTime,a=e.latestSuspendedTime,0===r?e.earliestSuspendedTime=e.latestSuspendedTime=t:r<t?e.earliestSuspendedTime=t:a>t&&(e.latestSuspendedTime=t),Gt(t,e)}function Ft(e,t){var r=e.earliestPendingTime;return e=e.earliestSuspendedTime,r>t&&(t=r),e>t&&(t=e),t}function Gt(e,t){var r=t.earliestSuspendedTime,a=t.latestSuspendedTime,_=t.earliestPendingTime,n=t.latestPingedTime;_=0!==_?_:n,0===_&&(0===e||a<e)&&(_=a),e=_,0!==e&&r>e&&(e=r),t.nextExpirationTimeToWorkOn=_,t.expirationTime=e}function kt(e){return{baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Kt(e){return{baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Bt(e){return{expirationTime:e,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function Xt(e,t){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t)}function jt(e,t){var r=e.alternate;if(null===r){var a=e.updateQueue,_=null;null===a&&(a=e.updateQueue=kt(e.memoizedState))}else a=e.updateQueue,_=r.updateQueue,null===a?null===_?(a=e.updateQueue=kt(e.memoizedState),_=r.updateQueue=kt(r.memoizedState)):a=e.updateQueue=Kt(_):null===_&&(_=r.updateQueue=Kt(a));null===_||a===_?Xt(a,t):null===a.lastUpdate||null===_.lastUpdate?(Xt(a,t),Xt(_,t)):(Xt(a,t),_.lastUpdate=t)}function Ht(e,t){var r=e.updateQueue;r=null===r?e.updateQueue=kt(e.memoizedState):Qt(e,r),null===r.lastCapturedUpdate?r.firstCapturedUpdate=r.lastCapturedUpdate=t:(r.lastCapturedUpdate.next=t,r.lastCapturedUpdate=t)}function Qt(e,t){var r=e.alternate;return null!==r&&t===r.updateQueue&&(t=e.updateQueue=Kt(t)),t}function zt(e,t,r,a,_,n){switch(r.tag){case 1:return e=r.payload,"function"===typeof e?e.call(n,a,_):e;case 3:e.effectTag=-2049&e.effectTag|64;case 0:if(e=r.payload,null===(_="function"===typeof e?e.call(n,a,_):e)||void 0===_)break;return ya({},a,_);case 2:_o=!0}return a}function qt(e,t,r,a,_){_o=!1,t=Qt(e,t);for(var n=t.baseState,o=null,i=0,s=t.firstUpdate,c=n;null!==s;){var E=s.expirationTime;E<_?(null===o&&(o=s,n=c),i<E&&(i=E)):(c=zt(e,t,s,c,r,a),null!==s.callback&&(e.effectTag|=32,s.nextEffect=null,null===t.lastEffect?t.firstEffect=t.lastEffect=s:(t.lastEffect.nextEffect=s,t.lastEffect=s))),s=s.next}for(E=null,s=t.firstCapturedUpdate;null!==s;){var l=s.expirationTime;l<_?(null===E&&(E=s,null===o&&(n=c)),i<l&&(i=l)):(c=zt(e,t,s,c,r,a),null!==s.callback&&(e.effectTag|=32,s.nextEffect=null,null===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=s:(t.lastCapturedEffect.nextEffect=s,t.lastCapturedEffect=s))),s=s.next}null===o&&(t.lastUpdate=null),null===E?t.lastCapturedUpdate=null:e.effectTag|=32,null===o&&null===E&&(n=c),t.baseState=n,t.firstUpdate=o,t.firstCapturedUpdate=E,e.expirationTime=i,e.memoizedState=c}function Vt(e,t,r){null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null),Wt(t.firstEffect,r),t.firstEffect=t.lastEffect=null,Wt(t.firstCapturedEffect,r),t.firstCapturedEffect=t.lastCapturedEffect=null}function Wt(e,t){for(;null!==e;){var r=e.callback;if(null!==r){e.callback=null;var a=t;"function"!==typeof r&&_("191",r),r.call(a)}e=e.nextEffect}}function Jt(e,t){return{value:e,source:t,stack:te(t)}}function Zt(e,t){var r=e.type._context;ft(no,r._currentValue,e),r._currentValue=t}function $t(e){var t=no.current;dt(no,e),e.type._context._currentValue=t}function er(e){oo=e,so=io=null,e.firstContextDependency=null}function tr(e,t){return so!==e&&!1!==t&&0!==t&&("number"===typeof t&&1073741823!==t||(so=e,t=1073741823),t={context:e,observedBits:t,next:null},null===io?(null===oo&&_("293"),oo.firstContextDependency=io=t):io=io.next=t),e._currentValue}function rr(e){return e===co&&_("174"),e}function ar(e,t){ft(To,t,e),ft(lo,e,e),ft(Eo,co,e);var r=t.nodeType;switch(r){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rt(null,"");break;default:r=8===r?t.parentNode:t,t=r.namespaceURI||null,r=r.tagName,t=rt(t,r)}dt(Eo,e),ft(Eo,t,e)}function _r(e){dt(Eo,e),dt(lo,e),dt(To,e)}function nr(e){rr(To.current);var t=rr(Eo.current),r=rt(t,e.type);t!==r&&(ft(lo,e,e),ft(Eo,r,e))}function or(e){lo.current===e&&(dt(Eo,e),dt(lo,e))}function ir(e,t){if(e&&e.defaultProps){t=ya({},t),e=e.defaultProps;for(var r in e)void 0===t[r]&&(t[r]=e[r])}return t}function sr(e){var t=e._result;switch(e._status){case 1:return t;case 2:case 0:throw t;default:throw e._status=0,t=e._ctor,t=t(),t.then(function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)},function(t){0===e._status&&(e._status=2,e._result=t)}),e._result=t,t}}function cr(e,t,r,a){t=e.memoizedState,r=r(a,t),r=null===r||void 0===r?t:ya({},t,r),e.memoizedState=r,null!==(a=e.updateQueue)&&0===e.expirationTime&&(a.baseState=r)}function Er(e,t,r,a,_,n,o){return e=e.stateNode,"function"===typeof e.shouldComponentUpdate?e.shouldComponentUpdate(a,n,o):!t.prototype||!t.prototype.isPureReactComponent||(!be(r,a)||!be(_,n))}function lr(e,t,r){var a=!1,_=Zn,n=t.contextType;return"object"===typeof n&&null!==n?n=uo.currentDispatcher.readContext(n):(_=At(t)?to:$n.current,a=t.contextTypes,n=(a=null!==a&&void 0!==a)?Pt(e,_):Zn),t=new t(r,n),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Po,e.stateNode=t,t._reactInternalFiber=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=_,e.__reactInternalMemoizedMaskedChildContext=n),t}function Tr(e,t,r,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&Po.enqueueReplaceState(t,t.state,null)}function ur(e,t,r,a){var _=e.stateNode;_.props=r,_.state=e.memoizedState,_.refs=fo;var n=t.contextType;"object"===typeof n&&null!==n?_.context=uo.currentDispatcher.readContext(n):(n=At(t)?to:$n.current,_.context=Pt(e,n)),n=e.updateQueue,null!==n&&(qt(e,n,r,_,a),_.state=e.memoizedState),n=t.getDerivedStateFromProps,"function"===typeof n&&(cr(e,t,n,r),_.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof _.getSnapshotBeforeUpdate||"function"!==typeof _.UNSAFE_componentWillMount&&"function"!==typeof _.componentWillMount||(t=_.state,"function"===typeof _.componentWillMount&&_.componentWillMount(),"function"===typeof _.UNSAFE_componentWillMount&&_.UNSAFE_componentWillMount(),t!==_.state&&Po.enqueueReplaceState(_,_.state,null),null!==(n=e.updateQueue)&&(qt(e,n,r,_,a),_.state=e.memoizedState)),"function"===typeof _.componentDidMount&&(e.effectTag|=4)}function dr(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){r=r._owner;var a=void 0;r&&(1!==r.tag&&_("289"),a=r.stateNode),a||_("147",e);var n=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===n?t.ref:(t=function(e){var t=a.refs;t===fo&&(t=a.refs={}),null===e?delete t[n]:t[n]=e},t._stringRef=n,t)}"string"!==typeof e&&_("284"),r._owner||_("290",e)}return e}function fr(e,t){"textarea"!==e.type&&_("31","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function Pr(e){function t(t,r){if(e){var a=t.lastEffect;null!==a?(a.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r,r.nextEffect=null,r.effectTag=8}}function r(r,a){if(!e)return null;for(;null!==a;)t(r,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t,r){return e=Lt(e,t,r),e.index=0,e.sibling=null,e}function o(t,r,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index,a<r?(t.effectTag=2,r):a):(t.effectTag=2,r):r}function i(t){return e&&null===t.alternate&&(t.effectTag=2),t}function s(e,t,r,a){return null===t||6!==t.tag?(t=Ut(r,e.mode,a),t.return=e,t):(t=n(t,r,a),t.return=e,t)}function c(e,t,r,a){return null!==t&&t.elementType===r.type?(a=n(t,r.props,a),a.ref=dr(e,t,r),a.return=e,a):(a=Mt(r.type,r.key,r.props,null,e.mode,a),a.ref=dr(e,t,r),a.return=e,a)}function E(e,t,r,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?(t=wt(r,e.mode,a),t.return=e,t):(t=n(t,r.children||[],a),t.return=e,t)}function l(e,t,r,a,_){return null===t||7!==t.tag?(t=yt(r,e.mode,a,_),t.return=e,t):(t=n(t,r,a),t.return=e,t)}function T(e,t,r){if("string"===typeof t||"number"===typeof t)return t=Ut(""+t,e.mode,r),t.return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case M_:return r=Mt(t.type,t.key,t.props,null,e.mode,r),r.ref=dr(e,null,t),r.return=e,r;case y_:return t=wt(t,e.mode,r),t.return=e,t}if(Ao(t)||$(t))return t=yt(t,e.mode,r,null),t.return=e,t;fr(e,t)}return null}function u(e,t,r,a){var _=null!==t?t.key:null;if("string"===typeof r||"number"===typeof r)return null!==_?null:s(e,t,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case M_:return r.key===_?r.type===x_?l(e,t,r.props.children,a,_):c(e,t,r,a):null;case y_:return r.key===_?E(e,t,r,a):null}if(Ao(r)||$(r))return null!==_?null:l(e,t,r,a,null);fr(e,r)}return null}function d(e,t,r,a,_){if("string"===typeof a||"number"===typeof a)return e=e.get(r)||null,s(t,e,""+a,_);if("object"===typeof a&&null!==a){switch(a.$$typeof){case M_:return e=e.get(null===a.key?r:a.key)||null,a.type===x_?l(t,e,a.props.children,_,a.key):c(t,e,a,_);case y_:return e=e.get(null===a.key?r:a.key)||null,E(t,e,a,_)}if(Ao(a)||$(a))return e=e.get(r)||null,l(t,e,a,_,null);fr(t,a)}return null}function f(_,n,i,s){for(var c=null,E=null,l=n,f=n=0,P=null;null!==l&&f<i.length;f++){l.index>f?(P=l,l=null):P=l.sibling;var A=u(_,l,i[f],s);if(null===A){null===l&&(l=P);break}e&&l&&null===A.alternate&&t(_,l),n=o(A,n,f),null===E?c=A:E.sibling=A,E=A,l=P}if(f===i.length)return r(_,l),c;if(null===l){for(;f<i.length;f++)(l=T(_,i[f],s))&&(n=o(l,n,f),null===E?c=l:E.sibling=l,E=l);return c}for(l=a(_,l);f<i.length;f++)(P=d(l,_,f,i[f],s))&&(e&&null!==P.alternate&&l.delete(null===P.key?f:P.key),n=o(P,n,f),null===E?c=P:E.sibling=P,E=P);return e&&l.forEach(function(e){return t(_,e)}),c}function P(n,i,s,c){var E=$(s);"function"!==typeof E&&_("150"),null==(s=E.call(s))&&_("151");for(var l=E=null,f=i,P=i=0,A=null,S=s.next();null!==f&&!S.done;P++,S=s.next()){f.index>P?(A=f,f=null):A=f.sibling;var p=u(n,f,S.value,c);if(null===p){f||(f=A);break}e&&f&&null===p.alternate&&t(n,f),i=o(p,i,P),null===l?E=p:l.sibling=p,l=p,f=A}if(S.done)return r(n,f),E;if(null===f){for(;!S.done;P++,S=s.next())null!==(S=T(n,S.value,c))&&(i=o(S,i,P),null===l?E=S:l.sibling=S,l=S);return E}for(f=a(n,f);!S.done;P++,S=s.next())null!==(S=d(f,n,P,S.value,c))&&(e&&null!==S.alternate&&f.delete(null===S.key?P:S.key),i=o(S,i,P),null===l?E=S:l.sibling=S,l=S);return e&&f.forEach(function(e){return t(n,e)}),E}return function(e,a,o,s){var c="object"===typeof o&&null!==o&&o.type===x_&&null===o.key;c&&(o=o.props.children);var E="object"===typeof o&&null!==o;if(E)switch(o.$$typeof){case M_:e:{for(E=o.key,c=a;null!==c;){if(c.key===E){if(7===c.tag?o.type===x_:c.elementType===o.type){r(e,c.sibling),a=n(c,o.type===x_?o.props.children:o.props,s),a.ref=dr(e,c,o),a.return=e,e=a;break e}r(e,c);break}t(e,c),c=c.sibling}o.type===x_?(a=yt(o.props.children,e.mode,s,o.key),a.return=e,e=a):(s=Mt(o.type,o.key,o.props,null,e.mode,s),s.ref=dr(e,a,o),s.return=e,e=s)}return i(e);case y_:e:{for(c=o.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){r(e,a.sibling),a=n(a,o.children||[],s),a.return=e,e=a;break e}r(e,a);break}t(e,a),a=a.sibling}a=wt(o,e.mode,s),a.return=e,e=a}return i(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==a&&6===a.tag?(r(e,a.sibling),a=n(a,o,s),a.return=e,e=a):(r(e,a),a=Ut(o,e.mode,s),a.return=e,e=a),i(e);if(Ao(o))return f(e,a,o,s);if($(o))return P(e,a,o,s);if(E&&fr(e,o),"undefined"===typeof o&&!c)switch(e.tag){case 1:case 0:s=e.type,_("152",s.displayName||s.name||"Component")}return r(e,a)}}function Ar(e,t){var r=It(5,null,null,0);r.elementType="DELETED",r.type="DELETED",r.stateNode=t,r.return=e,r.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=r,e.lastEffect=r):e.firstEffect=e.lastEffect=r}function Sr(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function pr(e){if(Oo){var t=mo;if(t){var r=t;if(!Sr(e,t)){if(!(t=Tt(r))||!Sr(e,t))return e.effectTag|=2,Oo=!1,void(vo=e);Ar(vo,r)}vo=e,mo=ut(t)}else e.effectTag|=2,Oo=!1,vo=e}}function vr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag;)e=e.return;vo=e}function mr(e){if(e!==vo)return!1;if(!Oo)return vr(e),Oo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!lt(t,e.memoizedProps))for(t=mo;t;)Ar(e,t),t=Tt(t);return vr(e),mo=vo?Tt(e.stateNode):null,!0}function Or(){mo=vo=null,Oo=!1}function Nr(e,t,r,a){t.child=null===e?po(t,null,r,a):So(t,e.child,r,a)}function gr(e,t,r,a,_){r=r.render;var n=t.ref;return er(t,_),a=r(a,n),t.effectTag|=1,Nr(e,t,a,_),t.child}function hr(e,t,r,a,_,n){if(null===e){var o=r.type;return"function"!==typeof o||bt(o)||void 0!==o.defaultProps||null!==r.compare?(e=Mt(r.type,null,a,null,t.mode,n),e.ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Rr(e,t,o,a,_,n))}return o=e.child,_<n&&(_=o.memoizedProps,r=r.compare,(r=null!==r?r:be)(_,a)&&e.ref===t.ref)?xr(e,t,n):(t.effectTag|=1,e=Lt(o,a,n),e.ref=t.ref,e.return=t,t.child=e)}function Rr(e,t,r,a,_,n){return null!==e&&_<n&&be(e.memoizedProps,a)&&e.ref===t.ref?xr(e,t,n):br(e,t,r,a,n)}function Ir(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.effectTag|=128)}function br(e,t,r,a,_){var n=At(r)?to:$n.current;return n=Pt(t,n),er(t,_),r=r(a,n),t.effectTag|=1,Nr(e,t,r,_),t.child}function Yr(e,t,r,a,_){if(At(r)){var n=!0;Ot(t)}else n=!1;if(er(t,_),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),lr(t,r,a,_),ur(t,r,a,_),a=!0;else if(null===e){var o=t.stateNode,i=t.memoizedProps;o.props=i;var s=o.context,c=r.contextType;"object"===typeof c&&null!==c?c=uo.currentDispatcher.readContext(c):(c=At(r)?to:$n.current,c=Pt(t,c));var E=r.getDerivedStateFromProps,l="function"===typeof E||"function"===typeof o.getSnapshotBeforeUpdate;l||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==a||s!==c)&&Tr(t,o,a,c),_o=!1;var T=t.memoizedState;s=o.state=T;var u=t.updateQueue;null!==u&&(qt(t,u,a,o,_),s=t.memoizedState),i!==a||T!==s||eo.current||_o?("function"===typeof E&&(cr(t,r,E,a),s=t.memoizedState),(i=_o||Er(t,r,i,a,T,s,c))?(l||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.effectTag|=4)):("function"===typeof o.componentDidMount&&(t.effectTag|=4),t.memoizedProps=a,t.memoizedState=s),o.props=a,o.state=s,o.context=c,a=i):("function"===typeof o.componentDidMount&&(t.effectTag|=4),a=!1)}else o=t.stateNode,i=t.memoizedProps,o.props=t.type===t.elementType?i:ir(t.type,i),s=o.context,c=r.contextType,"object"===typeof c&&null!==c?c=uo.currentDispatcher.readContext(c):(c=At(r)?to:$n.current,c=Pt(t,c)),E=r.getDerivedStateFromProps,(l="function"===typeof E||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==a||s!==c)&&Tr(t,o,a,c),_o=!1,s=t.memoizedState,T=o.state=s,u=t.updateQueue,null!==u&&(qt(t,u,a,o,_),T=t.memoizedState),i!==a||s!==T||eo.current||_o?("function"===typeof E&&(cr(t,r,E,a),T=t.memoizedState),(E=_o||Er(t,r,i,a,s,T,c))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(a,T,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(a,T,c)),"function"===typeof o.componentDidUpdate&&(t.effectTag|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=256),t.memoizedProps=a,t.memoizedState=T),o.props=a,o.state=T,o.context=c,a=E):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=256),a=!1);return Lr(e,t,r,a,n,_)}function Lr(e,t,r,a,_,n){Ir(e,t);var o=0!==(64&t.effectTag);if(!a&&!o)return _&&Nt(t,r,!1),xr(e,t,n);a=t.stateNode,No.current=t;var i=o&&"function"!==typeof r.getDerivedStateFromError?null:a.render();return t.effectTag|=1,null!==e&&o?(t.child=So(t,e.child,null,n),t.child=So(t,null,i,n)):Nr(e,t,i,n),t.memoizedState=a.state,_&&Nt(t,r,!0),t.child}function Mr(e){var t=e.stateNode;t.pendingContext?vt(e,t.pendingContext,t.pendingContext!==t.context):t.context&&vt(e,t.context,!1),ar(e,t.containerInfo)}function yr(e,t,r){var a=t.mode,_=t.pendingProps,n=t.memoizedState;if(0===(64&t.effectTag)){n=null;var o=!1}else n={timedOutAt:null!==n?n.timedOutAt:0},o=!0,t.effectTag&=-65;return null===e?o?(o=_.fallback,_=yt(null,a,0,null),0===(1&t.mode)&&(_.child=null!==t.memoizedState?t.child.child:t.child),a=yt(o,a,r,null),_.sibling=a,r=_,r.return=a.return=t):r=a=po(t,null,_.children,r):null!==e.memoizedState?(a=e.child,e=a.sibling,o?(r=_.fallback,_=Lt(a,a.pendingProps,0),0===(1&t.mode)&&(o=null!==t.memoizedState?t.child.child:t.child)!==a.child&&(_.child=o),a=_.sibling=Lt(e,r,e.expirationTime),r=_,_.childExpirationTime=0,r.return=a.return=t):r=a=So(t,a.child,_.children,r)):(e=e.child,o?(o=_.fallback,_=yt(null,a,0,null),_.child=e,0===(1&t.mode)&&(_.child=null!==t.memoizedState?t.child.child:t.child),a=_.sibling=yt(o,a,r,null),a.effectTag|=2,r=_,_.childExpirationTime=0,r.return=a.return=t):a=r=So(t,e,_.children,r)),t.memoizedState=n,t.child=r,a}function xr(e,t,r){if(null!==e&&(t.firstContextDependency=e.firstContextDependency),t.childExpirationTime<r)return null;if(null!==e&&t.child!==e.child&&_("153"),null!==t.child){for(e=t.child,r=Lt(e,e.pendingProps,e.expirationTime),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,r=r.sibling=Lt(e,e.pendingProps,e.expirationTime),r.return=t;r.sibling=null}return t.child}function Ur(e,t,r){var a=t.expirationTime;if(null!==e&&e.memoizedProps===t.pendingProps&&!eo.current&&a<r){switch(t.tag){case 3:Mr(t),Or();break;case 5:nr(t);break;case 1:At(t.type)&&Ot(t);break;case 4:ar(t,t.stateNode.containerInfo);break;case 10:Zt(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(a=t.child.childExpirationTime)&&a>=r?yr(e,t,r):(t=xr(e,t,r),null!==t?t.sibling:null)}return xr(e,t,r)}switch(t.expirationTime=0,t.tag){case 2:a=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps;var n=Pt(t,$n.current);if(er(t,r),n=a(e,n),t.effectTag|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof){if(t.tag=1,At(a)){var o=!0;Ot(t)}else o=!1;t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null;var i=a.getDerivedStateFromProps;"function"===typeof i&&cr(t,a,i,e),n.updater=Po,t.stateNode=n,n._reactInternalFiber=t,ur(t,a,e,r),t=Lr(null,t,a,!0,o,r)}else t.tag=0,Nr(null,t,n,r),t=t.child;return t;case 16:switch(n=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),o=t.pendingProps,e=sr(n),t.type=e,n=t.tag=Yt(e),o=ir(e,o),i=void 0,n){case 0:i=br(null,t,e,o,r);break;case 1:i=Yr(null,t,e,o,r);break;case 11:i=gr(null,t,e,o,r);break;case 14:i=hr(null,t,e,ir(e.type,o),a,r);break;default:_("283",e)}return i;case 0:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:ir(a,n),br(e,t,a,n,r);case 1:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:ir(a,n),Yr(e,t,a,n,r);case 3:return Mr(t),a=t.updateQueue,null===a&&_("282"),n=t.memoizedState,n=null!==n?n.element:null,qt(t,a,t.pendingProps,null,r),a=t.memoizedState.element,a===n?(Or(),t=xr(e,t,r)):(n=t.stateNode,(n=(null===e||null===e.child)&&n.hydrate)&&(mo=ut(t.stateNode.containerInfo),vo=t,n=Oo=!0),n?(t.effectTag|=2,t.child=po(t,null,a,r)):(Nr(e,t,a,r),Or()),t=t.child),t;case 5:return nr(t),null===e&&pr(t),a=t.type,n=t.pendingProps,o=null!==e?e.memoizedProps:null,i=n.children,lt(a,n)?i=null:null!==o&&lt(a,o)&&(t.effectTag|=16),Ir(e,t),1!==r&&1&t.mode&&n.hidden?(t.expirationTime=1,t=null):(Nr(e,t,i,r),t=t.child),t;case 6:return null===e&&pr(t),null;case 13:return yr(e,t,r);case 4:return ar(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=So(t,null,a,r):Nr(e,t,a,r),t.child;case 11:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:ir(a,n),gr(e,t,a,n,r);case 7:return Nr(e,t,t.pendingProps,r),t.child;case 8:case 12:return Nr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,n=t.pendingProps,i=t.memoizedProps,o=n.value,Zt(t,o),null!==i){var s=i.value;if(0===(o=s===o&&(0!==s||1/s===1/o)||s!==s&&o!==o?0:0|("function"===typeof a._calculateChangedBits?a._calculateChangedBits(s,o):1073741823))){if(i.children===n.children&&!eo.current){t=xr(e,t,r);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){if(null!==(s=i.firstContextDependency))do{if(s.context===a&&0!==(s.observedBits&o)){if(1===i.tag){var c=Bt(r);c.tag=2,jt(i,c)}i.expirationTime<r&&(i.expirationTime=r),c=i.alternate,null!==c&&c.expirationTime<r&&(c.expirationTime=r);for(var E=i.return;null!==E;){if(c=E.alternate,E.childExpirationTime<r)E.childExpirationTime=r,null!==c&&c.childExpirationTime<r&&(c.childExpirationTime=r);else{if(!(null!==c&&c.childExpirationTime<r))break;c.childExpirationTime=r}E=E.return}}c=i.child,s=s.next}while(null!==s);else c=10===i.tag&&i.type===t.type?null:i.child;if(null!==c)c.return=i;else for(c=i;null!==c;){if(c===t){c=null;break}if(null!==(i=c.sibling)){i.return=c.return,c=i;break}c=c.return}i=c}}Nr(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,o=t.pendingProps,a=o.children,er(t,r),n=tr(n,o.unstable_observedBits),a=a(n),t.effectTag|=1,Nr(e,t,a,r),t.child;case 14:return n=t.type,o=ir(n.type,t.pendingProps),hr(e,t,n,o,a,r);case 15:return Rr(e,t,t.type,t.pendingProps,a,r);case 17:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:ir(a,n),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,At(a)?(e=!0,Ot(t)):e=!1,er(t,r),lr(t,a,n,r),ur(t,a,n,r),Lr(null,t,a,!0,e,r);default:_("156")}}function wr(e){e.effectTag|=4}function Cr(e,t){var r=t.source,a=t.stack;null===a&&null!==r&&(a=te(r)),null!==r&&ee(r.type),t=t.value,null!==e&&1===e.tag&&ee(e.type);try{console.error(t)}catch(e){setTimeout(function(){throw e})}}function Dr(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(t){Jr(e,t)}else t.current=null}function Fr(e){switch("function"===typeof ao&&ao(e),e.tag){case 0:case 11:case 14:case 15:var t=e.updateQueue;if(null!==t&&null!==(t=t.lastEffect)){var r=t=t.next;do{var a=r.destroy;if(null!==a){var _=e;try{a()}catch(e){Jr(_,e)}}r=r.next}while(r!==t)}break;case 1:if(Dr(e),t=e.stateNode,"function"===typeof t.componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Jr(e,t)}break;case 5:Dr(e);break;case 4:Kr(e)}}function Gr(e){return 5===e.tag||3===e.tag||4===e.tag}function kr(e){e:{for(var t=e.return;null!==t;){if(Gr(t)){var r=t;break e}t=t.return}_("160"),r=void 0}var a=t=void 0;switch(r.tag){case 5:t=r.stateNode,a=!1;break;case 3:case 4:t=r.stateNode.containerInfo,a=!0;break;default:_("161")}16&r.effectTag&&(at(t,""),r.effectTag&=-17);e:t:for(r=e;;){for(;null===r.sibling;){if(null===r.return||Gr(r.return)){r=null;break e}r=r.return}for(r.sibling.return=r.return,r=r.sibling;5!==r.tag&&6!==r.tag;){if(2&r.effectTag)continue t;if(null===r.child||4===r.tag)continue t;r.child.return=r,r=r.child}if(!(2&r.effectTag)){r=r.stateNode;break e}}for(var n=e;;){if(5===n.tag||6===n.tag)if(r)if(a){var o=t,i=n.stateNode,s=r;8===o.nodeType?o.parentNode.insertBefore(i,s):o.insertBefore(i,s)}else t.insertBefore(n.stateNode,r);else a?(i=t,s=n.stateNode,8===i.nodeType?(o=i.parentNode,o.insertBefore(s,i)):(o=i,o.appendChild(s)),null!==(i=i._reactRootContainer)&&void 0!==i||null!==o.onclick||(o.onclick=ct)):t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Kr(e){for(var t=e,r=!1,a=void 0,n=void 0;;){if(!r){r=t.return;e:for(;;){switch(null===r&&_("160"),r.tag){case 5:a=r.stateNode,n=!1;break e;case 3:case 4:a=r.stateNode.containerInfo,n=!0;break e}r=r.return}r=!0}if(5===t.tag||6===t.tag){e:for(var o=t,i=o;;)if(Fr(i),null!==i.child&&4!==i.tag)i.child.return=i,i=i.child;else{if(i===o)break;for(;null===i.sibling;){if(null===i.return||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}n?(o=a,i=t.stateNode,8===o.nodeType?o.parentNode.removeChild(i):o.removeChild(i)):a.removeChild(t.stateNode)}else if(4===t.tag?(a=t.stateNode.containerInfo,n=!0):Fr(t),null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;t=t.return,4===t.tag&&(r=!1)}t.sibling.return=t.return,t=t.sibling}}function Br(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 1:break;case 5:var r=t.stateNode;if(null!=r){var a=t.memoizedProps,n=null!==e?e.memoizedProps:a;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(r[Za]=a,"input"===e&&"radio"===a.type&&null!=a.name&&le(r,a),it(e,n),t=it(e,a),n=0;n<o.length;n+=2){var i=o[n],s=o[n+1];"style"===i?nt(r,s):"dangerouslySetInnerHTML"===i?Bn(r,s):"children"===i?at(r,s):ie(r,i,s,t)}switch(e){case"input":Te(r,a);break;case"textarea":$e(r,a);break;case"select":t=r._wrapperState.wasMultiple,r._wrapperState.wasMultiple=!!a.multiple,e=a.value,null!=e?We(r,!!a.multiple,e,!1):t!==!!a.multiple&&(null!=a.defaultValue?We(r,!!a.multiple,a.defaultValue,!0):We(r,!!a.multiple,a.multiple?[]:"",!1))}}}break;case 6:null===t.stateNode&&_("162"),t.stateNode.nodeValue=t.memoizedProps;break;case 3:case 12:break;case 13:if(r=t.memoizedState,e=t,null===r?a=!1:(a=!0,e=t.child,0===r.timedOutAt&&(r.timedOutAt=ia())),null!==e)e:for(t=r=e;;){if(5===t.tag)e=t.stateNode,a?e.style.display="none":(e=t.stateNode,o=t.memoizedProps.style,o=void 0!==o&&null!==o&&o.hasOwnProperty("display")?o.display:null,e.style.display=_t("display",o));else if(6===t.tag)t.stateNode.nodeValue=a?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState){e=t.child.sibling,e.return=t,t=e;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===r)break e;for(;null===t.sibling;){if(null===t.return||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}break;case 17:break;default:_("163")}}function Xr(e,t,r){r=Bt(r),r.tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){Pa(a),Cr(e,t)},r}function jr(e,t,r){r=Bt(r),r.tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var _=t.value;r.payload=function(){return a(_)}}var n=e.stateNode;return null!==n&&"function"===typeof n.componentDidCatch&&(r.callback=function(){"function"!==typeof a&&(null===Bo?Bo=new Set([this]):Bo.add(this));var r=t.value,_=t.stack;Cr(e,t),this.componentDidCatch(r,{componentStack:null!==_?_:""})}),r}function Hr(e){switch(e.tag){case 1:At(e.type)&&St(e);var t=e.effectTag;return 2048&t?(e.effectTag=-2049&t|64,e):null;case 3:return _r(e),pt(e),t=e.effectTag,0!==(64&t)&&_("285"),e.effectTag=-2049&t|64,e;case 5:return or(e),null;case 13:return t=e.effectTag,2048&t?(e.effectTag=-2049&t|64,e):null;case 4:return _r(e),null;case 10:return $t(e),null;default:return null}}function Qr(){if(null!==xo)for(var e=xo.return;null!==e;){var t=e;switch(t.tag){case 1:var r=t.type.childContextTypes;null!==r&&void 0!==r&&St(t);break;case 3:_r(t),pt(t);break;case 5:or(t);break;case 4:_r(t);break;case 10:$t(t)}e=e.return}Uo=null,wo=0,Co=-1,Do=!1,xo=null}function zr(){null!==Ko&&(xa.unstable_cancelCallback(ko),Ko())}function qr(e){for(;;){var t=e.alternate,r=e.return,a=e.sibling;if(0===(1024&e.effectTag)){xo=e;e:{var n=t;t=e;var o=wo,i=t.pendingProps;switch(t.tag){case 2:case 16:break;case 15:case 0:break;case 1:At(t.type)&&St(t);break;case 3:_r(t),pt(t),i=t.stateNode,i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==n&&null!==n.child||(mr(t),t.effectTag&=-3),ho(t);break;case 5:or(t);var s=rr(To.current);if(o=t.type,null!==n&&null!=t.stateNode)Ro(n,t,o,i,s),n.ref!==t.ref&&(t.effectTag|=128);else if(i){var c=rr(Eo.current);if(mr(t)){i=t,n=i.stateNode;var E=i.type,l=i.memoizedProps,T=s;switch(n[Ja]=i,n[Za]=l,o=void 0,s=E){case"iframe":case"object":Ce("load",n);break;case"video":case"audio":for(E=0;E<i_.length;E++)Ce(i_[E],n);break;case"source":Ce("error",n);break;case"img":case"image":case"link":Ce("error",n),Ce("load",n);break;case"form":Ce("reset",n),Ce("submit",n);break;case"details":Ce("toggle",n);break;case"input":Ee(n,l),Ce("invalid",n),st(T,"onChange");break;case"select":n._wrapperState={wasMultiple:!!l.multiple},Ce("invalid",n),st(T,"onChange");break;case"textarea":Ze(n,l),Ce("invalid",n),st(T,"onChange")}ot(s,l),E=null;for(o in l)l.hasOwnProperty(o)&&(c=l[o],"children"===o?"string"===typeof c?n.textContent!==c&&(E=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(E=["children",""+c]):Xa.hasOwnProperty(o)&&null!=c&&st(T,o));switch(s){case"input":J(n),ue(n,l,!0);break;case"textarea":J(n),et(n,l);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(n.onclick=ct)}o=E,i.updateQueue=o,i=null!==o,i&&wr(t)}else{l=t,n=o,T=i,E=9===s.nodeType?s:s.ownerDocument,c===kn.html&&(c=tt(n)),c===kn.html?"script"===n?(n=E.createElement("div"),n.innerHTML="<script><\/script>",E=n.removeChild(n.firstChild)):"string"===typeof T.is?E=E.createElement(n,{is:T.is}):(E=E.createElement(n),"select"===n&&T.multiple&&(E.multiple=!0)):E=E.createElementNS(c,n),n=E,n[Ja]=l,n[Za]=i,go(n,t,!1,!1),T=n,E=o,l=i;var u=s,d=it(E,l);switch(E){case"iframe":case"object":Ce("load",T),s=l;break;case"video":case"audio":for(s=0;s<i_.length;s++)Ce(i_[s],T);s=l;break;case"source":Ce("error",T),s=l;break;case"img":case"image":case"link":Ce("error",T),Ce("load",T),s=l;break;case"form":Ce("reset",T),Ce("submit",T),s=l;break;case"details":Ce("toggle",T),s=l;break;case"input":Ee(T,l),s=ce(T,l),Ce("invalid",T),st(u,"onChange");break;case"option":s=Ve(T,l);break;case"select":T._wrapperState={wasMultiple:!!l.multiple},s=ya({},l,{value:void 0}),Ce("invalid",T),st(u,"onChange");break;case"textarea":Ze(T,l),s=Je(T,l),Ce("invalid",T),st(u,"onChange");break;default:s=l}ot(E,s),c=void 0;var f=E,P=T,A=s;for(c in A)if(A.hasOwnProperty(c)){var S=A[c];"style"===c?nt(P,S):"dangerouslySetInnerHTML"===c?null!=(S=S?S.__html:void 0)&&Bn(P,S):"children"===c?"string"===typeof S?("textarea"!==f||""!==S)&&at(P,S):"number"===typeof S&&at(P,""+S):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(Xa.hasOwnProperty(c)?null!=S&&st(u,c):null!=S&&ie(P,c,S,d))}switch(E){case"input":J(T),ue(T,l,!1);break;case"textarea":J(T),et(T,l);break;case"option":null!=l.value&&T.setAttribute("value",""+se(l.value));break;case"select":s=T,s.multiple=!!l.multiple,T=l.value,null!=T?We(s,!!l.multiple,T,!1):null!=l.defaultValue&&We(s,!!l.multiple,l.defaultValue,!0);break;default:"function"===typeof s.onClick&&(T.onclick=ct)}(i=Et(o,i))&&wr(t),t.stateNode=n}null!==t.ref&&(t.effectTag|=128)}else null===t.stateNode&&_("166");break;case 6:n&&null!=t.stateNode?Io(n,t,n.memoizedProps,i):("string"!==typeof i&&(null===t.stateNode&&_("166")),n=rr(To.current),rr(Eo.current),mr(t)?(i=t,o=i.stateNode,n=i.memoizedProps,o[Ja]=i,(i=o.nodeValue!==n)&&wr(t)):(o=t,i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i),i[Ja]=t,o.stateNode=i));break;case 11:break;case 13:if(i=t.memoizedState,0!==(64&t.effectTag)){t.expirationTime=o,xo=t;break e}i=null!==i,o=null!==n&&null!==n.memoizedState,null!==n&&!i&&o&&null!==(n=n.child.sibling)&&(s=t.firstEffect,null!==s?(t.firstEffect=n,n.nextEffect=s):(t.firstEffect=t.lastEffect=n,n.nextEffect=null),n.effectTag=8),(i!==o||0===(1&t.effectTag)&&i)&&(t.effectTag|=4);break;case 7:case 8:case 12:break;case 4:_r(t),ho(t);break;case 10:$t(t);break;case 9:case 14:break;case 17:At(t.type)&&St(t);break;default:_("156")}xo=null}if(t=e,1===wo||1!==t.childExpirationTime){for(i=0,o=t.child;null!==o;)n=o.expirationTime,s=o.childExpirationTime,n>i&&(i=n),s>i&&(i=s),o=o.sibling;t.childExpirationTime=i}if(null!==xo)return xo;null!==r&&0===(1024&r.effectTag)&&(null===r.firstEffect&&(r.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==r.lastEffect&&(r.lastEffect.nextEffect=e.firstEffect),r.lastEffect=e.lastEffect),1<e.effectTag&&(null!==r.lastEffect?r.lastEffect.nextEffect=e:r.firstEffect=e,r.lastEffect=e))}else{if(null!==(e=Hr(e,wo)))return e.effectTag&=1023,e;null!==r&&(r.firstEffect=r.lastEffect=null,r.effectTag|=1024)}if(null!==a)return a;if(null===r)break;e=r}return null}function Vr(e){var t=Ur(e.alternate,e,wo);return e.memoizedProps=e.pendingProps,null===t&&(t=qr(e)),Yo.current=null,t}function Wr(e,t){yo&&_("243"),zr(),yo=!0,Yo.currentDispatcher=bo;var r=e.nextExpirationTimeToWorkOn;r===wo&&e===Uo&&null!==xo||(Qr(),Uo=e,wo=r,xo=Lt(Uo.current,null,wo),e.pendingCommitExpirationTime=0);for(var a=!1;;){try{if(t)for(;null!==xo&&!Ea();)xo=Vr(xo);else for(;null!==xo;)xo=Vr(xo)}catch(t){if(so=io=oo=null,null===xo)a=!0,Pa(t);else{null===xo&&_("271");var n=xo,o=n.return;if(null!==o){e:{var i=e,s=o,c=n,E=t;if(o=wo,c.effectTag|=1024,c.firstEffect=c.lastEffect=null,null!==E&&"object"===typeof E&&"function"===typeof E.then){var l=E;E=s;var T=-1,u=-1;do{if(13===E.tag){var d=E.alternate;if(null!==d&&null!==(d=d.memoizedState)){u=10*(1073741822-d.timedOutAt);break}d=E.pendingProps.maxDuration,"number"===typeof d&&(0>=d?T=0:(-1===T||d<T)&&(T=d))}E=E.return}while(null!==E);E=s;do{if((d=13===E.tag)&&(d=void 0!==E.memoizedProps.fallback&&null===E.memoizedState),d){if(s=$r.bind(null,i,E,c,0===(1&E.mode)?1073741823:o),l.then(s,s),0===(1&E.mode)){E.effectTag|=64,c.effectTag&=-1957,1===c.tag&&null===c.alternate&&(c.tag=17),c.expirationTime=o;break e}-1===T?i=1073741823:(-1===u&&(u=10*(1073741822-Ft(i,o))-5e3),i=u+T),0<=i&&Co<i&&(Co=i),E.effectTag|=2048,E.expirationTime=o;break e}E=E.return}while(null!==E);E=Error((ee(c.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+te(c))}Do=!0,E=Jt(E,c),i=s;do{switch(i.tag){case 3:c=E,i.effectTag|=2048,i.expirationTime=o,o=Xr(i,c,o),Ht(i,o);break e;case 1:if(c=E,s=i.type,l=i.stateNode,0===(64&i.effectTag)&&("function"===typeof s.getDerivedStateFromError||null!==l&&"function"===typeof l.componentDidCatch&&(null===Bo||!Bo.has(l)))){i.effectTag|=2048,i.expirationTime=o,o=jr(i,c,o),Ht(i,o);break e}}i=i.return}while(null!==i)}xo=qr(n);continue}a=!0,Pa(t)}}break}if(yo=!1,so=io=oo=Yo.currentDispatcher=null,a)Uo=null,e.finishedWork=null;else if(null!==xo)e.finishedWork=null;else{if(a=e.current.alternate,null===a&&_("281"),Uo=null,Do){if(n=e.latestPendingTime,o=e.latestSuspendedTime,i=e.latestPingedTime,0!==n&&n<r||0!==o&&o<r||0!==i&&i<r)return Dt(e,r),void na(e,a,r,e.expirationTime,-1);if(!e.didError&&t)return e.didError=!0,r=e.nextExpirationTimeToWorkOn=r,t=e.expirationTime=1073741823,void na(e,a,r,t,-1)}t&&-1!==Co?(Dt(e,r),t=10*(1073741822-Ft(e,r)),t<Co&&(Co=t),t=10*(1073741822-ia()),t=Co-t,na(e,a,r,e.expirationTime,0>t?0:t)):(e.pendingCommitExpirationTime=r,e.finishedWork=a)}}function Jr(e,t){for(var r=e.return;null!==r;){switch(r.tag){case 1:var a=r.stateNode;if("function"===typeof r.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Bo||!Bo.has(a)))return e=Jt(t,e),e=jr(r,e,1073741823),jt(r,e),void ta(r,1073741823);break;case 3:return e=Jt(t,e),e=Xr(r,e,1073741823),jt(r,e),void ta(r,1073741823)}r=r.return}3===e.tag&&(r=Jt(t,e),r=Xr(e,r,1073741823),jt(e,r),ta(e,1073741823))}function Zr(e,t){return 0!==Mo?e=Mo:yo?e=Go?1073741823:wo:1&t.mode?(e=ti?1073741822-10*(1+((1073741822-e+15)/10|0)):1073741822-25*(1+((1073741822-e+500)/25|0)),null!==Uo&&e===wo&&--e):e=1073741823,ti&&(0===Wo||e<Wo)&&(Wo=e),e}function $r(e,t,r,a){var _=e.earliestSuspendedTime,n=e.latestSuspendedTime;if(0!==_&&a<=_&&a>=n){n=_=a,e.didError=!1;var o=e.latestPingedTime;(0===o||o>n)&&(e.latestPingedTime=n),Gt(n,e)}else _=ia(),_=Zr(_,t),Ct(e,_);0!==(1&t.mode)&&e===Uo&&wo===a&&(Uo=null),ea(t,_),0===(1&t.mode)&&(ea(r,_),1===r.tag&&null!==r.stateNode&&(t=Bt(_),t.tag=2,jt(r,t))),0!==(r=e.expirationTime)&&sa(e,r)}function ea(e,t){e.expirationTime<t&&(e.expirationTime=t);var r=e.alternate;null!==r&&r.expirationTime<t&&(r.expirationTime=t);var a=e.return,_=null;if(null===a&&3===e.tag)_=e.stateNode;else for(;null!==a;){if(r=a.alternate,a.childExpirationTime<t&&(a.childExpirationTime=t),null!==r&&r.childExpirationTime<t&&(r.childExpirationTime=t),null===a.return&&3===a.tag){_=a.stateNode;break}a=a.return}return _}function ta(e,t){null!==(e=ea(e,t))&&(!yo&&0!==wo&&t>wo&&Qr(),Ct(e,t),yo&&!Go&&Uo===e||sa(e,e.expirationTime),ii>oi&&(ii=0,_("185")))}function ra(e,t,r,a,_){var n=Mo;Mo=1073741823;try{return e(t,r,a,_)}finally{Mo=n}}function aa(){_i=1073741822-((xa.unstable_now()-ai)/10|0)}function _a(e,t){if(0!==Ho){if(t<Ho)return;null!==Qo&&xa.unstable_cancelCallback(Qo)}Ho=t,e=xa.unstable_now()-ai,Qo=xa.unstable_scheduleCallback(la,{timeout:10*(1073741822-t)-e})}function na(e,t,r,a,_){e.expirationTime=a,0!==_||Ea()?0<_&&(e.timeoutHandle=qn(oa.bind(null,e,t,r),_)):(e.pendingCommitExpirationTime=r,e.finishedWork=t)}function oa(e,t,r){e.pendingCommitExpirationTime=r,e.finishedWork=t,aa(),ni=_i,ua(e,r)}function ia(){return zo?ni:(ca(),0!==Vo&&1!==Vo||(aa(),ni=_i),ni)}function sa(e,t){null===e.nextScheduledRoot?(e.expirationTime=t,null===jo?(Xo=jo=e,e.nextScheduledRoot=e):(jo=jo.nextScheduledRoot=e,jo.nextScheduledRoot=Xo)):t>e.expirationTime&&(e.expirationTime=t),zo||($o?ei&&(qo=e,Vo=1073741823,da(e,1073741823,!1)):1073741823===t?Ta(1073741823,!1):_a(e,t))}function ca(){var e=0,t=null;if(null!==jo)for(var r=jo,a=Xo;null!==a;){var n=a.expirationTime;if(0===n){if((null===r||null===jo)&&_("244"),a===a.nextScheduledRoot){Xo=jo=a.nextScheduledRoot=null;break}if(a===Xo)Xo=n=a.nextScheduledRoot,jo.nextScheduledRoot=n,a.nextScheduledRoot=null;else{if(a===jo){jo=r,jo.nextScheduledRoot=Xo,a.nextScheduledRoot=null;break}r.nextScheduledRoot=a.nextScheduledRoot,a.nextScheduledRoot=null}a=r.nextScheduledRoot}else{if(n>e&&(e=n,t=a),a===jo)break;if(1073741823===e)break;r=a,a=a.nextScheduledRoot}}qo=t,Vo=e}function Ea(){return!!ci||!!xa.unstable_shouldYield()&&(ci=!0)}function la(){try{if(!Ea()&&null!==Xo){aa();var e=Xo;do{var t=e.expirationTime;0!==t&&_i<=t&&(e.nextExpirationTimeToWorkOn=_i),e=e.nextScheduledRoot}while(e!==Xo)}Ta(0,!0)}finally{ci=!1}}function Ta(e,t){if(ca(),t)for(aa(),ni=_i;null!==qo&&0!==Vo&&e<=Vo&&!(ci&&_i>Vo);)da(qo,Vo,_i>Vo),ca(),aa(),ni=_i;else for(;null!==qo&&0!==Vo&&e<=Vo;)da(qo,Vo,!1),ca();if(t&&(Ho=0,Qo=null),0!==Vo&&_a(qo,Vo),ii=0,si=null,null!==ri)for(e=ri,ri=null,t=0;t<e.length;t++){var r=e[t];try{r._onComplete()}catch(e){Jo||(Jo=!0,Zo=e)}}if(Jo)throw e=Zo,Zo=null,Jo=!1,e}function ua(e,t){zo&&_("253"),qo=e,Vo=t,da(e,t,!1),Ta(1073741823,!1)}function da(e,t,r){if(zo&&_("245"),zo=!0,r){var a=e.finishedWork;null!==a?fa(e,a,t):(e.finishedWork=null,a=e.timeoutHandle,-1!==a&&(e.timeoutHandle=-1,Vn(a)),Wr(e,r),null!==(a=e.finishedWork)&&(Ea()?e.finishedWork=a:fa(e,a,t)))}else a=e.finishedWork,null!==a?fa(e,a,t):(e.finishedWork=null,a=e.timeoutHandle,-1!==a&&(e.timeoutHandle=-1,Vn(a)),Wr(e,r),null!==(a=e.finishedWork)&&fa(e,a,t));zo=!1}function fa(e,t,r){var a=e.firstBatch;if(null!==a&&a._expirationTime>=r&&(null===ri?ri=[a]:ri.push(a),a._defer))return e.finishedWork=t,void(e.expirationTime=0);e.finishedWork=null,e===si?ii++:(si=e,ii=0),Go=yo=!0,e.current===t&&_("177"),r=e.pendingCommitExpirationTime,0===r&&_("261"),e.pendingCommitExpirationTime=0,a=t.expirationTime;var n=t.childExpirationTime;if(a=n>a?n:a,e.didError=!1,0===a?(e.earliestPendingTime=0,e.latestPendingTime=0,e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0):(n=e.latestPendingTime,0!==n&&(n>a?e.earliestPendingTime=e.latestPendingTime=0:e.earliestPendingTime>a&&(e.earliestPendingTime=e.latestPendingTime)),n=e.earliestSuspendedTime,0===n?Ct(e,a):a<e.latestSuspendedTime?(e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0,Ct(e,a)):a>n&&Ct(e,a)),Gt(0,e),Yo.current=null,1<t.effectTag?null!==t.lastEffect?(t.lastEffect.nextEffect=t,a=t.firstEffect):a=t:a=t.firstEffect,Qn=Yn,n=He(),Qe(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var i=o.getSelection&&o.getSelection();if(i&&0!==i.rangeCount){o=i.anchorNode;var s=i.anchorOffset,c=i.focusNode;i=i.focusOffset;try{o.nodeType,c.nodeType}catch(e){o=null;break e}var E=0,l=-1,T=-1,u=0,d=0,f=n,P=null;t:for(;;){for(var A;f!==o||0!==s&&3!==f.nodeType||(l=E+s),f!==c||0!==i&&3!==f.nodeType||(T=E+i),3===f.nodeType&&(E+=f.nodeValue.length),null!==(A=f.firstChild);)P=f,f=A;for(;;){if(f===n)break t;if(P===o&&++u===s&&(l=E),P===c&&++d===i&&(T=E),null!==(A=f.nextSibling))break;f=P,P=f.parentNode}f=A}o=-1===l||-1===T?null:{start:l,end:T}}else o=null}o=o||{start:0,end:0}}else o=null;for(zn={focusedElem:n,selectionRange:o},Yn=!1,Fo=a;null!==Fo;){n=!1,o=void 0;try{for(;null!==Fo;){if(256&Fo.effectTag)e:{var S=Fo.alternate;switch(s=Fo,s.tag){case 0:case 11:case 15:break e;case 1:if(256&s.effectTag&&null!==S){var p=S.memoizedProps,v=S.memoizedState,m=s.stateNode,O=m.getSnapshotBeforeUpdate(s.elementType===s.type?p:ir(s.type,p),v);m.__reactInternalSnapshotBeforeUpdate=O}break e;case 3:case 5:case 6:case 4:case 17:break e;default:_("163")}}Fo=Fo.nextEffect}}catch(e){n=!0,o=e}n&&(null===Fo&&_("178"),Jr(Fo,o),null!==Fo&&(Fo=Fo.nextEffect))}for(Fo=a;null!==Fo;){S=!1,p=void 0;try{for(;null!==Fo;){var N=Fo.effectTag;if(16&N&&at(Fo.stateNode,""),128&N){var g=Fo.alternate;if(null!==g){var h=g.ref;null!==h&&("function"===typeof h?h(null):h.current=null)}}switch(14&N){case 2:kr(Fo),Fo.effectTag&=-3;break;case 6:kr(Fo),Fo.effectTag&=-3,Br(Fo.alternate,Fo);break;case 4:Br(Fo.alternate,Fo);break;case 8:v=Fo,Kr(v),v.return=null,v.child=null,v.alternate&&(v.alternate.child=null,v.alternate.return=null)}Fo=Fo.nextEffect}}catch(e){S=!0,p=e}S&&(null===Fo&&_("178"),Jr(Fo,p),null!==Fo&&(Fo=Fo.nextEffect))}if(h=zn,g=He(),N=h.focusedElem,p=h.selectionRange,g!==N&&N&&N.ownerDocument&&je(N.ownerDocument.documentElement,N)){null!==p&&Qe(N)&&(g=p.start,h=p.end,void 0===h&&(h=g),"selectionStart"in N?(N.selectionStart=g,N.selectionEnd=Math.min(h,N.value.length)):(h=(g=N.ownerDocument||document)&&g.defaultView||window,h.getSelection&&(h=h.getSelection(),v=N.textContent.length,S=Math.min(p.start,v),p=void 0===p.end?S:Math.min(p.end,v),!h.extend&&S>p&&(v=p,p=S,S=v),v=Xe(N,S),m=Xe(N,p),v&&m&&(1!==h.rangeCount||h.anchorNode!==v.node||h.anchorOffset!==v.offset||h.focusNode!==m.node||h.focusOffset!==m.offset)&&(g=g.createRange(),g.setStart(v.node,v.offset),h.removeAllRanges(),S>p?(h.addRange(g),h.extend(m.node,m.offset)):(g.setEnd(m.node,m.offset),h.addRange(g)))))),g=[];for(h=N;h=h.parentNode;)1===h.nodeType&&g.push({element:h,left:h.scrollLeft,top:h.scrollTop});for("function"===typeof N.focus&&N.focus(),N=0;N<g.length;N++)h=g[N],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}for(zn=null,Yn=!!Qn,Qn=null,e.current=t,Fo=a;null!==Fo;){a=!1,N=void 0;try{for(g=r;null!==Fo;){var R=Fo.effectTag;if(36&R){var I=Fo.alternate;switch(h=Fo,S=g,h.tag){case 0:case 11:case 15:break;case 1:var b=h.stateNode;if(4&h.effectTag)if(null===I)b.componentDidMount();else{var Y=h.elementType===h.type?I.memoizedProps:ir(h.type,I.memoizedProps);b.componentDidUpdate(Y,I.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var L=h.updateQueue;null!==L&&Vt(h,L,b,S);break;case 3:var M=h.updateQueue;if(null!==M){if(p=null,null!==h.child)switch(h.child.tag){case 5:p=h.child.stateNode;break;case 1:p=h.child.stateNode}Vt(h,M,p,S)}break;case 5:var y=h.stateNode;null===I&&4&h.effectTag&&Et(h.type,h.memoizedProps)&&y.focus();break;case 6:case 4:case 12:case 13:case 17:break;default:_("163")}}if(128&R){var x=Fo.ref;if(null!==x){var U=Fo.stateNode;switch(Fo.tag){case 5:var w=U;break;default:w=U}"function"===typeof x?x(w):x.current=w}}Fo=Fo.nextEffect}}catch(e){a=!0,N=e}a&&(null===Fo&&_("178"),Jr(Fo,N),null!==Fo&&(Fo=Fo.nextEffect))}yo=Go=!1,"function"===typeof ro&&ro(t.stateNode),R=t.expirationTime,t=t.childExpirationTime,t=t>R?t:R,0===t&&(Bo=null),e.expirationTime=t,e.finishedWork=null}function Pa(e){null===qo&&_("246"),qo.expirationTime=0,Jo||(Jo=!0,Zo=e)}function Aa(e,t){var r=$o;$o=!0;try{return e(t)}finally{($o=r)||zo||Ta(1073741823,!1)}}function Sa(e,t){if($o&&!ei){ei=!0;try{return e(t)}finally{ei=!1}}return e(t)}function pa(e,t,r){if(ti)return e(t,r);$o||zo||0===Wo||(Ta(Wo,!1),Wo=0);var a=ti,_=$o;$o=ti=!0;try{return e(t,r)}finally{ti=a,($o=_)||zo||Ta(1073741823,!1)}}function va(e,t,r,a,n){var o=t.current;e:if(r){r=r._reactInternalFiber;t:{2===Ye(r)&&1===r.tag||_("170");var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(At(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(null!==i);_("171"),i=void 0}if(1===r.tag){var s=r.type;if(At(s)){r=mt(r,s,i);break e}}r=i}else r=Zn;return null===t.context?t.context=r:t.pendingContext=r,t=n,n=Bt(a),n.payload={element:e},t=void 0===t?null:t,null!==t&&(n.callback=t),zr(),jt(o,n),ta(o,a),a}function ma(e,t,r,a){var _=t.current;return _=Zr(ia(),_),va(e,t,r,_,a)}function Oa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Na(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:y_,key:null==a?null:""+a,children:e,containerInfo:t,implementation:r}}function ga(e){var t=1073741822-25*(1+((1073741822-ia()+500)/25|0));t>=Lo&&(t=Lo-1),this._expirationTime=Lo=t,this._root=e,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function ha(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function Ra(e,t,r){t=It(3,null,null,t?3:0),e={current:t,containerInfo:e,pendingChildren:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,didError:!1,pendingCommitExpirationTime:0,finishedWork:null,timeoutHandle:-1,context:null,pendingContext:null,hydrate:r,nextExpirationTimeToWorkOn:0,expirationTime:0,firstBatch:null,nextScheduledRoot:null},this._internalRoot=t.stateNode=e}function Ia(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ba(e,t){if(t||(t=e?9===e.nodeType?e.documentElement:e.firstChild:null,t=!(!t||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var r;r=e.lastChild;)e.removeChild(r);return new Ra(e,!1,t)}function Ya(e,t,r,a,n){Ia(r)||_("200");var o=r._reactRootContainer;if(o){if("function"===typeof n){var i=n;n=function(){var e=Oa(o._internalRoot);i.call(e)}}null!=e?o.legacy_renderSubtreeIntoContainer(e,t,n):o.render(t,n)}else{if(o=r._reactRootContainer=ba(r,a),"function"===typeof n){var s=n;n=function(){var e=Oa(o._internalRoot);s.call(e)}}Sa(function(){null!=e?o.legacy_renderSubtreeIntoContainer(e,t,n):o.render(t,n)})}return Oa(o._internalRoot)}function La(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Ia(t)||_("200"),Na(e,t,null,r)}var Ma=r(27),ya=r(65),xa=r(101);Ma||_("227");var Ua=!1,wa=null,Ca=!1,Da=null,Fa={onError:function(e){Ua=!0,wa=e}},Ga=null,ka={},Ka=[],Ba={},Xa={},ja={},Ha=null,Qa=null,za=null,qa=null,Va={injectEventPluginOrder:function(e){Ga&&_("101"),Ga=Array.prototype.slice.call(e),s()},injectEventPluginsByName:function(e){var t,r=!1;for(t in e)if(e.hasOwnProperty(t)){var a=e[t];ka.hasOwnProperty(t)&&ka[t]===a||(ka[t]&&_("102",t),ka[t]=a,r=!0)}r&&s()}},Wa=Math.random().toString(36).slice(2),Ja="__reactInternalInstance$"+Wa,Za="__reactEventHandlers$"+Wa,$a=!("undefined"===typeof window||!window.document||!window.document.createElement),e_={animationend:R("Animation","AnimationEnd"),animationiteration:R("Animation","AnimationIteration"),animationstart:R("Animation","AnimationStart"),transitionend:R("Transition","TransitionEnd")},t_={},r_={};$a&&(r_=document.createElement("div").style,"AnimationEvent"in window||(delete e_.animationend.animation,delete e_.animationiteration.animation,delete e_.animationstart.animation),"TransitionEvent"in window||delete e_.transitionend.transition);var a_=I("animationend"),__=I("animationiteration"),n_=I("animationstart"),o_=I("transitionend"),i_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),s_=null,c_=null,E_=null;ya(M.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Y)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Y)},persist:function(){this.isPersistent=Y},isPersistent:L,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=L,this._dispatchInstances=this._dispatchListeners=null}}),M.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},M.extend=function(e){function t(){}function r(){return a.apply(this,arguments)}var a=this;t.prototype=a.prototype;var _=new t;return ya(_,r.prototype),r.prototype=_,r.prototype.constructor=r,r.Interface=ya({},a.Interface,e),r.extend=a.extend,U(r),r},U(M);var l_=M.extend({data:null}),T_=M.extend({data:null}),u_=[9,13,27,32],d_=$a&&"CompositionEvent"in window,f_=null;$a&&"documentMode"in document&&(f_=document.documentMode);var P_=$a&&"TextEvent"in window&&!f_,A_=$a&&(!d_||f_&&8<f_&&11>=f_),S_=String.fromCharCode(32),p_={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},v_=!1,m_=!1,O_={eventTypes:p_,extractEvents:function(e,t,r,a){var _=void 0,n=void 0;if(d_)e:{switch(e){case"compositionstart":_=p_.compositionStart;break e;case"compositionend":_=p_.compositionEnd;break e;case"compositionupdate":_=p_.compositionUpdate;break e}_=void 0}else m_?w(e,r)&&(_=p_.compositionEnd):"keydown"===e&&229===r.keyCode&&(_=p_.compositionStart);return _?(A_&&"ko"!==r.locale&&(m_||_!==p_.compositionStart?_===p_.compositionEnd&&m_&&(n=b()):(s_=a,c_="value"in s_?s_.value:s_.textContent,m_=!0)),_=l_.getPooled(_,t,r,a),n?_.data=n:null!==(n=C(r))&&(_.data=n),h(_),n=_):n=null,(e=P_?D(e,r):F(e,r))?(t=T_.getPooled(p_.beforeInput,t,r,a),t.data=e,h(t)):t=null,null===n?t:null===t?n:[n,t]}},N_=null,g_=null,h_=null,R_=!1,I_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},b_=Ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Y_=/^(.*)[\\\/]/,L_="function"===typeof Symbol&&Symbol.for,M_=L_?Symbol.for("react.element"):60103,y_=L_?Symbol.for("react.portal"):60106,x_=L_?Symbol.for("react.fragment"):60107,U_=L_?Symbol.for("react.strict_mode"):60108,w_=L_?Symbol.for("react.profiler"):60114,C_=L_?Symbol.for("react.provider"):60109,D_=L_?Symbol.for("react.context"):60110,F_=L_?Symbol.for("react.concurrent_mode"):60111,G_=L_?Symbol.for("react.forward_ref"):60112,k_=L_?Symbol.for("react.suspense"):60113,K_=L_?Symbol.for("react.memo"):60115,B_=L_?Symbol.for("react.lazy"):60116,X_="function"===typeof Symbol&&Symbol.iterator,j_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H_=Object.prototype.hasOwnProperty,Q_={},z_={},q_={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){q_[e]=new ne(e,0,!1,e,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];q_[t]=new ne(t,1,!1,e[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){q_[e]=new ne(e,2,!1,e.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){q_[e]=new ne(e,2,!1,e,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){q_[e]=new ne(e,3,!1,e.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(e){q_[e]=new ne(e,3,!0,e,null)}),["capture","download"].forEach(function(e){q_[e]=new ne(e,4,!1,e,null)}),["cols","rows","size","span"].forEach(function(e){q_[e]=new ne(e,6,!1,e,null)}),["rowSpan","start"].forEach(function(e){q_[e]=new ne(e,5,!1,e.toLowerCase(),null)});var V_=/[\-:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(V_,oe);q_[t]=new ne(t,1,!1,e,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(V_,oe);q_[t]=new ne(t,1,!1,e,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(V_,oe);q_[t]=new ne(t,1,!1,e,"http://www.w3.org/XML/1998/namespace")}),q_.tabIndex=new ne("tabIndex",1,!1,"tabindex",null);var W_={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},J_=null,Z_=null,$_=!1;$a&&($_=q("input")&&(!document.documentMode||9<document.documentMode));var en={eventTypes:W_,_isInputEventSupported:$_,extractEvents:function(e,t,r,a){var _=t?S(t):window,n=void 0,o=void 0,i=_.nodeName&&_.nodeName.toLowerCase();if("select"===i||"input"===i&&"file"===_.type?n=Se:Q(_)?$_?n=ge:(n=Oe,o=me):(i=_.nodeName)&&"input"===i.toLowerCase()&&("checkbox"===_.type||"radio"===_.type)&&(n=Ne),n&&(n=n(e,t)))return fe(n,r,a);o&&o(e,_,t),"blur"===e&&(e=_._wrapperState)&&e.controlled&&"number"===_.type&&de(_,"number",_.value)}},tn=M.extend({view:null,detail:null}),rn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},an=0,_n=0,nn=!1,on=!1,sn=tn.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Re,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=an;return an=e.screenX,nn?"mousemove"===e.type?e.screenX-t:0:(nn=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=_n;return _n=e.screenY,on?"mousemove"===e.type?e.screenY-t:0:(on=!0,0)}}),cn=sn.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),En={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},ln={eventTypes:En,extractEvents:function(e,t,r,a){var _="mouseover"===e||"pointerover"===e,n="mouseout"===e||"pointerout"===e;if(_&&(r.relatedTarget||r.fromElement)||!n&&!_)return null;if(_=a.window===a?a:(_=a.ownerDocument)?_.defaultView||_.parentWindow:window,n?(n=t,t=(t=r.relatedTarget||r.toElement)?P(t):null):n=null,n===t)return null;var o=void 0,i=void 0,s=void 0,c=void 0;"mouseout"===e||"mouseover"===e?(o=sn,i=En.mouseLeave,s=En.mouseEnter,c="mouse"):"pointerout"!==e&&"pointerover"!==e||(o=cn,i=En.pointerLeave,s=En.pointerEnter,c="pointer");var E=null==n?_:S(n);if(_=null==t?_:S(t),e=o.getPooled(i,n,r,a),e.type=c+"leave",e.target=E,e.relatedTarget=_,r=o.getPooled(s,t,r,a),r.type=c+"enter",r.target=_,r.relatedTarget=E,a=t,n&&a)e:{for(t=n,_=a,c=0,o=t;o;o=v(o))c++;for(o=0,s=_;s;s=v(s))o++;for(;0<c-o;)t=v(t),c--;for(;0<o-c;)_=v(_),o--;for(;c--;){if(t===_||t===_.alternate)break e;t=v(t),_=v(_)}t=null}else t=null;for(_=t,t=[];n&&n!==_&&(null===(c=n.alternate)||c!==_);)t.push(n),n=v(n);for(n=[];a&&a!==_&&(null===(c=a.alternate)||c!==_);)n.push(a),a=v(a);for(a=0;a<t.length;a++)N(t[a],"bubbled",e);for(a=n.length;0<a--;)N(n[a],"captured",r);return[e,r]}},Tn=Object.prototype.hasOwnProperty,un=M.extend({animationName:null,elapsedTime:null,pseudoElement:null}),dn=M.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fn=tn.extend({relatedTarget:null}),Pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},An={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn=tn.extend({key:function(e){if(e.key){var t=Pn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?(e=xe(e),13===e?"Enter":String.fromCharCode(e)):"keydown"===e.type||"keyup"===e.type?An[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Re,charCode:function(e){return"keypress"===e.type?xe(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?xe(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),pn=sn.extend({dataTransfer:null}),vn=tn.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Re}),mn=M.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),On=sn.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),Nn=[["abort","abort"],[a_,"animationEnd"],[__,"animationIteration"],[n_,"animationStart"],["canplay","canPlay"],["canplaythrough","canPlayThrough"],["drag","drag"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["gotpointercapture","gotPointerCapture"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["loadstart","loadStart"],["lostpointercapture","lostPointerCapture"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["playing","playing"],["pointermove","pointerMove"],["pointerout","pointerOut"],["pointerover","pointerOver"],["progress","progress"],["scroll","scroll"],["seeking","seeking"],["stalled","stalled"],["suspend","suspend"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchmove","touchMove"],[o_,"transitionEnd"],["waiting","waiting"],["wheel","wheel"]],gn={},hn={};[["blur","blur"],["cancel","cancel"],["click","click"],["close","close"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["auxclick","auxClick"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragstart","dragStart"],["drop","drop"],["focus","focus"],["input","input"],["invalid","invalid"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["mousedown","mouseDown"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["pointercancel","pointerCancel"],["pointerdown","pointerDown"],["pointerup","pointerUp"],["ratechange","rateChange"],["reset","reset"],["seeked","seeked"],["submit","submit"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchstart","touchStart"],["volumechange","volumeChange"]].forEach(function(e){Ue(e,!0)}),Nn.forEach(function(e){Ue(e,!1)});var Rn={eventTypes:gn,isInteractiveTopLevelEventType:function(e){return void 0!==(e=hn[e])&&!0===e.isInteractive},extractEvents:function(e,t,r,a){var _=hn[e];if(!_)return null;switch(e){case"keypress":if(0===xe(r))return null;case"keydown":case"keyup":e=Sn;break;case"blur":case"focus":e=fn;break;case"click":if(2===r.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=vn;break;case a_:case __:case n_:e=un;break;case o_:e=mn;break;case"scroll":e=tn;break;case"wheel":e=On;break;case"copy":case"cut":case"paste":e=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=cn;break;default:e=M}return t=e.getPooled(_,t,r,a),h(t),t}},In=Rn.isInteractiveTopLevelEventType,bn=[],Yn=!0,Ln={},Mn=0,yn="_reactListenersID"+(""+Math.random()).slice(2),xn=$a&&"documentMode"in document&&11>=document.documentMode,Un={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},wn=null,Cn=null,Dn=null,Fn=!1,Gn={eventTypes:Un,extractEvents:function(e,t,r,a){var _,n=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;if(!(_=!n)){e:{n=ke(n),_=ja.onSelect;for(var o=0;o<_.length;o++){var i=_[o];if(!n.hasOwnProperty(i)||!n[i]){n=!1;break e}}n=!0}_=!n}if(_)return null;switch(n=t?S(t):window,e){case"focus":(Q(n)||"true"===n.contentEditable)&&(wn=n,Cn=t,Dn=null);break;case"blur":Dn=Cn=wn=null;break;case"mousedown":Fn=!0;break;case"contextmenu":case"mouseup":case"dragend":return Fn=!1,ze(r,a);case"selectionchange":if(xn)break;case"keydown":case"keyup":return ze(r,a)}return null}};Va.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),Ha=p,Qa=A,za=S,Va.injectEventPluginsByName({SimpleEventPlugin:Rn,EnterLeaveEventPlugin:ln,ChangeEventPlugin:en,SelectEventPlugin:Gn,BeforeInputEventPlugin:O_});var kn={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},Kn=void 0,Bn=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,r,a,_){MSApp.execUnsafeLocalFunction(function(){return e(t,r)})}:e}(function(e,t){if(e.namespaceURI!==kn.svg||"innerHTML"in e)e.innerHTML=t;else{for(Kn=Kn||document.createElement("div"),Kn.innerHTML="<svg>"+t+"</svg>",t=Kn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}),Xn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jn=["Webkit","ms","Moz","O"];Object.keys(Xn).forEach(function(e){jn.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xn[t]=Xn[e]})});var Hn=ya({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Qn=null,zn=null,qn="function"===typeof setTimeout?setTimeout:void 0,Vn="function"===typeof clearTimeout?clearTimeout:void 0;new Set;var Wn=[],Jn=-1,Zn={},$n={current:Zn},eo={current:!1},to=Zn,ro=null,ao=null,_o=!1,no={current:null},oo=null,io=null,so=null,co={},Eo={current:co},lo={current:co},To={current:co},uo=b_.ReactCurrentOwner,fo=(new Ma.Component).refs,Po={isMounted:function(e){return!!(e=e._reactInternalFiber)&&2===Ye(e)},enqueueSetState:function(e,t,r){e=e._reactInternalFiber;var a=ia();a=Zr(a,e);var _=Bt(a);_.payload=t,void 0!==r&&null!==r&&(_.callback=r),zr(),jt(e,_),ta(e,a)},enqueueReplaceState:function(e,t,r){e=e._reactInternalFiber;var a=ia();a=Zr(a,e);var _=Bt(a);_.tag=1,_.payload=t,void 0!==r&&null!==r&&(_.callback=r),zr(),jt(e,_),ta(e,a)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var r=ia();r=Zr(r,e);var a=Bt(r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),zr(),jt(e,a),ta(e,r)}},Ao=Array.isArray,So=Pr(!0),po=Pr(!1),vo=null,mo=null,Oo=!1,No=b_.ReactCurrentOwner,go=void 0,ho=void 0,Ro=void 0,Io=void 0;go=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},ho=function(){},Ro=function(e,t,r,a,_){var n=e.memoizedProps;if(n!==a){var o=t.stateNode;switch(rr(Eo.current),e=null,r){case"input":n=ce(o,n),a=ce(o,a),e=[];break;case"option":n=Ve(o,n),a=Ve(o,a),e=[];break;case"select":n=ya({},n,{value:void 0}),a=ya({},a,{value:void 0}),e=[];break;case"textarea":n=Je(o,n),a=Je(o,a),e=[];break;default:"function"!==typeof n.onClick&&"function"===typeof a.onClick&&(o.onclick=ct)}ot(r,a),o=r=void 0;var i=null;for(r in n)if(!a.hasOwnProperty(r)&&n.hasOwnProperty(r)&&null!=n[r])if("style"===r){var s=n[r];for(o in s)s.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else"dangerouslySetInnerHTML"!==r&&"children"!==r&&"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(Xa.hasOwnProperty(r)?e||(e=[]):(e=e||[]).push(r,null));for(r in a){var c=a[r];if(s=null!=n?n[r]:void 0,a.hasOwnProperty(r)&&c!==s&&(null!=c||null!=s))if("style"===r)if(s){for(o in s)!s.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in c)c.hasOwnProperty(o)&&s[o]!==c[o]&&(i||(i={}),i[o]=c[o])}else i||(e||(e=[]),e.push(r,i)),i=c;else"dangerouslySetInnerHTML"===r?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(e=e||[]).push(r,""+c)):"children"===r?s===c||"string"!==typeof c&&"number"!==typeof c||(e=e||[]).push(r,""+c):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&(Xa.hasOwnProperty(r)?(null!=c&&st(_,r),e||s===c||(e=[])):(e=e||[]).push(r,c))}i&&(e=e||[]).push("style",i),_=e,(t.updateQueue=_)&&wr(t)}},Io=function(e,t,r,a){r!==a&&wr(t)};var bo={readContext:tr},Yo=b_.ReactCurrentOwner,Lo=1073741822,Mo=0,yo=!1,xo=null,Uo=null,wo=0,Co=-1,Do=!1,Fo=null,Go=!1,ko=null,Ko=null,Bo=null,Xo=null,jo=null,Ho=0,Qo=void 0,zo=!1,qo=null,Vo=0,Wo=0,Jo=!1,Zo=null,$o=!1,ei=!1,ti=!1,ri=null,ai=xa.unstable_now(),_i=1073741822-(ai/10|0),ni=_i,oi=50,ii=0,si=null,ci=!1;N_=function(e,t,r){switch(t){case"input":if(Te(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var n=p(a);n||_("90"),Z(a),Te(a,n)}}}break;case"textarea":$e(e,r);break;case"select":null!=(t=r.value)&&We(e,!!r.multiple,t,!1)}},ga.prototype.render=function(e){this._defer||_("250"),this._hasChildren=!0,this._children=e;var t=this._root._internalRoot,r=this._expirationTime,a=new ha;return va(e,t,null,r,a._onCommit),a},ga.prototype.then=function(e){if(this._didComplete)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},ga.prototype.commit=function(){var e=this._root._internalRoot,t=e.firstBatch;if(this._defer&&null!==t||_("251"),this._hasChildren){var r=this._expirationTime;if(t!==this){this._hasChildren&&(r=this._expirationTime=t._expirationTime,this.render(this._children));for(var a=null,n=t;n!==this;)a=n,n=n._next;null===a&&_("251"),a._next=n._next,this._next=t,e.firstBatch=this}this._defer=!1,ua(e,r),t=this._next,this._next=null,t=e.firstBatch=t,null!==t&&t._hasChildren&&t.render(t._children)}else this._next=null,this._defer=!1},ga.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++)(0,e[t])()}},ha.prototype.then=function(e){if(this._didCommit)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},ha.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var r=e[t];"function"!==typeof r&&_("191",r),r()}}},Ra.prototype.render=function(e,t){var r=this._internalRoot,a=new ha;return t=void 0===t?null:t,null!==t&&a.then(t),ma(e,r,null,a._onCommit),a},Ra.prototype.unmount=function(e){var t=this._internalRoot,r=new ha;return e=void 0===e?null:e,null!==e&&r.then(e),ma(null,t,null,r._onCommit),r},Ra.prototype.legacy_renderSubtreeIntoContainer=function(e,t,r){var a=this._internalRoot,_=new ha;return r=void 0===r?null:r,null!==r&&_.then(r),ma(t,a,e,_._onCommit),_},Ra.prototype.createBatch=function(){var e=new ga(this),t=e._expirationTime,r=this._internalRoot,a=r.firstBatch;if(null===a)r.firstBatch=e,e._next=null;else{for(r=null;null!==a&&a._expirationTime>=t;)r=a,a=a._next;e._next=a,null!==r&&(r._next=e)}return e},B=Aa,X=pa,j=function(){zo||0===Wo||(Ta(Wo,!1),Wo=0)};var Ei={createPortal:La,findDOMNode:function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;return void 0===t&&("function"===typeof e.render?_("188"):_("268",Object.keys(e))),e=ye(t),e=null===e?null:e.stateNode},hydrate:function(e,t,r){return Ya(null,e,t,!0,r)},render:function(e,t,r){return Ya(null,e,t,!1,r)},unstable_renderSubtreeIntoContainer:function(e,t,r,a){return(null==e||void 0===e._reactInternalFiber)&&_("38"),Ya(e,t,r,!1,a)},unmountComponentAtNode:function(e){return Ia(e)||_("40"),!!e._reactRootContainer&&(Sa(function(){Ya(null,null,e,!1,function(){e._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return La.apply(void 0,arguments)},unstable_batchedUpdates:Aa,unstable_interactiveUpdates:pa,flushSync:function(e,t){zo&&_("187");var r=$o;$o=!0;try{return ra(e,t)}finally{$o=r,Ta(1073741823,!1)}},unstable_flushControlled:function(e){var t=$o;$o=!0;try{ra(e)}finally{($o=t)||zo||Ta(1073741823,!1)}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[A,S,p,Va.injectEventPluginsByName,Ba,h,function(e){T(e,g)},k,K,Ge,f]},unstable_createRoot:function(e,t){return Ia(e)||_("299","unstable_createRoot"),new Ra(e,!0,null!=t&&!0===t.hydrate)}};!function(e){var t=e.findFiberByHostInstance;ht(ya({},e,{findHostInstanceByFiber:function(e){return e=ye(e),null===e?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null}}))}({findFiberByHostInstance:P,bundleType:0,version:"16.6.3",rendererPackageName:"react-dom"});var li={default:Ei},Ti=li&&Ei||li;e.exports=Ti.default||Ti},function(e,t,r){"use strict";e.exports=r(102)},function(e,t,r){"use strict";function a(){if(!f){var e=E.expirationTime;P?g():P=!0,N(o,e)}}function _(){var e=E,t=E.next;if(E===t)E=null;else{var r=E.previous;E=r.next=t,t.previous=r}e.next=e.previous=null,r=e.callback,t=e.expirationTime,e=e.priorityLevel;var _=T,n=d;T=e,d=t;try{var o=r()}finally{T=_,d=n}if("function"===typeof o)if(o={callback:o,priorityLevel:e,expirationTime:t,next:null,previous:null},null===E)E=o.next=o.previous=o;else{r=null,e=E;do{if(e.expirationTime>=t){r=e;break}e=e.next}while(e!==E);null===r?r=E:r===E&&(E=o,a()),t=r.previous,t.next=r.previous=o,o.next=r,o.previous=t}}function n(){if(-1===u&&null!==E&&1===E.priorityLevel){f=!0;try{do{_()}while(null!==E&&1===E.priorityLevel)}finally{f=!1,null!==E?a():P=!1}}}function o(e){f=!0;var r=l;l=e;try{if(e)for(;null!==E;){var o=t.unstable_now();if(!(E.expirationTime<=o))break;do{_()}while(null!==E&&E.expirationTime<=o)}else if(null!==E)do{_()}while(null!==E&&!h())}finally{f=!1,l=r,null!==E?a():P=!1,n()}}function i(e){s=v(function(t){p(c),e(t)}),c=S(function(){m(s),e(t.unstable_now())},100)}Object.defineProperty(t,"__esModule",{value:!0});var s,c,E=null,l=!1,T=3,u=-1,d=-1,f=!1,P=!1,A=Date,S="function"===typeof setTimeout?setTimeout:void 0,p="function"===typeof clearTimeout?clearTimeout:void 0,v="function"===typeof requestAnimationFrame?requestAnimationFrame:void 0,m="function"===typeof cancelAnimationFrame?cancelAnimationFrame:void 0;if("object"===typeof performance&&"function"===typeof performance.now){var O=performance;t.unstable_now=function(){return O.now()}}else t.unstable_now=function(){return A.now()};var N,g,h;if("undefined"!==typeof window&&window._schedMock){var R=window._schedMock;N=R[0],g=R[1],h=R[2]}else if("undefined"===typeof window||"function"!==typeof window.addEventListener){var I=null,b=-1,Y=function(e,t){if(null!==I){var r=I;I=null;try{b=t,r(e)}finally{b=-1}}};N=function(e,t){-1!==b?setTimeout(N,0,e,t):(I=e,setTimeout(Y,t,!0,t),setTimeout(Y,1073741823,!1,1073741823))},g=function(){I=null},h=function(){return!1},t.unstable_now=function(){return-1===b?0:b}}else{"undefined"!==typeof console&&("function"!==typeof v&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));var L=null,M=!1,y=-1,x=!1,U=!1,w=0,C=33,D=33;h=function(){return w<=t.unstable_now()};var F="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(e){if(e.source===window&&e.data===F){M=!1,e=L;var r=y;L=null,y=-1;var a=t.unstable_now(),_=!1;if(0>=w-a){if(!(-1!==r&&r<=a))return x||(x=!0,i(G)),L=e,void(y=r);_=!0}if(null!==e){U=!0;try{e(_)}finally{U=!1}}}},!1);var G=function(e){if(null!==L){i(G);var t=e-w+D;t<D&&C<D?(8>t&&(t=8),D=t<C?C:t):C=t,w=e+D,M||(M=!0,window.postMessage(F,"*"))}else x=!1};N=function(e,t){L=e,y=t,U||0>t?window.postMessage(F,"*"):x||(x=!0,i(G))},g=function(){L=null,M=!1,y=-1}}t.unstable_ImmediatePriority=1,t.unstable_UserBlockingPriority=2,t.unstable_NormalPriority=3,t.unstable_IdlePriority=5,t.unstable_LowPriority=4,t.unstable_runWithPriority=function(e,r){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=T,_=u;T=e,u=t.unstable_now();try{return r()}finally{T=a,u=_,n()}},t.unstable_scheduleCallback=function(e,r){var _=-1!==u?u:t.unstable_now();if("object"===typeof r&&null!==r&&"number"===typeof r.timeout)r=_+r.timeout;else switch(T){case 1:r=_+-1;break;case 2:r=_+250;break;case 5:r=_+1073741823;break;case 4:r=_+1e4;break;default:r=_+5e3}if(e={callback:e,priorityLevel:T,expirationTime:r,next:null,previous:null},null===E)E=e.next=e.previous=e,a();else{_=null;var n=E;do{if(n.expirationTime>r){_=n;break}n=n.next}while(n!==E);null===_?_=E:_===E&&(E=e,a()),r=_.previous,r.next=_.previous=e,e.next=_,e.previous=r}return e},t.unstable_cancelCallback=function(e){var t=e.next;if(null!==t){if(t===e)E=null;else{e===E&&(E=t);var r=e.previous;r.next=t,t.previous=r}e.next=e.previous=null}},t.unstable_wrapCallback=function(e){var r=T;return function(){var a=T,_=u;T=r,u=t.unstable_now();try{return e.apply(this,arguments)}finally{T=a,u=_,n()}}},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_shouldYield=function(){return!l&&(null!==E&&E.expirationTime<d||h())}},function(e,t,r){var a=r(104);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,"body {\n  margin: 0;\n  padding: 0;\n  font-family: sans-serif; }\n",""])},function(e,t){e.exports=function(e){var t="undefined"!==typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!==typeof e)return e;var r=t.protocol+"//"+t.host,a=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var _=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(_))return e;var n;return n=0===_.indexOf("//")?_:0===_.indexOf("/")?r+_:a+_.replace(/^\.\//,""),"url("+JSON.stringify(n)+")"})}},function(e,t,r){"use strict";function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function a(_,n){try{var o=t[_](n),i=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(i).then(function(e){a("next",e)},function(e){a("throw",e)});e(i)}return a("next")})}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=r(76),s=r.n(i),c=r(27),E=r.n(c),l=r(109),T=r.n(l),u=r(110),d=r(147),f=(r.n(d),r(149)),P=r(153),A=r(156),S=r(172),p=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),v=function(e){function t(){var e=this;_(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.loadData=a(s.a.mark(function t(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Object(S.a)("/product/embroideries?categoryEcode=MYR").then(function(e){if(e&&e.data){console.log(e);var t=e.data.embroideryVo,a=t.embPositions,_=t.embFonts,n=t.embColors,o=e.data.printings;console.log(o);var i=function(){for(var e=[],t=1;t<=o.length;t++)e.push(function(e){return function(){var t="assets/printings/print_0"+e+".png";return Object(u.b)("Pattern2D_315009.005","Texture.002",t)}}(t));return e}();console.log(i);for(var s=0;s<o.length;s++)o[s].clickAction=i[s];var c=function(){for(var e=[],t=1;t<=a.length;t++)e.push(function(e){return function(){var t="assets/cixiu/cixiu_0"+e+".png";return Object(u.b)("Pattern2D_315009.005","Texture.004",t)}}(t));return e}();console.log(c);for(var E=0;E<a.length;E++)a[E].clickAction=c[E];var l=function(){for(var e=[],t=1;t<=3;t++)e.push(function(e){return function(){var t="assets/emb/cixiu_0"+e+".png";return Object(u.b)("Pattern2D_315009.005","Texture.003",t)}}(t));return e}();console.log(l);for(var T=0;T<3;T++)_[T].clickAction=l[T];console.log("===========\u5b57\u4f53==============",_);var d=function(){for(var e=[],t=0;t<n.length;t++){var r=function(e){return e="#"===e[0]?e.slice(1):e,e=4===e.length?e.slice(0,3):e,e=3===e.length?e[0].repeat(2)+e[1].repeat(2)+e[2].repeat(2):e,6===e.length&&/^[0-9a-fA-F]{3,6}$/i.test(e)?[parseInt(e[0]+e[1],16)/255,parseInt(e[2]+e[3],16)/255,parseInt(e[4]+e[5],16)/255]:"Invalid data"}(n[t].ecode),a="#"+n[t].ecode[0].repeat(2)+n[t].ecode[1].repeat(2)+n[t].ecode[2].repeat(2);e.push({color:r,colorHex:a})}return e}();console.log("+++++++++",d);for(var f=0;f<n.length;f++)n[f].color=d[f].color,n[f].colorHex=d[f].colorHex;console.log("===============yanse===============",n);var P=function(){for(var e=[],t=0;t<=n.length;t++)e.push(function(e){return function(){return console.log(n[e].color),Object(u.a)("Pattern2D_315009.005",["ds","RGB"],n[e].color)}}(t));return e}();console.log("----------------\u8272\u53f7",P);for(var A=0;A<n.length;A++)n[A].clickAction=P[A];var S=["Pattern2D_315009.000","Pattern2D_315009.003","Pattern2D_315009.005","Pattern2D_315009.007","pocket_01","pocket_02","Pattern2D_5750432.001","Pattern2D_787255.001","987-MC5.000"],p=[[[{key:"key1",title:"\u9762\u6599",container:[{name:"\u767d\u8272\u9762\u6599",ecode:0,clickAction:function(){for(var e=0;e<S.length;e++)Object(u.b)(S[e],"Texture.001","assets/mianliao_white.jpg")}},{name:"\u7ea2\u8272\u9762\u6599",ecode:1,clickAction:function(){for(var e=0;e<S.length;e++)Object(u.b)(S[e],"Texture.001","assets/mianliao_red.jpg")}},{name:"\u84dd\u8272\u9762\u6599",ecode:2,clickAction:function(){for(var e=0;e<S.length;e++)Object(u.b)(S[e],"Texture.001","assets/mianliao_blue.jpg")}},{name:"\u7eff\u8272\u9762\u6599",ecode:3,clickAction:function(){for(var e=0;e<S.length;e++)Object(u.b)(S[e],"Texture.001","assets/mianliao_green.jpg")}}]}],[{key:"key2",title:"\u9886\u5b50",container:[{name:"\u9886\u5b50",ecode:0,clickAction:function(){Object(u.c)("pocket_01",!1),Object(u.c)("pocket_02",!0)}},{name:"\u9886\u5b50",ecode:1,clickAction:function(){Object(u.c)("pocket_01",!0),Object(u.c)("pocket_02",!1)}}]}],[{key:"key3",title:"\u53e3\u888b",container:[{name:"\u7ad6\u888b",color:"red",ecode:0,clickAction:function(){Object(u.c)("pocket_01",!1),Object(u.c)("pocket_02",!0)}},{name:"\u659c\u888b",color:"\u53e3\u888b",ecode:1,clickAction:function(){Object(u.c)("pocket_01",!0),Object(u.c)("pocket_02",!1)}},{name:"\u65e0\u888b",color:"black",ecode:2,clickAction:function(){var e=["pocket_01","pocket_02"];Object(u.d)(e)}}]}]],[[{key:"embPositions",title:"\u523a\u7ee3\u4f4d\u7f6e",container:a},{key:"embFonts",title:"\u523a\u7ee3\u5b57\u4f53",container:_},{key:"embColors",title:"\u523a\u7ee3\u989c\u8272",container:n,type:"color"},{key:"key11",title:"\u8bf7\u8f93\u5165\u523a\u7ee3\u5185\u5bb9(\u6700\u591a12\u4e2a\u5b57\uff09",type:"input"}],[{key:"printings",title:"\u5370\u82b1\u4f4d\u7f6e",container:o}]]],v={};p.forEach(function(e){return e.forEach(function(e){return e.forEach(function(e){v[e.key]=e.container&&e.container.length>0?e.container[0].ecode:void 0})})}),r.setState({contentArr:p,selectKeys:v})}else console.log("wx.miniProgram.pos")});case 1:case"end":return e.stop()}},t,e)})),r.hideOrshow=function(){console.log("====hideOrshow======"),T.a.miniProgram.postMessage({data:{ffdf:"foos",name:"dadf",dsfds:"dfadf"}})},r.save=function(){console.log("wx.miniProgram.postMessage({ data: 'foos' })"),T.a.miniProgram.postMessage({data:{ffdf:"foos",name:"dadf",dsfds:"dfadf"}})},r.state={selectIndex:0,selectKeys:{key1:0,key2:0,key3:0},contentArr:[]},r}return o(t,e),p(t,[{key:"componentWillMount",value:function(){Object(u.e)()}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentWillUnmount",value:function(){T.a.miniProgram.postMessage({data:{ffdf:"foos",name:"dadf",dsfds:"dfadf"}})}},{key:"render",value:function(){var e=this;return E.a.createElement("div",{className:"app-container"},E.a.createElement(f.a,null),E.a.createElement("div",{className:"customization"},E.a.createElement(P.a,{contentArr:["\u5de5\u827a","\u523a\u7ee3\u5370\u82b1"],selectIndex:this.state.selectIndex,clickItem:function(t){return e.setState({selectIndex:t})},saveActio:this.save}),this.state.contentArr.length>0&&this.state.contentArr[this.state.selectIndex].map(function(t,r){return E.a.createElement("div",{className:"itemContain",key:"itemContain"+r},t.map(function(t){return"input"===t.type?E.a.createElement("input",{className:"input",placeholder:t.title}):E.a.createElement(A.a,Object.assign({},t,{selectValue:e.state.selectKeys[t.key],clickItem:function(r){r.clickAction&&r.clickAction();var a=e.state.selectKeys;a[t.key]=r.ecode,e.setState({selectKeys:a})}}))}))})))}}]),t}(c.Component);t.a=v},function(e,t,r){var a=function(){return this}()||Function("return this")(),_=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,n=_&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=r(108),_)a.regeneratorRuntime=n;else try{delete a.regeneratorRuntime}catch(e){a.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";function r(e,t,r,a){var n=t&&t.prototype instanceof _?t:_,o=Object.create(n.prototype),i=new u(a||[]);return o._invoke=c(e,r,i),o}function a(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function _(){}function n(){}function o(){}function i(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(e){function t(r,_,n,o){var i=a(e[r],e,_);if("throw"!==i.type){var s=i.arg,c=s.value;return c&&"object"===typeof c&&S.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):Promise.resolve(c).then(function(e){s.value=e,n(s)},o)}o(i.arg)}function r(e,r){function a(){return new Promise(function(a,_){t(e,r,a,_)})}return _=_?_.then(a,a):a()}var _;this._invoke=r}function c(e,t,r){var _=h;return function(n,o){if(_===I)throw new Error("Generator is already running");if(_===b){if("throw"===n)throw o;return f()}for(r.method=n,r.arg=o;;){var i=r.delegate;if(i){var s=E(i,r);if(s){if(s===Y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(_===h)throw _=b,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);_=I;var c=a(e,t,r);if("normal"===c.type){if(_=r.done?b:R,c.arg===Y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(_=b,r.method="throw",r.arg=c.arg)}}}function E(e,t){var r=e.iterator[t.method];if(r===P){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=P,E(e,t),"throw"===t.method))return Y;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return Y}var _=a(r,e.iterator,t.arg);if("throw"===_.type)return t.method="throw",t.arg=_.arg,t.delegate=null,Y;var n=_.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=P),t.delegate=null,Y):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,Y)}function l(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function u(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(l,this),this.reset(!0)}function d(e){if(e){var t=e[v];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(S.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=P,t.done=!0,t};return a.next=a}}return{next:f}}function f(){return{value:P,done:!0}}var P,A=Object.prototype,S=A.hasOwnProperty,p="function"===typeof Symbol?Symbol:{},v=p.iterator||"@@iterator",m=p.asyncIterator||"@@asyncIterator",O=p.toStringTag||"@@toStringTag",N="object"===typeof e,g=t.regeneratorRuntime;if(g)return void(N&&(e.exports=g));g=t.regeneratorRuntime=N?e.exports:{},g.wrap=r;var h="suspendedStart",R="suspendedYield",I="executing",b="completed",Y={},L={};L[v]=function(){return this};var M=Object.getPrototypeOf,y=M&&M(M(d([])));y&&y!==A&&S.call(y,v)&&(L=y);var x=o.prototype=_.prototype=Object.create(L);n.prototype=x.constructor=o,o.constructor=n,o[O]=n.displayName="GeneratorFunction",g.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))},g.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,O in e||(e[O]="GeneratorFunction")),e.prototype=Object.create(x),e},g.awrap=function(e){return{__await:e}},i(s.prototype),s.prototype[m]=function(){return this},g.AsyncIterator=s,g.async=function(e,t,a,_){var n=new s(r(e,t,a,_));return g.isGeneratorFunction(t)?n:n.next().then(function(e){return e.done?e.value:n.next()})},i(x),x[O]="Generator",x[v]=function(){return this},x.toString=function(){return"[object Generator]"},g.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var a=t.pop();if(a in e)return r.value=a,r.done=!1,r}return r.done=!0,r}},g.values=d,u.prototype={constructor:u,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=P,this.done=!1,this.delegate=null,this.method="next",this.arg=P,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&S.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=P)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,a){return n.type="throw",n.arg=e,r.next=t,a&&(r.method="next",r.arg=P),!!a}if(this.done)throw e;for(var r=this,a=this.tryEntries.length-1;a>=0;--a){var _=this.tryEntries[a],n=_.completion;if("root"===_.tryLoc)return t("end");if(_.tryLoc<=this.prev){var o=S.call(_,"catchLoc"),i=S.call(_,"finallyLoc");if(o&&i){if(this.prev<_.catchLoc)return t(_.catchLoc,!0);if(this.prev<_.finallyLoc)return t(_.finallyLoc)}else if(o){if(this.prev<_.catchLoc)return t(_.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<_.finallyLoc)return t(_.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&S.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var _=a;break}}_&&("break"===e||"continue"===e)&&_.tryLoc<=t&&t<=_.finallyLoc&&(_=null);var n=_?_.completion:{};return n.type=e,n.arg=t,_?(this.method="next",this.next=_.finallyLoc,Y):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),Y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),Y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var _=a.arg;T(r)}return _}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:d(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=P),Y}}}(function(){return this}()||Function("return this")())},function(e,t){!function(t,r){e.exports=function(e,t){function r(t,r,a){e.WeixinJSBridge?WeixinJSBridge.invoke(t,_(r),function(e){i(t,e,a)}):E(t,a)}function a(t,r,a){e.WeixinJSBridge?WeixinJSBridge.on(t,function(e){a&&a.trigger&&a.trigger(e),i(t,e,r)}):a?E(t,a):E(t,r)}function _(e){return e=e||{},e.appId=L.appId,e.verifyAppId=L.appId,e.verifySignType="sha1",e.verifyTimestamp=L.timestamp+"",e.verifyNonceStr=L.nonceStr,e.verifySignature=L.signature,e}function n(e){return{timeStamp:e.timestamp+"",nonceStr:e.nonceStr,package:e.package,paySign:e.paySign,signType:e.signType||"SHA1"}}function o(e){return e.postalCode=e.addressPostalCode,delete e.addressPostalCode,e.provinceName=e.proviceFirstStageName,delete e.proviceFirstStageName,e.cityName=e.addressCitySecondStageName,delete e.addressCitySecondStageName,e.countryName=e.addressCountiesThirdStageName,delete e.addressCountiesThirdStageName,e.detailInfo=e.addressDetailInfo,delete e.addressDetailInfo,e}function i(e,t,r){"openEnterpriseChat"==e&&(t.errCode=t.err_code),delete t.err_code,delete t.err_desc,delete t.err_detail;var a=t.errMsg;a||(a=t.err_msg,delete t.err_msg,a=s(e,a),t.errMsg=a),(r=r||{})._complete&&(r._complete(t),delete r._complete),a=t.errMsg||"",L.debug&&!r.isInnerInvoke&&alert(JSON.stringify(t));var _=a.indexOf(":");switch(a.substring(_+1)){case"ok":r.success&&r.success(t);break;case"cancel":r.cancel&&r.cancel(t);break;default:r.fail&&r.fail(t)}r.complete&&r.complete(t)}function s(e,t){var r=e,a=A[r];a&&(r=a);var _="ok";if(t){var n=t.indexOf(":");"confirm"==(_=t.substring(n+1))&&(_="ok"),"failed"==_&&(_="fail"),-1!=_.indexOf("failed_")&&(_=_.substring(7)),-1!=_.indexOf("fail_")&&(_=_.substring(5)),"access denied"!=(_=(_=_.replace(/_/g," ")).toLowerCase())&&"no permission to execute"!=_||(_="permission denied"),"config"==r&&"function not exist"==_&&(_="ok"),""==_&&(_="fail")}return t=r+":"+_}function c(e){if(e){for(var t=0,r=e.length;t<r;++t){var a=e[t],_=P[a];_&&(e[t]=_)}return e}}function E(e,t){if(!(!L.debug||t&&t.isInnerInvoke)){var r=A[e];r&&(e=r),t&&t._complete&&delete t._complete,console.log('"'+e+'",',t||"")}}function l(e){if(!(O||N||L.debug||I<"6.0.2"||Y.systemType<0)){var t=new Image;Y.appId=L.appId,Y.initTime=b.initEndTime-b.initStartTime,Y.preVerifyTime=b.preVerifyEndTime-b.preVerifyStartTime,w.getNetworkType({isInnerInvoke:!0,success:function(e){Y.networkType=e.networkType;var r="https://open.weixin.qq.com/sdk/report?v="+Y.version+"&o="+Y.isPreVerifyOk+"&s="+Y.systemType+"&c="+Y.clientVersion+"&a="+Y.appId+"&n="+Y.networkType+"&i="+Y.initTime+"&p="+Y.preVerifyTime+"&u="+Y.url;t.src=r}})}}function T(){return(new Date).getTime()}function u(t){g&&(e.WeixinJSBridge?"preInject"===S.__wxjsjs__isPreInject?S.addEventListener&&S.addEventListener("WeixinJSBridgeReady",t,!1):t():S.addEventListener&&S.addEventListener("WeixinJSBridgeReady",t,!1))}function d(){w.invoke||(w.invoke=function(t,r,a){e.WeixinJSBridge&&WeixinJSBridge.invoke(t,_(r),a)},w.on=function(t,r){e.WeixinJSBridge&&WeixinJSBridge.on(t,r)})}function f(e){if("string"==typeof e&&e.length>0){var t=e.split("?")[0],r=e.split("?")[1];return t+=".html",void 0!==r?t+"?"+r:t}}if(!e.jWeixin){var P={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress"},A=function(){var e={};for(var t in P)e[P[t]]=t;return e}(),S=e.document,p=S.title,v=navigator.userAgent.toLowerCase(),m=navigator.platform.toLowerCase(),O=!(!m.match("mac")&&!m.match("win")),N=-1!=v.indexOf("wxdebugger"),g=-1!=v.indexOf("micromessenger"),h=-1!=v.indexOf("android"),R=-1!=v.indexOf("iphone")||-1!=v.indexOf("ipad"),I=function(){var e=v.match(/micromessenger\/(\d+\.\d+\.\d+)/)||v.match(/micromessenger\/(\d+\.\d+)/);return e?e[1]:""}(),b={initStartTime:T(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},Y={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:R?1:h?2:-1,clientVersion:I,url:encodeURIComponent(location.href)},L={},M={_completes:[]},y={state:0,data:{}};u(function(){b.initEndTime=T()});var x=!1,U=[],w={config:function(e){L=e,E("config",e);var t=!1!==L.check;u(function(){if(t)r(P.config,{verifyJsApiList:c(L.jsApiList)},function(){M._complete=function(e){b.preVerifyEndTime=T(),y.state=1,y.data=e},M.success=function(e){Y.isPreVerifyOk=0},M.fail=function(e){M._fail?M._fail(e):y.state=-1};var e=M._completes;return e.push(function(){l()}),M.complete=function(t){for(var r=0,a=e.length;r<a;++r)e[r]();M._completes=[]},M}()),b.preVerifyStartTime=T();else{y.state=1;for(var e=M._completes,a=0,_=e.length;a<_;++a)e[a]();M._completes=[]}}),d()},ready:function(e){0!=y.state?e():(M._completes.push(e),!g&&L.debug&&e())},error:function(e){I<"6.0.2"||(-1==y.state?e(y.data):M._fail=e)},checkJsApi:function(e){var t=function(e){var t=e.checkResult;for(var r in t){var a=A[r];a&&(t[a]=t[r],delete t[r])}return e};r("checkJsApi",{jsApiList:c(e.jsApiList)},(e._complete=function(e){if(h){var r=e.checkResult;r&&(e.checkResult=JSON.parse(r))}e=t(e)},e))},onMenuShareTimeline:function(e){a(P.onMenuShareTimeline,{complete:function(){r("shareTimeline",{title:e.title||p,desc:e.title||p,img_url:e.imgUrl||"",link:e.link||location.href,type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareAppMessage:function(e){a(P.onMenuShareAppMessage,{complete:function(){r("sendAppMessage",{title:e.title||p,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareQQ:function(e){a(P.onMenuShareQQ,{complete:function(){r("shareQQ",{title:e.title||p,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareWeibo:function(e){a(P.onMenuShareWeibo,{complete:function(){r("shareWeiboApp",{title:e.title||p,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareQZone:function(e){a(P.onMenuShareQZone,{complete:function(){r("shareQZone",{title:e.title||p,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},startRecord:function(e){r("startRecord",{},e)},stopRecord:function(e){r("stopRecord",{},e)},onVoiceRecordEnd:function(e){a("onVoiceRecordEnd",e)},playVoice:function(e){r("playVoice",{localId:e.localId},e)},pauseVoice:function(e){r("pauseVoice",{localId:e.localId},e)},stopVoice:function(e){r("stopVoice",{localId:e.localId},e)},onVoicePlayEnd:function(e){a("onVoicePlayEnd",e)},uploadVoice:function(e){r("uploadVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadVoice:function(e){r("downloadVoice",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},translateVoice:function(e){r("translateVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},chooseImage:function(e){r("chooseImage",{scene:"1|2",count:e.count||9,sizeType:e.sizeType||["original","compressed"],sourceType:e.sourceType||["album","camera"]},(e._complete=function(e){if(h){var t=e.localIds;t&&(e.localIds=JSON.parse(t))}},e))},getLocation:function(e){},previewImage:function(e){r(P.previewImage,{current:e.current,urls:e.urls},e)},uploadImage:function(e){r("uploadImage",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadImage:function(e){r("downloadImage",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},getLocalImgData:function(e){!1===x?(x=!0,r("getLocalImgData",{localId:e.localId},(e._complete=function(e){if(x=!1,U.length>0){var t=U.shift();w.getLocalImgData(t)}},e))):U.push(e)},getNetworkType:function(e){var t=function(e){var t=e.errMsg;e.errMsg="getNetworkType:ok";var r=e.subtype;if(delete e.subtype,r)e.networkType=r;else{var a=t.indexOf(":"),_=t.substring(a+1);switch(_){case"wifi":case"edge":case"wwan":e.networkType=_;break;default:e.errMsg="getNetworkType:fail"}}return e};r("getNetworkType",{},(e._complete=function(e){e=t(e)},e))},openLocation:function(e){r("openLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name||"",address:e.address||"",scale:e.scale||28,infoUrl:e.infoUrl||""},e)},getLocation:function(e){e=e||{},r(P.getLocation,{type:e.type||"wgs84"},(e._complete=function(e){delete e.type},e))},hideOptionMenu:function(e){r("hideOptionMenu",{},e)},showOptionMenu:function(e){r("showOptionMenu",{},e)},closeWindow:function(e){r("closeWindow",{},e=e||{})},hideMenuItems:function(e){r("hideMenuItems",{menuList:e.menuList},e)},showMenuItems:function(e){r("showMenuItems",{menuList:e.menuList},e)},hideAllNonBaseMenuItem:function(e){r("hideAllNonBaseMenuItem",{},e)},showAllNonBaseMenuItem:function(e){r("showAllNonBaseMenuItem",{},e)},scanQRCode:function(e){r("scanQRCode",{needResult:(e=e||{}).needResult||0,scanType:e.scanType||["qrCode","barCode"]},(e._complete=function(e){if(R){var t=e.resultStr;if(t){var r=JSON.parse(t);e.resultStr=r&&r.scan_code&&r.scan_code.scan_result}}},e))},openAddress:function(e){r(P.openAddress,{},(e._complete=function(e){e=o(e)},e))},openProductSpecificView:function(e){r(P.openProductSpecificView,{pid:e.productId,view_type:e.viewType||0,ext_info:e.extInfo},e)},addCard:function(e){for(var t=e.cardList,a=[],_=0,n=t.length;_<n;++_){var o=t[_],i={card_id:o.cardId,card_ext:o.cardExt};a.push(i)}r(P.addCard,{card_list:a},(e._complete=function(e){var t=e.card_list;if(t){for(var r=0,a=(t=JSON.parse(t)).length;r<a;++r){var _=t[r];_.cardId=_.card_id,_.cardExt=_.card_ext,_.isSuccess=!!_.is_succ,delete _.card_id,delete _.card_ext,delete _.is_succ}e.cardList=t,delete e.card_list}},e))},chooseCard:function(e){r("chooseCard",{app_id:L.appId,location_id:e.shopId||"",sign_type:e.signType||"SHA1",card_id:e.cardId||"",card_type:e.cardType||"",card_sign:e.cardSign,time_stamp:e.timestamp+"",nonce_str:e.nonceStr},(e._complete=function(e){e.cardList=e.choose_card_info,delete e.choose_card_info},e))},openCard:function(e){for(var t=e.cardList,a=[],_=0,n=t.length;_<n;++_){var o=t[_],i={card_id:o.cardId,code:o.code};a.push(i)}r(P.openCard,{card_list:a},e)},consumeAndShareCard:function(e){r(P.consumeAndShareCard,{consumedCardId:e.cardId,consumedCode:e.code},e)},chooseWXPay:function(e){r(P.chooseWXPay,n(e),e)},openEnterpriseRedPacket:function(e){r(P.openEnterpriseRedPacket,n(e),e)},startSearchBeacons:function(e){r(P.startSearchBeacons,{ticket:e.ticket},e)},stopSearchBeacons:function(e){r(P.stopSearchBeacons,{},e)},onSearchBeacons:function(e){a(P.onSearchBeacons,e)},openEnterpriseChat:function(e){r("openEnterpriseChat",{useridlist:e.userIds,chatname:e.groupName},e)},launchMiniProgram:function(e){r("launchMiniProgram",{targetAppId:e.targetAppId,path:f(e.path),envVersion:e.envVersion},e)},miniProgram:{navigateBack:function(e){e=e||{},u(function(){r("invokeMiniProgramAPI",{name:"navigateBack",arg:{delta:e.delta||1}},e)})},navigateTo:function(e){u(function(){r("invokeMiniProgramAPI",{name:"navigateTo",arg:{url:e.url}},e)})},redirectTo:function(e){u(function(){r("invokeMiniProgramAPI",{name:"redirectTo",arg:{url:e.url}},e)})},switchTab:function(e){u(function(){r("invokeMiniProgramAPI",{name:"switchTab",arg:{url:e.url}},e)})},reLaunch:function(e){u(function(){r("invokeMiniProgramAPI",{name:"reLaunch",arg:{url:e.url}},e)})},postMessage:function(e){u(function(){r("invokeMiniProgramAPI",{name:"postMessage",arg:e.data||{}},e)})},getEnv:function(t){u(function(){t({miniprogram:"miniprogram"===e.__wxjs_environment})})}}},C=1,D={};return S.addEventListener("error",function(e){if(!h){var t=e.target,r=t.tagName,a=t.src;if(("IMG"==r||"VIDEO"==r||"AUDIO"==r||"SOURCE"==r)&&-1!=a.indexOf("wxlocalresource://")){e.preventDefault(),e.stopPropagation();var _=t["wx-id"];if(_||(_=C++,t["wx-id"]=_),D[_])return;D[_]=!0,w.ready(function(){w.getLocalImgData({localId:a,success:function(e){t.src=e.localData}})})}}},!0),S.addEventListener("load",function(e){if(!h){var t=e.target,r=t.tagName;if(t.src,"IMG"==r||"VIDEO"==r||"AUDIO"==r||"SOURCE"==r){var a=t["wx-id"];a&&(D[a]=!1)}}},!0),t&&(e.wx=e.jWeixin=w),w}}(t)}(window)},function(e,t,r){"use strict";r.d(t,"e",function(){return P}),r.d(t,"c",function(){return m}),r.d(t,"d",function(){return O}),r.d(t,"b",function(){return N}),r.d(t,"a",function(){return g});var a=r(111),_=a.a.app,n=a.a.data,o=a.a.animation,i=a.a.container,s=a.a.mouse,c=a.a.scenes,E=a.a.config,l=a.a.textures,T=a.a.material,u=null,d=null,f=!1,P=function(){f?(n.unload(),E.apply_quality(E.P_ULTRA),_.init({canvas_container_id:"b4w",callback:A,autoresize:!0,reflections:!0,reflections_quality:"HIGH",shadows:!0})):(f=!0,E.apply_quality(E.P_ULTRA),_.init({canvas_container_id:"b4w",callback:A,autoresize:!0,pause_invisible:!0,reflections:!0,reflection_quality:"HIGH",shadows:!0}))},A=function(e,t){if(!t)return void console.log("b4w init failure");e.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1},S()},S=function(){document.getElementById("preloader_cont").style.visibility="visible",n.load("assets/yurongfu_newscene.json",v,null),u=n.load("assets/yurongfu_new.json",function(){console.log("\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01show\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01")},p)},p=function(e){var t=document.getElementById("prelod_dynamic_path"),r=document.getElementById("logo_container");if(t.style.width=e+"%",100===e){return document.getElementById("preloader_cont").style.visibility="hidden",void(r.style.visibility="hidden")}},v=function(e,t){if(!t)return void console.log("b4w load failure");_.enable_camera_controls();var r=i.get_canvas();r.addEventListener("mousedown",h,!1),r.addEventListener("touchstart",h,!1)},m=function(e,t){var r=c.get_object_by_name(e,u),a=c.is_visible(r);console.log("\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01hidden\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01\ud83d\ude01",r,a),t?c.hide_object(r):c.show_object(r)},O=function(e){if(console.log("22222222222222222222"),e)for(var t=0;t<e.length;t++){var r=c.get_object_by_name(e[t],u);c.hide_object(r)}},N=function(e,t,r){console.log("111111111");var a=c.get_object_by_name(e,u),_=new Image;_.onload=function(){l.replace_image(a,t,_)},_.src=r},g=function(e,t,r){var a=c.get_object_by_name(e,u);T.set_nodemat_rgb(a,t,r[0],r[1],r[2])},h=function(e){e.preventDefault&&e.preventDefault();var t=s.get_coords_x(e),r=s.get_coords_y(e),a=c.pick_object(t,r);a&&(d&&(o.stop(d),o.set_frame(d,0)),d=a,o.apply_def(a),o.play(a))}},function(e,t,r){"use strict";var a=r(35),_=r(112),n=r(122),o=r(123),i=r(124),s=r(125),c=r(88),E=r(126),l=r(127),T=r(128),u=r(129),d=r(130),f=r(131),P=r(73),A=r(132),S=r(90),p=r(133),v=r(134),m=r(36),O=r(83),N=r(71),g=r(43),h=r(24),R=r(84),I=r(85),b=r(135),Y=r(136),L=r(52),M=r(137),y=r(138),x=r(64),U=r(139),w=r(140),C=r(141),D=r(142),F=r(143),G=r(57),k=r(144),K=r(31),B=r(53),X=r(89),j=r(145),H=r(72),Q=r(44),z=r(87),q=r(26),V=r(146),W=r(1),J=r(3),Z=r(7),$=r(28),ee=r(21),te=r(8);a.a.app=_.a,a.a.camera_anim=n.a,a.a.fps=o.a,a.a.gp_conf=i.a,a.a.gyroscope=s.a,a.a.hmd=c.a,a.a.hmd_conf=E.a,a.a.mixer=l.a,a.a.mouse=T.a,a.a.npc_ai=u.a,a.a.preloader=d.a,a.a.screenshooter=f.a,a.a.storage=P.a,a.a.anchors=A.a,a.a.animation=S.a,a.a.armature=p.a,a.a.assets=v.a,a.a.camera=m.a,a.a.config=O.a,a.a.constraints=N.a,a.a.container=g.a,a.a.controls=h.a,a.a.data=R.a,a.a.debug=I.a,a.a.geometry=b.a,a.a.hud=Y.a,a.a.input=L.a,a.a.lights=M.a,a.a.logic_nodes=y.a,a.a.main=x.a,a.a.material=U.a,a.a.math=w.a,a.a.nla=C.a,a.a.objects=D.a,a.a.particles=F.a,a.a.physics=G.a,a.a.rgb=k.a,a.a.scenes=K.a,a.a.screen=B.a,a.a.sfx=X.a,a.a.textures=j.a,a.a.time=H.a,a.a.transform=Q.a,a.a.tsr=z.a,a.a.util=q.a,a.a.version=V.a,a.a.print=W.a,a.a.vec3=J,a.a.vec4=Z,a.a.mat3=$,a.a.mat4=ee,a.a.quat=te,a.a.register("vec3",function(e,t){for(var r in J)e[r]=J[r]}),a.a.register("vec4",function(e,t){for(var r in Z)e[r]=Z[r]}),a.a.register("mat3",function(e,t){for(var r in $)e[r]=$[r]}),a.a.register("mat4",function(e,t){for(var r in ee)e[r]=ee[r]}),a.a.register("quat",function(e,t){for(var r in te)e[r]=te[r]}),t.a=a.a},function(e,t,r){"use strict";function a(e,t){function r(){var e=q.is_paused(),t=function(){document.hidden?(e=q.is_paused(),q.pause()):e||q.resume()};document.addEventListener("visibilitychange",t,!1)}function a(){var e=0,t=X.get_container(),r=q.is_paused(),a=!0,_=function(){if(e%Me==0){var _=t.getBoundingClientRect();_.top>window.innerHeight||_.bottom<0?(a&&(r=q.is_paused()),q.pause(),a=!1):r||a||(q.resume(),a=!0)}e++};q.append_loop_cb(_)}function _(e,t,r,a){var _=document.createElement("canvas"),n=document.getElementById(e);if(n||(W.error('Warning: canvas container "'+e+'" not found, appending to body'),n=document.body),_.style.position="absolute",_.style.left=0,_.style.top=0,_.style.width=n.offsetWidth+"px",_.style.height=n.offsetHeight+"px",_.width=n.offsetWidth*window.devicePixelRatio,_.height=n.offsetHeight*window.devicePixelRatio,t){var o=document.createElement("canvas");o.style.position="absolute",_.style.left=0,_.style.top=0,o.style.pointerEvents="none"}else var o=null;return n.appendChild(_),q.init(_,o)?(o&&X.insert_to_container(o,"LAST"),!0):(r&&U("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",a),!1)}function m(e,t){e?(t&&(document.getElementById(t).style.display="block"),we=document.getElementById(e)):(we=document.createElement("div"),we.innerHTML=0,we.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",X.insert_to_container(we,"JUST_AFTER_CANVAS"))}function O(e,t){var r=String(e);t&&(r+="/"+String(t)),we.innerHTML=r}function N(e){var t=document.getElementById(e),r=t.cloneNode(!0);return t.parentNode.replaceChild(r,t),r}function g(e,t,r){var a=Math.max(k.hover_get_distance(e),me),_=$.get_rotation(e,Qe),n=ee.quat_to_dir(_,t,je);n[2]=0,v.normalize(n,n),v.scale(n,a*r,n);var o=$.get_translation(e,He);v.add(o,n,o),k.set_translation(e,o)}function h(e,t){var r=k.hover_get_vertical_limits(e,qe);if(r.up!=r.down){var a=k.get_camera_angles(e,Xe)[1],_=(r.down-a)/(r.down-r.up),n=k.hover_get_distance_limits(e,qe);_=Math.max(_,ve/n.max),k.rotate_camera(e,0,_*t)}}function R(e,t,r,a){t*=_e,r*=_e,a*=_e,$.move_local(e,t,r,a)}function I(e){return e/(1-e)}function b(e,t,r){var a=k.target_get_distance(e),_=Math.abs(t),n=Math.pow(_*r,te-Math.pow(_*r,re));t=t<0?a>Ye?-a*n:0:a*I(n),$.move_local(e,0,0,t)}function Y(e,t,r,a,_){for(var n=a*r,o=t;o>0;--o)a+=n,_+=n,n=a*r;return _}function L(e,t,r,a,_,n){if(n){var o=k.target_get_pivot(e,je),i=k.get_translation(e),s=v.dist(o,i)+a;a=t>0?Y(e,t,-r,s,a):Y(e,-t,I(r),s,a)}else a-=t*_*r;return a}function M(e,t,r,a,_,n){Ce=e,De=t,Fe=r,Ge=a,ke=_,Ke=n;var o=Z.get_active_camera();y(o);var i=!1,s=null,c=!1;switch(k.get_move_style(o)){case k.MS_TARGET_CONTROLS:i=!e;break;case k.MS_EYE_CONTROLS:s=Z.get_first_character();break;case k.MS_STATIC:return;case k.MS_HOVER_CONTROLS:c=!0}var E=k.get_velocities(o,ze),l=j.create_elapsed_sensor();if(V.has_simulated_physics(o)){var T=j.create_collision_sensor(o,null,!0),u=function(e,t,r){var a=j.get_sensor_payload(e,t,0).coll_dist;if(a<0){var _=j.get_sensor_payload(e,t,0).coll_norm,n=je;v.scale(_,-be*a,n);var o=$.get_translation(e,He);v.add(o,n,o),$.set_translation_v(e,o)}};j.create_sensor_manifold(o,"CAMERA_COLLISION",j.CT_POSITIVE,[T],null,u)}if(s){var d=$.get_translation(o),f=$.get_rotation(o),P=ee.cam_quat_to_mesh_quat(f);d[2]-=Ie,V.set_transform(s,d,P),B.append_stiff_trans(o,s,[0,0,.5]);var A=new Float32Array(2),S=!0;V.set_character_move_type(s,V.CM_FLY);var p=function(){S=!S,V.set_character_move_type(s,S?V.CM_FLY:V.CM_WALK)};j.create_kb_sensor_manifold(o,"TOGGLE_CHAR_MOVE_TYPE",j.CT_SHOT,j.KEY_C,p)}var m,O,N,I,Y,M,x,U,w,K,X,H,Q=function(e,t,r){if(1==r){var a=j.get_sensor_value(e,t,0);switch(k.get_velocities(e,E),t){case"FORWARD":if(s)A[0]=1;else if(c){var _=k.get_camera_angles(e,Xe)[1],n=Math.abs(_)>=Math.PI/4?ee.AXIS_Y:ee.AXIS_MZ;g(e,n,E.trans*fe*a)}else i?b(e,-E.zoom,a):R(e,0,0,-E.trans*a);break;case"BACKWARD":if(s)A[0]=-1;else if(c){var _=k.get_camera_angles(e,Xe)[1],n=Math.abs(_)>=Math.PI/4?ee.AXIS_MY:ee.AXIS_Z;g(e,n,E.trans*fe*a)}else i?b(e,E.zoom,a):R(e,0,0,E.trans*a);break;case"UP":c?h(e,-E.zoom*Pe*a):s||R(e,0,E.trans*a,0);break;case"DOWN":c?h(e,E.zoom*Pe*a):s||R(e,0,-E.trans*a,0);break;case"LEFT":s?A[1]=1:c?g(e,ee.AXIS_MX,E.trans*fe*a):R(e,-E.trans*a,0,0);break;case"RIGHT":s?A[1]=-1:c?g(e,ee.AXIS_X,E.trans*fe*a):R(e,E.trans*a,0,0);break;case"ROT_LEFT":i?k.rotate_camera(e,-E.rot*Ee*a,0):k.rotate_camera(e,E.rot*Ee*a,0);break;case"ROT_RIGHT":i?k.rotate_camera(e,E.rot*Ee*a,0):k.rotate_camera(e,-E.rot*Ee*a,0);break;case"ROT_UP":i?k.rotate_camera(e,0,-E.rot*Ee*a):k.rotate_camera(e,0,E.rot*Ee*a);break;case"ROT_DOWN":i?k.rotate_camera(e,0,E.rot*Ee*a):k.rotate_camera(e,0,-E.rot*Ee*a)}}else switch(t){case"FORWARD":case"BACKWARD":s&&(A[0]=0);break;case"LEFT":case"RIGHT":s&&(A[1]=0)}if(s){V.set_character_move_dir(s,A[0],A[1]);var o=k.get_camera_angles_char(e,Be);V.set_character_rotation_h(s,o[0]),V.set_character_vert_move_dir_angle(s,o[1])}};if(n)x=U=w=K=X=H=j.create_custom_sensor(0);else{var q=z.check_enable_gamepad_indices();if(q.length)var W=q[q.length-1];else var W=0;x=j.create_gamepad_btn_sensor(z.GMPD_BUTTON_6,W),U=j.create_gamepad_btn_sensor(z.GMPD_BUTTON_7,W),w=j.create_gamepad_axis_sensor(z.GMPD_AXIS_0,q),K=j.create_gamepad_axis_sensor(z.GMPD_AXIS_1,q),X=j.create_gamepad_axis_sensor(z.GMPD_AXIS_2,q),H=j.create_gamepad_axis_sensor(z.GMPD_AXIS_3,q)}t?m=O=N=I=Y=M=j.create_custom_sensor(0):(m=j.create_keyboard_sensor(j.KEY_W),O=j.create_keyboard_sensor(j.KEY_S),N=j.create_keyboard_sensor(j.KEY_A),I=j.create_keyboard_sensor(j.KEY_D),Y=j.create_keyboard_sensor(j.KEY_R),M=j.create_keyboard_sensor(j.KEY_F));var J=j.create_keyboard_sensor(j.KEY_UP),te=j.create_keyboard_sensor(j.KEY_DOWN),re=j.create_keyboard_sensor(j.KEY_LEFT),_e=j.create_keyboard_sensor(j.KEY_RIGHT),ve=function(e){return e[0]&&(e[1]||e[2]||e[3])},me=function(e){return e[0]&&(e[1]||e[2]>ye)},Oe=function(e){return e[0]&&(e[1]||e[2]<-ye)},Ne=function(e){return e[0]&&(e[1]||e[2]||e[3]>ye)},ge=function(e){return e[0]&&(e[1]||e[2]||e[3]<-ye)};if(c||(j.create_sensor_manifold(o,"FORWARD",j.CT_CONTINUOUS,[l,m,K],Oe,Q),j.create_sensor_manifold(o,"BACKWARD",j.CT_CONTINUOUS,[l,O,K],me,Q)),i?(j.create_sensor_manifold(o,"ROT_UP",j.CT_CONTINUOUS,[l,J,Y,H],ge,Q),j.create_sensor_manifold(o,"ROT_DOWN",j.CT_CONTINUOUS,[l,te,M,H],Ne,Q),j.create_sensor_manifold(o,"ROT_LEFT",j.CT_CONTINUOUS,[l,re,N,X],ge,Q),j.create_sensor_manifold(o,"ROT_RIGHT",j.CT_CONTINUOUS,[l,_e,I,X],Ne,Q)):c?(j.create_sensor_manifold(o,"LEFT",j.CT_CONTINUOUS,[l,re,N,w],ge,Q),j.create_sensor_manifold(o,"RIGHT",j.CT_CONTINUOUS,[l,_e,I,w],Ne,Q),j.create_sensor_manifold(o,"FORWARD",j.CT_CONTINUOUS,[l,J,m,K],ge,Q),j.create_sensor_manifold(o,"BACKWARD",j.CT_CONTINUOUS,[l,te,O,K],Ne,Q),j.create_sensor_manifold(o,"UP",j.CT_CONTINUOUS,[l,M,H],me,Q),j.create_sensor_manifold(o,"DOWN",j.CT_CONTINUOUS,[l,Y,H],Oe,Q)):(j.create_sensor_manifold(o,"UP",j.CT_CONTINUOUS,[l,Y,x],ve,Q),j.create_sensor_manifold(o,"DOWN",j.CT_CONTINUOUS,[l,M,U],ve,Q),j.create_sensor_manifold(o,"LEFT",j.CT_CONTINUOUS,[l,N,w],Oe,Q),j.create_sensor_manifold(o,"RIGHT",j.CT_CONTINUOUS,[l,I,w],me,Q),j.create_sensor_manifold(o,"ROT_UP",j.CT_CONTINUOUS,[l,J,H],Oe,Q),j.create_sensor_manifold(o,"ROT_DOWN",j.CT_CONTINUOUS,[l,te,H],me,Q),j.create_sensor_manifold(o,"ROT_LEFT",j.CT_CONTINUOUS,[l,re,X],Oe,Q),j.create_sensor_manifold(o,"ROT_RIGHT",j.CT_CONTINUOUS,[l,_e,X],me,Q)),!r){var he=0,Re=j.create_mouse_wheel_sensor(a),Me=0,we=j.create_touch_zoom_sensor(a),Qe=function(e,t,r){if(1==r){var a=j.get_sensor_value(e,t,0);if(k.get_velocities(e,E),i||c)he=L(e,a,E.zoom,he,Se,i);else{var _=a*E.zoom;E.trans*=1+_,k.set_velocities(e,E)}}};j.create_sensor_manifold(o,"MOUSE_WHEEL",j.CT_LEVEL,[Re],null,Qe);var qe=function(e,t,r,a){if(1==r){var _=j.get_sensor_value(e,t,0);k.get_velocities(e,E),j.get_sensor_payload(e,t,0)===j.PL_MULTITOUCH_MOVE_ZOOM&&(Me=L(e,_,E.zoom*ae,Me,pe,i))}};j.create_sensor_manifold(o,"TOUCH_ZOOM",j.CT_LEVEL,[we],null,qe);var Ve=function(e,t,r){if(i||c)if(Math.abs(he)>Le||Math.abs(Me)>Le){var a=j.get_sensor_value(e,t,0),_=ee.smooth(he,0,a,C());he-=_;var n=ee.smooth(Me,0,a,D());if(Me-=n,c)h(e,-(_+n));else{var o=k.target_get_distance(e)+_+n;o=Math.max(o,Ye),k.target_set_distance(e,o)}}else he=0,Me=0};j.create_sensor_manifold(o,"ZOOM_INTERPOL",j.CT_POSITIVE,[l],null,Ve)}var We=0,Je=0,Ze=0,$e=0,et=function(e,t,r,a){if(1==r){var _=j.get_sensor_value(e,t,1);if(k.get_velocities(e,E),c)var n=le*E.trans,o=Te*E.rot;else var n=oe*E.rot,o=ie*E.trans;1===j.get_sensor_payload(e,t,0).which?(We+="X"==a?-_*n:0,Je+="Y"==a?-_*n:0):2!==j.get_sensor_payload(e,t,0).which&&3!==j.get_sensor_payload(e,t,0).which||(Ze+="X"==a?-_*o:0,$e+="Y"==a?-_*o:0)}},tt=0,rt=0;if(!n){var at=function(e,t,r){k.get_velocities(e,E),tt+=E.trans*xe},_t=function(e,t,r){k.get_velocities(e,E),rt+=E.zoom*Ue},nt=function(e,t,r){k.get_velocities(e,E),tt-=E.trans*xe},ot=function(e,t,r){k.get_velocities(e,E),rt-=E.zoom*Ue};i?(j.create_sensor_manifold(o,"GMPD_PAN_Y_POS",j.CT_CONTINUOUS,[x],null,_t),j.create_sensor_manifold(o,"GMPD_PAN_Y_NEG",j.CT_CONTINUOUS,[U],null,ot),j.create_sensor_manifold(o,"GMPD_PAN_X_POS",j.CT_CONTINUOUS,[w],function(e){return e[0]<-ye},nt),j.create_sensor_manifold(o,"GMPD_PAN_X_NEG",j.CT_CONTINUOUS,[w],function(e){return e[0]>ye},at)):c&&(j.create_sensor_manifold(o,"GMPD_PAN_X_POS",j.CT_CONTINUOUS,[X],function(e){return e[0]<-ye},nt),j.create_sensor_manifold(o,"GMPD_PAN_X_NEG",j.CT_CONTINUOUS,[X],function(e){return e[0]>ye},at))}if(_){var it=j.create_mouse_move_sensor("X",window),st=j.create_mouse_move_sensor("Y",window),ct=j.create_mouse_click_sensor(a),Et=j.create_mouse_click_sensor(window),lt=!1,Tt=function(e){return e[2]?lt=!0:e[0]||(lt=!1),lt&&e[0]};j.create_sensor_manifold(o,"MOUSE_X",j.CT_POSITIVE,[Et,it,ct],Tt,et,"X"),j.create_sensor_manifold(o,"MOUSE_Y",j.CT_POSITIVE,[Et,st,ct],Tt,et,"Y");var ut=z.get_device_by_type_element(z.DEVICE_MOUSE,window);z.switch_prevent_default(ut,!1)}else{var it=j.create_mouse_move_sensor("X",a),st=j.create_mouse_move_sensor("Y",a),dt=j.create_mouse_click_sensor(a);j.create_sensor_manifold(o,"MOUSE_X",j.CT_POSITIVE,[dt,it],null,et,"X"),j.create_sensor_manifold(o,"MOUSE_Y",j.CT_POSITIVE,[dt,st],null,et,"Y")}var ft=0,Pt=0,At=0,St=0,pt=j.create_touch_move_sensor("X",a),vt=j.create_touch_move_sensor("Y",a),mt=function(e,t,r,a){if(1==r){if(k.get_velocities(e,E),c)var _=ue*E.trans;else var _=se*E.rot;var n=j.get_sensor_value(e,t,0);if(j.get_sensor_payload(e,t,0).gesture===j.PL_SINGLE_TOUCH_MOVE)ft+="X"==a?-n*_:0,Pt+="Y"==a?-n*_:0;else if(j.get_sensor_payload(e,t,0).gesture===j.PL_MULTITOUCH_MOVE_PAN){if(c)var o=de*E.rot;else var o=ce*E.trans;At+="X"==a?-n*o:0,St+="Y"==a?-n*o:0}}};j.create_sensor_manifold(o,"TOUCH_X",j.CT_POSITIVE,[pt],null,mt,"X"),j.create_sensor_manifold(o,"TOUCH_Y",j.CT_POSITIVE,[vt],null,mt,"Y");var Ot=function(e,t,r){if(Math.abs(We)>Le||Math.abs(Je)>Le||Math.abs(ft)>Le||Math.abs(Pt)>Le||Math.abs(Ze)>Le||Math.abs($e)>Le||Math.abs(At)>Le||Math.abs(St)>Le||Math.abs(tt)>Le||Math.abs(rt)>Le){var a=j.get_sensor_value(e,t,0),_=ee.smooth(We,0,a,F()),n=ee.smooth(Je,0,a,F());We-=_,Je-=n;var o=ee.smooth(ft,0,a,G()),E=ee.smooth(Pt,0,a,G());ft-=o,Pt-=E;var l=ee.smooth(Ze,0,a,F()),T=ee.smooth($e,0,a,F());Ze-=l,$e-=T;var u=ee.smooth(At,0,a,G()),d=ee.smooth(St,0,a,G());At-=u,St-=d;var f=ee.smooth(tt,0,a,F()),P=ee.smooth(rt,0,a,F());if(tt-=f,rt-=P,i){k.rotate_camera(e,_+o,n+E);var A=k.target_get_distance(e);k.target_pan_pivot(e,A*(l+u+f),A*(T+d+P))}else if(c){if(_+o&&g(e,ee.AXIS_X,(_+o)*Ae),n+E){var S=k.get_camera_angles(e,Xe)[1],p=Math.abs(S)>Math.PI/4?ee.AXIS_MY:ee.AXIS_Z;g(e,p,(n+E)*Ae)}k.rotate_camera(e,l+u+f,0)}else if(k.rotate_camera(e,(_+o)*ne,(n+E)*ne),s){var v=k.get_camera_angles_char(e,Be);V.set_character_rotation_h(s,v[0]),V.set_character_vert_move_dir_angle(s,v[1])}}};j.create_sensor_manifold(o,"ROT_TRANS_INTERPOL",j.CT_POSITIVE,[l],null,Ot),j.create_kb_sensor_manifold(o,"DEC_STEREO_DIST",j.CT_SHOT,j.KEY_LEFT_SQ_BRACKET,function(e,t,r){var a=k.get_stereo_distance(e);k.set_stereo_distance(e,.9*a)}),j.create_kb_sensor_manifold(o,"INC_STEREO_DIST",j.CT_SHOT,j.KEY_RIGHT_SQ_BRACKET,function(e,t,r){var a=k.get_stereo_distance(e);k.set_stereo_distance(e,1.1*a)})}function y(e){function t(e,t,r){x(),M(Ce,De,Fe,Ge,ke,Ke)}var r=k.get_move_style(e),a=function(){var t=k.get_move_style(e),a=t!=r;return r=t,a},_=j.create_callback_sensor(a);j.create_sensor_manifold(e,"CHANGE_MOVE_STYLE",j.CT_POSITIVE,[_],null,t)}function x(){var e=Z.get_active_camera();j.check_sensor_manifold(e,"TOGGLE_CHAR_MOVE_TYPE")&&Z.get_first_character()&&B.remove(e);for(var t=["FORWARD","BACKWARD","ROT_UP","ROT_DOWN","ROT_LEFT","ROT_RIGHT","UP","DOWN","LEFT","RIGHT","MOUSE_WHEEL","TOUCH_ZOOM","ZOOM_INTERPOL","MOUSE_X","MOUSE_Y","TOUCH_X","TOUCH_Y","ROT_TRANS_INTERPOL","CHANGE_MOVE_STYLE","TOGGLE_CHAR_MOVE_TYPE"],r=0;r<t.length;r++)j.remove_sensor_manifold(e,t[r])}function U(e,t,r,a){var _=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div");if(a)for(var i=0;i<a.length;i++){var s=document.getElementById(a[i]);s&&s.parentNode.removeChild(s)}_.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;",n.style.cssText="color:#fff;font-size:24px;",o.style.cssText="color:#fff;font-size:20px;",n.innerHTML=e,o.innerHTML=t+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+r+'">'+r.replace("https://www.","")+"</a>",_.appendChild(n),_.appendChild(o),document.body.appendChild(_)}function w(e,t,r,a,_){function n(){var i=performance.now()-o;_(t+i*(r-t)/a),(i>=a||!e.parentNode)&&q.remove_loop_cb(n)}var o=performance.now();q.append_loop_cb(n)}function C(){return Ne*Oe}function D(){return ge*Oe}function F(){return he*Oe}function G(){return Re*Oe}var k=Object(n.a)(e),K=Object(o.a)(e),B=Object(i.a)(e),X=Object(s.a)(e),j=Object(c.a)(e),H=Object(E.a)(e),Q=Object(l.a)(e),z=Object(T.a)(e),q=Object(u.a)(e),V=Object(d.a)(e),W=Object(f.a)(e),J=Object(P.a)(e),Z=Object(A.a)(e),$=Object(S.a)(e),ee=Object(p.a)(e),te=1,re=.15,ae=.03,_e=5,ne=.5,oe=.003,ie=75e-5,se=.003,ce=75e-5,Ee=.75,le=.003,Te=75e-5,ue=.003,de=.003,fe=.5,Pe=30,Ae=.2,Se=2,pe=2,ve=2,me=1,Oe=1,Ne=.1,ge=.15,he=.08,Re=.12,Ie=.5,be=.25,Ye=.001,Le=1e-5,Me=10,ye=.1,xe=.002,Ue=.05,we=null,Ce=!1,De=!1,Fe=!1,Ge=null,ke=!1,Ke=!1,Be=new Float32Array(2),Xe=new Float32Array(2),je=new Float32Array(3),He=new Float32Array(3),Qe=new Float32Array(4),ze={},qe={};t.init=function(e){e=e||{};var t=!1,n=null,o=function(){},i=null,s=null,c=0,E=null,l=!0,T=!1,u=!0,d=!0,f=!1,P=!1,A=!1,S=!1,p=K.get("quality");for(var v in e)switch(v){case"canvas_container_id":n=e.canvas_container_id;break;case"callback":o=e.callback;break;case"autoresize":t=e.autoresize;break;case"show_hud_debug_info":A=e.show_hud_debug_info;break;case"sfx_mix_mode":f=e.sfx_mix_mode;break;case"show_fps":P=e.show_fps;break;case"track_container_position":S=e.track_container_position,W.error_once("track_container_position deprecated. Not needed anymore. Use the container.get_coords_target_space method.");break;case"fps_wrapper_id":E=e.fps_wrapper_id;break;case"fps_elem_id":s=e.fps_elem_id;break;case"error_purge_elements":i=e.error_purge_elements;break;case"report_init_failure":d=e.report_init_failure;break;case"pause_invisible":u=e.pause_invisible;break;case"key_pause_enabled":l=e.key_pause_enabled;break;case"force_container_ratio":c=e.force_container_ratio;break;case"min_capabilities":T=e.min_capabilities;break;case"quality":p=e.quality;break;default:K.set(v,e[v])}p!=K.P_AUTO&&K.set("quality",p);var N=function(e){e.keyCode==j.KEY_P&&(q.is_paused()?q.resume():q.pause())};l&&document.addEventListener("keydown",N,!1),K.set("show_hud_debug_info",A),K.set("sfx_mix_mode",f);var g=A||f||null,h=function(){var e=_(n,g,d,i),l=X.get_canvas();if(!e)return void o(l,!1);var f=X.get_container();X.resize_to_container(),P&&(m(s,E),q.set_fps_callback(O)),u&&(r(),a()),c&&q.append_loop_cb(function(){f.style.height=f.clientWidth/c+"px"}),t&&q.append_loop_cb(function(){X.resize_to_container()}),S&&q.append_loop_cb(function(){X.force_offsets_updating()}),T&&K.reset_limits(),p==K.P_AUTO?Q.test_performance(function(e,t){0==e?(W.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),K.apply_quality(K.P_HIGH)):t<1.5?(W.log("QUALITY TEST RESULT: LOW ("+t.toFixed(1)+" GB/s)"),K.apply_quality(K.P_LOW)):(W.log("QUALITY TEST RESULT: HIGH ("+t.toFixed(1)+" GB/s)"),K.apply_quality(K.P_HIGH)),o(l,!0)}):o(l,!0)},R=function(){H.cleanup()};"complete"==document.readyState?window.setTimeout(h,0):window.addEventListener("load",h,!1),window.addEventListener("unload",R,!1)},t.set_onclick=function(e,t){var r=N(e);r.addEventListener("mouseup",function(e){t(r.value)},!1)},t.set_onchange=function(e,t){var r=N(e);r.addEventListener("change",function(e){var a=r.checked,_=void 0!=a?a:r.value;t(_)},!1)},t.set_onkeypress=function(e,t){var r=N(e);r.addEventListener("keypress",function(e){t(e.keyCode,r.value)},!1)},t.enable_camera_controls=M,t.disable_camera_controls=x,t.enable_object_controls=function(e,t){var r=V.is_vehicle_chassis(e)||V.is_vehicle_hull(e),a=function(e,t,a){if(1==a){var _=j.get_sensor_value(e,t,0);switch(t){case"FORWARD":r?V.vehicle_throttle(e,1):$.move_local(e,0,-1*_,0);break;case"BACKWARD":r?V.vehicle_throttle(e,-1):$.move_local(e,0,1*_,0);break;case"LEFT":r?V.vehicle_steer(e,-1):$.move_local(e,1*_,0,0);break;case"RIGHT":r?V.vehicle_steer(e,1):$.move_local(e,-1*_,0,0)}}else switch(t){case"FORWARD":case"BACKWARD":r&&V.vehicle_throttle(e,0);break;case"LEFT":case"RIGHT":r&&V.vehicle_steer(e,0)}},_=j.create_elapsed_sensor(),n=j.create_keyboard_sensor(j.KEY_W),o=j.create_keyboard_sensor(j.KEY_S),i=j.create_keyboard_sensor(j.KEY_A),s=j.create_keyboard_sensor(j.KEY_D),c=j.create_keyboard_sensor(j.KEY_UP),E=j.create_keyboard_sensor(j.KEY_DOWN),l=j.create_keyboard_sensor(j.KEY_LEFT),T=j.create_keyboard_sensor(j.KEY_RIGHT),u=function(e){return e[0]&&(e[1]||e[2])};j.create_sensor_manifold(e,"FORWARD",j.CT_CONTINUOUS,[_,n,c],u,a),j.create_sensor_manifold(e,"BACKWARD",j.CT_CONTINUOUS,[_,o,E],u,a),j.create_sensor_manifold(e,"LEFT",j.CT_CONTINUOUS,[_,i,l],u,a),j.create_sensor_manifold(e,"RIGHT",j.CT_CONTINUOUS,[_,s,T],u,a)},t.disable_object_controls=function(e){for(var t=["FORWARD","BACKWARD","LEFT","RIGHT"],r=0;r<t.length;r++)j.remove_sensor_manifold(e,t[r])},t.enable_debug_controls=function(){j.create_kb_sensor_manifold(null,"CAMERA_SHOT",j.CT_SHOT,j.KEY_K,function(){Q.make_camera_frustum_shot()}),j.create_kb_sensor_manifold(null,"LIGHT_SHOT",j.CT_SHOT,j.KEY_L,function(){Q.make_light_frustum_shot()}),j.create_kb_sensor_manifold(null,"TELEMETRY",j.CT_SHOT,j.KEY_T,function(){Q.plot_telemetry()})},t.request_fullscreen=function(e,t,r){W.error_deprecated("request_fullscreen","screen.request_fullscreen"),J.request_fullscreen(e,t,r)},t.exit_fullscreen=function(){W.error_deprecated("exit_fullscreen","screen.exit_fullscreen"),J.exit_fullscreen()},t.check_fullscreen=function(){return W.error_deprecated("check_fullscreen","screen.check_fullscreen"),J.check_fullscreen()},t.report_app_error=U,t.get_url_params=function(e){e=!!e;var t=decodeURIComponent(location.href.toString());if(-1==t.indexOf("?"))return null;for(var r=t.split("?")[1].split("&"),a={},_=0;_<r.length;_++){var n=r[_].split("="),o=n[0];if(n.length>1){var i=n[1];e?o in a?a[o].push(i):a[o]=[i]:a[o]=i}else e?o in a||(a[o]=[]):a[o]=""}return a},t.css_animate=function(e,t,r,a,_,n,o,i){function s(_){e&&(c[t]=n+_+o,(r>a&&_<=a||r<a&&_>=a)&&(c[t]=n+a+o,i()))}if(e&&t&&isFinite(r)&&isFinite(a)&&isFinite(_)){n=n||"",o=o||"",i=i||function(){};var c=e.style,E=t.charAt(0).toUpperCase()+t.slice(1);if(void 0!=c[t]);else if(void 0!=c["webkit"+E])t="webkit"+E;else if(void 0!=c["ms"+E])t="ms"+E;else{if(void 0==c["moz"+E])return;t="moz"+E}w(e,r,a,_,s)}},t.attr_animate=function(e,t,r,a,_,n){function o(_){e&&(_>=0&&e.setAttribute(t,_),(r>a&&_<=a||r<a&&_>=a)&&(e.setAttribute(t,a),n()))}e&&t&&isFinite(r)&&isFinite(a)&&isFinite(_)&&(n=n||function(){},w(e,r,a,_,o))},t.queue_animate=function(e){if(e.length){var r=e.shift(),a=r.elem,_=r.prop,n=r.from,o=r.to,i=r.duration,s=r.opt_prefix,c=r.opt_suffix,E=function(){r.cb&&r.cb(),t.queue_animate(e)};"css"==r.type?t.css_animate(a,_,n,o,i,s,c,E):"attr"==r.type&&t.attr_animate(a,_,n,o,i,E)}},t.set_camera_smooth_factor=function(e){Oe=e},t.get_camera_smooth_factor=function(){return Oe}}var _=r(0),n=r(36),o=r(83),i=r(71),s=r(43),c=r(24),E=r(84),l=r(85),T=r(52),u=r(64),d=r(57),f=r(1),P=r(53),A=r(31),S=r(44),p=r(26),v=r(3),m=Object(_.a)("app",a);t.a=m},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e);t.nodegraph_to_dot=function(e,t){if(t)var a=function(e){var t="";switch(e.type){case"GEOMETRY_UV":t="\nuv_layer: "+e.data.value;break;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":t="\ntexture: "+e.data.value.name+"\n("+e.data.value.img_filepath+")"}return""==t&&(t="\n---"),t},_=function(e,t){var r=t.type+"("+t.name+")",_=t.inputs;if(r+="\n\nINPUTS:",_.length)for(var n=0;n<_.length;n++)r+="\n"+_[n].identifier+": ",_[n].is_linked?r+="linked":r+=_[n].default_value;else r+="\n---";var o=t.outputs;if(r+="\n\nOUTPUTS:",o.length)for(var n=0;n<o.length;n++)r+="\n"+o[n].identifier+": ",o[n].is_linked?r+="linked(default "+o[n].default_value+")":r+="not used";else r+="\n---";return r+="\n\nDATA:",r+=a(t)},n=function(t,a,_){var n=r.get_node_attr(e,t),o=r.get_node_attr(e,a),i=n.outputs[_[0]],s=o.inputs[_[1]];return i.identifier+"\n==>\n"+s.identifier};else var _=function(e,t){return t.type},n=function(t,a,_){var n=r.get_node_attr(e,t),o=r.get_node_attr(e,a),i=n.outputs[_[0]],s=o.inputs[_[1]];return i.identifier+"\n==>\n"+s.identifier};return r.debug_dot(e,_,n)}}var _=r(0),n=r(30),o=Object(_.a)("__debug_nodegraph",a);t.a=o},function(e,t,r){"use strict";function a(e,t){function r(e){for(var t=document.getElementsByTagName("script"),r=Object(s.b)(e),a=0;a<t.length;a++)if(t[a].src==r)return t[a];return null}function a(e,t,r){for(var a=0;a<m.length;a+=2)m[a+1]==e&&(v[a+Number(!t)]=r)}function _(e,t){for(var r=0;r<m.length;r+=2)if(m[r+1]==e)return v[r+Number(!t)];return null}function c(e){for(var t=0;t<e.length;t++){var r=e[t],a=0;for(var _ in r){var n=r[_];switch(n.constructor){case Float32Array:a+=n.length;break;case Number:a+=1}}a-=1,r.len=a}}var E=Object(o.a)(e),l=Object(i.a)(e),T=!0;t.IN_LOADED=0,t.IN_COLLISION=1,t.IN_COLLISION_POS_NORM=2,t.IN_COLLISION_IMPULSE=3,t.IN_ERROR=4,t.IN_FBMSG=5,t.IN_FLOATER_BOB_TRANSFORM=6,t.IN_LOG=7,t.IN_PROP_OFFSET=8,t.IN_RAY_HIT=9,t.IN_RAY_HIT_POS_NORM=10,t.IN_REMOVE_RAY_TEST=11,t.IN_TRANSFORM=12,t.IN_VEHICLE_SPEED=13,t.IN_PING=14,t.IN_FPS=15,t.IN_DEBUG_STATS=16;var u=t.IN_COLLISION,d=t.IN_COLLISION_POS_NORM,f=t.IN_PROP_OFFSET,P=t.IN_RAY_HIT,A=t.IN_RAY_HIT_POS_NORM,S=t.IN_TRANSFORM;t.OUT_INIT=100,t.OUT_ACTIVATE=101,t.OUT_ADD_BOAT_BOB=102,t.OUT_ADD_CAR_WHEEL=103,t.OUT_ADD_FLOATER_BOB=104,t.OUT_APPEND_BOUNDING_BODY=105,t.OUT_APPEND_BOAT=106,t.OUT_APPEND_CAR=107,t.OUT_APPEND_CHARACTER=108,t.OUT_APPEND_COLLISION_TEST=109,t.OUT_APPEND_CONSTRAINT=110,t.OUT_APPEND_FLOATER=111,t.OUT_APPEND_GHOST_MESH_BODY=112,t.OUT_APPEND_STATIC_MESH_BODY=113,t.OUT_APPEND_WATER=114,t.OUT_REMOVE_BODY=115,t.OUT_APPLY_CENTRAL_FORCE=116,t.OUT_APPLY_COLLISION_IMPULSE_TEST=117,t.OUT_APPLY_TORQUE=118,t.OUT_CHARACTER_JUMP=119,t.OUT_CHARACTER_ROTATION_INCREMENT=120,t.OUT_CLEAR_COLLISION_IMPULSE_TEST=121,t.OUT_DISABLE_SIMULATION=122,t.OUT_ENABLE_SIMULATION=123,t.OUT_PAUSE=124,t.OUT_APPEND_RAY_TEST=125,t.OUT_REMOVE_RAY_TEST=126,t.OUT_CHANGE_RAY_TEST_FROM_TO=127,t.OUT_REMOVE_COLLISION_TEST=128,t.OUT_REMOVE_CONSTRAINT=129,t.OUT_RESUME=130,t.OUT_SET_CHARACTER_FLY_VELOCITY=131,t.OUT_SET_CHARACTER_HOR_ROTATION=132,t.OUT_SET_CHARACTER_MOVE_DIR=133,t.OUT_SET_CHARACTER_MOVE_TYPE=134,t.OUT_SET_CHARACTER_ROTATION=135,t.OUT_SET_CHARACTER_RUN_VELOCITY=136,t.OUT_SET_CHARACTER_VERT_ROTATION=137,t.OUT_SET_CHARACTER_WALK_VELOCITY=138,t.OUT_SET_GRAVITY=139,t.OUT_SET_LINEAR_VELOCITY=140,t.OUT_SET_TRANSFORM=141,t.OUT_SET_WATER_TIME=142,t.OUT_ADD_WATER_WRAPPER=143,t.OUT_UPDATE_BOAT_CONTROLS=144,t.OUT_UPDATE_CAR_CONTROLS=145,t.OUT_PING=146,t.OUT_DEBUG=147,t.OUT_UPDATE_WORLD=148,t.OUT_SET_ANGULAR_VELOCITY=149,t.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE=150,t.OUT_UPDATE_BOUNDING_BODY=151,t.OUT_UPDATE_STATIC_MESH_BODY=152;var p=t.OUT_SET_TRANSFORM,v=n.a.worker_listeners,m=n.a.worker_namespaces,O={msg_id:S,body_id:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),linvel:new Float32Array(3),angvel:new Float32Array(3),len:0},N={msg_id:f,chassis_hull_body_id:0,prop_ind:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},g={msg_id:P,id:0,body_id_hit:0,hit_fract:0,hit_time:0,len:0},h={msg_id:A,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},R={msg_id:u,body_id_a:0,body_id_b:0,result:0,len:0},I={msg_id:d,body_id_a:0,body_id_b:0,result:0,coll_point:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},b={msg_id:p,body_id:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},Y=[O,N,g,h,R,I,b];t.create_worker=function(t,o){var i={is_main:!!t,web_worker:null,buf_arr:[],fb_worker_ns:""};if(o){var s={addEventListener:function(e,t,r){"message"!=e&&E.panic("Wrong web worker event"),a(i.fb_worker_ns,i.is_main,t)},removeEventListener:function(e,t,r){"message"!=e&&E.panic("Wrong web worker event"),a(i.fb_worker_ns,i.is_main,null)},postMessage:function(e,t){_(i.fb_worker_ns,!i.is_main)({data:e})},terminate:function(){for(var e=0;e<m.length;e+=2)if(m[e+1]==i.fb_worker_ns)return v.splice(e,2),void m.splice(e,2)}};if(i.web_worker=s,i.is_main){var c=e,u=l.unique_name(c+"_worker");m.push(c),m.push(u),v.push(null),v.push(null),i.fb_worker_ns=u;var d=r(t);d?T?d.addEventListener("load",function(){n.a.require("__bindings",i.fb_worker_ns)},!1):(n.a.cleanup("__bindings",i.fb_worker_ns),n.a.cleanup("__ipc",i.fb_worker_ns),n.a.require("__bindings",i.fb_worker_ns)):(d=document.createElement("script"),d.src=t,d.defer="defer",d.async="async",d.addEventListener("load",function(){T=!1,n.a.require("__bindings",i.fb_worker_ns)},!1),document.head.appendChild(d))}else i.fb_worker_ns=e}else i.web_worker=t?new Worker(t):self;return i},t.attach_handler=function(e,t){c(Y);var r=function(a){if(a.constructor==ArrayBuffer)a=new Float32Array(a);else if(a[0].constructor==ArrayBuffer){for(var _=0;_<a.length;_++)r(a[_]);return}var n=0|a[0];switch(n){case S:var o=O;o.body_id=0|a[1],o.time=a[2],o.trans[0]=a[3],o.trans[1]=a[4],o.trans[2]=a[5],o.quat[0]=a[6],o.quat[1]=a[7],o.quat[2]=a[8],o.quat[3]=a[9],o.linvel[0]=a[10],o.linvel[1]=a[11],o.linvel[2]=a[12],o.angvel[0]=a[13],o.angvel[1]=a[14],o.angvel[2]=a[15];break;case f:var o=N;o.chassis_hull_body_id=0|a[1],o.prop_ind=0|a[2],o.trans[0]=a[3],o.trans[1]=a[4],o.trans[2]=a[5],o.quat[0]=a[6],o.quat[1]=a[7],o.quat[2]=a[8],o.quat[3]=a[9];break;case P:var o=g;o.id=0|a[1],o.body_id_hit=0|a[2],o.hit_fract=a[3],o.hit_time=a[4];break;case A:var o=h;o.id=0|a[1],o.body_id_hit=0|a[2],o.hit_fract=a[3],o.hit_time=a[4],o.hit_pos[0]=a[5],o.hit_pos[1]=a[6],o.hit_pos[2]=a[7],o.hit_norm[0]=a[8],o.hit_norm[1]=a[9],o.hit_norm[2]=a[10];break;case u:var o=R;o.body_id_a=0|a[1],o.body_id_b=0|a[2],o.result=!!a[3];break;case d:var o=I;o.body_id_a=0|a[1],o.body_id_b=0|a[2],o.result=!!a[3],o.coll_point[0]=a[4],o.coll_point[1]=a[5],o.coll_point[2]=a[6],o.coll_norm[0]=a[7],o.coll_norm[1]=a[8],o.coll_norm[2]=a[9],o.coll_dist=a[10];break;case p:var o=b;o.body_id=0|a[1],o.trans[0]=a[2],o.trans[1]=a[3],o.trans[2]=a[4],o.quat[0]=a[5],o.quat[1]=a[6],o.quat[2]=a[7],o.quat[3]=a[8];break;default:var o=a}t(e,n,o)};e.web_worker.addEventListener("message",function(e){r(e.data)},!1)},t.cleanup=function(){},t.post_msg=function(e,t){if(e)switch(t){case S:var r=O,a=new Float32Array(r.len);a[0]=r.msg_id,a[1]=r.body_id,a[2]=r.time,a[3]=r.trans[0],a[4]=r.trans[1],a[5]=r.trans[2],a[6]=r.quat[0],a[7]=r.quat[1],a[8]=r.quat[2],a[9]=r.quat[3],a[10]=r.linvel[0],a[11]=r.linvel[1],a[12]=r.linvel[2],a[13]=r.angvel[0],a[14]=r.angvel[1],a[15]=r.angvel[2],e.buf_arr.push(a.buffer);break;case f:var r=N,a=new Float32Array(r.len);a[0]=r.msg_id,a[1]=r.chassis_hull_body_id,a[2]=r.prop_ind,a[3]=r.trans[0],a[4]=r.trans[1],a[5]=r.trans[2],a[6]=r.quat[0],a[7]=r.quat[1],a[8]=r.quat[2],a[9]=r.quat[3],e.buf_arr.push(a.buffer);break;case P:var r=g,a=new Float32Array(r.len);a[0]=r.msg_id,a[1]=r.id,a[2]=r.body_id_hit,a[3]=r.hit_fract,a[4]=r.hit_time,e.buf_arr.push(a.buffer);break;case A:var r=h,a=new Float32Array(r.len);a[0]=r.msg_id,a[1]=r.id,a[2]=r.body_id_hit,a[3]=r.hit_fract,a[4]=r.hit_time,a[5]=r.hit_pos[0],a[6]=r.hit_pos[1],a[7]=r.hit_pos[2],a[8]=r.hit_norm[0],a[9]=r.hit_norm[1],a[10]=r.hit_norm[2],e.buf_arr.push(a.buffer);break;case u:var r=R,a=new Float32Array(r.len);a[0]=r.msg_id,a[1]=r.body_id_a,a[2]=r.body_id_b,a[3]=r.result,e.buf_arr.push(a.buffer);break;case d:var r=I,a=new Float32Array(r.len);a[0]=r.msg_id,a[1]=r.body_id_a,a[2]=r.body_id_b,a[3]=r.result,a[4]=r.coll_point[0],a[5]=r.coll_point[1],a[6]=r.coll_point[2],a[7]=r.coll_norm[0],a[8]=r.coll_norm[1],a[9]=r.coll_norm[2],a[10]=r.coll_dist,e.buf_arr.push(a.buffer);break;case p:var r=b,a=new Float32Array(r.len);a[0]=r.msg_id,a[1]=r.body_id,a[2]=r.trans[0],a[3]=r.trans[1],a[4]=r.trans[2],a[5]=r.quat[0],a[6]=r.quat[1],a[7]=r.quat[2],a[8]=r.quat[3],e.buf_arr.push(a.buffer);break;default:for(var a=[],_=1;_<arguments.length;_++)a.push(arguments[_]);e.web_worker.postMessage(a)}},t.post_msg_arr=function(e){e&&e.buf_arr.length&&(e.web_worker.postMessage(e.buf_arr),e.buf_arr.length=0)},t.get_msg_cache=function(e){switch(e){case S:return O;case f:return N;case P:return g;case A:return h;case u:return R;case d:return I;case p:return b;default:return null}},t.terminate=function(e){e.web_worker.terminate(),e.web_worker=null},t.is_active=function(e){return!!e.web_worker},t.is_fallback=function(e){return!!e.fb_worker_ns}}var _=r(0),n=r(35),o=r(5),i=r(34),s=r(51),c=Object(_.a)("__ipc",a);t.a=c},function(e,t,r){"use strict";function a(e,t){function r(e){e.sort(a)}function a(e,t){return e.z_index-t.z_index}function _(e,t){if(e.world_bounds){var r=e.world_bounds.bs;return T.squaredDistance(r.center,t)+r.radius*r.radius}return 1/0}function u(e,t){var r=e.obj_render;if(r.is_visible=!1,r.hide)return!1;var a=t.camera;if(t.type==v.SHADOW_CAST)var _=a.lod_eye;else var _=E.j(a.world_tsr,N);var n=e.batch;return!!S.update_lod_visibility(n,r,_)&&(r.is_visible=!0,t.type==v.DEBUG_VIEW?t.debug_view_mode==P.DV_BOUNDINGS?n.debug_sphere:!n.debug_sphere:(t.type!=v.OUTLINE_MASK||0!=r.outline_intensity)&&!(!n.do_not_cull&&e.world_bounds&&m&&d(a.frustum_planes,e.world_bounds.bs,e.world_bounds.be,n.use_be)))}function d(e,t,r,a){var _=t.center;if(l._56(_,e,t.radius))return!0;if(!a)return!1;var n=r.axis_x,o=r.axis_y,i=r.axis_z;return _=r.center,l.X(_,e,n,o,i)}function f(e){var t=e.particles_data;if(t&&t.need_buffers_update){var r=e.bufs_data;A.make_dynamic(r);var a=r.pointers,_=a.a_position.offset;A.vbo_source_data_set_attr(r.vbo_source_data,"a_position",t.positions_cache,_);var n=a.a_tbn.offset;A.vbo_source_data_set_attr(r.vbo_source_data,"a_tbn",t.tbn_cache,n),A.update_gl_buffers(r)}}var P=Object(n.a)(e),A=Object(o.a)(e),S=Object(i.a)(e),p=Object(s.a)(e),v=Object(c.a)(e),m=!0,O=[v.MAIN_OPAQUE,v.MAIN_BLEND,v.MAIN_PLANE_REFLECT,v.MAIN_CUBE_REFLECT,v.MAIN_PLANE_REFLECT_BLEND,v.MAIN_CUBE_REFLECT_BLEND,v.MAIN_GLOW,v.MAIN_XRAY,v.SHADOW_CAST,v.SHADOW_RECEIVE,v.OUTLINE_MASK,v.DEBUG_VIEW,v.COLOR_PICKING,v.COLOR_PICKING_XRAY],N=new Float32Array(3);t.prerender_subs=function(e){if(O.indexOf(e.type)>-1){for(var t=!1,a=e.type==v.MAIN_CUBE_REFLECT||e.type==v.MAIN_CUBE_REFLECT_BLEND,n=e.draw_data,o=0;o<n.length;o++){for(var i=n[o],s=i.bundles,c=!1,l=0;l<s.length;l++){var T=s[l],d=T.batch;if(a)for(var P=0;P<6;P++)e.camera.frustum_planes=e.cube_cam_frustums[P],T.do_render_cube[P]=u(T,e),T.do_render_cube[P]&&(t=!0,c=!0,f(d));else T.do_render=u(T,e),T.do_render&&(t=!0,c=!0,f(d));if(e.need_perm_uniforms_update&&(d.shader.need_uniforms_update=!0),T.do_render){var A=e.camera,S=E.j(A.world_tsr,N),m=_(T,S);T.z_index=m}else T.z_index=1/0}s.length>0&&!s[0].batch.blend&&(r(s),n.z_index=s[0].z_index),i.do_render=c}switch(e.need_perm_uniforms_update=!1,e.type){case v.DEBUG_VIEW:break;default:e.type==v.MAIN_OPAQUE||e.type==v.SHADOW_RECEIVE||e.type==v.MAIN_GLOW||e.type==v.MAIN_PLANE_REFLECT||e.type==v.MAIN_CUBE_REFLECT||t?e.do_render=!0:(e.do_render&&p.clear(e),e.do_render=!1)}}else if(e.need_perm_uniforms_update){for(var n=e.draw_data,o=0;o<n.length;o++)for(var s=n[o].bundles,l=0;l<s.length;l++){var T=s[l],d=T.batch;d.shader.need_uniforms_update=!0}e.need_perm_uniforms_update=!1}e.need_draw_data_sort&&v.sort_draw_data(e)}}var _=r(0),n=r(49),o=r(20),i=r(12),s=r(22),c=r(11),E=r(6),l=r(2),T=r(3),u=Object(_.a)("__prerender",a);t.a=u},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var e,a,_;!function(t){if("object"===typeof exports&&"undefined"!==typeof e)e.exports=t();else if("function"===typeof a&&a.amd)a([],t);else{var r;r="undefined"!==typeof window?window:"undefined"!==typeof self?self:this,r.pako=t()}}(function(){return function e(t,r,a){function n(i,s){if(!r[i]){if(!t[i]){var c="function"==typeof _&&_;if(!s&&c)return c(i,!0);if(o)return o(i,!0);var E=new Error("Cannot find module '"+i+"'");throw E.code="MODULE_NOT_FOUND",E}var l=r[i]={exports:{}};t[i][0].call(l.exports,function(e){var r=t[i][1][e];return n(r||e)},l,l.exports,e,t,r,a)}return r[i].exports}for(var o="function"==typeof _&&_,i=0;i<a.length;i++)n(a[i]);return n}({1:[function(e,t,r){var a="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var _={arraySet:function(e,t,r,a,_){if(t.subarray&&e.subarray)return void e.set(t.subarray(r,r+a),_);for(var n=0;n<a;n++)e[_+n]=t[r+n]},flattenChunks:function(e){var t,r,a,_,n,o;for(a=0,t=0,r=e.length;t<r;t++)a+=e[t].length;for(o=new Uint8Array(a),_=0,t=0,r=e.length;t<r;t++)n=e[t],o.set(n,_),_+=n.length;return o}},n={arraySet:function(e,t,r,a,_){for(var n=0;n<a;n++)e[_+n]=t[r+n]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,_)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,n))},r.setTyped(a)},{}],2:[function(e,t,r){function a(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&n))return String.fromCharCode.apply(null,_.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}var _=e("./common"),n=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var i=new _.Buf8(256),s=0;s<256;s++)i[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;i[254]=i[254]=1,r.string2buf=function(e){var t,r,a,n,o,i=e.length,s=0;for(n=0;n<i;n++)r=e.charCodeAt(n),55296===(64512&r)&&n+1<i&&56320===(64512&(a=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(a-56320),n++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new _.Buf8(s),o=0,n=0;o<s;n++)r=e.charCodeAt(n),55296===(64512&r)&&n+1<i&&56320===(64512&(a=e.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(a-56320),n++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},r.buf2binstring=function(e){return a(e,e.length)},r.binstring2buf=function(e){for(var t=new _.Buf8(e.length),r=0,a=t.length;r<a;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,_,n,o,s=t||e.length,c=new Array(2*s);for(_=0,r=0;r<s;)if((n=e[r++])<128)c[_++]=n;else if((o=i[n])>4)c[_++]=65533,r+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&r<s;)n=n<<6|63&e[r++],o--;o>1?c[_++]=65533:n<65536?c[_++]=n:(n-=65536,c[_++]=55296|n>>10&1023,c[_++]=56320|1023&n)}return a(c,_)},r.utf8border=function(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&128===(192&e[r]);)r--;return r<0?t:0===r?t:r+i[e[r]]>t?r:t}},{"./common":1}],3:[function(e,t,r){function a(e,t,r,a){for(var _=65535&e|0,n=e>>>16&65535|0,o=0;0!==r;){o=r>2e3?2e3:r,r-=o;do{_=_+t[a++]|0,n=n+_|0}while(--o);_%=65521,n%=65521}return _|n<<16|0}t.exports=a},{}],4:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,r){function a(e,t,r,a){var n=_,o=a+r;e^=-1;for(var i=a;i<o;i++)e=e>>>8^n[255&(e^t[i])];return-1^e}var _=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=a},{}],6:[function(e,t,r){function a(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=a},{}],7:[function(e,t,r){t.exports=function(e,t){var r,a,_,n,o,i,s,c,E,l,T,u,d,f,P,A,S,p,v,m,O,N,g,h,R;r=e.state,a=e.next_in,h=e.input,_=a+(e.avail_in-5),n=e.next_out,R=e.output,o=n-(t-e.avail_out),i=n+(e.avail_out-257),s=r.dmax,c=r.wsize,E=r.whave,l=r.wnext,T=r.window,u=r.hold,d=r.bits,f=r.lencode,P=r.distcode,A=(1<<r.lenbits)-1,S=(1<<r.distbits)-1;e:do{d<15&&(u+=h[a++]<<d,d+=8,u+=h[a++]<<d,d+=8),p=f[u&A];t:for(;;){if(v=p>>>24,u>>>=v,d-=v,0===(v=p>>>16&255))R[n++]=65535&p;else{if(!(16&v)){if(0===(64&v)){p=f[(65535&p)+(u&(1<<v)-1)];continue t}if(32&v){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}m=65535&p,v&=15,v&&(d<v&&(u+=h[a++]<<d,d+=8),m+=u&(1<<v)-1,u>>>=v,d-=v),d<15&&(u+=h[a++]<<d,d+=8,u+=h[a++]<<d,d+=8),p=P[u&S];r:for(;;){if(v=p>>>24,u>>>=v,d-=v,!(16&(v=p>>>16&255))){if(0===(64&v)){p=P[(65535&p)+(u&(1<<v)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(O=65535&p,v&=15,d<v&&(u+=h[a++]<<d,(d+=8)<v&&(u+=h[a++]<<d,d+=8)),(O+=u&(1<<v)-1)>s){e.msg="invalid distance too far back",r.mode=30;break e}if(u>>>=v,d-=v,v=n-o,O>v){if((v=O-v)>E&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(N=0,g=T,0===l){if(N+=c-v,v<m){m-=v;do{R[n++]=T[N++]}while(--v);N=n-O,g=R}}else if(l<v){if(N+=c+l-v,(v-=l)<m){m-=v;do{R[n++]=T[N++]}while(--v);if(N=0,l<m){v=l,m-=v;do{R[n++]=T[N++]}while(--v);N=n-O,g=R}}}else if(N+=l-v,v<m){m-=v;do{R[n++]=T[N++]}while(--v);N=n-O,g=R}for(;m>2;)R[n++]=g[N++],R[n++]=g[N++],R[n++]=g[N++],m-=3;m&&(R[n++]=g[N++],m>1&&(R[n++]=g[N++]))}else{N=n-O;do{R[n++]=R[N++],R[n++]=R[N++],R[n++]=R[N++],m-=3}while(m>2);m&&(R[n++]=R[N++],m>1&&(R[n++]=R[N++]))}break}}break}}while(a<_&&n<i);m=d>>3,a-=m,d-=m<<3,u&=(1<<d)-1,e.next_in=a,e.next_out=n,e.avail_in=a<_?_-a+5:5-(a-_),e.avail_out=n<i?i-n+257:257-(n-i),r.hold=u,r.bits=d}},{}],8:[function(e,t,r){function a(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new S.Buf16(320),this.work=new S.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function n(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=D,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new S.Buf32(fe),t.distcode=t.distdyn=new S.Buf32(Pe),t.sane=1,t.back=-1,Y):y}function o(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,n(e)):y}function i(e,t){var r,a;return e&&e.state?(a=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?y:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,o(e))):y}function s(e,t){var r,a;return e?(a=new _,e.state=a,a.window=null,r=i(e,t),r!==Y&&(e.state=null),r):y}function c(e){return s(e,Ae)}function E(e){if(Se){var t;for(P=new S.Buf32(512),A=new S.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(O(g,e.lens,0,288,P,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;O(h,e.lens,0,32,A,0,e.work,{bits:5}),Se=!1}e.lencode=P,e.lenbits=9,e.distcode=A,e.distbits=5}function l(e,t,r,a){var _,n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new S.Buf8(n.wsize)),a>=n.wsize?(S.arraySet(n.window,t,r-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):(_=n.wsize-n.wnext,_>a&&(_=a),S.arraySet(n.window,t,r-a,_,n.wnext),a-=_,a?(S.arraySet(n.window,t,r-a,a,0),n.wnext=a,n.whave=n.wsize):(n.wnext+=_,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=_))),0}function T(e,t){var r,_,n,o,i,s,c,T,u,d,f,P,A,fe,Pe,Ae,Se,pe,ve,me,Oe,Ne,ge,he,Re=0,Ie=new S.Buf8(4),be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return y;r=e.state,r.mode===q&&(r.mode=V),i=e.next_out,n=e.output,c=e.avail_out,o=e.next_in,_=e.input,s=e.avail_in,T=r.hold,u=r.bits,d=s,f=c,Ne=Y;e:for(;;)switch(r.mode){case D:if(0===r.wrap){r.mode=V;break}for(;u<16;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(2&r.wrap&&35615===T){r.check=0,Ie[0]=255&T,Ie[1]=T>>>8&255,r.check=v(r.check,Ie,2,0),T=0,u=0,r.mode=F;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&T)<<8)+(T>>8))%31){e.msg="incorrect header check",r.mode=Te;break}if((15&T)!==C){e.msg="unknown compression method",r.mode=Te;break}if(T>>>=4,u-=4,Oe=8+(15&T),0===r.wbits)r.wbits=Oe;else if(Oe>r.wbits){e.msg="invalid window size",r.mode=Te;break}r.dmax=1<<Oe,e.adler=r.check=1,r.mode=512&T?Q:q,T=0,u=0;break;case F:for(;u<16;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(r.flags=T,(255&r.flags)!==C){e.msg="unknown compression method",r.mode=Te;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=Te;break}r.head&&(r.head.text=T>>8&1),512&r.flags&&(Ie[0]=255&T,Ie[1]=T>>>8&255,r.check=v(r.check,Ie,2,0)),T=0,u=0,r.mode=G;case G:for(;u<32;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}r.head&&(r.head.time=T),512&r.flags&&(Ie[0]=255&T,Ie[1]=T>>>8&255,Ie[2]=T>>>16&255,Ie[3]=T>>>24&255,r.check=v(r.check,Ie,4,0)),T=0,u=0,r.mode=k;case k:for(;u<16;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}r.head&&(r.head.xflags=255&T,r.head.os=T>>8),512&r.flags&&(Ie[0]=255&T,Ie[1]=T>>>8&255,r.check=v(r.check,Ie,2,0)),T=0,u=0,r.mode=K;case K:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}r.length=T,r.head&&(r.head.extra_len=T),512&r.flags&&(Ie[0]=255&T,Ie[1]=T>>>8&255,r.check=v(r.check,Ie,2,0)),T=0,u=0}else r.head&&(r.head.extra=null);r.mode=B;case B:if(1024&r.flags&&(P=r.length,P>s&&(P=s),P&&(r.head&&(Oe=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),S.arraySet(r.head.extra,_,o,P,Oe)),512&r.flags&&(r.check=v(r.check,_,P,o)),s-=P,o+=P,r.length-=P),r.length))break e;r.length=0,r.mode=X;case X:if(2048&r.flags){if(0===s)break e;P=0;do{Oe=_[o+P++],r.head&&Oe&&r.length<65536&&(r.head.name+=String.fromCharCode(Oe))}while(Oe&&P<s);if(512&r.flags&&(r.check=v(r.check,_,P,o)),s-=P,o+=P,Oe)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=j;case j:if(4096&r.flags){if(0===s)break e;P=0;do{Oe=_[o+P++],r.head&&Oe&&r.length<65536&&(r.head.comment+=String.fromCharCode(Oe))}while(Oe&&P<s);if(512&r.flags&&(r.check=v(r.check,_,P,o)),s-=P,o+=P,Oe)break e}else r.head&&(r.head.comment=null);r.mode=H;case H:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(T!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Te;break}T=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=q;break;case Q:for(;u<32;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}e.adler=r.check=a(T),T=0,u=0,r.mode=z;case z:if(0===r.havedict)return e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=s,r.hold=T,r.bits=u,M;e.adler=r.check=1,r.mode=q;case q:if(t===I||t===b)break e;case V:if(r.last){T>>>=7&u,u-=7&u,r.mode=ce;break}for(;u<3;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}switch(r.last=1&T,T>>>=1,u-=1,3&T){case 0:r.mode=W;break;case 1:if(E(r),r.mode=re,t===b){T>>>=2,u-=2;break e}break;case 2:r.mode=$;break;case 3:e.msg="invalid block type",r.mode=Te}T>>>=2,u-=2;break;case W:for(T>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if((65535&T)!==(T>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Te;break}if(r.length=65535&T,T=0,u=0,r.mode=J,t===b)break e;case J:r.mode=Z;case Z:if(P=r.length){if(P>s&&(P=s),P>c&&(P=c),0===P)break e;S.arraySet(n,_,o,P,i),s-=P,o+=P,c-=P,i+=P,r.length-=P;break}r.mode=q;break;case $:for(;u<14;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(r.nlen=257+(31&T),T>>>=5,u-=5,r.ndist=1+(31&T),T>>>=5,u-=5,r.ncode=4+(15&T),T>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Te;break}r.have=0,r.mode=ee;case ee:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}r.lens[be[r.have++]]=7&T,T>>>=3,u-=3}for(;r.have<19;)r.lens[be[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ge={bits:r.lenbits},Ne=O(N,r.lens,0,19,r.lencode,0,r.work,ge),r.lenbits=ge.bits,Ne){e.msg="invalid code lengths set",r.mode=Te;break}r.have=0,r.mode=te;case te:for(;r.have<r.nlen+r.ndist;){for(;Re=r.lencode[T&(1<<r.lenbits)-1],Pe=Re>>>24,Ae=Re>>>16&255,Se=65535&Re,!(Pe<=u);){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(Se<16)T>>>=Pe,u-=Pe,r.lens[r.have++]=Se;else{if(16===Se){for(he=Pe+2;u<he;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(T>>>=Pe,u-=Pe,0===r.have){e.msg="invalid bit length repeat",r.mode=Te;break}Oe=r.lens[r.have-1],P=3+(3&T),T>>>=2,u-=2}else if(17===Se){for(he=Pe+3;u<he;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}T>>>=Pe,u-=Pe,Oe=0,P=3+(7&T),T>>>=3,u-=3}else{for(he=Pe+7;u<he;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}T>>>=Pe,u-=Pe,Oe=0,P=11+(127&T),T>>>=7,u-=7}if(r.have+P>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Te;break}for(;P--;)r.lens[r.have++]=Oe}}if(r.mode===Te)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=Te;break}if(r.lenbits=9,ge={bits:r.lenbits},Ne=O(g,r.lens,0,r.nlen,r.lencode,0,r.work,ge),r.lenbits=ge.bits,Ne){e.msg="invalid literal/lengths set",r.mode=Te;break}if(r.distbits=6,r.distcode=r.distdyn,ge={bits:r.distbits},Ne=O(h,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ge),r.distbits=ge.bits,Ne){e.msg="invalid distances set",r.mode=Te;break}if(r.mode=re,t===b)break e;case re:r.mode=ae;case ae:if(s>=6&&c>=258){e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=s,r.hold=T,r.bits=u,m(e,f),i=e.next_out,n=e.output,c=e.avail_out,o=e.next_in,_=e.input,s=e.avail_in,T=r.hold,u=r.bits,r.mode===q&&(r.back=-1);break}for(r.back=0;Re=r.lencode[T&(1<<r.lenbits)-1],Pe=Re>>>24,Ae=Re>>>16&255,Se=65535&Re,!(Pe<=u);){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(Ae&&0===(240&Ae)){for(pe=Pe,ve=Ae,me=Se;Re=r.lencode[me+((T&(1<<pe+ve)-1)>>pe)],Pe=Re>>>24,Ae=Re>>>16&255,Se=65535&Re,!(pe+Pe<=u);){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}T>>>=pe,u-=pe,r.back+=pe}if(T>>>=Pe,u-=Pe,r.back+=Pe,r.length=Se,0===Ae){r.mode=se;break}if(32&Ae){r.back=-1,r.mode=q;break}if(64&Ae){e.msg="invalid literal/length code",r.mode=Te;break}r.extra=15&Ae,r.mode=_e;case _e:if(r.extra){for(he=r.extra;u<he;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}r.length+=T&(1<<r.extra)-1,T>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=ne;case ne:for(;Re=r.distcode[T&(1<<r.distbits)-1],Pe=Re>>>24,Ae=Re>>>16&255,Se=65535&Re,!(Pe<=u);){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(0===(240&Ae)){for(pe=Pe,ve=Ae,me=Se;Re=r.distcode[me+((T&(1<<pe+ve)-1)>>pe)],Pe=Re>>>24,Ae=Re>>>16&255,Se=65535&Re,!(pe+Pe<=u);){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}T>>>=pe,u-=pe,r.back+=pe}if(T>>>=Pe,u-=Pe,r.back+=Pe,64&Ae){e.msg="invalid distance code",r.mode=Te;break}r.offset=Se,r.extra=15&Ae,r.mode=oe;case oe:if(r.extra){for(he=r.extra;u<he;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}r.offset+=T&(1<<r.extra)-1,T>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Te;break}r.mode=ie;case ie:if(0===c)break e;if(P=f-c,r.offset>P){if((P=r.offset-P)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Te;break}P>r.wnext?(P-=r.wnext,A=r.wsize-P):A=r.wnext-P,P>r.length&&(P=r.length),fe=r.window}else fe=n,A=i-r.offset,P=r.length;P>c&&(P=c),c-=P,r.length-=P;do{n[i++]=fe[A++]}while(--P);0===r.length&&(r.mode=ae);break;case se:if(0===c)break e;n[i++]=r.length,c--,r.mode=ae;break;case ce:if(r.wrap){for(;u<32;){if(0===s)break e;s--,T|=_[o++]<<u,u+=8}if(f-=c,e.total_out+=f,r.total+=f,f&&(e.adler=r.check=r.flags?v(r.check,n,f,i-f):p(r.check,n,f,i-f)),f=c,(r.flags?T:a(T))!==r.check){e.msg="incorrect data check",r.mode=Te;break}T=0,u=0}r.mode=Ee;case Ee:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,T+=_[o++]<<u,u+=8}if(T!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Te;break}T=0,u=0}r.mode=le;case le:Ne=L;break e;case Te:Ne=x;break e;case ue:return U;case de:default:return y}return e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=s,r.hold=T,r.bits=u,(r.wsize||f!==e.avail_out&&r.mode<Te&&(r.mode<ce||t!==R))&&l(e,e.output,e.next_out,f-e.avail_out)?(r.mode=ue,U):(d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,r.total+=f,r.wrap&&f&&(e.adler=r.check=r.flags?v(r.check,n,f,e.next_out-f):p(r.check,n,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===q?128:0)+(r.mode===re||r.mode===J?256:0),(0===d&&0===f||t===R)&&Ne===Y&&(Ne=w),Ne)}function u(e){if(!e||!e.state)return y;var t=e.state;return t.window&&(t.window=null),e.state=null,Y}function d(e,t){var r;return e&&e.state?(r=e.state,0===(2&r.wrap)?y:(r.head=t,t.done=!1,Y)):y}function f(e,t){var r,a,_=t.length;return e&&e.state?(r=e.state,0!==r.wrap&&r.mode!==z?y:r.mode===z&&(a=1,(a=p(a,t,_,0))!==r.check)?x:l(e,t,_,_)?(r.mode=ue,U):(r.havedict=1,Y)):y}var P,A,S=e("../utils/common"),p=e("./adler32"),v=e("./crc32"),m=e("./inffast"),O=e("./inftrees"),N=0,g=1,h=2,R=4,I=5,b=6,Y=0,L=1,M=2,y=-2,x=-3,U=-4,w=-5,C=8,D=1,F=2,G=3,k=4,K=5,B=6,X=7,j=8,H=9,Q=10,z=11,q=12,V=13,W=14,J=15,Z=16,$=17,ee=18,te=19,re=20,ae=21,_e=22,ne=23,oe=24,ie=25,se=26,ce=27,Ee=28,le=29,Te=30,ue=31,de=32,fe=852,Pe=592,Ae=15,Se=!0;r.inflateReset=o,r.inflateReset2=i,r.inflateResetKeep=n,r.inflateInit=c,r.inflateInit2=s,r.inflate=T,r.inflateEnd=u,r.inflateGetHeader=d,r.inflateSetDictionary=f,r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,r){var a=e("../utils/common"),_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],i=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,s,c,E,l,T){var u,d,f,P,A,S,p,v,m,O=T.bits,N=0,g=0,h=0,R=0,I=0,b=0,Y=0,L=0,M=0,y=0,x=null,U=0,w=new a.Buf16(16),C=new a.Buf16(16),D=null,F=0;for(N=0;N<=15;N++)w[N]=0;for(g=0;g<s;g++)w[t[r+g]]++;for(I=O,R=15;R>=1&&0===w[R];R--);if(I>R&&(I=R),0===R)return c[E++]=20971520,c[E++]=20971520,T.bits=1,0;for(h=1;h<R&&0===w[h];h++);for(I<h&&(I=h),L=1,N=1;N<=15;N++)if(L<<=1,(L-=w[N])<0)return-1;if(L>0&&(0===e||1!==R))return-1;for(C[1]=0,N=1;N<15;N++)C[N+1]=C[N]+w[N];for(g=0;g<s;g++)0!==t[r+g]&&(l[C[t[r+g]]++]=g);if(0===e?(x=D=l,S=19):1===e?(x=_,U-=257,D=n,F-=257,S=256):(x=o,D=i,S=-1),y=0,g=0,N=h,A=E,b=I,Y=0,f=-1,M=1<<I,P=M-1,1===e&&M>852||2===e&&M>592)return 1;for(;;){p=N-Y,l[g]<S?(v=0,m=l[g]):l[g]>S?(v=D[F+l[g]],m=x[U+l[g]]):(v=96,m=0),u=1<<N-Y,d=1<<b,h=d;do{d-=u,c[A+(y>>Y)+d]=p<<24|v<<16|m|0}while(0!==d);for(u=1<<N-1;y&u;)u>>=1;if(0!==u?(y&=u-1,y+=u):y=0,g++,0===--w[N]){if(N===R)break;N=t[r+l[g]]}if(N>I&&(y&P)!==f){for(0===Y&&(Y=I),A+=h,b=N-Y,L=1<<b;b+Y<R&&!((L-=w[b+Y])<=0);)b++,L<<=1;if(M+=1<<b,1===e&&M>852||2===e&&M>592)return 1;f=y&P,c[f]=I<<24|b<<16|A-E|0}}return 0!==y&&(c[A+y]=N-Y<<24|64<<16|0),T.bits=I,0}},{"../utils/common":1}],10:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,r){function a(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=a},{}],"/lib/inflate.js":[function(e,t,r){function a(e){if(!(this instanceof a))return new a(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=o.inflateInit2(this.strm,t.windowBits);if(r!==c.Z_OK)throw new Error(E[r]);this.header=new T,o.inflateGetHeader(this.strm,this.header)}function _(e,t){var r=new a(t);if(r.push(e,!0),r.err)throw r.msg||E[r.err];return r.result}function n(e,t){return t=t||{},t.raw=!0,_(e,t)}var o=e("./zlib/inflate"),i=e("./utils/common"),s=e("./utils/strings"),c=e("./zlib/constants"),E=e("./zlib/messages"),l=e("./zlib/zstream"),T=e("./zlib/gzheader"),u=Object.prototype.toString;a.prototype.push=function(e,t){var r,a,_,n,E,l,T=this.strm,d=this.options.chunkSize,f=this.options.dictionary,P=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?c.Z_FINISH:c.Z_NO_FLUSH,"string"===typeof e?T.input=s.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?T.input=new Uint8Array(e):T.input=e,T.next_in=0,T.avail_in=T.input.length;do{if(0===T.avail_out&&(T.output=new i.Buf8(d),T.next_out=0,T.avail_out=d),r=o.inflate(T,c.Z_NO_FLUSH),r===c.Z_NEED_DICT&&f&&(l="string"===typeof f?s.string2buf(f):"[object ArrayBuffer]"===u.call(f)?new Uint8Array(f):f,r=o.inflateSetDictionary(this.strm,l)),r===c.Z_BUF_ERROR&&!0===P&&(r=c.Z_OK,P=!1),r!==c.Z_STREAM_END&&r!==c.Z_OK)return this.onEnd(r),this.ended=!0,!1;T.next_out&&(0!==T.avail_out&&r!==c.Z_STREAM_END&&(0!==T.avail_in||a!==c.Z_FINISH&&a!==c.Z_SYNC_FLUSH)||("string"===this.options.to?(_=s.utf8border(T.output,T.next_out),n=T.next_out-_,E=s.buf2string(T.output,_),T.next_out=n,T.avail_out=d-n,n&&i.arraySet(T.output,T.output,_,n,0),this.onData(E)):this.onData(i.shrinkBuf(T.output,T.next_out)))),0===T.avail_in&&0===T.avail_out&&(P=!0)}while((T.avail_in>0||0===T.avail_out)&&r!==c.Z_STREAM_END);return r===c.Z_STREAM_END&&(a=c.Z_FINISH),a===c.Z_FINISH?(r=o.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c.Z_OK):a!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),T.avail_out=0,!0)},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===c.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=a,r.inflate=_,r.inflateRaw=n,r.ungzip=_},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")});var n=window.pako.inflate},function(e,t,r){"use strict";r(35).a.module.shader_texts=function(e,t){e["anchors.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";","}"]}]},e["anchors.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANCHOR_NUM",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec3","u_position","[","ANCHOR_NUM","]",";","uniform","mat4","u_view_proj_matrix",";","uniform","vec2","u_texel_size",";","GLSL_IN","float","a_index",";","void","main","(",")","{","int","c","=","int","(","mod","(","a_index",",","3.0",")",")",";","int","d","=","int","(","a_index","/","3.0",")",";","vec2","e",";","if","(","c","==","0",")","{","e","=","vec2","(","-","4.0","*","u_texel_size","[","0","]",",","-","u_texel_size","[","1","]",")",";","}","else","if","(","c","==","1",")","{","e","=","vec2","(","4.0","*","u_texel_size","[","0","]",",","-","u_texel_size","[","1","]",")",";","}","else","{","e","=","vec2","(","0.0",",","5.0","*","u_texel_size","[","1","]",")",";","}","vec4","f","=","u_view_proj_matrix","*","vec4","(","u_position","[","d","]",",","1.0",")",";","f",".","xy","+=","e","*","f",".","w",";","gl_Position","=","f",";","}"]}]},e["color_id.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_OUTLINE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";","uniform","float","u_alpha_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_color_id",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";","uniform","sampler2D","u_shadow_mask",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_outline_intensity",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec4","i",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";","GLSL_IN","vec4","o",";","GLSL_IN","vec4","u",";","GLSL_IN","vec4","v",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","float","L","=","I",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","(","GLSL_TEXTURE","(","u_sampler",",","A",")",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","M","=","u_alpha_factor","*","L",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","L","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","u_outline_intensity",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","u_color_id",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["color_id.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec4","i",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:6},{TYPE:"logical_and_expr",PLACES:3},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:7}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","U","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";","vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","_","(","u_model_tsr",",","U",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","aq",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","mat4","(","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","T","(","a_tbn",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","ay",",","mat4","(","0.0",")",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]},{TYPE:"txt",TOKENS:["i","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","i",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","i",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","}"]}]},e["debug_view.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIREFRAME_QUALITY",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_SPHERE_DYNAMIC",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_debug_view_mode",";","uniform","float","u_cluster_id",";","uniform","float","u_batch_debug_id_color",";","uniform","float","u_batch_debug_main_render_time",";","uniform","float","u_debug_colors_seed",";","uniform","float","u_debug_render_time_threshold",";","uniform","vec3","u_wireframe_edge_color",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","aD",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","const","float","aE","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE_DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aF","=","vec3","(","1.0",",","0.05",",","0.05",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aF","=","vec3","(","0.05",",","0.05",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aG","=","vec3","(","0.4",",","0.4",",","1.0",")",";","const","vec3","aH","=","vec3","(","1.0",",","0.4",",","0.4",")",";","const","vec3","aI","=","vec3","(","1.0",",","1.0",",","1.0",")",";","const","vec3","aJ","=","vec3","(","0.0",",","133.0","/","255.0",",","66.0","/","255.0",")",";","const","vec3","aK","=","vec3","(","160.0","/","255.0",",","38.0","/","255.0",",","33.0","/","255.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aP","(",")","{","float","aL","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIREFRAME_QUALITY",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","aL","=","0.0",";"]}]}},{TYPE:"elif",EXPRESSION:["WIREFRAME_QUALITY",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"txt",TOKENS:["vec3","aN","=","fwidth","(","aD",")",";","vec3","aO","=","smoothstep","(","vec3","(","0.0",")",",","aN","*","aE",",","aD",")",";","aL","=","min","(","min","(","aO",".","x",",","aO",".","y",")",",","aO",".","z",")",";","aL","=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aL",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","aQ","=","vec3","(","0.0",")",";","float","L","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","{","aQ","=","aF",";","L","=","1.0",";","}","else","discard",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_debug_view_mode","==","DV_OPAQUE_WIREFRAME",")","{","float","aL","=","aP","(",")",";","aQ","=","vec3","(","mix","(","u_wireframe_edge_color",",","aI",",","aL",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_TRANSPARENT_WIREFRAME",")","{","float","aL","=","aP","(",")",";","aQ","=","u_wireframe_edge_color",";","L","=","mix","(","1.0",",","0.0",",","aL",")",";","}","else","if","(","u_debug_view_mode","==","DV_FRONT_BACK_VIEW",")","{","float","aL","=","aP","(",")",";","if","(","gl_FrontFacing",")","aQ","=","mix","(","u_wireframe_edge_color",",","aG",",","aL",")",";","else","aQ","=","mix","(","u_wireframe_edge_color",",","aH",",","aL",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_CLUSTERS_VIEW",")","{","float","aR","=","u_cluster_id","+","u_debug_colors_seed","+","2.0",";","aQ","=","vec3","(","fract","(","aR","*","19.73",")",",","fract","(","aR","*","6.34",")",",","fract","(","aR","*","1.56",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_BATCHES_VIEW",")","{","float","aR","=","u_batch_debug_id_color","+","u_debug_colors_seed",";","aQ","=","vec3","(","fract","(","aR","*","19.73",")",",","fract","(","aR","*","6.34",")",",","fract","(","aR","*","1.56",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_RENDER_TIME",")","{","float","aS",";","if","(","u_debug_render_time_threshold",">","0.0",")","aS","=","clamp","(","u_batch_debug_main_render_time",",","0.0",",","u_debug_render_time_threshold",")","/","u_debug_render_time_threshold",";","else","aS","=","1.0",";","float","aT","=","clamp","(","2.0","*","aS",",","0.0",",","1.0",")",";","float","aU","=","clamp","(","2.0","*","aS","-","1.0",",","0.0",",","1.0",")",";","float","aV","=","aS",";","aQ","=","mix","(","aJ",",","aK",",","vec3","(","aT",",","aU",",","aV",")",")",";","L","=","1.0",";","}"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["debug_view.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_VIEW_SPECIAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";","GLSL_IN","float","a_polyindex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"include",FILE:"dynamic_grass.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","if","(","a_polyindex","==","0.0",")","aD","=","vec3","(","1.0",",","0.0",",","0.0",")",";","else","if","(","a_polyindex","==","1.0",")","aD","=","vec3","(","0.0",",","0.0",",","1.0",")",";","else","aD","=","vec3","(","0.0",",","1.0",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_VIEW_SPECIAL_SKYDOME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gl_Position","=","vec4","(","a_position",".","xy",",","0.9999999",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","aZ","(","a_part_ts",".","xyz",",","aY","(",")",")",";","Z","=","a_","(","vec3","(","a_part_ts",".","w",")",",","Z",")",";","Z","=","bc","(","a_part_r",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","bd","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";","vec4","S","=","R","(","a_tbn",")",";","vec3","U","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";","an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","be","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bf","=","aq",";","Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","bf",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","mat4","(","0.0",")",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["error.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","0.0",",","1.0",",","1.0",")",";","}"]}]},e["error.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","void","main","(",")","{","gl_Position","=","u_proj_matrix","*","bh","(","u_view_tsr",")","*","vec4","(","a_position",",","1.0",")",";","}"]}]},e["grass_map.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bi",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bi",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","bi",",","vec3","(","1.0",")",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","bi",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["grass_map.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_grass_size",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bi",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bi",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","float","u_time",";","uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","vec3","(","0.0",")",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","u_model_tsr",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","vec4","(","a_grass_size",",","a_grass_color",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","a_grass_size",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","a_grass_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["halo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec3","u_halo_rings_color",";","uniform","vec3","u_halo_lines_color",";","uniform","float","u_halo_hardness",";","uniform","float","u_halo_size",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_halo_stars_blend",";","uniform","float","u_halo_stars_height",";","uniform","float","u_cam_water_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bj",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_IN","float","bk",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"halo_color.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","bm","=","bl","(",")",";","vec3","aQ","=","bm",".","rgb",";","float","aM","=","bm",".","a",";","aW","(","aQ",")",";","aX","(","aQ",",","aM",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","aM",")",";","}"]}]},e["halo.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","PRECISION","float","u_halo_size",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec2","a_halo_bb_vertex",";","GLSL_IN","float","a_random_vals",";","GLSL_OUT","vec2","A",";","GLSL_OUT","float","bk",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","bj",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";","vec3","O","=","ap","(","Z",",","a_position",")",";","A","=","a_halo_bb_vertex","*","2.0","-","1.0",";","bk","=","a_random_vals",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bo","=","bn","(","O",",","N",")",";","mat3","bp","=","N",";","bp","[","0","]","[","0","]","=","0.0",";","bp","[","0","]","[","1","]","=","0.0",";","bp","[","0","]","[","2","]","=","0.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bo","=","bn","(","O",",","N",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","bq","=","(","a_halo_bb_vertex","*","2.0","-","1.0",")","*","u_halo_size",";","vec3","bs","=","vec3","(","bq","[","0","]",",","0.0",",","bq","[","1","]",")",";","vec3","bt","=","ap","(","bo",",","bs",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","bp",",","bt",")",",","1.0",")",";","f",".","z","=","0.99999","*","f",".","w",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bj","=","vec4","(","bt",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","N",",","bt",")",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["irradiance_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bu",";","void","main","(",")","{","vec3","bv","=","normalize","(","bu",")",";","vec3","bw",";","vec3","bx","=","vec3","(","0.0",")",";","vec3","by","=","vec3","(","0.0",",","0.0",",","1.0",")",";","vec3","bz","=","vec3","(","1.0",",","0.0",",","0.0",")",";","const","float","bA","=","0.025",";","float","bB","=","0.0",";","for","(","float","bC","=","0.0",";","bC","<","2.0","*","M_PI",";","bC","+=","bA",")","{","for","(","float","bD","=","0.0",";","bD","<","0.5","*","M_PI",";","bD","+=","bA",")","{","vec3","bE","=","vec3","(","sin","(","bD",")","*","cos","(","bC",")",",","sin","(","bD",")","*","sin","(","bC",")",",","cos","(","bD",")",")",";","vec3","bF","=","bE",".","x","*","bz","+","bE",".","y","*","by","+","bE",".","z","*","bv",";","vec3","bw","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","bF",")",".","rgb",";","bG","(","bw",")",";","bx","+=","bw","*","cos","(","bD",")","*","sin","(","bD",")",";","bB","++",";","}","}","bx","=","M_PI","*","bx","*","(","1.0","/","float","(","bB",")",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bx",",","1.0",")",";","}"]}]},e["lens_flares.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","GLSL_TEXTURE","(","u_sampler",",","A",")",";","aW","(","aQ",".","rgb",")",";","aX","(","aQ",".","rgb",",","aQ",".","a",")",";","GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["lens_flares.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"define",NAME:"LIGHT_INDEX",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","GLSL_IN","float","a_lf_dist",";","GLSL_IN","vec2","a_lf_bb_vertex",";","GLSL_IN","vec2","a_texcoord",";","GLSL_OUT","vec2","A",";","void","main","(",")","{","A","=","a_texcoord",";","vec3","bH","=","normalize","(","u_light_directions","[","LIGHT_INDEX","]",")",";","vec4","f","=","u_proj_matrix","*","vec4","(","bI","(","u_view_tsr",",","bH",")",",","0.0",")",";","f",".","x","/=","f",".","w",";","f",".","y","/=","f",".","w",";","f","+=","99999.0","*","step","(","f",".","z",",","0.0",")",";","f","+=","100.0","*","(","step","(","1.0",",","abs","(","f",".","x",")",")","+","step","(","1.0",",","abs","(","f",".","y",")",")",")",";","f",".","x","=","a_lf_dist","*","f",".","x",";","f",".","y","=","a_lf_dist","*","f",".","y",";","float","bJ","=","u_proj_matrix","[","1","]","[","1","]","/","u_proj_matrix","[","0","]","[","0","]",";","vec2","bK","=","vec2","(","a_lf_bb_vertex",".","x","/","bJ",",","a_lf_bb_vertex",".","y",")",";","if","(","a_lf_dist","<","0.999",")","{","const","float","bL","=","1.9",";","bK","*=","(","1.0","+","bL","*","length","(","f",".","xy",")",")",";","}","gl_Position","=","vec4","(","f",".","xy","+","bK",",","0.999999",",","1.0",")",";","}"]}]},e["line.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec3","aQ","=","u_diffuse_color",".","xyz",";","float","L","=","u_diffuse_color",".","a",";","aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["line.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec3","a_direction",";","uniform","mat3","u_model_tsr",";","uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","float","u_height",";","uniform","float","u_line_width",";","void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";","au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","normalize","(","a_direction",")",",","Z",")",";","vec4","bM","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","bM",".","xyz","/=","bM",".","w",";","vec4","bN","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O","+","aw",".","U",")",",","1.0",")",";","bN",".","xyz","/=","bN",".","w",";","float","bJ","=","u_proj_matrix","[","1","]","[","1","]","/","u_proj_matrix","[","0","]","[","0","]",";","vec2","bO","=","(","bN","-","bM",")",".","xy",";","bO",".","x","*=","bJ",";","float","bP","=","M_PI","/","2.0",";","mat2","bQ","=","mat2","(","cos","(","bP",")",",","sin","(","bP",")",",","-","sin","(","bP",")",",","cos","(","bP",")",")",";","bO","=","bQ","*","bO",";","bO","=","normalize","(","bO",")",";","vec2","bR","=","(","u_line_width","/","u_height",")","*","vec2","(","1.0","/","bJ",",","1.0",")",";","gl_Position","=","vec4","(","bM",".","xy","+","bO",".","xy","*","bR","/","2.0",",","bM",".","z",",","1.0",")",";","gl_Position","*=","bM",".","w",";","}"]}]},e["main.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_PROJ_MATRIX_FRAG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS","USE_REFRACTION_CORRECTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","vec2","u_texel_size",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_BSDF_SKY_DIM",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_bsdf_cube_sky_dim",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sun_quaternion",";","uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_PROJ_MATRIX_FRAG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_proj_matrix_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_irradiance",";","uniform","samplerCube","u_cube_r_convolution",";","uniform","sampler2D","u_brdf",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_NODE_BSDF_PRINCIPLED",{TYPE:"logical_or_expr",PLACES:2},"USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",0,{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","i",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z","-","WATER_LEVEL",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","vec3","aQ","=","E",";","float","L","=","I",";","vec3","U","=","G",";","vec4","bU","=","H",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","max","(","aQ","-","sqrt","(","0.01","*","-","min","(","bT",",","0.0",")",")",",","0.5","*","aQ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bV","(","aQ",",","bT",",","u_time",",","bU",",","U",",","u_sun_direction",",","u_sun_intensity",",","u_sun_quaternion",",","h",",","bS",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","min","(","1.0",",","L",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","bT",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bX","=","GLSL_TEXTURE_PROJ","(","u_shadow_mask",",","l",")",".","a",";","aQ","=","vec3","(","bX",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","=","max","(","vec3","(","0.0",")",",","aQ",")",";","aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["main.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bZ",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_v_light_tsr","[","NUM_CAST_LAMPS","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_v_light_ts","[","NUM_CAST_LAMPS","]",";","uniform","vec4","u_v_light_r","[","NUM_CAST_LAMPS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","mat4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","aZ","(","a_part_ts",".","xyz",",","aY","(",")",")",";","Z","=","a_","(","vec3","(","a_part_ts",".","w",")",",","Z",")",";","Z","=","bc","(","a_part_r",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","bd","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:14}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","ca","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"elif",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cb","=","ap","(","Z",",","O",")",";","vec3","ac","=","normalize","(","bI","(","Z",",","ca",")",")",";","vec3","D","=","cb","-","u_camera_eye",";","vec3","W","=","cross","(","D",",","ac",")",";","vec3","V","=","cross","(","ac",",","W",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","bI","(","Z",",","ca",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:10}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","be","(","O",",","V",",","ae",",","W",",","U",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","(","b_","*","vec4","(","O",",","1.0",")",")",".","xyz",";","ao","=","(","b_","*","vec4","(","ao",",","1.0",")",")",".","xyz",";","aq","=","(","b_","*","vec4","(","aq",",","1.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bf","=","aq",";","Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","bf",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","b_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bY","=","u_camera_eye","-","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bZ","=","aw",".","aQ",";"]}]}},{TYPE:"elif",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bZ","=","a_color",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cc","=","b_","*","vec4","(","aw",".","O",",","1.0",")",";","cc",".","xyz","=","ap","(","N",",","cc",".","xyz",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cc","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cd","(","aw",".","O",",","aw",".","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","cc",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["main_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_SPEC_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR0_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_COLOR1_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_PLANE"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_SPEC",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_AS_SPEC",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX_LOD_DIST",TOKENS:["5.0"]},{TYPE:"var",NAME:"PARALLAX_STEPS",TOKENS:["5.0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sun_quaternion",";","uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC","ALPHA_AS_SPEC",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_specmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap1",";","uniform","sampler2D","u_stencil0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";","uniform","float","u_specular_alpha",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_diffuse_color_factor",";","uniform","float","u_alpha_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_specular_color_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_parallax_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"lighting_nodes.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","i",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z","-","WATER_LEVEL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cf","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["cf","=","cf",";","else","cf","=","-","cf",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","cf",",","k",".","xyz",")","*","k",".","w",";","mat3","cg","=","mat3","(","k",".","xyz",",","W",",","cf",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ch","=","normalize","(","bI","(","N",",","j",")",")",".","st",";","ch","=","ch","*","vec2","(","0.495",")","+","vec2","(","0.5",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","bS","<","PARALLAX_LOD_DIST",")","{","float","ci","=","clamp","(","0.5","*","(","PARALLAX_LOD_DIST","-","bS",")",",","0.0",",","1.0",")",";","float","cj","=","u_parallax_scale","*","ci",";","vec3","ck","=","normalize","(","bY","*","cg",")",";","float","cl","=","1.0","/","PARALLAX_STEPS",";","vec2","cm","=","ck",".","xy","*","cj","/","(","PARALLAX_STEPS","*","ck",".","z",")",";","float","cn","=","1.0",";","float","co",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cp","=","ch",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cp","=","ce",";"]}]}}]},{TYPE:"txt",TOKENS:["co","=","GLSL_TEXTURE","(","u_normalmap0",",","cp",")",".","a",";","for","(","float","cq","=","1.0",";","cq","<=","PARALLAX_STEPS",";","cq","++",")","{","if","(","co","<","cn",")","{","cn","-=","cl",";","cp","-=","cm",";","co","=","GLSL_TEXTURE","(","u_normalmap0",",","cp",")",".","a",";","}","}","vec2","cr","=","cp","+","cm",";","float","cs","=","GLSL_TEXTURE","(","u_normalmap0",",","cr",")",".","a","-","(","cn","+","cl",")",";","float","ct","=","co","-","cn",";","float","cu","=","ct","/","(","ct","-","cs",")",";","cp","=","cu","*","cr","+","(","1.0","-","cu",")","*","cp",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ce","+=","cp","-","ch",";"]}]}}]},{TYPE:"txt",TOKENS:["ch","=","cp",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ch","+=","cp","-","ce",";"]}]}}]},{TYPE:"txt",TOKENS:["ce","=","cp",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cv",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cv","=","GLSL_TEXTURE","(","u_normalmap0",",","ch",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cv","=","GLSL_TEXTURE","(","u_normalmap0",",","ce",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cw","=","cv",".","rgb","-","0.5",";","cw","=","mix","(","vec3","(","0.0",",","0.0",",","1.0",")",",","cw",",","u_normal_factor",")",";","vec3","U","=","cg","*","cw",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","cf",";"]}]}}]},{TYPE:"txt",TOKENS:["U","=","normalize","(","U",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ch","=","normalize","(","bI","(","N",",","U",")",")",".","st",";","ch","=","ch","*","vec2","(","0.495",")","+","vec2","(","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bY",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cx","=","bZ",";","bG","(","cx",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cy","=","vec4","(","cx",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cy","=","u_diffuse_color",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cz","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cA","=","GLSL_TEXTURE","(","u_colormap0",",","ch",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cA","=","GLSL_TEXTURE","(","u_colormap0",",","ce",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bG","(","cA",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cB",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cB","=","GLSL_TEXTURE","(","u_colormap1",",","ch",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cB","=","GLSL_TEXTURE","(","u_colormap1",",","ce",")",";"]}]}}]},{TYPE:"txt",TOKENS:["bG","(","cB",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cC","=","GLSL_TEXTURE","(","u_stencil0",",","ch",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cC","=","GLSL_TEXTURE","(","u_stencil0",",","ce",")",";"]}]}}]},{TYPE:"txt",TOKENS:["cA","=","mix","(","cA",",","cB",",","cC",".","r",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","=","mix","(","cy",".","rgb",",","cA",".","rgb",",","u_diffuse_color_factor",")",";","float","M","=","u_alpha_factor","*","cA",".","a",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","cy",".","a","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";","cz","=","cA",".","a",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","*=","mix","(","vec3","(","1.0",")",",","cA",".","rgb",",","u_diffuse_color_factor",")",";","cy",".","a","=","cA",".","a",";","cz","=","cA",".","a",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aQ","=","cy",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cD","=","u_diffuse_intensity","*","cy",".","rgb",";","vec3","cF","=","u_environment_energy","*","cE","(","U",")",";","vec3","cG","=","u_ambient","*","cF",";","vec4","bU","=","cH","(","cD",")",";","vec3","cI","=","u_emit","*","cy",".","rgb",";","vec3","cJ","=","u_specular_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_AS_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cK","=","vec3","(","cz",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cK","=","GLSL_TEXTURE","(","u_specmap0",",","ch",")",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cK","=","GLSL_TEXTURE","(","u_specmap0",",","ce",")",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["bG","(","cK",".","rgb",")",";","cJ","=","mix","(","cJ",",","cK",",","u_specular_color_factor",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cL","=","u_specular_params","[","0","]",";","vec2","cM","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cN","=","cL","*","cJ",";","vec3","aQ",";","vec3","cO",";","cP","(","cI",",","cG",",","cD",",","cN",",","h",",","U",",","D",",","cM",",","u_diffuse_params",",","bU",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cO",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cQ","(","aQ",",","D",",","U",",","u_reflect_factor",",","N",")",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cQ","(","aQ",",","D",",","U",",","u_reflect_factor",",","mat3","(","0.0",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cQ","(","aQ",",","D",",","U",",","u_mirror_factor",",","mat3","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","+=","cO",";"]}]}}]},{TYPE:"txt",TOKENS:["float","L","=","cy",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","max","(","aQ","-","sqrt","(","0.01","*","-","min","(","bT",",","0.0",")",")",",","0.5","*","aQ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bV","(","aQ",",","bT",",","u_time",",","bU",",","U",",","u_sun_direction",",","u_sun_intensity",",","u_sun_quaternion",",","h",",","bS",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","cO",".","r",",","cO",".","g",")",",","cO",".","b",")","*","u_specular_alpha",";","L","=","cy",".","a","*","(","1.0","-","t",")","+","t",";"]}]}}]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cR","=","-","(","bI","(","N",",","U",")",")",".","xy",";","aQ","=","mix","(","cS","(","l",",","cR","*","u_refr_bump",")",",","aQ",",","L",")",";","L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","bT",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bX","=","GLSL_TEXTURE_PROJ","(","u_shadow_mask",",","l",")",".","a",";","aQ","=","vec3","(","bX",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["node_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bu",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_GEOMETRY_NO","USE_NODE_GEOMETRY_GL","USE_NODE_GEOMETRY_IN","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB","USE_NODE_TEX_COORD_NO","USE_NODE_B4W_REFLECT_WORLD",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","-","normalize","(","bu",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","E","=","max","(","vec3","(","0.0",")",",","E",")",";","aW","(","E",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","E",",","_1_0",")",";","}"]}]},e["particle_system.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","float","u_time",";","uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";","uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:7}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","j",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"particles_nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","vec3","aQ","=","E",";","float","L","=","I",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","min","(","1.0",",","L",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","length","(","i",")",",","D",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cT","=","-","i",".","z","/","u_view_max_depth",";","vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cW","=","cV","(","cU",")",";","float","cX","=","cW","-","cT",";","float","cY","=","u_view_max_depth","/","SOFT_STRENGTH","*","cX",";","L","=","L","*","min","(","cY",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["particle_system.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";","GLSL_IN","vec3","a_p_data",";","GLSL_IN","vec4","a_p_vels",";","GLSL_IN","vec2","a_p_bb_vertex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","cZ",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bk",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_p_color_ramp","[","COLOR_RAMP_LENGTH","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_p_time",";","uniform","float","u_p_length",";","uniform","int","u_p_cyclic",";","uniform","float","u_p_fade_in",";","uniform","float","u_p_fade_out",";","uniform","float","u_p_nfactor",";","uniform","float","u_p_gravity",";","uniform","float","u_p_mass",";","uniform","float","u_p_wind_fac",";","uniform","float","u_p_max_lifetime",";","uniform","float","u_p_tilt",";","uniform","float","u_p_tilt_rand",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_wind",";","uniform","float","u_p_size",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE",{TYPE:"logic_negative_expr",PLACES:1},"NODES","HALO_PARTICLES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"particles.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"particles_nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["float","db","(","vec2","c_",",","vec2","da",")","{","return","(","atan","(","da",".","y",",","da",".","x",")","-","atan","(","c_",".","y",",","c_",".","x",")",")",";","}","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","mat4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";","dc","pp",";","pp","=","dd","(",")",";","float","de",";","mat3","bo","=","aY","(",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","df","=","(","b_","*","vec4","(","pp",".","O",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","df","=","pp",".","O",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",",","-","1.0",",","0.0",")",";","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_VIEW",")","{","de","=","pp",".","bP",";","bo","=","bn","(","df",",","N",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_XY",")","{","de","=","db","(","vec2","(","EPSILON",",","1.0",")",",","vec2","(","U",".","x",",","-","U",".","y",")",")","+","pp",".","bP",";","bo","=","aZ","(","df",",","bo",")",";","vec4","dg","=","X","(","RIGHT_VECTOR",",","-","M_PI","/","2.0",")",";","bo","=","bc","(","dg",",","bo",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_YZ",")","{","de","=","pp",".","bP",";","bo","=","aZ","(","df",",","bo",")",";","vec4","dh","=","X","(","UP_VECTOR",",","M_PI","/","2.0",")",";","bo","=","bc","(","dh",",","bo",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_ZX",")","{","de","=","pp",".","bP",";","bo","=","aZ","(","df",",","bo",")",";","}","vec3","bs","=","vec3","(","(","a_p_bb_vertex","[","0","]","*","2.0","-","1.0",")","*","pp",".","di","*","u_p_size",",","0.0",",","(","a_p_bb_vertex","[","1","]","*","2.0","-","1.0",")","*","pp",".","di","*","u_p_size",")",";","float","dj","=","a_p_data","[","2","]",";","float","dk","=","u_p_tilt","*","u_p_tilt_rand","*","(","2.0","*","dj","-","1.0",")",";","float","dl","=","(","dk","+","u_p_tilt",")","*","M_PI",";","vec4","dm","=","X","(","TOWARD_VECTOR",",","dl","+","de",")",";","vec3","bt","=","ap","(","bo",",","T","(","dm",",","bs",")",")",";","vec4","cc","=","vec4","(","ap","(","N",",","bt",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bk","=","dj",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","dn","=","aY","(",")",";","dm","=","X","(","TOWARD_VECTOR",",","de",")",";","dn","=","bc","(","dm",",","dn",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},"USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","W","=","vec3","(","0.0",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","V",",","vec3","(","0.0",")",",","W",",","U",",","bd","(","bo",",","dn",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(","pp",".","O",",","pp",".","dp",",","pp",".","dq",",","pp",".","dr",",","pp",".","di",",","a_p_bb_vertex",",","a_p_data","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","U",",","bd","(","bo",",","dn",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_p_bb_vertex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_p_bb_vertex","*","2.0","-","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cZ","=","pp",".","L",";"]}]}}]},{TYPE:"txt",TOKENS:["bZ","=","pp",".","aQ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","h","=","bt",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bY","=","u_camera_eye","-","bt",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["particle_system_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";","uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_halo_size",";","uniform","vec3","u_halo_rings_color",";","uniform","float","u_halo_hardness",";","uniform","vec3","u_halo_lines_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";","uniform","float","u_halo_stars_blend",";","uniform","float","u_halo_stars_height",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_p_alpha_start",";","uniform","float","u_p_alpha_end",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";","uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","cZ",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bk",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bj",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","j",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"halo_color.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bY",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","bm","=","bl","(",")",";","vec3","aQ","=","bm",".","rgb","*","bZ",";","float","ds","=","0.9","*","length","(","A",")",";","float","dt","=","smoothstep","(","u_p_alpha_start",",","u_p_alpha_end",",","ds",")",";","float","L","=","bm",".","a","*","(","1.0","-","dt",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cy","=","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cA","=","GLSL_TEXTURE","(","u_sampler",",","A",")",";","bG","(","cA",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","=","mix","(","cy",".","rgb",",","cA",".","rgb",",","u_diffuse_color_factor",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","*=","mix","(","vec3","(","1.0",")",",","cA",".","rgb",",","u_diffuse_color_factor",")",";"]}]}}]},{TYPE:"txt",TOKENS:["cy",".","a","=","cA",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["cy",".","rgb","*=","bZ",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cD","=","u_diffuse_intensity","*","cy",".","rgb",";","vec3","cI","=","u_emit","*","cy",".","rgb",";","vec3","U","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logic_negative_expr",PLACES:1},"SKY_COLOR",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cF","=","u_environment_energy","*","cE","(","vec3","(","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cF","=","u_environment_energy","*","cE","(","U",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cG","=","u_ambient","*","cF",";","float","cL","=","u_specular_params","[","0","]",";","vec2","cM","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cN","=","cL","*","u_specular_color",";","vec3","aQ",";","vec3","cO",";","cP","(","cI",",","cG",",","cD",",","cN",",","h",",","U",",","D",",","cM",",","u_diffuse_params",",","vec4","(","1.0",")",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cO",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aQ","=","cy",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["float","L","=","cy",".","a","*","cZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","length","(","i",")",",","D",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cT","=","-","i",".","z","/","u_view_max_depth",";","vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cW","=","cV","(","cU",")",";","float","cX","=","cW","-","cT",";","float","cY","=","u_view_max_depth","/","SOFT_STRENGTH","*","cX",";","L","=","L","*","min","(","cY",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["proc_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","vec3","u_sky_color",";","uniform","vec3","u_sun_direction",";","uniform","float","u_rayleigh_brightness",";","uniform","float","u_mie_brightness",";","uniform","float","u_spot_brightness",";","uniform","float","u_scatter_strength",";","uniform","float","u_rayleigh_strength",";","uniform","float","u_mie_strength",";","uniform","float","u_rayleigh_collection_power",";","uniform","float","u_mie_collection_power",";","uniform","float","u_mie_distribution",";","GLSL_IN","vec3","bu",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","const","float","du","=","0.99",";","const","float","dv","=","1.8",";","const","int","dw","=","8",";","float","dB","(","vec3","O",",","vec3","bH",")","{","float","a","=","dot","(","bH",",","bH",")",";","float","b","=","2.0","*","dot","(","bH",",","O",")",";","float","dx","=","dot","(","O",",","O",")","-","1.0",";","float","dy","=","b","*","b","-","4.0","*","a","*","dx",";","float","dz","=","sqrt","(","dy",")",";","float","q","=","(","-","b","-","dz",")","/","2.0",";","float","dA","=","dx","/","q",";","return","dA",";","}","float","dD","(","float","L",",","float","g",")","{","float","a","=","3.0","*","(","1.0","-","g","*","g",")",";","float","b","=","2.0","*","(","2.0","+","g","*","g",")",";","float","dx","=","1.0","+","L","*","L",";","float","dC","=","pow","(","1.0","+","g","*","g","-","2.0","*","g","*","L",",","1.5",")",";","dC","=","max","(","dC",",","0.00001",")",";","return","(","a","/","b",")","*","(","dx","/","dC",")",";","}","float","dI","(","vec3","O",",","vec3","bH",",","float","dE",")","{","float","dF","=","dot","(","bH",",","-","O",")",";","if","(","dF","<","0.0",")","{","return","1.0",";","}","vec3","dG","=","O","+","dF","*","bH",";","if","(","length","(","dG",")","<","dE",")","{","return","0.0",";","}","else","if","(","length","(","dG",")",">=","dE",")","{","vec3","da","=","normalize","(","dG",")","*","dE","-","O",";","float","dH","=","acos","(","dot","(","normalize","(","da",")",",","bH",")",")",";","return","smoothstep","(","0.0",",","1.0",",","pow","(","dH","*","2.0",",","3.0",")",")",";","}","else","return","1.0",";","}","vec3","dJ","(","float","aM",",","vec3","aQ",",","float","aL",")","{","return","aQ","-","aQ","*","pow","(","u_sky_color",",","vec3","(","aL","/","aM",")",")",";","}","void","main","(",")","{","vec3","bv","=","normalize","(","bu",")",";","vec3","dK","=","u_sun_direction",";","float","L","=","dot","(","bv",",","dK",")",";","float","dL","=","dD","(","L",",","-","0.01",")","*","u_rayleigh_brightness","*","dK",".","z",";","float","dM","=","dD","(","L","-","0.5",",","u_mie_distribution",")","*","u_mie_brightness","*","(","1.0","-","dK",".","z",")",";","float","dN","=","smoothstep","(","0.0",",","100.0",",","dD","(","L",",","0.9995",")",")","*","u_spot_brightness",";","vec3","dO","=","vec3","(","0.0",",","0.0",",","du",")",";","float","dP","=","dB","(","dO",",","bv",")",";","float","dQ","=","dP","/","float","(","dw",")",";","float","dR","=","dI","(","dO",",","bv",",","du","-","0.3",")",";","vec3","dS","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","dT","=","vec3","(","0.0",",","0.0",",","0.0",")",";","for","(","int","cq","=","0",";","cq","<","dw",";","cq","++",")","{","float","dU","=","dQ","*","float","(","cq",")",";","vec3","O","=","dO","+","bv","*","dU",";","float","dV","=","dI","(","O",",","dK",",","du","-","0.2",")",";","float","dW","=","dB","(","O",",","dK",")",";","vec3","dX","=","dJ","(","dW",",","vec3","(","dv",")",",","u_scatter_strength",")","*","dV",";","dS","+=","dJ","(","sqrt","(","dU",")",",","u_sky_color","*","dX",",","u_rayleigh_strength",")",";","dT","+=","dJ","(","dU",",","dX",",","u_mie_strength",")",";","}","dS","=","dS","*","dR","*","pow","(","dP",",","u_rayleigh_collection_power",")","/","float","(","dw",")",";","dT","=","(","dT","*","dR","*","pow","(","dP",",","u_mie_collection_power",")",")","/","float","(","dw",")",";","vec3","aQ","=","vec3","(","dN","*","dT","+","dM","*","dT","+","dL","*","dS",")",";","aW","(","aQ",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","1.0",")",";","}"]}]},e["r_convolution_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";","uniform","float","u_roughness",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bu",";","float","eb","(","int","cw",",","int","dY",")","{","float","dZ","=","1.0","/","float","(","dY",")",";","float","d_","=","1.0",";","float","ea","=","0.0",";","for","(","int","cq","=","0",";","cq","<","32",";","++","cq",")","{","if","(","cw",">","0",")","{","d_","=","mod","(","float","(","cw",")",",","2.0",")",";","ea","+=","d_","*","dZ",";","dZ","=","dZ","/","2.0",";","cw","=","int","(","float","(","cw",")","/","2.0",")",";","}","}","return","ea",";","}","vec2","ed","(","int","cq",",","int","ec",")","{","return","vec2","(","float","(","cq",")","/","float","(","ec",")",",","eb","(","cq",",","2",")",")",";","}","vec3","ek","(","vec2","ee",",","vec3","ec",",","float","ef",")","{","float","a","=","ef","*","ef",";","float","bC","=","2.0","*","M_PI","*","ee",".","x",";","float","eg","=","sqrt","(","(","1.0","-","ee",".","y",")","/","(","1.0","+","(","a","*","a","-","1.0",")","*","ee",".","y",")",")",";","float","eh","=","sqrt","(","1.0","-","eg","*","eg",")",";","vec3","ei",";","ei",".","x","=","cos","(","bC",")","*","eh",";","ei",".","y","=","sin","(","bC",")","*","eh",";","ei",".","z","=","eg",";","vec3","by","=","abs","(","ec",".","z",")","<","0.999","?","vec3","(","0.0",",","0.0",",","1.0",")",":","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","V","=","normalize","(","cross","(","by",",","ec",")",")",";","vec3","ej","=","cross","(","ec",",","V",")",";","vec3","bF","=","V","*","ei",".","x","+","ej","*","ei",".","y","+","ec","*","ei",".","z",";","return","normalize","(","bF",")",";","}","void","main","(",")","{","vec3","el","=","vec3","(","0.0",")",";","if","(","u_roughness","!=","0.0",")","{","vec3","ec","=","normalize","(","bu",")",";","vec3","em","=","ec",";","vec3","en","=","em",";","const","int","eo","=","1024",";","float","ep","=","0.0",";","for","(","int","cq","=","0",";","cq","<","eo",";","++","cq",")","{","vec2","ee","=","ed","(","cq",",","eo",")",";","vec3","ei","=","ek","(","ee",",","ec",",","u_roughness",")",";","vec3","eq","=","normalize","(","2.0","*","dot","(","en",",","ei",")","*","ei","-","en",")",";","float","er","=","max","(","dot","(","ec",",","eq",")",",","0.0",")",";","if","(","er",">","0.0",")","{","vec3","bw","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","eq",")",".","rgb",";","bG","(","bw",")",";","el","+=","bw","*","er",";","ep","+=","er",";","}","}","el","=","el","/","ep",";","}","else","{","vec3","bw","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","normalize","(","bu",")",")",".","rgb",";","bG","(","bw",")",";","el","=","bw",";","}","GLSL_OUT_FRAG_COLOR","=","vec4","(","el",",","1.0",")",";","}"]}]},e["shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap0",";","uniform","float","u_alpha_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS","SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","float","L","=","I",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","(","GLSL_TEXTURE","(","u_colormap0",",","A",")",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","M","=","u_alpha_factor","*","L",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","L","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","NO_SHADOWS",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","es","(","-","i",".","z",",","u_camera_range",")",";","GLSL_OUT_FRAG_COLOR","=","eu","(","et",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","ev","(","i",".","z",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR",".","a","*=","clamp","(","k",".","r",",","0.999999999",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"HAIR_BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_v_light_tsr","[","NUM_CAST_LAMPS","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_v_light_ts","[","NUM_CAST_LAMPS","]",";","uniform","vec4","u_v_light_r","[","NUM_CAST_LAMPS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","ca","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","vec3","U","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","aZ","(","a_part_ts",".","xyz",",","aY","(",")",")",";","Z","=","a_","(","vec3","(","a_part_ts",".","w",")",",","Z",")",";","Z","=","bc","(","a_part_r",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","bd","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","_","(","Z",",","ca",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","be","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","U",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HAIR_BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","ew","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","ew","=","N",";"]}]}}]},{TYPE:"txt",TOKENS:["Z","=","as","(","u_camera_eye",",","aq",",","ew",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","aq",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","ay",",","mat4","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec4","cc","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","cc",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cd","(","aw",".","O",",","aw",".","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ey","=","(","u_proj_matrix","*","vec4","(","ex","(","N",")",",","1.0",")",")",".","xy",";","float","ez","=","SHADOW_TEX_RES","/","2.0",";","ey","=","floor","(","ey","*","ez","+","0.5",")","/","ez","-","ey",";","f",".","xy","+=","ey",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["sky.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";","uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sky_tex_fac",";","uniform","vec3","u_sky_tex_color",";","uniform","float","u_sky_tex_dvar",";","uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bu",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec3","bw",";","vec3","bv","=","normalize","(","bu",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eA","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","abs","(","A",".","y",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","(","A",".","y","+","1.0",")","*","0.5",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","eB","=","u_horizon_color",";","vec3","eC","=","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eD","=","vec3","(","A",",","0.0",")",";","vec4","eE","=","GLSL_TEXTURE_CUBE","(","u_sky",",","bv",")",";","bG","(","eE",".","rgb",")",";","bw","=","eF","(","eB",",","eC",",","eE",",","eA",",","eD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","mix","(","eB",",","eC",",","eA",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","GLSL_TEXTURE_CUBE","(","u_sky",",","bv",")",".","rgb",";","bG","(","bw",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eG","=","WATER_LEVEL","-","u_camera_eye_frag",".","z",";","vec3","eH","=","vec3","(","0.0",")",";","vec3","eI","=","mix","(","u_underwater_fog_color_density",".","rgb",",","eH",",","min","(","-","bv",".","z",",","1.0",")",")",";","eI","*=","min","(","1.0","-","min","(","0.03","*","eG",",","0.8",")",",","1.0",")",";","float","aL","=","clamp","(","sign","(","0.01","*","eG","-","bv",".","z",")",",","0.0",",","1.0",")",";","bw","=","mix","(","bw",",","eI",",","aL",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","bw",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bw",",","1.0",")",";","}"]}]},e["sky.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","mat4","u_sky_vp_inverse",";","GLSL_IN","vec3","a_position",";","GLSL_OUT","vec3","bu",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","O","=","vec4","(","a_position",".","xy",",","0.9999999",",","1.0",")",";","vec4","bv","=","u_sky_vp_inverse","*","O",";","bu","=","bv",".","xyz",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_position",".","xy",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]},e["skybox.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_view_matrix",";","GLSL_IN","vec3","a_position",";","GLSL_OUT","vec3","bu",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","O","=","vec4","(","a_position",".","xy",",","0.999999",",","1.0",")",";","vec4","bv","=","u_cube_view_matrix","*","O",";","bu","=","bv",".","xyz",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_position",".","xy",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]},e["tex_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bu",";","GLSL_IN","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_sky_tex_fac",";","uniform","vec3","u_sky_tex_color",";","uniform","float","u_sky_tex_dvar",";","uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","bv","=","normalize","(","bu",")",";","vec3","bw",";","float","eA","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYPAPER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","bv",")",".","xyz",";","bG","(","bw",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","vec3","(","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","acos","(","bv",".","z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","abs","(","L","*","INV_PI","-","0.5",")","*","2.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","1.0","-","L","*","INV_PI",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","eB","=","u_horizon_color",";","vec3","eC","=","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","eE","=","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","bv",")",";","bG","(","eE",".","rgb",")",";","vec3","eD","=","vec3","(","bu",".","xy",",","0.0",")",";","bw","=","eF","(","eB",",","eC",",","eE",",","eA",",","eD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","mix","(","eB",",","eC",",","eA",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","eB",";"]}]}}]}]}}]}]}}]},{TYPE:"txt",TOKENS:["aW","(","bw",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bw",",","1.0",")",";","}"]}]},e["water.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},{TYPE:"var",NAME:"ABSORB",TOKENS:["6.0"]},{TYPE:"var",NAME:"SSS_STRENGTH",TOKENS:["1.0"]},{TYPE:"var",NAME:"SSS_WIDTH",TOKENS:["0.45"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.002"]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_foam",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";","uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";","uniform","vec3","u_shallow_water_col",";","uniform","vec3","u_shore_water_col",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_water_norm_uv_velocity",";","uniform","vec2","u_normalmap0_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap1_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap2_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_water_shallow_col_fac",";","uniform","float","u_water_shore_col_fac",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_foam_factor",";","uniform","vec2","u_foam_uv_freq",";","uniform","vec2","u_foam_mag",";","uniform","vec2","u_foam_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","aE","=","1.0",";","uniform","vec3","u_wireframe_edge_color",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";","GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","k",";","GLSL_IN","vec3","eJ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eK",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["vec3","eT","(","in","vec2","eM",",","in","vec3","U",",","in","vec3","eN",",","in","vec3","eO",",","out","float","eP",",","in","float","eQ",")","{","eP","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eR","=","eM",".","xy","+","U",".","xy","*","REFL_BUMP","/","m",";","eP","=","u_reflect_factor",";","vec3","eS",";","if","(","u_cam_water_depth","<","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eS","=","u_underwater_fog_color_density",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eS","=","u_diffuse_color",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","{","eS","=","GLSL_TEXTURE","(","u_plane_reflection",",","eR",")",".","rgb",";","bG","(","eS",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eP","=","u_mirror_factor",";","vec3","eS","=","eO","*","GLSL_TEXTURE_CUBE","(","u_mirrormap",",","eN",")",".","rgb",";","bG","(","eS",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eP","=","u_reflect_factor",";","vec3","eS","=","eO","*","vec3","(","0.3",",","0.5",",","1.0",")",";","bG","(","eS",")",";"]}]}}]},{TYPE:"txt",TOKENS:["eP","=","min","(","eP","*","eQ",",","1.0",")",";","return","eS",";","}"]},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","cg","=","mat3","(","k",",","eJ",",","j",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","U","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC","FOAM",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z","-","WATER_LEVEL",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","vec2","(","eK",".","x",",","-","eK",".","y",")","+","0.5",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","vec2","(","h",".","x",",","-","h",".","y",")","+","0.5",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eU","=","vec3","(","0.0",")",";","eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap0_scale","+","vec2","(","0.3",",","0.5",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap1_scale","+","vec2","(","-","0.3",",","0.7",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap2_scale","+","vec2","(","0.0",",","1.1",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap3_scale","+","vec2","(","-","0.66",",","-","0.3",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","normalize","(","cg","*","eU",")",",","0.3",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","normalize","(","cg","*","eU",")",",","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["U","=","normalize","(","U",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bY",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eM","=","l",".","xy","/","l",".","z",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eM","=","vec2","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eV","=","eM","+","U",".","xy","*","u_refr_bump","/","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";","vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cW","=","cV","(","cU",")",";","float","cX","=","max","(","cW","-","m",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eX","=","eW","(","cW",",","eV",",","eM",")",";","float","eY","=","max","(","eX","-","m",",","0.0",")",";","float","eZ","=","u_view_max_depth","/","ABSORB","*","eY",";","float","e_","=","min","(","L","*","eZ",",","1.0",")",";","L","=","min","(","15.0","*","L","*","u_view_max_depth","*","cX",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cY","=","u_view_max_depth","/","ABSORB","*","cX",";","if","(","u_cam_water_depth",">","0.0",")","L","=","min","(","L","*","cY",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","e_","=","L",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_cam_water_depth","<","0.0",")","e_","=","0.0",";","vec3","fa","=","GLSL_TEXTURE","(","u_refractmap",",","eV",")",".","rgb",";","bG","(","fa",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fb","=","pow","(","min","(","eL",".","b","/","u_water_shallow_col_fac",",","1.0",")",",","0.3",")",";","vec3","cy","=","mix","(","u_shallow_water_col",",","u_diffuse_color",".","rgb",",","fb",")",";","fb","=","pow","(","min","(","eL",".","b","/","u_water_shore_col_fac",",","1.0",")",",","0.3",")",";","cy","=","mix","(","u_shore_water_col",",","cy",",","fb",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cy","=","u_diffuse_color",".","rgb",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fc","=","max","(","1.0","-","u_view_max_depth","*","cX",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fc","=","1.0","-","L",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fd","=","max","(","bT","/","WAVES_HEIGHT","+","0.1",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fe","=","normalize","(","vec3","(","eL",".","rg",",","0.0",")",")",";","vec3","ff","=","normalize","(","mix","(","UP_VECTOR",",","fe",",","0.8",")",")",";","float","fg","=","1.25","*","max","(","dot","(","U",",","ff",")","-","0.2",",","0.0",")",";","fg","+=","max","(","dot","(","U",",","-","UP_VECTOR",")",",","0.0",")",";","fc","+=","fg","*","(","1.0","-","eL",".","b",")",";","fd","*=","(","1.0","-","0.95","*","pow","(","eL",".","b",",","0.1",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["fc","+=","fd",";","fc","=","min","(","u_foam_factor","*","fc",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","fh","=","GLSL_TEXTURE","(","u_foam",",","u_foam_mag","*","sin","(","u_foam_uv_freq","*","u_time",")","+","ce","*","u_foam_scale",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cL","=","u_specular_params","[","0","]",";","vec2","cM","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cN","=","cL","*","u_specular_color",";","vec3","cF","=","u_environment_energy","*","cE","(","U",")",";","vec3","cG","=","u_ambient","*","cF",";","vec3","eO","=","cG","+","u_sun_intensity",";","float","eP",";","vec3","eN","=","reflect","(","-","D",",","U",")",";","vec3","fi","=","normalize","(","eN","+","D",")",";","float","fj","=","1.0","-","dot","(","D",",","fi",")",";","float","ec","=","u_fresnel_params","[","0","]",";","float","fk","=","u_fresnel_params","[","1","]",";","float","fl","=","fk","+","(","1.0","-","fk",")","*","pow","(","fj",",","ec",")",";","vec3","eS","=","eT","(","eM",",","U",",","eN",",","eO",",","eP",",","fl",")",";","vec3","cD","=","u_diffuse_intensity","*","cy",";","vec3","aQ",";","vec3","cO",";","cP","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","cD",",","cN",",","h",",","U",",","D",",","cM",",","u_diffuse_params",",","vec4","(","1.0",")",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cO",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fm","=","max","(","dot","(","u_sun_direction",",","-","j",")","+","SSS_WIDTH",",","0.0",")","*","max","(","dot","(","-","D",",","u_sun_direction",")","-","0.5",",","0.0",")","*","max","(","0.0",",","length","(","u_sun_intensity",")","-","0.1",")",";","fm","=","clamp","(","SSS_STRENGTH","*","fm",",","0.0",",","1.0",")",";","aQ","=","mix","(","aQ",",","u_shallow_water_col",",","fm",")",";","aQ","=","mix","(","aQ",",","u_shore_water_col",",","fm",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","mix","(","fa",",","aQ",",","e_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","=","mix","(","aQ",",","eS",",","eP",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fn","=","mix","(","fh",".","g",",","fh",".","r",",","max","(","4.0","*","(","fc","-","0.75",")",",","0.0",")",")",";","fn","=","mix","(","fh",".","b",",","fn",",","max","(","2.0","*","fc","-","1.0",",","0.0",")",")",";","fn","=","mix","(","0.0",",","fn",",","fc",")",";","aQ","=","mix","(","aQ",",","eO",",","fn",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","+=","cO",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fo","=","m","*","u_view_max_depth",";","float","fp","=","1.0",";","if","(","u_cam_water_depth",">","1.0",")","fp","=","2.0",";","bW","(","aQ",",","fo",",","D",",","fp",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","max","(","L",",","cO",".","r",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","+=","fn",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHORE_SMOOTHING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"txt",TOKENS:["vec3","aN","=","fwidth","(","aD",")",";","vec3","aO","=","smoothstep","(","vec3","(","0.0",")",",","aN","*","aE",",","aD",")",";","float","fq","=","min","(","min","(","aO",".","x",",","aO",".","y",")",",","aO",".","z",")",";","fq","=","clamp","(","fq",",","0.0",",","1.0",")",";","aQ","=","mix","(","u_wireframe_edge_color",",","aQ",",","fq",")",";","L","=","mix","(","1.0",",","L",",","fq",")",";"]}]}},{TYPE:"elif",EXPRESSION:["DEBUG_WIREFRAME",2,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","float","fq","=","1.0",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","fq","=","0.0",";","aQ","=","mix","(","u_wireframe_edge_color",",","aQ",",","fq",")",";","L","=","mix","(","1.0",",","L",",","fq",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["water.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"MAX_SHORE_DIST",TOKENS:["100.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_X",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_Y",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_X",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_Y",TOKENS:["0.0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},{TYPE:"var",NAME:"DST_NOISE_SCALE_0",TOKENS:["0.05"]},{TYPE:"var",NAME:"DST_NOISE_SCALE_1",TOKENS:["0.03"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_0",TOKENS:["1.3"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_1",TOKENS:["1.0"]},{TYPE:"var",NAME:"DIR_MIN_SHR_FAC",TOKENS:["0.4"]},{TYPE:"var",NAME:"DIR_FREQ",TOKENS:["0.5"]},{TYPE:"var",NAME:"DIR_NOISE_SCALE",TOKENS:["0.05"]},{TYPE:"var",NAME:"DIR_NOISE_FREQ",TOKENS:["0.07"]},{TYPE:"var",NAME:"DIR_MIN_NOISE_FAC",TOKENS:["0.5"]},{TYPE:"var",NAME:"DST_MIN_FAC",TOKENS:["0.2"]},{TYPE:"var",NAME:"WAVES_HOR_FAC",TOKENS:["5.0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WAVES_LENGTH",TOKENS:["10.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_polyindex",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";","GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","k",";","GLSL_OUT","vec3","eJ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eK",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_time",";","uniform","vec3","u_wind",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fx","(","in","vec2","fr",")","{","vec2","fs","=","0.5","+","vec2","(","(","fr",".","x","-","SHORE_MAP_CENTER_X",")","/","SHORE_MAP_SIZE_X",",","(","fr",".","y","-","SHORE_MAP_CENTER_Y",")","/","SHORE_MAP_SIZE_Y",")",";","vec4","ft","=","GLSL_TEXTURE","(","u_shore_dist_map",",","fs",")",";","const","vec2","fu","=","vec2","(","1.0","/","255.0",",","1.0",")",";","float","fv","=","dot","(","ft",".","ba",",","fu",")",";","vec2","fw","=","normalize","(","ft",".","rg","*","2.0","-","1.0",")",";","return","vec3","(","fw",",","fv",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMALL_WAVES_FAC",TOKENS:["0.2"]},{TYPE:"txt",TOKENS:["void","fM","(","inout","vec3","fr",",","in","float","fy",",","in","vec3","ft",")","{","float","fA","=","fz","(","DST_NOISE_SCALE_0","*","(","fr",".","xy","+","DST_NOISE_FREQ_0","*","fy",")",")","*","fz","(","DST_NOISE_SCALE_1","*","(","fr",".","yx","-","DST_NOISE_FREQ_1","*","fy",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fB","=","WAVES_LENGTH","/","MAX_SHORE_DIST","/","M_PI",";","float","fv","=","ft",".","b",";","float","fC","=","sqrt","(","fv",")",";","float","fD","=","max","(","fv",",","DIR_MIN_SHR_FAC",")","*","sin","(","fC","/","fB","+","DIR_FREQ","*","fy",")",";","float","fE","=","max","(","fz","(","DIR_NOISE_SCALE","*","(","fr",".","xy","+","DIR_NOISE_FREQ","*","fy",")",")",",","DIR_MIN_NOISE_FAC",")",";","fD","*=","fE",";","float","fF","=","WAVES_HEIGHT","*","mix","(","fD",",","fA",",","max","(","fC",",","DST_MIN_FAC",")",")",";","vec2","fw","=","ft",".","rg",";","float","fG","=","WAVES_HOR_FAC","*","fD","*","max","(","MAX_SHORE_DIST","/","35.0","*","(","0.05","-","fv",")",",","0.0",")",";","vec2","fH","=","fG","*","fw",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fF","=","WAVES_HEIGHT","*","fA",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fI","=","1.0","*","(","fr",".","xy","-","0.3","*","fy",")",";","vec2","fJ","=","0.7","*","(","fr",".","yx","+","0.07","*","fy",")",";","float","fL","=","fK","(","fI",")",".","x","+","fK","(","fJ",")",".","x","-","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fr",".","xy","+=","fH",";","fL","*=","fv",";"]}]}}]},{TYPE:"txt",TOKENS:["fF","+=","SMALL_WAVES_FAC","*","fL",";"]}]}}]},{TYPE:"txt",TOKENS:["fr",".","z","+=","fF",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","a_polyindex","==","0.0",")","aD","=","vec3","(","1.0",",","0.0",",","0.0",")",";","else","if","(","a_polyindex","==","1.0",")","aD","=","vec3","(","0.0",",","0.0",",","1.0",")",";","else","aD","=","vec3","(","0.0",",","1.0",",","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","O","=","a_position",";","float","fN","=","abs","(","O",".","z",")",";","vec2","fO","=","u_camera_eye",".","xy","-","mod","(","u_camera_eye",".","xy",",","fN",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O",".","z","=","WATER_LEVEL",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O",".","z","=","0.0",";"]}]}}]},{TYPE:"txt",TOKENS:["O",".","xy","+=","fO",";","vec3","cb","=","O",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_texcoord",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","u_model_tsr",")",";","vec3","cb","=","aw",".","O",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eL","=","fx","(","cb",".","xy",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fP","=","length","(","u_wind",")",";","if","(","fP","==","0.0",")","fP","=","1.0",";","float","fQ","=","u_time",";","fQ","*=","fP",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fR","=","fN",";","vec3","fS","=","cb","+","vec3","(","fR",",","0.0",",","0.0",")",";","vec3","fT","=","cb","+","vec3","(","0.0",",","fR",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eK","=","cb",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fS","=","cb","+","vec3","(","0.05",",","0.0",",","0.0",")",";","vec3","fT","=","cb","+","vec3","(","0.0",",","0.05",",","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fU","=","fx","(","fS",".","xy",")",";","vec3","fV","=","fx","(","fT",".","xy",")",";","fM","(","fS",",","fQ",",","fU",")",";","fM","(","fT",",","fQ",",","fV",")",";","fM","(","cb",",","fQ",",","eL",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fM","(","fS",",","fQ",",","vec3","(","0.0",")",")",";","fM","(","fT",",","fQ",",","vec3","(","0.0",")",")",";","fM","(","cb",",","fQ",",","vec3","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","a_position",".","z","<","0.0",")","{","cb",".","z","=","WATER_LEVEL","-","1.0",";","fS",".","z","=","cb",".","z",";","fT",".","z","=","cb",".","z",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec3","ej","=","normalize","(","fS","-","cb",")",";","vec3","V","=","normalize","(","fT","-","cb",")",";","j","=","normalize","(","cross","(","ej",",","V",")",")",";","float","fW","=","dot","(","j",",","UP_VECTOR",")",";","float","aL","=","clamp","(","0.8","-","fW",",","0.0",",","1.0",")",";","j","=","mix","(","j",",","UP_VECTOR",",","aL",")",";"]}]}},{TYPE:"elif",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","S","=","R","(","a_tbn",")",";","j","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","vec3","(","0.0",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","1.0",",","0.0",",","0.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["k","=","V",";","eJ","=","cross","(","j",",","k",")",";"]}]}}]},{TYPE:"txt",TOKENS:["h","=","cb",";","bY","=","u_camera_eye","-","cb",";","vec4","cc","=","vec4","(","ap","(","u_view_tsr",",","cb",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fX","=","f",".","x",";","float","fY","=","f",".","y",";","float","fZ","=","f",".","w",";","l",".","x","=","(","fX","+","fZ",")","/","2.0",";","l",".","y","=","(","fY","+","fZ",")","/","2.0",";","l",".","z","=","fZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","cc",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["postprocessing/antialiasing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_FXAA_LIGHT"]},{TYPE:"var",NAME:"AA_QUALITY",TOKENS:["AA_QUALITY_LOW"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_REDUCE_MIN",TOKENS:["(","1.0","/","128.0",")"]},{TYPE:"define",NAME:"FXAA_REDUCE_MUL",TOKENS:["(","1.0","/","8.0",")"]},{TYPE:"define",NAME:"FXAA_SPAN_MAX",TOKENS:["8.0"]},{TYPE:"txt",TOKENS:["vec4","gc","(","float","x",",","float","y",")","{","vec2","f_","=","A","+","vec2","(","x",",","y",")","*","u_texel_size",";","return","GLSL_TEXTURE","(","u_color",",","f_",")",";","}","vec4","gx","(",")","{","vec4","gd","=","gc","(","-","1.0",",","-","1.0",")",";","vec4","ge","=","gc","(","1.0",",","-","1.0",")",";","vec4","gf","=","gc","(","-","1.0",",","1.0",")",";","vec4","gh","=","gc","(","1.0",",","1.0",")",";","vec4","gi","=","gc","(","0.0",",","0.0",")",";","float","gk","=","gj","(","gi",")",";","float","gl","=","gj","(","gd",")",";","float","gm","=","gj","(","ge",")",";","float","gn","=","gj","(","gf",")",";","float","go","=","gj","(","gh",")",";","float","gp","=","min","(","gk",",","min","(","min","(","gl",",","gm",")",",","min","(","gn",",","go",")",")",")",";","float","gq","=","max","(","gk",",","max","(","max","(","gl",",","gm",")",",","max","(","gn",",","go",")",")",")",";","vec2","bH",";","bH",".","x","=","-","(","(","gl","+","gm",")","-","(","gn","+","go",")",")",";","bH",".","y","=","(","(","gl","+","gn",")","-","(","gm","+","go",")",")",";","float","gs","=","max","(","(","gl","+","gm","+","gn","+","go",")","*","(","0.25","*","FXAA_REDUCE_MUL",")",",","FXAA_REDUCE_MIN",")",";","float","gt","=","1.0","/","(","min","(","abs","(","bH",".","x",")",",","abs","(","bH",".","y",")",")","+","gs",")",";","bH","=","min","(","vec2","(","FXAA_SPAN_MAX",",","FXAA_SPAN_MAX",")",",","max","(","vec2","(","-","FXAA_SPAN_MAX",",","-","FXAA_SPAN_MAX",")",",","bH","*","gt",")",")","*","u_texel_size",";","vec4","gu","=","0.5","*","(","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","(","1.0","/","3.0","-","0.5",")",")","+","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","(","2.0","/","3.0","-","0.5",")",")",")",";","vec4","gv","=","gu","*","0.5","+","0.25","*","(","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","-","0.5",")","+","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","0.5",")",")",";","float","gw","=","gj","(","gv",")",";","if","(","(","gw","<","gp",")","||","(","gw",">","gq",")",")","return","gu",";","else","return","gv",";","}"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["1"]},{TYPE:"include",FILE:"fxaa.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_QUALITY","AA_QUALITY_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["39"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["1.00"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.063"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0312"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY","AA_QUALITY_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["20"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.65"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0625"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY","AA_QUALITY_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.50"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0833"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gx","(",")",";"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","gy","=","u_texel_size",";","GLSL_OUT_FRAG_COLOR","=","gz","(","A",",","u_color",",","gy",",","FXAA_QUALITY_SUBPIX",",","FXAA_QUALITY_EDGE_THRESHOLD",",","FXAA_QUALITY_EDGE_THRESHOLD_MIN",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/bloom_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"BLUR_PASS_NUM",TOKENS:["BLUR_PASS_5"]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_3",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_4",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gA","=","GLSL_TEXTURE","(","u_main",",","A",")",";","vec4","gB","=","vec4","(","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_0",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_1",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_2",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_3",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_4",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gA","+","gB",";","}"]}]},e["postprocessing/coc.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"COC_TYPE",TOKENS:["COC_ALL"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","sampler2D","u_depth",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_view_max_depth",";","uniform","float","u_dof_dist",";","uniform","float","u_dof_front_start",";","uniform","float","u_dof_front_end",";","uniform","float","u_dof_rear_start",";","uniform","float","u_dof_rear_end",";","uniform","vec2","u_camera_range",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","if","(","u_dof_dist",">","0.0",")","{","float","et","=","gC","(","u_depth",",","A",",","u_camera_range",")",";","et","*=","u_view_max_depth",";","float","gD","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","gE","=","GLSL_TEXTURE","(","u_coc_fg",",","A",")",";","float","gF","=","gE",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","et","<","u_dof_dist",")","gD","=","(","u_dof_dist","-","et","-","u_dof_front_start",")","/","(","u_dof_front_end","-","u_dof_front_start",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","gD","=","(","et","-","u_dof_dist","-","u_dof_rear_start",")","/","(","u_dof_rear_end","-","u_dof_rear_start",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gD","=","clamp","(","gD",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gD","=","max","(","gD",",","gF",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","gD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",".","xyz","*","gD",",","gD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",".","xyz",",","0.0",")",";","}"]}]},e["postprocessing/compositing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","float","u_brightness",";","uniform","float","u_contrast",";","uniform","float","u_exposure",";","uniform","float","u_saturation",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gG","=","GLSL_TEXTURE","(","u_color",",","A",")",";","vec3","aQ","=","gG",".","rgb",";","if","(","u_brightness","<","0.0",")","aQ","=","aQ","*","(","1.0","+","u_brightness",")",";","else","aQ","=","aQ","+","(","(","1.0","-","aQ",")","*","u_brightness",")",";","aQ","=","(","aQ","-","0.5",")","*","(","tan","(","(","u_contrast","+","1.0",")","*","M_PI_4",")",")","+","0.5",";","aQ","*=","u_exposure",";","float","dv","=","gj","(","vec4","(","aQ",",","0.0",")",")",";","aQ","=","mix","(","vec3","(","dv",")",",","aQ",",","u_saturation",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","gG",".","a",")",";","}"]}]},e["postprocessing/depth_pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","vec2","u_camera_range",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","eu","(","clamp","(","gC","(","u_depth",",","A",",","u_camera_range",")",",","0.0",",","0.999999",")",")",";","}"]}]},e["postprocessing/dof.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DOF_TYPE",TOKENS:["DOF_SIMPLE"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","highp","sampler2D","u_sharp",";","uniform","highp","sampler2D","u_blurred1",";","uniform","highp","sampler2D","u_blurred2",";","uniform","float","u_dof_dist",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sharp",";","uniform","sampler2D","u_blurred",";","uniform","sampler2D","u_depth",";","uniform","float","u_view_max_depth",";","uniform","float","u_dof_dist",";","uniform","float","u_dof_front_end",";","uniform","float","u_dof_rear_end",";","uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gH","=","GLSL_TEXTURE","(","u_sharp",",","A",")",";","if","(","u_dof_dist",">","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gD",";","vec4","gI","=","GLSL_TEXTURE","(","u_blurred1",",","A",")",";","vec4","gJ","=","GLSL_TEXTURE","(","u_blurred2",",","A",")",";","vec4","gK","=","min","(","gI",".","rgba",",","gJ",".","rgba",")",";","gD","=","gK",".","a",";","if","(","gD",">","0.0",")","{","gK","=","vec4","(","gK",".","rgb","/","gD",",","gH",".","a",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","gH",",","gK",",","min","(","gD","*","5.0",",","1.0",")",")",";","}","else","GLSL_OUT_FRAG_COLOR","=","gH",";"]}]}},{TYPE:"elif",EXPRESSION:["DOF_TYPE","DOF_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","gC","(","u_depth",",","A",",","u_camera_range",")",";","et","*=","u_view_max_depth",";","float","gL",";","if","(","et","<","u_dof_dist",")","gL","=","(","u_dof_dist","-","et",")","/","u_dof_front_end",";","else","gL","=","(","et","-","u_dof_dist",")","/","u_dof_rear_end",";","gL","=","clamp","(","gL",",","0.0",",","1.0",")",";","vec4","gM","=","GLSL_TEXTURE","(","u_blurred",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","gH",",","gM",",","gL",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gH",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","GLSL_OUT_FRAG_COLOR","=","gH",";","}"]}]},e["postprocessing/glow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_src_color",";","uniform","sampler2D","u_glow_mask_small",";","uniform","sampler2D","u_glow_mask_large",";","uniform","float","u_glow_mask_small_coeff",";","uniform","float","u_glow_mask_large_coeff",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gN","=","GLSL_TEXTURE","(","u_src_color",",","A",")",";","vec4","gO","=","GLSL_TEXTURE","(","u_glow_mask_small",",","A",")",";","vec4","gP","=","GLSL_TEXTURE","(","u_glow_mask_large",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","gN",";","if","(","gP",".","a","!=","0.0",")","{","float","gQ","=","u_glow_mask_large_coeff","*","gP",".","a",";","gQ","=","clamp","(","gQ",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","mix","(","GLSL_OUT_FRAG_COLOR",".","rgb",",","gP",".","rgb","/","gP",".","a",",","gQ",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","mix","(","GLSL_OUT_FRAG_COLOR",".","a",",","1.0",",","gQ",")",";","}","if","(","gO",".","a","!=","0.0",")","{","float","gR","=","u_glow_mask_small_coeff","*","gO",".","a",";","gR","=","clamp","(","gR",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","mix","(","GLSL_OUT_FRAG_COLOR",".","rgb",",","gO",".","rgb","/","gO",".","a",",","gR",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","mix","(","GLSL_OUT_FRAG_COLOR",".","a",",","1.0",",","gR",")",";","}","}"]}]},e["postprocessing/god_rays.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"STEPS_PER_PASS",TOKENS:["10.0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_radial_blur_step",";","uniform","sampler2D","u_input",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","gS",";","GLSL_IN","vec2","gT",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_IN","vec4","gU",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec2","cX","=","(","gU",".","xy","-","A",")",";","float","aM","=","length","(","cX",")",";","vec2","gV","=","u_radial_blur_step","*","cX","/","aM",";","float","gW","=","aM","/","u_radial_blur_step",";","gV","*=","min","(","gW",",","STEPS_PER_PASS",")","/","STEPS_PER_PASS",";","gW","=","max","(","gW",",","STEPS_PER_PASS",")",";","vec2","gX","=","A",";","float","gY","=","0.0",";","const","int","gZ","=","int","(","STEPS_PER_PASS",")",";","int","g_","=","int","(","gW","+","0.5",")",";","for","(","int","cq","=","0",";","cq","<","gZ",";","cq","+=","1",")","{","if","(","cq","<=","g_",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","gC","(","u_input",",","gX",",","u_camera_range",")",";","gY","+=","max","(","(","1.0","-","pow","(","aM",",","0.3",")",")","*","step","(","0.9",",","et",")",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","ha","=","GLSL_TEXTURE","(","u_input",",","gX",")",";","gY","+=","cV","(","ha",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","gX","+=","gV",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A","+","gT",";","float","hb","=","fK","(","vec2","(","2.5","*","(","ce",".","x",")",",","2.5","*","(","ce",".","y",")","+","1.0","*","u_time",")",")",".","x","+","0.75","*","fK","(","vec2","(","5.0","*","(","ce",".","x",")","-","0.66","*","u_time",",","5.0","*","(","ce",".","y",")","+","0.66","*","u_time",")",")",".","x","+","0.5","*","fz","(","vec2","(","7.5","*","(","ce",".","x",")","+","0.33","*","u_time",",","7.5","*","(","ce",".","y",")","-","0.33","*","u_time",")",")",";","hb","*=","clamp","(","1.2","-","sqrt","(","0.2","*","aM",")",",","0.0",",","1.0",")","*","gS",";","gY","=","max","(","hb",",","gY",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","eu","(","gY","/","STEPS_PER_PASS",")",";","}"]}]},e["postprocessing/god_rays.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["uniform","mat4","u_view_proj_matrix",";","uniform","vec3","u_sun_direction",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_camera_quat",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_bb_vertex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","gS",";","GLSL_OUT","vec2","gT",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";","GLSL_OUT","vec4","gU",";","void","main","(",")","{","A","=","a_bb_vertex",";","vec3","bH","=","normalize","(","u_sun_direction",")",";","gU","=","u_view_proj_matrix","*","vec4","(","bH",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_cam_water_depth","<","0.0",")","{","gS","=","1.0",";","vec3","hc","=","vec3","(","0.0",",","1.0",",","0.0",")",";","vec3","hd","=","T","(","u_camera_quat",",","hc",")",";","hd","=","normalize","(","hd",")",";","float","he","=","dot","(","hd",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","float","hf","=","atan","(","hd",".","x",",","hd",".","z",")",";","gT","=","vec2","(","-","hf",",","acos","(","he",")",")",";","}","else","{","gS","=","0.0",";","}"]}]}}]},{TYPE:"txt",TOKENS:["gU",".","xy","=","0.5","*","(","gU",".","xy","/","gU",".","w","+","1.0",")",";","gU","+=","99999.0","*","step","(","gU",".","z",",","0.0",")",";","gl_Position","=","vec4","(","2.0","*","a_bb_vertex",".","xy","-","1.0",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/god_rays_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SAFARI_CANVAS_ALPHA_HACK",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";","uniform","sampler2D","u_god_rays",";","uniform","float","u_god_rays_intensity",";","uniform","vec3","u_sun_intensity",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hg","=","GLSL_TEXTURE","(","u_main",",","A",")",";","vec3","hh","=","clamp","(","u_sun_intensity",",","0.4",",","0.8",")",";","bG","(","hg",".","rgb",")",";","float","hi","=","cV","(","GLSL_TEXTURE","(","u_god_rays",",","A",")",")",";","vec3","hj","=","hg",".","rgb","+","u_god_rays_intensity","*","vec3","(","hi",")","*","hh",";","aW","(","hj",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SAFARI_CANVAS_ALPHA_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","hj",",","max","(","0.01",",","hg",".","a",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","hj",",","hg",".","a",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/luminance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_input",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gA","=","GLSL_TEXTURE","(","u_input",",","A",")",";","float","hk","=","dot","(","gA",".","rgb",",","vec3","(","0.2126",",","0.7152",",","0.0722",")",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","vec3","(","hk",")",",","1.0",")",";","}"]}]},e["postprocessing/luminance_av.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_input",";","uniform","float","u_mipmap_1x1",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","float","hl","=","max","(","GLSL_TEXTURE","(","u_input",",","A",",","u_mipmap_1x1",")",".","r",",","0.01",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","vec3","(","hl",")",",","1.0",")",";","}"]}]},e["postprocessing/luminance_truncated.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"ADAPTIVE_BLOOM",TOKENS:["0"]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";","uniform","sampler2D","u_luminance",";","uniform","sampler2D","u_average_lum",";","uniform","float","u_bloom_edge_lum",";","uniform","float","u_bloom_key",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hl","=","GLSL_TEXTURE","(","u_average_lum",",","vec2","(","0.5",")",")",".","r",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hl","=","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:["float","hm","=","GLSL_TEXTURE","(","u_luminance",",","A",")",".","r",";","vec4","aQ","=","GLSL_TEXTURE","(","u_main",",","A",")",";","float","hn","=","hm","/","hl",";","float","ho","=","u_bloom_edge_lum",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","u_bloom_key","*","smoothstep","(","ho",",","ho","+","1.2",",","hn",")",";","}"]}]},e["postprocessing/motion_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_mb_tex_curr",";","uniform","sampler2D","u_mb_tex_accum",";","uniform","float","u_motion_blur_exp",";","uniform","float","u_motion_blur_decay_threshold",";","float","hp","=","0.0042",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hq","=","GLSL_TEXTURE","(","u_mb_tex_curr",",","A",")",";","vec4","hr","=","GLSL_TEXTURE","(","u_mb_tex_accum",",","A",")",";","if","(","length","(","hq","-","hr",")",">","u_motion_blur_decay_threshold",")","{","vec4","hs","=","(","1.0","-","u_motion_blur_exp",")","*","hq","+","u_motion_blur_exp","*","hr",";","vec4","ht","=","hs","-","hr",";","vec4","hu","=","hq","-","hr",";","vec4","cX","=","min","(","max","(","abs","(","ht",")",",","vec4","(","hp",")",")",",","abs","(","hu",")",")","*","sign","(","ht",")",";","GLSL_OUT_FRAG_COLOR","=","hr","+","cX",";","}","else","{","GLSL_OUT_FRAG_COLOR","=","hq",";","}","}"]}]},e["postprocessing/outline.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_outline_src",";","uniform","sampler2D","u_outline_mask",";","uniform","sampler2D","u_outline_mask_blurred",";","uniform","vec3","u_outline_color",";","uniform","float","u_draw_outline",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hv","=","GLSL_TEXTURE","(","u_outline_src",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","hv",";","if","(","u_draw_outline","!=","0.0",")","{","vec4","hw","=","GLSL_TEXTURE","(","u_outline_mask",",","A",")",";","vec4","hx","=","GLSL_TEXTURE","(","u_outline_mask_blurred",",","A",")",";","float","hy","=","hx",".","a","-","hw",".","a",";","if","(","hy","!=","0.0",")","{","float","hz","=","smoothstep","(","0.0",",","1.0",",","hx",".","a",")",";","if","(","hw",".","a","==","0.0",")","{","vec3","hA","=","u_outline_color",";","aW","(","hA",")",";","vec4","hB","=","vec4","(","clamp","(","hA",",","0.0",",","1.0",")",",","1.0",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hv",",","hB",",","hz",")",";","}","}","}","}"]}]},e["postprocessing/performance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","vec4","(","0.0",")",";","for","(","int","cq","=","0",";","cq","<","10",";","cq","++",")","{","vec2","hC","=","vec2","(","fract","(","A","*","vec2","(","cq",")","*","vec2","(","1.431",",","3.921",")",")",")",";","aQ","+=","0.01","*","GLSL_TEXTURE","(","u_color",",","hC",")",";","}","GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["postprocessing/postprocessing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"POST_EFFECT",TOKENS:["POST_EFFECT_NONE"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec2","u_texel_size",";","uniform","sampler2D","u_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_tex_number",";","uniform","vec2","u_delta",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","A",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","dx","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","vec3","(","(","dx",".","r","+","dx",".","g","+","dx",".","b",")","/","3.0",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","1.0",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","0.2270270270",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1945945946",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1945945946",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1216216216",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1216216216",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0540540541",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0540540541",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0162162162",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0162162162",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.152507",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.141763",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.141763",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.113861",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.113861",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.079019",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.079019",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.047383",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.047383",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.024549",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.024549",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.01099",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.01099",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00425",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00425",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00142",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00142",";","GLSL_OUT_FRAG_COLOR","=","clamp","(","GLSL_OUT_FRAG_COLOR",",","0.0",",","1.0",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","vec4","hD",";","vec4","hE",";","float","gD",";","float","hF","=","u_dof_bokeh_intensity",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","hD","=","aQ",";","hE","=","aQ",";","gD","=","aQ",".","a",";","cX","=","gD","*","cX",";","for","(","int","cq","=","0",";","cq","<","12",";","cq","+=","2",")","{","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hD","+=","aQ",";","hE","=","max","(","hE",",","aQ",")",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hD","+=","aQ",";","hE","=","max","(","hE",",","aQ",")",";","}","hD","/=","13.0",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hD",",","hE",",","hF",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","vec4","hD",";","vec4","hE",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","hE","=","max","(","hE",",","aQ",")",";","hD","=","aQ",";","hD",".","a","=","aQ",".","a","*","0.2270270270",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1945945946",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1945945946",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1216216216",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1216216216",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0540540541",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0540540541",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0162162162",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0162162162",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hD",",","hE",",","0.5",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_EXTEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cX","=","u_texel_size",";","vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ",";","if","(","aQ",".","a","==","0.0",")","{","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","cX",")",";","if","(","aQ",".","a",">","0.0",")","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","aQ",".","a",")",";","else","{","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","cX",")",";","if","(","aQ",".","a",">","0.0",")","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","aQ",".","a",")",";","}","}"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hG","=","u_delta","[","0","]",";","float","hH","=","u_delta","[","1","]",";","float","hI","=","1.0","/","3.0",";","float","hJ","=","0.5",";","vec2","hK","=","vec2","(","hI",",","hJ",")",";","if","(","u_tex_number","==","0",")","{","vec2","ce","=","mat2","(","0.0",",","-","1.0",",","1.0",",","0.0",")","*","A","*","hK","+","vec2","(","2.0","*","hI",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","2.0","*","hI","+","hG",")",";","ce","[","1","]","=","max","(","ce","[","1","]",",","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","ce","[","0","]",",","hJ","-","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","1",")","{","vec2","ce","=","mat2","(","0.0",",","-","1.0",",","1.0",",","0.0",")","*","A","*","hK","+","vec2","(","0.0",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","hJ","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","hI","-","ce","[","0","]",",","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","2",")","{","vec2","ce","=","A","*","hK","+","vec2","(","2.0","*","hI",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","2.0","*","hI","+","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","1.0","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","ce","[","0","]",",","1.5","-","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","3",")","{","vec2","ce","=","A","*","hK","+","vec2","(","hI",",","0.0",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hI","+","hG",")",";","ce","[","0","]","=","min","(","ce","[","0","]",",","2.0","*","hI","-","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","hJ","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","1.0","-","ce","[","0","]",",","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","4",")","{","vec2","ce","=","A","*","hK","+","vec2","(","hI",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hI","+","hG",")",";","ce","[","0","]","=","min","(","ce","[","0","]",",","2.0","*","hI","-","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","1.0","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","ce","[","0","]",",","3.0","*","hJ","-","ce","[","1","]",")",")",";","}","else","{","vec2","ce","=","A","*","hK","+","vec2","(","0.0",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","1.0","-","hH",")",";","ce","[","1","]","=","max","(","ce","[","1","]",",","hJ","+","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","hI","-","ce","[","0","]",",","ce","[","1","]",")",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/postprocessing.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_position",";","GLSL_OUT","vec2","A",";","void","main","(",")","{","A","=","2.0","*","a_position",";","gl_Position","=","vec4","(","4.0","*","(","a_position",".","xy","-","0.25",")",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/precompute_brdf.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";","precision","PRECISION","float",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","float","eb","(","int","cw",",","int","dY",")","{","float","dZ","=","1.0","/","float","(","dY",")",";","float","d_","=","1.0",";","float","ea","=","0.0",";","for","(","int","cq","=","0",";","cq","<","32",";","++","cq",")","{","if","(","cw",">","0",")","{","d_","=","mod","(","float","(","cw",")",",","2.0",")",";","ea","+=","d_","*","dZ",";","dZ","=","dZ","/","2.0",";","cw","=","int","(","float","(","cw",")","/","2.0",")",";","}","}","return","ea",";","}","vec2","ed","(","int","cq",",","int","ec",")","{","return","vec2","(","float","(","cq",")","/","float","(","ec",")",",","eb","(","cq",",","2",")",")",";","}","vec3","ek","(","vec2","ee",",","vec3","ec",",","float","ef",")","{","float","a","=","ef","*","ef",";","float","bC","=","2.0","*","M_PI","*","ee",".","x",";","float","eg","=","sqrt","(","(","1.0","-","ee",".","y",")","/","(","1.0","+","(","a","*","a","-","1.0",")","*","ee",".","y",")",")",";","float","eh","=","sqrt","(","1.0","-","eg","*","eg",")",";","vec3","ei",";","ei",".","x","=","cos","(","bC",")","*","eh",";","ei",".","y","=","sin","(","bC",")","*","eh",";","ei",".","z","=","eg",";","vec3","by","=","abs","(","ec",".","z",")","<","0.999","?","vec3","(","0.0",",","0.0",",","1.0",")",":","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","V","=","normalize","(","cross","(","by",",","ec",")",")",";","vec3","ej","=","cross","(","ec",",","V",")",";","vec3","bF","=","V","*","ei",".","x","+","ej","*","ei",".","y","+","ec","*","ei",".","z",";","return","normalize","(","bF",")",";","}","float","hO","(","float","hL",",","float","ef",")","{","float","a","=","ef",";","float","hM","=","(","a","*","a",")","/","2.0",";","float","hN","=","hL",";","float","d_","=","hL","*","(","1.0","-","hM",")","+","hM",";","return","hN","/","d_",";","}","float","hR","(","vec3","ec",",","vec3","en",",","vec3","eq",",","float","ef",")","{","float","hL","=","max","(","dot","(","ec",",","en",")",",","0.0",")",";","float","er","=","max","(","dot","(","ec",",","eq",")",",","0.0",")",";","float","hP","=","hO","(","hL",",","ef",")",";","float","hQ","=","hO","(","er",",","ef",")",";","return","hQ","*","hP",";","}","vec2","hY","(","float","hL",",","float","ef",")","{","vec3","en",";","en",".","x","=","sqrt","(","1.0","-","hL","*","hL",")",";","en",".","y","=","0.0",";","en",".","z","=","hL",";","float","cG","=","0.0",";","float","hS","=","0.0",";","vec3","ec","=","vec3","(","0.0",",","0.0",",","1.0",")",";","const","int","eo","=","1024",";","for","(","int","cq","=","0",";","cq","<","eo",";","++","cq",")","{","vec2","ee","=","ed","(","cq",",","eo",")",";","vec3","ei","=","ek","(","ee",",","ec",",","ef",")",";","vec3","eq","=","normalize","(","2.0","*","dot","(","en",",","ei",")","*","ei","-","en",")",";","float","er","=","max","(","eq",".","z",",","0.0",")",";","float","hT","=","max","(","ei",".","z",",","0.0",")",";","float","hU","=","max","(","dot","(","en",",","ei",")",",","0.0",")",";","if","(","er",">","0.0",")","{","float","hV","=","hR","(","ec",",","en",",","eq",",","ef",")",";","float","hW","=","(","hV","*","hU",")","/","(","hT","*","hL",")",";","float","hX","=","pow","(","1.0","-","hU",",","5.0",")",";","cG","+=","(","1.0","-","hX",")","*","hW",";","hS","+=","hX","*","hW",";","}","}","cG","/=","float","(","eo",")",";","hS","/=","float","(","eo",")",";","return","vec2","(","cG",",","hS",")",";","}","void","main","(",")","{","vec2","hZ","=","hY","(","A",".","x",",","A",".","y",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","hZ",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/smaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"SMAA_REPROJECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_PREDICATION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["0"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_ULTRA"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_prev",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_blend",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2},"SMAA_PREDICATION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_search_tex",";","uniform","sampler2D","u_area_tex",";","uniform","vec4","u_subsample_indices",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","h_",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","ia",";","GLSL_IN","vec4","ib",";","GLSL_IN","vec4","ic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","id",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.15"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["8"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.05"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["16"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_DEPTH_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_DEPTH_THRESHOLD",TOKENS:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["8"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_CORNER_ROUNDING",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_THRESHOLD",TOKENS:["0.01"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_SCALE",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_STRENGTH",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_STRENGTH",TOKENS:["0.4"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_REPROJECTION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",TOKENS:["30.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}}]},{TYPE:"define",NAME:"SMAA_AREATEX_MAX_DISTANCE",TOKENS:["16"]},{TYPE:"define",NAME:"SMAA_AREATEX_MAX_DISTANCE_DIAG",TOKENS:["20"]},{TYPE:"define",NAME:"SMAA_AREATEX_PIXEL_SIZE",TOKENS:["(","1.0","/","vec2","(","160.0",",","560.0",")",")"]},{TYPE:"define",NAME:"SMAA_AREATEX_SUBTEX_SIZE",TOKENS:["(","1.0","/","7.0",")"]},{TYPE:"define",NAME:"SMAA_SEARCHTEX_SIZE",TOKENS:["vec2","(","66.0",",","33.0",")"]},{TYPE:"define",NAME:"SMAA_SEARCHTEX_PACKED_SIZE",TOKENS:["vec2","(","64.0",",","16.0",")"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING_NORM",TOKENS:["(","float","(","SMAA_CORNER_ROUNDING",")","/","100.0",")"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ii","(","vec2","ce",",","sampler2D","ie",")","{","float","p","=","GLSL_TEXTURE","(","ie",",","ce",")",".","r",";","float","ig","=","GLSL_TEXTURE","(","ie",",","ia",".","xy",")",".","r",";","float","ih","=","GLSL_TEXTURE","(","ie",",","ia",".","zw",")",".","r",";","return","vec3","(","p",",","ig",",","ih",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","im","(","vec2","ce",",","sampler2D","ij",")","{","vec3","ik","=","ii","(","ce",",","ij",")",";","vec2","cX","=","abs","(","ik",".","xx","-","ik",".","yz",")",";","vec2","il","=","step","(","SMAA_PREDICATION_THRESHOLD",",","cX",")",";","return","SMAA_PREDICATION_SCALE","*","SMAA_THRESHOLD","*","(","1.0","-","SMAA_PREDICATION_STRENGTH","*","il",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","ir","(","bvec2","io",",","inout","vec2","ip",",","vec2","iq",")","{","if","(","io",".","x",")","ip",".","x","=","iq",".","x",";","if","(","io",".","y",")","ip",".","y","=","iq",".","y",";","}","void","ir","(","bvec4","io",",","inout","vec4","ip",",","vec4","iq",")","{","ir","(","io",".","xy",",","ip",".","xy",",","iq",".","xy",")",";","ir","(","io",".","zw",",","ip",".","zw",",","iq",".","zw",")",";","}","vec2","is","(","vec2","x",")","{","return","sign","(","x",")","*","floor","(","abs","(","x",")","+",".5",")",";","}","vec4","is","(","vec4","x",")","{","return","sign","(","x",")","*","floor","(","abs","(","x",")","+",".5",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iE","(","vec2","ce",",","sampler2D","it"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ij"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iu","=","im","(","ce",",","ij",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iu","=","vec2","(","SMAA_THRESHOLD",",","SMAA_THRESHOLD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","iv","=","vec3","(","0.2126",",","0.7152",",","0.0722",")",";","float","eq","=","dot","(","GLSL_TEXTURE","(","it",",","ce",")",".","rgb",",","iv",")",";","float","iw","=","dot","(","GLSL_TEXTURE","(","it",",","ia",".","xy",")",".","rgb",",","iv",")",";","float","ix","=","dot","(","GLSL_TEXTURE","(","it",",","ia",".","zw",")",".","rgb",",","iv",")",";","vec4","cX",";","cX",".","xy","=","abs","(","eq","-","vec2","(","iw",",","ix",")",")",";","vec2","il","=","step","(","iu",",","cX",".","xy",")",";","if","(","dot","(","il",",","vec2","(","1.0",",","1.0",")",")","==","0.0",")","discard",";","float","iy","=","dot","(","GLSL_TEXTURE","(","it",",","ib",".","xy",")",".","rgb",",","iv",")",";","float","iz","=","dot","(","GLSL_TEXTURE","(","it",",","ib",".","zw",")",".","rgb",",","iv",")",";","cX",".","zw","=","abs","(","eq","-","vec2","(","iy",",","iz",")",")",";","vec2","iA","=","max","(","cX",".","xy",",","cX",".","zw",")",";","float","iB","=","dot","(","GLSL_TEXTURE","(","it",",","ic",".","xy",")",".","rgb",",","iv",")",";","float","iC","=","dot","(","GLSL_TEXTURE","(","it",",","ic",".","zw",")",".","rgb",",","iv",")",";","cX",".","zw","=","abs","(","vec2","(","iw",",","ix",")","-","vec2","(","iB",",","iC",")",")",";","iA","=","max","(","iA",".","xy",",","cX",".","zw",")",";","float","iD","=","max","(","iA",".","x",",","iA",".","y",")",";","il",".","xy","*=","step","(","iD",",","SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR","*","cX",".","xy",")",";","return","il",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iG","(","vec2","iF",")","{","iF",".","r","=","iF",".","r","*","abs","(","5.0","*","iF",".","r","-","5.0","*","0.75",")",";","return","is","(","iF",")",";","}","vec4","iG","(","vec4","iF",")","{","iF",".","rb","=","iF",".","rb","*","abs","(","5.0","*","iF",".","rb","-","5.0","*","0.75",")",";","return","is","(","iF",")",";","}","vec2","iI","(","sampler2D","iH",",","vec2","ce",",","vec2","bH",",","out","vec2","iF",")","{","vec4","f_","=","vec4","(","ce",",","-","1.0",",","1.0",")",";","vec3","t","=","vec3","(","u_texel_size",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS_DIAG",";","cq","++",")","{","if","(","f_",".","z","<","float","(","SMAA_MAX_SEARCH_STEPS_DIAG","-","1",")","&&","f_",".","w",">","0.9",")","{","f_",".","xyz","+=","t","*","vec3","(","bH",",","1.0",")",";","iF","=","GLSL_TEXTURE","(","iH",",","f_",".","xy",",","0.0",")",".","rg",";","f_",".","w","=","dot","(","iF",",","vec2","(","0.5",",","0.5",")",")",";","}","}","return","f_",".","zw",";","}","vec2","iJ","(","sampler2D","iH",",","vec2","ce",",","vec2","bH",",","out","vec2","iF",")","{","vec4","f_","=","vec4","(","ce",",","-","1.0",",","1.0",")",";","f_",".","x","+=","0.25","*","u_texel_size",".","x",";","vec3","t","=","vec3","(","u_texel_size",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS_DIAG",";","cq","++",")","{","if","(","f_",".","z","<","float","(","SMAA_MAX_SEARCH_STEPS_DIAG","-","1",")","&&","f_",".","w",">","0.9",")","{","f_",".","xyz","=","t","*","vec3","(","bH",",","1.0",")","+","f_",".","xyz",";","iF","=","GLSL_TEXTURE","(","iH",",","f_",".","xy",",","0.0",")",".","rg",";","iF","=","iG","(","iF",")",";","f_",".","w","=","dot","(","iF",",","vec2","(","0.5",",","0.5",")",")",";","}","}","return","f_",".","zw",";","}","vec2","iL","(","sampler2D","iK",",","vec2","aM",",","vec2","iF",",","float","fM",")","{","vec2","ce","=","vec2","(","SMAA_AREATEX_MAX_DISTANCE_DIAG",",","SMAA_AREATEX_MAX_DISTANCE_DIAG",")","*","iF","+","aM",";","ce","=","SMAA_AREATEX_PIXEL_SIZE","*","ce","+","0.5","*","SMAA_AREATEX_PIXEL_SIZE",";","ce",".","x","+=","0.5",";","ce",".","y","+=","SMAA_AREATEX_SUBTEX_SIZE","*","fM",";","return","GLSL_TEXTURE","(","iK",",","ce",",","0.0",")",".","rg",";","}","vec2","iQ","(","sampler2D","iH",",","sampler2D","iK",",","vec2","ce",",","vec2","iF",",","vec4","iM",")","{","vec2","iv","=","vec2","(","0.0",",","0.0",")",";","vec4","dC",";","vec2","iN",";","if","(","iF",".","r",">","0.0",")","{","dC",".","xz","=","iI","(","iH",",","ce",",","vec2","(","-","1.0",",","1.0",")",",","iN",")",";","dC",".","x","+=","float","(","iN",".","y",">","0.9",")",";","}","else","dC",".","xz","=","vec2","(","0.0",",","0.0",")",";","dC",".","yw","=","iI","(","iH",",","ce",",","vec2","(","1.0",",","-","1.0",")",",","iN",")",";","if","(","dC",".","x","+","dC",".","y",">","2.0",")","{","vec4","iO","=","vec4","(","-","dC",".","x","+","0.25",",","dC",".","x",",","dC",".","y",",","-","dC",".","y","-","0.25",")","*","u_texel_size",".","xyxy","+","ce",".","xyxy",";","vec4","dx",";","dx",".","xy","=","GLSL_TEXTURE","(","iH",",","iO",".","xy","+","u_texel_size","*","vec2","(","-","1",",","0",")",",","0.0",")",".","rg",";","dx",".","zw","=","GLSL_TEXTURE","(","iH",",","iO",".","zw","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","rg",";","dx",".","yxwz","=","iG","(","dx",".","xyzw",")",";","vec2","iP","=","vec2","(","2.0",",","2.0",")","*","dx",".","xz","+","dx",".","yw",";","ir","(","bvec2","(","step","(","0.9",",","dC",".","zw",")",")",",","iP",",","vec2","(","0.0",",","0.0",")",")",";","iv","+=","iL","(","iK",",","dC",".","xy",",","iP",",","iM",".","z",")",";","}","dC",".","xz","=","iJ","(","iH",",","ce",",","vec2","(","-","1",",","-","1",")",",","iN",")",";","if","(","GLSL_TEXTURE","(","iH",",","ce","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","r",">","0.0",")","{","dC",".","yw","=","iJ","(","iH",",","ce",",","vec2","(","1",",","1",")",",","iN",")",";","dC",".","y","+=","float","(","iN",".","y",">","0.9",")",";","}","else","dC",".","yw","=","vec2","(","0.0",",","0.0",")",";","if","(","dC",".","x","+","dC",".","y",">","2.0",")","{","vec4","iO","=","vec4","(","-","dC",".","x",",","-","dC",".","x",",","dC",".","y",",","dC",".","y",")","*","u_texel_size",".","xyxy","+","ce",".","xyxy",";","vec4","dx",";","dx",".","x","=","GLSL_TEXTURE","(","iH",",","iO",".","xy","+","u_texel_size","*","vec2","(","-","1",",","0",")",",","0.0",")",".","g",";","dx",".","y","=","GLSL_TEXTURE","(","iH",",","iO",".","xy","+","u_texel_size","*","vec2","(","0",",","-","1",")",",","0.0",")",".","r",";","dx",".","zw","=","GLSL_TEXTURE","(","iH",",","iO",".","zw","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","gr",";","vec2","iP","=","vec2","(","2.0",",","2.0",")","*","dx",".","xz","+","dx",".","yw",";","ir","(","bvec2","(","step","(","0.9",",","dC",".","zw",")",")",",","iP",",","vec2","(","0",",","0",")",")",";","iv","+=","iL","(","iK",",","dC",".","xy",",","iP",",","iM",".","w",")",".","gr",";","}","return","iv",";","}"]}]}}]},{TYPE:"txt",TOKENS:["float","iT","(","sampler2D","iR",",","vec2","iF",",","float","fM",")","{","vec2","hK","=","SMAA_SEARCHTEX_SIZE","*","vec2","(","0.5",",","-","1.0",")",";","vec2","iS","=","SMAA_SEARCHTEX_SIZE","*","vec2","(","fM",",","1.0",")",";","hK","+=","vec2","(","-","1.0",",","1.0",")",";","iS","+=","vec2","(","0.5",",","-","0.5",")",";","hK","*=","1.0","/","SMAA_SEARCHTEX_PACKED_SIZE",";","iS","*=","1.0","/","SMAA_SEARCHTEX_PACKED_SIZE",";","return","GLSL_TEXTURE","(","iR",",","hK","*","iF","+","iS",",","0.0",")",".","r",";","}","float","iU","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","0.0",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","x",">","iN","&&","iF",".","g",">","0.8281","&&","iF",".","r","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","-","vec2","(","2.0",",","0.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",",","0.0",")","+","3.25",";","return","u_texel_size",".","x","*","fM","+","ce",".","x",";","}","float","iV","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","0.0",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","x","<","iN","&&","iF",".","g",">","0.8281","&&","iF",".","r","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","vec2","(","2.0",",","0.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",",","0.5",")","+","3.25",";","return","-","u_texel_size",".","x","*","fM","+","ce",".","x",";","}","float","iW","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","1.0",",","0.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","y",">","iN","&&","iF",".","r",">","0.8281","&&","iF",".","g","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","-","vec2","(","0.0",",","2.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",".","gr",",","0.0",")","+","3.25",";","return","u_texel_size",".","y","*","fM","+","ce",".","y",";","}","float","iX","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","1.0",",","0.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","y","<","iN","&&","iF",".","r",">","0.8281","&&","iF",".","g","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","vec2","(","0.0",",","2.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",".","gr",",","0.5",")","+","3.25",";","return","-","u_texel_size",".","y","*","fM","+","ce",".","y",";","}","vec2","i_","(","sampler2D","iK",",","vec2","aM",",","float","iY",",","float","iZ",",","float","fM",")","{","vec2","ce","=","vec2","(","SMAA_AREATEX_MAX_DISTANCE",",","SMAA_AREATEX_MAX_DISTANCE",")","*","is","(","4.0","*","vec2","(","iY",",","iZ",")",")","+","aM",";","ce","=","SMAA_AREATEX_PIXEL_SIZE","*","ce","+","0.5","*","SMAA_AREATEX_PIXEL_SIZE",";","ce",".","y","=","SMAA_AREATEX_SUBTEX_SIZE","*","fM","+","ce",".","y",";","return","GLSL_TEXTURE","(","iK",",","ce",",","0.0",")",".","rg",";","}","void","jc","(","sampler2D","iH",",","inout","vec2","iv",",","vec4","ce",",","vec2","dC",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ja","=","step","(","dC",".","xy",",","dC",".","yx",")",";","vec2","jb","=","(","1.0","-","SMAA_CORNER_ROUNDING_NORM",")","*","ja",";","jb","/=","ja",".","x","+","ja",".","y",";","vec2","aL","=","vec2","(","1.0",",","1.0",")",";","aL",".","x","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","0",",","1",")",",","0.0",")",".","r",";","aL",".","x","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","1",",","1",")",",","0.0",")",".","r",";","aL",".","y","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","0",",","-","2",")",",","0.0",")",".","r",";","aL",".","y","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","1",",","-","2",")",",","0.0",")",".","r",";","iv","*=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","jd","(","sampler2D","iH",",","inout","vec2","iv",",","vec4","ce",",","vec2","dC",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ja","=","step","(","dC",".","xy",",","dC",".","yx",")",";","vec2","jb","=","(","1.0","-","SMAA_CORNER_ROUNDING_NORM",")","*","ja",";","jb","/=","ja",".","x","+","ja",".","y",";","vec2","aL","=","vec2","(","1.0",",","1.0",")",";","aL",".","x","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","g",";","aL",".","x","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","1",",","1",")",",","0.0",")",".","g",";","aL",".","y","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","-","2",",","0",")",",","0.0",")",".","g",";","aL",".","y","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","-","2",",","1",")",",","0.0",")",".","g",";","iv","*=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jg","(","vec2","ce",",","vec2","je",",","sampler2D","iH",",","sampler2D","iK",",","sampler2D","iR",",","vec4","iM",")","{","vec4","iv","=","vec4","(","0.0",",","0.0",",","0.0",",","0.0",")",";","vec2","iF","=","GLSL_TEXTURE","(","iH",",","ce",")",".","rg",";","if","(","iF",".","g",">","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["iv",".","rg","=","iQ","(","iH",",","iK",",","ce",",","iF",",","iM",")",";","if","(","iv",".","r","==","-","iv",".","g",")","{"]}]}}]},{TYPE:"txt",TOKENS:["vec2","dC",";","vec3","iO",";","iO",".","x","=","iU","(","iH",",","iR",",","ia",".","xy",",","ic",".","x",")",";","iO",".","y","=","ib",".","y",";","dC",".","x","=","iO",".","x",";","float","iY","=","GLSL_TEXTURE","(","iH",",","iO",".","xy",",","0.0",")",".","r",";","iO",".","z","=","iV","(","iH",",","iR",",","ia",".","zw",",","ic",".","y",")",";","dC",".","y","=","iO",".","z",";","dC","=","abs","(","is","(","dC","/","u_texel_size",".","xx","-","je",".","xx",")",")",";","vec2","jf","=","sqrt","(","dC",")",";","float","iZ","=","GLSL_TEXTURE","(","iH",",","iO",".","zy","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","r",";","iv",".","rg","=","i_","(","iK",",","jf",",","iY",",","iZ",",","iM",".","y",")",";","iO",".","y","=","ce",".","y",";","jc","(","iH",",","iv",".","rg",",","iO",".","xyzy",",","dC",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["}","else","iF",".","r","=","0.0",";"]}]}}]},{TYPE:"txt",TOKENS:["}","if","(","iF",".","r",">","0.0",")","{","vec2","dC",";","vec3","iO",";","iO",".","y","=","iW","(","iH",",","iR",",","ib",".","xy",",","ic",".","z",")",";","iO",".","x","=","ia",".","x",";","dC",".","x","=","iO",".","y",";","float","iY","=","GLSL_TEXTURE","(","iH",",","iO",".","xy",",","0.0",")",".","g",";","iO",".","z","=","iX","(","iH",",","iR",",","ib",".","zw",",","ic",".","w",")",";","dC",".","y","=","iO",".","z",";","dC","=","abs","(","is","(","dC","/","u_texel_size",".","yy","-","je",".","yy",")",")",";","vec2","jf","=","sqrt","(","dC",")",";","float","iZ","=","GLSL_TEXTURE","(","iH",",","iO",".","xz","+","u_texel_size","*","vec2","(","0",",","1",")",",","0.0",")",".","g",";","iv",".","ba","=","i_","(","iK",",","jf",",","iY",",","iZ",",","iM",".","x",")",";","iO",".","x","=","ce",".","x",";","jd","(","iH",",","iv",".","ba",",","iO",".","xyxz",",","dC",")",";","}","return","iv",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jp","(","vec2","ce",",","sampler2D","it",",","sampler2D","jh"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ji"]}]}}]},{TYPE:"txt",TOKENS:[")","{","vec4","a",";","a",".","x","=","GLSL_TEXTURE","(","jh",",","h_",".","xy",")",".","a",";","a",".","y","=","GLSL_TEXTURE","(","jh",",","h_",".","zw",")",".","g",";","a",".","wz","=","GLSL_TEXTURE","(","jh",",","ce",")",".","xz",";","if","(","dot","(","a",",","vec4","(","1.0",",","1.0",",","1.0",",","1.0",")",")","<","1e-5",")","{","vec4","aQ","=","GLSL_TEXTURE","(","it",",","ce",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jj","=","GLSL_TEXTURE","(","ji",",","A",")",";","vec2","dp","=","2.0","*","jk","(","jj",")","-","1.0",";","aQ",".","a","=","sqrt","(","2.0","*","length","(","dp",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}","else","{","bool","co","=","max","(","a",".","x",",","a",".","z",")",">","max","(","a",".","y",",","a",".","w",")",";","vec4","jl","=","vec4","(","0.0",",","a",".","y",",","0.0",",","a",".","w",")",";","vec2","jm","=","a",".","yw",";","ir","(","bvec4","(","co",",","co",",","co",",","co",")",",","jl",",","vec4","(","a",".","x",",","0.0",",","a",".","z",",","0.0",")",")",";","ir","(","bvec2","(","co",",","co",")",",","jm",",","a",".","xz",")",";","jm","/=","dot","(","jm",",","vec2","(","1.0",",","1.0",")",")",";","vec4","jn","=","jl","*","vec4","(","u_texel_size",",","-","u_texel_size",")","+","ce",".","xyxy",";","vec4","aQ","=","jm",".","x","*","GLSL_TEXTURE","(","it",",","jn",".","xy",",","0.0",")",";","aQ","+=","jm",".","y","*","GLSL_TEXTURE","(","it",",","jn",".","zw",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jj","=","GLSL_TEXTURE","(","ji",",","jn",".","xy",")",";","vec2","jo","=","2.0","*","jk","(","jj",")","-","1.0",";","vec2","dp","=","jm",".","x","*","jo",";","jj","=","GLSL_TEXTURE","(","ji",",","jn",".","zw",")",";","jo","=","2.0","*","jk","(","jj",")","-","1.0",";","dp","+=","jm",".","y","*","jo",";","aQ",".","a","=","sqrt","(","2.0","*","length","(","dp",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","ju","(","vec2","ce",",","sampler2D","jq",",","sampler2D","jr"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ji"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jj","=","GLSL_TEXTURE","(","ji",",","A",")",";","vec2","dp",";","dp","=","2.0","*","jk","(","jj",")","-","1.0",";","vec4","js","=","GLSL_TEXTURE","(","jq",",","ce",")",";","vec4","jt","=","GLSL_TEXTURE","(","jr",",","ce","-","dp",")",";","float","cX","=","abs","(","js",".","a","*","js",".","a","-","jt",".","a","*","jt",".","a",")","/","2.0",";","float","cu","=","0.5","*","clamp","(","1.0","-","sqrt","(","cX",")","*","SMAA_REPROJECTION_WEIGHT_SCALE",",","0.0",",","1.0",")",";","vec4","aQ","=","mix","(","js",",","jt",",","cu",")",";","aQ",".","a","=","1.0",";","return","aQ",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","js","=","GLSL_TEXTURE","(","jq",",","ce",")",";","vec4","jt","=","GLSL_TEXTURE","(","jr",",","ce",")",";","return","mix","(","js",",","jt",",","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","vec4","(","iE","(","A",",","u_color"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_predication_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",",","0.0",",","0.0",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","jg","(","A",",","id",",","u_color",",","u_area_tex",",","u_search_tex",",","u_subsample_indices",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","jp","(","A",",","u_color",",","u_blend"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","vec4","(","ju","(","A",",","u_color",",","u_color_prev"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["postprocessing/smaa.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_LOW"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","PRECISION","vec2","u_texel_size",";","GLSL_IN","vec2","a_position",";","GLSL_OUT","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","h_",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","ia",";","GLSL_OUT","vec4","ib",";","GLSL_OUT","vec4","ic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","id",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["4"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["8"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["32"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jv","(","vec2","ce",")","{","ia","=","u_texel_size",".","xyxy","*","vec4","(","-","1.0",",","0.0",",","0.0",",","-","1.0",")","+","ce",".","xyxy",";","ib","=","u_texel_size",".","xyxy","*","vec4","(","1.0",",","0.0",",","0.0",",","1.0",")","+","ce",".","xyxy",";","ic","=","u_texel_size",".","xyxy","*","vec4","(","-","2.0",",","0.0",",","0.0",",","-","2.0",")","+","ce",".","xyxy",";","}"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jw","(","vec2","ce",",","out","vec2","je",")","{","je","=","ce","/","u_texel_size",";","ia","=","u_texel_size",".","xyxy","*","vec4","(","-","0.25",",","-","0.125",",","1.25",",","-","0.125",")","+","ce",".","xyxy",";","ib","=","u_texel_size",".","xyxy","*","vec4","(","-","0.125",",","-","0.25",",","-","0.125",",","1.25",")","+","ce",".","xyxy",";","ic","=","u_texel_size",".","xxyy","*","vec4","(","-","2.0",",","2.0",",","-","2.0",",","2.0",")","*","float","(","SMAA_MAX_SEARCH_STEPS",")","+","vec4","(","ia",".","xz",",","ib",".","yw",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jx","(","vec2","ce",")","{","h_","=","u_texel_size",".","xyxy","*","vec4","(","1.0",",","0.0",",","0.0",",","1.0",")","+","ce",".","xyxy",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","A","=","2.0","*","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jv","(","A",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jw","(","A",",","id",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jx","(","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","vec4","(","4.0","*","(","a_position",".","xy","-","0.25",")",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/ssao.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_WHITE",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_QUALITY",TOKENS:["SSAO_QUALITY_8"]},{TYPE:"var",NAME:"SSAO_HEMISPHERE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","sampler2D","u_depth",";","uniform","sampler2D","u_ssao_special_tex",";","uniform","vec2","u_camera_range",";","uniform","vec2","u_texel_size",";","uniform","float","u_ssao_radius_increase",";","uniform","float","u_ssao_influence",";","uniform","float","u_ssao_dist_factor",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","float","jy","(","in","vec2","f_",")","{","return","gC","(","u_depth",",","f_",",","u_camera_range",")",";","}","void","main","(",")","{","vec3","gG","=","GLSL_TEXTURE","(","u_color",",","A",")",".","rgb",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_WHITE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","gG",",","1.0",")",";","return",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","jz","=","normalize","(","2.0","*","GLSL_TEXTURE","(","u_ssao_special_tex",",","A","*","0.25","/","u_texel_size",")",".","rgb","-","1.0",")",";","float","et","=","jy","(","A",")",";","float","jA","=","et","*","(","u_camera_range",".","y","-","u_camera_range",".","x",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","8.0",";","const","int","jC","=","1",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","16.0",";","const","int","jC","=","2",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_24",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","24.0",";","const","int","jC","=","3",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_32",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","32.0",";","const","int","jC","=","4",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jD","=","u_ssao_radius_increase","*","0.001",";","const","float","jE","=","1.0","+","2.4","/","jB",";","float","jF","=","0.0",";","for","(","int","cq","=","0",";","cq","<","jC",";","cq","++",")","for","(","int","x","=","-","1",";","x","<=","1",";","x","+=","2",")","for","(","int","y","=","-","1",";","y","<=","1",";","y","+=","2",")","for","(","int","z","=","-","1",";","z","<=","1",";","z","+=","2",")","{","vec3","jG","=","reflect","(","normalize","(","vec3","(","x",",","y",",","z",")",")",",","jz",")","*","(","jD","*=","jE",")",";","vec3","jH","=","vec3","(","A",",","jA",")",";","jH","+=","vec3","(","jG",".","xy",",","jG",".","z","*","jA","*","2.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jH",".","z","-=","1.4","*","(","jH",".","z","-","jA",")","*","step","(","jA",",","jH",".","z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jI","=","jy","(","jH",".","xy",")","*","(","u_camera_range",".","y","-","u_camera_range",".","x",")",";","float","jJ","=","clamp","(","(","jA","-","jI",")","/","jI",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","+=","mix","(","1.0",",","jJ",",","step","(","jI",",","jH",".","z",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","+=","mix","(","step","(","jH",".","z",",","jI",")",",","0.5",",","jJ",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","jF","=","jF","/","jB",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","=","clamp","(","jF","*","jF","+","0.6","*","jF",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","=","clamp","(","jF","*","jF","+","jF",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jK","=","u_ssao_influence","*","(","1.0","-","u_ssao_dist_factor","*","et",")",";","jF","=","mix","(","1.0",",","jF",",","jK",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","gG",",","jF",")",";","}"]}]},e["postprocessing/ssao_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_BLUR_DEPTH",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_ssao_mask",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","vec2","u_camera_range",";","uniform","float","u_ssao_blur_discard_value",";","float","jy","(","in","vec2","f_",")","{","return","gC","(","u_depth",",","f_",",","u_camera_range",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","float","jL","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","jM","=","jy","(","A",")",";","float","cu","=","0.0",";","float","jN","=","u_ssao_blur_discard_value","*","100.0",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","jO","=","vec2","(","-","2.0",")",";","for","(","int","cq","=","0",";","cq","<","4",";","++","cq",")","{","for","(","int","jP","=","0",";","jP","<","4",";","++","jP",")","{","vec2","fM","=","(","jO","+","vec2","(","float","(","cq",")",",","float","(","jP",")",")",")","*","u_texel_size",";","float","jQ","=","GLSL_TEXTURE","(","u_ssao_mask",",","A","+","fM",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","jR","=","jy","(","A","+","fM",")",";","float","jS","=","1.0","-","clamp","(","abs","(","jR","-","jM",")","*","jN",",","0.0",",","1.0",")",";","jL","+=","jQ","*","jS",";","cu","+=","jS",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jL","+=","jQ",";"]}]}}]},{TYPE:"txt",TOKENS:["}","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","GLSL_TEXTURE","(","u_ssao_mask",",","A",")",".","rgb",",","jL","/","cu",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","GLSL_TEXTURE","(","u_ssao_mask",",","A",")",".","rgb",",","jL","/","16.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/stereo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANAGLYPH",TOKENS:["0"]},{TYPE:"var",NAME:"SIDEBYSIDE",TOKENS:["0"]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"DISTOR_SCALE",TOKENS:["0.8"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler_left",";","uniform","sampler2D","u_sampler_right",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH",{TYPE:"logic_negative_expr",PLACES:1},"SIDEBYSIDE",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_enable_hmd_stereo",";","uniform","vec4","u_distortion_params",";","uniform","vec4","u_chromatic_aberration_coefs",";","void","ka","(","vec2","ce",",","vec2","ao",",","float","di",",","sampler2D","jT",")","{","vec2","bD","=","(","ce","-","ao",")","*","4.0","*","u_texel_size","[","0","]","/","u_texel_size","[","1","]","/","di",";","float","jU","=","bD",".","x","*","bD",".","x","+","bD",".","y","*","bD",".","y",";","vec2","jV","=","bD","*","(","1.0","+","u_distortion_params","[","0","]","*","jU","+","u_distortion_params","[","1","]","*","jU","*","jU",")",";","vec2","jW","=","jV","*","0.5","/","(","1.0","+","u_distortion_params","[","0","]","+","u_distortion_params","[","1","]",")",";","if","(","length","(","u_chromatic_aberration_coefs",")",">","0.0",")","{","vec2","jX","=","jW","*","(","1.0","+","u_chromatic_aberration_coefs","[","0","]","+","jU","*","u_chromatic_aberration_coefs","[","1","]",")","+","0.5",";","vec2","jY","=","jW","+","0.5",";","vec2","jZ","=","jW","*","(","1.0","+","u_chromatic_aberration_coefs","[","2","]","+","jU","*","u_chromatic_aberration_coefs","[","3","]",")","+","0.5",";","if","(","clamp","(","jZ",",","0.0",",","1.0",")","!=","jZ",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","0.0",")",";","}","else","{","vec4","j_","=","GLSL_TEXTURE","(","jT",",","jY",")",";","GLSL_OUT_FRAG_COLOR","[","0","]","=","GLSL_TEXTURE","(","jT",",","jX",")",".","x",";","GLSL_OUT_FRAG_COLOR","[","1","]","=","j_",".","y",";","GLSL_OUT_FRAG_COLOR","[","2","]","=","GLSL_TEXTURE","(","jT",",","jZ",")",".","z",";","GLSL_OUT_FRAG_COLOR","[","3","]","=","j_",".","w",";","}","}","else","{","jW","+=","0.5",";","if","(","clamp","(","jW",",","0.0",",","1.0",")","!=","jW",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","0.0",")",";","}","else","{","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","jT",",","jW",")",";","}","}","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","kb","=","GLSL_TEXTURE","(","u_sampler_left",",","A",")",";","vec4","kc","=","GLSL_TEXTURE","(","u_sampler_right",",","A",")",";","vec3","kd","=","vec3","(","kb","[","0","]",",","kb","[","1","]",",","kb","[","2","]",")",";","bG","(","kd",")",";","vec3","ke","=","vec3","(","kc","[","0","]",",","kc","[","1","]",",","kc","[","2","]",")",";","bG","(","ke",")",";","mat3","kf","=","mat3","(","0.437",",","-","0.062",",","-","0.048",",","0.449",",","-","0.062",",","-","0.050",",","0.164",",","-","0.024",",","-","0.017",")",";","mat3","bz","=","mat3","(","-","0.011",",","0.377",",","-","0.026",",","-","0.032",",","0.761",",","-","0.093",",","-","0.007",",","0.009",",","1.234",")",";","vec3","aQ","=","clamp","(","kf","*","kd",",","0.0",",","1.0",")","+","clamp","(","bz","*","ke",",","0.0",",","1.0",")",";","aW","(","aQ",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","kb","[","3","]","+","kc","[","3","]",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SIDEBYSIDE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","A","[","0","]","<","0.5",")","{","vec2","ce","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","ce",")",";","}","else","{","vec2","ce","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_right",",","ce",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_enable_hmd_stereo","!=","0",")","{","if","(","abs","(","u_distortion_params","[","0","]",")",">","EPSILON","||","abs","(","u_distortion_params","[","1","]",")",">","EPSILON",")","if","(","A","[","0","]","<","0.5",")","{","vec2","ce","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","vec2","ao","=","vec2","(","0.5","-","(","u_distortion_params","[","3","]","-","0.5",")","/","2.0",",","u_distortion_params","[","2","]",")",";","float","di","=","2.0","*","u_distortion_params","[","3","]","*","DISTOR_SCALE",";","ka","(","ce",",","ao",",","di",",","u_sampler_left",")",";","}","else","{","vec2","ce","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","vec2","ao","=","vec2","(","0.5","+","(","u_distortion_params","[","3","]","-","0.5",")","/","2.0",",","u_distortion_params","[","2","]",")",";","float","di","=","2.0","*","u_distortion_params","[","3","]","*","DISTOR_SCALE",";","ka","(","ce",",","ao",",","di",",","u_sampler_right",")",";","}","else","if","(","A","[","0","]","<","0.5",")","{","vec2","ce","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","ce",")",";","}","else","{","vec2","ce","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_right",",","ce",")",";","}","}","else","{","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","A",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/velocity.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","mat4","u_view_proj_inverse",";","uniform","mat4","u_view_proj_prev",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","float","et","=","GLSL_TEXTURE","(","u_depth",",","A",")",".","x",";","vec4","kg","=","vec4","(","A","*","2.0","-","1.0",",","2.0","*","et","-","1.0",",","1.0",")",";","vec4","cD","=","u_view_proj_inverse","*","kg",";","vec4","kh","=","cD","/","cD",".","w",";","vec4","ki","=","u_view_proj_prev","*","kh",";","ki","/=","ki",".","w",";","vec2","dp","=","(","kg",".","xy","-","ki",".","xy",")","/","4.0","+","0.5",";","dp","=","clamp","(","dp",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR","=","eu","(","dp",")",";","}"]}]},e["include/blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"BLENDING_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec3","kj","(","vec3","rgb",")","{","vec4","hM","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hM",".","wz",")",",","vec4","(","rgb",".","gb",",","hM",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dC","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iF","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dC","+","iF",")",")",",","dC","/","(","q",".","x","+","iF",")",",","q",".","x",")",";","}","vec3","kl","(","vec3","kk",")","{","vec4","hM","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kk",".","r",",","kk",".","r",",","kk",".","r",")","+","hM",".","xyz",")","*","6.0","-","hM",".","www",")",";","return","kk",".","b","*","mix","(","hM",".","xxx",",","clamp","(","p","-","hM",".","xxx",",","_0_0",",","_1_0",")",",","kk",".","g",")",";","}","vec3","kp","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","km",",","kn",",","ko",")",";","}","vec3","kq","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","ko","*","km","+","kn",";","}","vec3","kr","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","kn","-","ko","*","km",";","}","vec3","kt","(","vec3","km",",","vec3","kn",",","float","ko",")","{","float","ks","=","_1_0","-","ko",";","return","(","vec3","(","ks",")","+","ko","*","km",")","*","kn",";","}","vec3","ku","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","ks","=","vec3","(","_1_0","-","ko",")",";","return","vec3","(","_1_0",")","-","(","ks","+","ko","*","(","vec3","(","_1_0",")","-","km",")",")","*","(","vec3","(","_1_0",")","-","kn",")",";","}","vec3","kv","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","ks","=","vec3","(","_1_0","-","ko",")",";","return","mix","(","kn","*","(","ks","+","2.0","*","ko","*","km",")",",","vec3","(","_1_0",")","-","(","ks","+","2.0","*","ko","*","(","vec3","(","_1_0",")","-","km",")",")","*","(","vec3","(","_1_0",")","-","kn",")",",","step","(","0.5",",","kn",")",")",";","}","vec3","kw","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","kn",",","abs","(","km","-","kn",")",",","ko",")",";","}","vec3","kx","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","kn",",","kn","/","(","km","+","step","(","km",",","vec3","(","_0_0",")",")",")",",","ko",")",";","}","vec3","ky","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","kn",",","min","(","km",",","kn",")",",","ko",")",";","}","vec3","kz","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","max","(","ko","*","km",",","kn",")",";","}","vec3","kD","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","kn",")",";","if","(","kA",".","y","!=","_0_0",")","{","vec3","kB","=","kj","(","km",")",";","vec3","kC","=","kl","(","vec3","(","kA",".","x",",","kB",".","yz",")",")",";","return","mix","(","km",",","kC",",","ko",")",";","}","return","km",";","}","vec3","kE","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","km",")",";","if","(","kA",".","y","!=","_0_0",")","{","vec3","kB","=","kj","(","kn",")",";","return","kl","(","vec3","(","kA",".","x",",","mix","(","kA",".","y",",","kB",".","y",",","ko",")",",","kA",".","z",")",")",";","}","return","km",";","}","vec3","kF","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","km",")",";","vec3","kB","=","kj","(","kn",")",";","return","kl","(","vec3","(","kA",".","xy",",","mix","(","kA",".","z",",","kB",".","z",",","ko",")",")",")",";","}","vec3","kG","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","kn",")",";","if","(","kA",".","y","!=","_0_0",")","{","vec3","kB","=","kj","(","km",")",";","vec3","kC","=","kl","(","vec3","(","kA",".","xy",",","kB",".","z",")",")",";","return","mix","(","km",",","kC",",","ko",")",";","}","return","km",";","}","vec3","kI","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kH","=","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","kn",")","*","(","vec3","(","_1_0",")","-","km",")",";","return","mix","(","km",",","(","(","vec3","(","_1_0",")","-","km",")","*","kn","*","km",")","+","km","*","kH",",","ko",")",";","}","vec3","kJ","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","km","+","ko","*","(","2.0","*","kn","-","_1_0",")",";","}","float","kN","(","float","kK",",","float","kL",",","float","ko",",","float","kM",")","{","float","ks","=","_1_0","-","kM",";","return","(","ks","+","ko","*","kK",")","*","kL",";","}","float","kO","(","float","kK",",","float","kL",",","float","ko",",","float","kM",")","{","float","ks","=","_1_0","-","kM",";","return","_1_0","-","(","ks","+","ko","*","(","_1_0","-","kK",")",")","*","(","_1_0","-","kL",")",";","}","float","kP","(","float","kK",",","float","kL",",","float","ko",",","float","kM",")","{","float","ks","=","_1_0","-","kM",";","return","mix","(","kL","*","(","ks","+","2.0","*","ko","*","kK",")",",","_1_0","-","(","ks","+","2.0","*","ko","*","(","_1_0","-","kK",")",")","*","(","_1_0","-","kL",")",",","step","(","0.5",",","kL",")",")",";","}"]}]}}]}]},e["include/caustics.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"CAUSTICS_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"CAUSTICS_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"SUN_NUM",TOKENS:["0"]},{TYPE:"var",NAME:"CAUST_SCALE",TOKENS:["0.25"]},{TYPE:"var",NAME:"CAUST_SPEED",TOKENS:["vec2","(","0.0",")"]},{TYPE:"var",NAME:"CAUST_BRIGHT",TOKENS:["0.5"]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"CAUSTICS_VIEW_DISTANCE",TOKENS:["100.0"]},{TYPE:"txt",TOKENS:["void","bV","(","inout","vec3","aQ",",","float","kQ",",","float","fy",",","vec4","bU",",","vec3","U",",","vec3","kR",",","vec3","kS",",","vec4","kT",",","vec3","bt",",","float","bS",")","{","if","(","bS",">","CAUSTICS_VIEW_DISTANCE",")","return",";","vec3","kU","=","bt","+","U",";","kU",".","xz","=","10.0","*","sin","(","0.1","*","kU",".","xz",")",";","vec3","kW","=","T","(","kV","(","kT",")",",","kU",")",";","vec2","ce","=","kW",".","xz",";","vec3","kX","=","kR",";","float","kY","=","max","(","dot","(","U",",","kX",")",",","0.0",")",";","float","kZ","=","0.025",";","vec2","k_","=","CAUST_SPEED","*","fy",";","ce",".","s","+=","0.25","*","sin","(","dot","(","bt","+","fy",",","vec3","(","1.0",")",")",")",";","ce",".","t","+=","0.35","*","(","-","sin","(","dot","(","bt","-","fy",",","vec3","(","-","0.7",")",")",")",")",";","ce",".","st","+=","0.15","*","cos","(","4.0","*","kQ","-","k_",".","x",")","+","1.5","*","sin","(","kQ","-","0.3","*","k_",".","y",")",";","float","hK","=","CAUST_SCALE","*","(","1.0","+","max","(","0.1","*","kQ",",","0.0",")",")",";","vec3","lb","=","la","(","(","ce","/","hK",")",",","kZ",")",";","lb","*=","CAUST_BRIGHT",";","lb","*=","lb",";","float","lc","=","min","(","0.25","*","kQ",",","-","kQ",")","+","1.0",";","lc","=","max","(","lc",",","0.0",")",";","float","ld","=","bU","[","SUN_NUM","]","*","kY",";","float","le","=","max","(","sign","(","kQ",")",",","0.0",")",";","ld","=","ld","+","max","(","0.5","*","sign","(","-","U",".","y",")","*","le",",","0.0",")",";","ld","=","min","(","ld",",","1.0",")",";","aQ","+=","kS","*","lb","*","lc","*","ld",";","}"]}]}}]}]},e["include/color_util.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COLOR_UTIL_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COLOR_UTIL_GLSLF",TOKENS:[""]},{TYPE:"define",NAME:"PREMULTIPLY_ALPHA",TOKENS:["1"]},{TYPE:"var",NAME:"SRGB",TOKENS:["SRGB_NONE"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["void","bG","(","inout","float","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","2.2",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","aQ","<","0.04045",")","aQ","=","aQ","/","12.92",";","else","aQ","=","pow","(","aQ","*","(","1.0","/","1.055",")","+","0.0521327",",","2.4",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aW","(","inout","float","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","1.0","/","2.2",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","aQ","<","0.0031308",")","aQ","=","aQ","*","12.92",";","else","aQ","=","1.055","*","pow","(","aQ",",","1.0","/","2.4",")","-","0.055",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","bG","(","inout","vec3","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","vec3","(","2.2",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bG","(","aQ",".","r",")",";","bG","(","aQ",".","g",")",";","bG","(","aQ",".","b",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aW","(","inout","vec3","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","vec3","(","1.0","/","2.2",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aW","(","aQ",".","r",")",";","aW","(","aQ",".","g",")",";","aW","(","aQ",".","b",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aX","(","inout","vec3","aQ",",","in","float","L",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PREMULTIPLY_ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","aQ","*","L",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","gj","(","vec4","aQ",")","{","vec3","lf","=","vec3","(","0.299",",","0.587",",","0.114",")",";","float","lg","=","dot","(","aQ",".","rgb",",","lf",")",";","return","lg",";","}"]}]}}]}]},e["include/coverage.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COVERAGE_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COVERAGE_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:["const","float","lh","=","1000.0",";","bool","C","(","float","L",",","float","li",")","{","if","(","li","<","0.0",")","L","=","1.0","-","L",";","float","lj","=","floor","(","L","*","lh",")",";","float","ll","=","floor","(","lk","(","gl_FragCoord",".","xy",")","*","lh",")",";","if","(","li",">","0.0",")","return","ll","<","lj",";","else","return","ll",">=","lj",";","}"]}]}}]}]},e["include/depth_fetch.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"DEPTH_FETCH_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DEPTH_FETCH_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","es","(","in","float","lm",",","in","vec2","ln",")","{","float","dG","=","ln",".","x",";","float","lo","=","ln",".","y",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","lo","*","(","1.0","-","dG","/","lm",")","/","(","lo","-","dG",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","(","lm","-","dG",")","/","(","lo","-","dG",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gC","(","in","sampler2D","lp",",","in","vec2","f_",",","in","vec2","ln",")","{","float","et","=","GLSL_TEXTURE","(","lp",",","f_",")",".","r",";","float","dG","=","ln",".","x",";","float","lo","=","ln",".","y",";","float","lm","=","2.0","*","dG","/","(","dG","+","lo","-","(","2.0","*","et","-","1.0",")","*","(","lo","-","dG",")",")",";","return","lm",";","}"]}]}}]}]}}]}]},e["include/dynamic_grass.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"DYNAMIC_GRASS_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DYNAMIC_GRASS_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"GRASS_TEXTURE_SIZE",TOKENS:["1024.0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["vec2","lt","(","vec3","O",",","float","lq",",","vec2","lr",")","{","vec2","ls","=","vec2","(","(","O",".","x","-","lr",".","x",")","/","lq",",","(","O",".","y","-","lr",".","y",")","/","lq",")",";","return","fract","(","ls",")",";","}","vec2","lu","(","vec2","gX",",","float","lq",",","vec2","lr",")","{","return","vec2","(","gX",".","x","*","lq",",","gX",".","y","*","lq",")","+","lr",";","}","au","lv","(",")","{","return","au","(","vec3","(","-","10000.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","lF","(","sampler2D","lw",",","vec2","lx",")","{","float","ly","=","1.0","/","GRASS_TEXTURE_SIZE",";","vec4","lz","=","GLSL_TEXTURE","(","lw",",","lx",")",";","vec4","lA","=","GLSL_TEXTURE","(","lw",",","lx","+","vec2","(","ly",",","0.0",")",")",";","vec4","lB","=","GLSL_TEXTURE","(","lw",",","lx","+","vec2","(","0.0",",","ly",")",")",";","vec4","lC","=","GLSL_TEXTURE","(","lw",",","lx","+","vec2","(","ly",",","ly",")",")",";","float","a","=","fract","(","lx",".","x","*","GRASS_TEXTURE_SIZE",")",";","vec4","lD","=","mix","(","lz",",","lA",",","a",")",";","vec4","lE","=","mix","(","lB",",","lC",",","a",")",";","float","b","=","fract","(","lx",".","y","*","GRASS_TEXTURE_SIZE",")",";","return","mix","(","lD",",","lE",",","b",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["au","be","(","vec3","O",",","vec3","V",",","vec3","lG",",","vec3","W",",","vec3","U",",","vec3","ao",",","PRECISION","sampler2D","lH",",","sampler2D","lI",",","vec3","lJ",",","float","lK",",","vec3","lL",",","vec4","lM",",","mat3","N",",","mat3","Z",")","{","vec3","lN","=","T","(","lM",",","vec3","(","0.0",",","0.0",",","-","1.0",")",")",";","float","lO","=","-","lN",".","x",";","float","lP","=","lN",".","y",";","vec2","lr","=","vec2","(","lL",".","x","-","lK","*","(","1.0","+","lO",")","/","2.0",",","lL",".","y","-","lK","*","(","1.0","-","lP",")","/","2.0",")",";","vec2","lQ","=","lt","(","ao",",","lK",",","lr",")",";","float","lR","=","lK","/","2.0",";","vec2","lS","=","abs","(","lu","(","lQ","-","vec2","(","0.5",")",",","lK",",","vec2","(","0.0",")",")",")",";","float","lT","=","lR","*","(","1.0","+","sqrt","(","2.0",")",")","/","2.0",";","if","(","length","(","lS",")",">","lT",")","return","lv","(",")",";","float","lU","=","lK","/","lJ",".","z",";","vec2","lV","=","(","lQ","-","vec2","(","0.5",")",")","*","lU","+","vec2","(","0.5",")",";","vec3","lW","=","lN","*","(","lK","/","lJ",".","z","-","1.0",")","/","2.0",";","lV",".","x","+=","lW",".","x",";","lV",".","y","+=","lW",".","y",";","vec4","lX","=","GLSL_TEXTURE","(","lI",",","lV",")",";","float","hK","=","lX",".","r",";","if","(","hK","<","u_scale_threshold",")","return","lv","(",")",";","float","lY","=","lJ",".","y","-","lJ",".","x",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cn","=","lJ",".","y","-","(","lF","(","lH",",","lV",")",")",".","r","*","lY",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cn","=","lJ",".","y","-","(","GLSL_TEXTURE","(","lH",",","lV",")",")",".","r","*","lY",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","lZ","=","O",".","xy","-","ao",".","xy",";","ao",".","xy","=","lu","(","lQ",",","lK",",","lr",")",";","ao",".","z","=","cn",";","O",".","xy","=","ao",".","xy","+","lZ",";","O",".","z","*=","hK",";","O",".","z","+=","cn",";","vec3","aQ","=","lX",".","gba",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","-=","ao",";","mat3","l_","=","as","(","lL",",","ao",",","N",",","Z",")",";","au","aw","=","av","(","O",",","ao",",","V",",","lG",",","W",",","U",",","l_",")",";","aw",".","ao","=","ao",";","aw",".","aQ","=","aQ",";","return","ma","(","aw",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ma","(","au","(","O",",","ao",",","V",",","lG",",","W",",","U",",","aQ",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/environment.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"ENVIRONMENT_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"ENVIRONMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["vec3","cE","(","vec3","U",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","U",")",".","rgb",";"]}]}},{TYPE:"elif",EXPRESSION:["SKY_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","mb","=","0.5","*","U",".","z","+","0.5",";","return","mix","(","u_horizon_color",",","u_zenith_color",",","mb",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec3","(","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/fog.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FOG_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FOG_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"FOG_TYPE",TOKENS:["QUADRATIC"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","mg","(","inout","vec3","aQ",",","in","float","mc",",","in","float","cn",",","in","vec4","md",")","{","float","me","=","clamp","(","(","mc","-","u_fog_params",".","z",")","/","u_fog_params",".","y",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOG_TYPE","QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["me","*=","me",";"]}]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","LINEAR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","INVERSE_QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["me","=","sqrt","(","me",")",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","u_fog_params",".","w",">","0.0",")","{","if","(","cn",">","u_fog_params",".","w",")","me","=","0.0",";","else","{","float","mf","=","(","u_fog_params",".","w","-","max","(","cn",",","0.0",")",")","/","u_fog_params",".","w",";","me","*=","mf","*","mf",";","}","}","md",".","a","=","1.0","-","(","1.0","-","me",")","*","(","1.0","-","u_fog_params",".","x",")",";","aQ","=","mix","(","aQ",",","md",".","rgb",",","md",".","a",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ml","(","in","mat4","mh",",","in","vec3","D",")","{","vec3","mi","=","mix","(","mh","[","0","]",".","rgb",",","mh","[","1","]",".","rgb",",","(","D",".","x","+","1.0",")","/","2.0",")",";","vec3","mj","=","mix","(","mh","[","2","]",".","rgb",",","mh","[","3","]",".","rgb",",","(","D",".","y","+","1.0",")","/","2.0",")",";","vec3","mk","=","vec3","(","mh","[","0","]",".","a",",","mh","[","1","]",".","a",",","mh","[","2","]",".","a",")",";","vec3","aQ","=","mix","(","mi",",","mj",",","abs","(","D",".","y",")",")",";","aQ","=","mix","(","aQ",",","mk",",","abs","(","D",".","z",")",")",";","bG","(","aQ",")",";","return","aQ",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","mn","(","inout","float","mm",")","{","mm","-=","0.5",";","mm","=","4.0","*","(","mm","*","mm","*","mm",")","+","0.5",";","}","void","mt","(","inout","vec3","aQ",",","in","float","mc",",","in","vec3","D",",","in","float","eG",",","in","vec4","mo",",","in","float","fp",")","{","float","mp","=","max","(","D",".","z",",","0.0",")",";","float","mq","=","max","(","mc","-","max","(","eG","/","mp",",","0.0",")",",","0.0",")",";","float","mr","=","mo",".","w","*","mq",";","vec3","eH","=","vec3","(","0.0",",","0.02",",","0.05",")",";","vec3","ms","=","mo",".","rgb",";","mr","=","min","(","mr",",","1.0",")",";","mn","(","mr",")",";","mr","*=","clamp","(","2.0","-","fp",",","0.0",",","1.0",")",";","vec3","eI","=","mix","(","ms",",","eH",",","min","(","mp",",","1.0",")",")",";","eG","=","clamp","(","-","eG","*","0.03",",","0.0",",","0.8",")",";","eI","*=","1.0","-","eG",";","aQ","=","mix","(","aQ",",","eI",",","mr",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","bW","(","inout","vec3","aQ",",","float","mc",",","vec3","D",",","float","bT",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","mh","=","ml","(","u_cube_fog",",","D",")",";","vec4","eI","=","vec4","(","mh",",","u_fog_color_density",".","a",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","eI","=","u_fog_color_density",";"]}]}}]},{TYPE:"txt",TOKENS:["mg","(","aQ",",","mc",",","h",".","z",",","eI",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mt","(","aQ",",","mc",",","D",",","u_cam_water_depth",",","u_underwater_fog_color_density",",","bT",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/fxaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"FXAA_BLEND4WEB",TOKENS:["1"]},{TYPE:"var",NAME:"FXAA_QUALITY_P12",TOKENS:["0.0"]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PS3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PS3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360_OPT",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360_OPT",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC_CONSOLE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC_CONSOLE",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_120",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_120",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_130",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_130",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_4",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_5",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GREEN_AS_LUMA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_EARLY_EXIT",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_EARLY_EXIT",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_DISCARD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_DISCARD",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_EXT_gpu_shader4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_HLSL_5",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["4.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["2.0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.125"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.25"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_QUALITY_PRESET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",10,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",11,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",12,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",13,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",14,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",15,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",20,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",21,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",22,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",23,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",24,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",25,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",26,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["9"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",27,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["10"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",28,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["11"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",29,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",39,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["float","mu","(","float","x",")","{","return","clamp","(","x",",","0.0",",","1.0",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","mv","(","sampler2D","t",",","vec2","p",")","{","return","GLSL_TEXTURE","(","t",",","p",")",";","}","vec4","mx","(","sampler2D","t",",","vec2","p",",","vec2","mw",",","vec2","r",")","{","return","GLSL_TEXTURE","(","t",",","p","+","(","mw","*","r",")",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec4","gz","(","vec2","fr",",","sampler2D","ie",",","vec2","my",",","float","mz",",","float","mA",",","float","mB",")","{","vec2","mC",";","mC",".","x","=","fr",".","x",";","mC",".","y","=","fr",".","y",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","mD","=","mv","(","ie",",","mC",")",";","float","gk","=","gj","(","mD",")",";","float","mE","=","gj","(","mx","(","ie",",","mC",",","vec2","(","0",",","1",")",",","my",".","xy",")",")",";","float","mF","=","gj","(","mx","(","ie",",","mC",",","vec2","(","1",",","0",")",",","my",".","xy",")",")",";","float","mG","=","gj","(","mx","(","ie",",","mC",",","vec2","(","0",",","-","1",")",",","my",".","xy",")",")",";","float","mH","=","gj","(","mx","(","ie",",","mC",",","vec2","(","-","1",",","0",")",",","my",".","xy",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","mI","=","max","(","mE",",","gk",")",";","float","mJ","=","min","(","mE",",","gk",")",";","float","mK","=","max","(","mF",",","mI",")",";","float","mL","=","min","(","mF",",","mJ",")",";","float","mM","=","max","(","mG",",","mH",")",";","float","mN","=","min","(","mG",",","mH",")",";","float","mO","=","max","(","mM",",","mK",")",";","float","mP","=","min","(","mN",",","mL",")",";","float","mQ","=","mO","*","mA",";","float","mR","=","mO","-","mP",";","float","mS","=","max","(","mB",",","mQ",")",";","bool","mT","=","mR","<","mS",";","if","(","mT",")","return","mD",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gl","=","gj","(","mx","(","ie",",","mC",",","vec2","(","-","1",",","-","1",")",",","my",".","xy",")",")",";","float","go","=","gj","(","mx","(","ie",",","mC",",","vec2","(","1",",","1",")",",","my",".","xy",")",")",";","float","gm","=","gj","(","mx","(","ie",",","mC",",","vec2","(","1",",","-","1",")",",","my",".","xy",")",")",";","float","gn","=","gj","(","mx","(","ie",",","mC",",","vec2","(","-","1",",","1",")",",","my",".","xy",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[]}}]},{TYPE:"txt",TOKENS:["float","mU","=","mG","+","mE",";","float","mV","=","mH","+","mF",";","float","mW","=","1.0","/","mR",";","float","mX","=","mU","+","mV",";","float","mY","=","(","-","2.0","*","gk",")","+","mU",";","float","mZ","=","(","-","2.0","*","gk",")","+","mV",";","float","m_","=","gm","+","go",";","float","na","=","gl","+","gm",";","float","nb","=","(","-","2.0","*","mF",")","+","m_",";","float","nc","=","(","-","2.0","*","mG",")","+","na",";","float","nd","=","gl","+","gn",";","float","ne","=","gn","+","go",";","float","nf","=","(","abs","(","mY",")","*","2.0",")","+","abs","(","nb",")",";","float","ng","=","(","abs","(","mZ",")","*","2.0",")","+","abs","(","nc",")",";","float","nh","=","(","-","2.0","*","mH",")","+","nd",";","float","ni","=","(","-","2.0","*","mE",")","+","ne",";","float","nj","=","abs","(","nh",")","+","nf",";","float","nk","=","abs","(","ni",")","+","ng",";","float","nl","=","nd","+","m_",";","float","nm","=","my",".","x",";","bool","nn","=","nj",">=","nk",";","float","no","=","mX","*","2.0","+","nl",";","if","(","!","nn",")","mG","=","mH",";","if","(","!","nn",")","mE","=","mF",";","if","(","nn",")","nm","=","my",".","y",";","float","np","=","(","no","*","(","1.0","/","12.0",")",")","-","gk",";","float","nq","=","mG","-","gk",";","float","nr","=","mE","-","gk",";","float","ns","=","mG","+","gk",";","float","nt","=","mE","+","gk",";","bool","nu","=","abs","(","nq",")",">=","abs","(","nr",")",";","float","nv","=","max","(","abs","(","nq",")",",","abs","(","nr",")",")",";","if","(","nu",")","nm","=","-","nm",";","float","nw","=","mu","(","abs","(","np",")","*","mW",")",";","vec2","nx",";","nx",".","x","=","mC",".","x",";","nx",".","y","=","mC",".","y",";","vec2","ny",";","ny",".","x","=","(","!","nn",")","?","0.0",":","my",".","x",";","ny",".","y","=","(","nn",")","?","0.0",":","my",".","y",";","if","(","!","nn",")","nx",".","x","+=","nm","*","0.5",";","if","(","nn",")","nx",".","y","+=","nm","*","0.5",";","vec2","nz",";","nz",".","x","=","nx",".","x","-","ny",".","x","*","FXAA_QUALITY_P0",";","nz",".","y","=","nx",".","y","-","ny",".","y","*","FXAA_QUALITY_P0",";","vec2","nA",";","nA",".","x","=","nx",".","x","+","ny",".","x","*","FXAA_QUALITY_P0",";","nA",".","y","=","nx",".","y","+","ny",".","y","*","FXAA_QUALITY_P0",";","float","nB","=","(","(","-","2.0",")","*","nw",")","+","3.0",";","float","nC","=","gj","(","mv","(","ie",",","nz",")",")",";","float","nD","=","nw","*","nw",";","float","nE","=","gj","(","mv","(","ie",",","nA",")",")",";","if","(","!","nu",")","ns","=","nt",";","float","nF","=","nv","*","1.0","/","4.0",";","float","nG","=","gk","-","ns","*","0.5",";","float","nH","=","nB","*","nD",";","bool","nI","=","nG","<","0.0",";","nC","-=","ns","*","0.5",";","nE","-=","ns","*","0.5",";","bool","nJ","=","abs","(","nC",")",">=","nF",";","bool","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P1",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P1",";","bool","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P1",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P1",";","if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P2",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P2",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P2",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P2",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P3",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P3",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P3",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P3",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",4,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P4",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P4",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P4",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P4",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",5,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P5",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P5",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P5",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P5",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",6,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P6",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P6",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P6",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P6",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",7,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P7",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P7",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P7",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P7",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",8,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P8",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P8",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P8",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P8",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",9,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P9",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P9",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P9",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P9",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",10,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P10",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P10",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P10",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P10",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",11,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P11",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P11",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P11",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P11",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",12,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P12",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P12",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P12",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P12",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}","float","nM","=","mC",".","x","-","nz",".","x",";","float","nN","=","nA",".","x","-","mC",".","x",";","if","(","!","nn",")","nM","=","mC",".","y","-","nz",".","y",";","if","(","!","nn",")","nN","=","nA",".","y","-","mC",".","y",";","bool","nO","=","(","nC","<","0.0",")","!=","nI",";","float","nP","=","(","nN","+","nM",")",";","bool","nQ","=","(","nE","<","0.0",")","!=","nI",";","float","nR","=","1.0","/","nP",";","bool","nS","=","nM","<","nN",";","float","nT","=","min","(","nM",",","nN",")",";","bool","nU","=","nS","?","nO",":","nQ",";","float","nV","=","nH","*","nH",";","float","nW","=","(","nT","*","(","-","nR",")",")","+","0.5",";","float","nX","=","nV","*","mz",";","float","nY","=","nU","?","nW",":","0.0",";","float","nZ","=","max","(","nY",",","nX",")",";","if","(","!","nn",")","mC",".","x","+=","nZ","*","nm",";","if","(","nn",")","mC",".","y","+=","nZ","*","nm",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_DISCARD",1,{TYPE:"equal_expr",PLACES:2},"FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","mv","(","ie",",","mC",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec4","(","mv","(","ie",",","mC",")",".","xyz",",","gk",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/halo_color.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"HALO_COLOR_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"HALO_COLOR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"NUM_RINGS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LINES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","int","n_","=","NUM_RINGS",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","int","n_","=","NUM_LINES",";"]}]}}]},{TYPE:"txt",TOKENS:["float","oa","(","float","x",")","{","return","x","-","floor","(","x","*","(","1.0","/","0.01",")",")","*","0.01",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","oh","(","inout","float","ob",",","in","float","oc","[","n_","]",",","in","float","od",")","{","for","(","int","a","=","0",";","a","<","NUM_RINGS",";","a","++",")","{","float","oe","=","40.0","*","oc","[","a","]",";","float","of","=","300.0","*","(","oa","(","oe",")","-","0.005",")",";","float","og","=","oe",";","float","me","=","abs","(","og","*","(","u_halo_size","*","of","-","od",")",")",";","ob","+=","1.0","-","min","(","me",",","1.0",")",";","}","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","om","(","inout","float","oi",",","in","float","oc","[","n_","]",",","in","float","aM",")","{","for","(","int","a","=","0",";","a","<","NUM_LINES",";","a","++",")","{","float","oj","=","oc","[","a","]",";","float","ok","=","oj",";","float","ol","=","1000.0","*","(","oa","(","oj",")","-","0.005",")",";","float","me","=","20.0","*","abs","(","ok","*","A",".","x","+","ol","*","A",".","y",")",";","oi","+=","1.0","-","min","(","me",",","1.0",")",";","}","oi","*=","aM",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","oq","(","inout","float","aM",",","in","vec2","ce",")","{","float","on",",","bP",";","bP","=","atan","(","ce",".","y",",","ce",".","x",")",";","bP","*=","(","1.0","+","0.25","*","float","(","NUM_STARS",")",")",";","float","oo","=","cos","(","bP",")",";","float","op","=","sin","(","bP",")",";","bP","=","(","oo","*","ce",".","x","+","op","*","ce",".","y",")","*","(","oo","*","ce",".","y","-","op","*","ce",".","x",")",";","on","=","abs","(","bP",")",";","if","(","on","<","1.0",")","{","on","=","(","0.01","*","u_halo_size",")","/","(","on",")",";","aM","*=","sqrt","(","min","(","on",",","1.0",")",")",";","}","}","vec4","bl","(",")","{","float","aM","=","(","A",".","x","*","A",".","x","+","A",".","y","*","A",".","y",")",";","float","od","=","sqrt","(","aM",")",";","aM","=","max","(","1.0","-","aM",",","0.0",")",";","aM","=","pow","(","aM",",","u_halo_hardness",")",";","float","L","=","u_diffuse_color",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","oc","[","n_","]",";","for","(","int","cq","=","0",";","cq","<","n_",";","cq","++",")","{","oc","[","cq","]","=","fract","(","bk","/","float","(","cq","+","1",")",")","-","1.0",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","ob","=","0.0",";","oh","(","ob",",","oc",",","od",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","oi","=","0.0",";","om","(","oi",",","oc",",","aM",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["oq","(","aM",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aM","*=","L",";","vec3","aQ","=","u_diffuse_color",".","rgb",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ob","*=","aM",";","aQ","+=","u_halo_rings_color","*","ob",";","aM","+=","ob",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["oi","*=","L",";","aQ","+=","u_halo_lines_color","*","oi",";","aM","+=","oi",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aM","*=","max","(","1.0","-","2.0","*","u_sun_intensity",".","x",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","lc","=","u_halo_stars_blend","*","(","bj",".","y","-","u_halo_stars_height",")",";","aM","*=","clamp","(","lc",",","0.0",",","1.0",")",";","aM","*=","min","(","u_cam_water_depth","+","2.0","*","WAVES_HEIGHT",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec4","or","=","vec4","(","aQ",",","aM",")",";","return","or",";","}"]}]}}]}]},e["include/lighting_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"LIGHTING_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"LIGHTING_NODES_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"node",NAME:"LIGHTING_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"oF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oJ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oK",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oL",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oM",QUALIFIER:["vec4"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oN",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oO",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["oF","=","os",";","oG","=","ot",";","oH","=","ou",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oI"],STATEMENTS:[{TYPE:"txt",TOKENS:["oI","=","ov",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["oJ","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oL"],STATEMENTS:[{TYPE:"txt",TOKENS:["oL","=","oz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oK"],STATEMENTS:[{TYPE:"txt",TOKENS:["oK","=","oA",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oM"],STATEMENTS:[{TYPE:"txt",TOKENS:["oM","=","oB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oN"],STATEMENTS:[{TYPE:"txt",TOKENS:["oN","=","oC",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oO"],STATEMENTS:[{TYPE:"txt",TOKENS:["oO","=","oD",";"]}]}]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec4","(","oP","+","oR","*","oQ",",","_0_0",")",";","oT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oW","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oX","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","oU","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oZ","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oV","=","oZ","-","ow",";","float","aM","=","length","(","oV",")",";","float","o_","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oV","=","normalize","(","oV",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pa","=","u_light_directions","[","LAMP_IND","]",";","float","pb","=","dot","(","oV",",","pa",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","o_","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["o_","*=","max","(","LAMP_LIGHT_DIST","-","aM",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]},{TYPE:"txt",TOKENS:["oX","*=","o_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oV","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pc",",","B",".","xyz",")",";","pe","=","cross","(","pi",",","B",".","xyz",")",";","pe","=","-","normalize","(","pe",")",";"]}]}]},{TYPE:"txt",TOKENS:["ph","=","_0_0",";","if","(","pd",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pf",")","*","dot","(","pe",",","pc",")","+","pf",";","if","(","pg","[","0","]","==","_0_0",")","{","ph","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pj",")",";","t","=","pg","[","1","]","+","(","_1_0","-","pg","[","1","]",")","*","pow","(","t",",","pg","[","0","]",")",";","ph","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","ph","=","max","(","ph",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pk",",","B",".","xyz",")",";","pm","=","cross","(","pi",",","B",".","xyz",")",";","pm","=","-","normalize","(","pm",")",";"]}]}]},{TYPE:"txt",TOKENS:["po","=","_0_0",";","if","(","pl",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pn",")","*","dot","(","pm",",","pk",")","+","pn",";","po","=","max","(","pj",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pr",",","B",".","xyz",")",";","pv","=","cross","(","pi",",","B",".","xyz",")",";","pv","=","-","normalize","(","pv",")",";"]}]}]},{TYPE:"txt",TOKENS:["py","=","_0_0",";","if","(","pu",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pw",")","*","dot","(","pv",",","pr",")","+","pw",";","if","(","px","[","0","]",">","_0_0",")","{","float","pz","=","max","(","dot","(","pv",",","oy",")",",","_0_0",")",";","float","pA","=","px","[","0","]","*","px","[","0","]",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","pr","-","pj","*","pv",";","vec3","pC","=","oy","-","pz","*","pv",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","py","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","py","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","py","=","pj",";","py","=","max","(","py",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pH",",","B",".","xyz",")",";","pJ","=","cross","(","pi",",","B",".","xyz",")",";","pJ","=","-","normalize","(","pJ",")",";"]}]}]},{TYPE:"txt",TOKENS:["pM","=","_0_0",";","if","(","pI",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pK",")","*","dot","(","pJ",",","pH",")","+","pK",";","float","pz","=","max","(","dot","(","pJ",",","oy",")",",","_0_0",")",";","if","(","pL","[","0","]","<=","_1_0",")","pM","=","pj","*","pow","(","max","(","pz","*","pj",",","0.1",")",",","pL","[","0","]","-","_1_0",")",";","else","pM","=","pj","*","pow","(","1.0001","-","pz",",","pL","[","0","]","-","_1_0",")",";","pM","=","max","(","pM",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pN",",","B",".","xyz",")",";","pP","=","cross","(","pi",",","B",".","xyz",")",";","pP","=","-","normalize","(","pP",")",";"]}]}]},{TYPE:"txt",TOKENS:["pS","=","_0_0",";","if","(","pO",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pQ",")","*","dot","(","pP",",","pN",")","+","pQ",";","float","pT","=","acos","(","pj",")",";","if","(","pT","<","pR","[","0","]",")","pS","=","_1_0",";","else","if","(","pT",">","(","pR","[","0","]","+","pR","[","1","]",")","||","pR","[","1","]","==","_0_0",")","pS","=","_0_0",";","else","pS","=","_1_0","-","(","(","pT","-","pR","[","0","]",")","/","pR","[","1","]",")",";","pS","=","max","(","pS",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","_0_0",";","if","(","pV",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","pU","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pX","==","_0_0",")","{","pZ","=","dot","(","B",".","xyz",",","p_",")",";","pZ","=","sqrt","(","_1_0","-","pZ","*","pZ",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","(","_1_0","-","pX",")","*","max","(","dot","(","pW",",","p_",")",",","_0_0",")","+","pX",";"]}]}]},{TYPE:"txt",TOKENS:["pZ","=","pow","(","pZ",",","pY","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","_0_0",";","if","(","qb",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qa","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","qd","==","_0_0",")","{","qf","=","dot","(","B",".","xyz",",","p_",")",";","qf","=","sqrt","(","_1_0","-","qf","*","qf",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","max","(","dot","(","qc",",","p_",")",",","_0_0",")",";","qf","=","(","_1_0","-","qd",")","*","qf","+","qd",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","B",".","xyz",",","oy",")",",","_0_0",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","qc",",","oy",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qf","=","pow","(","qf",",","qe","[","0","]",")",";","qf","=","qf","/","(","0.1","+","pz",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ql","=","_0_0",";","if","(","qh",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qg","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","float","pz","=","_0_0",";","float","qn","=","_0_0",";","if","(","qj","==","_0_0",")","{","qm","=","dot","(","B",".","xyz",",","p_",")",";","pz","=","dot","(","B",".","xyz",",","oy",")",";","qn","=","dot","(","B",".","xyz",",","qg",")",";","qm","=","sqrt","(","_1_0","-","qm","*","qm",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";","qn","=","sqrt","(","_1_0","-","qn","*","qn",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","max","(","dot","(","qi",",","p_",")",",","0.01",")",";","float","pz","=","max","(","dot","(","qi",",","oy",")",",","0.01",")",";","float","qn","=","max","(","dot","(","qi",",","qg",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bP","=","tan","(","acos","(","qm",")",")",";","float","L","=","max","(","qk","[","0","]",",","0.01",")",";","ql","=","qn","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bP","*","bP",")","/","(","L","*","L",")",")","/","(","sqrt","(","pz","*","qn",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qx","=","_0_0",";","if","(","qr",".","g","!=","_0_0",")","{","vec3","co","=","normalize","(","qo","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qy","=","dot","(","co",",","B",".","xyz",")",";","float","bP","=","qw","[","0","]","+","qw","[","1","]",";","if","(","qv","==","_0_0",")","bP","=","acos","(","sqrt","(","_1_0","-","qy","*","qy",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bP","=","acos","(","dot","(","co",",","qu",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bP","<","qw","[","0","]",")","qx","=","_1_0",";","else","if","(","bP",">=","qw","[","0","]","+","qw","[","1","]","||","qw","[","1","]","==","_0_0",")","qx","=","_0_0",";","else","qx","=","_1_0","-","(","bP","-","qw","[","0","]",")","/","qw","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qF","=","qD","[","0","]",";","float","qG","=","qD","[","1","]",";","qE","=","_0_0",";","if","(","qA",".","g","!=","_0_0",")","{","if","(","qF","<","1.0","||","qG","==","_0_0",")","qE","=","_0_0",";","else","{","if","(","qG","<","100.0",")","qG","=","sqrt","(","1.0","/","qG",")",";","else","qG","=","10.0","/","qG",";","vec3","p_","=","normalize","(","oy","+","qz",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","0.0",";","if","(","qC","==","_0_0",")","{","float","qH","=","dot","(","B",".","xyz",",","p_",")",";","qm","=","sqrt","(","_1_0","-","qH","*","qH",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","(","_1_0","-","qC",")","*","max","(","dot","(","qB",",","p_",")",",","_0_0",")","+","qC",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qm","<","_0_0",")","qE","=","_0_0",";","else","{","float","pz","=","max","(","dot","(","qB",",","oy",")",",","0.01",")",";","float","qn","=","dot","(","qB",",","qz",")",";","if","(","qn","<=","0.01",")","qE","=","_0_0",";","else","{","float","qI","=","max","(","dot","(","oy",",","p_",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qm","*","pz",")","/","qI",";","float","dx","=","(","2.0","*","qm","*","qn",")","/","qI",";","float","g","=","min","(","min","(","a",",","b",")",",","dx",")",";","float","p","=","sqrt","(","pow","(","qF",",","2.0",")","+","pow","(","qI",",","2.0",")","-","_1_0",")",";","float","mm","=","pow","(","p","-","qI",",","2.0",")","/","pow","(","p","+","qI",",","2.0",")","*","(","_1_0","+","pow","(","qI","*","(","p","+","qI",")","-","_1_0",",","2.0",")","/","pow","(","qI","*","(","p","-","qI",")","+","_1_0",",","2.0",")",")",";","float","pT","=","acos","(","qm",")",";","qE","=","max","(","mm","*","g","*","exp","(","-","pow","(","pT",",","2.0",")","/","(","2.0","*","pow","(","qG",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qV","=","qK","+","qS","*","qR","*","qM",";","qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qW",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","qW",".","rgb",";","oE","=","qX",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","cP","(","vec3","os",",","vec3","ot",",","vec3","ou",",","vec3","ov",",","vec3","ow",",","vec3","ox",",","vec3","oy",",","vec2","oz",",","vec2","oA",",","vec4","oB",",","float","oC",",","vec4","oD",",","out","vec3","E",",","out","vec3","oE",")","{"]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/math.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MATH_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MATH_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["struct","au","{","vec3","O",";","vec3","ao",";","vec3","V",";","vec3","aB",";","vec3","W",";","vec3","U",";","vec3","aQ",";","}",";","bool","qY","(","vec3","a",",","vec3","b",")","{","return","any","(","lessThan","(","abs","(","a","-","b",")",",","vec3","(","EPSILON",")",")",")",";","}","vec3","T","(","in","vec4","q",",","in","vec3","kU",")","{","return","kU","+","2.0","*","cross","(","q",".","xyz",",","cross","(","q",".","xyz",",","kU",")","+","q",".","w","*","kU",")",";","}","vec4","kV","(","in","vec4","qZ",")","{","return","vec4","(","-","qZ",".","xyz",",","qZ",".","w",")",";","}","vec4","rc","(","in","vec4","a",",","in","vec4","b",")","{","vec4","q_",";","q_",".","x","=","a",".","x","*","b",".","w","+","a",".","w","*","b",".","x","+","a",".","y","*","b",".","z","-","a",".","z","*","b",".","y",";","q_",".","y","=","a",".","y","*","b",".","w","+","a",".","w","*","b",".","y","+","a",".","z","*","b",".","x","-","a",".","x","*","b",".","z",";","q_",".","z","=","a",".","z","*","b",".","w","+","a",".","w","*","b",".","z","+","a",".","x","*","b",".","y","-","a",".","y","*","b",".","x",";","q_",".","w","=","a",".","w","*","b",".","w","-","a",".","x","*","b",".","x","-","a",".","y","*","b",".","y","-","a",".","z","*","b",".","z",";","return","q_",";","}","vec4","X","(","in","vec3","rd",",","in","float","re",")","{","vec4","q_",";","re","=","re","*","0.5",";","float","s","=","sin","(","re",")",";","q_",".","x","=","s","*","rd","[","0","]",";","q_",".","y","=","s","*","rd","[","1","]",";","q_",".","z","=","s","*","rd","[","2","]",";","q_",".","w","=","cos","(","re",")",";","return","q_",";","}","vec4","ri","(","in","vec3","bH",",","in","vec3","rf",")","{","vec4","q_",";","float","dC","=","dot","(","rf",",","bH",")",";","vec3","rh","=","cross","(","rf",",","bH",")",";","q_",".","xyz","=","rh",".","xyz",";","q_",".","w","=","1.0","+","dC",";","return","normalize","(","q_",")",";","}","vec3","rl","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","rk",")","{","vec3","q_","=","rk","*","hK",";","q_","=","T","(","qZ",",","q_",")",";","q_","+=","rj",";","return","q_",";","}","vec3","rm","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","bH",")","{","vec3","q_","=","bH","*","hK",";","q_","=","T","(","qZ",",","q_",")",";","return","q_",";","}","vec3","rn","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","rk",")","{","vec3","q_","=","rk","-","rj",";","q_","=","T","(","kV","(","qZ",")",",","q_",")",";","q_","/=","hK",";","return","q_",";","}","vec3","ro","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","bH",")","{","return","T","(","kV","(","qZ",")",",","bH",")","/","hK",";","}","mat4","rp","(",")","{","return","mat4","(","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rq","(","float","bP",")","{","return","mat4","(","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","cos","(","bP",")",",","sin","(","bP",")",",","_0_0",",","_0_0",",","-","sin","(","bP",")",",","cos","(","bP",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rs","(","float","bP",")","{","return","mat4","(","cos","(","bP",")",",","_0_0",",","-","sin","(","bP",")",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","sin","(","bP",")",",","_0_0",",","cos","(","bP",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rt","(","float","bP",")","{","return","mat4","(","cos","(","bP",")",",","sin","(","bP",")",",","_0_0",",","_0_0",",","-","sin","(","bP",")",",","cos","(","bP",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","au","ma","(","in","au","kU",")","{","return","au","(","kU",".","O",",","kU",".","ao",",","normalize","(","kU",".","V",")",",","normalize","(","kU",".","aB",")",",","normalize","(","kU",".","W",")",",","normalize","(","kU",".","U",")",",","kU",".","aQ",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aC","(","vec4","f",")","{","float","fX","=","f",".","x",";","float","fY","=","f",".","y",";","float","fZ","=","f",".","w",";","vec3","ru",";","ru",".","x","=","(","fX","+","fZ",")","/","2.0",";","ru",".","y","=","(","fY","+","fZ",")","/","2.0",";","ru",".","z","=","fZ",";","return","ru",";","}"]}]}}]},{TYPE:"txt",TOKENS:["mat3","aY","(",")","{","return","mat3","(","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_1_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",")",";","}","mat4","bh","(","mat3","t",")","{","mat4","rv",";","float","rw","=","sqrt","(","abs","(","1.","-","t","[","2","]","[","0","]","*","t","[","2","]","[","0","]","-","t","[","2","]","[","1","]","*","t","[","2","]","[","1","]","-","t","[","2","]","[","2","]","*","t","[","2","]","[","2","]",")",")",";","rv","[","0","]","[","0","]","=","(","_1_0","-","(","t","[","2","]","[","1","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")","+","t","[","2","]","[","2","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")",")","*","t","[","1","]","[","0","]",";","rv","[","0","]","[","1","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")","+","rw","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","0","]","[","2","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","-","rw","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","0","]","[","3","]","=","_0_0",";","rv","[","1","]","[","0","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")","-","rw","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","1","]","[","1","]","=","(","_1_0","-","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","+","t","[","2","]","[","2","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")",")","*","t","[","1","]","[","0","]",";","rv","[","1","]","[","2","]","=","(","t","[","2","]","[","1","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","+","rw","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","1","]","[","3","]","=","_0_0",";","rv","[","2","]","[","0","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","+","rw","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","2","]","[","1","]","=","(","t","[","2","]","[","1","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","-","rw","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","2","]","[","2","]","=","(","_1_0","-","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","+","t","[","2","]","[","1","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")",")",")","*","t","[","1","]","[","0","]",";","rv","[","2","]","[","3","]","=","_0_0",";","rv","[","3","]","[","0","]","=","t","[","0","]","[","0","]",";","rv","[","3","]","[","1","]","=","t","[","0","]","[","1","]",";","rv","[","3","]","[","2","]","=","t","[","0","]","[","2","]",";","rv","[","3","]","[","3","]","=","1.0",";","return","rv",";","}","mat3","bc","(","in","vec4","qZ",",","in","mat3","rx",")","{","if","(","qZ",".","w","<","0.",")","qZ",".","xyz","*=","-","1.",";","rx","[","2","]","=","qZ",".","xyz",";","return","rx",";","}","vec4","ry","(","in","mat3","rx",")","{","return","vec4","(","rx","[","2","]",",","sqrt","(","abs","(","1.","-","rx","[","2","]","[","0","]","*","rx","[","2","]","[","0","]","-","rx","[","2","]","[","1","]","*","rx","[","2","]","[","1","]","-","rx","[","2","]","[","2","]","*","rx","[","2","]","[","2","]",")",")",")",";","}","vec3","ap","(","mat3","rx",",","vec3","rk",")","{","vec3","q_","=","rk","*","rx","[","1","]",";","vec4","qZ","=","ry","(","rx",")",";","q_","=","T","(","qZ",",","q_",")",";","q_","+=","rx","[","0","]",";","return","q_",";","}","vec3","_","(","mat3","rx",",","vec3","bH",")","{","vec3","q_","=","bH","*","rx","[","1","]",";","vec4","qZ","=","ry","(","rx",")",";","q_","=","T","(","qZ",",","q_",")",";","return","q_",";","}","vec3","bI","(","mat3","rx",",","vec3","rz",")","{","vec3","q_","=","rz","/","rx","[","1","]",";","vec4","qZ","=","ry","(","rx",")",";","q_","=","T","(","qZ",",","q_",")",";","return","q_",";","}","mat3","aZ","(","in","vec3","rj",",","in","mat3","rx",")","{","rx","[","0","]","=","rj",";","return","rx",";","}","vec3","ex","(","in","mat3","rx",")","{","return","rx","[","0","]",";","}","mat3","a_","(","in","vec3","hK",",","in","mat3","rx",")","{","rx","[","1","]","=","hK",";","return","rx",";","}","vec3","rA","(","in","mat3","rx",")","{","return","rx","[","1","]",";","}","mat3","bd","(","in","mat3","rx",",","in","mat3","rB",")","{","mat3","rC",";","vec3","rj","=","ex","(","rx",")",";","vec3","rD","=","ex","(","rB",")",";","vec3","hK","=","rA","(","rx",")",";","vec3","rE","=","rA","(","rB",")",";","vec4","qZ","=","ry","(","rx",")",";","vec4","rF","=","ry","(","rB",")",";","vec3","rG","=","rl","(","rj",",","hK",",","qZ",",","rD",")",";","rC","=","aZ","(","rG",",","rC",")",";","vec3","rH","=","hK","*","rE",";","rC","=","a_","(","rH",",","rC",")",";","vec4","rI","=","rc","(","qZ",",","rF",")",";","rC","=","bc","(","rI",",","rC",")",";","return","rC",";","}","mat3","bd","(","in","mat3","rx",",","in","mat3","rB",",","out","mat3","q_",")","{","q_","=","bd","(","rx",",","rB",")",";","return","q_",";","}","vec4","R","(","in","vec4","rJ",")","{","return","normalize","(","rJ",")",";","}","vec4","R","(","in","vec4","rJ",",","out","float","P",",","out","float","Q",")","{","vec4","qZ","=","R","(","rJ",")",";","P","=","length","(","rJ",")","*","M_PI",";","Q","=","sign","(","rJ","[","3","]",")",";","return","R","(","rJ",")",";","}"]}]}}]}]},e["include/mirror.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MIRROR_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MIRROR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.1"]},{TYPE:"txt",TOKENS:["float","rK","(","in","vec3","D",",","vec3","eN",",","float","ec",",","float","fk",")","{","vec3","fi","=","normalize","(","eN","+","D",")",";","float","fj","=","1.0","-","dot","(","D",",","fi",")",";","float","r","=","fk","+","(","1.0","-","fk",")","*","pow","(","fj",",","ec",")",";","return","r",";","}","void","cQ","(","inout","vec3","rL",",","vec3","D",",","vec3","U",",","float","rM",",","mat3","N",")","{","vec3","eN","=","reflect","(","-","D",",","U",")",";","float","ec","=","u_fresnel_params","[","0","]",";","float","fk","=","u_fresnel_params","[","1","]",";","float","r","=","1.0",";","if","(","ec","!=","0.0",")","r","=","rK","(","D",",","eN",",","ec",",","fk",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eS","=","GLSL_TEXTURE_CUBE","(","u_cube_reflection",",","eN",")",".","xyz",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rN","=","u_refl_plane",".","xyz","*","dot","(","U",",","u_refl_plane",".","xyz",")",";","vec3","rO","=","U","-","rN",";","vec2","rP","=","bI","(","N",",","rO",")",".","xy",";","vec2","rQ","=","l",".","xy","/","l",".","z",";","rQ","+=","rP","*","REFL_BUMP",";","vec3","eS","=","GLSL_TEXTURE","(","u_plane_reflection",",","rQ",")",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eS","=","vec3","(","1.0",")",";","rM","=","0.0",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eS","=","GLSL_TEXTURE_CUBE","(","u_mirrormap",",","eN",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["bG","(","eS",".","rgb",")",";","rL","=","mix","(","rL",",","eS",",","rM","*","r",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rU","(","float","eg",",","vec3","rR",",","float","ef",")","{","float","rS","=","1.0","-","eg",";","float","rT","=","rS","*","rS",";","rT","=","rT","*","rS","*","rT",";","return","rR","+","(","max","(","vec3","(","1.0","-","ef",")",",","rR",")","-","rR",")","*","rT",";","}","vec3","sf","(","vec3","rL",",","vec3","rV",",","vec3","D",",","vec3","U",",","float","rW",",","float","rX",",","mat3","N",")","{","float","rY","=","max","(","dot","(","normalize","(","U",")",",","D",")",",","_0_0",")",";","vec3","eN","=","reflect","(","-","D",",","U",")",";","float","ef","=","sqrt","(","rX",")",";","vec3","rR","=","vec3","(","0.04",")",";","rR","=","mix","(","rR",",","rV",",","rW",")",";","vec3","rZ","=","rU","(","rY",",","rR",",","ef",")",";","vec3","r_","=","rZ",";","vec3","sa","=","vec3","(","_1_0",")","-","r_",";","sa","*=","vec3","(","1.0","-","rW",")",";","vec3","bx","=","GLSL_TEXTURE_CUBE","(","u_cube_irradiance",",","U",")",".","xyz",";","vec3","sb","=","bx","*","rL",";","const","float","sc","=","5.0",";","vec3","el","=","GLSL_TEXTURE_CUBE_LOD","(","u_cube_r_convolution",",","eN",",","ef","*","sc",")",".","rgb",";","vec2","sd","=","GLSL_TEXTURE","(","u_brdf",",","vec2","(","rY",",","ef",")",")",".","rg",";","vec3","cO","=","el","*","(","rZ","*","sd",".","x","+","sd",".","y",")",";","vec3","se","=","(","sa","*","sb","+","cO",")",";","return","se",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rU","(","float","eg",",","vec3","rR",",","float","ef",")","{","float","rS","=","1.0","-","eg",";","float","rT","=","rS","*","rS",";","rT","=","rT","*","rS","*","rT",";","return","rR","+","(","max","(","vec3","(","1.0","-","ef",")",",","rR",")","-","rR",")","*","rT",";","}","vec3","sf","(","vec3","rL",",","vec3","rV",",","vec3","D",",","vec3","U",",","float","rW",",","float","rX",",","mat3","N",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_BSDF_SKY_DIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ec","=","normalize","(","U",")",";","float","rY","=","max","(","dot","(","ec",",","D",")",",","_0_0",")",";","vec3","eN","=","reflect","(","-","D",",","U",")",";","float","sg","=","max","(","2.0","/","(","rX","*","rX",")","-","2.0",",","_0_0",")",";","vec3","rR","=","vec3","(","0.04",")",";","rR","=","mix","(","rR",",","rV",",","rW",")",";","vec3","rZ","=","rU","(","rY",",","rR",",","sqrt","(","rX",")",")",";","vec3","r_","=","rZ",";","vec3","sa","=","vec3","(","_1_0",")","-","r_",";","sa","*=","1.0","-","rW",";","vec3","sb","=","GLSL_TEXTURE_CUBE_LOD","(","u_sky_reflection",",","ec",",","100.0",")",".","xyz",";","bG","(","sb",")",";","sb","*=","rL",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sh","=","u_bsdf_cube_sky_dim",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sh","=","float","(","textureSize","(","u_sky_reflection",",","0",")",".","x",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","si","=","log2","(","(","sh","*","sqrt","(","3.0",")",")","/","sqrt","(","sg","+","_1_0",")",")",";","vec3","cO","=","GLSL_TEXTURE_CUBE_LOD","(","u_sky_reflection",",","eN",",","si",")",".","xyz",";","bG","(","cO",")",";","vec3","se","=","sa","*","sb","+","r_","*","cO",";","return","se",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","rL",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"HAS_REFRACT_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"IS_WORLD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_PRINCIPLED_REFRACT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_REFRACT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_ALPHA",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"include",FILE:"shadow.glslf"},{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","sj",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sm","(","in","vec3","sk",",","in","float","sl",")","{","vec3","fa","=","vec3","(","_0_0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fa","=","cS","(","l",",","sk",".","xy","*","sl",")",";"]}]}},{TYPE:"elif",EXPRESSION:["HAS_REFRACT_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fa","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bG","(","fa",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","fa",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kj","(","vec3","rgb",")","{","vec4","hM","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hM",".","wz",")",",","vec4","(","rgb",".","gb",",","hM",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dC","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iF","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dC","+","iF",")",")",",","dC","/","(","q",".","x","+","iF",")",",","q",".","x",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kl","(","vec3","kk",")","{","vec4","hM","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kk",".","r",",","kk",".","r",",","kk",".","r",")","+","hM",".","xyz",")","*","6.0","-","hM",".","www",")",";","return","kk",".","b","*","mix","(","hM",".","xxx",",","clamp","(","p","-","hM",".","xxx",",","_0_0",",","_1_0",")",",","kk",".","g",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sn","(","vec2","gX",")","{","return","vec3","(","gX","*","2.0","-","vec2","(","_1_0",",","_1_0",")",",","_0_0",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","so","(","vec3","rk",")","{","return","vec2","(","rk",".","xy","*","_0_5","+","vec2","(","_0_5",",","_0_5",")",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sv","(","vec3","sr",",","vec3","rz",",","float","su",")","{","float","dx","=","abs","(","dot","(","sr",",","rz",")",")",";","float","g","=","su","*","su","-","_1_0","+","dx","*","dx",";","float","ea",";","if","(","g",">","_0_0",")","{","g","=","sqrt","(","g",")",";","float","cG","=","(","g","-","dx",")","/","(","g","+","dx",")",";","float","hS","=","(","dx","*","(","g","+","dx",")","-","_1_0",")","/","(","dx","*","(","g","-","dx",")","+","_1_0",")",";","ea","=","_0_5","*","cG","*","cG","*","(","_1_0","+","hS","*","hS",")",";","}","else","{","ea","=","_1_0",";","}","return","ea",";","}"]}]}}]},{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sU"],STATEMENTS:[{TYPE:"txt",TOKENS:["sU","=","normalize","(","sR",".","xyz",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sV"],STATEMENTS:[{TYPE:"txt",TOKENS:["sV","=","abs","(","sR",".","z",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sW"],STATEMENTS:[{TYPE:"txt",TOKENS:["sW","=","length","(","sR",".","xyz",")",";"]}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["s_","=","vec3","(","sX",",","sY",",","sZ",")",";"]}]},{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ta",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["td","=","kl","(","vec3","(","ta",",","tb",",","tc",")",")",";"]}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["te","=","vec3","(","-","_1_0",",","-","_1_0",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tf","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sw",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tg","=","sn","(","sw",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["th","=","2.0","*","sj","-","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sx",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ti","=","max","(","vec3","(","_0_0",")",",","sx",")",";","bG","(","ti",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sy",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tj","=","max","(","_0_0",",","sy",")",";","bG","(","tj",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sz",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tk","=","max","(","_0_0",",","sz","[","0","]",")",";","tl","=","max","(","_0_0",",","sz","[","1","]",")",";","bG","(","tk",")",";","bG","(","tl",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sA",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tm","=","max","(","_0_0",",","sA","[","0","]",")",";","tn","=","max","(","_0_0",",","sA","[","1","]",")",";","to","=","max","(","_0_0",",","sA","[","2","]",")",";","bG","(","tm",")",";","bG","(","tn",")",";","bG","(","to",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","tr",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","sK",".","xyz",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_BF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tw","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tw","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tx","=","-","_","(","u_view_tsr_frag",",","oy",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ty","=","sR",".","xyz",";"]}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tz","=","ow",";"]}]},{TYPE:"node",NAME:"GEOMETRY_IN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tA","=","oy",";"]}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tB","=","vec3","(","_0_0",")",";","tC","=","vec3","(","_0_0",")",";","tD","=","vec3","(","_0_0",")",";","tE","=","vec3","(","_0_0",")",";","tF","=","vec3","(","_0_0",")",";","tG","=","vec3","(","_0_0",")",";","tH","=","_0_0",";","tI","=","_0_0",";"]}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","kk","=","kj","(","tN",")",";","kk","[","0","]","+=","(","tJ","-","_0_5",")",";","if","(","kk","[","0","]",">","_1_0",")","kk","[","0","]","-=","_1_0",";","else","if","(","kk","[","0","]","<","_0_0",")","kk","[","0","]","+=","_1_0",";","kk","*=","vec3","(","_1_0",",","tK",",","tL",")",";","kk","=","mix","(","vec3","(","_1_0",")",",","mix","(","vec3","(","_0_0",")",",","kk",",","step","(","vec3","(","_0_0",")",",","kk",")",")",",","step","(","kk",",","vec3","(","_1_0",")",")",")",";","tO","=","mix","(","tN",",","kl","(","kk",")",",","tM",")",";"]}]},{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tR","=","mix","(","tQ",",","vec3","(","_1_0",")","-","tQ",",","tP",")",";"]}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tS",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_INDEX",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:["tS","=","u_lamp_light_color_intensities","[","LAMP_INDEX","]",";"]}]}]},{TYPE:"txt",TOKENS:["vec3","tW","=","u_lamp_light_directions","[","LAMP_INDEX","]",";","vec3","tX","=","u_lamp_light_positions","[","LAMP_INDEX","]",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","h","-","tX",";","tU","=","length","(","tT",")",";","tT","=","normalize","(","tT",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","tU","*","tU",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pb","=","dot","(","-","tT",",","tW",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","tV","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","*=","max","(","LAMP_LIGHT_DIST","-","tU",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tT"],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","tW",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tU"],STATEMENTS:[{TYPE:"txt",TOKENS:["tU","=","length","(","tX","-","h",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:["tS","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["tT","=","vec3","(","_0_0",")",";","tU","=","0.0",";"]}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"t_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tZ","=","sB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_t_"],STATEMENTS:[{TYPE:"txt",TOKENS:["t_","=","-","dot","(","tY",",","sB",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ub","=","-","_","(","u_view_tsr_frag",",","ua",")",";"]}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ud",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ue",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ug",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ur",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ut",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uv",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uw",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ux",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ur","=","ud",";","us","=","uf",";","ut","=","ui",";","ux","=","ud",";","uy","=","uf",";","uz","=","ul",";","uA","=","um",";","uB","=","un",";","uC","=","uo",";","up","=","sS","*","ur",";","uq","=","sT","*","u_environment_energy","*","cE","(","ut",")",";","uw","=","cH","(","ur",")",";","H","=","uw",";","uu","[","0","]","=","ue",";","uu","[","1","]","=","ug",";","uu","[","2","]","=","uh",";","uv","[","0","]","=","uj",";","uv","[","1","]","=","uk",";"]}]},{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uD",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uG",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uH",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uP",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","uQ","=","clamp","(","uG","[","1","]",",","_0_0",",","_1_0",")",";","float","rW","=","uG","[","2","]",";","uO","=","uD",".","rgb",";","uP","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","+=","sf","(","uI",",","uJ",",","oy",",","uF",",","rW",",","uQ",",","mat3","(","_0_0",")",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","+=","sf","(","uI",",","uJ",",","oy",",","uF",",","rW",",","u_view_tsr_frag",")",";"]}]}]},{TYPE:"txt",TOKENS:["uO","+=","uE",";","uO","=","mix","(","uO",",","uK",",","uL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_REFRACT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","uR","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bG","(","uR",")",";","uM","=","uM","*","uR",";","uO","+=","uM",";","uP","=","_1_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","=","mix","(","uM",",","uO",",","uN",")",";","uP","=","uN",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_PRINCIPLED_REFRACT"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","uS","=","uH","[","0","]",";","float","uT","=","uH","[","1","]",";","float","uU","=","clamp","(","uG","[","0","]",",","_0_0",",","_1_0",")",";","vec3","en","=","oy",";","vec3","ei","=","normalize","(","uF",")",";","vec3","uV","=","refract","(","-","en",",","ei",",","_1_0","/","uS",")",";","uV","*=","length","(","u_camera_eye_frag","-","h",")",";","vec3","uW","=","aC","(","u_proj_matrix_frag","*","vec4","(","ap","(","u_view_tsr_frag",",","ow","+","uV",")",",","_1_0",")",")",";","vec2","uX","=","uW",".","xy","/","uW",".","z",";","const","float","sc","=","10.0",";","vec3","fa","=","GLSL_TEXTURE_LOD","(","u_refractmap",",","uX",".","xy",",","uU","*","sc",")",".","rgb",";","bG","(","fa",")",";","float","e_","=","(","_1_0","-","rW",")","*","uT",";","uO","=","mix","(","uO",",","fa",",","e_",")",";"]}]}]},{TYPE:"txt",TOKENS:["uF",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uZ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"u_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"va",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vb",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","u_",";","float","uU","=","clamp","(","vb","[","0","]",",","_0_0",",","_1_0",")",";","float","uQ","=","clamp","(","vb","[","1","]",",","_0_0",",","_1_0",")",";","float","rW","=","vb","[","2","]",";","vec3","p_","=","normalize","(","oy","+","uY",")",";","vec3","ve","=","(","_1_0","-","va",")","*","vec3","(","dot","(","rz",",","uY",")",",","max","(","dot","(","uY",",","p_",")",",","_0_0",")",",","max","(","dot","(","u_",",","p_",")",",","_0_0",")",")","+","va",";","float","pj","=","ve",".","x",";","float","vf","=","ve",".","y",";","float","vg","=","ve",".","z",";","vc","=","_0_0",";","if","(","uZ",".","r","!=","_0_0",")","{","vc","=","pj",";","if","(","uU",">","_0_0",")","{","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","float","pA","=","uU","*","uU",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","uY","-","pj","*","rz",";","vec3","pC","=","oy","-","pz","*","rz",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","vc","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","vc","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","vc","=","max","(","vc",",","_0_0",")","/","M_PI",";","}","float","L","=","uQ",";","float","vh","=","L","*","L",";","float","d_","=","(","vg","*","vh","-","vg",")","*","vg","+","_1_0",";","float","cD","=","vh","/","(","M_PI","*","d_","*","d_",")",";","float","vi",";","float","vj",";","float","vk","=","_1_0","-","vf",";","float","vl","=","vk","*","vk",";","vl","=","vl","*","vk","*","vl",";","vi","=","_1_0",";","vj","=","vl",";","float","hM","=","L","/","2.0",";","float","vm","=","hM","*","hM",";","float","vn","=","_1_0","-","vm",";","float","vo","=","_1_0","/","(","vf","*","vf","*","vn","+","vm",")",";","vi","*=","vo",";","vj","*=","vo",";","float","rR","=","mix","(","0.04",",","_1_0",",","rW",")",";","float","vp","=","mix","(","vj",",","vi",",","rR",")",";","vd","=","max","(","pj","*","cD","*","vp",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_PRINCIPLED",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vq",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vy",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vz","=","vq",".","rgb",";","vA","=","vs","*","vs",";","vx","=","vq",".","rgb",";","vy","=","vs",";","vB","=","vr",";","vD","=","vt",";","vE","=","vu",";","vG","=","_0_0",";","vI","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vC","=","vv",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vC","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["vw",";","vF","=","vec3","(","_0_0",")",";","vH","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vP","=","vJ",";","vK",";","vL",";","vM",";","vN",";","vO",";"]}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"v_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vU","=","vQ",";","vV","=","vR",";","vX","=","_1_0",";","vY","=","_0_0",";","v_","=","1.45",";","wa","=","_0_0",";","wc","=","_0_0",";","we","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","vS",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["vT",";","vW","=","vec3","(","_0_0",")",";","wb","=","vec3","(","_0_0",")",";","wd","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wj","=","wf",";","wg",";","wh",";","wi",";"]}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wq","=","wk",";","wr","=","wl",";","ws","=","_1_0",";","wu","=","1.45",";","wv","=","_0_0",";","wB","=","_0_0",";","wD","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","wm",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["wn",";","wo","=","vec3","(","_0_0",")",";","wp","=","_0_0",";","wA","=","vec3","(","_0_0",")",";","wC","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wI","=","wE",";","wF",";","wG",";","wH",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wV","=","wJ",";","wP","=","_0_0",";","wU","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",TOKENS:["wW","=","_0_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wW","=","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["wQ","=","ox",";","wK",";","wL","=","vec3","(","_0_0",")",";","wM","=","_0_0",";","wN","=","vec3","(","_0_0",")",";","wO","=","_0_0",";","wT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wZ","=","wX",";","wY",";"]}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xd","[","0","]","=","xd","[","1","]","=","xd","[","2","]","=","_0_0",";","w_",";","xa",";","xb",";","xc",";"]}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xi","=","xe",";","xf",";","xg",";","xh",";"]}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xm","=","xj",";","xk",";","xl",";"]}]},{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xt","[","0","]","=","xt","[","1","]","=","xt","[","2","]","=","_0_0",";","xn",";","xp",";","xq",";","xr",";","xs",";","xo",";"]}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xJ","=","xv","*","xu",";","xF","=","_0_0",";","xK","=","_1_0",";","xM","=","_1_0",";","xG","=","ox",";","xH","=","1.45",";","xI","=","_0_0",";","xA",";","xB","=","vec3","(","_0_0",")",";","xC","=","_0_0",";","xD","=","vec3","(","_0_0",")",";","xE","=","_0_0",";"]}]},{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xO","[","0","]","=","xO","[","1","]","=","xO","[","2","]","=","_0_0",";","xN",";"]}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xP","[","0","]","=","xP","[","1","]","=","xP","[","2","]","=","_0_0",";"]}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xS","[","0","]","=","xS","[","1","]","=","xS","[","2","]","=","_0_0",";","xQ",";","xR",";"]}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xW","[","0","]","=","xW","[","1","]","=","xW","[","2","]","=","_0_0",";","xT",";","xU",";","xV",";"]}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[{TYPE:"node_var",NAME:"INVERT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"x_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","aM","=","xY",";","float","gL","=","xX",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["INVERT"],STATEMENTS:[{TYPE:"txt",TOKENS:["aM","=","-","_1_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","x_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yb","=","dFdx","(","ow",")",";","vec3","yc","=","dFdy","(","ow",")",";","vec3","yd","=","cross","(","yc",",","U",")",";","vec3","ye","=","cross","(","U",",","yb",")",";","float","dy","=","dot","(","yb",",","yd",")",";","float","yf","=","abs","(","dy",")",";","vec3","yg","=","dFdx","(","xZ",")","*","yd","+","dFdy","(","xZ",")","*","ye",";","gL","=","max","(","gL",",","_0_0",")",";","ya","=","normalize","(","yf","*","U","-","aM","*","sign","(","dy",")","*","yg",")",";","ya","=","normalize","(","gL","*","ya","+","(","_1_0","-","gL",")","*","U",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["ya","=","U",";"]}]}]}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","aM","=","0.1",";","vec3","U","=","ox",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yb","=","dFdx","(","ow",")",";","vec3","yc","=","dFdy","(","ow",")",";","vec3","yd","=","cross","(","yc",",","U",")",";","vec3","ye","=","cross","(","U",",","yb",")",";","float","dy","=","dot","(","yb",",","yd",")",";","float","yf","=","abs","(","dy",")",";","vec3","yg","=","dFdx","(","yh",")","*","yd","+","dFdy","(","yh",")","*","ye",";","yi","=","normalize","(","yf","*","U","-","aM","*","sign","(","dy",")","*","yg",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["yi","=","U",";"]}]}]}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","yl",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","sM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym","=","sQ","*","ym",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";","ym","=","bI","(","u_model_tsr",",","ym",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["float","me","=","max","(","yj",",","_0_0",")",";","ym","=","normalize","(","mix","(","yn",",","ym",",","me",")",")",";"]}]},{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","yo",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";","yp","=","ap","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";","yp","=","ap","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";","yp","=","_","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";","yp","=","_","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","normalize","(","yp",")",";"]}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yr","[","0","]","=","yr","[","1","]","=","yr","[","2","]","=","_0_0",";","yq",";"]}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yt","[","0","]","=","yt","[","1","]","=","yt","[","2","]","=","_0_0",";","ys",";"]}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yv","=","yu","[","0","]",";","yA","=","yu","[","1","]",";","yB","=","yu","[","2","]",";"]}]},{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yF","[","0","]","=","yC",";","yF","[","1","]","=","yD",";","yF","[","2","]","=","yE",";"]}]},{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","b","=","yH","-","yI","*","_0_5",";","yJ","=","max","(","(","_1_0","+","yI",")","*","yG","+","b",",","vec3","(","_0_0",")",")",";"]}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yM","=","yN","=","yO","=","_0_0",";","yK",";","yL",";"]}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yQ","[","0","]","=","yQ","[","1","]","=","yQ","[","2","]","=","_0_0",";","yP",";"]}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yV","[","0","]","=","yV","[","1","]","=","yV","[","2","]","=","_0_0",";","yW","=","_1_0",";","yR",";","yS",";","yT",";","yU",";"]}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"za",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zb","[","0","]","=","zb","[","1","]","=","zb","[","2","]","=","_0_0",";","zc","=","_1_0",";","yX",";","yY",";","yZ",";","y_",";","za",";"]}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ze",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zf","[","0","]","=","zf","[","1","]","=","zf","[","2","]","=","_0_0",";","zg","=","_1_0",";","zd",";","ze",";"]}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zo","[","0","]","=","zo","[","1","]","=","zo","[","2","]","=","_0_0",";","zp","=","_1_0",";","zh",";","zi",";","zj",";","zk",";","zl",";","zm",";","zn",";"]}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zr","[","0","]","=","zr","[","1","]","=","zr","[","2","]","=","_0_0",";","zs","=","_1_0",";","zq",";"]}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zA","[","0","]","=","zA","[","1","]","=","zA","[","2","]","=","_0_0",";","zB","=","_1_0",";","zt",";","zu",";","zv",";"]}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zG","[","0","]","=","zG","[","1","]","=","zG","[","2","]","=","_0_0",";","zH","=","_1_0",";","zC",";","zD",";","zE",";","zF",";"]}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zR","[","0","]","=","zR","[","1","]","=","zR","[","2","]","=","_0_0",";","zS","=","_1_0",";","zI",";","zJ",";","zK",";","zL",";","zM",";","zN",";","zO",";","zP",";","zQ",";"]}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zV","=","clamp","(","zT","+","zU",",","vec3","(","_0_0",")",",","vec3","(","_1_0",")",")",";"]}]},{TYPE:"node",NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"z_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ac",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ad",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ae",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Af",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ah",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ai",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ak",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Al",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Am",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ap",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ar",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"At",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Au",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ax",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","sqrt","(","clamp","(","zW",",","_0_0",",","_1_0",")",")",";","Ax","=","mix","(","zZ",",","Ak",",","AJ",")",";","Ay","=","mix","(","z_",",","Al",",","AJ",")",";","if","(","Ac",">","_0_0",")","{","if","(","Ao",">","_0_0",")","{","Az","=","mix","(","Aa",",","Am",",","AJ",")",";","AA","=","mix","(","Ab",",","An",",","AJ",")",";","}","else","{","Az","=","Aa",";","AA","=","Ab",";","}","}","else","{","Az","=","Am",";","AA","=","An",";","}","if","(","Ah",">","_0_0",")","{","if","(","At",">","_0_0",")","{","AF","=","mix","(","Ag",",","As",",","AJ",")",";","}","else","{","AF","=","Ag",";","}","}","else","{","AF","=","As",";","}","AB","=","mix","(","Ac",",","Ao",",","AJ",")",";","AC","=","mix","(","Ad",",","Ap",",","AJ",")",";","AG","=","mix","(","Ah",",","At",",","AJ",")",";","AH","=","mix","(","Ai",",","Au",",","AJ",")",";","AI","=","mix","(","Aj",",","Av",",","AJ",")",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sC",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AK"],STATEMENTS:[{TYPE:"txt",TOKENS:["AK","=","sn","(","sC",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AL"],STATEMENTS:[{TYPE:"txt",TOKENS:["AL","=","vec3","(","sC",",","_0_0",")",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sD",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AM","=","vec3","(","sD",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AN","=","ox",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","sj",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","sJ",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AP","=","ap","(","u_model_tsr_inverse",",","ow",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AP","=","sJ",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AQ",".","xy","=","sR",".","xy",";","AQ",".","z","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","xy","=","l",".","xy","/","l",".","z",";","AR",".","z","=","_0_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AS","=","reflect","(","-","oy",",","ox",")",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sE",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AT","=","vec3","(","sE",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"A_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AU","=","_0_0",";","AV","=","_0_0",";","AW","=","_0_0",";","AX","=","vec3","(","_0_0",")",";","AY","=","_0_0",";","AZ","=","AX",";","A_","=","AX",";"]}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ba",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ba","=","_0_0",";","Bb","=","_0_0",";","Bc","=","_0_0",";","Bd","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_LOCATION_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_OBJ_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MAT_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_RANDOM_OUT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Be",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_LOCATION_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Be","=","ex","(","u_model_tsr",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OBJ_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","u_obj_info",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MAT_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bg","=","u_obj_info",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_RANDOM_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bh","=","u_obj_info",".","b",";"]}]}]}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bj","=","Bi",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bk","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","normalize","(","Bm",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","normalize","(","oy",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","u_camera_direction",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Bn"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","su","=","max","(","_1_0","-","Bl",",","0.00001",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","==","false","?","su",":","_1_0","/","su",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","?","su",":","_1_0","/","su",";"]}]}]},{TYPE:"txt",TOKENS:["Bn","=","sv","(","Bp",",","cw",",","su",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Bn","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Bo"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","abs","(","dot","(","Bp",",","cw",")",")",";","float","eA","=","Bl",";","if","(","eA","!=","_0_5",")","{","eA","=","clamp","(","eA",",","_0_0",",","0.99999",")",";","eA","=","(","eA","<","_0_5",")","?","2.0","*","eA",":","_0_5","/","(","_1_0","-","eA",")",";","Bo","=","pow","(","Bo",",","eA",")",";","}","Bo","=","_1_0","-","Bo",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"By",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bq","=","Br","=","Bs","=","_0_0",";","Bt","=","Bu","=","Bv","=","_0_0",";","Bw","=","BA","=","By","=","Bz","=","_0_0",";","Bx","=","_0_0",";"]}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"BB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BB","=","BC","=","vec3","(","_0_0",")",";","BD","=","_0_0",";"]}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","BF",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","r","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","r","+","_0_5",",","NODE_TEX_ROW",")",")",".","r","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","g","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","g","+","_0_5",",","NODE_TEX_ROW",")",")",".","g","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","b","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","b","+","_0_5",",","NODE_TEX_ROW",")",")",".","b","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"txt",TOKENS:["BG","=","mix","(","BF",",","BG",",","BE",")",";"]}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","r",",","NODE_TEX_ROW",")",")",".","a",";","float","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","g",",","NODE_TEX_ROW",")",")",".","a",";","float","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","b",",","NODE_TEX_ROW",")",")",".","a",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","BI",".","r",";","float","g","=","BI",".","g",";","float","b","=","BI",".","b",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","r",",","NODE_TEX_ROW",")",")",".","r",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","g",",","NODE_TEX_ROW",")",")",".","g",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","b",",","NODE_TEX_ROW",")",")",".","b",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","b",";"]}]}]},{TYPE:"txt",TOKENS:["BJ","=","mix","(","BI",",","BJ",",","BH",")",";"]}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BK",",","NODE_TEX_ROW",")",")",";","BL","=","BN",".","rgb",";","BM","=","BN",".","a",";"]}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BO",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","*","MAPPING_SCALE",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","+","MAPPING_TRANS",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","(","MAPPING_TRS_MATRIX","*","vec4","(","BP",",","_1_0",")",")",".","xyz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","max","(","BP",",","MAPPING_MIN_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","min","(","BP",",","MAPPING_MAX_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","normalize","(","BP",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","BQ","+","BR",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","clamp","(","BS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","BT","-","BU",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","clamp","(","BV",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","BW","*","BX",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","clamp","(","BY",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","(","B_","!=","_0_0",")","?","BZ","/","B_",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","clamp","(","Ca",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","sin","(","Cb",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","clamp","(","Cd",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cc",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ce",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","cos","(","Ce",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","clamp","(","Cg",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cf",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ch",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ci",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","tan","(","Ch",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","clamp","(","Cj",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Ci",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ck",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","(","Ck","<=","_1_0","&&","Ck",">=","-","_1_0",")","?","asin","(","Ck",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","clamp","(","Cm",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cl",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","(","Cn","<=","_1_0","&&","Cn",">=","-","_1_0",")","?","acos","(","Cn",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","clamp","(","Cp",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Co",";"]}]},{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","atan","(","Cq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","clamp","(","Cs",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cr",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ct",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","Ct","<","_0_0","&&","Cu","!=","floor","(","Cu",")",")","Cv","=","_0_0",";","else","if","(","Cu","==","_0_0",")","Cv","=","_1_0",";","else","if","(","Ct","<","_0_0",")","Cv","=","mix","(","_1_0",",","-","_1_0",",","sign","(","mod","(","-","Cu",",","2.0",")",")",")","*","pow","(","-","Ct",",","Cu",")",";","else","if","(","Ct","==","_0_0",")","Cv","=","_0_0",";","else","Cv","=","pow","(","Ct",",","Cu",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cv","=","clamp","(","Cv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","(","Cw",">","_0_0","&&","Cx",">","_0_0",")","?","log2","(","Cw",")","/","log2","(","Cx",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","clamp","(","Cy",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","min","(","Cz",",","CA",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","clamp","(","CB",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","max","(","CC",",","CD",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","clamp","(","CE",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","floor","(","CF","+","_0_5",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","clamp","(","CH",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CG",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CK",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","(","CI","<","CJ",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","clamp","(","CK",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CN",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","(","CL",">","CM",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","clamp","(","CN",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","abs","(","CP",")",">","0.000001","?","mod","(","CO",",","CP",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","clamp","(","CQ",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CT",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","abs","(","CR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","clamp","(","CT",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CS",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CU",",","_0_0",",","_1_0",")",";","CX","=","mix","(","CV",",","CW",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CX","=","clamp","(","CX",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Da",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CY",",","_0_0",",","_1_0",")",";","Da","=","mix","(","CZ",",","CZ","+","C_",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Da","=","clamp","(","Da",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Db",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"De",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Db",",","_0_0",",","_1_0",")",";","De","=","mix","(","Dc",",","Dc","*","Dd",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["De","=","clamp","(","De",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Df",",","_0_0",",","_1_0",")",";","Di","=","mix","(","Dg",",","Dg","-","Dh",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Di","=","clamp","(","Di",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dj",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dm","=","vec3","(","_1_0",")","-","(","vec3","(","Dn",")","+","AJ","*","(","vec3","(","_1_0",")","-","Dl",")",")","*","(","vec3","(","_1_0",")","-","Dk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dm","=","clamp","(","Dm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Do",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Do",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dq","+=","step","(","Dq",",","vec3","(","_0_0",")",")",";","Dr","=","Dn","*","Dp","+","AJ","*","Dp","/","Dq",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dr","=","clamp","(","Dr",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ds",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dv",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ds",",","_0_0",",","_1_0",")",";","Dv","=","mix","(","Dt",",","abs","(","Dt","-","Du",")",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dv","=","clamp","(","Dv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dw",",","_0_0",",","_1_0",")",";","Dz","=","min","(","Dx",".","rgb",",","Dy",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dz","=","clamp","(","Dz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DA",",","_0_0",",","_1_0",")",";","DD","=","max","(","DB",".","rgb",",","DC",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DD","=","clamp","(","DD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DE",",","_0_0",",","_1_0",")",";","vec3","DI","=","vec3","(","_1_0","-","AJ",")",";","DH","=","mix","(","DF","*","(","DI","+","2.0","*","AJ","*","DG",")",",","vec3","(","_1_0",")","-","(","DI","+","2.0","*","AJ","*","(","vec3","(","_1_0",")","-","DG",")",")","*","(","vec3","(","_1_0",")","-","DF",")",",","step","(","_0_5",",","DF",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DH","=","clamp","(","DH",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DJ",",","_0_0",",","_1_0",")",";","vec3","DN","=","vec3","(","_1_0",")","-","AJ","*","DL",";","vec3","DO","=","clamp","(","DK","/","DN",",","_0_0",",","_1_0",")",";","DM","=","mix","(","mix","(","DO",",","vec3","(","_1_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",",","DK",",","step","(","DK",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DM","=","clamp","(","DM",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DP",",","_0_0",",","_1_0",")",";","vec3","ks","=","vec3","(","_1_0","-","AJ",")",";","vec3","DN","=","ks","+","AJ","*","DR",";","vec3","DO","=","clamp","(","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","DQ",")","/","DN",",","_0_0",",","_1_0",")",";","DS","=","mix","(","DO",",","vec3","(","_0_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","clamp","(","DS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DT",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","DW","=","DU",";","DX","=","kj","(","DV",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","DW",")",";","kk",".","x","=","DX",".","x",";","DN","=","kl","(","kk",")",";","DW","=","mix","(","DW",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","clamp","(","DW",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DY",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Ea","=","DZ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ea",")",";","if","(","kk",".","y","!=","_0_0",")","{","DX","=","kj","(","D_",")",";","kk",".","y","=","Dn","*","kk",".","y","+","AJ","*","DX",".","y",";","Ea","=","kl","(","kk",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ea","=","clamp","(","Ea",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ee",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eb",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ec",")",";","DX","=","kj","(","Ed",")",";","kk",".","z","=","Dn","*","kk",".","z","+","AJ","*","DX",".","z",";","Ee","=","kl","(","kk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ee","=","clamp","(","Ee",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ef",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ef",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","Ei","=","Eg",";","DX","=","kj","(","Eh",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","Ei",")",";","kk",".","x","=","DX",".","x",";","kk",".","y","=","DX",".","y",";","DN","=","kl","(","kk",")",";","Ei","=","mix","(","Ei",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ei","=","clamp","(","Ei",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ej",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ek",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"El",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Em",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ej",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","En","=","El","+","Ek","-","El","*","Ek",";","Em","=","Ek","*","(","vec3","(","Dn",")","+","vec3","(","AJ",")","*","(","(","vec3","(","_1_0",")","-","Ek",")","*","El","+","En",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Em","=","clamp","(","Em",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ep",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eo",",","_0_0",",","_1_0",")",";","Er","=","Ep","+","AJ","*","(","2.0","*","Eq","-","vec3","(","_1_0",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Er","=","clamp","(","Er",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Es",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Et",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ev",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Es",",","_0_0",",","_1_0",")",";","Ev","=","mix","(","Et",",","Eu",",","AJ",")",";"]}]},{TYPE:"node",NAME:"ADD_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ew",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ex",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ey",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ez",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ew",",","_0_0",",","_1_0",")",";","Ez","=","mix","(","Ex",",","Ex","+","Ey",",","AJ",")",";"]}]},{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EA",";","I","=","EB",";"]}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ED",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EC",";","I","=","ED",";"]}]},{TYPE:"node",NAME:"OUTPUT_WORLD_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EE",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EE",";","I","=","_1_0",";"]}]},{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EJ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ER",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sF",QUALIFIER:["const","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sG",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","=","EF",";","EN","=","sG","[","0","]","*","EG",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","normalize","(","EI",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","EJ","*","EM",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","sS","*","EM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","*=","EH",";"]}]}]},{TYPE:"txt",TOKENS:["EL","=","sT","*","u_environment_energy","*","cE","(","EO",")",";","ER","=","cH","(","EM",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["EP","=","vec2","(","sF","[","0","]",",","sF","[","1","]",")",";","EQ","=","vec2","(","sG","[","1","]",",","sG","[","2","]",")",";"]}]}]},{TYPE:"txt",TOKENS:["H","=","ER",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","vec3","(","_0_0",")",";","EL","=","vec3","(","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"ES",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ET",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EW",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EX",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EY",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EZ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"E_",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EY"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","ES",".","rgb",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["cQ","(","EY",",","oy",",","EU",",","EV",",","u_view_tsr_frag",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["cQ","(","EY",",","oy",",","EU",",","EV",",","mat3","(","_0_0",")",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","+=","ET",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_E_"],STATEMENTS:[{TYPE:"txt",TOKENS:["E_","=","EU",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fa"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fa","=","ES",".","rgb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fb","=","ET",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","EX",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","EW",";","EZ","=","clamp","(","EX","*","(","_1_0","-","t",")","+","t",",","_0_0",",","_1_0",")",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","sH",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","sI",";","EZ","=","sH","*","(","_1_0","-","t",")","+","t",";"]}]}]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","ET",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["G","=","EU",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec4","(","oP","+","oR","*","oQ",",","_0_0",")",";","oT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oW","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oX","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","oU","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oZ","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oV","=","oZ","-","ow",";","float","aM","=","length","(","oV",")",";","oX","*=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oV","=","normalize","(","oV",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pa","=","u_light_directions","[","LAMP_IND","]",";","float","pb","=","dot","(","oV",",","pa",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","oX","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","max","(","LAMP_LIGHT_DIST","-","aM",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oV","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pe",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pc",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["ph","=","_0_0",";","if","(","pd",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pf",")","*","dot","(","rz",",","pc",")","+","pf",";","if","(","pg","[","0","]","==","_0_0",")","{","ph","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pj",")",";","t","=","pg","[","1","]","+","(","_1_0","-","pg","[","1","]",")","*","pow","(","t",",","pg","[","0","]",")",";","ph","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","ph","=","max","(","ph",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pm",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pk",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["po","=","_0_0",";","if","(","pl",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pn",")","*","dot","(","rz",",","pk",")","+","pn",";","po","=","max","(","pj",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pv",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pr",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["py","=","_0_0",";","if","(","pu",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pw",")","*","dot","(","rz",",","pr",")","+","pw",";","if","(","px","[","0","]",">","_0_0",")","{","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","float","pA","=","px","[","0","]","*","px","[","0","]",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","pr","-","pj","*","rz",";","vec3","pC","=","oy","-","pz","*","rz",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","py","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","py","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","py","=","pj",";","py","=","max","(","py",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pJ",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pH",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["pM","=","_0_0",";","if","(","pI",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pK",")","*","dot","(","rz",",","pH",")","+","pK",";","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","if","(","pL","[","0","]","<=","_1_0",")","pM","=","pj","*","pow","(","max","(","pz","*","pj",",","0.1",")",",","pL","[","0","]","-","_1_0",")",";","else","pM","=","pj","*","pow","(","1.0001","-","pz",",","pL","[","0","]","-","_1_0",")",";","pM","=","max","(","pM",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pP",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pN",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["pS","=","_0_0",";","if","(","pO",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pQ",")","*","dot","(","rz",",","pN",")","+","pQ",";","float","pT","=","acos","(","pj",")",";","if","(","pT","<","pR","[","0","]",")","pS","=","_1_0",";","else","if","(","pT",">","(","pR","[","0","]","+","pR","[","1","]",")","||","pR","[","1","]","==","_0_0",")","pS","=","_0_0",";","else","pS","=","_1_0","-","(","(","pT","-","pR","[","0","]",")","/","pR","[","1","]",")",";","pS","=","max","(","pS",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","_0_0",";","if","(","pV",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","pU","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pX","==","_0_0",")","{","pZ","=","dot","(","B",".","xyz",",","p_",")",";","pZ","=","sqrt","(","_1_0","-","pZ","*","pZ",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","(","_1_0","-","pX",")","*","max","(","dot","(","pW",",","p_",")",",","_0_0",")","+","pX",";"]}]}]},{TYPE:"txt",TOKENS:["pZ","=","pow","(","pZ",",","pY","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","_0_0",";","if","(","qb",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qa","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","qd","==","_0_0",")","{","qf","=","dot","(","B",".","xyz",",","p_",")",";","qf","=","sqrt","(","_1_0","-","qf","*","qf",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","max","(","dot","(","qc",",","p_",")",",","_0_0",")",";","qf","=","(","_1_0","-","qd",")","*","qf","+","qd",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","B",".","xyz",",","oy",")",",","_0_0",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","qc",",","oy",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qf","=","pow","(","qf",",","qe","[","0","]",")",";","qf","=","qf","/","(","0.1","+","pz",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ql","=","_0_0",";","if","(","qh",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","qg","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","float","pz","=","_0_0",";","float","qn","=","_0_0",";","if","(","qj","==","_0_0",")","{","qm","=","dot","(","B",".","xyz",",","p_",")",";","pz","=","dot","(","B",".","xyz",",","oy",")",";","qn","=","dot","(","B",".","xyz",",","qg",")",";","qm","=","sqrt","(","_1_0","-","qm","*","qm",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";","qn","=","sqrt","(","_1_0","-","qn","*","qn",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","max","(","dot","(","qi",",","p_",")",",","0.01",")",";","float","pz","=","max","(","dot","(","qi",",","oy",")",",","0.01",")",";","float","qn","=","max","(","dot","(","qi",",","qg",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bP","=","tan","(","acos","(","qm",")",")",";","float","L","=","max","(","qk","[","0","]",",","0.01",")",";","ql","=","qn","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bP","*","bP",")","/","(","L","*","L",")",")","/","(","sqrt","(","pz","*","qn",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qx","=","_0_0",";","if","(","qr",".","g","==","_1_0",")","{","vec3","co","=","normalize","(","qo","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qy","=","dot","(","co",",","B",".","xyz",")",";","float","bP","=","qw","[","0","]","+","qw","[","1","]",";","if","(","qv","==","_0_0",")","bP","=","acos","(","sqrt","(","_1_0","-","qy","*","qy",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bP","=","acos","(","dot","(","co",",","qu",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bP","<","qw","[","0","]",")","qx","=","_1_0",";","else","if","(","bP",">=","qw","[","0","]","+","qw","[","1","]","||","qw","[","1","]","==","_0_0",")","qx","=","_0_0",";","else","qx","=","_1_0","-","(","bP","-","qw","[","0","]",")","/","qw","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qF","=","qD","[","0","]",";","float","qG","=","qD","[","1","]",";","qE","=","_0_0",";","if","(","qA",".","g","==","_1_0",")","{","if","(","qF","<","_1_0","||","qG","==","_0_0",")","qE","=","_0_0",";","else","{","if","(","qG","<","100.0",")","qG","=","sqrt","(","_1_0","/","qG",")",";","else","qG","=","10.0","/","qG",";","vec3","p_","=","normalize","(","oy","+","qz",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","if","(","qC","==","_0_0",")","{","float","qH","=","dot","(","B",".","xyz",",","p_",")",";","qm","=","sqrt","(","_1_0","-","qH","*","qH",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","(","_1_0","-","qC",")","*","max","(","dot","(","qB",",","p_",")",",","_0_0",")","+","qC",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qm","<","_0_0",")","qE","=","_0_0",";","else","{","float","pz","=","max","(","dot","(","qB",",","oy",")",",","0.01",")",";","float","qn","=","dot","(","qB",",","qz",")",";","if","(","qn","<=","0.01",")","qE","=","_0_0",";","else","{","float","qI","=","max","(","dot","(","oy",",","p_",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qm","*","pz",")","/","qI",";","float","dx","=","(","2.0","*","qm","*","qn",")","/","qI",";","float","g","=","min","(","min","(","a",",","b",")",",","dx",")",";","float","p","=","sqrt","(","pow","(","qF",",","2.0",")","+","pow","(","qI",",","2.0",")","-","_1_0",")",";","float","mm","=","pow","(","p","-","qI",",","2.0",")","/","pow","(","p","+","qI",",","2.0",")","*","(","_1_0","+","pow","(","qI","*","(","p","+","qI",")","-","_1_0",",","2.0",")","/","pow","(","qI","*","(","p","-","qI",")","+","_1_0",",","2.0",")",")",";","float","pT","=","acos","(","qm",")",";","qE","=","max","(","mm","*","g","*","exp","(","-","pow","(","pT",",","2.0",")","/","(","2.0","*","pow","(","qG",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","qN",",","qO",")","*","dot","(","oy",",","qO",")","<","_0_0",")","{","float","Fc","=","qP",".","x",";","float","Fd","=","qP",".","y",";","float","Fe","=","qP",".","z",";","float","Ff","=","qP",".","w",";","float","Fg","=","clamp","(","abs","(","dot","(","qN",",","qO",")",")",",","_0_0",",","_1_0",")",";","float","Fh","=","clamp","(","dot","(","oy",",","-","qN",")",",","_0_0",",","_1_0",")",";","float","Fi","=","pow","(","Fh",",","Fd",")",";","qU","=","qJ","+","qT","*","vec4","(","qS","*","Fg","*","pow","(","qQ",",","vec3","(","Fc",")",")",",","_1_0",")",";","qU","+=","Fe","*","mix","(","vec4","(","qQ",",","_1_0",")",",","vec4","(","_1_0",")",",","Ff",")","*","qT","*","vec4","(","qS","*","Fg","*","vec3","(","Fi",")",",","_1_0",")",";","}","else","{","qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";"]}]}]},{TYPE:"txt",TOKENS:["qV","=","qK","+","qS","*","qR","*","qM",";"]}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fj","=","u_node_rgbs","[","RGB_IND","]",";"]}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fl","=","dot","(","Fk",",","vec3","(","0.35",",","0.45",",","0.2",")",")",";"]}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fo",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fp",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fn","=","Fm",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fo"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fo","=","Fm",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fp","=","Fm",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Fu","=","kj","(","Fq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fr","=","Fu",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fs","=","Fu",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ft","=","Fu",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fy","=","_1_0","/","(","_1_0","+","pow","(","2.71828183",",","-","(","Fv","-","Fx",")","*","Fw",")",")",";"]}]},{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FB","=","Fz",";","if","(","FB",".","x",">","_0_0",")","FB",".","x","=","pow","(","Fz",".","x",",","FA",")",";","if","(","FB",".","y",">","_0_0",")","FB",".","y","=","pow","(","Fz",".","y",",","FA",")",";","if","(","FB",".","z",">","_0_0",")","FB",".","z","=","pow","(","Fz",".","z",",","FA",")",";"]}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FD","=","max","(","vec3","(","_0_0",")",",","FC",")",";","FD","=","pow","(","FD",",","vec3","(","2.2",")",")",";"]}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FF","=","max","(","vec3","(","_0_0",")",",","FE",")",";","FF","=","pow","(","FF",",","vec3","(","_1_0","/","2.2",")",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"FG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:["FG","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FH"],STATEMENTS:[{TYPE:"txt",TOKENS:["FH","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FI"],STATEMENTS:[{TYPE:"txt",TOKENS:["FI","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_CUBE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FK",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FL",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_CUBE_var_texture",QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FM","=","vec3","(","FJ",".","x",",","FJ",".","y",",","FJ",".","z",")",";","vec4","BN","=","GLSL_TEXTURE_CUBE","(","node_TEXTURE_ENVIRONMENT_CUBE_var_texture",",","FM",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FK"],STATEMENTS:[{TYPE:"txt",TOKENS:["FK","=","BN",".","xyz",";","bG","(","FK",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FL"],STATEMENTS:[{TYPE:"txt",TOKENS:["FL","=","BN",".","w",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR",NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","normalize","(","FN",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","sJ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["float","dF","=","-","atan","(","FP",".","y",",","FP",".","x",")","/","(","2.0","*","M_PI",")","+","_0_5",";","float","kU","=","atan","(","FP",".","z",",","sqrt","(","FP",".","x","*","FP",".","x","+","FP",".","y","*","FP",".","y",")",")","/","M_PI","+","_0_5",";","vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",",","vec2","(","dF",",","kU",")",")",";","FO","=","BN",".","xyz",";","bG","(","FO",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_MIRROR_BALL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","normalize","(","FQ",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","sJ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["FP",".","y","-=","_1_0",";","float","FS","=","2.0","*","sqrt","(","max","(","-","_0_5","*","FP",".","y",",","_0_0",")",")",";","if","(","FS",">","_0_0",")","FP","/=","FS",";","float","dF","=","_0_5","*","(","FP",".","x","+","_1_0",")",";","float","kU","=","_0_5","*","(","FP",".","z","+","_1_0",")",";","vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",",","vec2","(","dF",",","kU",")",")",";","FR","=","BN",".","xyz",";","bG","(","FR",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"CONVERT_UV",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FW",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FX",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FY",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"F_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ga",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gb",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gd",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FT",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FT",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FX"],STATEMENTS:[{TYPE:"txt",TOKENS:["FX","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FX",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FY"],STATEMENTS:[{TYPE:"txt",TOKENS:["FY","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FU",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FU",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["FZ","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FZ",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_F_"],STATEMENTS:[{TYPE:"txt",TOKENS:["F_","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FV",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FV",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ga"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ga","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Ga",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gb","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FW",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FW",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gc"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gc","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Gc",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gd"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gd","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Ge",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gi"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gi","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gj"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gj","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gf",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gk"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gk","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gl"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gl","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gg",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gm"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gm","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gn","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gh",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Go"],STATEMENTS:[{TYPE:"txt",TOKENS:["Go","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gp","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Gq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gq","=","u_node_values","[","VALUE_ROW_IND","]","[","VALUE_COL_IND","]",";"]}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gt","=","Gr","+","Gs",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gu"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gu","=","(","abs","(","Gt","[","0","]",")","+","abs","(","Gt","[","1","]",")","+","abs","(","Gt","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gx","=","Gv","-","Gw",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gy"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gy","=","(","abs","(","Gx","[","0","]",")","+","abs","(","Gx","[","1","]",")","+","abs","(","Gx","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","Gz","+","GA",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GC"],STATEMENTS:[{TYPE:"txt",TOKENS:["GC","=","length","(","GB",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GB"],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","normalize","(","GB",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GF","=","vec3","(","_0_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GG"],STATEMENTS:[{TYPE:"txt",TOKENS:["GG","=","dot","(","GD",",","GE",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GJ","=","cross","(","GH",",","GI",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GK"],STATEMENTS:[{TYPE:"txt",TOKENS:["GK","=","length","(","GJ",")",";","GJ","/=","GK",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["GJ","=","normalize","(","GJ",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GO",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GN","=","normalize","(","GL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GO"],STATEMENTS:[{TYPE:"txt",TOKENS:["GO","=","length","(","GL",")",";"]}]}]},{TYPE:"txt",TOKENS:["GM",";"]}]},{TYPE:"node",NAME:"FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_FRESNEL_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"GP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GR",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_FRESNEL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","normalize","(","GQ",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","normalize","(","oy",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","u_camera_direction",";"]}]}]},{TYPE:"txt",TOKENS:["float","su","=","max","(","GP",",","0.00001",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","==","false","?","su",":","_1_0","/","su",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","?","su",":","_1_0","/","su",";"]}]}]},{TYPE:"txt",TOKENS:["GR","=","sv","(","Bp",",","cw",",","su",")",";"]}]},{TYPE:"node",NAME:"BACKGROUND",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GU",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GU","=","GS","*","GT",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GX","=","reflect","(","_","(","u_view_tsr_inverse",",","GV",")",",","GW",")",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GZ","=","reflect","(","-","oy",".","xyz",",","GY",")",";"]}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"G_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ha",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hb",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hc",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","sR",")",";","if","(","bS","<","Hc",")","{","vec2","ce","=","so","(","G_",")",";","float","ci","=","clamp","(","_0_5","*","(","Hc","-","bS",")",",","_0_0",",","_1_0",")",";","float","hK","=","Ha","*","ci",";","vec3","ck","=","normalize","(","oy","*","sO",")",";","float","cl","=","_1_0","/","Hb",";","vec2","cm","=","ck",".","xy","*","hK","/","(","Hb","*","ck",".","z",")",";","float","cn","=","_1_0",";","float","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","for","(","float","cq","=","1.0",";","cq","<=","Hb",";","cq","++",")","{","if","(","co","<","cn",")","{","cn","-=","cl",";","ce","-=","cm",";","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","}","}","vec2","cr","=","ce","+","cm",";","float","cs","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","cr",")",".","a","-","(","cn","+","cl",")",";","float","ct","=","co","-","cn",";","float","cu","=","ct","/","(","ct","-","cs",")",";","ce","=","cu","*","cr","+","(","_1_0","-","cu",")","*","ce",";","Hd","=","sn","(","ce",")",";","}","else","Hd","=","G_",";"]}]},{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"He",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","=","clamp","(","He",",","_0_0",",","_1_0",")",";"]}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hi","=","sm","(","Hg",",","Hh",")",";"]}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ho",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Hp",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ho"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ho","=","Hj",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hp","=","vec4","(","Hk",",","Hl",",","Hm",",","Hn",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Hq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hq","=","u_time",";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ht",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hu","=","smoothstep","(","Hs",",","Ht",",","Hr",")",";"]}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","Hv",";","I","=","Hw",";"]}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hy","=","(","Hx",".","r","+","Hx",".","g","+","Hx",".","b",")","/","3.0",";"]}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"HA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HA","[","0","]","=","Hz",";","HA","[","1","]","=","Hz",";","HA","[","2","]","=","Hz",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","oy",",","out","vec3","E",",","out","vec3","F",",","out","vec3","G",",","out","vec4","H",",","out","float","I",")","{","E","=","vec3","(","_0_0",")",";","F","=","vec3","(","_0_0",")",";","G","=","vec3","(","_0_0",")",";","H","=","vec4","(","_0_0",")",";","I","=","_0_0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["IS_WORLD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sJ","=","-","oy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_GL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ow","=","-","oy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEX_COORD_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","oy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","oy",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sL","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["sL","=","sL",";","else","sL","=","-","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sM","=","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sN","=","normalize","(","sL",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","sN",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","normalize","(","j",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","sN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sN",",","k",".","xyz",")","*","k",".","w",";","mat3","sO","=","mat3","(","k",".","xyz",",","W",",","sN",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sP","=","cross","(","sL",",","k",".","xyz",")","*","k",".","w",";","mat3","sQ","=","mat3","(","k",".","xyz",",","sP",",","sL",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","ow","=","h",";","vec4","sR","=","i",";","float","sS","=","u_emit",";","float","sT","=","u_ambient",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2},"PARTICLE_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_orco_tex_coord",";","GLSL_OUT","vec3","sj",";"]}]}}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_TEX_COORD_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sD",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sD","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UV_MERGED_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sC",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sC","=","node_UV_MERGED_var_a_uv",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UVMAP_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sE",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sE","=","node_UVMAP_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sw",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sw","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HB",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HB","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC1_var_a_vertex_color",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HC",QUALIFIER:["GLSL_OUT","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HC","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC2_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HD",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HD","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC3_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HE",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HE","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sj","=","a_orco_tex_coord",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PACK_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PACK_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec4","eu","(","const","in","float","iq",")","{","vec4","fu","=","vec4","(","_255_0","*","_255_0","*","_255_0",",","_255_0","*","_255_0",",","_255_0",",","_1_0",")",";","vec4","HF","=","vec4","(","_0_0",",","_1_0","/","_255_0",",","_1_0","/","_255_0",",","_1_0","/","_255_0",")",";","vec4","jF","=","fract","(","iq","*","fu",")",";","jF","-=","jF",".","xxyz","*","HF",";","return","jF",";","}","float","cV","(","const","in","vec4","HG",")","{","float","et",";","vec4","fu","=","vec4","(","_1_0","/","(","_255_0","*","_255_0","*","_255_0",")",",","_1_0","/","(","_255_0","*","_255_0",")",",","_1_0","/","_255_0",",","_1_0",")",";","et","=","dot","(","HG",",","fu",")",";","return","et",";","}","vec4","eu","(","const","in","vec2","rk",")","{","vec2","fu","=","vec2","(","_255_0",",","_1_0",")",";","vec2","HF","=","vec2","(","_0_0",",","_1_0","/","_255_0",")",";","vec4","jF","=","fract","(","rk",".","xxyy","*","fu",".","xyxy",")",";","jF","-=","jF",".","xxzz","*","HF",".","xyxy",";","if","(","rk",".","r","==","_1_0",")","jF",".","rg","=","vec2","(","_0_0",",","_1_0",")",";","if","(","rk",".","g","==","_1_0",")","jF",".","ba","=","vec2","(","_0_0",",","_1_0",")",";","return","jF",";","}","vec2","jk","(","const","in","vec4","HH",")","{","vec2","rk",";","vec2","fu","=","vec2","(","_1_0","/","_255_0",",","_1_0",")",";","rk",".","r","=","dot","(","HH",".","rg",",","fu",")",";","rk",".","g","=","dot","(","HH",".","ba",",","fu",")",";","return","rk",";","}"]}]}}]}]},e["include/particles.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["struct","dc","{","float","di",";","vec3","O",";","float","L",";","vec3","aQ",";","float","bP",";","vec3","dp",";","vec3","dq",";","float","dr",";","}",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","HL","(","inout","vec3","aQ",",","float","HI",",","vec4","kf",",","vec4","bz",")","{","float","HJ","=","bz",".","x","-","kf",".","x",";","float","HK","=","(","HI","-","kf",".","x",")","/","HJ",";","aQ","=","mix","(","aQ",",","bz",".","yzw",",","clamp","(","HK",",","0.0",",","1.0",")",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","HO","(","float","t",",","float","HM",",","vec4","HN","[","COLOR_RAMP_LENGTH","]",")","{","float","HI","=","t","/","HM",";","vec3","aQ","=","HN","[","0","]",".","yzw",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["HL","(","aQ",",","HI",",","HN","[","0","]",",","HN","[","1","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["HL","(","aQ",",","HI",",","HN","[","1","]",",","HN","[","2","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["HL","(","aQ",",","HI",",","HN","[","2","]",",","HN","[","3","]",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}"]}]}}]},{TYPE:"txt",TOKENS:["float","HU","(","float","t",",","float","HM",",","float","HP",",","float","HQ",")","{","float","HR","=","max","(","0.01",",","min","(","HM",",","HP",")",")",";","float","HS","=","max","(","0.01",",","min","(","HM",",","HQ",")",")",";","float","HT","=","HM","-","HS",";","float","L","=","clamp","(","t","/","HR",",","0.0",",","1.0",")","-","step","(","HT",",","t",")","*","(","t","-","HT",")","/","HS",";","return","L",";","}","dc","dd","(",")","{","dc","sp",";","float","t",";","float","HM","=","a_p_data","[","0","]",";","float","HV","=","a_p_data","[","1","]",";","if","(","u_p_cyclic","==","1",")","{","t","=","mod","(","u_p_time",",","u_p_length",")","-","HV",";","if","(","t","<","0.0",")","t","+=","u_p_length",";","}","if","(","u_p_cyclic","!=","1",")","{","t","=","u_p_time","-","HV",";","}","if","(","t","<","0.0","||","t",">=","HM",")","{","sp",".","di","=","0.0001",";","sp",".","O","=","vec3","(","99999.0",",","0.0",",","0.0",")",";","}","if","(","!","(","t","<","0.0","||","t",">=","HM",")",")","{","vec4","S","=","R","(","a_tbn",")",";","vec3","ca","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fr","=","a_position",";","vec3","rz","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fr","=","ap","(","u_model_tsr",",","a_position",")",";","vec3","rz","=","bI","(","u_model_tsr",",","ca",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","HW","=","u_p_nfactor","*","rz",";","HW","+=","a_p_vels",".","xyz",";","HW",".","z","-=","u_p_gravity","*","t","/","2.0",";","float","HX","=","max","(","u_p_mass",",","EPSILON",")",";","HW","+=","(","u_p_wind_fac","*","u_wind","/","HX",")","*","t","/","2.0",";","sp",".","dr","=","t",";","sp",".","dp","=","HW",";","sp",".","dq","=","ca","*","a_p_vels",".","w",";","sp",".","O","=","fr","+","HW","*","t",";","sp",".","bP","=","a_p_vels",".","w","*","t",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","di","=","GLSL_TEXTURE","(","u_color_ramp_tex",",","vec2","(","t","/","u_p_max_lifetime",",","0.5",")",")",".","g",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","di","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","aQ","=","HO","(","t",",","u_p_max_lifetime",",","u_p_color_ramp",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","aQ","=","vec3","(","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["sp",".","L","=","HU","(","t",",","a_p_data","[","0","]",",","u_p_fade_in",",","u_p_fade_out",")",";","}","return","sp",";","}"]}]}}]}]},e["include/particles_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kj","(","vec3","rgb",")","{","vec4","hM","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hM",".","wz",")",",","vec4","(","rgb",".","gb",",","hM",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dC","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iF","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dC","+","iF",")",")",",","dC","/","(","q",".","x","+","iF",")",",","q",".","x",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kl","(","vec3","kk",")","{","vec4","hM","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kk",".","r",",","kk",".","r",",","kk",".","r",")","+","hM",".","xyz",")","*","6.0","-","hM",".","www",")",";","return","kk",".","b","*","mix","(","hM",".","xxx",",","clamp","(","p","-","hM",".","xxx",",","_0_0",",","_1_0",")",",","kk",".","g",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sn","(","vec2","gX",")","{","return","vec3","(","gX","*","2.0","-","vec2","(","_1_0",",","_1_0",")",",","_0_0",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","so","(","vec3","rk",")","{","return","vec2","(","rk",".","xy","*","_0_5","+","vec2","(","_0_5",",","_0_5",")",")",";","}"]}]}}]},{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sU"],STATEMENTS:[{TYPE:"txt",TOKENS:["sU","=","normalize","(","sR",".","xyz",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sV"],STATEMENTS:[{TYPE:"txt",TOKENS:["sV","=","abs","(","sR",".","z",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sW"],STATEMENTS:[{TYPE:"txt",TOKENS:["sW","=","length","(","sR",".","xyz",")",";"]}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["s_","=","vec3","(","sX",",","sY",",","sZ",")",";"]}]},{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ta",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["td","=","kl","(","vec3","(","ta",",","tb",",","tc",")",")",";"]}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["te","=","vec3","(","-","_1_0",",","-","_1_0",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tf","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tg",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tg","=","sn","(","A",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["th","=","2.0","*","vec3","(","A",",","_0_0",")","-","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ti","=","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tj","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tk","=","_1_0",";","tl","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tm","=","_1_0",";","tn","=","_1_0",";","to","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","tr",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","sK",".","xyz",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tx","=","-","_","(","u_view_tsr_frag",",","oy",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ty","[","0","]","=","sR","[","0","]",";","ty","[","1","]","=","sR","[","1","]",";","ty","[","2","]","=","sR","[","2","]",";"]}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tz","=","vec3","(","ow",".","r",",","ow",".","g",",","ow",".","b",")",";"]}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tB","=","vec3","(","_0_0",")",";","tC","=","vec3","(","_0_0",")",";","tD","=","vec3","(","_0_0",")",";","tE","=","vec3","(","_0_0",")",";","tF","=","vec3","(","_0_0",")",";","tG","=","vec3","(","_0_0",")",";","tH","=","_0_0",";","tI","=","_0_0",";"]}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","kk","=","kj","(","tN",")",";","kk","[","0","]","+=","(","tJ","-","_0_5",")",";","if","(","kk","[","0","]",">","_1_0",")","kk","[","0","]","-=","_1_0",";","else","if","(","kk","[","0","]","<","_0_0",")","kk","[","0","]","+=","_1_0",";","kk","*=","vec3","(","_1_0",",","tK",",","tL",")",";","kk","=","mix","(","vec3","(","_1_0",")",",","mix","(","vec3","(","_0_0",")",",","kk",",","step","(","vec3","(","_0_0",")",",","kk",")",")",",","step","(","kk",",","vec3","(","_1_0",")",")",")",";","tO","=","mix","(","tN",",","kl","(","kk",")",",","tM",")",";"]}]},{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tR","=","mix","(","tQ",",","vec3","(","_1_0",")","-","tQ",",","tP",")",";"]}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tS",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:["tS","=","u_lamp_light_color_intensities","[","LAMP_INDEX","]",";"]}]}]},{TYPE:"txt",TOKENS:["vec3","tW","=","u_lamp_light_directions","[","LAMP_INDEX","]",";","vec3","tX","=","u_lamp_light_positions","[","LAMP_INDEX","]",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","-","h","+","tX",";","tU","=","length","(","tT",")",";","tT","=","normalize","(","tT",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","tU","*","tU",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pb","=","dot","(","tT",",","tW",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","tV","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","*=","max","(","LAMP_LIGHT_DIST","-","tU",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tT"],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","tW",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tU"],STATEMENTS:[{TYPE:"txt",TOKENS:["tU","=","length","(","tX","-","h",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"t_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tZ","=","sB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_t_"],STATEMENTS:[{TYPE:"txt",TOKENS:["t_","=","-","dot","(","tY",",","sB",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ub","=","-","_","(","u_view_tsr_frag",",","ua",")",";"]}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ud",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ue",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ug",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ur",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ut",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uw",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ux",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ur","=","ud",";","us","=","uf",";","ut","=","ui",";","ux","=","ud",";","uy","=","uf",";","metalness_out","=","uh",";","uz","=","ul",";","uA","=","um",";","uB","=","un",";","uC","=","uo",";","up","=","sS","*","ur",";","uq","=","sT","*","u_environment_energy","*","cE","(","ut",")",";","uw","=","cH","(","ur",")",";","H","=","uw",";","uu","[","0","]","=","ue",";","uu","[","1","]","=","ug",";","uu","[","2","]","=","uh",";"]}]},{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uD",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uG",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","=","uD",".","rgb","+","uE",";","uO","=","mix","(","uO",",","uK",",","uL",")",";","I","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","uR","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bG","(","uR",")",";","uM","=","uM","*","uR",";","uO","+=","uM",";"]}]}]},{TYPE:"txt",TOKENS:["uF",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uZ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"u_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"va",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vb",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","u_",";","float","uU","=","clamp","(","vb","[","0","]",",","_0_0",",","_1_0",")",";","float","uQ","=","clamp","(","vb","[","1","]",",","_0_0",",","_1_0",")",";","float","rW","=","vb","[","2","]",";","vec3","p_","=","normalize","(","oy","+","uY",")",";","float","pj","=","(","_1_0","-","va",")","*","dot","(","rz",",","uY",")","+","va",";","float","vf","=","(","_1_0","-","va",")","*","max","(","dot","(","uY",",","p_",")",",","_0_0",")","+","va",";","float","vg","=","(","_1_0","-","va",")","*","max","(","dot","(","u_",",","p_",")",",","_0_0",")","+","va",";","vc","=","_0_0",";","if","(","uZ",".","r","!=","_0_0",")","{","if","(","uU",">","_0_0",")","{","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","float","pA","=","uU","*","uU",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","uY","-","pj","*","rz",";","vec3","pC","=","oy","-","pz","*","rz",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","vc","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","vc","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","vc","=","pj",";","vc","=","max","(","vc",",","_0_0",")",";","}","float","L","=","uQ",";","float","vh","=","L","*","L",";","float","d_","=","(","vg","*","vh","-","vg",")","*","vg","+","_1_0",";","float","cD","=","vh","/","(","M_PI","*","d_","*","d_",")",";","float","vi",";","float","vj",";","float","vl","=","pow","(","_1_0","-","vf",",","5.0",")",";","vi","=","_1_0",";","vj","=","vl",";","float","hM","=","L","/","2.0",";","float","vm","=","hM","*","hM",";","float","vn","=","_1_0","-","vm",";","float","vo","=","_1_0","/","(","vf","*","vf","*","vn","+","vm",")",";","vi","*=","vo",";","vj","*=","vo",";","float","rR","=","mix","(","0.04",",","_1_0",",","rW",")",";","float","vp","=","mix","(","vj",",","vi",",","rR",")",";","vd","=","max","(","pj","*","cD","*","vp",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vP","=","vJ",";","vK",";","vL",";","vM",";","vN",";","vO",";"]}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vU","=","vQ",";","vV","=","vR",";","vY","=","_0_0",";","wc","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","vS",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["vT",";","vW",";","vX",";","wb",";","wd",";","we",";"]}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wj","=","wf",";","wg",";","wh",";","wi",";"]}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wq","=","wk",";","wr","=","wl",";","ws","=","_1_0",";","wB","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","wm",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["wn",";","wo",";","wp",";","wA",";","wC",";","wD",";"]}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wI","=","wE",";","wF",";","wG",";","wH",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wV","=","wJ",";","wP","=","_0_0",";","wU","=","_0_0",";","wW","=","_0_0",";","wQ","=","ox",";","wK",";","wL",";","wM",";","wN",";","wO",";","wT",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wZ","=","wX",";","wY",";"]}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xd","[","0","]","=","xd","[","1","]","=","xd","[","2","]","=","_0_0",";","w_",";","xa",";","xb",";","xc",";"]}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xi","=","xe",";","xf",";","xg",";","xh",";"]}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xm","=","xj",";","xk",";","xl",";"]}]},{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xt","[","0","]","=","xt","[","1","]","=","xt","[","2","]","=","_0_0",";","xn",";","xp",";","xq",";","xr",";","xs",";","xo",";"]}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xJ","=","xv","*","xu",";","xF","=","_0_0",";","xK","=","_1_0",";","xG","=","ox",";","xA",";","xB",";","xC",";","xD",";","xE",";","xL",";","xM",";"]}]},{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xO","[","0","]","=","xO","[","1","]","=","xO","[","2","]","=","_0_0",";","xN",";"]}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xP","[","0","]","=","xP","[","1","]","=","xP","[","2","]","=","_0_0",";"]}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xS","[","0","]","=","xS","[","1","]","=","xS","[","2","]","=","_0_0",";","xQ",";","xR",";"]}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xW","[","0","]","=","xW","[","1","]","=","xW","[","2","]","=","_0_0",";","xT",";","xU",";","xV",";"]}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ib",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ic",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Id",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ya","=","Id",";","Ib",";","Ic",";","xZ",";"]}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yi","=","ox",";","yh",";"]}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","yl",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","sM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym","=","sQ","*","ym",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";","ym","=","bI","(","u_model_tsr",",","ym",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["float","me","=","max","(","yj",",","_0_0",")",";","ym","=","normalize","(","mix","(","yn",",","ym",",","me",")",")",";"]}]},{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","yo",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";","yp","=","ap","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";","yp","=","ap","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";","yp","=","_","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";","yp","=","_","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","normalize","(","yp",")",";"]}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yr","[","0","]","=","yr","[","1","]","=","yr","[","2","]","=","_0_0",";","yq",";"]}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yt","[","0","]","=","yt","[","1","]","=","yt","[","2","]","=","_0_0",";","ys",";"]}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yv","=","yu","[","0","]",";","yA","=","yu","[","1","]",";","yB","=","yu","[","2","]",";"]}]},{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yF","[","0","]","=","yC",";","yF","[","1","]","=","yD",";","yF","[","2","]","=","yE",";"]}]},{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","b","=","yH","-","yI","*","_0_5",";","yJ","=","max","(","(","_1_0","+","yI",")","*","yG","+","b",",","vec3","(","_0_0",")",")",";"]}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yM","=","yN","=","yO","=","_0_0",";","yK",";","yL",";"]}]},{TYPE:"node",NAME:"TEX_IMAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ie",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"If",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ig",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["If","[","0","]","=","If","[","1","]","=","If","[","2","]","=","_0_0",";","Ig","=","_1_0",";","Ie",";"]}]},{TYPE:"node",NAME:"TEX_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ih",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ii",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ii","[","0","]","=","Ii","[","1","]","=","Ii","[","2","]","=","_0_0",";","Ih",";"]}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yQ","[","0","]","=","yQ","[","1","]","=","yQ","[","2","]","=","_0_0",";","yP",";"]}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yV","[","0","]","=","yV","[","1","]","=","yV","[","2","]","=","_0_0",";","yW","=","_1_0",";","yR",";","yS",";","yT",";","yU",";"]}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"za",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zb","[","0","]","=","zb","[","1","]","=","zb","[","2","]","=","_0_0",";","zc","=","_1_0",";","yX",";","yY",";","yZ",";","y_",";","za",";"]}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ze",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zf","[","0","]","=","zf","[","1","]","=","zf","[","2","]","=","_0_0",";","zg","=","_1_0",";","zd",";","ze",";"]}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zo","[","0","]","=","zo","[","1","]","=","zo","[","2","]","=","_0_0",";","zp","=","_1_0",";","zh",";","zi",";","zj",";","zk",";","zl",";","zm",";","zn",";"]}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zr","[","0","]","=","zr","[","1","]","=","zr","[","2","]","=","_0_0",";","zs","=","_1_0",";","zq",";"]}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zA","[","0","]","=","zA","[","1","]","=","zA","[","2","]","=","_0_0",";","zB","=","_1_0",";","zt",";","zu",";","zv",";"]}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zG","[","0","]","=","zG","[","1","]","=","zG","[","2","]","=","_0_0",";","zH","=","_1_0",";","zC",";","zD",";","zE",";","zF",";"]}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zR","[","0","]","=","zR","[","1","]","=","zR","[","2","]","=","_0_0",";","zS","=","_1_0",";","zI",";","zJ",";","zK",";","zL",";","zM",";","zN",";","zO",";","zP",";","zQ",";"]}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zV","=","clamp","(","zT","+","zU",",","vec3","(","_0_0",")",",","vec3","(","_1_0",")",")",";"]}]},{TYPE:"node",NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"z_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ac",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ad",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ah",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ai",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ak",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Al",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Am",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ap",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"At",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Au",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ax",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","zW",",","_0_0",",","_1_0",")",";","Ax","=","mix","(","zZ",",","Ak",",","AJ",")",";","Ay","=","mix","(","z_",",","Al",",","AJ",")",";","if","(","Ac",">","_0_0",")","{","if","(","Ao",">","_0_0",")","{","Az","=","mix","(","Aa",",","Am",",","AJ",")",";","AA","=","mix","(","Ab",",","An",",","AJ",")",";","}","else","{","Az","=","Aa",";","AA","=","Ab",";","}","}","else","{","Az","=","Am",";","AA","=","An",";","}","if","(","Ah",">","_0_0",")","{","if","(","At",">","_0_0",")","{","AF","=","mix","(","Ag",",","As",",","AJ",")",";","}","else","{","AF","=","Ag",";","}","}","else","{","AF","=","As",";","}","AB","=","mix","(","Ac",",","Ao",",","AJ",")",";","AC","=","mix","(","Ad",",","Ap",",","AJ",")",";","AG","=","mix","(","Ah",",","At",",","AJ",")",";","AH","=","mix","(","Ai",",","Au",",","AJ",")",";","AI","=","mix","(","Aj",",","Av",",","AJ",")",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AK"],STATEMENTS:[{TYPE:"txt",TOKENS:["AK","=","sn","(","A",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AL"],STATEMENTS:[{TYPE:"txt",TOKENS:["AL","=","vec3","(","A",",","_0_0",")",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AM","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AN","=","ox",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AP","[","0","]","=","AP","[","1","]","=","AP","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AQ","[","0","]","=","sR","[","0","]",";","AQ","[","1","]","=","sR","[","1","]",";","AQ","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AR","[","0","]","=","AR","[","1","]","=","AR","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AS","[","0","]","=","AS","[","1","]","=","AS","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AT","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"A_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HY",QUALIFIER:["GLSL_IN","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"HZ",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"H_",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Ia",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PARTICLE_BATCH"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AU"],STATEMENTS:[{TYPE:"txt",TOKENS:["AU","=","HY","[","0","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AV"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","HY","[","1","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AW"],STATEMENTS:[{TYPE:"txt",TOKENS:["AW","=","HY","[","2","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AX"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","HZ",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AY"],STATEMENTS:[{TYPE:"txt",TOKENS:["AY","=","HY","[","3","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["AZ","=","H_",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_A_"],STATEMENTS:[{TYPE:"txt",TOKENS:["A_","=","Ia",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AU","=","_0_0",";","AV","=","_0_0",";","AW","=","_0_0",";","AX","=","vec3","(","_0_0",")",";","AY","=","_0_0",";","AZ","=","AX",";","A_","=","AX",";"]}]}]}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ba",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ba","=","_0_0",";","Bb","=","_0_0",";","Bc","=","_0_0",";","Bd","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Be",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","_0_0",";","Bg","=","_0_0",";","Bh","=","_0_0",";","Be","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bj","=","Bi",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bk","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ij",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ik",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bn","=","Bo","=","_0_0",";","Ik",";","Ij",";"]}]},{TYPE:"node",NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"By",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bq","=","Br","=","Bs","=","_0_0",";","Bt","=","Bu","=","Bv","=","_0_0",";","Bw","=","Bw","=","By","=","Bz","=","_0_0",";","Bx","=","_0_0",";"]}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"BB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BB","=","BC","=","vec3","(","_0_0",")",";","BD","=","_0_0",";"]}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["0.0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","BF",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","r","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","r","+","_0_5",",","NODE_TEX_ROW",")",")",".","r","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","g","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","g","+","_0_5",",","NODE_TEX_ROW",")",")",".","g","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","b","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","b","+","_0_5",",","NODE_TEX_ROW",")",")",".","b","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"txt",TOKENS:["BG","=","mix","(","BF",",","BG",",","BE",")",";"]}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","r",",","NODE_TEX_ROW",")",")",".","a",";","float","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","g",",","NODE_TEX_ROW",")",")",".","a",";","float","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","b",",","NODE_TEX_ROW",")",")",".","a",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","BI",".","r",";","float","g","=","BI",".","g",";","float","b","=","BI",".","b",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","r",",","NODE_TEX_ROW",")",")",".","r",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","g",",","NODE_TEX_ROW",")",")",".","g",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","b",",","NODE_TEX_ROW",")",")",".","b",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","b",";"]}]}]},{TYPE:"txt",TOKENS:["BJ","=","mix","(","BI",",","BJ",",","BH",")",";"]}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BK",",","NODE_TEX_ROW",")",")",";","BL","=","BN",".","rgb",";","BM","=","BN",".","a",";"]}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BO",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","*","MAPPING_SCALE",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","+","MAPPING_TRANS",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","(","MAPPING_TRS_MATRIX","*","vec4","(","BP",",","_1_0",")",")",".","xyz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","max","(","BP",",","MAPPING_MIN_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","min","(","BP",",","MAPPING_MAX_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","normalize","(","BP",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","BQ","+","BR",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","clamp","(","BS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","BT","-","BU",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","clamp","(","BV",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","BW","*","BX",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","clamp","(","BY",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","(","B_","!=","_0_0",")","?","BZ","/","B_",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","clamp","(","Ca",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","sin","(","Cb",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","clamp","(","Cd",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cc",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ce",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","cos","(","Ce",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","clamp","(","Cg",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cf",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ch",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ci",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","tan","(","Ch",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","clamp","(","Cj",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Ci",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ck",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","(","Ck","<=","_1_0","&&","Ck",">=","-","_1_0",")","?","asin","(","Ck",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","clamp","(","Cm",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cl",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","(","Cn","<=","_1_0","&&","Cn",">=","-","_1_0",")","?","acos","(","Cn",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","clamp","(","Cp",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Co",";"]}]},{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","atan","(","Cq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","clamp","(","Cs",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cr",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ct",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","Ct","<","_0_0","&&","Cu","!=","floor","(","Cu",")",")","Cv","=","_0_0",";","else","if","(","Cu","==","_0_0",")","Cv","=","_1_0",";","else","if","(","Ct","<","_0_0",")","Cv","=","mix","(","_1_0",",","-","_1_0",",","sign","(","mod","(","-","Cu",",","2.0",")",")",")","*","pow","(","-","Ct",",","Cu",")",";","else","if","(","Ct","==","_0_0",")","Cv","=","_0_0",";","else","Cv","=","pow","(","Ct",",","Cu",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cv","=","clamp","(","Cv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","(","Cw",">","_0_0","&&","Cx",">","_0_0",")","?","log2","(","Cw",")","/","log2","(","Cx",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","clamp","(","Cy",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","min","(","Cz",",","CA",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","clamp","(","CB",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","max","(","CC",",","CD",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","clamp","(","CE",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","floor","(","CF","+","_0_5",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","clamp","(","CH",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CG",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CK",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","(","CI","<","CJ",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","clamp","(","CK",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CN",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","(","CL",">","CM",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","clamp","(","CN",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","abs","(","CP",")",">","0.000001","?","mod","(","CO",",","CP",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","clamp","(","CQ",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CT",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","abs","(","CR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","clamp","(","CT",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CS",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CU",",","_0_0",",","_1_0",")",";","CX","=","mix","(","CV",",","CW",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CX","=","clamp","(","CX",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Da",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CY",",","_0_0",",","_1_0",")",";","Da","=","mix","(","CZ",",","CZ","+","C_",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Da","=","clamp","(","Da",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Db",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"De",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Db",",","_0_0",",","_1_0",")",";","De","=","mix","(","Dc",",","Dc","*","Dd",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["De","=","clamp","(","De",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Df",",","_0_0",",","_1_0",")",";","Di","=","mix","(","Dg",",","Dg","-","Dh",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Di","=","clamp","(","Di",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dj",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dm","=","vec3","(","_1_0",")","-","(","vec3","(","Dn",")","+","AJ","*","(","vec3","(","_1_0",")","-","Dl",")",")","*","(","vec3","(","_1_0",")","-","Dk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dm","=","clamp","(","Dm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Do",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Do",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dq","+=","step","(","Dq",",","vec3","(","_0_0",")",")",";","Dr","=","Dn","*","Dp","+","AJ","*","Dp","/","Dq",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dr","=","clamp","(","Dr",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ds",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dv",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ds",",","_0_0",",","_1_0",")",";","Dv","=","mix","(","Dt",",","abs","(","Dt","-","Du",")",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dv","=","clamp","(","Dv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dw",",","_0_0",",","_1_0",")",";","Dz","=","min","(","Dx",".","rgb",",","Dy",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dz","=","clamp","(","Dz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DA",",","_0_0",",","_1_0",")",";","DD","=","max","(","DB",".","rgb",",","DC",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DD","=","clamp","(","DD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DE",",","_0_0",",","_1_0",")",";","vec3","DI","=","vec3","(","_1_0","-","AJ",")",";","DH","=","mix","(","DF","*","(","DI","+","2.0","*","AJ","*","DG",")",",","vec3","(","_1_0",")","-","(","DI","+","2.0","*","AJ","*","(","vec3","(","_1_0",")","-","DG",")",")","*","(","vec3","(","_1_0",")","-","DF",")",",","step","(","_0_5",",","DF",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DH","=","clamp","(","DH",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DJ",",","_0_0",",","_1_0",")",";","vec3","DN","=","vec3","(","_1_0",")","-","AJ","*","DL",";","vec3","DO","=","clamp","(","DK","/","DN",",","_0_0",",","_1_0",")",";","DM","=","mix","(","mix","(","DO",",","vec3","(","_1_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",",","DK",",","step","(","DK",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DM","=","clamp","(","DM",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DP",",","_0_0",",","_1_0",")",";","vec3","ks","=","vec3","(","_1_0","-","AJ",")",";","vec3","DN","=","ks","+","AJ","*","DR",";","vec3","DO","=","clamp","(","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","DQ",")","/","DN",",","_0_0",",","_1_0",")",";","DS","=","mix","(","DO",",","vec3","(","_0_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","clamp","(","DS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DT",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","DW","=","DU",";","DX","=","kj","(","DV",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","DW",")",";","kk",".","x","=","DX",".","x",";","DN","=","kl","(","kk",")",";","DW","=","mix","(","DW",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","clamp","(","DW",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DY",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Ea","=","DZ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ea",")",";","if","(","kk",".","y","!=","_0_0",")","{","DX","=","kj","(","D_",")",";","kk",".","y","=","Dn","*","kk",".","y","+","AJ","*","DX",".","y",";","Ea","=","kl","(","kk",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ea","=","clamp","(","Ea",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ee",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eb",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ec",")",";","DX","=","kj","(","Ed",")",";","kk",".","z","=","Dn","*","kk",".","z","+","AJ","*","DX",".","z",";","Ee","=","kl","(","kk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ee","=","clamp","(","Ee",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ef",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ef",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","Ei","=","Eg",";","DX","=","kj","(","Eh",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","Ei",")",";","kk",".","x","=","DX",".","x",";","kk",".","y","=","DX",".","y",";","DN","=","kl","(","kk",")",";","Ei","=","mix","(","Ei",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ei","=","clamp","(","Ei",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ej",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ek",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"El",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Em",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ej",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","En","=","El","+","Ek","-","El","*","Ek",";","Em","=","Ek","*","(","vec3","(","Dn",")","+","vec3","(","AJ",")","*","(","(","vec3","(","_1_0",")","-","Ek",")","*","El","+","En",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Em","=","clamp","(","Em",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ep",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eo",",","_0_0",",","_1_0",")",";","Er","=","Ep","+","AJ","*","(","2.0","*","Eq","-","vec3","(","_1_0",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Er","=","clamp","(","Er",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EA",";","I","=","EB",";"]}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EC",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EC",";","I","=","_1_0",";"]}]},{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EJ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ER",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sF",QUALIFIER:["const","vec2"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sG",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","=","clamp","(","EF",",","_0_0",",","_1_0",")",";","EN","=","sG","[","0","]","*","clamp","(","EG",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","normalize","(","EI",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","EJ","*","EM",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","sS","*","EM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","*=","EH",";"]}]}]},{TYPE:"txt",TOKENS:["EL","=","sT","*","u_environment_energy","*","cE","(","EO",")",";","ER","=","vec4","(","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["EP","=","vec2","(","sF","[","0","]",",","sF","[","1","]",")",";","EQ","=","vec2","(","sG","[","1","]",",","sG","[","2","]",")",";"]}]}]},{TYPE:"txt",TOKENS:["H","=","ER",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","vec3","(","_0_0",")",";","EL","=","vec3","(","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"ES",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ET",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EW",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EX",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EY",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EZ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"E_",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EV",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EY"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","ES",".","rgb",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","+=","ET",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_E_"],STATEMENTS:[{TYPE:"txt",TOKENS:["E_","=","EU",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fa"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fa","=","ES",".","rgb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fb","=","ET",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","EX",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","EW",";","EZ","=","clamp","(","EX","*","(","_1_0","-","t",")","+","t",",","_0_0",",","_1_0",")",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","sH",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","sI",";","EZ","=","sH","*","(","_1_0","-","t",")","+","t",";"]}]}]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","ET",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["G","=","EU",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec4","(","oP","+","oR","*","oQ",",","_0_0",")",";","oT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oW","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oX","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","oU","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oZ","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oV","=","oZ","-","ow",";","float","aM","=","length","(","oV",")",";","oX","*=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oV","=","normalize","(","oV",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pa","=","u_light_directions","[","LAMP_IND","]",";","float","pb","=","dot","(","oV",",","pa",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","oX","*=","pb",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oV","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pc",",","k",".","xyz",")",";","pe","=","cross","(","pi",",","k",".","xyz",")",";","pe","=","-","normalize","(","pe",")",";"]}]}]},{TYPE:"txt",TOKENS:["ph","=","_0_0",";","if","(","pd",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pf",")","*","dot","(","pe",",","pc",")","+","pf",";","if","(","pg","[","0","]","==","_0_0",")","{","ph","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pj",")",";","t","=","pg","[","1","]","+","(","_1_0","-","pg","[","1","]",")","*","pow","(","t",",","pg","[","0","]",")",";","ph","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","ph","=","max","(","ph",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pk",",","k",".","xyz",")",";","pm","=","cross","(","pi",",","k",".","xyz",")",";","pm","=","-","normalize","(","pm",")",";"]}]}]},{TYPE:"txt",TOKENS:["po","=","_0_0",";","if","(","pl",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pn",")","*","dot","(","pm",",","pk",")","+","pn",";","po","=","max","(","pj",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pr",",","k",".","xyz",")",";","pv","=","cross","(","pi",",","k",".","xyz",")",";","pv","=","-","normalize","(","pv",")",";"]}]}]},{TYPE:"txt",TOKENS:["py","=","_0_0",";","if","(","pu",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pw",")","*","dot","(","pv",",","pr",")","+","pw",";","if","(","px","[","0","]",">","_0_0",")","{","float","pz","=","max","(","dot","(","pv",",","oy",")",",","_0_0",")",";","float","pA","=","px","[","0","]","*","px","[","0","]",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","pr","-","pj","*","pv",";","vec3","pC","=","oy","-","pz","*","pv",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","py","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","py","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","py","=","pj",";","py","=","max","(","py",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pH",",","k",".","xyz",")",";","pJ","=","cross","(","pi",",","k",".","xyz",")",";","pJ","=","-","normalize","(","pJ",")",";"]}]}]},{TYPE:"txt",TOKENS:["pM","=","_0_0",";","if","(","pI",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pK",")","*","dot","(","pJ",",","pH",")","+","pK",";","float","pz","=","max","(","dot","(","pJ",",","oy",")",",","_0_0",")",";","if","(","pL","[","0","]","<=","_1_0",")","pM","=","pj","*","pow","(","max","(","pz","*","pj",",","0.1",")",",","pL","[","0","]","-","_1_0",")",";","else","pM","=","pj","*","pow","(","1.0001","-","pz",",","pL","[","0","]","-","_1_0",")",";","pM","=","max","(","pM",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pN",",","k",".","xyz",")",";","pP","=","cross","(","pi",",","k",".","xyz",")",";","pP","=","-","normalize","(","pP",")",";"]}]}]},{TYPE:"txt",TOKENS:["pS","=","_0_0",";","if","(","pO",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pQ",")","*","dot","(","pP",",","pN",")","+","pQ",";","float","pT","=","acos","(","pj",")",";","if","(","pT","<","pR","[","0","]",")","pS","=","_1_0",";","else","if","(","pT",">","(","pR","[","0","]","+","pR","[","1","]",")","||","pR","[","1","]","==","_0_0",")","pS","=","_0_0",";","else","pS","=","_1_0","-","(","(","pT","-","pR","[","0","]",")","/","pR","[","1","]",")",";","pS","=","max","(","pS",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","_0_0",";","if","(","pV",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","pU","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pX","==","_0_0",")","{","pZ","=","dot","(","k",".","xyz",",","p_",")",";","pZ","=","sqrt","(","_1_0","-","pZ","*","pZ",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","(","_1_0","-","pX",")","*","max","(","dot","(","pW",",","p_",")",",","_0_0",")","+","pX",";"]}]}]},{TYPE:"txt",TOKENS:["pZ","=","pow","(","pZ",",","pY","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","_0_0",";","if","(","qb",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qa","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","qd","==","_0_0",")","{","qf","=","dot","(","B",".","xyz",",","p_",")",";","qf","=","sqrt","(","_1_0","-","qf","*","qf",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","max","(","dot","(","qc",",","p_",")",",","_0_0",")",";","qf","=","(","_1_0","-","qd",")","*","qf","+","qd",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","B",".","xyz",",","oy",")",",","_0_0",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","qc",",","oy",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qf","=","pow","(","qf",",","qe","[","0","]",")",";","qf","=","qf","/","(","0.1","+","pz",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ql","=","_0_0",";","if","(","qh",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","qg","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","float","pz","=","_0_0",";","float","qn","=","_0_0",";","if","(","qj","==","_0_0",")","{","qm","=","dot","(","k",".","xyz",",","p_",")",";","pz","=","dot","(","k",".","xyz",",","oy",")",";","qn","=","dot","(","k",".","xyz",",","qg",")",";","qm","=","sqrt","(","_1_0","-","qm","*","qm",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";","qn","=","sqrt","(","_1_0","-","qn","*","qn",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","max","(","dot","(","qi",",","p_",")",",","0.01",")",";","float","pz","=","max","(","dot","(","qi",",","oy",")",",","0.01",")",";","float","qn","=","max","(","dot","(","qi",",","qg",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bP","=","tan","(","acos","(","qm",")",")",";","float","L","=","max","(","qk","[","0","]",",","0.01",")",";","ql","=","qn","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bP","*","bP",")","/","(","L","*","L",")",")","/","(","sqrt","(","pz","*","qn",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qx","=","_0_0",";","if","(","qr",".","g","==","_1_0",")","{","vec3","co","=","normalize","(","qo","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qy","=","dot","(","co",",","k",".","xyz",")",";","float","bP","=","qw","[","0","]","+","qw","[","1","]",";","if","(","qv","==","_0_0",")","bP","=","acos","(","sqrt","(","_1_0","-","qy","*","qy",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bP","=","acos","(","dot","(","co",",","qu",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bP","<","qw","[","0","]",")","qx","=","_1_0",";","else","if","(","bP",">=","qw","[","0","]","+","qw","[","1","]","||","qw","[","1","]","==","_0_0",")","qx","=","_0_0",";","else","qx","=","_1_0","-","(","bP","-","qw","[","0","]",")","/","qw","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qE","=","_0_0",";","if","(","qA",".","g","==","_1_0",")","{","if","(","qD","[","0","]","<","_1_0","||","qD","[","1","]","==","_0_0",")","qE","=","_0_0",";","else","{","if","(","qD","[","1","]","<","100.0",")","qD","[","1","]","=","sqrt","(","_1_0","/","qD","[","1","]",")",";","else","qD","[","1","]","=","10.0","/","qD","[","1","]",";","vec3","p_","=","normalize","(","oy","+","qz",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","if","(","qC","==","_0_0",")","{","float","qH","=","dot","(","k",".","xyz",",","p_",")",";","qm","=","sqrt","(","_1_0","-","qH","*","qH",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","(","_1_0","-","qC",")","*","max","(","dot","(","qB",",","p_",")",",","_0_0",")","+","qC",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qm","<","_0_0",")","qE","=","_0_0",";","else","{","float","pz","=","max","(","dot","(","qB",",","oy",")",",","0.01",")",";","float","qn","=","dot","(","qB",",","qz",")",";","if","(","qn","<=","0.01",")","qE","=","_0_0",";","else","{","float","qI","=","max","(","dot","(","oy",",","p_",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qm","*","pz",")","/","qI",";","float","dx","=","(","2.0","*","qm","*","qn",")","/","qI",";","float","g","=","min","(","min","(","a",",","b",")",",","dx",")",";","float","p","=","sqrt","(","pow","(","qD","[","0","]",",","2.0",")","+","pow","(","qI",",","2.0",")","-","_1_0",")",";","float","mm","=","pow","(","p","-","qI",",","2.0",")","/","pow","(","p","+","qI",",","2.0",")","*","(","_1_0","+","pow","(","qI","*","(","p","+","qI",")","-","_1_0",",","2.0",")","/","pow","(","qI","*","(","p","-","qI",")","+","_1_0",",","2.0",")",")",";","float","pT","=","acos","(","qm",")",";","qE","=","max","(","mm","*","g","*","exp","(","-","pow","(","pT",",","2.0",")","/","(","2.0","*","pow","(","qD","[","1","]",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","qN",",","qO",")","*","dot","(","oy",",","qO",")","<","_0_0",")","{","float","Fc","=","qP",".","x",";","float","Fd","=","qP",".","y",";","float","Fe","=","qP",".","z",";","float","Ff","=","qP",".","w",";","float","Fg","=","clamp","(","abs","(","dot","(","qN",",","qO",")",")",",","_0_0",",","_1_0",")",";","float","Fh","=","clamp","(","dot","(","oy",",","-","qN",")",",","_0_0",",","_1_0",")",";","float","Fi","=","pow","(","Fh",",","Fd",")",";","qU","=","qJ","+","qT","*","vec4","(","qS","*","Fg","*","pow","(","qQ",",","vec3","(","Fc",")",")",",","_1_0",")",";","qU","+=","Fe","*","mix","(","vec4","(","qQ",",","_1_0",")",",","vec4","(","_1_0",")",",","Ff",")","*","qT","*","vec4","(","qS","*","Fg","*","vec3","(","Fi",")",",","_1_0",")",";","}","else","{","qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";"]}]}]},{TYPE:"txt",TOKENS:["qV","=","qK","+","qS","*","qR","*","qM",";"]}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fj","=","u_node_rgbs","[","RGB_IND","]",";"]}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fl","=","dot","(","Fk",",","vec3","(","0.35",",","0.45",",","0.2",")",")",";"]}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fo",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fp",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fn","=","Fm",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fo"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fo","=","Fm",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fp","=","Fm",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Fu","=","kj","(","Fq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fr","=","Fu",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fs","=","Fu",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ft","=","Fu",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fy","=","_1_0","/","(","_1_0","+","pow","(","2.71828183",",","-","(","Fv","-","Fx",")","*","Fw",")",")",";"]}]},{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FB","=","Fz",";","if","(","FB",".","x",">","_0_0",")","FB",".","x","=","pow","(","Fz",".","x",",","FA",")",";","if","(","FB",".","y",">","_0_0",")","FB",".","y","=","pow","(","Fz",".","y",",","FA",")",";","if","(","FB",".","z",">","_0_0",")","FB",".","z","=","pow","(","Fz",".","z",",","FA",")",";"]}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FD","=","max","(","vec3","(","_0_0",")",",","FC",")",";","FD","=","pow","(","FD",",","vec3","(","2.2",")",")",";"]}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FF","=","max","(","vec3","(","_0_0",")",",","FE",")",";","FF","=","pow","(","FF",",","vec3","(","_1_0","/","2.2",")",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"FG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:["FG","[","2","]","=","FG","[","1","]","=","FG","[","0","]","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FH"],STATEMENTS:[{TYPE:"txt",TOKENS:["FH","[","2","]","=","FH","[","1","]","=","FH","[","0","]","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FI"],STATEMENTS:[{TYPE:"txt",TOKENS:["FI","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Il",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Im",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"In",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_var_texture",QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE_CUBE","(","node_TEXTURE_ENVIRONMENT_var_texture",",","Il",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Im"],STATEMENTS:[{TYPE:"txt",TOKENS:["Im","=","BN",".","xyz",";","bG","(","Im",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_In"],STATEMENTS:[{TYPE:"txt",TOKENS:["In","=","BN",".","w",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FW",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FX",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FY",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"F_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ga",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gb",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gd",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FT",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FX"],STATEMENTS:[{TYPE:"txt",TOKENS:["FX","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FX",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FY"],STATEMENTS:[{TYPE:"txt",TOKENS:["FY","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FU",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["FZ","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FZ",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_F_"],STATEMENTS:[{TYPE:"txt",TOKENS:["F_","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FV",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ga"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ga","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Ga",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gb","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FW",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gc"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gc","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Gc",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gd"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gd","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Ge",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gi"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gi","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gj"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gj","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gf",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gk"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gk","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gl"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gl","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gg",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gm"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gm","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gn","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gh",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Go"],STATEMENTS:[{TYPE:"txt",TOKENS:["Go","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gp","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Gq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gq","=","u_node_values","[","VALUE_ROW_IND","]","[","VALUE_COL_IND","]",";"]}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gt","=","Gr","+","Gs",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gu"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gu","=","(","abs","(","Gt","[","0","]",")","+","abs","(","Gt","[","1","]",")","+","abs","(","Gt","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gx","=","Gv","-","Gw",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gy"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gy","=","(","abs","(","Gx","[","0","]",")","+","abs","(","Gx","[","1","]",")","+","abs","(","Gx","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","Gz","+","GA",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GC"],STATEMENTS:[{TYPE:"txt",TOKENS:["GC","=","length","(","GB",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GB"],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","normalize","(","GB",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GF","=","vec3","(","_0_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GG"],STATEMENTS:[{TYPE:"txt",TOKENS:["GG","=","dot","(","GD",",","GE",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GJ","=","cross","(","GH",",","GI",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GK"],STATEMENTS:[{TYPE:"txt",TOKENS:["GK","=","length","(","GJ",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GO",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GN","=","normalize","(","GL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GO"],STATEMENTS:[{TYPE:"txt",TOKENS:["GO","=","length","(","GL",")",";"]}]}]},{TYPE:"txt",TOKENS:["GM",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GX","=","reflect","(","_","(","u_view_tsr_inverse",",","GV",")",",","GW",")",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Io","=","-","oy",".","xyz",";","GZ","=","reflect","(","Io",",","GY",")",";"]}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"G_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ha",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hb",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hc",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","sR",")",";","if","(","bS","<","Hc",")","{","vec2","ce","=","so","(","G_",")",";","float","ci","=","clamp","(","_0_5","*","(","Hc","-","bS",")",",","_0_0",",","_1_0",")",";","float","hK","=","Ha","*","ci",";","vec3","ck","=","normalize","(","oy","*","sO",")",";","float","cl","=","_1_0","/","Hb",";","vec2","cm","=","ck",".","xy","*","hK","/","(","Hb","*","ck",".","z",")",";","float","cn","=","_1_0",";","float","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","for","(","float","cq","=","1.0",";","cq","<=","Hb",";","cq","++",")","{","if","(","co","<","cn",")","{","cn","-=","cl",";","ce","-=","cm",";","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","}","}","vec2","cr","=","ce","+","cm",";","float","cs","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","cr",")",".","a","-","(","cn","+","cl",")",";","float","ct","=","co","-","cn",";","float","cu","=","ct","/","(","ct","-","cs",")",";","ce","=","cu","*","cr","+","(","_1_0","-","cu",")","*","ce",";","Hd","=","sn","(","ce",")",";","}","else","Hd","=","G_",";"]}]},{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"He",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","=","clamp","(","He",",","_0_0",",","_1_0",")",";"]}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hi","=","Hg",";"]}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ho",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Hp",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ho"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ho","=","Hj",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hp","=","vec4","(","Hk",",","Hl",",","Hm",",","Hn",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Hq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hq","=","u_time",";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ht",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hu","=","smoothstep","(","Hs",",","Ht",",","Hr",")",";"]}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","Hv",";","I","=","Hw",";"]}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hy","=","(","Hx",".","r","+","Hx",".","g","+","Hx",".","b",")","/","3.0",";"]}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"HA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HA","[","0","]","=","Hz",";","HA","[","1","]","=","Hz",";","HA","[","2","]","=","Hz",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","oy",",","out","vec3","E",",","out","vec3","F",",","out","vec3","G",",","out","vec4","H",",","out","float","I",")","{","E","=","vec3","(","_0_0",")",";","F","=","vec3","(","_0_0",")",";","G","=","vec3","(","_0_0",")",";","H","=","vec4","(","_0_0",")",";","I","=","_0_0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sL","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["sL","=","sL",";","else","sL","=","-","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sM","=","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sN","=","normalize","(","sL",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","sN",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","normalize","(","j",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","sN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sN",",","k",".","xyz",")","*","k",".","w",";","mat3","sO","=","mat3","(","k",".","xyz",",","W",",","sN",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sL",",","k",".","xyz",")","*","k",".","w",";","mat3","sQ","=","mat3","(","k",".","xyz",",","W",",","sL",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","ow","=","h",";","vec4","sR","=","i",";","float","sS","=","u_emit",";","float","sT","=","u_ambient",";"]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/particles_nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLV",TOKENS:[""]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"PART_INFO_SIZE",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_AGE",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LT",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LOC",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_VEL",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_A_VEL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_param",NAME:"HY",QUALIFIER:["GLSL_OUT","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"HZ",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"H_",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Ia",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_PARTICLE_INFO_var_a_p_indices",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_SIZE"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","3","]","=","It",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_AGE"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","1","]","=","Is",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LT"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","2","]","=","Iv",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LOC"],STATEMENTS:[{TYPE:"txt",TOKENS:["HZ","=","Ip",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_IND"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","0","]","=","node_PARTICLE_INFO_var_a_p_indices",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_VEL"],STATEMENTS:[{TYPE:"txt",TOKENS:["H_","=","Iq",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_A_VEL"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ia","=","Ir",";"]}]}]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","Ip",",","in","vec3","Iq",",","in","vec3","Ir",",","in","float","Is",",","in","float","It",",","in","vec2","Iu",",","in","float","Iv",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/precision_statement.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PRECISION_STATEMENT_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PRECISION_STATEMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","float",";"]}]}}]}]},e["include/procedural.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PROCEDURAL_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PROCEDURAL_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec4","Iw","(","vec4","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec3","Iw","(","vec3","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec2","Iw","(","vec2","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec4","Ix","(","vec4","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","7.0",")",")","*","7.0",";","}","vec4","Iy","(","vec4","x",")","{","return","Iw","(","(","34.0","*","x","+","5.0",")","*","x",")",";","}"]},{TYPE:"define",NAME:"K",TOKENS:["0.142857142857"]},{TYPE:"define",NAME:"K2",TOKENS:["0.0714285714285"]},{TYPE:"define",NAME:"JITTER",TOKENS:["0.7"]},{TYPE:"txt",TOKENS:["vec2","fK","(","vec2","Iz",")","{","vec2","IA","=","Iw","(","floor","(","Iz",")",")",";","vec2","IB","=","fract","(","Iz",")",";","vec4","IC","=","IB",".","x","+","vec4","(","-","0.5",",","-","1.5",",","-","0.5",",","-","1.5",")",";","vec4","ID","=","IB",".","y","+","vec4","(","-","0.5",",","-","0.5",",","-","1.5",",","-","1.5",")",";","vec4","p","=","Iy","(","IA",".","x","+","vec4","(","_0_0",",","_1_0",",","_0_0",",","_1_0",")",")",";","p","=","Iy","(","p","+","IA",".","y","+","vec4","(","_0_0",",","_0_0",",","_1_0",",","_1_0",")",")",";","vec4","IE","=","Ix","(","p",")","*","K","+","K2",";","vec4","IF","=","Ix","(","floor","(","p","*","K",")",")","*","K","+","K2",";","vec4","IG","=","IC","+","JITTER","*","IE",";","vec4","IH","=","ID","+","JITTER","*","IF",";","vec4","dC","=","IG","*","IG","+","IH","*","IH",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["dC",".","xy","=","min","(","dC",".","xy",",","dC",".","zw",")",";","dC",".","x","=","min","(","dC",".","x",",","dC",".","y",")",";","return","dC",".","xx",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["dC",".","xy","=","(","dC",".","x","<","dC",".","y",")","?","dC",".","xy",":","dC",".","yx",";","dC",".","xz","=","(","dC",".","x","<","dC",".","z",")","?","dC",".","xz",":","dC",".","zx",";","dC",".","xw","=","(","dC",".","x","<","dC",".","w",")","?","dC",".","xw",":","dC",".","wx",";","dC",".","y","=","min","(","dC",".","y",",","dC",".","z",")",";","dC",".","y","=","min","(","dC",".","y",",","dC",".","w",")",";","return","sqrt","(","dC",".","xy",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","vec3","la","(","vec2","Iz",",","float","II",")","{","vec2","IA","=","Iw","(","floor","(","Iz",")",")",";","vec2","IB","=","fract","(","Iz",")",";","vec4","IC","=","IB",".","x","+","vec4","(","-","0.5",",","-","1.5",",","-","0.5",",","-","1.5",")",";","vec4","ID","=","IB",".","y","+","vec4","(","-","0.5",",","-","0.5",",","-","1.5",",","-","1.5",")",";","vec4","p","=","Iy","(","IA",".","x","+","vec4","(","_0_0",",","_1_0",",","_0_0",",","_1_0",")",")",";","p","=","Iy","(","p","+","IA",".","y","+","vec4","(","_0_0",",","_0_0",",","_1_0",",","_1_0",")",")",";","vec4","IE","=","Ix","(","p",")","*","K","+","K2",";","vec4","IF","=","Ix","(","floor","(","p","*","K",")",")","*","K","+","K2",";","vec4","IG","=","IC","+","JITTER","*","IE",";","vec4","IH","=","ID","+","JITTER","*","IF",";","vec4","IJ","=","IG","*","IG","+","IH","*","IH",";","IG","+=","II",";","IH","+=","II",";","vec4","IK","=","IG","*","IG","+","IH","*","IH",";","IG","+=","II",";","IH","+=","II",";","vec4","IL","=","IG","*","IG","+","IH","*","IH",";","IJ",".","xy","=","min","(","IJ",".","xy",",","IJ",".","zw",")",";","IJ",".","x","=","min","(","IJ",".","x",",","IJ",".","y",")",";","IK",".","xy","=","min","(","IK",".","xy",",","IK",".","zw",")",";","IK",".","x","=","min","(","IK",".","x",",","IK",".","y",")",";","IL",".","xy","=","min","(","IL",".","xy",",","IL",".","zw",")",";","IL",".","x","=","min","(","IL",".","x",",","IL",".","y",")",";","return","vec3","(","IJ",".","x",",","IK",".","x",",","IL",".","x",")",";","}","vec3","IM","(","vec3","x",")","{","return","Iw","(","(","(","x","*","34.0",")","+","_1_0",")","*","x",")",";","}","float","fz","(","vec2","kU",")","{","const","vec4","IN","=","vec4","(","0.211324865405187",",","0.366025403784439",",","-","0.577350269189626",",","0.024390243902439",")",";","vec2","cq","=","floor","(","kU","+","dot","(","kU",",","IN",".","yy",")",")",";","vec2","IO","=","kU","-","cq","+","dot","(","cq",",","IN",".","xx",")",";","vec2","IP",";","IP","=","(","IO",".","x",">","IO",".","y",")","?","vec2","(","_1_0",",","_0_0",")",":","vec2","(","_0_0",",","_1_0",")",";","vec4","IQ","=","IO",".","xyxy","+","IN",".","xxzz",";","IQ",".","xy","-=","IP",";","cq","=","Iw","(","cq",")",";","vec3","p","=","IM","(","IM","(","cq",".","y","+","vec3","(","_0_0",",","IP",".","y",",","_1_0",")",")","+","cq",".","x","+","vec3","(","_0_0",",","IP",".","x",",","_1_0",")",")",";","vec3","aA","=","max","(","0.5","-","vec3","(","dot","(","IO",",","IO",")",",","dot","(","IQ",".","xy",",","IQ",".","xy",")",",","dot","(","IQ",".","zw",",","IQ",".","zw",")",")",",","_0_0",")",";","aA","=","aA","*","aA",";","aA","=","aA","*","aA",";","vec3","x","=","2.0","*","fract","(","p","*","IN",".","www",")","-","_1_0",";","vec3","co","=","abs","(","x",")","-","0.5",";","vec3","IE","=","floor","(","x","+","0.5",")",";","vec3","IR","=","x","-","IE",";","aA","*=","1.79284291400159","-","0.85373472095314","*","(","IR","*","IR","+","co","*","co",")",";","vec3","g",";","g",".","x","=","IR",".","x","*","IO",".","x","+","co",".","x","*","IO",".","y",";","g",".","yz","=","IR",".","yz","*","IQ",".","xz","+","co",".","yz","*","IQ",".","yw",";","return","130.0","*","dot","(","aA",",","g",")",";","}","vec2","IU","(","vec2","f_",")","{","float","IJ","=","dot","(","f_",",","vec2","(","12.9898",",","78.233",")",")",";","float","IK","=","dot","(","f_",",","vec2","(","12.9898",",","78.233",")","*","2.0",")",";","float","IS","=","fract","(","sin","(","IJ",")","*","43758.5453",")","*","2.0","-","_1_0",";","float","IT","=","fract","(","sin","(","IK",")","*","43758.5453",")","*","2.0","-","_1_0",";","return","vec2","(","IS",",","IT",")",";","}","float","lk","(","vec2","IV",")","{","return","fract","(","sin","(","dot","(","IV",",","vec2","(","12.9898",",","78.233",")",")",")","*","43758.5453",")",";","}"]}]}}]}]},e["include/refraction.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"REFRACTION_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"REFRACTION_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eW","(","in","float","cW",",","inout","vec2","eV",",","in","vec2","eM",")","{","vec4","IW","=","GLSL_TEXTURE","(","u_scene_depth",",","eV",")",";","float","eX","=","cV","(","IW",")",";","if","(","eX","<","m",")","{","eV","=","eM",";","return","cW",";","}","else","{","return","eX",";","}","return","cW",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cS","(","in","vec3","ru",",","in","vec2","IX",")","{","vec2","eM","=","ru",".","xy","/","ru",".","z",";","vec2","eV","=","eM","+","IX",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","ru",")",";","float","cW","=","cV","(","cU",")",";","eW","(","cW",",","eV",",","eM",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","fa","=","GLSL_TEXTURE","(","u_refractmap",",","eV",")",".","rgb",";","bG","(","fa",")",";","return","fa",";","}"]}]}}]}]}}]}]},e["include/scale_texcoord.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SCALE_TEXCOORD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SCALE_TEXCOORD_GLSLV",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec2","az","(","vec2","ce",",","vec3","IY",")","{","return","(","ce","+","0.5",")","*","IY",".","xy","-","0.5",";","}"]}]}}]}]},e["include/shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"CSM_FADE_LAST_CASCADE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_BLEND_BETWEEN_CASCADES",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"COMPARED_MODE",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"procedural.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","IZ","=","0.1",";","const","float","I_","=","0.1",";","const","float","Ja","=","-","0.01",";","const","float","Jb","=","0.05",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Jc","=","vec4","(","0.14383161",",","0.34495938",",","-","0.38277543",",","-","0.26496911",")",";","vec4","Jd","=","vec4","(","0.53742981",",","0.19984126",",","0.79197514",",","-","0.094184101",")",";","vec4","Je","=","vec4","(","-","0.94201624",",","-","0.91588581",",","-","0.2418884",",","0.44323325",")",";","vec4","Jf","=","vec4","(","-","0.81544232",",","0.94558609",",","-","0.81409955",",","0.97484398",")",";","vec4","Jg","=","vec4","(","-","0.1410079",",","0.2938776",",","0.27676845",",","-","0.41893023",")",";","vec4","Jh","=","vec4","(","-","0.4737342",",","0.78641367",",","0.19090188",",","-","0.9293887",")",";","vec4","Ji","=","vec4","(","-","0.39906216",",","0.45771432",",","0.99706507",",","-","0.97511554",")",";","vec4","Jj","=","vec4","(","-","0.87912464",",","-","0.76890725",",","0.9143759",",","0.7564837",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","Jc","=","vec2","(","-","0.37192261",",","0.47109537",")",";","vec2","Jd","=","vec2","(","-","0.6807477",",","0.69048062",")",";","vec2","Je","=","vec2","(","0.11615683",",","-","0.91318524",")",";","vec2","Jf","=","vec2","(","0.93688596",",","-","0.16948928",")",";","vec2","Jg","=","vec2","(","-","0.89699117",",","0.74092316",")",";","vec2","Jh","=","vec2","(","0.38263656",",","-","0.66119884",")",";","vec2","Ji","=","vec2","(","-","0.08193062",",","-","0.21275223",")",";","vec2","Jj","=","vec2","(","0.05578877",",","0.84225623",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_4",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","Jc","=","vec2","(","-","0.51808083",",","0.0",")",";","vec2","Jd","=","vec2","(","0.5741194",",","0.0",")",";","vec2","Je","=","vec2","(","-","0.68048857",",","0.0",")",";","vec2","Jf","=","vec2","(","0.82934988",",","0.0",")",";","vec2","Jg","=","vec2","(","0.70009436",",","0.0",")",";","vec2","Jh","=","vec2","(","-","0.78790467",",","0.0",")",";","vec2","Ji","=","vec2","(","-","0.58619489",",","0.0",")",";","vec2","Jj","=","vec2","(","0.41902178",",","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["bool","Jl","(","vec2","iO",",","float","Jk",")","{","return","all","(","lessThanEqual","(","iO",",","vec2","(","1.0","+","Jk",")",")",")","&&","all","(","greaterThanEqual","(","iO",",","vec2","(","0.0","-","Jk",")",")",")",";","}","float","Js","(","float","Jm",",","float","Jn",",","mat2","Jo",",","vec3","Jp",",","float","Jq",",","PRECISION","GLSL_SMPLR2D_SHDW","Jr",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iO",",","fM",";","fM",".","x","=","Jm",";","fM",".","y","=","Jn",";","fM","=","Jo","*","fM",";","iO","=","Jp",".","xy","+","fM","*","Jq","/","SHADOW_TEX_RES",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iO","=","Jp",".","xy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","Jl","(","iO",",","Ja",")",")","return","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","cV","(","GLSL_TEXTURE","(","Jr",",","iO",")",")",";","return","step","(","Jp",".","z",",","et",")",";"]}]}},{TYPE:"elif",EXPRESSION:["COMPARED_MODE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","GLSL_TEXTURE","(","Jr",",","vec3","(","iO",",","Jp",".","z",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","step","(","Jp",".","z",",","GLSL_TEXTURE","(","Jr",",","iO",")",".","r",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","Jx","(","vec3","Jp",",","PRECISION","GLSL_SMPLR2D_SHDW","Jr",",","float","Jq",")","{","float","Jt","=","0.0",";","Jp",".","z","=","clamp","(","Jp",".","z",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Ju","=","IU","(","Jp",".","xy",")",".","x","*","M_PI",";","float","Jv","=","cos","(","Ju",")",";","float","Jw","=","sin","(","Ju",")",";","mat2","Jo","=","mat2","(","Jv",",","Jw",",","-","Jw",",","Jv",")",";","for","(","int","cq","=","0",";","cq","<","POISSON_DISK_NUM",";","cq","++",")","{","Jt","+=","Js","(","Jc","[","cq","]",",","Jg","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","Jt","+=","Js","(","Jd","[","cq","]",",","Jh","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","Jt","+=","Js","(","Je","[","cq","]",",","Ji","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","Jt","+=","Js","(","Jf","[","cq","]",",","Jj","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","}","return","clamp","(","Jt","/","(","float","(","POISSON_DISK_NUM",")","*","4.0",")",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","Js","(","0.0",",","0.0",",","mat2","(","0.0",")",",","Jp",",","Jq",",","Jr",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","JG","(","vec3","Jy",",","PRECISION","GLSL_SMPLR2D_SHDW","Jz",",","vec3","JA",",","PRECISION","GLSL_SMPLR2D_SHDW","JB",",","float","JC",",","float","JD",",","float","aL",")","{","float","JE",",","JF",";","Jy",".","z","=","clamp","(","Jy",".","z",",","0.0",",","1.0",")",";","JA",".","z","=","clamp","(","JA",".","z",",","0.0",",","1.0",")",";","JE","=","0.0",";","JF","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Ju","=","IU","(","Jy",".","xy",")",".","x","*","M_PI",";","float","Jv","=","cos","(","Ju",")",";","float","Jw","=","sin","(","Ju",")",";","mat2","Jo","=","mat2","(","Jv",",","Jw",",","-","Jw",",","Jv",")",";","for","(","int","cq","=","0",";","cq","<","POISSON_DISK_NUM",";","cq","++",")","{","JE","+=","Js","(","Jc","[","cq","]",",","Jg","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","JE","+=","Js","(","Jd","[","cq","]",",","Jh","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","JE","+=","Js","(","Je","[","cq","]",",","Ji","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","JE","+=","Js","(","Jf","[","cq","]",",","Jj","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","}","for","(","int","cq","=","0",";","cq","<","POISSON_DISK_NUM",";","cq","++",")","{","JF","+=","Js","(","Jc","[","cq","]",",","Jg","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","JF","+=","Js","(","Jd","[","cq","]",",","Jh","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","JF","+=","Js","(","Je","[","cq","]",",","Ji","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","JF","+=","Js","(","Jf","[","cq","]",",","Jj","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","}","JE","=","mix","(","JE",",","JF",",","aL",")",";","JE","/=","(","float","(","POISSON_DISK_NUM",")","*","4.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JE","+=","Js","(","0.0",",","0.0",",","mat2","(","0.0",")",",","Jy",",","JC",",","Jz",")",";","JF","+=","Js","(","0.0",",","0.0",",","mat2","(","0.0",")",",","JA",",","JD",",","JB",")",";","JE","=","mix","(","JE",",","JF",",","aL",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","clamp","(","JE",",","0.0",",","1.0",")",";","}","float","JH","(","vec2","iO",")","{","float","a","=","min","(","iO",".","x",",","iO",".","y",")",";","float","b","=","min","(","1.0","-","iO",".","x",",","1.0","-","iO",".","y",")",";","return","min","(","a",",","b",")",";","}","float","JJ","(","float","vo",",","float","JI",")","{","if","(","JI",">=","0.0","&&","JI","<=","I_",")","vo","=","(","vo","-","1.0",")","/","I_","*","JI","+","1.0",";","return","vo",";","}","float","JO","(","vec3","JK",",","vec3","JL",",","PRECISION","GLSL_SMPLR2D_SHDW","Jz",",","PRECISION","GLSL_SMPLR2D_SHDW","JB",",","float","JC",",","float","JD",",","float","JM",",","float","et",")","{","float","vo",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_BLEND_BETWEEN_CASCADES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JI","=","JH","(","JK",".","xy",")",";","if","(","-","et",">","JM","&&","JI",">=","0.0","&&","JI","<=","IZ","&&","Jl","(","JL",".","xy",",","0.0",")",")","{","float","JN","=","1.0","-","JI","/","IZ",";","vo","=","JG","(","JK",",","Jz",",","JL",",","JB",",","JC",",","JD",",","JN",")",";","}","else"]}]}}]},{TYPE:"txt",TOKENS:["vo","=","Jx","(","JK",",","Jz",",","JC",")",";","return","vo",";","}","float","JQ","(","vec3","JP",",","PRECISION","GLSL_SMPLR2D_SHDW","Jr",",","float","Jq",",","float","JM",",","float","et",")","{","float","vo","=","Jx","(","JP",",","Jr",",","Jq",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_FADE_LAST_CASCADE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","-","et",">","JM",")","{","float","JI","=","JH","(","JP",".","xy",")",";","vo","=","JJ","(","vo",",","JI",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["return","vo",";","}","vec4","ev","(","float","et",")","{","float","vo","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","JR","=","u_pcf_blur_radii",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","JR","=","vec4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","Jy","=","n",".","xyz","/","n",".","w",";","if","(","n",".","w","<","0.0",")","Jy",".","z","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JA","=","o",".","xyz","/","o",".","w",";","if","(","o",".","w","<","0.0",")","JA",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JS","=","u",".","xyz","/","u",".","w",";","if","(","u",".","w","<","0.0",")","JS",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JT","=","v",".","xyz","/","v",".","w",";","if","(","v",".","w","<","0.0",")","JT",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","Jl","(","Jy",".","xy",",","0.0",")",")","{","vo","=","JO","(","Jy",",","JA",",","u_shadow_map0",",","u_shadow_map1",",","JR","[","0","]",",","JR","[","1","]",",","u_csm_center_dists","[","0","]",",","et",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","Jl","(","Jy",".","xy",",","Jb",")",")","{","vo","=","JQ","(","Jy",",","u_shadow_map0",",","JR","[","0","]",",","u_csm_center_dists","[","0","]",",","et",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","Jl","(","JA",".","xy",",","0.0",")",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JO","(","JA",",","JS",",","u_shadow_map1",",","u_shadow_map2",",","JR","[","1","]",",","JR","[","2","]",",","u_csm_center_dists","[","1","]",",","et",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JQ","(","JA",",","u_shadow_map1",",","JR","[","1","]",",","u_csm_center_dists","[","1","]",",","et",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","Jl","(","JS",".","xy",",","0.0",")",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JO","(","JS",",","JT",",","u_shadow_map2",",","u_shadow_map3",",","JR","[","2","]",",","JR","[","3","]",",","u_csm_center_dists","[","2","]",",","et",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JQ","(","JS",",","u_shadow_map2",",","JR","[","2","]",",","u_csm_center_dists","[","2","]",",","et",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","Jl","(","JT",".","xy",",","0.0",")",")","vo","=","JQ","(","JT",",","u_shadow_map3",",","JR","[","3","]",",","u_csm_center_dists","[","3","]",",","et",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JU","=","Jx","(","JA",",","u_shadow_map1",",","JR","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JU","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JV","=","Jx","(","JS",",","u_shadow_map2",",","JR","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JV","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JW","=","Jx","(","JT",",","u_shadow_map3",",","JR","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JW","=","1.0",";"]}]}}]},{TYPE:"txt",TOKENS:["return","vec4","(","vo",",","JU",",","JV",",","JW",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec4","cH","(","inout","vec3","cD",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Jt","=","GLSL_TEXTURE","(","u_shadow_mask",",","l",".","xy","/","l",".","z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"l_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cD","*=","Jt",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["return","Jt",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Jt","=","ev","(","i",".","z",")",";","return","Jt",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec4","(","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["vec4","J_","(","mat4","JX",",","vec4","JY",",","mat4","JZ",")","{","vec2","ey","=","(","JX","*","JZ","[","3","]",")",".","xy",";","float","ez","=","SHADOW_TEX_RES","/","2.0",";","ey","=","floor","(","ey","*","ez","+","0.5",")","/","ez","-","ey",";","vec4","Jp","=","JX","*","JY",";","Jp",".","xy","+=","ey",";","Jp",".","xyz","=","0.5","*","(","Jp",".","xyz","+","Jp",".","w",")",";","return","Jp",";","}","void","cd","(","vec3","fr",",","vec3","Ka",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","JZ","=","bh","(","u_v_light_tsr","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","JZ","=","bh","(","mat3","(","u_v_light_ts","[","0","]",".","xyz",",","vec3","(","u_v_light_ts","[","0","]",".","w",")",",","u_v_light_r","[","0","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","0","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","n","=","J_","(","u_p_light_matrix0",",","Kb",",","JZ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","u_v_light_tsr","[","1","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","mat3","(","u_v_light_ts","[","1","]",".","xyz",",","vec3","(","u_v_light_ts","[","1","]",".","w",")",",","u_v_light_r","[","1","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","1","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","o","=","J_","(","u_p_light_matrix1",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","u_v_light_tsr","[","2","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","mat3","(","u_v_light_ts","[","2","]",".","xyz",",","vec3","(","u_v_light_ts","[","2","]",".","w",")",",","u_v_light_r","[","2","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","2","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","u","=","J_","(","u_p_light_matrix2",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","u_v_light_tsr","[","3","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","mat3","(","u_v_light_ts","[","3","]",".","xyz",",","vec3","(","u_v_light_ts","[","3","]",".","w",")",",","u_v_light_r","[","3","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","3","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","v","=","J_","(","u_p_light_matrix3",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["o","=","J_","(","u_p_light_matrix1",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["u","=","J_","(","u_p_light_matrix2",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["v","=","J_","(","u_p_light_matrix3",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/skin.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SKIN_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKIN_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"DISABLE_TANGENT_SKINNING",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"SKIN_SLERP",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Ki","(","in","vec4","qZ",",","in","vec4","rF",",","in","float","Kc",")","{","float","Kd","=","qZ","[","0","]","*","rF","[","0","]","+","qZ","[","1","]","*","rF","[","1","]","+","qZ","[","2","]","*","rF","[","2","]","+","qZ","[","3","]","*","rF","[","3","]",";","if","(","Kd","<","0.0",")","{","rF","*=","-","1.0",";","Kd","=","-","Kd",";","}","if","(","abs","(","Kd",")",">=","1.0",")","return","qZ",";","float","Ke","=","acos","(","Kd",")",";","float","Kf","=","sqrt","(","1.0","-","Kd","*","Kd",")",";","if","(","abs","(","Kf",")","<","0.001",")","return","vec4","(","qZ","*","0.5","+","rF","*","0.5",")",";","float","Kg","=","sin","(","(","1.0","-","Kc",")","*","Ke",")","/","Kf",";","float","Kh","=","sin","(","Kc","*","Ke",")","/","Kf",";","return","qZ","*","Kg","+","rF","*","Kh",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kw","(","in","vec3","O",",","in","vec4","Kj",",","in","vec4","Kk",",","in","vec4","Kl",",","in","vec4","Km",",","in","float","Kn",")","{","vec3","Ko","=","rl","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","O",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","qZ","=","Ki","(","Kj",",","Kk",",","Kn",")",";","vec4","Kp","=","mix","(","Kl",",","Km",",","Kn",")",";","vec3","Kq","=","T","(","qZ",",","Ko",")",";","vec3","Kr","=","Kq","*","Kp",".","w","+","Kp",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ks","=","T","(","Kj",",","Ko",")",";","vec3","Kt","=","T","(","Kk",",","Ko",")",";","vec3","Ku","=","Ks","*","Kl",".","w","+","Kl",".","xyz",";","vec3","Kv","=","Kt","*","Km",".","w","+","Km",".","xyz",";","vec3","Kr","=","mix","(","Ku",",","Kv",",","Kn",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","rn","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kr",")",";","}","vec3","KC","(","in","vec3","Kx",",","in","vec4","Kj",",","in","vec4","Kk",",","in","float","Kn",")","{","vec3","Ky","=","rm","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kx",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","qZ","=","Ki","(","Kj",",","Kk",",","Kn",")",";","vec3","Kz","=","T","(","qZ",",","Ky",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","KA","=","T","(","Kj",",","Ky",")",";","vec3","KB","=","T","(","Kk",",","Ky",")",";","vec3","Kz","=","mix","(","KA",",","KB",",","Kn",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","ro","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kz",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kw","(","in","vec3","O",",","in","vec4","Kj",",","in","vec4","Kl",")","{","vec3","Ko","=","rl","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","O",")",";","vec3","Kq","=","T","(","Kj",",","Ko",")",";","vec3","Kr","=","Kq","*","Kl",".","w","+","Kl",".","xyz",";","return","rn","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kr",")",";","}","vec3","KC","(","in","vec3","Kx",",","in","vec4","Kj",")","{","vec3","Ky","=","rm","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kx",")",";","vec3","Kz","=","T","(","Kj",",","Ky",")",";","return","ro","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kz",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","an","(","inout","vec3","O",",","inout","vec3","V",",","inout","vec3","W",",","inout","vec3","U",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","KD","=","u_frame_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","a_influence",".","y",">","0.0",")","{","vec3","jH","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","KE","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","KF","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","KG","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec4","KH","=","a_influence",";","for","(","int","cq","=","0",";","cq","<","4",";","cq","++",")","{","int","KI","=","int","(","KH","[","cq","]",")",";","float","KJ","=","fract","(","KH","[","cq","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KE","+=","KJ","*","KC","(","V",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","KD",")",";","KF","+=","KJ","*","KC","(","W",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","KD",")",";","KG","+=","KJ","*","KC","(","U",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","KD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_transb","[","KI","]",")",";","KG","+=","KJ","*","KC","(","U",",","u_quatsb","[","KI","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KE","+=","KJ","*","KC","(","V",",","u_quatsb","[","KI","]",")",";","KF","+=","KJ","*","KC","(","W",",","u_quatsb","[","KI","]",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["int","KI","=","int","(","KH","[","0","]",")",";","float","KJ","=","fract","(","KH","[","0","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";","KI","=","int","(","KH","[","1","]",")",";","KJ","=","fract","(","KH","[","1","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";","KI","=","int","(","KH","[","2","]",")",";","KJ","=","fract","(","KH","[","2","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";","KI","=","int","(","KH","[","3","]",")",";","KJ","=","fract","(","KH","[","3","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["O","=","jH",";","U","=","KG",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["V","=","KE",";","W","=","KF",";"]}]}}]},{TYPE:"txt",TOKENS:["}","if","(","!","(","a_influence",".","y",">","0.0",")",")","{","int","KK","=","int","(","a_influence","[","0","]","-","1.0",")",";","if","(","KK",">","-","1",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","Kw","(","O",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","u_transb","[","KK","]",",","u_transa","[","KK","]",",","KD",")",";","V","=","KC","(","V",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","KD",")",";","W","=","KC","(","W",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","KD",")",";","U","=","KC","(","U",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","KD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","Kw","(","O",",","u_quatsb","[","KK","]",",","u_transb","[","KK","]",")",";","U","=","KC","(","U",",","u_quatsb","[","KK","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["V","=","KC","(","V",",","u_quatsb","[","KK","]",")",";","W","=","KC","(","W",",","u_quatsb","[","KK","]",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}","}","}"]}]}}]}]}}]}]},e["include/sky_blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SKY_BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKY_BLENDING_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"blending.glslf"},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"BLENDTYPE",TOKENS:["MIX"]},{TYPE:"var",NAME:"MTEX_RGBTOINT",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_HORIZ",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENUP",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENDOWN",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_BLEND",TOKENS:["0"]},{TYPE:"var",NAME:"MTEX_NEGATIVE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["vec3","KL","(","vec3","km",",","vec3","kn",",","float","aL",",","float","kM",")","{","float","ko","=","aL","*","kM",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kp","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kq","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kr","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kt","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ku","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kv","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kw","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kx","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ky","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kz","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","HUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kD","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SATURATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kE","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","VALUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kF","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","COLOR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kG","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kI","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kJ","(","kn",",","km",",","ko",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","vec3","(","1.0",",","0.0",",","1.0",")",";","}","float","KM","(","float","kK",",","float","kL",",","float","aL",",","float","kM",")","{","vec3","km","=","vec3","(","kK",")",",","kn","=","vec3","(","kL",")",";","float","ko","=","aL","*","kM",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kp","(","kn",",","km",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kq","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kr","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kN","(","kK",",","kL",",","ko",",","kM",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kO","(","kK",",","kL",",","ko",",","kM",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kP","(","kK",",","kL",",","ko",",","kM",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kw","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kx","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ky","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kz","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kI","(","kn",",","km",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kJ","(","kn",",","km",",","ko",")",".","x",";"]}]}}]},{TYPE:"txt",TOKENS:["return","0.0",";","}","vec3","eF","(","vec3","eB",",","vec3","eC",",","vec4","eE",",","float","eA",",","vec3","eD",")","{","float","KN","=","1.0",";","KN","=","eE",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","gj","(","eE",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_NEGATIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eE","=","vec4","(","vec3","(","1.0",")","-","eE",".","rgb",",","eE",".","a",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","1.0","-","KN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eE","=","vec4","(","u_sky_tex_color",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","eE",".","a",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eB","=","KL","(","eE",".","rgb",",","eB",",","KN",",","u_sky_tex_fac","[","1","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","KO","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","eD",",","vec3","(","0.0",",","0.0",",","1.0",")",")",">=","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KO","=","u_sky_tex_fac","[","2","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","KO","=","u_sky_tex_fac","[","3","]",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KO","=","u_sky_tex_fac","[","2","]",";"]}]}},{TYPE:"elif",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KO","=","u_sky_tex_fac","[","3","]",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["if","(","KO","!=","0.0",")","eC","=","KL","(","eE",".","rgb",",","eC",",","KN",",","KO",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_BLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","dot","(","eE",".","rgb",",","vec3","(","0.2126",",","0.7152",",","0.0722",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["eA","=","KM","(","u_sky_tex_dvar",",","eA",",","KN",",","u_sky_tex_fac","[","0","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bw","=","mix","(","eB",",","eC",",","eA",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bw","=","eB",";"]}]}}]},{TYPE:"txt",TOKENS:["return","bw",";","}"]}]}}]}]},e["include/std.glsl"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"STD_ENUMS_GLSL",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"STD_ENUMS_GLSL",TOKENS:[""]},{TYPE:"var",NAME:"CONSTANTS_HACK",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_UV_ORCO",TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NORMAL",TOKENS:["2"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MIX",TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MULTIPLY",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_SRC_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_DST_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_DST_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_DST_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"NO_SHADOWS",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_CASTING",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_MASK_GENERATION",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_MAPPING_OPAQUE",TOKENS:["4"]},{TYPE:"define",NAME:"SHADOW_MAPPING_BLEND",TOKENS:["5"]},{TYPE:"define",NAME:"POISSON_X_16",TOKENS:["4"]},{TYPE:"define",NAME:"POISSON_X_8",TOKENS:["2"]},{TYPE:"define",NAME:"POISSON_X_4",TOKENS:["1"]},{TYPE:"define",NAME:"NO_SOFT_SHADOWS",TOKENS:["0"]},{TYPE:"define",NAME:"SPECULAR_PHONG",TOKENS:["1"]},{TYPE:"define",NAME:"SPECULAR_COOKTORR",TOKENS:["2"]},{TYPE:"define",NAME:"SPECULAR_WARDISO",TOKENS:["3"]},{TYPE:"define",NAME:"SPECULAR_BLINN",TOKENS:["4"]},{TYPE:"define",NAME:"SPECULAR_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFUSE_LAMBERT",TOKENS:["1"]},{TYPE:"define",NAME:"DIFFUSE_OREN_NAYAR",TOKENS:["2"]},{TYPE:"define",NAME:"DIFFUSE_FRESNEL",TOKENS:["3"]},{TYPE:"define",NAME:"DIFFUSE_MINNAERT",TOKENS:["4"]},{TYPE:"define",NAME:"DIFFUSE_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"MIX",TOKENS:["0"]},{TYPE:"define",NAME:"ADD",TOKENS:["1"]},{TYPE:"define",NAME:"SUBTRACT",TOKENS:["2"]},{TYPE:"define",NAME:"MULTIPLY",TOKENS:["3"]},{TYPE:"define",NAME:"SCREEN",TOKENS:["4"]},{TYPE:"define",NAME:"OVERLAY",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFERENCE",TOKENS:["6"]},{TYPE:"define",NAME:"DIVIDE",TOKENS:["7"]},{TYPE:"define",NAME:"DARKEN",TOKENS:["8"]},{TYPE:"define",NAME:"LIGHTEN",TOKENS:["9"]},{TYPE:"define",NAME:"HUE",TOKENS:["10"]},{TYPE:"define",NAME:"SATURATION",TOKENS:["11"]},{TYPE:"define",NAME:"VALUE",TOKENS:["12"]},{TYPE:"define",NAME:"COLOR",TOKENS:["13"]},{TYPE:"define",NAME:"SOFT_LIGHT",TOKENS:["14"]},{TYPE:"define",NAME:"LINEAR_LIGHT",TOKENS:["15"]},{TYPE:"define",NAME:"REFL_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"REFL_MIRRORMAP",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PLANE",TOKENS:["2"]},{TYPE:"define",NAME:"REFL_CUBE",TOKENS:["3"]},{TYPE:"define",NAME:"REFL_PBR_SIMPLE",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PBR_STANDARD",TOKENS:["5"]},{TYPE:"define",NAME:"INVERSE_QUADRATIC",TOKENS:["0"]},{TYPE:"define",NAME:"LINEAR",TOKENS:["1"]},{TYPE:"define",NAME:"QUADRATIC",TOKENS:["2"]},{TYPE:"define",NAME:"HEMI",TOKENS:["1"]},{TYPE:"define",NAME:"SPOT",TOKENS:["2"]},{TYPE:"define",NAME:"POINT",TOKENS:["3"]},{TYPE:"define",NAME:"SUN",TOKENS:["4"]},{TYPE:"define",NAME:"DOF_SIMPLE",TOKENS:["0"]},{TYPE:"define",NAME:"DOF_BOKEH",TOKENS:["1"]},{TYPE:"define",NAME:"COC_ALL",TOKENS:["0"]},{TYPE:"define",NAME:"COC_FOREGROUND",TOKENS:["1"]},{TYPE:"define",NAME:"COC_COMBINE",TOKENS:["2"]},{TYPE:"define",NAME:"VT_WORLD_TO_WORLD",TOKENS:["0"]},{TYPE:"define",NAME:"VT_WORLD_TO_OBJECT",TOKENS:["1"]},{TYPE:"define",NAME:"VT_WORLD_TO_CAMERA",TOKENS:["2"]},{TYPE:"define",NAME:"VT_OBJECT_TO_WORLD",TOKENS:["3"]},{TYPE:"define",NAME:"VT_OBJECT_TO_OBJECT",TOKENS:["4"]},{TYPE:"define",NAME:"VT_OBJECT_TO_CAMERA",TOKENS:["5"]},{TYPE:"define",NAME:"VT_CAMERA_TO_WORLD",TOKENS:["6"]},{TYPE:"define",NAME:"VT_CAMERA_TO_OBJECT",TOKENS:["7"]},{TYPE:"define",NAME:"VT_CAMERA_TO_CAMERA",TOKENS:["8"]},{TYPE:"define",NAME:"VT_POINT",TOKENS:["0"]},{TYPE:"define",NAME:"VT_VECTOR",TOKENS:["1"]},{TYPE:"define",NAME:"VT_NORMAL",TOKENS:["2"]},{TYPE:"define",NAME:"NM_TANGENT",TOKENS:["0"]},{TYPE:"define",NAME:"NM_OBJECT",TOKENS:["1"]},{TYPE:"define",NAME:"NM_WORLD",TOKENS:["2"]},{TYPE:"define",NAME:"NM_BLENDER_OBJECT",TOKENS:["3"]},{TYPE:"define",NAME:"NM_BLENDER_WORLD",TOKENS:["4"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_VIEW",TOKENS:["1"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_XY",TOKENS:["2"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_YZ",TOKENS:["3"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_ZX",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"POST_EFFECT_GRAYSCALE",TOKENS:["2"]},{TYPE:"define",NAME:"POST_EFFECT_BLUR",TOKENS:["3"]},{TYPE:"define",NAME:"POST_EFFECT_GLOW_BLUR",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_DOF_BLUR",TOKENS:["5"]},{TYPE:"define",NAME:"POST_EFFECT_ALPHA_BLUR",TOKENS:["6"]},{TYPE:"define",NAME:"POST_EFFECT_EXTEND",TOKENS:["7"]},{TYPE:"define",NAME:"FLIP_CUBEMAP_COORDS",TOKENS:["8"]},{TYPE:"define",NAME:"BLUR_PASS_1",TOKENS:["1"]},{TYPE:"define",NAME:"BLUR_PASS_2",TOKENS:["2"]},{TYPE:"define",NAME:"BLUR_PASS_3",TOKENS:["3"]},{TYPE:"define",NAME:"BLUR_PASS_4",TOKENS:["4"]},{TYPE:"define",NAME:"BLUR_PASS_5",TOKENS:["5"]},{TYPE:"define",NAME:"DV_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"DV_OPAQUE_WIREFRAME",TOKENS:["1"]},{TYPE:"define",NAME:"DV_TRANSPARENT_WIREFRAME",TOKENS:["2"]},{TYPE:"define",NAME:"DV_FRONT_BACK_VIEW",TOKENS:["3"]},{TYPE:"define",NAME:"DV_BOUNDINGS",TOKENS:["4"]},{TYPE:"define",NAME:"DV_CLUSTERS_VIEW",TOKENS:["5"]},{TYPE:"define",NAME:"DV_BATCHES_VIEW",TOKENS:["6"]},{TYPE:"define",NAME:"DV_RENDER_TIME",TOKENS:["7"]},{TYPE:"define",NAME:"SSAO_QUALITY_8",TOKENS:["1"]},{TYPE:"define",NAME:"SSAO_QUALITY_16",TOKENS:["2"]},{TYPE:"define",NAME:"SSAO_QUALITY_24",TOKENS:["3"]},{TYPE:"define",NAME:"SSAO_QUALITY_32",TOKENS:["4"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_LIGHT",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_QUALITY",TOKENS:["2"]},{TYPE:"define",NAME:"AA_QUALITY_LOW",TOKENS:["0"]},{TYPE:"define",NAME:"AA_QUALITY_MEDIUM",TOKENS:["1"]},{TYPE:"define",NAME:"AA_QUALITY_HIGH",TOKENS:["2"]},{TYPE:"define",NAME:"SMAA_RESOLVE",TOKENS:["25"]},{TYPE:"define",NAME:"SMAA_EDGE_DETECTION",TOKENS:["24"]},{TYPE:"define",NAME:"SMAA_BLENDING_WEIGHT_CALCULATION",TOKENS:["23"]},{TYPE:"define",NAME:"SMAA_NEIGHBORHOOD_BLENDING",TOKENS:["26"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_LOW",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_MEDIUM",TOKENS:["2"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_HIGH",TOKENS:["3"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_ULTRA",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PASS_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"REFL_PASS_PLANE",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PASS_CUBE",TOKENS:["2"]},{TYPE:"define",NAME:"SRGB_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"SRGB_SIMPLE",TOKENS:["1"]},{TYPE:"define",NAME:"SRGB_PROPER",TOKENS:["2"]},{TYPE:"define",NAME:"CAM_TYPE_ORTHO",TOKENS:["0"]},{TYPE:"define",NAME:"CAM_TYPE_PERSP",TOKENS:["1"]},{TYPE:"define",NAME:"M_PI",TOKENS:["3.14159265359"]},{TYPE:"define",NAME:"M_PI_4",TOKENS:["0.785398163"]},{TYPE:"define",NAME:"INV_PI",TOKENS:["0.318309886"]},{TYPE:"define",NAME:"UP_VECTOR",TOKENS:["vec3","(","0.0",",","0.0",",","1.0",")"]},{TYPE:"define",NAME:"RIGHT_VECTOR",TOKENS:["vec3","(","1.0",",","0.0",",","0.0",")"]},{TYPE:"define",NAME:"TOWARD_VECTOR",TOKENS:["vec3","(","0.0",",","-","1.0",",","0.0",")"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CONSTANTS_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","_0_0","=","0.0",";","float","_0_5","=","0.5",";","float","_1_0","=","1.0",";","float","_255_0","=","255.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"_0_0",TOKENS:["0.0"]},{TYPE:"define",NAME:"_0_5",TOKENS:["0.5"]},{TYPE:"define",NAME:"_1_0",TOKENS:["1.0"]},{TYPE:"define",NAME:"_255_0",TOKENS:["255.0"]}]}}]}]}}]}]},e["include/to_world.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"TO_WORLD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"TO_WORLD_GLSLV",TOKENS:[""]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"BILLBOARD_SPHERICAL",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_RANDOM",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_PRES_GLOB_ORIENTATION",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"define",NAME:"MAX_BILLBOARD_ANGLE",TOKENS:["M_PI_4"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bn","(","vec3","KP",",","mat3","N",")","{","vec4","KQ","=","ry","(","N",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","KR","=","X","(","RIGHT_VECTOR",",","-","M_PI","/","2.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","KR","=","X","(","RIGHT_VECTOR",",","M_PI","/","2.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["KQ","=","rc","(","KR",",","KQ",")",";","KQ","=","kV","(","KQ",")",";","mat3","bo","=","aY","(",")",";","bo","=","aZ","(","KP",",","bo",")",";","bo","=","bc","(","KQ",",","bo",")",";","return","bo",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","KT","(","vec3","lL",",","vec3","KP",")","{","vec3","KS","=","lL","-","KP",";","KS",".","z","=","0.0",";","KS","=","normalize","(","KS",")",";","vec4","KQ","=","ri","(","KS",",","TOWARD_VECTOR",")",";","mat3","bo","=","aY","(",")",";","bo","=","aZ","(","KP",",","bo",")",";","bo","=","bc","(","KQ",",","bo",")",";","return","bo",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","at","(","in","vec3","KU",",","float","KV",",","float","KW",",","float","KX",",","vec3","bf",",","mat3","Z",")","{","float","IV","=","fract","(","length","(","bf",")","/","0.17",")",";","float","KY","=","KX","+","IV","/","10.0",";","float","KZ","=","IV",";","if","(","KX","!=","0.0",")","KZ","/=","KX",";","KU","*=","1.0","+","0.5","*","sin","(","KV",")",";","float","K_","=","length","(","KU",")","*","KW","*","sin","(","2.0","*","3.14","*","KV","*","KY","+","KZ",")",";","vec4","La","=","X","(","TOWARD_VECTOR",",","K_",")",";","vec4","Lb","=","ry","(","Z",")",";","Lb","=","rc","(","Lb",",","La",")",";","Z","=","bc","(","Lb",",","Z",")",";","return","Z",";","}"]}]}}]},{TYPE:"txt",TOKENS:["mat3","as","(","in","vec3","lL",",","in","vec3","aq",",","in","mat3","N",",","in","mat3","Z",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","l_","=","bn","(","aq",",","N",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BILLBOARD_RANDOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","IV","=","fract","(","(","aq",".","x","*","1.43","-","aq",".","z","*","0.123","+","aq",".","y","*","6.1",")",")",";","float","Lc","=","2.0","*","M_PI","*","IV",";","vec4","Ld","=","ry","(","N",")",";","float","Le","=","asin","(","2.0","*","(","Ld",".","x","*","Ld",".","y","-","Ld",".","z","*","Ld",".","w",")",")",";","float","hy","=","Le","-","Lc",";","if","(","hy","<","0.0",")","hy","=","2.0","*","M_PI","+","hy",";","float","Lf","=","Lc",";","if","(","hy","<=","MAX_BILLBOARD_ANGLE",")","Lf","+=","hy",";","else","if","(","hy","<=","M_PI","-","MAX_BILLBOARD_ANGLE",")","Lf","+=","MAX_BILLBOARD_ANGLE","*","(","2.0","*","hy","-","M_PI",")","/","(","2.0","*","MAX_BILLBOARD_ANGLE","-","M_PI",")",";","else","if","(","hy","<=","M_PI","+","MAX_BILLBOARD_ANGLE",")","Lf","+=","hy","-","M_PI",";","else","if","(","hy","<=","2.0","*","M_PI","-","MAX_BILLBOARD_ANGLE",")","Lf","+=","MAX_BILLBOARD_ANGLE","*","(","2.0","*","hy","-","M_PI",")","/","(","2.0","*","MAX_BILLBOARD_ANGLE","-","M_PI",")","+","M_PI",";","else","Lf","+=","hy","-","2.0","*","M_PI",";","vec4","Lg","=","X","(","UP_VECTOR",",","Lf",")",";","mat3","l_","=","aY","(",")",";","l_","=","aZ","(","aq",",","l_",")",";","l_","=","bc","(","Lg",",","l_",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","l_","=","KT","(","lL",",","aq",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","aZ","(","vec3","(","0.0",")",",","Z",")",";","l_","=","bd","(","l_",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Lh","=","rA","(","l_",")",";","vec3","Li","=","rA","(","Z",")",";","l_","=","a_","(","Lh","*","Li",",","l_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","l_",";","}","au","av","(","in","vec3","fr",",","in","vec3","Lj",",","in","vec3","Lk",",","in","vec3","Ll",",","in","vec3","Lm",",","in","vec3","Ln",",","in","mat3","Z",")","{","fr","=","ap","(","Z",",","fr",")",";","Lj","=","ap","(","Z",",","Lj",")",";","Lk","=","_","(","Z",",","Lk",")",";","Ll","=","_","(","Z",",","Ll",")",";","Lm","=","_","(","Z",",","Lm",")",";","Ln","=","bI","(","Z",",","Ln",")",";","return","ma","(","au","(","fr",",","Lj",",","Lk",",","Ll",",","Lm",",","Ln",",","vec3","(","0.0",")",")",")",";","}"]}]}}]}]},e["include/wind_bending.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"WIND_BENDING_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"WIND_BENDING_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","LA","(","inout","vec3","bt",",","in","vec3","Lo",",","in","float","Lp",",","in","float","Lq",",","in","float","fy",",","in","vec3","KU",",","in","float","Lr",",","in","mat4","b_",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","(","b_","*","vec4","(","bt",",","1.0",")",")",".","xyz",";","vec3","Lt","=","(","b_","*","vec4","(","Lo",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","bt",";","vec3","Lt","=","Lo",";"]}]}}]},{TYPE:"txt",TOKENS:["float","dD","=","length","(","Lt",")",";","float","Lu","=","Lq","*","(","1.0","+","0.1","*","fract","(","dD",")",")",";","float","Lv","=","Lp","*","Lr","*","(","1.0","+","sin","(","2.0","*","3.14","*","fy","*","Lu","+","dD",")",")",";","float","Lw","=","(","Ls",".","z","-","Lt",".","z",")","*","abs","(","Lv",")",";","Lw","+=","1.0",";","Lw","*=","Lw",";","Lw","=","Lw","*","Lw","-","Lw",";","vec3","Lx","=","Ls",";","Lx",".","xy","+=","KU",".","xy","*","Lw","*","sign","(","Lv",")",";","vec3","Ly","=","Lx","-","Lt",";","if","(","all","(","equal","(","Ly",",","vec3","(","0.0",")",")",")",")","bt","=","Lo",";","else","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Ly","=","(","b_","*","vec4","(","Ly",",","0.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["float","Lz","=","length","(","Ls","-","Lt",")",";","bt","=","Lo","+","normalize","(","Ly",")","*","Lz",";","}","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","LB","(","vec4","x",")","{","return","x","*","x","*","(","3.0","-","2.0","*","x",")",";","}","vec4","LC","(","vec4","x",")","{","return","abs","(","fract","(","x","+","0.5",")","*","2.0","-","1.0",")",";","}","vec4","LD","(","vec4","x",")","{","return","LB","(","LC","(","x",")",")",";","}","void","LP","(","inout","vec3","bt",",","in","float","fy",",","in","vec3","U",",","in","vec3","KU",",","in","vec3","Lo",",","in","float","LE",",","in","float","LF",",","in","float","LG",",","in","vec3","LH",",","in","mat4","b_",")","{","float","LI",";","float","LJ",";","float","LK",";","vec2","LL",";","vec4","LM",";","vec2","LN",";","vec3","LO",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","(","b_","*","vec4","(","bt",",","1.0",")",")",".","xyz",";","vec3","Lt","=","(","b_","*","vec4","(","Lo",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","bt",";","vec3","Lt","=","Lo",";"]}]}}]},{TYPE:"txt",TOKENS:["LI","=","dot","(","Lt",",","vec3","(","1.0",")",")",";","LJ","=","LI","+","LH",".","g",";","LK","=","dot","(","Ls",",","vec3","(","LH",".","g",")",")",";","LL","=","(","fy","+","vec2","(","LK",",","LJ",")",")",";","LM","=","(","(","fract","(","(","LL",".","xxyy","*","vec4","(","1.975",",","0.793",",","0.375",",","0.193",")",")",")","*","2.0",")","-","1.0",")","*","length","(","KU",")","*","LE",";","LM","=","LD","(","LM",")",";","LN","=","LM",".","xz","+","LM",".","yw",";","LN",".","y","=","0.5","-","LN",".","y",";","LO","=","LN",".","xxy","*","LH",".","rrb","*","vec3","(","LF","*","U",".","x",",","LF","*","U",".","y",",","LG",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LO","=","(","b_","*","vec4","(","LO",",","0.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["bt","+=","LO",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","ax","(","inout","vec3","O",",","inout","vec3","ao",",","in","vec3","U",",","in","mat4","b_",")","{","vec3","LQ","=","u_wind","*","1.0","+","0.7","*","sin","(","u_time",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","LR","=","ao",";","vec3","LS","=","a_emitter_center",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LS","=","(","b_","*","vec4","(","LS",",","1.0",")",")",".","xyz",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","LR","=","O",";","vec3","LS","=","ao",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LP","(","LR",",","u_time",",","U",",","LQ",",","LS",",","au_detail_bending_freq",",","au_detail_bending_amp",",","au_branch_bending_amp",",","a_bending_col_detail",",","b_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["LA","(","LR",",","LS",",","au_wind_bending_amp",",","au_wind_bending_freq",",","u_time",",","LQ",",","a_bending_col_main",",","b_",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LA","(","LR",",","LS",",","au_wind_bending_amp",",","au_wind_bending_freq",",","u_time",",","LQ",",","1.0",",","b_",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","+=","LR","-","ao",";","ao","=","LR",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","LR",";","ao","=","LS",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"parser",function(){return _});var a;a=function(){function e(e,t,r,a,_,n){this.message=e,this.expected=t,this.found=r,this.offset=a,this.line=_,this.column=n,this.name="SyntaxError"}function t(t){function r(e){return ti!==e&&(ti>e&&(ti=0,ri={line:1,column:1,seenCR:!1}),function(e,r,a){var _,n;for(_=r;_<a;_++)n=t.charAt(_),"\n"===n?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===n||"\u2028"===n||"\u2029"===n?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(ri,ti,e),ti=e),ri}function a(e){$o<ai||($o>ai&&(ai=$o,_i=[]),_i.push(e))}function _(a,_,n){var o=r(n),i=n<t.length?t.charAt(n):null;return null!==_&&function(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(_),new e(null!==a?a:function(e,t){var r,a,_,n=new Array(e.length);for(_=0;_<e.length;_++)n[_]=e[_].description;return r=e.length>1?n.slice(0,-1).join(", ")+" or "+n[e.length-1]:n[0],a=t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}(t)+'"':"end of input","Expected "+r+" but "+a+" found."}(_,i),_,i,n,o.line,o.column)}function n(){var e,t,r,a;return e=$o,t=He(),t!==_t?(r=o(),r!==_t?(a=He(),a!==_t?(ei=e,t=it(r),e=t):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function o(){var e,t;return e=$o,t=i(),t===_t&&(t=null),t!==_t&&(ei=e,t=st(t)),e=t}function i(){var e,t,r,a,_,n;if(e=$o,(t=s())!==_t){for(r=[],a=$o,_=He(),_!==_t?(n=s(),n!==_t?(_=[_,n],a=_):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=He(),_!==_t?(n=s(),n!==_t?(_=[_,n],a=_):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=ct(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function s(){var e;return e=c(),e===_t&&(e=d())===_t&&(e=f())===_t&&(e=M()),e}function c(){var e,t,r,a,_,n,o;if(e=$o,(t=E())!==_t)if(He()!==_t){for(r=[],a=l();a!==_t;)r.push(a),a=l();r!==_t?(a=He(),a!==_t?(_=T(),_===_t&&(_=null),_!==_t?(n=He(),n!==_t?(o=u(),o!==_t?(ei=e,t=Et(t,r,_),e=t):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;return e}function E(){var e,r,_,n,i,s,c,E,l,T;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,2)===ut?(n=ut,$o+=2):(n=_t,0===ni&&a(dt)),n!==_t?(i=je(),i!==_t?(s=x(),s!==_t?(c=Xe(),c!==_t?(E=qe(),E!==_t?(l=He(),l!==_t?(T=o(),T!==_t?(ei=e,r=ft(s,T),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,5)===Pt?(n=Pt,$o+=5):(n=_t,0===ni&&a(At)),n!==_t?(i=je(),i!==_t?(s=oi(),s!==_t?(c=Xe(),c!==_t?(E=qe(),E!==_t?(l=He(),l!==_t?(T=o(),T!==_t?(ei=e,r=St(s,T),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,6)===pt?(n=pt,$o+=6):(n=_t,0===ni&&a(vt)),n!==_t?(i=je(),i!==_t?(s=oi(),s!==_t?(c=Xe(),c!==_t?(E=qe(),E!==_t?(l=He(),l!==_t?(T=o(),T!==_t?(ei=e,r=mt(s,T),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t))),e}function l(){var e,r,_,n,i,s,c,E,l,T,u;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,4)===Ot?(n=Ot,$o+=4):(n=_t,0===ni&&a(Nt)),n!==_t?(i=je(),i!==_t?(s=x(),s!==_t?(c=Xe(),c!==_t?(E=qe(),E!==_t?(l=He(),l!==_t?(T=o(),T!==_t?(u=He(),u!==_t?(ei=e,r=gt(s,T),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function T(){var e,r,_,n,i,s,c,E;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,4)===ht?(n=ht,$o+=4):(n=_t,0===ni&&a(Rt)),n!==_t?(i=Xe(),i!==_t?(s=qe(),s!==_t?(c=He(),c!==_t?(E=o(),E!==_t?(ei=e,r=It(E),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function u(){var e,r,_,n,o,i;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,5)===bt?(n=bt,$o+=5):(n=_t,0===ni&&a(Yt)),n!==_t?(o=Xe(),o!==_t?(i=Ve(),i!==_t?(r=[r,_,n,o,i],e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function d(){var e,r,_,n,o,i,s,c,E,l;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,7)===Lt?(n=Lt,$o+=7):(n=_t,0===ni&&a(Mt)),n!==_t?(o=Xe(),o!==_t?(i=Ee(),i!==_t?(s=Xe(),s!==_t?(c=Ve(),c!==_t?(ei=e,r=yt(i),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,6)===xt?(n=xt,$o+=6):(n=_t,0===ni&&a(Ut)),n===_t&&(t.substr($o,3)===wt?(n=wt,$o+=3):(n=_t,0===ni&&a(Ct))),n!==_t?(o=je(),o!==_t?(i=oi(),i!==_t?(s=$o,c=je(),c!==_t?(E=y(),E!==_t?(c=[c,E],s=c):($o=s,s=_t)):($o=s,s=_t),s===_t&&(s=null),s!==_t?(c=Xe(),c!==_t?(E=Ve(),E!==_t?(ei=e,r=Dt(n,i,s),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,5)===Ft?(n=Ft,$o+=5):(n=_t,0===ni&&a(Gt)),n!==_t?(o=$o,i=je(),i!==_t?(s=y(),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t),o===_t&&(o=null),o!==_t?(i=Xe(),i!==_t?(s=Ve(),s!==_t?(ei=e,r=kt(o),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,4)===Kt?(n=Kt,$o+=4):(n=_t,0===ni&&a(Bt)),n!==_t?(o=je(),o!==_t?(i=y(),i!==_t?(s=Xe(),s!==_t?(c=Ve(),c!==_t?(ei=e,r=Xt(i),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,6)===jt?(n=jt,$o+=6):(n=_t,0===ni&&a(Ht)),n!==_t?(o=je(),o!==_t?(i=oi(),i!==_t?(s=je(),s!==_t?(c=y(),c!==_t?(E=Xe(),E!==_t?(l=Ve(),l!==_t?(ei=e,r=Qt(i,c),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,5)===zt?(n=zt,$o+=5):(n=_t,0===ni&&a(qt)),n!==_t?(o=je(),o!==_t?(i=oi(),i!==_t?(s=Xe(),s!==_t?(c=Ve(),c!==_t?(ei=e,r=Vt(i),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,7)===Wt?(n=Wt,$o+=7):(n=_t,0===ni&&a(Jt)),n!==_t?(o=$o,i=je(),i!==_t?(s=y(),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t),o===_t&&(o=null),o!==_t?(i=Xe(),i!==_t?(s=Ve(),s!==_t?(ei=e,r=Zt(o),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,9)===$t?(n=$t,$o+=9):(n=_t,0===ni&&a(er)),n!==_t?(o=$o,i=je(),i!==_t?(s=y(),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t),o===_t&&(o=null),o!==_t?(i=Xe(),i!==_t?(s=Ve(),s!==_t?(ei=e,r=tr(o),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,7)===rr?(n=rr,$o+=7):(n=_t,0===ni&&a(ar)),n!==_t?(o=je(),o!==_t?(i=ue(),i!==_t?(s=Xe(),s!==_t?(c=Ve(),c!==_t?(ei=e,r=_r(i),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(n=Ve(),n!==_t?(ei=e,r=nr(),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)))))))))),e}function f(){var e,t,r,a;return e=$o,t=P(),t!==_t?(r=He(),r!==_t?(a=A(),a!==_t?(ei=e,t=or(t),e=t):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=Y())===_t&&(e=L()),e}function P(){var e,r,_,n,o,i,s,c,E,l;if(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t)if(Xe()!==_t)if(t.substr($o,4)===ir?(_=ir,$o+=4):(_=_t,0===ni&&a(sr)),_!==_t)if(je()!==_t)if((n=oi())!==_t)if(Xe()!==_t)if(qe()!==_t)if(He()!==_t){for(o=[],i=$o,s=S(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);i!==_t;)o.push(i),i=$o,s=S(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);if(o!==_t){for(i=[],s=$o,c=p(),c!==_t?(E=He(),E!==_t?(c=[c,E],s=c):($o=s,s=_t)):($o=s,s=_t);s!==_t;)i.push(s),s=$o,c=p(),c!==_t?(E=He(),E!==_t?(c=[c,E],s=c):($o=s,s=_t)):($o=s,s=_t);if(i!==_t){for(s=[],c=$o,E=v(),E!==_t?(l=He(),l!==_t?(E=[E,l],c=E):($o=c,c=_t)):($o=c,c=_t);c!==_t;)s.push(c),c=$o,E=v(),E!==_t?(l=He(),l!==_t?(E=[E,l],c=E):($o=c,c=_t)):($o=c,c=_t);s!==_t?(ei=e,r=cr(n,o,i,s),e=r):($o=e,e=_t)}else $o=e,e=_t}else $o=e,e=_t}else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;return e}function A(){var e,r,_,n,o,i;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,7)===Er?(n=Er,$o+=7):(n=_t,0===ni&&a(lr)),n!==_t?(o=Xe(),o!==_t?(i=Ve(),i===_t&&(i=null),i!==_t?(r=[r,_,n,o,i],e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function S(){var e,r,_,n,o,i,s,c,E;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,8)===Tr?(n=Tr,$o+=8):(n=_t,0===ni&&a(ur)),n!==_t?(o=je(),o!==_t?(i=oi(),i!==_t?(s=$o,c=je(),c!==_t?(E=y(),E!==_t?(c=[c,E],s=c):($o=s,s=_t)):($o=s,s=_t),s===_t&&(s=null),s!==_t?(c=Xe(),c!==_t?(E=qe(),E!==_t?(ei=e,r=dr(i,s),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function p(){var e;return e=R(),e===_t&&(e=I())===_t&&(e=b()),e}function v(){var e;return e=m(),e===_t&&(e=M()),e}function m(){var e,t,r,a,_,n,o;if(e=$o,(t=O())!==_t)if(He()!==_t){for(r=[],a=N();a!==_t;)r.push(a),a=N();r!==_t?(a=He(),a!==_t?(_=g(),_===_t&&(_=null),_!==_t?(n=He(),n!==_t?(o=h(),o!==_t?(ei=e,t=fr(t,r,_),e=t):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;return e}function O(){var e,r,_,n,o,i,s,c;if(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t)if(Xe()!==_t)if(t.substr($o,7)===Pr?(_=Pr,$o+=7):(_=_t,0===ni&&a(Ar)),_!==_t)if(je()!==_t)if((n=x())!==_t)if(Xe()!==_t)if(qe()!==_t)if(He()!==_t){for(o=[],i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);i!==_t;)o.push(i),i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);o!==_t?(ei=e,r=Sr(n,o),e=r):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;if(e===_t){if(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t)if(Xe()!==_t)if(t.substr($o,10)===pr?(_=pr,$o+=10):(_=_t,0===ni&&a(vr)),_!==_t)if(je()!==_t)if((n=oi())!==_t)if(Xe()!==_t)if(qe()!==_t)if(He()!==_t){for(o=[],i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);i!==_t;)o.push(i),i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);o!==_t?(ei=e,r=mr(n,o),e=r):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;if(e===_t)if(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t)if(Xe()!==_t)if(t.substr($o,11)===Or?(_=Or,$o+=11):(_=_t,0===ni&&a(Nr)),_!==_t)if(je()!==_t)if((n=oi())!==_t)if(Xe()!==_t)if(qe()!==_t)if(He()!==_t){for(o=[],i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);i!==_t;)o.push(i),i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);o!==_t?(ei=e,r=gr(n,o),e=r):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t}return e}function N(){var e,r,_,n,o,i,s,c;if(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t)if(Xe()!==_t)if(t.substr($o,9)===hr?(_=hr,$o+=9):(_=_t,0===ni&&a(Rr)),_!==_t)if(je()!==_t)if((n=x())!==_t)if(Xe()!==_t)if(qe()!==_t)if(He()!==_t){for(o=[],i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);i!==_t;)o.push(i),i=$o,s=v(),s!==_t?(c=He(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t);o!==_t?(i=He(),i!==_t?(ei=e,r=Ir(n,o),e=r):($o=e,e=_t)):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;return e}function g(){var e,r,_,n,o,i,s;if(e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t)if(Xe()!==_t)if(t.substr($o,9)===br?(_=br,$o+=9):(_=_t,0===ni&&a(Yr)),_!==_t)if(Xe()!==_t)if(qe()!==_t)if(He()!==_t){for(n=[],o=$o,i=v(),i!==_t?(s=He(),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t);o!==_t;)n.push(o),o=$o,i=v(),i!==_t?(s=He(),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t);n!==_t?(ei=e,r=Lr(n),e=r):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;else $o=e,e=_t;return e}function h(){var e,r,_,n,o,i;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,10)===Mr?(n=Mr,$o+=10):(n=_t,0===ni&&a(yr)),n!==_t?(o=Xe(),o!==_t?(i=Ve(),i!==_t?(r=[r,_,n,o,i],e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function R(){var e,r,_,n,o,i,s,c;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,7)===xr?(n=xr,$o+=7):(n=_t,0===ni&&a(Ur)),n!==_t?(o=$o,i=je(),i!==_t?(t.substr($o,8)===wr?(s=wr,$o+=8):(s=_t,0===ni&&a(Cr)),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t),o===_t&&(o=null),o!==_t?(i=$o,s=je(),s!==_t?(c=y(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t),i===_t&&(i=null),i!==_t?(s=Xe(),s!==_t?(c=qe(),c!==_t?(ei=e,r=Dr(o,i),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function I(){var e,r,_,n,o,i,s,c;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,8)===Fr?(n=Fr,$o+=8):(n=_t,0===ni&&a(Gr)),n!==_t?(o=$o,i=je(),i!==_t?(t.substr($o,8)===wr?(s=wr,$o+=8):(s=_t,0===ni&&a(Cr)),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t),o===_t&&(o=null),o!==_t?(i=$o,s=je(),s!==_t?(c=y(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t),i===_t&&(i=null),i!==_t?(s=Xe(),s!==_t?(c=qe(),c!==_t?(ei=e,r=kr(o,i),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function b(){var e,r,_,n,o,i,s,c;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,10)===Kr?(n=Kr,$o+=10):(n=_t,0===ni&&a(Br)),n!==_t?(o=$o,i=je(),i!==_t?(t.substr($o,8)===wr?(s=wr,$o+=8):(s=_t,0===ni&&a(Cr)),s!==_t?(i=[i,s],o=i):($o=o,o=_t)):($o=o,o=_t),o===_t&&(o=null),o!==_t?(i=$o,s=je(),s!==_t?(c=y(),c!==_t?(s=[s,c],i=s):($o=i,i=_t)):($o=i,i=_t),i===_t&&(i=null),i!==_t?(s=Xe(),s!==_t?(c=qe(),c!==_t?(ei=e,r=Xr(o,i),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function Y(){var e,r,_,n,o,i;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,12)===jr?(n=jr,$o+=12):(n=_t,0===ni&&a(Hr)),n!==_t?(o=Xe(),o!==_t?(i=Ve(),i!==_t?(ei=e,r=Qr(),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function L(){var e,r,_,n,o,i;return e=$o,35===t.charCodeAt($o)?(r=lt,$o++):(r=_t,0===ni&&a(Tt)),r!==_t?(_=Xe(),_!==_t?(t.substr($o,10)===zr?(n=zr,$o+=10):(n=_t,0===ni&&a(qr)),n!==_t?(o=Xe(),o!==_t?(i=Ve(),i!==_t?(ei=e,r=Vr(),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e}function M(){var e,t;return e=$o,t=y(),t!==_t&&(ei=e,t=Wr(t)),e=t}function y(){var e,t,r,a,_,n;if(e=$o,(t=ue())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=ue(),n!==_t?(_=[_,n],a=_):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=ue(),n!==_t?(_=[_,n],a=_):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=ct(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function x(){var e,r,_,n,o,i,s,c;if(e=$o,(r=U())!==_t){for(_=[],n=$o,o=Xe(),o!==_t?(44===t.charCodeAt($o)?(i=Jr,$o++):(i=_t,0===ni&&a(Zr)),i!==_t?(s=Xe(),s!==_t?(c=U(),c!==_t?(o=[o,i,s,c],n=o):($o=n,n=_t)):($o=n,n=_t)):($o=n,n=_t)):($o=n,n=_t);n!==_t;)_.push(n),n=$o,o=Xe(),o!==_t?(44===t.charCodeAt($o)?(i=Jr,$o++):(i=_t,0===ni&&a(Zr)),i!==_t?(s=Xe(),s!==_t?(c=U(),c!==_t?(o=[o,i,s,c],n=o):($o=n,n=_t)):($o=n,n=_t)):($o=n,n=_t)):($o=n,n=_t);_!==_t?(ei=e,r=$r(r,_),e=r):($o=e,e=_t)}else $o=e,e=_t;return e}function U(){var e,r,_,n,o,i,s,c,E,l;return e=$o,r=w(),r!==_t?(_=Xe(),_!==_t?(63===t.charCodeAt($o)?(n=ea,$o++):(n=_t,0===ni&&a(ta)),n!==_t?(o=Xe(),o!==_t?(i=x(),i!==_t?(s=Xe(),s!==_t?(58===t.charCodeAt($o)?(c=ra,$o++):(c=_t,0===ni&&a(aa)),c!==_t?(E=Xe(),E!==_t?(l=x(),l!==_t?(ei=e,r=_a(r,i,l),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=w()),e}function w(){var e,t,r,a,_,n,o,i;if(e=$o,(t=C())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=ce(),n!==_t?(o=Xe(),o!==_t?(i=C(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=ce(),n!==_t?(o=Xe(),o!==_t?(i=C(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=na(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function C(){var e,t,r,a,_,n,o,i;if(e=$o,(t=D())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=se(),n!==_t?(o=Xe(),o!==_t?(i=D(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=se(),n!==_t?(o=Xe(),o!==_t?(i=D(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=oa(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function D(){var e,t,r,a,_,n,o,i;if(e=$o,(t=F())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=ie(),n!==_t?(o=Xe(),o!==_t?(i=F(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=ie(),n!==_t?(o=Xe(),o!==_t?(i=F(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=ia(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function F(){var e,t,r,a,_,n,o,i;if(e=$o,(t=G())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=oe(),n!==_t?(o=Xe(),o!==_t?(i=G(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=oe(),n!==_t?(o=Xe(),o!==_t?(i=G(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=sa(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function G(){var e,t,r,a,_,n,o,i;if(e=$o,(t=k())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=ne(),n!==_t?(o=Xe(),o!==_t?(i=k(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=ne(),n!==_t?(o=Xe(),o!==_t?(i=k(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=ca(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function k(){var e,t,r,a,_,n,o,i;if(e=$o,(t=K())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=_e(),n!==_t?(o=Xe(),o!==_t?(i=K(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=_e(),n!==_t?(o=Xe(),o!==_t?(i=K(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=Ea(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function K(){var e,t,r,a,_,n,o,i;if(e=$o,(t=B())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=ae(),n!==_t?(o=Xe(),o!==_t?(i=B(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=ae(),n!==_t?(o=Xe(),o!==_t?(i=B(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=la(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function B(){var e,t,r,a,_,n,o,i;if(e=$o,(t=X())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=re(),n!==_t?(o=Xe(),o!==_t?(i=X(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=re(),n!==_t?(o=Xe(),o!==_t?(i=X(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=Ta(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function X(){var e,t,r,a,_,n,o,i;if(e=$o,(t=j())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=te(),n!==_t?(o=Xe(),o!==_t?(i=j(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=te(),n!==_t?(o=Xe(),o!==_t?(i=j(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=ua(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function j(){var e,t,r,a,_,n,o,i;if(e=$o,(t=H())!==_t){for(r=[],a=$o,_=Xe(),_!==_t?(n=ee(),n!==_t?(o=Xe(),o!==_t?(i=H(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);a!==_t;)r.push(a),a=$o,_=Xe(),_!==_t?(n=ee(),n!==_t?(o=Xe(),o!==_t?(i=H(),i!==_t?(_=[_,n,o,i],a=_):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t)):($o=a,a=_t);r!==_t?(ei=e,t=da(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return e}function H(){var e,r,_,n;return e=$o,t.substr($o,7)===fa?(r=fa,$o+=7):(r=_t,0===ni&&a(Pa)),r!==_t?(_=Xe(),_!==_t?(n=q(),n!==_t?(ei=e,r=Aa(n),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=Q())===_t&&(e=$o,r=$(),r!==_t?(_=Xe(),_!==_t?(n=H(),n!==_t?(ei=e,r=Sa(r,n),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)),e}function Q(){var e,t,r,a;return e=$o,t=z(),t!==_t?(r=Xe(),r!==_t?(a=Z(),a!==_t?(ei=e,t=pa(t,a),e=t):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=z()),e}function z(){var e,r,_,n,o,i;return e=$o,r=V(),r!==_t&&(ei=e,r=va(r)),e=r,e===_t&&(e=$o,r=oi(),r!==_t&&(ei=e,r=ma(r)),(e=r)===_t&&(e=$o,40===t.charCodeAt($o)?(r=Oa,$o++):(r=_t,0===ni&&a(Na)),r!==_t?(_=Xe(),_!==_t?(n=x(),n!==_t?(o=Xe(),o!==_t?(41===t.charCodeAt($o)?(i=ga,$o++):(i=_t,0===ni&&a(ha)),i!==_t?(ei=e,r=Ra(n),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t))),e}function q(){var e,r,_,n,o,i;if(e=$o,r=oi(),r!==_t&&(ei=e,r=ma(r)),(e=r)===_t){if(e=$o,r=[],_=$o,n=$o,ni++,40===t.charCodeAt($o)?(o=Oa,$o++):(o=_t,0===ni&&a(Na)),o===_t&&(41===t.charCodeAt($o)?(o=ga,$o++):(o=_t,0===ni&&a(ha))),ni--,o===_t?n=void 0:($o=n,n=_t),n!==_t?(o=et(),o!==_t?(n=[n,o],_=n):($o=_,_=_t)):($o=_,_=_t),_!==_t)for(;_!==_t;)r.push(_),_=$o,n=$o,ni++,40===t.charCodeAt($o)?(o=Oa,$o++):(o=_t,0===ni&&a(Na)),o===_t&&(41===t.charCodeAt($o)?(o=ga,$o++):(o=_t,0===ni&&a(ha))),ni--,o===_t?n=void 0:($o=n,n=_t),n!==_t?(o=et(),o!==_t?(n=[n,o],_=n):($o=_,_=_t)):($o=_,_=_t);else r=_t;r!==_t&&(ei=e,r=Ia()),e=r,e===_t&&(e=$o,40===t.charCodeAt($o)?(r=Oa,$o++):(r=_t,0===ni&&a(Na)),r!==_t?(_=Xe(),_!==_t?(n=q(),n!==_t?(o=Xe(),o!==_t?(41===t.charCodeAt($o)?(i=ga,$o++):(i=_t,0===ni&&a(ha)),i!==_t?(ei=e,r=Ra(n),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t))}return e}function V(){var e,t;return ni++,e=$o,t=me(),t===_t&&(t=W()),t!==_t&&(ei=e,t=Ya(t)),e=t,ni--,e===_t&&(t=_t,0===ni&&a(ba)),e}function W(){var e,r,a;return e=$o,r=$o,a=Oe(),r=a!==_t?t.substring(r,$o):a,r!==_t&&(ei=e,r=La(r)),e=r}function J(){var e,r,_,n;return e=$o,t.substr($o,7)===fa?(r=fa,$o+=7):(r=_t,0===ni&&a(Pa)),r!==_t?(_=$o,ni++,n=Pe(),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(r=[r,_],e=r):($o=e,e=_t)):($o=e,e=_t),e}function Z(){var e;return t.substr($o,2)===xa?(e=xa,$o+=2):(e=_t,0===ni&&a(Ua)),e===_t&&(t.substr($o,2)===wa?(e=wa,$o+=2):(e=_t,0===ni&&a(Ca))),e}function $(){var e;return t.substr($o,2)===xa?(e=xa,$o+=2):(e=_t,0===ni&&a(Ua)),e===_t&&(t.substr($o,2)===wa?(e=wa,$o+=2):(e=_t,0===ni&&a(Ca)),e===_t&&(43===t.charCodeAt($o)?(e=Da,$o++):(e=_t,0===ni&&a(Fa)),e===_t&&(45===t.charCodeAt($o)?(e=Ga,$o++):(e=_t,0===ni&&a(ka)),e===_t&&(126===t.charCodeAt($o)?(e=Ka,$o++):(e=_t,0===ni&&a(Ba)),e===_t&&(33===t.charCodeAt($o)?(e=Xa,$o++):(e=_t,0===ni&&a(ja))))))),e}function ee(){var e,r,_,n;return e=$o,42===t.charCodeAt($o)?(r=Ha,$o++):(r=_t,0===ni&&a(Qa)),r===_t&&(47===t.charCodeAt($o)?(r=za,$o++):(r=_t,0===ni&&a(qa)),r===_t&&(37===t.charCodeAt($o)?(r=Va,$o++):(r=_t,0===ni&&a(Wa)))),r!==_t?(_=$o,ni++,61===t.charCodeAt($o)?(n=Ja,$o++):(n=_t,0===ni&&a(Za)),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(ei=e,r=$a(r),e=r):($o=e,e=_t)):($o=e,e=_t),e}function te(){var e,r,_,n;return e=$o,43===t.charCodeAt($o)?(r=Da,$o++):(r=_t,0===ni&&a(Fa)),r!==_t?(_=$o,ni++,43===t.charCodeAt($o)?(n=Da,$o++):(n=_t,0===ni&&a(Fa)),n===_t&&(61===t.charCodeAt($o)?(n=Ja,$o++):(n=_t,0===ni&&a(Za))),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(ei=e,r=e_(),e=r):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,45===t.charCodeAt($o)?(r=Ga,$o++):(r=_t,0===ni&&a(ka)),r!==_t?(_=$o,ni++,45===t.charCodeAt($o)?(n=Ga,$o++):(n=_t,0===ni&&a(ka)),n===_t&&(61===t.charCodeAt($o)?(n=Ja,$o++):(n=_t,0===ni&&a(Za))),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(ei=e,r=t_(),e=r):($o=e,e=_t)):($o=e,e=_t)),e}function re(){var e;return t.substr($o,2)===r_?(e=r_,$o+=2):(e=_t,0===ni&&a(a_)),e===_t&&(t.substr($o,2)===__?(e=__,$o+=2):(e=_t,0===ni&&a(n_))),e}function ae(){var e;return t.substr($o,2)===o_?(e=o_,$o+=2):(e=_t,0===ni&&a(i_)),e===_t&&(t.substr($o,2)===s_?(e=s_,$o+=2):(e=_t,0===ni&&a(c_)),e===_t&&(60===t.charCodeAt($o)?(e=E_,$o++):(e=_t,0===ni&&a(l_)),e===_t&&(62===t.charCodeAt($o)?(e=T_,$o++):(e=_t,0===ni&&a(u_))))),e}function _e(){var e;return t.substr($o,2)===d_?(e=d_,$o+=2):(e=_t,0===ni&&a(f_)),e===_t&&(t.substr($o,2)===P_?(e=P_,$o+=2):(e=_t,0===ni&&a(A_))),e}function ne(){var e,r,_,n;return e=$o,38===t.charCodeAt($o)?(r=S_,$o++):(r=_t,0===ni&&a(p_)),r!==_t?(_=$o,ni++,38===t.charCodeAt($o)?(n=S_,$o++):(n=_t,0===ni&&a(p_)),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(ei=e,r=v_(),e=r):($o=e,e=_t)):($o=e,e=_t),e}function oe(){var e,r,_,n;return e=$o,94===t.charCodeAt($o)?(r=m_,$o++):(r=_t,0===ni&&a(O_)),r!==_t?(_=$o,ni++,94===t.charCodeAt($o)?(n=m_,$o++):(n=_t,0===ni&&a(O_)),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(ei=e,r=N_(),e=r):($o=e,e=_t)):($o=e,e=_t),e}function ie(){var e,r,_,n;return e=$o,124===t.charCodeAt($o)?(r=g_,$o++):(r=_t,0===ni&&a(h_)),r!==_t?(_=$o,ni++,124===t.charCodeAt($o)?(n=g_,$o++):(n=_t,0===ni&&a(h_)),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(ei=e,r=R_(),e=r):($o=e,e=_t)):($o=e,e=_t),e}function se(){var e,r;return e=$o,t.substr($o,2)===I_?(r=I_,$o+=2):(r=_t,0===ni&&a(b_)),r!==_t&&(ei=e,r=Y_()),e=r}function ce(){var e,r;return e=$o,t.substr($o,2)===L_?(r=L_,$o+=2):(r=_t,0===ni&&a(M_)),r!==_t&&(ei=e,r=y_()),e=r}function Ee(){var e,r,_,n,o,i;return e=$o,60===t.charCodeAt($o)?(r=E_,$o++):(r=_t,0===ni&&a(l_)),r!==_t?(_=Xe(),_!==_t?(n=le(),n!==_t?(o=Xe(),o!==_t?(62===t.charCodeAt($o)?(i=T_,$o++):(i=_t,0===ni&&a(u_)),i!==_t?(ei=e,r=ya(n),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,34===t.charCodeAt($o)?(r=x_,$o++):(r=_t,0===ni&&a(U_)),r!==_t?(_=Xe(),_!==_t?(n=Te(),n!==_t?(o=Xe(),o!==_t?(34===t.charCodeAt($o)?(i=x_,$o++):(i=_t,0===ni&&a(U_)),i!==_t?(ei=e,r=ya(n),e=r):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)):($o=e,e=_t)),e}function le(){var e,r,_,n,o;for(e=$o,r=[],_=$o,n=$o,ni++,o=Ve(),o===_t&&(62===t.charCodeAt($o)?(o=T_,$o++):(o=_t,0===ni&&a(u_))),ni--,o===_t?n=void 0:($o=n,n=_t),n!==_t?(o=et(),o!==_t?(n=[n,o],_=n):($o=_,_=_t)):($o=_,_=_t);_!==_t;)r.push(_),_=$o,n=$o,ni++,o=Ve(),o===_t&&(62===t.charCodeAt($o)?(o=T_,$o++):(o=_t,0===ni&&a(u_))),ni--,o===_t?n=void 0:($o=n,n=_t),n!==_t?(o=et(),o!==_t?(n=[n,o],_=n):($o=_,_=_t)):($o=_,_=_t);return r!==_t&&(ei=e,r=w_(r)),e=r}function Te(){var e,r,_,n,o;for(e=$o,r=[],_=$o,n=$o,ni++,o=Ve(),o===_t&&(34===t.charCodeAt($o)?(o=x_,$o++):(o=_t,0===ni&&a(U_))),ni--,o===_t?n=void 0:($o=n,n=_t),n!==_t?(o=et(),o!==_t?(n=[n,o],_=n):($o=_,_=_t)):($o=_,_=_t);_!==_t;)r.push(_),_=$o,n=$o,ni++,o=Ve(),o===_t&&(34===t.charCodeAt($o)?(o=x_,$o++):(o=_t,0===ni&&a(U_))),ni--,o===_t?n=void 0:($o=n,n=_t),n!==_t?(o=et(),o!==_t?(n=[n,o],_=n):($o=_,_=_t)):($o=_,_=_t);return r!==_t&&(ei=e,r=w_(r)),e=r}function ue(){var e;return e=oi(),e===_t&&(e=pe())===_t&&(e=Le())===_t&&(e=Be()),e}function de(){var e,t,r,_;if(ni++,e=$o,(t=fe())!==_t){for(r=[],_=Pe();_!==_t;)r.push(_),_=Pe();r!==_t?(ei=e,t=C_(t,r),e=t):($o=e,e=_t)}else $o=e,e=_t;return ni--,e===_t&&(t=_t,0===ni&&a(Ma)),e}function fe(){var e;return e=Ae(),e===_t&&(36===t.charCodeAt($o)?(e=D_,$o++):(e=_t,0===ni&&a(F_)),e===_t&&(95===t.charCodeAt($o)?(e=G_,$o++):(e=_t,0===ni&&a(k_)))),e}function Pe(){var e;return e=fe(),e===_t&&(e=ge()),e}function Ae(){var e;return K_.test(t.charAt($o))?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(B_)),e}function Se(){var e,r,_,n;return e=$o,t.substr($o,7)===X_?(r=X_,$o+=7):(r=_t,0===ni&&a(j_)),r===_t&&(t.substr($o,5)===H_?(r=H_,$o+=5):(r=_t,0===ni&&a(Q_)),r===_t&&(t.substr($o,5)===z_?(r=z_,$o+=5):(r=_t,0===ni&&a(q_)),r===_t&&(t.substr($o,6)===V_?(r=V_,$o+=6):(r=_t,0===ni&&a(W_)),r===_t&&(t.substr($o,6)===J_?(r=J_,$o+=6):(r=_t,0===ni&&a(Z_)),r===_t&&(t.substr($o,3)===$_?(r=$_,$o+=3):(r=_t,0===ni&&a(en)),r===_t&&(t.substr($o,6)===tn?(r=tn,$o+=6):(r=_t,0===ni&&a(rn)),r===_t&&(t.substr($o,7)===an?(r=an,$o+=7):(r=_t,0===ni&&a(_n)),r===_t&&(t.substr($o,8)===nn?(r=nn,$o+=8):(r=_t,0===ni&&a(on)),r===_t&&(t.substr($o,5)===sn?(r=sn,$o+=5):(r=_t,0===ni&&a(cn)),r===_t&&(t.substr($o,7)===En?(r=En,$o+=7):(r=_t,0===ni&&a(ln)),r===_t&&(t.substr($o,8)===Tn?(r=Tn,$o+=8):(r=_t,0===ni&&a(un)),r===_t&&(t.substr($o,8)===dn?(r=dn,$o+=8):(r=_t,0===ni&&a(fn)),r===_t&&(t.substr($o,3)===wt?(r=wt,$o+=3):(r=_t,0===ni&&a(Ct))))))))))))))),r!==_t?(_=$o,ni++,n=Pe(),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(r=[r,_],e=r):($o=e,e=_t)):($o=e,e=_t),e}function pe(){var e,t,r,_;return ni++,e=$o,t=me(),t===_t&&(t=ve()),t!==_t?(r=$o,ni++,_=fe(),ni--,_===_t?r=void 0:($o=r,r=_t),r!==_t?(ei=e,t=Ya(t),e=t):($o=e,e=_t)):($o=e,e=_t),ni--,e===_t&&(t=_t,0===ni&&a(ba)),e}function ve(){var e,r,_,n,o,i,s;return e=$o,r=$o,_=$o,n=Oe(),n!==_t?(46===t.charCodeAt($o)?(o=Pn,$o++):(o=_t,0===ni&&a(An)),o!==_t?(i=Ne(),i===_t&&(i=null),i!==_t?(s=Re(),s===_t&&(s=null),s!==_t?(n=[n,o,i,s],_=n):($o=_,_=_t)):($o=_,_=_t)):($o=_,_=_t)):($o=_,_=_t),r=_!==_t?t.substring(r,$o):_,r!==_t&&(ei=e,r=On(r)),e=r,e===_t&&(e=$o,r=$o,_=$o,46===t.charCodeAt($o)?(n=Pn,$o++):(n=_t,0===ni&&a(An)),n!==_t?(o=Ne(),o!==_t?(i=Re(),i===_t&&(i=null),i!==_t?(n=[n,o,i],_=n):($o=_,_=_t)):($o=_,_=_t)):($o=_,_=_t),r=_!==_t?t.substring(r,$o):_,r!==_t&&(ei=e,r=Nn(r)),(e=r)===_t&&(e=$o,r=$o,_=$o,n=Oe(),n!==_t?(o=Re(),o===_t&&(o=null),o!==_t?(n=[n,o],_=n):($o=_,_=_t)):($o=_,_=_t),r=_!==_t?t.substring(r,$o):_,r!==_t&&(ei=e,r=Nn(r)),e=r)),e}function me(){var e,r,_,n,o,i;if(e=$o,48===t.charCodeAt($o)?(r=Sn,$o++):(r=_t,0===ni&&a(pn)),r!==_t)if(vn.test(t.charAt($o))?(_=t.charAt($o),$o++):(_=_t,0===ni&&a(mn)),_!==_t){if(n=$o,o=[],(i=Ye())!==_t)for(;i!==_t;)o.push(i),i=Ye();else o=_t;n=o!==_t?t.substring(n,$o):o,n!==_t?(ei=e,r=gn(n),e=r):($o=e,e=_t)}else $o=e,e=_t;else $o=e,e=_t;return e}function Oe(){var e,r,_;return 48===t.charCodeAt($o)?(e=Sn,$o++):(e=_t,0===ni&&a(pn)),e===_t&&(e=$o,r=he(),r!==_t?(_=Ne(),_===_t&&(_=null),_!==_t?(r=[r,_],e=r):($o=e,e=_t)):($o=e,e=_t)),e}function Ne(){var e,t;if(e=[],(t=ge())!==_t)for(;t!==_t;)e.push(t),t=ge();else e=_t;return e}function ge(){var e;return hn.test(t.charAt($o))?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(Rn)),e}function he(){var e;return In.test(t.charAt($o))?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(bn)),e}function Re(){var e,t,r;return e=$o,t=Ie(),t!==_t?(r=be(),r!==_t?(t=[t,r],e=t):($o=e,e=_t)):($o=e,e=_t),e}function Ie(){var e;return Yn.test(t.charAt($o))?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(Ln)),e}function be(){var e,r,_;return e=$o,Mn.test(t.charAt($o))?(r=t.charAt($o),$o++):(r=_t,0===ni&&a(yn)),r===_t&&(r=null),r!==_t?(_=Ne(),_!==_t?(r=[r,_],e=r):($o=e,e=_t)):($o=e,e=_t),e}function Ye(){var e;return xn.test(t.charAt($o))?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(Un)),e}function Le(){var e,r,_,n,o;return ni++,e=$o,r=$o,34===t.charCodeAt($o)?(_=x_,$o++):(_=_t,0===ni&&a(U_)),_!==_t?(n=Me(),n===_t&&(n=null),n!==_t?(34===t.charCodeAt($o)?(o=x_,$o++):(o=_t,0===ni&&a(U_)),o!==_t?(_=[_,n,o],r=_):($o=r,r=_t)):($o=r,r=_t)):($o=r,r=_t),r===_t&&(r=$o,39===t.charCodeAt($o)?(_=Cn,$o++):(_=_t,0===ni&&a(Dn)),_!==_t?(n=ye(),n===_t&&(n=null),n!==_t?(39===t.charCodeAt($o)?(o=Cn,$o++):(o=_t,0===ni&&a(Dn)),o!==_t?(_=[_,n,o],r=_):($o=r,r=_t)):($o=r,r=_t)):($o=r,r=_t)),r!==_t&&(ei=e,r=Fn(r)),e=r,ni--,e===_t&&(r=_t,0===ni&&a(wn)),e}function Me(){var e,t,r;if(e=$o,t=[],(r=xe())!==_t)for(;r!==_t;)t.push(r),r=xe();else t=_t;return t!==_t&&(ei=e,t=Gn(t)),e=t}function ye(){var e,t,r;if(e=$o,t=[],(r=Ue())!==_t)for(;r!==_t;)t.push(r),r=Ue();else t=_t;return t!==_t&&(ei=e,t=Gn(t)),e=t}function xe(){var e,r,_;return e=$o,r=$o,ni++,34===t.charCodeAt($o)?(_=x_,$o++):(_=_t,0===ni&&a(U_)),_===_t&&(92===t.charCodeAt($o)?(_=kn,$o++):(_=_t,0===ni&&a(Kn)),_===_t&&(_=ze())),ni--,_===_t?r=void 0:($o=r,r=_t),r!==_t?(_=et(),_!==_t?(ei=e,r=Bn(_),e=r):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,92===t.charCodeAt($o)?(r=kn,$o++):(r=_t,0===ni&&a(Kn)),r!==_t?(_=Ce(),_!==_t?(ei=e,r=Xn(_),e=r):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=we())),e}function Ue(){var e,r,_;return e=$o,r=$o,ni++,39===t.charCodeAt($o)?(_=Cn,$o++):(_=_t,0===ni&&a(Dn)),_===_t&&(92===t.charCodeAt($o)?(_=kn,$o++):(_=_t,0===ni&&a(Kn)),_===_t&&(_=ze())),ni--,_===_t?r=void 0:($o=r,r=_t),r!==_t?(_=et(),_!==_t?(ei=e,r=Bn(_),e=r):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=$o,92===t.charCodeAt($o)?(r=kn,$o++):(r=_t,0===ni&&a(Kn)),r!==_t?(_=Ce(),_!==_t?(ei=e,r=Xn(_),e=r):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=we())),e}function we(){var e,r,_;return e=$o,92===t.charCodeAt($o)?(r=kn,$o++):(r=_t,0===ni&&a(Kn)),r!==_t?(_=Ve(),_!==_t?(ei=e,r=jn(_),e=r):($o=e,e=_t)):($o=e,e=_t),e}function Ce(){var e,r,_,n;return e=De(),e===_t&&(e=$o,48===t.charCodeAt($o)?(r=Sn,$o++):(r=_t,0===ni&&a(pn)),r!==_t?(_=$o,ni++,n=ge(),ni--,n===_t?_=void 0:($o=_,_=_t),_!==_t?(ei=e,r=Hn(),e=r):($o=e,e=_t)):($o=e,e=_t),e===_t&&(e=Ke())),e}function De(){var e;return e=Fe(),e===_t&&(e=Ge()),e}function Fe(){var e,r;return e=$o,Qn.test(t.charAt($o))?(r=t.charAt($o),$o++):(r=_t,0===ni&&a(zn)),r!==_t&&(ei=e,r=qn(r)),e=r}function Ge(){var e,t,r;return e=$o,t=$o,ni++,r=ke(),ni--,r===_t?t=void 0:($o=t,t=_t),t===_t&&(t=ze()),t!==_t?(r=et(),r!==_t?(ei=e,t=Vn(r),e=t):($o=e,e=_t)):($o=e,e=_t),e}function ke(){var e;return e=Fe(),e===_t&&(e=ge())===_t&&(120===t.charCodeAt($o)?(e=Wn,$o++):(e=_t,0===ni&&a(Jn)),e===_t&&(117===t.charCodeAt($o)?(e=Zn,$o++):(e=_t,0===ni&&a($n)))),e}function Ke(){var e,r,_,n,o,i;return e=$o,120===t.charCodeAt($o)?(r=Wn,$o++):(r=_t,0===ni&&a(Jn)),r!==_t?(_=$o,n=$o,o=Ye(),o!==_t?(i=Ye(),i!==_t?(o=[o,i],n=o):($o=n,n=_t)):($o=n,n=_t),_=n!==_t?t.substring(_,$o):n,_!==_t?(ei=e,r=eo(_),e=r):($o=e,e=_t)):($o=e,e=_t),e}function Be(){var e;return ni++,t.substr($o,2)===ro?(e=ro,$o+=2):(e=_t,0===ni&&a(ao)),e===_t&&(t.substr($o,2)===_o?(e=_o,$o+=2):(e=_t,0===ni&&a(no)),e===_t&&(t.substr($o,2)===oo?(e=oo,$o+=2):(e=_t,0===ni&&a(io)),e===_t&&(t.substr($o,2)===so?(e=so,$o+=2):(e=_t,0===ni&&a(co)),e===_t&&(t.substr($o,2)===Eo?(e=Eo,$o+=2):(e=_t,0===ni&&a(lo)),e===_t&&(t.substr($o,2)===To?(e=To,$o+=2):(e=_t,0===ni&&a(uo)),e===_t&&(t.substr($o,2)===fo?(e=fo,$o+=2):(e=_t,0===ni&&a(Po)),e===_t&&(t.substr($o,2)===Ao?(e=Ao,$o+=2):(e=_t,0===ni&&a(So)),e===_t&&(t.substr($o,2)===r_?(e=r_,$o+=2):(e=_t,0===ni&&a(a_)),e===_t&&(t.substr($o,2)===__?(e=__,$o+=2):(e=_t,0===ni&&a(n_)),e===_t&&(t.substr($o,3)===po?(e=po,$o+=3):(e=_t,0===ni&&a(vo)),e===_t&&(t.substr($o,3)===mo?(e=mo,$o+=3):(e=_t,0===ni&&a(Oo)),e===_t&&(t.substr($o,2)===d_?(e=d_,$o+=2):(e=_t,0===ni&&a(f_)),e===_t&&(t.substr($o,2)===P_?(e=P_,$o+=2):(e=_t,0===ni&&a(A_)),e===_t&&(t.substr($o,2)===o_?(e=o_,$o+=2):(e=_t,0===ni&&a(i_)),e===_t&&(t.substr($o,2)===s_?(e=s_,$o+=2):(e=_t,0===ni&&a(c_)),e===_t&&(t.substr($o,2)===I_?(e=I_,$o+=2):(e=_t,0===ni&&a(b_)),e===_t&&(t.substr($o,2)===L_?(e=L_,$o+=2):(e=_t,0===ni&&a(M_)),e===_t&&(t.substr($o,2)===xa?(e=xa,$o+=2):(e=_t,0===ni&&a(Ua)),e===_t&&(t.substr($o,2)===wa?(e=wa,$o+=2):(e=_t,0===ni&&a(Ca)),e===_t&&(123===t.charCodeAt($o)?(e=No,$o++):(e=_t,0===ni&&a(go)),e===_t&&(125===t.charCodeAt($o)?(e=ho,$o++):(e=_t,0===ni&&a(Ro)),e===_t&&(91===t.charCodeAt($o)?(e=Io,$o++):(e=_t,0===ni&&a(bo)),e===_t&&(93===t.charCodeAt($o)?(e=Yo,$o++):(e=_t,0===ni&&a(Lo)),e===_t&&(40===t.charCodeAt($o)?(e=Oa,$o++):(e=_t,0===ni&&a(Na)),e===_t&&(41===t.charCodeAt($o)?(e=ga,$o++):(e=_t,0===ni&&a(ha)),e===_t&&(59===t.charCodeAt($o)?(e=Mo,$o++):(e=_t,0===ni&&a(yo)),e===_t&&(58===t.charCodeAt($o)?(e=ra,$o++):(e=_t,0===ni&&a(aa)),e===_t&&(63===t.charCodeAt($o)?(e=ea,$o++):(e=_t,0===ni&&a(ta)),e===_t&&(46===t.charCodeAt($o)?(e=Pn,$o++):(e=_t,0===ni&&a(An)),e===_t&&(43===t.charCodeAt($o)?(e=Da,$o++):(e=_t,0===ni&&a(Fa)),e===_t&&(45===t.charCodeAt($o)?(e=Ga,$o++):(e=_t,0===ni&&a(ka)),e===_t&&(42===t.charCodeAt($o)?(e=Ha,$o++):(e=_t,0===ni&&a(Qa)),e===_t&&(47===t.charCodeAt($o)?(e=za,$o++):(e=_t,0===ni&&a(qa)),e===_t&&(37===t.charCodeAt($o)?(e=Va,$o++):(e=_t,0===ni&&a(Wa)),e===_t&&(94===t.charCodeAt($o)?(e=m_,$o++):(e=_t,0===ni&&a(O_)),e===_t&&(38===t.charCodeAt($o)?(e=S_,$o++):(e=_t,0===ni&&a(p_)),e===_t&&(124===t.charCodeAt($o)?(e=g_,$o++):(e=_t,0===ni&&a(h_)),e===_t&&(126===t.charCodeAt($o)?(e=Ka,$o++):(e=_t,0===ni&&a(Ba)),e===_t&&(33===t.charCodeAt($o)?(e=Xa,$o++):(e=_t,0===ni&&a(ja)),e===_t&&(61===t.charCodeAt($o)?(e=Ja,$o++):(e=_t,0===ni&&a(Za)),e===_t&&(60===t.charCodeAt($o)?(e=E_,$o++):(e=_t,0===ni&&a(l_)),e===_t&&(62===t.charCodeAt($o)?(e=T_,$o++):(e=_t,0===ni&&a(u_)),e===_t&&(44===t.charCodeAt($o)?(e=Jr,$o++):(e=_t,0===ni&&a(Zr))))))))))))))))))))))))))))))))))))))))))))),ni--,e===_t&&(_t,0===ni&&a(to)),e}function Xe(){var e,t;for(e=[],t=Qe(),t===_t&&(t=we())===_t&&(t=Ze())===_t&&(t=$e());t!==_t;)e.push(t),(t=Qe())===_t&&(t=we())===_t&&(t=Ze())===_t&&(t=$e());return e}function je(){var e,t;if(e=[],t=Qe(),t===_t&&(t=we())===_t&&(t=Ze())===_t&&(t=$e()),t!==_t)for(;t!==_t;)e.push(t),(t=Qe())===_t&&(t=we())===_t&&(t=Ze())===_t&&(t=$e());else e=_t;return e}function He(){var e,t;for(e=[],t=Qe(),t===_t&&(t=we())===_t&&(t=qe())===_t&&(t=We());t!==_t;)e.push(t),(t=Qe())===_t&&(t=we())===_t&&(t=qe())===_t&&(t=We());return e}function Qe(){var e;return ni++,Uo.test(t.charAt($o))?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(wo)),ni--,e===_t&&(_t,0===ni&&a(xo)),e}function ze(){var e;return Co.test(t.charAt($o))?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(Do)),e}function qe(){var e;return ni++,10===t.charCodeAt($o)?(e=Go,$o++):(e=_t,0===ni&&a(ko)),e===_t&&(t.substr($o,2)===Ko?(e=Ko,$o+=2):(e=_t,0===ni&&a(Bo)),e===_t&&(13===t.charCodeAt($o)?(e=Xo,$o++):(e=_t,0===ni&&a(jo)))),ni--,e===_t&&(_t,0===ni&&a(Fo)),e}function Ve(){var e;return e=qe(),e===_t&&(e=tt()),e}function We(){var e;return ni++,e=Je(),e===_t&&(e=$e()),ni--,e===_t&&(_t,0===ni&&a(Ho)),e}function Je(){var e,r,_,n,o,i;if(e=$o,t.substr($o,2)===Qo?(r=Qo,$o+=2):(r=_t,0===ni&&a(zo)),r!==_t){for(_=[],n=$o,o=$o,ni++,t.substr($o,2)===qo?(i=qo,$o+=2):(i=_t,0===ni&&a(Vo)),ni--,i===_t?o=void 0:($o=o,o=_t),o!==_t?(i=et(),i!==_t?(o=[o,i],n=o):($o=n,n=_t)):($o=n,n=_t);n!==_t;)_.push(n),n=$o,o=$o,ni++,t.substr($o,2)===qo?(i=qo,$o+=2):(i=_t,0===ni&&a(Vo)),ni--,i===_t?o=void 0:($o=o,o=_t),o!==_t?(i=et(),i!==_t?(o=[o,i],n=o):($o=n,n=_t)):($o=n,n=_t);_!==_t?(t.substr($o,2)===qo?(n=qo,$o+=2):(n=_t,0===ni&&a(Vo)),n!==_t?(r=[r,_,n],e=r):($o=e,e=_t)):($o=e,e=_t)}else $o=e,e=_t;return e}function Ze(){var e,r,_,n,o,i;if(e=$o,t.substr($o,2)===Qo?(r=Qo,$o+=2):(r=_t,0===ni&&a(zo)),r!==_t){for(_=[],n=$o,o=$o,ni++,t.substr($o,2)===qo?(i=qo,$o+=2):(i=_t,0===ni&&a(Vo)),i===_t&&(i=ze()),ni--,i===_t?o=void 0:($o=o,o=_t),o!==_t?(i=et(),i!==_t?(o=[o,i],n=o):($o=n,n=_t)):($o=n,n=_t);n!==_t;)_.push(n),n=$o,o=$o,ni++,t.substr($o,2)===qo?(i=qo,$o+=2):(i=_t,0===ni&&a(Vo)),i===_t&&(i=ze()),ni--,i===_t?o=void 0:($o=o,o=_t),o!==_t?(i=et(),i!==_t?(o=[o,i],n=o):($o=n,n=_t)):($o=n,n=_t);_!==_t?(t.substr($o,2)===qo?(n=qo,$o+=2):(n=_t,0===ni&&a(Vo)),n!==_t?(r=[r,_,n],e=r):($o=e,e=_t)):($o=e,e=_t)}else $o=e,e=_t;return e}function $e(){var e,r,_,n,o,i;if(e=$o,t.substr($o,2)===Wo?(r=Wo,$o+=2):(r=_t,0===ni&&a(Jo)),r!==_t){for(_=[],n=$o,o=$o,ni++,i=ze(),ni--,i===_t?o=void 0:($o=o,o=_t),o!==_t?(i=et(),i!==_t?(o=[o,i],n=o):($o=n,n=_t)):($o=n,n=_t);n!==_t;)_.push(n),n=$o,o=$o,ni++,i=ze(),ni--,i===_t?o=void 0:($o=o,o=_t),o!==_t?(i=et(),i!==_t?(o=[o,i],n=o):($o=n,n=_t)):($o=n,n=_t);_!==_t?(r=[r,_],e=r):($o=e,e=_t)}else $o=e,e=_t;return e}function et(){var e;return t.length>$o?(e=t.charAt($o),$o++):(e=_t,0===ni&&a(Zo)),e}function tt(){var e,r;return e=$o,ni++,t.length>$o?(r=t.charAt($o),$o++):(r=_t,0===ni&&a(Zo)),ni--,r===_t?e=void 0:($o=e,e=_t),e}var rt,at=arguments.length>1?arguments[1]:{},_t={},nt={start:n},ot=n,it=function(e){return e},st=function(e){return{TYPE:"grp",PARTS:null!==e?e:[]}},ct=function(e,t){for(var r=[e],a=0;a<t.length;a++)r.push(t[a][1]);return r},Et=function(e,t,r){for(var a=[e],_=0;_<t.length;_++)a.push(t[_]);return null!==r&&a.push(r),{TYPE:"cond",PARTS:a}},lt="#",Tt={type:"literal",value:"#",description:'"#"'},ut="if",dt={type:"literal",value:"if",description:'"if"'},ft=function(e,t){return{TYPE:"if",EXPRESSION:e,GROUP:t}},Pt="ifdef",At={type:"literal",value:"ifdef",description:'"ifdef"'},St=function(e,t){return{TYPE:"ifdef",NAME:e,GROUP:t}},pt="ifndef",vt={type:"literal",value:"ifndef",description:'"ifndef"'},mt=function(e,t){return{TYPE:"ifndef",NAME:e,GROUP:t}},Ot="elif",Nt={type:"literal",value:"elif",description:'"elif"'},gt=function(e,t){return{TYPE:"elif",EXPRESSION:e,GROUP:t}},ht="else",Rt={type:"literal",value:"else",description:'"else"'},It=function(e){return{TYPE:"else",GROUP:e}},bt="endif",Yt={type:"literal",value:"endif",description:'"endif"'},Lt="include",Mt={type:"literal",value:"include",description:'"include"'},yt=function(e){return{TYPE:"include",FILE:e}},xt="define",Ut={type:"literal",value:"define",description:'"define"'},wt="var",Ct={type:"literal",value:"var",description:'"var"'},Dt=function(e,t,r){var a=[];if(null===r)a.push("");else for(var _=0;_<r[1].length;_++)a.push(r[1][_]);return{TYPE:e,NAME:t,TOKENS:a}},Ft="error",Gt={type:"literal",value:"error",description:'"error"'},kt=function(e){var t=[];if(null!==e)for(var r=0;r<e[1].length;r++)t.push(e[1][r]);return{TYPE:"error",TOKENS:t}},Kt="line",Bt={type:"literal",value:"line",description:'"line"'},Xt=function(e){return{TYPE:"line",TOKENS:e}},jt="pragma",Ht={type:"literal",value:"pragma",description:'"pragma"'},Qt=function(e,t){return{TYPE:"pragma",NAME:e,TOKENS:t}},zt="undef",qt={type:"literal",value:"undef",description:'"undef"'},Vt=function(e){return{TYPE:"undef",NAME:e}},Wt="warning",Jt={type:"literal",value:"warning",description:'"warning"'},Zt=function(e){var t=[];if(null!==e)for(var r=0;r<e[1].length;r++)t.push(e[1][r]);return{TYPE:"warning",TOKENS:t}},$t="extension",er={type:"literal",value:"extension",description:'"extension"'},tr=function(e){var t=[];if(null!==e)for(var r=0;r<e[1].length;r++)t.push(e[1][r]);return{TYPE:"extension",TOKENS:t}},rr="version",ar={type:"literal",value:"version",description:'"version"'},_r=function(e){var t=[];return null!==e&&t.push(e),{TYPE:"version",TOKENS:t}},nr=function(){return{TYPE:"#"}},or=function(e){return e},ir="node",sr={type:"literal",value:"node",description:'"node"'},cr=function(e,t,r,a){for(var _=[],n=0;n<t.length;n++)_.push(t[n][0]);for(var o=[],n=0;n<r.length;n++)o.push(r[n][0]);for(var i=[],n=0;n<a.length;n++)i.push(a[n][0]);return{TYPE:"node",NAME:e,NODE_VARS:_,DECLARATIONS:o,STATEMENTS:i}},Er="endnode",lr={type:"literal",value:"endnode",description:'"endnode"'},Tr="node_var",ur={type:"literal",value:"node_var",description:'"node_var"'},dr=function(e,t){var r=[];if(null===t)r.push("");else for(var a=0;a<t[1].length;a++)r.push(t[1][a]);return{TYPE:"node_var",NAME:e,TOKENS:r}},fr=function(e,t,r){for(var a=[e],_=0;_<t.length;_++)a.push(t[_]);return null!==r&&a.push(r),{TYPE:"node_cond",PARTS:a}},Pr="node_if",Ar={type:"literal",value:"node_if",description:'"node_if"'},Sr=function(e,t){for(var r=[],a=0;a<t.length;a++)r.push(t[a][0]);return{TYPE:"node_if",EXPRESSION:e,STATEMENTS:r}},pr="node_ifdef",vr={type:"literal",value:"node_ifdef",description:'"node_ifdef"'},mr=function(e,t){for(var r=[],a=0;a<t.length;a++)r.push(t[a][0]);return{TYPE:"node_ifdef",NAME:e,STATEMENTS:r}},Or="node_ifndef",Nr={type:"literal",value:"node_ifndef",description:'"node_ifndef"'},gr=function(e,t){for(var r=[],a=0;a<t.length;a++)r.push(t[a][0]);return{TYPE:"node_ifndef",NAME:e,STATEMENTS:r}},hr="node_elif",Rr={type:"literal",value:"node_elif",description:'"node_elif"'},Ir=function(e,t){for(var r=[],a=0;a<t.length;a++)r.push(t[a][0]);return{TYPE:"node_elif",EXPRESSION:e,STATEMENTS:r}},br="node_else",Yr={type:"literal",value:"node_else",description:'"node_else"'},Lr=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r][0]);return{TYPE:"node_else",STATEMENTS:t}},Mr="node_endif",yr={type:"literal",value:"node_endif",description:'"node_endif"'},xr="node_in",Ur={type:"literal",value:"node_in",description:'"node_in"'},wr="optional",Cr={type:"literal",value:"optional",description:'"optional"'},Dr=function(e,t){var r=[];if(null!==t)for(var a=0;a<t[1].length;a++)r.push(t[1][a]);return{TYPE:"node_in",NAME:r.pop(),QUALIFIER:r,IS_OPTIONAL:Boolean(e)}},Fr="node_out",Gr={type:"literal",value:"node_out",description:'"node_out"'},kr=function(e,t){var r=[];if(null!==t)for(var a=0;a<t[1].length;a++)r.push(t[1][a]);return{TYPE:"node_out",NAME:r.pop(),QUALIFIER:r,IS_OPTIONAL:Boolean(e)}},Kr="node_param",Br={type:"literal",value:"node_param",description:'"node_param"'},Xr=function(e,t){var r=[];if(null!==t)for(var a=0;a<t[1].length;a++)r.push(t[1][a]);return{TYPE:"node_param",NAME:r.pop(),QUALIFIER:r,IS_OPTIONAL:Boolean(e)}},jr="nodes_global",Hr={type:"literal",value:"nodes_global",description:'"nodes_global"'},Qr=function(){return{TYPE:"nodes_global"}},zr="nodes_main",qr={type:"literal",value:"nodes_main",description:'"nodes_main"'},Vr=function(){return{TYPE:"nodes_main"}},Wr=function(e){return{TYPE:"txt",TOKENS:e}},Jr=",",Zr={type:"literal",value:",",description:'","'},$r=function(e,t){return 0==t.length?e:t[t.length-1]},ea="?",ta={type:"literal",value:"?",description:'"?"'},ra=":",aa={type:"literal",value:":",description:'":"'},_a=function(e,t,r){var a=e,_={TYPE:"conditional_expr",PLACES:3};return a.push.apply(a,t),a.push.apply(a,r),a.push(_),a},na=function(e,t){var r=e;if(t.length){for(var a={TYPE:"logical_or_expr",PLACES:t.length+1},_=0;_<t.length;_++)r.push.apply(r,t[_][3]);r.push(a)}return r},oa=function(e,t){var r=e;if(t.length){for(var a={TYPE:"logical_and_expr",PLACES:t.length+1},_=0;_<t.length;_++)r.push.apply(r,t[_][3]);r.push(a)}return r},ia=function(e,t){var r=e;if(t.length){for(var a={TYPE:"logical_bitor_expr",PLACES:t.length+1},_=0;_<t.length;_++)r.push.apply(r,t[_][3]);r.push(a)}return r},sa=function(e,t){var r=e;if(t.length){for(var a={TYPE:"logical_bitxor_expr",PLACES:t.length+1},_=0;_<t.length;_++)r.push.apply(r,t[_][3]);r.push(a)}return r},ca=function(e,t){var r=e;if(t.length){for(var a={TYPE:"logical_bitand_expr",PLACES:t.length+1},_=0;_<t.length;_++)r.push.apply(r,t[_][3]);r.push(a)}return r},Ea=function(e,t){for(var r=e,a=0;a<t.length;a++)switch(t[a][1]){case"==":var _={TYPE:"equal_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case"!=":var _={TYPE:"non_equal_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_)}return r},la=function(e,t){for(var r=e,a=0;a<t.length;a++)switch(t[a][1]){case"<=":var _={TYPE:"le_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case">=":var _={TYPE:"ge_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case"<":var _={TYPE:"l_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case">":var _={TYPE:"g_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_)}return r},Ta=function(e,t){for(var r=e,a=0;a<t.length;a++)switch(t[a][1]){case"<<":var _={TYPE:"left_shift_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case">>":var _={TYPE:"right_shift_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_)}return r},ua=function(e,t){for(var r=e,a=0;a<t.length;a++)switch(t[a][1]){case"+":var _={TYPE:"add_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case"-":var _={TYPE:"sub_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_)}return r},da=function(e,t){for(var r=e,a=0;a<t.length;a++)switch(t[a][1]){case"*":var _={TYPE:"mul_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case"/":var _={TYPE:"div_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_);break;case"%":var _={TYPE:"mod_expr",PLACES:2};r.push.apply(r,t[a][3]),r.push(_)}return r},fa="defined",Pa={type:"literal",value:"defined",description:'"defined"'},Aa=function(e){return e},Sa=function(e,t){var r=t;switch(e){case"++":var a={TYPE:"pre_inc_expr",PLACES:1};r.push(a);break;case"--":var a={TYPE:"pre_dec_expr",PLACES:1};r.push(a);break;case"+":var a={TYPE:"positive_expr",PLACES:1};r.push(a);break;case"-":var a={TYPE:"negative_expr",PLACES:1};r.push(a);break;case"~":var a={TYPE:"one_compl_expr",PLACES:1};r.push(a);break;case"!":var a={TYPE:"logic_negative_expr",PLACES:1};r.push(a)}return r},pa=function(e,t){var r=e;switch(t){case"++":var a={TYPE:"post_inc_expr",PLACES:1};r.push(a);break;case"--":var a={TYPE:"post_dec_expr",PLACES:1};r.push(a)}return r},va=function(e){return[e]},ma=function(e){return[e]},Oa="(",Na={type:"literal",value:"(",description:'"("'},ga=")",ha={type:"literal",value:")",description:'")"'},Ra=function(e){return e},Ia=function(){return 1},ba={type:"other",description:"number"},Ya=function(e){return e},La=function(e){return parseInt(e)},Ma={type:"other",description:"identifier"},ya=function(e){return e},xa="++",Ua={type:"literal",value:"++",description:'"++"'},wa="--",Ca={type:"literal",value:"--",description:'"--"'},Da="+",Fa={type:"literal",value:"+",description:'"+"'},Ga="-",ka={type:"literal",value:"-",description:'"-"'},Ka="~",Ba={type:"literal",value:"~",description:'"~"'},Xa="!",ja={type:"literal",value:"!",description:'"!"'},Ha="*",Qa={type:"literal",value:"*",description:'"*"'},za="/",qa={type:"literal",value:"/",description:'"/"'},Va="%",Wa={type:"literal",value:"%",description:'"%"'},Ja="=",Za={type:"literal",value:"=",description:'"="'},$a=function(e){return e},e_=function(){return"+"},t_=function(){return"-"},r_="<<",a_={type:"literal",value:"<<",description:'"<<"'},__=">>",n_={type:"literal",value:">>",description:'">>"'},o_="<=",i_={type:"literal",value:"<=",description:'"<="'},s_=">=",c_={type:"literal",value:">=",description:'">="'},E_="<",l_={type:"literal",value:"<",description:'"<"'},T_=">",u_={type:"literal",value:">",description:'">"'},d_="==",f_={type:"literal",value:"==",description:'"=="'},P_="!=",A_={type:"literal",value:"!=",description:'"!="'},S_="&",p_={type:"literal",value:"&",description:'"&"'},v_=function(){return"&"},m_="^",O_={type:"literal",value:"^",description:'"^"'},N_=function(){return"^"},g_="|",h_={type:"literal",value:"|",description:'"|"'},R_=function(){return"|"},I_="&&",b_={type:"literal",value:"&&",description:'"&&"'},Y_=function(){return"&&"},L_="||",M_={type:"literal",value:"||",description:'"||"'},y_=function(){return"||"},x_='"',U_={type:"literal",value:'"',description:'"\\""'},w_=function(e){for(var t="",r=0;r<e.length;r++)t+=e[r][1];return t},C_=function(e,t){return e+t.join("")},D_="$",F_={type:"literal",value:"$",description:'"$"'},G_="_",k_={type:"literal",value:"_",description:'"_"'},K_=/^[a-zA-Z]/,B_={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},X_="#define",j_={type:"literal",value:"#define",description:'"#define"'},H_="#elif",Q_={type:"literal",value:"#elif",description:'"#elif"'},z_="#else",q_={type:"literal",value:"#else",description:'"#else"'},V_="#endif",W_={type:"literal",value:"#endif",description:'"#endif"'},J_="#error",Z_={type:"literal",value:"#error",description:'"#error"'},$_="#if",en={type:"literal",value:"#if",description:'"#if"'},tn="#ifdef",rn={type:"literal",value:"#ifdef",description:'"#ifdef"'},an="#ifndef",_n={type:"literal",value:"#ifndef",description:'"#ifndef"'},nn="#include",on={type:"literal",value:"#include",description:'"#include"'},sn="#line",cn={type:"literal",value:"#line",description:'"#line"'},En="#pragma",ln={type:"literal",value:"#pragma",description:'"#pragma"'},Tn="#warning",un={type:"literal",value:"#warning",description:'"#warning"'},dn="#version",fn={type:"literal",value:"#version",description:'"#version"'},Pn=".",An={type:"literal",value:".",description:'"."'},Sn="0",pn={type:"literal",value:"0",description:'"0"'},vn=/^[xX]/,mn={type:"class",value:"[xX]",description:"[xX]"},On=function(e){return e},Nn=function(e){return e},gn=function(e){return String(parseInt("0x"+e))},hn=/^[0-9]/,Rn={type:"class",value:"[0-9]",description:"[0-9]"},In=/^[1-9]/,bn={type:"class",value:"[1-9]",description:"[1-9]"},Yn=/^[eE]/,Ln={type:"class",value:"[eE]",description:"[eE]"},Mn=/^[\-+]/,yn={type:"class",value:"[-+]",description:"[-+]"},xn=/^[0-9a-fA-F]/,Un={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},wn={type:"other",description:"string"},Cn="'",Dn={type:"literal",value:"'",description:'"\'"'},Fn=function(e){return'"'+e[1]+'"'},Gn=function(e){return e.join("")},kn="\\",Kn={type:"literal",value:"\\",description:'"\\\\"'},Bn=function(e){return e},Xn=function(e){return e},jn=function(e){return e},Hn=function(){return"\0"},Qn=/^['"\\bfnrtv]/,zn={type:"class",value:"['\"\\\\bfnrtv]",description:"['\"\\\\bfnrtv]"},qn=function(e){return e.replace("b","\b").replace("f","\f").replace("n","\n").replace("r","\r").replace("t","\t").replace("v","\v")},Vn=function(e){return e},Wn="x",Jn={type:"literal",value:"x",description:'"x"'},Zn="u",$n={type:"literal",value:"u",description:'"u"'},eo=function(e){return String.fromCharCode(parseInt("0x"+e))},to={type:"other",description:"punctuation"},ro="+=",ao={type:"literal",value:"+=",description:'"+="'},_o="-=",no={type:"literal",value:"-=",description:'"-="'},oo="*=",io={type:"literal",value:"*=",description:'"*="'},so="/=",co={type:"literal",value:"/=",description:'"/="'},Eo="%=",lo={type:"literal",value:"%=",description:'"%="'},To="^=",uo={type:"literal",value:"^=",description:'"^="'},fo="&=",Po={type:"literal",value:"&=",description:'"&="'},Ao="|=",So={type:"literal",value:"|=",description:'"|="'},po="<<=",vo={type:"literal",value:"<<=",description:'"<<="'},mo=">>=",Oo={type:"literal",value:">>=",description:'">>="'},No="{",go={type:"literal",value:"{",description:'"{"'},ho="}",Ro={type:"literal",value:"}",description:'"}"'},Io="[",bo={type:"literal",value:"[",description:'"["'},Yo="]",Lo={type:"literal",value:"]",description:'"]"'},Mo=";",yo={type:"literal",value:";",description:'";"'},xo={type:"other",description:"whitespace"},Uo=/^[\t\x0B\f ]/,wo={type:"class",value:"[\\t\\v\\f ]",description:"[\\t\\v\\f ]"},Co=/^[\n\r]/,Do={type:"class",value:"[\\n\\r]",description:"[\\n\\r]"},Fo={type:"other",description:"end of line"},Go="\n",ko={type:"literal",value:"\n",description:'"\\n"'},Ko="\r\n",Bo={type:"literal",value:"\r\n",description:'"\\r\\n"'},Xo="\r",jo={type:"literal",value:"\r",description:'"\\r"'},Ho={type:"other",description:"comment"},Qo="/*",zo={type:"literal",value:"/*",description:'"/*"'},qo="*/",Vo={type:"literal",value:"*/",description:'"*/"'},Wo="//",Jo={type:"literal",value:"//",description:'"//"'},Zo={type:"any",description:"any character"},$o=0,ei=0,ti=0,ri={line:1,column:1,seenCR:!1},ai=0,_i=[],ni=0;if("startRule"in at){if(!(at.startRule in nt))throw new Error("Can't start parsing from rule \""+at.startRule+'".');ot=nt[at.startRule]}var oi=function(){var e,t,r;return ni++,e=$o,t=$o,ni++,r=J(),ni--,r===_t?t=void 0:($o=t,t=_t),t!==_t?(r=de(),r!==_t?(ei=e,t=ya(r),e=t):($o=e,e=_t)):($o=e,e=_t),ni--,e===_t&&(t=_t,0===ni&&a(Ma)),e};if(oi=function(){var e,t,r;return ni++,e=$o,t=$o,ni++,r=Se(),ni--,r===_t?t=void 0:($o=t,t=_t),t!==_t?(r=de(),r!==_t?(ei=e,t=ya(r),e=t):($o=e,e=_t)):($o=e,e=_t),ni--,e===_t&&(t=_t,0===ni&&a(Ma)),e},(rt=ot())!==_t&&$o===t.length)return rt;throw rt!==_t&&$o<t.length&&a({type:"end",description:"end of input"}),_(null,_i,ai)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),{SyntaxError:e,parse:t}}();var _=a},function(e,t,r){"use strict";function a(e,t){var r=e[0],a=e[1],_=e[2],c=e[3];r=n(r,a,_,c,t[0],7,-680876936),c=n(c,r,a,_,t[1],12,-389564586),_=n(_,c,r,a,t[2],17,606105819),a=n(a,_,c,r,t[3],22,-1044525330),r=n(r,a,_,c,t[4],7,-176418897),c=n(c,r,a,_,t[5],12,1200080426),_=n(_,c,r,a,t[6],17,-1473231341),a=n(a,_,c,r,t[7],22,-45705983),r=n(r,a,_,c,t[8],7,1770035416),c=n(c,r,a,_,t[9],12,-1958414417),_=n(_,c,r,a,t[10],17,-42063),a=n(a,_,c,r,t[11],22,-1990404162),r=n(r,a,_,c,t[12],7,1804603682),c=n(c,r,a,_,t[13],12,-40341101),_=n(_,c,r,a,t[14],17,-1502002290),a=n(a,_,c,r,t[15],22,1236535329),r=o(r,a,_,c,t[1],5,-165796510),c=o(c,r,a,_,t[6],9,-1069501632),_=o(_,c,r,a,t[11],14,643717713),a=o(a,_,c,r,t[0],20,-373897302),r=o(r,a,_,c,t[5],5,-701558691),c=o(c,r,a,_,t[10],9,38016083),_=o(_,c,r,a,t[15],14,-660478335),a=o(a,_,c,r,t[4],20,-405537848),r=o(r,a,_,c,t[9],5,568446438),c=o(c,r,a,_,t[14],9,-1019803690),_=o(_,c,r,a,t[3],14,-187363961),a=o(a,_,c,r,t[8],20,1163531501),r=o(r,a,_,c,t[13],5,-1444681467),c=o(c,r,a,_,t[2],9,-51403784),_=o(_,c,r,a,t[7],14,1735328473),a=o(a,_,c,r,t[12],20,-1926607734),r=i(r,a,_,c,t[5],4,-378558),c=i(c,r,a,_,t[8],11,-2022574463),_=i(_,c,r,a,t[11],16,1839030562),a=i(a,_,c,r,t[14],23,-35309556),r=i(r,a,_,c,t[1],4,-1530992060),c=i(c,r,a,_,t[4],11,1272893353),_=i(_,c,r,a,t[7],16,-155497632),a=i(a,_,c,r,t[10],23,-1094730640),r=i(r,a,_,c,t[13],4,681279174),c=i(c,r,a,_,t[0],11,-358537222),_=i(_,c,r,a,t[3],16,-722521979),a=i(a,_,c,r,t[6],23,76029189),r=i(r,a,_,c,t[9],4,-640364487),c=i(c,r,a,_,t[12],11,-421815835),_=i(_,c,r,a,t[15],16,530742520),a=i(a,_,c,r,t[2],23,-995338651),r=s(r,a,_,c,t[0],6,-198630844),c=s(c,r,a,_,t[7],10,1126891415),_=s(_,c,r,a,t[14],15,-1416354905),a=s(a,_,c,r,t[5],21,-57434055),r=s(r,a,_,c,t[12],6,1700485571),c=s(c,r,a,_,t[3],10,-1894986606),_=s(_,c,r,a,t[10],15,-1051523),a=s(a,_,c,r,t[1],21,-2054922799),r=s(r,a,_,c,t[8],6,1873313359),c=s(c,r,a,_,t[15],10,-30611744),_=s(_,c,r,a,t[6],15,-1560198380),a=s(a,_,c,r,t[13],21,1309151649),r=s(r,a,_,c,t[4],6,-145523070),c=s(c,r,a,_,t[11],10,-1120210379),_=s(_,c,r,a,t[2],15,718787259),a=s(a,_,c,r,t[9],21,-343485551),e[0]=u(r,e[0]),e[1]=u(a,e[1]),e[2]=u(_,e[2]),e[3]=u(c,e[3])}function _(e,t,r,a,_,n){return t=u(u(t,e),u(a,n)),u(t<<_|t>>>32-_,r)}function n(e,t,r,a,n,o,i){return _(t&r|~t&a,e,t,n,o,i)}function o(e,t,r,a,n,o,i){return _(t&a|r&~a,e,t,n,o,i)}function i(e,t,r,a,n,o,i){return _(t^r^a,e,t,n,o,i)}function s(e,t,r,a,n,o,i){return _(r^(t|~a),e,t,n,o,i)}function c(e){var t,r=e.length,_=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)a(_,E(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(a(_,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,a(_,n),_}function E(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function l(e){for(var t="",r=0;r<4;r++)t+=f[e>>8*r+4&15]+f[e>>8*r&15];return t}function T(e){for(var t=0;t<e.length;t++)e[t]=l(e[t]);return e.join("")}function u(e,t){return e+t&4294967295}function d(e){return T(c(e))}t.a=d;var f="0123456789abcdef".split("")},function(e,t,r){"use strict";function a(e,t){function r(e){switch(e.type){case"VALTORGB":e.color_ramp||(e.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},v("node Color Ramp",e,"color_ramp"));break;case"CURVE_RGB":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},v("node RGB Curves",e,"curve_mapping"));break;case"CURVE_VEC":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},v("node Vector Curves",e,"curve_mapping"));break;case"MAPPING":e.vector_type||(e.vector_type="POINT",v("node Mapping",e,"vector_type"));break;case"MATERIAL":case"MATERIAL_EXT":"alpha"in e||(e.alpha=1,v("node material",e,"alpha")),"darkness"in e||(e.darkness=1,v("node material",e,"darkness")),"diffuse_toon_size"in e||(e.diffuse_toon_size=.5,v("node material",e,"diffuse_toon_size")),"diffuse_toon_smooth"in e||(e.diffuse_toon_smooth=.1,v("node material",e,"diffuse_toon_smooth")),"diffuse_intensity"in e||(e.diffuse_intensity=1,v("node material",e,"diffuse_intensity")),"use_tangent_shading"in e||(e.use_tangent_shading=!1,v("node material",e,"use_tangent_shading")),"specular_shader"in e||(e.specular_shader="COOKTORR",v("node material",e,"specular_shader")),"specular_ior"in e||(e.specular_ior=4,v("node material",e,"specular_ior")),"specular_hardness"in e||(e.specular_hardness=50,v("node material",e,"specular_hardness")),"specular_slope"in e||(e.specular_slope=.1,v("node material",e,"specular_slope")),"specular_toon_size"in e||(e.specular_toon_size=.5,v("node material",e,"specular_toon_size")),"specular_toon_smooth"in e||(e.specular_toon_smooth=.1,v("node material",e,"specular_toon_smooth")),"specular_intensity"in e||(e.specular_intensity=.5,v("node material",e,"specular_intensity")),"diffuse_shader"in e||(e.diffuse_shader="LAMBERT",v("node material",e,"diffuse_shader")),"roughness"in e||(e.roughness=.5,v("node material",e,"roughness")),"diffuse_fresnel"in e||(e.diffuse_fresnel=.1,v("node material",e,"diffuse_fresnel")),"diffuse_fresnel_factor"in e||(e.diffuse_fresnel_factor=.5,v("node material",e,"diffuse_fresnel_factor"));break;case"MATH":case"MIX_RGB":"use_clamp"in e||(e.use_clamp=!1,v("node "+e.type,e,"use_clamp"));break;case"GROUP":switch(e.node_tree_name=e.node_tree_name.replace(/\.[0-9]{3,}$/g,""),e.node_tree_name){case"CLAMP":case"LEVELS_OF_QUALITY":case"LINEAR_TO_SRGB":case"NORMAL_VIEW":case"PARALLAX":case"REFLECT":case"REFRACTION":case"REPLACE":case"SMOOTHSTEP":case"SRGB_TO_LINEAR":case"TIME":case"TRANSLUCENCY":case"VECTOR_VIEW":e.node_tree_name="B4W_"+e.node_tree_name}break;case"VECT_TRANSFORM":"convert_from"in e||(e.convert_from="WORLD",v("node "+e.type,e,"convert_from")),"convert_to"in e||(e.convert_to="WORLD",v("node "+e.type,e,"convert_to")),"vector_type"in e||(e.vector_type="POINT",v("node "+e.type,e,"vector_type"));break;case"ATTRIBUTE":e.color_layer="";break;case"BSDF_TRANSPARENT":"b4w_use_alpha"in e||(e.b4w_use_alpha=!1,v("node "+e.type,e,"b4w_use_alpha"))}}function a(e){var t=e.nla_tracks;if(t)for(var r=0;r<t.length;r++)for(var a=t[r],_=0;_<a.strips.length;_++){var n=a.strips[_];"action"in n||(n.action=null,v("strip",n,"action")),"action_frame_start"in n||(n.action_frame_start=0,v("strip",n,"action_frame_start")),"action_frame_end"in n||(n.action_frame_end=n.frame_end-n.frame_start,v("strip",n,"action_frame_end")),"repeat"in n||(n.repeat=1,v("strip",n,"repeat")),"use_reverse"in n||(n.use_reverse=!1,v("strip",n,"use_reverse")),"scale"in n||(n.scale=1,v("strip",n,"scale"))}}function _(e){for(var t=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],r=null,a=0;a<t.length;a++)e[t[a]]&&(r?(e[t[a]]=!1,F.warn('WARNING property "'+t[a]+'" of object "'+e.name+'" has been set to "false". Foreground property "'+r+'" already exists.')):r=t[a])}function S(e){var t=e.game,r=t.collision_bounds_type;t.use_collision_bounds&&"BOX"!=r&&"CYLINDER"!=r&&"CONE"!=r&&"SPHERE"!=r&&"CAPSULE"!=r&&"EMPTY"!=r&&(F.error("Wrong collision bounds type "+r+". Disable physics for object "+e.name),e.b4w_collision=!1,e.b4w_floating=!1,e.b4w_vehicle=!1,e.b4w_character=!1)}function p(e,t){var r=e[0],a=e[1],_=e[2],n=e[3];return t[0]=n,t[1]=r,t[2]=a,t[3]=_,t}function v(e,t,r){if(!B)return void(X=!0);var a=r+">>"+e;a in j||(j[a]={storage:[],report_type:"undefined",type:e}),j[a].storage.push(t.name)}function m(e,t){if(!B)return void(X=!0);F.warn("WARNING Datablock "+e+' is missing, reexport "'+t+'" scene')}function O(e,t,r){if(!B)return void(X=!0);var a=r+">>"+e;a in j||(j[a]={storage:[],report_type:"deprecated",type:e}),j[a].storage.push(t.name)}function N(e,t,r){if(!B)return void(X=!0);F.error("WARNING Incomplete modifier "+String(e)+' for "'+t.name+'", reexport "'+r+'" scene')}function g(e){if(!B)return void(X=!0);F.warn(e)}function h(e){var t=e.scale;if(0==t[0]&&0==t[1]&&0==t[2])return!0;var r=Math.abs((t[0]-t[1])/t[0]),a=Math.abs((t[1]-t[2])/t[1]);return r<.005&&a<.005}function R(e){return e.scale[0]<0||e.scale[1]<0||e.scale[2]<0}function I(e){for(var t=e.modifiers,r=0;r<t.length;r++){var a=t[r],_=a.type;if("ARRAY"==_||"CURVE"==_)return!0}return!1}function b(e,t){for(var r=0,a=0,_=0,n=new Float32Array(16),o=[],i=1;i<t.count;i++){if(t.use_constant_offset&&(r+=t.constant_offset_displace[0],a+=t.constant_offset_displace[1],_+=t.constant_offset_displace[2]),t.use_relative_offset){var s=e.b4w_boundings.bb;r+=(s.max_x-s.min_x)*t.relative_offset_displace[0],a+=(s.max_y-s.min_y)*t.relative_offset_displace[1],_+=(s.max_z-s.min_z)*t.relative_offset_displace[2]}u._60(r,a,_,n);var c=M(e);U(c,n),o.push(c)}for(var i=0;i<o.length;i++)y(e,o[i])}function Y(e,t){for(var r=t.object,a=D.create_spline(r),_=new Float32Array(16),n=a.is_3d?4:3,o=new Float32Array(n),i=new Float32Array(n),s=new Float32Array(3),E=new Float32Array(4),u=new Float32Array(4),f=new Float32Array(3),P=new Float32Array(3),A=new Float32Array(3),S=0;S<e.submeshes.length;S++){var p=e.submeshes[S],v=p.position,m=p.tbn,O=L(t.deform_axis);f[0]=0,f[1]=0,f[2]=0,f[O]=1;for(var N=D.spline_length(a),g=0;g<v.length/3;g++){A[0]=v[3*g],A[1]=v[3*g+1],A[2]=v[3*g+2];var h=A[O],R=D.spline_len_to_t(a,h);if(D.spline_point(a,R,o),s[0]=o[0],s[1]=o[1],s[2]=o[2],D.spline_derivative(a,R,i),P[0]=i[0],P[1]=0,P[2]=i[2],d.normalize(P,P),l.rotationTo(f,P,E),h<0?(o[0]=P[0],o[1]=P[1],o[2]=P[2],d.scale(o,h,o),d.add(s,o,s)):h>N&&(o[0]=P[0],o[1]=P[1],o[2]=P[2],d.scale(o,h-N,o),d.add(s,o,s)),c.fromRotationTranslation(E,s,_),a.is_3d){var I=o[3];l.setAxisAngle(f,I,u),d.transformQuat(A,u,A)}A[O]=0,d.transformMat4(A,_,A),v[3*g]=A[0],v[3*g+1]=A[1],v[3*g+2]=A[2];var b=T.e(m,g,Q);T.j(b,E,b),T.n(m,b,g)}}}function L(e){switch(e){case"POS_X":case"NEG_X":return 0;case"POS_Y":case"NEG_Y":return 1;case"POS_Z":case"NEG_Z":return 2;default:w.panic("Wrong deform axis value "+e)}}function M(e,t){t||(t=e.name+"_COPY");var r=e.materials,a=e.submeshes;e.materials=null,e.submeshes=null;var _=u.O(e);e.materials=r,e.submeshes=a,_.name=t,_.materials=e.materials.slice(0),_.submeshes=[];for(var n=0;n<a.length;n++){var o=a[n],i=u.N(o);_.submeshes.push(i)}return _}function y(e,t){for(var r=0;r<e.submeshes.length;r++){var a=e.submeshes[r],_=t.submeshes[r],n=a.base_length,o=a.indices.length;if(n)for(var i in a)switch(i){case"base_length":a[i]+=_[i];break;case"boundings":break;case"indices":a[i]=u._67(a[i],_[i]);for(var s=o;s<a[i].length;s++)a[i][s]+=n;break;case"position":a[i]=x(a[i],_[i],a[i].length/n/3);break;case"tbn":a[i]=x(a[i],_[i],a[i].length/n/4);break;case"shade_tangs":a[i]=x(a[i],_[i],a[i].length/n/3);break;case"group":a[i]=x(a[i],_[i],a[i].length/n);break;case"texcoord":a[i]=x(a[i],_[i],a.uv_layers.length);break;case"color":a[i]=x(a[i],_[i],a.vertex_colors.length);break;case"uv_layers":case"vertex_colors":break;default:F.warn('array_mesh_join(): unknown submesh property "'+i+'"'),a[i]=u._2(a[i],_[i])}}return e}function x(e,t,r){if(r>1){for(var a=e.length/r,_=t.length/r,n=new Float32Array(e.length+t.length),o=0,i=0;i<r;i++)n.set(e.subarray(a*i,a*(i+1)),o),o+=a,n.set(t.subarray(_*i,_*(i+1)),o),o+=_;return n}return u._2(e,t)}function U(e,t){for(var r=f.fromMat4(t,H),a=l.fromMat3(r,z),_=0;_<e.submeshes.length;_++){var n=e.submeshes[_];u._28(n.position,t,n.position,0),T.j(n.tbn,a,n.tbn)}}var w=Object(n.a)(e),C=Object(i.a)(e),D=Object(s.a)(e),F=Object(E.a)(e),G=Object(P.a)(e),k=Object(A.a)(e),K=C.defaults,B=!0,X=!1,j={},H=f.create(),Q=T.c(),z=l.create();t.check_bpy_data=function(e){j={};var t=e.worlds;if(0==t.length){m("world",e.b4w_filepath_blend);var n={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,use_nodes:!1,node_tree:null,texture_slots:[]};t.push(n)}for(var o=0;o<t.length;o++){var n=t[o];"use_sky_blend"in n||(v("world",n,"use_sky_blend"),n.use_sky_blend=!1),"use_sky_paper"in n||(v("world",n,"use_sky_paper"),n.use_sky_paper=!1),"use_sky_real"in n||(v("world",n,"use_sky_real"),n.use_sky_real=!1),"b4w_sky_settings"in n&&"rayleigh_brightness"in n.b4w_sky_settings||(v("world",n,"rayleigh_brightness"),n.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4}),"fog_settings"in n||(v("world",n,"fog_settings"),n.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in n&&(n.fog_settings.use_custom_color=!0,n.fog_settings.color=n.b4w_fog_color),"b4w_fog_density"in n&&n.b4w_fog_density>0&&(n.fog_settings.depth=1/n.b4w_fog_density)),"render_sky"in n.b4w_sky_settings||(v("world",n,"render_sky"),n.b4w_sky_settings.render_sky=!1);for(var i=n.texture_slots,s=0;s<i.length;s++){var c=i[s];"blend_type"in c||(c.blend_type="MIX",v("world_texture_slot",c,"blend_type")),"use_map_blend"in c||(c.use_map_blend=!1,v("world_texture_slot",c,"use_map_blend")),"use_map_horizon"in c||(c.use_map_horizon=!0,v("world_texture_slot",c,"use_map_horizon")),"use_map_zenith_up"in c||(c.use_map_zenith_up=!1,v("world_texture_slot",c,"use_map_zenith_up")),"use_rgb_to_intensity"in c||(c.use_rgb_to_intensity=!1,v("world_texture_slot",c,"use_rgb_to_intensity")),"invert"in c||(c.invert=!1,v("world_texture_slot",c,"invert")),"color"in c||(c.color=[1,0,1],v("world_texture_slot",c,"color")),"blend_factor"in c||(c.blend_factor=0,v("world_texture_slot",c,"blend_factor")),"horizon_factor"in c||(c.horizon_factor=1,v("world_texture_slot",c,"horizon_factor")),"zenith_up_factor"in c||(c.zenith_up_factor=0,v("world_texture_slot",c,"zenith_up_factor")),"zenith_down_factor"in c||(c.zenith_down_factor=0,v("world_texture_slot",c,"zenith_down_factor")),"default_value"in c||(c.default_value=1,v("world_texture_slot",c,"default_value"))}"b4w_use_default_animation"in n||(v("world",n,"b4w_use_default_animation"),n.b4w_use_default_animation=!1),"b4w_anim_behavior"in n||(v("world",n,"b4w_anim_behavior"),n.b4w_anim_behavior="CYCLIC")}for(var E=e.scenes,o=0;o<E.length;o++){var l=E[o],T=l.world;if("timeline_markers"in l||(l.timeline_markers=null,v("scene",l,"timeline_markers")),"boolean"==typeof l.b4w_enable_physics&&(l.b4w_enable_physics="AUTO"),"b4w_reflection_quality"in l||(l.b4w_reflection_quality="MEDIUM",v("scene",l,"b4w_reflection_quality")),"b4w_use_nla"in l||(l.b4w_use_nla=!1,v("scene",l,"b4w_use_nla")),"fps"in l||(l.fps=24,v("scene",l,"fps")),"b4w_nla_cyclic"in l||(l.b4w_nla_cyclic=!1,v("scene",l,"b4w_nla_cyclic")),"b4w_logic_nodes"in l||(l.b4w_logic_nodes=[],v("scene",l,"b4w_logic_nodes")),"b4w_detect_collisions"in l&&(O("scene",l,"b4w_detect_collisions"),delete l.b4w_detect_collisions),"audio_doppler_speed"in l||(l.audio_doppler_speed=343.3),"audio_doppler_factor"in l||(l.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in l||(l.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},v("scene",l,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in l||(l.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in l||(l.b4w_enable_bloom=!1,v("scene",l,"b4w_enable_bloom")),"b4w_enable_motion_blur"in l||(l.b4w_enable_motion_blur=!1,v("scene",l,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in l||(l.b4w_enable_color_correction=!1,v("scene",l,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in l||(l.b4w_antialiasing_quality="MEDIUM",v("scene",l,"b4w_antialiasing_quality")),"b4w_tags"in l||(l.b4w_tags={title:"",description:""},v("scene",l,"b4w_tags")),"b4w_lod_smooth_type"in l||(l.b4w_lod_smooth_type="OFF",v("scene",l,"b4w_lod_smooth_type")),"b4w_lod_hyst_interval"in l||(l.b4w_lod_hyst_interval=0,v("scene",l,"b4w_lod_hyst_interval")),"b4w_enable_object_selection"in l||(l.b4w_enable_object_selection="AUTO",v("scene",l,"b4w_enable_object_selection")),"b4w_enable_outlining"in l||(l.b4w_enable_outlining="AUTO",v("scene",l,"b4w_enable_outlining")),"b4w_enable_glow_materials"in l||(l.b4w_enable_glow_materials="AUTO",v("scene",l,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in l||(l.b4w_enable_anchors_visibility="AUTO",v("scene",l,"b4w_enable_anchors_visibility")),"b4w_outline_color"in l||(l.b4w_outline_color=[1,1,1],v("scene",l,"b4w_outline_color")),"b4w_outline_factor"in l||(l.b4w_outline_factor="b4w_glow_factor"in l?l.b4w_glow_factor:1,v("scene",l,"b4w_outline_factor")),!("b4w_shadow_settings"in l)){v("scene",l,"b4w_shadow_settings");var d=T.b4w_shadow_settings;l.b4w_shadow_settings=d||{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}}var f=l.b4w_shadow_settings;if("csm_resolution"in f||(v("scene",l,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"blur_samples"in f||(v("scene",l,"b4w_shadow_settings.blur_samples"),f.blur_samples="16x"),"soft_shadows"in f||(v("scene",l,"b4w_shadow_settings.soft_shadows"),f.soft_shadows=!0),"self_shadow_polygon_offset"in f||(v("scene",l,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in f||(v("scene",l,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(v("scene",l,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(v("scene",l,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(v("scene",l,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(v("scene",l,"b4w_shadow_settings.first_cascade_blur_radius"),f.first_cascade_blur_radius=3),"csm_last_cascade_border"in f||(v("scene",l,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(v("scene",l,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(v("scene",l,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(v("scene",l,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),!("b4w_ssao_settings"in l)){v("scene",l,"b4w_ssao_settings");var P=T.b4w_ssao_settings;l.b4w_ssao_settings=P||{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}}var A=l.b4w_ssao_settings;if("dist_factor"in A||(v("scene",l,"b4w_ssao_settings.dist_factor"),A.dist_factor=0),"samples"in A||(v("scene",l,"b4w_ssao_settings.samples"),A.samples=16),"hemisphere"in A||(v("scene",l,"b4w_ssao_settings.hemisphere"),A.hemisphere=!1),"blur_depth"in A||(v("scene",l,"b4w_ssao_settings.blur_depth"),A.blur_depth=!1),"blur_discard_value"in A||(v("scene",l,"b4w_ssao_settings.blur_discard_value"),A.blur_discard_value=1),!("b4w_bloom_settings"in l)){v("scene",l,"b4w_bloom_settings");var I=T.b4w_bloom_settings;l.b4w_bloom_settings=I||{key:.2,blur:4,edge_lum:1}}if("key"in l.b4w_bloom_settings||(v("scene",l,"b4w_bloom_settings.key"),l.b4w_bloom_settings.key=.2),"blur"in l.b4w_bloom_settings||(v("scene",l,"b4w_bloom_settings.blur"),l.b4w_bloom_settings.blur=4),"edge_lum"in l.b4w_bloom_settings||(v("scene",l,"b4w_bloom_settings.edge_lum"),l.b4w_bloom_settings.edge_lum=1),"adaptive"in l.b4w_bloom_settings||(v("scene",l,"b4w_bloom_settings.adaptive"),l.b4w_bloom_settings.adaptive=!0),"average_luminance"in l.b4w_bloom_settings||(v("scene",l,"b4w_bloom_settings.average_luminance"),l.b4w_bloom_settings.average_luminance=.5),!("b4w_motion_blur_settings"in l)){v("scene",l,"b4w_motion_blur_settings");var b=T.b4w_motion_blur_settings;l.b4w_motion_blur_settings=b||{motion_blur_factor:.01,motion_blur_decay_threshold:.01}}if("motion_blur_factor"in l.b4w_motion_blur_settings||(v("scene",l,"b4w_motion_blur_settings.motion_blur_factor"),l.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in l.b4w_motion_blur_settings||(v("scene",l,"b4w_motion_blur_settings.motion_blur_decay_threshold"),l.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),!("b4w_color_correction_settings"in l)){v("scene",l,"b4w_color_correction_settings");var Y=T.b4w_color_correction_settings;l.b4w_color_correction_settings=Y||{brightness:0,contrast:0,exposure:1,saturation:1}}if(!("b4w_god_rays_settings"in l)){v("scene",l,"b4w_god_rays_settings");var L=T.b4w_god_rays_settings;l.b4w_god_rays_settings=L||{intensity:.7,max_ray_length:1,steps_per_pass:10}}if("steps_per_pass"in l.b4w_god_rays_settings||(v("scene",l,"b4w_god_rays_settings.steps_per_pass"),l.b4w_god_rays_settings.steps_per_pass=10),!("b4w_glow_settings"in l)){v("scene",l,"b4w_glow_settings"),l.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6};var M=l.b4w_glow_settings;"b4w_render_glow_over_blend"in T&&(M.render_glow_over_blend=T.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in T&&(M.small_glow_mask_coeff=T.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in T&&(M.large_glow_mask_coeff=T.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in T&&(M.small_glow_mask_width=T.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in T&&(M.large_glow_mask_width=T.b4w_large_glow_mask_width)}var y=l.b4w_render_shadows;"AUTO"!=y&&"OFF"!=y&&"ON"!=y&&(l.b4w_render_shadows=y?"ON":"OFF");var x=l.b4w_render_reflections;"OFF"!=x&&"ON"!=x&&(l.b4w_render_reflections=x?"ON":"OFF");var U=l.b4w_render_refractions;"AUTO"!=U&&"OFF"!=U&&"ON"!=U&&(l.b4w_render_refractions=U?"ON":"OFF"),"b4w_render_dynamic_grass"in l||(v("scene",l,"b4w_render_dynamic_grass"),l.b4w_render_dynamic_grass="AUTO"),l.b4w_nla_script&&O("scene",l,"b4w_nla_script"),"audio_distance_model"in l||(v("scene",l,"audio_distance_model"),l.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in l||(v("scene",l,"b4w_custom_prop"),l.b4w_custom_prop=null)}for(var w=e.meshes,o=0;o<w.length;o++){var C=w[o];if(!C.b4w_boundings){v("mesh",C,"b4w_boundings"),C.b4w_boundings={};var D=C.b4w_boundings;if(C.b4w_bounding_box?D.bb=C.b4w_bounding_box:D.bb={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},C.b4w_bounding_box_source?D.bb_src=C.b4w_bounding_box_source:D.bb_src=C.b4w_bounding_box,C.b4w_bounding_sphere_center?D.bs_cen=C.b4w_bounding_sphere_center:D.bs_cen=[0,0,0],C.b4w_bounding_cylinder_center?D.bc_cen=C.b4w_bounding_cylinder_center:D.bc_cen=[0,0,0],C.b4w_bounding_ellipsoid_center?D.be_cen=C.b4w_bounding_ellipsoid_center:D.be_cen=[0,0,0],C.b4w_bounding_ellipsoid_axes)D.be_ax=C.b4w_bounding_ellipsoid_axes;else{var G=D.bb;D.be_ax=[(G.max_x-G.min_x)/2,(G.max_y-G.min_y)/2,(G.max_z-G.min_z)/2]}if(C.b4w_rotated_bounding_box)D.rbb=C.b4w_rotated_bounding_box;else{var G=D.bb;D.rbb={rbb_c:[(G.max_x+G.min_x)/2,(G.max_y+G.min_y)/2,(G.max_z+G.min_z)/2],rbb_s:[1,1,1]}}C.b4w_cov_axis_x?D.caxis_x=C.b4w_cov_axis_x:D.caxis_x=[1,0,0],C.b4w_cov_axis_y?D.caxis_y=C.b4w_cov_axis_y:D.caxis_y=[0,1,0],C.b4w_cov_axis_z?D.caxis_z=C.b4w_cov_axis_z:D.caxis_z=[0,0,1]}"is_boundings_overridden"in C||(v("mesh",C,"is_boundings_overridden"),C.is_boundings_overridden=!1),"b4w_shape_keys"in C||(C.b4w_shape_keys=[],v("mesh",C,"b4w_shape_keys"));for(var k=!0,B=0;B<C.submeshes.length;B++){var H=C.submeshes[B];if("boundings"in H||(k=!1,H.boundings={be_ax:C.b4w_bounding_ellipsoid_axes,be_cen:C.b4w_bounding_ellipsoid_center,bb:{max_x:C.b4w_bounding_box.max_x,max_y:C.b4w_bounding_box.max_y,max_z:C.b4w_bounding_box.max_z,min_x:C.b4w_bounding_box.min_x,min_y:C.b4w_bounding_box.min_y,min_z:C.b4w_bounding_box.min_z}}),"uv_layers"in H||(v("submesh",C,"uv_layers"),H.uv_layers=C.uv_textures),"be_ax"in H.boundings||(H.boundings.be_ax=C.b4w_bounding_ellipsoid_axes),"be_cen"in H.boundings||(H.boundings.be_cen=C.b4w_bounding_ellipsoid_center),"bb"in H.boundings||(H.boundings.bb=C.b4w_bounding_box),!("rbb"in H.boundings)){var G=C.b4w_bounding_box;H.boundings.rbb={rbb_c:[(G.max_x+G.min_x)/2,(G.max_y+G.min_y)/2,(G.max_z+G.min_z)/2],rbb_s:[1,1,1]}}"caxis_x"in H.boundings||(H.boundings.caxis_x=[1,0,0]),"caxis_y"in H.boundings||(H.boundings.caxis_y=[0,1,0]),"caxis_z"in H.boundings||(H.boundings.caxis_z=[0,0,1])}k||v("mesh",C,"submesh_bd"),_(C);for(var s=0;s<C.b4w_vertex_anim.length;s++){var Q=C.b4w_vertex_anim[s];"allow_nla"in Q||(v('mesh["b4w_vertex_anim"]',C,"allow_nla"),Q.allow_nla=!0)}"active_uv_name"in C||(v("mesh",C,"active_uv_name"),C.active_uv_name="")}for(var z=e.cameras,o=0;o<z.length;o++){var q=z[o];q.type||(q.type="PERSP",v("camera",q,"type")),"b4w_eye_target_dist"in q&&(delete q.b4w_eye_target_dist,O("camera",q,"b4w_eye_target_dist")),"b4w_hover_zero_level"in q||(q.b4w_hover_zero_level=0,v("camera",q,"b4w_hover_zero_level")),"b4w_trans_velocity"in q||(q.b4w_trans_velocity=1,v("camera",q,"b4w_trans_velocity")),"b4w_rot_velocity"in q||(q.b4w_rot_velocity=1,v("camera",q,"b4w_rot_velocity")),"b4w_zoom_velocity"in q||(q.b4w_zoom_velocity=.1,v("camera",q,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in q||(q.b4w_use_target_distance_limits=q.b4w_use_distance_limits||!1,v("camera",q,"b4w_use_target_distance_limits")),"b4w_use_zooming"in q||(q.b4w_use_zooming=q.b4w_use_distance_limits||!1,v("camera",q,"b4w_use_zooming")),"b4w_distance_min"in q||(q.b4w_distance_min=1,v("camera",q,"b4w_distance_min")),"b4w_distance_max"in q||(q.b4w_distance_max=100,v("camera",q,"b4w_distance_max")),"b4w_horizontal_translation_min"in q||(q.b4w_horizontal_translation_min=-100,v("camera",q,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in q||(q.b4w_horizontal_translation_max=100,v("camera",q,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in q||(q.b4w_vertical_translation_min=-100,v("camera",q,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in q||(q.b4w_vertical_translation_max=100,v("camera",q,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in q||(q.b4w_use_horizontal_clamping=!1,v("camera",q,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in q||(q.b4w_rotation_left_limit=-Math.PI,v("camera",q,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in q||(q.b4w_rotation_right_limit=Math.PI,v("camera",q,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in q||(q.b4w_horizontal_clamping_type="LOCAL",v("camera",q,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in q||(q.b4w_use_vertical_clamping=!1,v("camera",q,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in q||(q.b4w_rotation_down_limit=-Math.PI/2,v("camera",q,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in q||(q.b4w_rotation_up_limit=Math.PI/2,v("camera",q,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in q||(q.b4w_vertical_clamping_type="LOCAL",v("camera",q,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in q||(q.b4w_hover_angle_min=Math.PI/6,v("camera",q,"b4w_hover_angle_min")),"b4w_hover_angle_max"in q||(q.b4w_hover_angle_max=Math.PI/6,v("camera",q,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in q||(q.b4w_enable_hover_hor_rotation=!0,v("camera",q,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in q||(q.b4w_use_panning=!0,v("camera",q,"b4w_use_panning")),"b4w_use_pivot_limits"in q||(q.b4w_use_pivot_limits=!1,q.b4w_pivot_z_min=0,q.b4w_pivot_z_max=10,v("camera",q,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in q||(q.b4w_dof_bokeh=!1,v("camera",q,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in q||(q.b4w_dof_bokeh_intensity=.3,v("camera",q,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in q||(q.b4w_dof_foreground_blur=!1,v("camera",q,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in q||(q.b4w_dof_front_start=0,v("camera",q,"b4w_dof_front_start")),"b4w_dof_front_end"in q||(q.b4w_dof_front_end=q.b4w_dof_front,v("camera",q,"b4w_dof_front_end")),"b4w_dof_rear_start"in q||(q.b4w_dof_rear_start=0,v("camera",q,"b4w_dof_rear_start")),"b4w_dof_rear_end"in q||(q.b4w_dof_rear_end=q.b4w_dof_rear,v("camera",q,"b4w_dof_rear_end")),"sensor_fit"in q||(q.sensor_fit="VERTICAL",v("camera",q,"sensor_fit"))}for(var V=e.lamps,o=0;o<V.length;o++){var W=V[o];"b4w_generate_shadows"in W||(W.b4w_generate_shadows=!1,v("lamp",W,"b4w_generate_shadows")),"b4w_dynamic_intensity"in W||(W.b4w_dynamic_intensity=!1,v("lamp",W,"b4w_dynamic_intensity")),"use_diffuse"in W||(W.use_diffuse=!0,v("lamp",W,"use_diffuse")),"use_specular"in W||(W.use_specular=!0,v("lamp",W,"use_specular")),"clip_start"in W||(W.clip_start=.1,v("lamp",W,"clip_start")),"clip_end"in W||(W.clip_end=30,v("lamp",W,"clip_end")),"POINT"!=W.type&&"SPOT"!=W.type||("use_sphere"in W||(W.use_sphere=!1,v("lamp",W,"use_sphere")),K.mali4_lamps_hack&&(W.type="SUN"))}for(var J=e.speakers,o=0;o<J.length;o++){var Z=J[o];"b4w_behavior"in Z||(Z.b4w_background_music?Z.b4w_behavior="BACKGROUND_SOUND":Z.b4w_behavior="POSITIONAL"),"b4w_auto_play"in Z||(Z.b4w_auto_play=!1,v("speaker",Z,"b4w_auto_play")),"b4w_enable_doppler"in Z||(Z.b4w_enable_doppler=!1,v("speaker",Z,"b4w_enable_doppler")),"b4w_delay"in Z||(Z.b4w_delay=0),"b4w_delay_random"in Z||(Z.b4w_delay_random=0),"b4w_volume_random"in Z||(Z.b4w_volume_random=0),"b4w_pitch_random"in Z||(Z.b4w_pitch_random=0),"b4w_fade_in"in Z||(Z.b4w_fade_in=0),"b4w_fade_out"in Z||(Z.b4w_fade_out=0),"b4w_loop"in Z||(Z.b4w_loop=!1),"b4w_loop_start"in Z||(Z.b4w_loop_start=0,v("speaker",Z,"b4w_loop_start")),"b4w_loop_end"in Z||(Z.b4w_loop_end=0,v("speaker",Z,"b4w_loop_end")),Z.animation_data&&a(Z.animation_data)}for(var $=e.textures,o=0;o<$.length;o++){var ee=$[o];"b4w_anisotropic_filtering"in ee||(ee.b4w_anisotropic_filtering="OFF",v("texture",ee,"b4w_anisotropic_filtering")),"b4w_water_foam"in ee||(ee.b4w_water_foam=!1,v("texture",ee,"b4w_water_foam")),"b4w_foam_uv_freq"in ee||(ee.b4w_foam_uv_freq=[1,1],v("texture",ee,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in ee||(ee.b4w_foam_uv_magnitude=[1,1],v("texture",ee,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in ee||(ee.b4w_parallax_steps=5,v("material",ee,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in ee||(ee.b4w_parallax_lod_dist=10,v("material",ee,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in ee||(ee.b4w_shore_dist_map=!1,v("texture",ee,"b4w_shore_dist_map")),"b4w_shore_boundings"in ee||(ee.b4w_shore_boundings=[1e3,-1e3,1e3,-1e3],v("texture",ee,"b4w_shore_boundings")),"b4w_max_shore_dist"in ee||(ee.b4w_max_shore_dist=100,v("texture",ee,"b4w_max_shore_dist")),"b4w_disable_compression"in ee||(ee.b4w_disable_compression=!1,v("texture",ee,"b4w_disable_compression")),"b4w_source_type"in ee||(ee.b4w_source_type="",v("texture",ee,"b4w_source_type")),"b4w_source_id"in ee||(ee.b4w_source_id="",v("texture",ee,"b4w_source_id")),"b4w_source_size"in ee||(ee.b4w_source_size=1024,v("texture",ee,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in ee||(ee.b4w_enable_canvas_mipmapping=!0,v("texture",ee,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in ee||(ee.b4w_nla_video=!1,v("texture",ee,"b4w_nla_video"))}for(var te=e.images,o=0;o<te.length;o++){var re=te[o];"colorspace_settings_name"in re||(re.colorspace_settings_name="sRGB",v("image",re,"colorspace_settings_name"))}for(var ae=e.materials,o=0;o<ae.length;o++){var _e=ae[o];"ALPHA_ANTIALIASING"==_e.game_settings.alpha_blend&&(K.mali_alpha_antialias_hack?_e.game_settings.alpha_blend="CLIP":K.msaa_samples<2&&(F.warn('Material "'+_e.name+'" has the "Alpha Anti-Aliasing" transparency type, but multisampling is disabled. Changed to "Alpha Clip".'),_e.game_settings.alpha_blend="CLIP")),"use_tangent_shading"in _e||(_e.use_tangent_shading=!1,v("material",_e,"use_tangent_shading")),"b4w_node_mat_type"in _e&&O("material",_e,"b4w_node_mat_type"),"b4w_skydome"in _e&&O("material",_e,"b4w_skydome"),"b4w_procedural_skydome"in _e&&O("material",_e,"b4w_procedural_skydome"),"b4w_lens_flares"in _e||(_e.b4w_lens_flares=!1,v("material",_e,"b4w_lens_flares")),"LENS_FLARES"===_e.name&&(_e.b4w_lens_flares||F.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),_e.b4w_lens_flares=!0),_e.b4w_water&&("b4w_water_shore_smoothing"in _e||(_e.b4w_water_shore_smoothing=!1,v("material",_e,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in _e||(_e.b4w_water_dynamic=!1,v("material",_e,"b4w_water_dynamic")),"b4w_waves_height"in _e||(_e.b4w_waves_height=1,v("material",_e,"b4w_waves_height")),"b4w_waves_length"in _e||(_e.b4w_waves_length=1,v("material",_e,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in _e||(_e.b4w_water_dst_noise_scale0=.05,v("material",_e,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in _e||(_e.b4w_water_dst_noise_scale1=.03,v("material",_e,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in _e||(_e.b4w_water_dst_noise_freq0=1.3,v("material",_e,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in _e||(_e.b4w_water_dst_noise_freq1=1,v("material",_e,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in _e||(_e.b4w_water_dir_min_shore_fac=.4,v("material",_e,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in _e||(_e.b4w_water_dir_freq=.5,v("material",_e,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in _e||(_e.b4w_water_dir_noise_scale=.05,v("material",_e,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in _e||(_e.b4w_water_dir_noise_freq=.07,v("material",_e,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in _e||(_e.b4w_water_dir_min_noise_fac=.5,v("material",_e,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in _e||(_e.b4w_water_dst_min_fac=.2,v("material",_e,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in _e||(_e.b4w_water_waves_hor_fac=5,v("material",_e,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in _e||(_e.b4w_water_absorb_factor=6,v("material",_e,"b4w_water_absorb_factor")),"b4w_water_fog_color"in _e||(_e.b4w_water_fog_color=[.5,.7,.7],v("material",_e,"b4w_water_fog_color")),"b4w_foam_factor"in _e||(_e.b4w_foam_factor=5,v("material",_e,"b4w_foam_factor")),"b4w_generated_mesh"in _e||(_e.b4w_generated_mesh=!1,v("material",_e,"b4w_generated_mesh")),"b4w_water_num_cascads"in _e||(_e.b4w_water_num_cascads=5,v("material",_e,"b4w_water_num_cascads")),"b4w_water_subdivs"in _e||(_e.b4w_water_subdivs=64,v("material",_e,"b4w_water_subdivs")),"b4w_water_detailed_dist"in _e||(_e.b4w_water_detailed_dist=1e3,v("material",_e,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in _e||(_e.b4w_water_enable_caust=!1,v("material",_e,"b4w_water_enable_caust")),"b4w_water_caust_scale"in _e||(_e.b4w_water_caust_scale=.25,v("material",_e,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in _e||(_e.b4w_water_caust_brightness=.5,v("material",_e,"b4w_water_caust_brightness"))),"b4w_dynamic_grass_size"in _e||(_e.b4w_dynamic_grass_size=""),"b4w_dynamic_grass_color"in _e||(_e.b4w_dynamic_grass_color=""),"diffuse_intensity"in _e||(_e.diffuse_intensity=1,v("material",_e,"diffuse_intensity")),"b4w_use_ghost"in _e||(_e.b4w_use_ghost=!1),"b4w_collision_margin"in _e||(_e.b4w_collision_margin=.04,v("material",_e,"b4w_collision_margin")),"b4w_collision_group"in _e||(_e.b4w_collision_group=128,v("material",_e,"b4w_collision_group")),"b4w_collision_mask"in _e||(_e.b4w_collision_mask=127,v("material",_e,"b4w_collision_mask")),"b4w_do_not_render"in _e||(_e.b4w_do_not_render=!1,v("material",_e,"b4w_do_not_render")),"HALO"!=_e.type||"b4w_halo_sky_stars"in _e||(_e.b4w_halo_sky_stars=!1,v("material",_e,"b4w_halo_sky_stars")),"HALO"!=_e.type||"b4w_halo_stars_blend_height"in _e||(_e.b4w_halo_stars_blend_height=10,v("material",_e,"b4w_halo_stars_blend_height")),"HALO"!=_e.type||"b4w_halo_stars_min_height"in _e||(_e.b4w_halo_stars_min_height=0,v("material",_e,"b4w_halo_stars_min_height")),"specular_shader"in _e||(_e.specular_shader="COOKTORR",v("material",_e,"specular_shader")),"diffuse_shader"in _e||(_e.diffuse_shader="LAMBERT",v("material",_e,"diffuse_shader")),"roughness"in _e||(_e.roughness=.5,v("material",_e,"roughness")),"diffuse_fresnel"in _e||(_e.diffuse_fresnel=.1,v("material",_e,"diffuse_fresnel")),"diffuse_fresnel_factor"in _e||(_e.diffuse_fresnel_factor=.5,v("material",_e,"diffuse_fresnel_factor")),"specular_slope"in _e||(_e.specular_slope=.2,v("material",_e,"specular_slope")),"specular_toon_size"in _e||(_e.specular_toon_size=.5,v("material",_e,"specular_toon_size")),"specular_toon_smooth"in _e||(_e.specular_toon_smooth=.1,v("material",_e,"specular_toon_smooth")),"specular_alpha"in _e||(_e.specular_alpha=1,v("material",_e,"specular_alpha")),"b4w_wettable"in _e||(_e.b4w_wettable=!1,v("material",_e,"b4w_wettable")),"b4w_refractive"in _e||(_e.b4w_refractive=!1,v("material",_e,"b4w_refractive")),"b4w_refr_bump"in _e||(_e.b4w_refr_bump=0,v("material",_e,"b4w_refr_bump")),"b4w_shallow_water_col"in _e||(_e.b4w_shallow_water_col=[0,.8,.3],v("material",_e,"b4w_shallow_water_col")),"b4w_shore_water_col"in _e||(_e.b4w_shore_water_col=[0,.9,.2],v("material",_e,"b4w_shore_water_col")),"b4w_shallow_water_col_fac"in _e||(_e.b4w_shallow_water_col_fac=1,v("material",_e,"b4w_shallow_water_col_fac")),"b4w_shore_water_col_fac"in _e||(_e.b4w_shore_water_col_fac=.5,v("material",_e,"b4w_shore_water_col_fac")),"b4w_water_sss_strength"in _e||(_e.b4w_water_sss_strength=5.9,v("material",_e,"b4w_water_sss_strength")),"b4w_water_sss_width"in _e||(_e.b4w_water_sss_width=.45,v("material",_e,"b4w_water_sss_width")),"b4w_render_above_all"in _e||(_e.b4w_render_above_all=!1,v("material",_e,"b4w_render_above_all")),"b4w_water_norm_uv_velocity"in _e||(_e.b4w_water_norm_uv_velocity=.05,v("material",_e,"b4w_water_norm_uv_velocity")),"specular_ior"in _e||(_e.specular_ior=1,v("material",_e,"specular_ior")),"darkness"in _e||(_e.darkness=0,v("material",_e,"darkness")),"diffuse_toon_size"in _e||(_e.diffuse_toon_size=0,v("material",_e,"diffuse_toon_size")),"diffuse_toon_smooth"in _e||(_e.diffuse_toon_smooth=0,v("material",_e,"diffuse_toon_smooth")),"pass_index"in _e||(_e.pass_index=0,v("material",_e,"pass_index"));for(var i=_e.texture_slots,s=0;s<i.length;s++){var c=i[s];"blend_type"in c||(c.blend_type="MIX",v("texture_slot",c,"blend_type"))}if(_e.node_tree){for(var ne=_e.node_tree.nodes,s=0;s<ne.length;s++)r(ne[s]);_e.node_tree.animation_data&&a(_e.node_tree.animation_data)}}for(var oe=e.node_groups,o=0;o<oe.length;o++)for(var ne=oe[o].node_tree.nodes,s=0;s<ne.length;s++)r(ne[s]);for(var ie=e.objects,o=0;o<ie.length;o++){var se=ie[o];switch(se.type){case"MESH":"b4w_dynamic_geometry"in se||(se.b4w_dynamic_geometry=!1),"b4w_reflexible"in se||(se.b4w_reflexible=!1),"b4w_reflexible_only"in se||(se.b4w_reflexible_only=!1),"b4w_reflective"in se||(se.b4w_reflective=!1),"b4w_reflection_type"in se||(se.b4w_reflection_type="PLANE",v("object",se,"b4w_reflection_type")),"b4w_wind_bending"in se||(se.b4w_wind_bending=!1,v("object",se,"b4w_wind_bending")),"b4w_wind_bending_angle"in se||(se.b4w_wind_bending_angle=10,se.b4w_wind_bending_freq=.25,v("object",se,"wind bending params")),"b4w_detail_bending_amp"in se||(se.b4w_detail_bending_amp=.1,se.b4w_branch_bending_amp=.3,v("object",se,"detail bending params")),"b4w_detail_bending_freq"in se||(se.b4w_detail_bending_freq=1,v("object",se,"b4w_detail_bending_freq")),"b4w_main_bend_stiffness_col"in se||(se.b4w_main_bend_stiffness_col="",v("object",se,"b4w_main_bend_stiffness_col")),"b4w_detail_bend_colors"in se||(se.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},v("object",se,"b4w_detail_bend_colors")),"b4w_caustics"in se||(se.b4w_caustics=!1),"vertex_groups"in se&&se.vertex_groups.length&&se.data&&0==se.data.vertex_groups.length&&(se.data.vertex_groups=se.vertex_groups,delete se.vertex_groups,v("object",se,"vertex_groups")),"b4w_vertex_anim"in se&&se.b4w_vertex_anim.length&&se.data&&0==se.data.b4w_vertex_anim.length&&(se.data.b4w_vertex_anim=se.b4w_vertex_anim,delete se.b4w_vertex_anim,v("object",se,"b4w_vertex_anim")),"b4w_do_not_render"in se||(se.b4w_do_not_render=!1),"b4w_hidden_on_load"in se||(se.b4w_hidden_on_load=!1),"b4w_hide_chldr_on_load"in se||(se.b4w_hide_chldr_on_load=!1),"use_ghost"in se.game||(se.game.use_ghost=!1),"use_sleep"in se.game||(se.game.use_sleep=!1),"velocity_min"in se.game||(se.game.velocity_min=0),"velocity_max"in se.game||(se.game.velocity_max=0),"collision_group"in se.game||(se.game.collision_group=1),"collision_mask"in se.game||(se.game.collision_mask=255),S(se),"b4w_vehicle_settings"in se?se.b4w_vehicle_settings&&("steering_ratio"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.steering_ratio=10),"steering_max"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.steering_max=1),"inverse_control"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.inverse_control=!1),"force_max"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.force_max=1500),"brake_max"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.brake_max=100),"speed_ratio"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.wheel_friction=1e3),"roll_influence"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.floating_factor=3),"floating_factor"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.water_rot_damp=.9)):(se.b4w_vehicle_settings=null,v("object",se,"b4w_vehicle_settings")),"b4w_floating_settings"in se?se.b4w_floating_settings&&("floating_factor"in se.b4w_floating_settings||(se.b4w_floating_settings.floating_factor=3),"water_lin_damp"in se.b4w_floating_settings||(se.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in se.b4w_floating_settings||(se.b4w_floating_settings.water_rot_damp=.8)):(se.b4w_floating_settings=null,v("object",se,"b4w_floating_settings")),"b4w_character_settings"in se?se.b4w_character_settings&&("walk_speed"in se.b4w_character_settings||(se.b4w_character_settings.walk_speed=4),"run_speed"in se.b4w_character_settings||(se.b4w_character_settings.run_speed=8),"step_height"in se.b4w_character_settings||(se.b4w_character_settings.step_height=.25),"jump_strength"in se.b4w_character_settings||(se.b4w_character_settings.jump_strength=5),"waterline"in se.b4w_character_settings||(se.b4w_character_settings.waterline=0)):(se.b4w_character_settings=null,v("object",se,"b4w_character_settings")),"b4w_selectable"in se||(se.b4w_selectable=!1,v("object",se,"b4w_selectable")),"b4w_outlining"in se||(se.b4w_outlining=!1,v("object",se,"b4w_outlining")),"b4w_outline_on_select"in se||(se.b4w_outline_on_select=!1,v("object",se,"b4w_outline_on_select")),"b4w_billboard"in se||(se.b4w_billboard=!1,v("object",se,"b4w_billboard")),"b4w_billboard_geometry"in se||(se.b4w_billboard_geometry="SPHERICAL",v("object",se,"b4w_billboard_geometry")),"b4w_pres_glob_orientation"in se||(se.b4w_pres_glob_orientation=!1,v("object",se,"b4w_pres_glob_orientation")),"b4w_outline_settings"in se||("b4w_glow_settings"in se?se.b4w_outline_settings=se.b4w_glow_settings:(se.b4w_outline_settings={},se.b4w_outline_settings.outline_duration=1,se.b4w_outline_settings.outline_period=1,se.b4w_outline_settings.outline_relapses=0),v("object",se,"b4w_outline_settings")),"lod_levels"in se||(se.lod_levels=[],v("object",se,"lod_levels")),"b4w_animation_mixing"in se||(se.b4w_animation_mixing=!1,v("object",se,"b4w_animation_mixing"));break;case"EMPTY":"b4w_anchor"in se||(se.b4w_anchor=null,v("object",se,"b4w_anchor")),!se.b4w_anchor||"max_width"in se.b4w_anchor||(se.b4w_anchor.max_width=250)}if("collision_margin"in se.game||(se.game.collision_margin=.04,v("object",se,"collision_margin")),"b4w_anim_behavior"in se||(se.b4w_anim_behavior=se.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",v("object",se,"b4w_anim_behavior")),!("rotation_quaternion"in se)){var ce=[0,0,0,1];u.Y(se.rotation_euler,ce),p(ce,ce),se.rotation_quaternion=ce,v("object",se,"rotation_quaternion")}"webgl_do_not_batch"in se&&(se.b4w_do_not_batch=se.webgl_do_not_batch,se.webgl_do_not_batch&&O("object",se,"webgl_do_not_batch")),"b4w_shadow_cast_only"in se||(se.b4w_shadow_cast_only=!1,v("object",se,"b4w_shadow_cast_only")),"b4w_correct_bounding_offset"in se||(se.b4w_correct_bounding_offset="AUTO",v("object",se,"b4w_correct_bounding_offset"));for(var Ee=se.particle_systems,s=0;s<Ee.length;s++){var le=Ee[s],Te=le.settings;"use_rotation_dupli"in Te||(Te.use_rotation_dupli=!1,v("particle_settings",Te,"use_rotation_dupli")),"use_whole_group"in Te||(Te.use_whole_group=!1,v("particle_settings",Te,"use_whole_group")),le.transforms||(le.transforms=new Float32Array,v("particle_system",le,"transforms")),"b4w_billboard_align"in Te||(Te.b4w_billboard_align="VIEW",v("particle_settings",Te,"b4w_billboard_align")),"b4w_dynamic_grass"in Te||(Te.b4w_dynamic_grass=!1,v("object",Te,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in Te||(Te.b4w_dynamic_grass_scale_threshold=.01,v("object",Te,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in Te||(Te.b4w_initial_rand_rotation=!1,v("particle_settings",Te,"b4w_initial_rand_rotation")),"b4w_rotation_type"in Te||(Te.b4w_rotation_type="Z",v("particle_settings",Te,"b4w_rotation_type")),"b4w_rand_rotation_strength"in Te||(Te.b4w_rand_rotation_strength=1,v("particle_settings",Te,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in Te||(Te.b4w_hair_billboard=!1,v("particle_settings",Te,"b4w_hair_billboard")),"b4w_hair_billboard_type"in Te||(Te.b4w_hair_billboard_type="BASIC",v("particle_settings",Te,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in Te||(Te.b4w_hair_billboard_jitter_amp=0,v("particle_settings",Te,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in Te||(Te.b4w_hair_billboard_jitter_freq=0,v("particle_settings",Te,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in Te||(Te.b4w_hair_billboard_geometry="SPHERICAL",v("particle_settings",Te,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in Te||(Te.b4w_wind_bend_inheritance="PARENT",v("particle_settings",Te,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in Te||(Te.b4w_shadow_inheritance="PARENT",v("particle_settings",Te,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in Te||(Te.b4w_reflection_inheritance="PARENT",v("particle_settings",Te,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in Te||(Te.b4w_vcol_from_name="",v("particle_settings",Te,"b4w_vcol_from_name")),"b4w_vcol_to_name"in Te||(Te.b4w_vcol_to_name="",v("particle_settings",Te,"b4w_vcol_to_name")),"b4w_coordinate_system"in Te||(Te.b4w_coordinate_system="LOCAL",v("particle_settings",Te,"b4w_coordinate_system")),"b4w_allow_nla"in Te||(Te.b4w_allow_nla=!0,v("particle_settings",Te,"b4w_allow_nla")),"b4w_enable_soft_particles"in Te||(Te.b4w_enable_soft_particles=!1,v("particle_settings",Te,"b4w_enable_soft_particles")),"b4w_particles_softness"in Te||(Te.b4w_particles_softness=1,v("particle_settings",Te,"b4w_particles_softness")),"billboard_tilt"in Te||(Te.billboard_tilt=0,v("particle_settings",Te,"billboard_tilt")),"billboard_tilt_random"in Te||(Te.billboard_tilt_random=0,v("particle_settings",Te,"billboard_tilt_random")),"use_rotations"in Te||(Te.use_rotations=!1,v("particle_settings",Te,"use_rotations"))}"constraints"in se||(se.constraints=[],v("object",se,"constraints"));for(var ue=se.constraints,s=0;s<ue.length;s++){var de=ue[s];"influence"in de||(de.influence=1),"axes"in de||(de.axes=[1,1,1])}for(var fe=se.modifiers,s=0;s<fe.length;s++)(function(t,r){switch(t.type){case"ARRAY":if(!("fit_type"in t))return N(t.type,r,e.b4w_filepath_blend),!1}return!0})(fe[s],se)||(fe.splice(s,1),s--);if("animation_data"in se||(se.animation_data={action:null,nla_tracks:[]},v("object",se,"animation_data")),se.animation_data){if("action"in se.animation_data){if(se.animation_data.action){var Pe=se.animation_data.action.fcurves;for(var Ae in Pe){var Se=Pe[Ae];for(var pe in Se){var ve=Se[pe];"num_channels"in ve||(ve.num_channels=1,g('B4W Warning: no channels number in animation fcurve for "'+se.animation_data.action.name+'" action, reexport scene'))}}}}else se.animation_data.action=null,g("no action in animation data "+se.name);"nla_tracks"in se.animation_data||(se.animation_data.nla_tracks=[],g("no NLA in animation data "+se.name)),a(se.animation_data)}"b4w_collision_id"in se||(se.b4w_collision_id="",v("object",se,"b4w_collision_id")),"b4w_viewport_alignment"in se||(se.b4w_viewport_alignment=null,v("object",se,"b4w_viewport_alignment")),"pinverse_tsr"in se||(se.pinverse_tsr=null,v("object",se,"pinverse_tsr")),"b4w_cluster_data"in se||(se.b4w_cluster_data={cluster_id:-1,cluster_center:null},v("object",se,"b4w_cluster_data")),"pass_index"in se||(se.pass_index=0,v("object",se,"pass_index")),"b4w_custom_prop"in se||(v("object",se,"b4w_custom_prop"),se.b4w_custom_prop=null),R(se)&&g('negative scale for object "'+se.name+'", can lead to some errors'),h(se)||g("non-uniform scale for object "+se.name)}X&&F.error("Compatibility issues detected");for(var me in j){var Oe=j[me],Ne=me.match(/.*?(?=>>|$)/i)[0];F.warn('Property "'+String(Ne)+'" is '+Oe.report_type+' for "'+Oe.type+'". To fix this, reexport '+e.b4w_filepath_blend)}},t.apply_mesh_modifiers=function(e){if(!I(e))return null;for(var t=M(e.data,e.data.name+"_MOD"),r=e.modifiers,a=0;a<r.length;a++){var _=r[a];switch(_.type){case"ARRAY":b(t,_);break;case"CURVE":Y(t,_)}o.N(t)}return t},t.assign_logic_nodes_object_params=function(e,t,r){function a(t,r){var a=t[0];if(t.length>1)for(var _=1;_<t.length;_++)a+="*"+t[_];for(var _=0;_<e.length;_++){var n=e[_];if(n.name==a)for(var o in r)n[o]=r[o]}}function _(e,t){for(var r in e)a(e[r],t)}for(var n=r.b4w_logic_nodes,o=0;o<n.length;o++)for(var i=n[o],s=0;s<i.length;s++){var c=i[s],E={register1:"variable1",register2:"variable2",registerd:"variabled"};for(var l in E)l in c&&(c[E[l]]=c[l]);for(var T in c.variables)"boolean"!=typeof c.variables[T][0]&&(c.variables[T]=[!1,c.variables[T]]);["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(c.type)>=0&&("variable1"in c&&(c.variables.id0=[!1,c.variable1]),"variable2"in c&&(c.variables.id1=[!1,c.variable2]),"variabled"in c&&(c.variables.vd=[!1,c.variabled]));for(var u in c.links)u.startsWith("id")||delete c.links[u];var d=c.common_usage_names,f=c.variables;switch(c.type){case"SELECT":for(var P=0;P<e.length;P++){var A=e[P];A.name==c.object&&(A.b4w_selectable=!0)}c.bools||(c.bools={}),c.bools.not_wait||(c.bools.not_wait=!1),g('Logic nodes type "SELECT" is deprecated');break;case"SWITCH_SELECT":if(_(c.objects_paths,{b4w_selectable:!0}),c.links instanceof Array){g('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+r.name+'"');var S={},p=0;for(P in c.objects_paths)S[P]=c.links[p],p++;c.links=S}break;case"SELECT_PLAY":g('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+r.name+'"'),c.mute=!0;break;case"SELECT_PLAY_ANIM":g('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case"SHOW":case"HIDE":c.bools||(c.bools={}),void 0===c.bools.ch&&(c.bools.ch=!1),c.bools.id0||_(c.objects_paths,{b4w_do_not_batch:!0});break;case"SET_SHADER_NODE_PARAM":case"INHERIT_MAT":_(c.objects_paths,{b4w_do_not_batch:!0});break;case"PLAY":r.b4w_use_nla=!0;break;case"MOVE_TO":_(c.objects_paths,{b4w_do_not_batch:!0});break;case"TRANSFORM_OBJECT":switch(_(c.objects_paths,{b4w_do_not_batch:!0}),d.space_type){case"WORLD":d.space_type=G.NST_WORLD;break;case"PARENT":d.space_type=G.NST_PARENT;break;case"LOCAL":d.space_type=G.NST_LOCAL}break;case"OUTLINE":_(c.objects_paths,{b4w_outlining:!0});break;case"CONDJUMP":if(c.condition&&(d.condition=c.condition),"cnd"in c.floats)d.condition=c.floats.cnd;else switch(d.condition){case"GEQUAL":d.condition=G.NC_GEQUAL;break;case"LEQUAL":d.condition=G.NC_LEQUAL;break;case"GREATER":d.condition=G.NC_GREATER;break;case"LESS":d.condition=G.NC_LESS;break;case"NOTEQUAL":d.condition=G.NC_NOTEQUAL;break;case"EQUAL":d.condition=G.NC_EQUAL}switch(void 0!=c.number1&&(c.input1=c.number1),void 0!=c.number2&&(c.input2=c.number2),c.bools||(c.bools={}),c.bools.str&&(d.variable_type="STRING"),d.variable_type){case"NUMBER":d.variable_type=G.NT_NUMBER;break;case"STRING":d.variable_type=G.NT_STRING;break;case"OBJECT":d.variable_type=G.NT_OBJECT}void 0===d.variable_type&&(d.variable_type=G.NT_NUMBER,c.floats.inp1=c.input1,c.floats.inp2=c.input2),void 0===f.id0&&(f.id0=f.v1,f.id1=f.v2);break;case"SEND_REQ":c.bools||(c.bools={}),c.strings||(c.strings={}),void 0===c.bools.ct&&(c.bools.ct=!1),void 0!=c.url&&(c.bools.url=!1,c.strings.url=c.url);break;case"MATH":switch(void 0!=c.number1&&(c.input1=c.number1),void 0!=c.number2&&(c.input2=c.number2),void 0!=c.input1&&(c.floats.inp1=c.input1),void 0!=c.input2&&(c.floats.inp2=c.input2),c.operation){case"DIV":c.operation=G.NMO_DIV;break;case"SUB":c.operation=G.NMO_SUB;break;case"MUL":c.operation=G.NMO_MUL;break;case"ADD":c.operation=G.NMO_ADD;break;case"RAND":c.operation=G.NMO_RAND;break;case"SIN":c.operation=G.NMO_SIN;break;case"COS":c.operation=G.NMO_COS;break;case"TAN":c.operation=G.NMO_TAN;break;case"ARCSIN":c.operation=G.NMO_ARCSIN;break;case"ARCCOS":c.operation=G.NMO_ARCCOS;break;case"ARCTAN":c.operation=G.NMO_ARCTAN;break;case"LOG":c.operation=G.NMO_LOG;break;case"MIN":c.operation=G.NMO_MIN;break;case"MAX":c.operation=G.NMO_MAX;break;case"ROUND":c.operation=G.NMO_ROUND;break;case"MOD":c.operation=G.NMO_MOD;break;case"ABS":c.operation=G.NMO_ABS}void 0===f.id0&&(f.id0=f.v1,f.id1=f.v2);break;case"REGSTORE":if(c.floats||(c.floats={}),c.strings||(c.strings={}),void 0!=c.number1&&(c.input1=c.number1),void 0!=c.input1)switch(typeof c.input1){case"number":c.floats.inp1=c.input1,d.variable_type="NUMBER";break;default:c.strings.inp1=c.input1,d.variable_type="STRING"}switch(d.variable_type){case"NUMBER":d.variable_type=G.NT_NUMBER;break;case"STRING":d.variable_type=G.NT_STRING;break;case"OBJECT":d.variable_type=G.NT_OBJECT,_(c.objects_paths,{b4w_do_not_batch:!0})}break;case"PAGEPARAM":c.bools||(c.bools={}),void 0===c.bools.hsh&&(c.bools.hsh=!1),c.floats||(c.floats={}),void 0===c.floats.ptp&&(c.floats.ptp=0);break;case"STOP_ANIM":case"PLAY_ANIM":if(c.bools||(c.bools={}),void 0===c.bools.env&&(c.bools.env=!1),void 0===c.bools.id0&&(c.bools.id0=!1),c.bools.id0||a(c.objects_paths.id0,{b4w_do_not_batch:!0}),"PLAY_ANIM"==c.type){var v=d.param_anim_behavior;v||(v="FINISH_STOP"),d.param_anim_behavior=k.anim_behavior_bpy_b4w(v)}break;case"STRING":switch(d.string_operation){case"JOIN":d.string_operation=G.NSO_JOIN;break;case"FIND":d.string_operation=G.NSO_FIND;break;case"REPLACE":d.string_operation=G.NSO_REPLACE;break;case"SPLIT":d.string_operation=G.NSO_SPLIT;break;case"COMPARE":d.string_operation=G.NSO_COMPARE}if("cnd"in c.floats)d.condition=c.floats.cnd;else switch(d.condition){case"GEQUAL":d.condition=G.NC_GEQUAL;break;case"LEQUAL":d.condition=G.NC_LEQUAL;break;case"GREATER":d.condition=G.NC_GREATER;break;case"LESS":d.condition=G.NC_LESS;break;case"NOTEQUAL":d.condition=G.NC_NOTEQUAL;break;case"EQUAL":d.condition=G.NC_EQUAL}break;case"REDIRECT":void 0!=c.url&&(c.bools.url=!1,c.strings.url=c.url);break;case"SET_CAMERA_MOVE_STYLE":switch(d.camera_move_style){case"STATIC":d.camera_move_style=G.NCMS_STATIC;break;case"TARGET":d.camera_move_style=G.NCMS_TARGET;break;case"EYE":d.camera_move_style=G.NCMS_EYE;break;case"HOVER":d.camera_move_style=G.NCMS_HOVER}break;case"ENTRYPOINT":c.bools||(c.bools={}),void 0===c.bools.js&&(c.bools.js=!1),c.bools.js&&(c.mute=!0);break;case"JS_CALLBACK":var m=d.js_cb_params;for(var l in m)switch(m[l]){case"OBJECT":m[l]=G.NCPT_OBJECT;break;case"VARIABLE":m[l]=G.NCPT_VARIABLE}}}}}var _=r(0),n=r(5),o=r(25),i=r(4),s=r(82),c=r(21),E=r(1),l=r(8),T=r(39),u=r(2),d=r(3),f=r(28),P=r(63),A=r(41),S=Object(_.a)("__reformer",a);t.a=S},function(e,t,r){"use strict";function a(e,t){function r(e,t,r){var _=[];for(var n in e)c._8(e[n])>1&&_.push([n,e[n]]);if(_.sort(function(e,t){var r=c._8(e[1]),a=c._8(t[1]);return a!=r?a-r:e<t?-1:t<e?1:0}),_.length){E.groupCollapsed(t+" "+r),E.log_raw("Property different variants (>1) | Property name");for(var o=0;o<_.length;o++)E.groupCollapsed(c._8(_[o][1]),_[o][0]),a(_[o][1]);E.groupEnd()}}function a(e){E.log_raw("Batches count for this property value | Property value");var t=[];for(var r in e)t.push([r,e[r]]);t.sort(function(e,t){return t[1]!=e[1]?t[1]-e[1]:e[0]<t[0]?-1:t[0]<e[0]?1:0});for(var a=0;a<t.length;a++)E.log_raw(t[a][1],t[a][0]);E.groupEnd()}var _=Object(n.a)(e),E=Object(o.a)(e),l=Object(i.a)(e),T=Object(s.a)(e);t.print_batches_stat=function(){for(var e={},t=["bounds_local","bufs_data","id","attribute_setters","num_vertices","num_triangles","material_names","shader","bpy_tex_names"],a=0,n=0,o=l.get_scene_objs(T.get_main(),"MESH",l.DATA_ID_ALL),i=0;i<o.length;i++)for(var s=0;s<o[i].scenes_data.length;s++)for(var c=0;c<o[i].scenes_data[s].batches.length;c++){var u=_.clone_batch(o[i].scenes_data[s].batches[c]),d=u.shaders_info.vert+"/"+u.shaders_info.frag;u["shaders_info.directives"]=u.shaders_info.directives,u["shaders_info.node_elements"]=u.shaders_info.node_elements,delete u.shaders_info;for(var f=0;f<t.length;f++)delete u[t[f]];if(o[i].is_dynamic)n++;else{a++,u.type in e||(e[u.type]={}),d in e[u.type]||(e[u.type][d]={});for(var P in u){P in e[u.type][d]||(e[u.type][d][P]={});var A=JSON.stringify(u[P]);A in e[u.type][d][P]||(e[u.type][d][P][A]=0),e[u.type][d][P][A]++}}}E.group("Batches statistics:"),E.log_raw("STATIC/DYNAMIC count:",a+"/"+n),E.group("STATIC batches diversity:");for(var S in e)for(var d in e[S])r(e[S][d],S,d);E.groupEnd(),E.groupEnd()}}var _=r(0),n=r(16),o=r(1),i=r(12),s=r(10),c=r(2),E=Object(_.a)("__debug_batch",a);t.a=E},function(e,t,r){"use strict";function a(e,t){function r(e,t,r){var n=_.get_camera_angles(e,g)[0],o=a(e,n,t.left,t.right,h);return r*Math.min(1,o[0]/O,o[1]/O)}function a(e,t,r,a,n){var o=m.angle_wrap_0_2pi(t-r),i=Math.min(o,2*Math.PI-o),s=m.angle_wrap_0_2pi(a-t),c=Math.min(s,2*Math.PI-s);return(Math.abs(i)<N||2*Math.PI-Math.abs(i)<N)&&(i=0),(Math.abs(c)<N||2*Math.PI-Math.abs(c)<N)&&(c=0),_.is_eye_camera(e)?(n[0]=c,n[1]=i):(n[0]=i,n[1]=c),n}var _=Object(n.a)(e),f=Object(o.a)(e),P=Object(i.a)(e),A=Object(c.a)(e),S=Object(E.a)(e),p=Object(l.a)(e),v=Object(T.a)(e),m=Object(u.a)(e),O=.2,N=1e-6,g=new Float32Array(2),h=new Float32Array(2),R=new Float32Array(3),I=new Float32Array(3),b=new Float32Array(3),Y=v.create(),L=v.create(),M=v.create(),y=s.create(),x={},U=!1,w=!1,C=!1,D=!1;t.track_to_target=function(e,t,r,a,n,o,i,s){if(!_.is_eye_camera(e))return void P.error("track_to_target(): Wrong camera object or camera move style");if(m.is_vector(t))var c=t;else{var c=R;p.get_object_center(t,!1,c)}r=r||1,a=a||2,n=n||1,o=o||1;var E=p.get_translation(e,I),l=d.subtract(c,E,b),T=_.get_camera_angles(e,g),u=_.get_camera_angles_dir(l,h),A=u[0]-T[0],v=u[1]-T[1],O=Math.acos(Math.cos(A)*Math.cos(v)),N=Math.abs(O/r),Y=d.length(l)*(1-1/a),L=function(e){return 6*e*(1-e)},M=S.get_timeline(),y=0,x=function(t,r,a){if(!_.is_eye_camera(t))return void U();if(1==a){var i=f.get_sensor_value(t,r,0)-M,c=f.get_sensor_value(t,r,1);if(i<N){var l=L(i/N),T=l*A*c/N,d=l*v*c/N;_.rotate_camera(e,T,d)}else if(i<N+n){0==y&&(_.rotate_camera(e,u[0],u[1],!0),y++);var l=L(i-N/n),P=l*Y*c/n;p.move_local(t,0,0,-P)}else if(i<N+n+o)y<=1&&(_.rotate_camera(e,u[0],u[1],!0),_.eye_set_look_at(e,E),p.move_local(t,0,0,-Y),s&&s(),y++);else if(i<N+n+o+n){y<=2&&(_.rotate_camera(e,u[0],u[1],!0),_.eye_set_look_at(e,E),p.move_local(t,0,0,-Y),y++);var l=L(i-N-n-o/n),P=l*Y*c/n;p.move_local(t,0,0,P)}else _.rotate_camera(e,u[0],u[1],!0),_.eye_set_look_at(e,E),U()}},U=function(){f.remove_sensor_manifold(e,"TRACK_TO_TARGET"),i&&i()},w=f.create_timeline_sensor(),C=f.create_elapsed_sensor();f.create_sensor_manifold(e,"TRACK_TO_TARGET",f.CT_CONTINUOUS,[w,C],null,x)},t.auto_rotate=function(e,t,n){function o(t){T=T||{},T.left=t.left,T.right=t.right,u=Math.min(O,m.angle_wrap_0_2pi(T.right-T.left)/2),d=r(l,T,e)}function i(e,t,r){if(1==r){var a=_.get_move_style(e);if(a==_.MS_STATIC)E();else if(a!=_.MS_TARGET_CONTROLS&&a!=_.MS_EYE_CONTROLS||!_.has_horizontal_rot_limits(e))T=null,c(e,t);else{var n=a==_.MS_EYE_CONTROLS?_.eye_get_horizontal_limits(e,x):_.target_get_horizontal_limits(e,x);null!==T&&n.left==T.left&&n.right==T.right||o(n),s(e,t)}}}function s(t,r){var n=f.get_sensor_value(t,r,0),o=_.get_camera_angles(t,g)[0],i=a(t,o,T.left,T.right,h);i[1]>u&&i[0]>u?d=m.sign(d)*e:i[1]<u?d-=Math.pow(e,2)/(2*O)*n:i[0]<u&&(d+=Math.pow(e,2)/(2*O)*n),_.rotate_camera(t,n*d,0)}function c(t,r){var a=f.get_sensor_value(t,r,0);_.rotate_camera(t,a*e,0)}function E(){f.remove_sensor_manifold(l,"AUTO_ROTATE"),f.remove_sensor_manifold(l,"DISABLE_AUTO_ROTATE"),t()}t=t||function(){};var l=A.get_active_camera();if(_.is_static_camera(l))return void P.error("auto_rotate(): Wrong camera move style");var T={},u=0,d=0;if(f.check_sensor_manifold(l,"AUTO_ROTATE"))E();else{var S=f.create_mouse_move_sensor("X"),p=f.create_mouse_move_sensor("Y"),v=f.create_mouse_click_sensor(),N=f.create_touch_move_sensor(),R=f.create_touch_zoom_sensor(),I=f.create_elapsed_sensor();if(n)var b=f.create_mouse_wheel_sensor();else var b=f.create_custom_sensor(0);var Y=function(e){return e[0]&&e[2]||e[1]&&e[2]||e[3]||e[4]||e[5]};f.create_sensor_manifold(l,"DISABLE_AUTO_ROTATE",f.CT_LEVEL,[S,p,v,N,R,b],Y,E),f.create_sensor_manifold(l,"AUTO_ROTATE",f.CT_CONTINUOUS,[I],function(e){return e[0]},i)}},t.is_auto_rotate=function(){var e=A.get_active_camera();return f.check_sensor_manifold(e,"AUTO_ROTATE")},t.check_auto_rotate=function(){var e=A.get_active_camera();return _.get_move_style(e)!=_.MS_STATIC},t.move_camera_to_point=function(e,t,r,a,n){if(_.get_move_style(e)!=_.MS_STATIC)return void P.error("move_camera_to_point(): wrong camera type");if(!U){if(!e)return void P.error("move_camera_to_point(): you must specify the camera object");if(!t)return void P.error("move_camera_to_point(): you must specify the point object");if(r=r||1,a=a||.01,m.is_vector(e))var o=e;else var o=p.get_tsr(e,Y);if(m.is_vector(t))var i=t;else var i=p.get_tsr(t,L);var s=d.distance(v.get_trans(o,R),v.get_trans(i,I)),c=s/r,E=m.quat_to_dir(v.get_quat(o,y),m.AXIS_MZ,R),l=m.quat_to_dir(v.get_quat(i,y),m.AXIS_MZ,I),T=Math.min(Math.abs(d.dot(E,l)),1),u=Math.acos(T),f=u/a,A=1e3*Math.max(c,f);U=!0;var O=S.animate(0,1,A,function(t){var r=v.interpolate(o,i,m.smooth_step(t),M);if(C)return S.clear_animation(O),C=!1,void(U=!1);p.set_tsr(e,r),1==t&&(U=!1,n&&n())})}},t.rotate_camera=function(e,t,r,a,n){function o(){w&&(w=!1,n&&n())}if(_.get_move_style(e)==_.MS_STATIC)return void P.error("rotate_camera(): not supported for STATIC cameras");if(!w){if(!e)return void P.error("rotate_camera(): you must specify the camera object");if(!t&&!r)return void P.error("rotate_camera(): you must specify the rotation angle");a=a||1e3,w=!0;var i=0,s=S.animate(0,t,a,function(r){if(D||Math.abs(r)>=Math.abs(t))return D=!1,S.clear_animation(s),void o();_.rotate_camera(e,i-r,0),i=r}),c=0,E=S.animate(0,r,a,function(t){if(D||Math.abs(t)>=Math.abs(r))return D=!1,S.clear_animation(E),void o();_.rotate_camera(e,0,c-t),c=t})}},t.stop_cam_moving=function(){C=!0},t.stop_cam_rotating=function(){D=!0},t.is_moving=function(){return U},t.is_rotating=function(){return w}}var _=r(0),n=r(36),o=r(24),i=r(1),s=r(8),c=r(31),E=r(72),l=r(44),T=r(87),u=r(26),d=r(3),f=Object(_.a)("camera_anim",a);t.a=f},function(e,t,r){"use strict";function a(e,t){function r(e,t,r){var a=$.get_active_camera();W.rotate_camera(a,t,r);var _=W.get_camera_angles_char(a,Ke);Z.set_character_rotation_h(e,_[0]),Z.set_character_vert_move_dir_angle(e,_[1])}function a(e,t,r,a){if(Math.abs(Le[0])>.01||Math.abs(Le[1])>.01){var _=J.get_sensor_value(e,t,0),n=ee.smooth(Le[0],0,_,p()),o=ee.smooth(Le[1],0,_,p());Le[0]-=n,Le[1]-=o,a(e,-n*ye,-o*ye)}}function _(e){Me=e}function p(){return Oe*Me}function v(e,t){var r=document.createElement("div");r.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: "+pe,r.setAttribute("id",Ae);var a=document.createElement("div");a.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: "+pe+"transform: rotate(180deg);transform-origin: center;",a.setAttribute("id",Se),t.appendChild(r),t.appendChild(a)}function m(e){return"function"===typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)}function O(e,t,r,a){var _=J.get_sensor_value(e,r,1),n=J.get_sensor_value(e,r,2),o=a*ge,i=Math.abs(n)<Ne?0:n,s=-i*o,c=Math.abs(_)<Ne?0:_,E=-c*o;s=ee.clamp(s,he,Re),W.rotate_camera(t,E,s);var l=W.get_camera_angles(t,Ke);Z.set_character_rotation_h(e,l[0]+Math.PI)}function N(e,t){J.check_sensor_manifolds(t,"FPS_PLOCK")&&J.remove_sensor_manifold(t,"FPS_PLOCK"),J.check_sensor_manifolds(null,"FPS_ACTIVATE_PLOCK")&&J.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"),J.check_sensor_manifolds(t,"FPS_CAM_ROT")&&J.remove_sensor_manifold(t,"FPS_CAM_ROT"),J.check_sensor_manifolds(null,"FPS_DRAG_PRESS")&&J.remove_sensor_manifold(null,"FPS_DRAG_PRESS"),J.check_sensor_manifolds(null,"FPS_DRAG_MOVE")&&J.remove_sensor_manifold(null,"FPS_DRAG_MOVE"),J.check_sensor_manifolds(t,"FPS_SMOOTH_DRAG")&&J.remove_sensor_manifold(t,"FPS_SMOOTH_DRAG")}function g(e,t){if(m(e)&&!te.detect_mobile()){var r=J.create_plock_mouse_sensor(e),_=we||J.create_plock_sensor(e);we=_;var n=function(e){return e[0]&&e[1]},o=function(e,t,r){if(r>0){var a=J.get_sensor_payload(e,t,0);De(e,-a.coords[0]*ye,-a.coords[1]*ye)}};J.create_sensor_manifold(t,"FPS_PLOCK",J.CT_CONTINUOUS,[r,_],n,o);var i=function(e){return e[0]},s=function(t,r,a){a>0?Ce.enable_cb&&Ce.enable_cb(e):Ce.disable_cb&&Ce.disable_cb(e)};J.create_sensor_manifold(null,"FPS_ACTIVATE_PLOCK",J.CT_TRIGGER,[_],i,s)}else{if(te.detect_mobile())var c=J.create_touch_move_sensor("XY",e),E=J.create_touch_click_sensor(e),l=ve;else{var c=J.create_mouse_move_sensor("XY",e),E=J.create_mouse_click_sensor(e),l=me,T=$.get_active_camera(),u=function(e,t,r){if(r>0){var a=J.get_sensor_value(e,t,0);O(e,T,t,a)}},d=function(e){return Math.abs(e[1])>Ne||Math.abs(e[2])>Ne},f=J.create_elapsed_sensor(),P=J.create_gamepad_axis_sensor(ae.GMPD_AXIS_2),A=J.create_gamepad_axis_sensor(ae.GMPD_AXIS_3);J.create_sensor_manifold(t,"FPS_CAM_ROT",J.CT_CONTINUOUS,[f,P,A],d,u)}var S=0,p=0,v=function(e){return e[0]},N=function(e,t,r){if(1==r){var a=J.get_sensor_payload(e,t,0),_=a.coords;S=_[0],p=_[1]}};J.create_sensor_manifold(null,"FPS_DRAG_PRESS",J.CT_SHOT,[E],v,N);var g=function(e){return e[0]&&e[1]},h=function(e,t,r){if(1==r){var a=J.get_sensor_payload(e,t,0),_=a.coords;Le[0]+=(_[0]-S)*l,Le[1]+=(_[1]-p)*l,S=_[0],p=_[1]}};J.create_sensor_manifold(null,"FPS_DRAG_MOVE",J.CT_CONTINUOUS,[c,E],g,h);var R=J.create_elapsed_sensor();J.create_sensor_manifold(t,"FPS_SMOOTH_DRAG",J.CT_CONTINUOUS,[R],null,a,De)}}function h(e,t){var r=$.get_active_camera();if(t){var a=ne.get_translation(r,Be),_=ne.get_translation(e,Xe);P.subtract(a,_,a),oe.append_stiff_trans(r,e,a)}var n=W.get_camera_angles_char(r,Ke);Z.set_character_rotation_h(e,n[0]),Z.set_character_vert_move_dir_angle(e,n[1])}function R(e,t){ae.add_click_listener(e,function(){_e.request_fullscreen_hmd(e,function(){N(e,t),ie.enable_hmd(ie.HMD_ALL_AXES_MOUSE_NONE),I(t),je&&je()},function(){b(t),ie.disable_hmd(),g(e,t),He&&He()})})}function I(e){var t=J.create_elapsed_sensor(),r=$.get_active_camera(),a=function(e,t,a){var _=W.get_camera_angles_char(r,Ke)[0];Z.set_character_rotation_h(e,_)};J.create_sensor_manifold(e,"FPS_CHARECTER_VR_ROT",J.CT_CONTINUOUS,[t],null,a)}function b(e){J.remove_sensor_manifold(e,"FPS_CHARECTER_VR_ROT")}function Y(){var e=ie.check_browser_support()&&!te.detect_mobile(),t=ae.get_device_by_type_element(ae.DEVICE_HMD);return t&&(e=e&&ae.get_value_param(t,ae.HMD_WEBVR_TYPE)&ae.HMD_WEBVR1),e}function L(e,t){Y()&&R(e,t),g(e,t)}function M(e,t,r,a){if(te.detect_mobile()){var _=e.parentElement?e.parentElement:e;v(t,_)}var n=k(t),o={left:0,right:0,forw:0,back:0},i=-1,s=a.move_dir_cd,c=function(){return!ke||(o.left=0,o.right=0,o.forw=0,o.back=0,!1)},E=function(e,t){var r=D(n).id;e||t||r==Pe?r==Te&&(i>0?G(n,de):G(n,ue)):G(n,Te)},l=function(e){if(c()){var a=o.forw+o.back;o.forw=e;var _=o.forw+o.back,n=o.left+o.right;Z.set_character_move_dir(t,_,n),r&&r(_,n),E(_,n),s&&a!=_&&s(_,n,0)}},T=function(e){if(c()){e=e>0?1:e,e=e<0?-1:e;var a=o.forw+o.back;o.back=-e;var _=o.forw+o.back,n=o.left+o.right;Z.set_character_move_dir(t,_,n),r&&r(_,n),E(_,n),s&&a!=_&&s(_,n,0)}},u=function(e){if(c()){D(n).id==Pe&&(e=0),e=e>0?1:e,e=e<0?-1:e;var a=o.left+o.right;o.right=-e;var _=o.forw+o.back,i=o.left+o.right;Z.set_character_move_dir(t,_,i),r&&r(_,i),E(_,i),s&&a!=i&&s(_,i,0)}},d=function(e){if(c()){D(n).id==Pe&&(e=0);var a=o.left+o.right;o.left=e;var _=o.forw+o.back,i=o.left+o.right;Z.set_character_move_dir(t,_,i),r&&r(_,i),E(_,i),s&&a!=i&&s(_,i,0)}},f=function(e){c()&&e>0&&(Z.character_jump(t),s&&s(o.forw+o.back,o.left+o.right,1))},P=function(e){i=e,Math.abs(o.forw+o.back)+Math.abs(o.left+o.right)?(e>0?G(n,de):G(n,ue),s&&s(o.forw+o.back,o.left+o.right,0)):G(n,Te)},A=function(e){if(e>0){var t=D(Ue).id;t==ue||t==Te?G(n,fe):G(n,ue)}},S=a.forward_sens_arr,p=a.backward_sens_arr,m=a.right_sens_arr,O=a.left_sens_arr,N=a.jump_sens_arr,g=a.run_sens_arr,h=a.fly_sens_arr;z(ce,S,l),z(ce,p,T),z(ce,m,u),z(ce,O,d),z(ce,N,f),z(le,[ae.GMPD_AXIS_0],u),z(le,[ae.GMPD_AXIS_1],T),z(ce,g,P),z(ce,h,A)}function y(){return Ue||(Ue={nodes:[],current_node:null,lock:!1,last_state:null}),Ue}function x(e,t,r,a,_,n){e.nodes.push({id:t,allowed_ids:r,call_switch:a,call_before_switch:_,call_after_switch:n})}function U(e){for(var t=[],r=0;r<e.nodes;r++){var a=e.nodes[r].id;if(t.indexOf(a)>=0)return!1;t.push(a)}for(var r=0;r<e.nodes;r++)for(var _=e.nodes[r],n=0;n<_.allowed_ids.length;n++)if(t.indexOf(_.allowed_ids[n])<0)return!1;return!0}function w(e,t){for(var r=null,a=0;a<e.nodes.length;a++)if(e.nodes[a].id==t){r=e.nodes[a];break}return r}function C(e,t){var r=w(e,t);return e.current_node=r,r}function D(e){return e.current_node}function F(e,t,r){w(e,t).call_after_switch=r}function G(e,t){if(e.last_state=t,e.lock)return!1;var r=D(e),a=r.id;if(r.allowed_ids.indexOf(t)>=0){var _=!0;if(r.call_before_switch&&(_=r.call_before_switch(a,t)),_)return C(e,t),r.call_switch&&r.call_switch(a,t),r.call_after_switch&&r.call_after_switch(a,t),!0}return!1}function k(e){var t=y(),r=function(t,r){switch(r){case Te:case ue:Z.set_character_move_type(e,Z.CM_WALK);break;case de:Z.set_character_move_type(e,Z.CM_RUN);break;case fe:Z.set_character_move_type(e,Z.CM_FLY);break;case Pe:Z.set_character_move_type(e,Z.CM_CLIMB)}};return x(t,Te,[ue,fe,de,Pe],r,null,null),x(t,ue,[de,fe,Pe,Te],r,null,null),x(t,de,[ue,fe,Pe,Te],r,null,null),x(t,fe,[ue],r,null,null),x(t,Pe,[ue,de,Te],r,null,null),U(t),C(t,Te),Ue}function K(){for(var e=0;e<xe;e++)J.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+e.toString())}function B(e,t){m(t)&&!te.detect_mobile()&&(Ce.disable_cb&&Ce.disable_cb(t),J.remove_sensor_manifold(e,"FPS_PLOCK"),J.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"))}function X(e,t){m(t)&&!te.detect_mobile()||(J.remove_sensor_manifold(e,"FPS_CAM_ROT"),J.remove_sensor_manifold(e,"FPS_DRAG_PRESS"),J.remove_sensor_manifold(e,"FPS_DRAG_MOVE"),J.remove_sensor_manifold(e,"FPS_SMOOTH_DRAG"))}function j(e){Y()&&J.remove_sensor_manifold(e,"FPS_CHARECTER_VR_ROT")}function H(e,t){if(te.detect_mobile()){var r=document.getElementById(Ae),a=document.getElementById(Se);r&&t.removeChild(r),a&&t.removeChild(a)}}function Q(e){Fe=e}function z(e,t,r){if(t.length){for(var a=[],_=0;_<t.length;_++)if("number"==typeof t[_])t[_]<be?a.push(J.create_keyboard_sensor(t[_])):t[_]<Ye?a.push(J.create_gamepad_btn_sensor(t[_],Fe)):a.push(J.create_gamepad_axis_sensor(t[_]));else if("string"==typeof t[_]){var n=document.getElementById(t[_]);n?a.push(J.create_touch_click_sensor(n)):se.error("Couldn't find element with "+t[_]+" ID.")}var o=function(e){return!1},i=J.CT_SHOT,s=function(e,t,r,a){};switch(e){case ce:i=J.CT_TRIGGER,o=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},s=function(e,t,a,_){r(a>0?1:0)};break;case Ee:i=J.CT_TRIGGER,o=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},s=function(e,t,a,_){r(a<0?1:0)};break;case le:i=J.CT_CONTINUOUS,o=function(e){for(var t=0;t<e.length;t++)if(Math.abs(e[t])>Ne)return!0;return!1},s=function(e,t,a,_){if(a>0)for(var n=0;n<_;n++){var o=J.get_sensor_value(e,t,n);if(Math.abs(o)>Ne)return void r(o)}else r(0)}}var c="FPS_USER_CONTROL_ACTION_"+xe.toString(),E=a.length;J.create_sensor_manifold(null,c,i,a,o,s,E),xe++}}function q(e){ye=e/Ie}function V(){return ye*Ie}var W=Object(n.a)(e),J=Object(o.a)(e),Z=Object(i.a)(e),$=Object(s.a)(e),ee=Object(c.a)(e),te=Object(E.a)(e),re=Object(l.a)(e),ae=Object(T.a)(e),_e=Object(u.a)(e),ne=Object(d.a)(e),oe=Object(f.a)(e),ie=Object(A.a)(e),se=Object(S.a)(e),ce=1,Ee=2,le=3,Te=0,ue=1,de=2,fe=3,Pe=4,Ae="B4W_DEFAULT_BTN_1",Se="B4W_DEFAULT_BTN_2",pe="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);",ve=4,me=2,Oe=.2,Ne=.05,ge=2.5,he=(.1-Math.PI)/2,Re=(Math.PI-.1)/2,Ie=2e5,be=300,Ye=326,Le=new Float32Array(2),Me=1,ye=4e-4,xe=0,Ue=null,we=null,Ce={enable_cb:null,disable_cb:null},De=function(){},Fe=0,Ge=4,ke=!1,Ke=new Float32Array(2),Be=new Float32Array(3),Xe=new Float32Array(3),je=null,He=null;t.append_switch_vr_cbs=function(e,t){je=e,He=He},t.CS_STAY=Te,t.CS_WALK=ue,t.CS_RUN=de,t.CS_FLY=fe,t.CS_CLIMB=Pe,t.AT_PRESSED=ce,t.AT_RELEASED=Ee,t.AT_CONTINUOUS=le,t.bind_action=z,t.enable_fps_controls=function(e){e=e||{lock_camera:!0};var t=e.character||$.get_first_character();if(t){var a=e.element||re.get_canvas(),_=e.motion_cb||null;Q(e.gamepad_id||0);var n=e.forward_sens||[J.KEY_W,ae.GMPD_BUTTON_12],o=e.backward_sens||[J.KEY_S,ae.GMPD_BUTTON_13],i=e.right_sens||[J.KEY_D,ae.GMPD_BUTTON_15],s=e.left_sens||[J.KEY_A,ae.GMPD_BUTTON_14],c=e.jump_sens||[J.KEY_SPACE,ae.GMPD_BUTTON_1],E=e.run_sens||[J.KEY_SHIFT,ae.GMPD_BUTTON_7],l=e.fly_sens||[];te.detect_mobile()&&(n.push(Ae),o.push(Se));var T=e.move_dir_cd||null,u={forward_sens_arr:n,backward_sens_arr:o,right_sens_arr:i,left_sens_arr:s,jump_sens_arr:c,run_sens_arr:E,fly_sens_arr:l,move_dir_cd:T};De=e.rotation_cb||r;h(t,"undefined"==typeof e.lock_camera||e.lock_camera),L(a,t),M(a,t,_,u)}},t.disable_fps_controls=function(e,t){e=e||$.get_first_character(),t=t||re.get_container(),e&&(K(),B(e,t),X(e,t),j(e),H(e,t))},t.set_state_change_cb=function(e,t){F(Ue,e,t)},t.set_cam_smooth_factor=function(e){J.set_plock_smooth_factor(e),_(e)},t.get_cam_smooth_factor=function(){return Me},t.set_cam_sensitivity=q,t.get_cam_sensitivity=V,t.set_plock_enable_cb=function(e){Ce.enable_cb=e},t.set_plock_disable_cb=function(e){Ce.disable_cb=e},t.get_character_state=function(){return D(Ue).id},t.add_new_state=function(){return Ge++},t.add_state=function(e,t,r){var a=y();x(a,e,t,r,null,null),U(a)||se.error("Incorrect state machine.")},t.switch_state=function(e){G(y(),e)},t.lock_character=function(){y().lock=!0},t.unlock_character=function(){y().lock=!1},t.is_character_locked=function(){return y().lock},t.set_rotation_cb=function(e){De=e||r},t.freeze_movements=function(){ke=!0},t.unfreeze_movements=function(){ke=!1}}var _=r(0),n=r(36),o=r(24),i=r(57),s=r(31),c=r(26),E=r(64),l=r(43),T=r(52),u=r(53),d=r(44),f=r(71),P=r(3),A=r(88),S=r(1),p=Object(_.a)("fps",a);t.a=p},function(e,t,r){"use strict";function a(e,t){function r(e,t,r,a){var _=R.get_sensor_value(t,r,a)*D,n=R.get_sensor_value(t,r,a+1)*D;e.style.transform="translate3d("+_+"px, "+n+"px, 0px) rotate(0rad)"}function a(e,t,r){if(!(r+1>2*Ne.length)){var a=R.get_sensor_value(e,t,r),_=R.get_sensor_value(e,t,r+1);if(he[r]>-2){var n=a-he[r],o=_-he[r+1],i=Ne[Math.floor(r/2)],s=i.getAttribute("data-svgid");if(ue==G)i.style.backgroundImage=n||o?Y+btoa(Ee[s].replace(x,y))+"')":Y+btoa(Ee[s])+"')";else if(ue==K){var c=I.get_moved_gmpd_axis(le);if(c>=0){c%2!=0&&c--,ue=G,i.style.backgroundImage=Y+btoa(Ee[s])+"')";var E=parseFloat(Te.getAttribute("data-key"));I.set_gamepad_key(le,E,c),I.set_gamepad_key(le,E+1,c+1),Te=null,document.getElementById("action_label").textContent=U}}}he[r]=a,he[r+1]=_}}function _(e,t,r){if(!(r>=Ne.length)){var a=R.get_sensor_value(e,t,r);if(he[r]>-2){var _=a-he[r],n=Ne[r],o=n.getAttribute("data-svgid");if(ue==G)n.style.backgroundImage=_?Y+btoa(Ee[o].replace(x,y))+"')":Y+btoa(Ee[o])+"')";else if(ue==K){var i=I.get_moved_gmpd_axis(le);if(i>=0){ue=G,n.style.backgroundImage=Y+btoa(Ee[o])+"')";var s=parseFloat(Te.getAttribute("data-key"));I.set_gamepad_key(le,s,i),Te=null,document.getElementById("action_label").textContent=U}}}he[r]=a}}function c(e,t,r){if(ue==G){if(t&&"B"==e.getAttribute("data-colorstate")){var a=Ee[r];e.style.backgroundImage=Y+btoa(a.replace(L,y))+"')",e.setAttribute("data-colorstate","G")}if(!t&&"B"!=e.getAttribute("data-colorstate")){var a=Ee[r];e.style.backgroundImage=Y+btoa(a)+"')",e.setAttribute("data-colorstate","B")}}else{var _=I.get_pressed_gmpd_btn(le);if(_>=0&&Te&&ue==k){var n=Te.getAttribute("data-key");I.set_gamepad_key(le,n,_),l(n,_),Te=null,document.getElementById("action_label").textContent=U,ue=G}}}function E(){ve.length=0;for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)e[t]&&ve.push(e[t]);return ve}function l(e,t){var r=b.get(le+"_gmpd_stngs","b4w")||"{}",a=JSON.parse(r);a[e]=t,b.set(le+"_gmpd_stngs",JSON.stringify(a),"b4w")}function T(e){var t=JSON.stringify(F);b.set(e+"_gmpd_stngs",t,"b4w")}function u(e,t){for(var r in e)I.set_gamepad_key(t,r,e[r])}function d(e){var t=b.get(e+"_gmpd_stngs","b4w");t?u(JSON.parse(t),e):T(e)}function f(e){ge=!0;var t=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),_=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),E=document.createElement("div"),l=document.createElement("div"),T=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),f=document.createElement("div"),P=document.createElement("div"),A=document.createElement("div"),S=document.createElement("div"),p=document.createElement("div"),v=document.createElement("div"),m=document.createElement("div"),N=document.createElement("div");fe=t,t.style.cssText="position: absolute;height: auto;background-image: "+Y+btoa(B)+"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;",r.style.cssText="background-image: "+Y+btoa(X)+"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;",a.style.cssText="background-image: "+Y+btoa(j)+"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;",_.style.cssText="background-image: "+Y+btoa(H)+"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;",n.style.cssText="background-image: "+Y+btoa(Q)+"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;",o.style.cssText="background-image: "+Y+btoa(z)+"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;",i.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;",s.style.cssText="background-image: "+Y+btoa(q)+"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;",c.style.cssText="background-image: "+Y+btoa(q)+"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;",E.style.cssText="background-image: "+Y+btoa(q)+"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;",l.style.cssText="background-image: "+Y+btoa(q)+"');width: 50px;height: 50px;top: 51px;position: absolute;",T.style.cssText="background-image: "+Y+btoa(V)+"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;",u.style.cssText="background-image: "+Y+btoa(V)+"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;",d.style.cssText="background-image: "+Y+btoa(W)+"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;",f.style.cssText="background-image: "+Y+btoa(W)+"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;",P.style.cssText="background-image: "+Y+btoa(Z)+"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;",A.style.cssText="background-image: "+Y+btoa($)+"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;",S.style.cssText="background-image: "+Y+btoa(J)+"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;",p.style.cssText="background-image: "+Y+btoa(J)+"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;",v.style.cssText="background-image: "+Y+btoa(ee)+"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;",m.style.cssText="background-image: "+Y+btoa(te)+"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;",N.style.cssText="background-image: "+Y+btoa(te)+"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;",t.appendChild(m),t.appendChild(N),r.appendChild(a),r.appendChild(_),r.appendChild(n),r.appendChild(o),t.appendChild(r),i.appendChild(s),i.appendChild(c),i.appendChild(E),i.appendChild(l),t.appendChild(i),t.appendChild(T),t.appendChild(u),t.appendChild(d),t.appendChild(f),t.appendChild(P),t.appendChild(A),t.appendChild(S),e.appendChild(t),t.appendChild(p),t.appendChild(v),me.length=0,Ee.length=0,Oe.length=0,Ne.length=0,me.push(E,c,l,s,P,A,p,S,d,f,T,u,a,n,o,_,v),Ee.push(q,q,q,q,Z,$,J,J,W,W,V,V,j,Q,z,H,ee),Oe.push(T,T,u,u),Ne.push(m,N);for(var g=0;g<me.length;g++)me[g].setAttribute("id","pad_btn_"+g),me[g].setAttribute("data-colorstate","B"),me[g].setAttribute("data-key",g),me[g].setAttribute("data-svgid",g);m.setAttribute("id","pad_left_axis"),m.setAttribute("data-colorstate","GR"),m.setAttribute("data-key",I.GMPD_AXIS_0),m.setAttribute("data-svgid",Ee.length),N.setAttribute("id","pad_right_axis"),N.setAttribute("data-colorstate","GR"),N.setAttribute("data-key",I.GMPD_AXIS_2),N.setAttribute("data-svgid",Ee.length+1),Ee.push(te,te),O(me,L),O(Ne,x)}function P(e){ge=!1;var t=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),_=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),E=document.createElement("div"),l=document.createElement("div"),T=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),f=document.createElement("div"),P=document.createElement("div"),A=document.createElement("div"),S=document.createElement("div"),p=document.createElement("div"),v=document.createElement("div"),m=document.createElement("div"),N=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),R=document.createElement("div"),b=document.createElement("div"),M=document.createElement("div"),y=document.createElement("div"),U=document.createElement("div"),w=document.createElement("div");fe=t;var C="position: absolute;height: auto;background-image: "+Y+btoa(ae)+"');width: 19px;height: 19px;background-size: 100% 100%;";t.style.cssText="position: absolute;background-image: "+Y+btoa(re)+"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;",r.style.cssText=C+"top: 132px;left: 331px;",a.style.cssText=C+"top: 122px;left: 315px;",_.style.cssText=C+"top: 122px;left: 347px;",n.style.cssText=C+"top: 113px;left: 331px;",o.style.cssText="position: absolute;height: auto;background-image: "+Y+btoa(_e)+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;",i.style.cssText="position: absolute;height: auto;background-image: "+Y+btoa(ne)+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;",s.style.cssText=C+"top: 107px;left: 141px;",c.style.cssText=C+"top: 107px;left: 90px;",E.style.cssText=C+"top: 185px;left: 321px;",l.style.cssText=C+"top: 185px;left: 340px;",T.style.cssText=C+"top: 179px;left: 358px;",u.style.cssText=C+"top: 178px;left: 303px;",d.style.cssText=C+"top: 210px;left: 299px;",f.style.cssText=C+"top: 279px;left: 299px;",P.style.cssText=C+"top: 210px;left: 321px;",A.style.cssText=C+"top: 279px;left: 321px;",S.style.cssText=C+"top: 210px;left: 344px;",p.style.cssText=C+"top: 278px;left: 344px;",v.style.cssText=C+"top: 124px;left: 147px;",m.style.cssText=C+"top: 138px;left: 133px;",N.style.cssText=C+"top: 124px;left: 82px;",g.style.cssText=C+"top: 138px;left: 96px;",h.style.cssText=C+"top: 278px;left: 367px;";var D="position: absolute;background-image: "+Y+btoa(oe)+"');width: 19px;height: 46px;background-size: 100% 100%;";R.style.cssText=D+"top: 291px;left: 50px;",b.style.cssText=D+"top: 291px;left: 111px;",M.style.cssText=D+"top: 291px;left: 171px;",y.style.cssText="position: absolute;background-image: "+Y+btoa(ie)+"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;",U.style.cssText="position: absolute;background-image: "+Y+btoa(se)+"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;",w.style.cssText="position: absolute;background-image: "+Y+btoa(ce)+"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;",e.appendChild(t),t.appendChild(R),t.appendChild(b),t.appendChild(M),t.appendChild(y),t.appendChild(U),t.appendChild(w),t.appendChild(r),t.appendChild(a),t.appendChild(_),t.appendChild(n),t.appendChild(o),t.appendChild(i),t.appendChild(s),t.appendChild(c),t.appendChild(E),t.appendChild(l),t.appendChild(T),t.appendChild(u),t.appendChild(d),t.appendChild(f),t.appendChild(P),t.appendChild(A),t.appendChild(S),t.appendChild(p),t.appendChild(v),t.appendChild(m),t.appendChild(N),t.appendChild(g),t.appendChild(h),me.length=0,Ee.length=0,Oe.length=0,Ne.length=0,me.push(r,a,_,n,o,i,s,c,E,l,T,u,d,f,P,A,S,p,v,m,N,g,h),Ee.push(ae,ae,ae,ae,_e,ne,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae),Ne.push(y,R,M,b,U,w);for(var F=0;F<me.length;F++)me[F].setAttribute("id","wheel_btn_"+F),me[F].setAttribute("data-colorstate","B"),me[F].setAttribute("data-key",F),me[F].setAttribute("data-svgid",F);for(var F=0;F<Ne.length;F++)me[F].setAttribute("id","wheel_axis_"+F),me[F].setAttribute("data-colorstate","GR");y.setAttribute("data-key",I.GMPD_AXIS_0),y.setAttribute("data-svgid",Ee.length),R.setAttribute("data-key",I.GMPD_AXIS_1),R.setAttribute("data-svgid",Ee.length+1),M.setAttribute("data-key",I.GMPD_AXIS_2),M.setAttribute("data-svgid",Ee.length+2),b.setAttribute("data-key",I.GMPD_AXIS_3),b.setAttribute("data-svgid",Ee.length+3),U.setAttribute("data-key",I.GMPD_AXIS_4),U.setAttribute("data-svgid",Ee.length+4),w.setAttribute("data-key",I.GMPD_AXIS_5),w.setAttribute("data-svgid",Ee.length+5),Ee.push(ie,oe,oe,oe,se,ce),O(me,L),O(Ne,x)}function A(e){return[R.create_gamepad_btn_sensor(I.GMPD_BUTTON_0,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_1,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_2,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_3,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_4,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_5,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_6,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_7,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_8,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_9,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_10,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_11,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_12,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_13,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_14,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_15,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_16,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_17,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_18,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_19,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_20,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_21,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_22,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_23,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_24,e),R.create_gamepad_btn_sensor(I.GMPD_BUTTON_25,e)]}function S(e){return[R.create_gamepad_axis_sensor(I.GMPD_AXIS_0,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_1,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_2,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_3,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_4,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_5,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_6,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_7,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_8,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_9,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_10,e),R.create_gamepad_axis_sensor(I.GMPD_AXIS_11,e)]}function p(e,t){var r=document.createElement("input");r.style.cssText="display: inline-block;position = relative;",r.setAttribute("type","radio"),r.setAttribute("name","choice");var a=document.createElement("label");return a.textContent=t,a.style.cssText="position = relative;display: inline-block;color: white;",e.appendChild(r),e.appendChild(a),r}function v(){de.removeChild(fe),fe=null}function m(e){switch(v(),e){case"PAD":Se.checked=!0,f(de);break;case"WHEEL":Ae.checked=!0,P(de)}}function O(e,t){for(var r=function(e){var r=e.target;if(!(le<0||"G"==r.getAttribute("data-colorstate")))if(ue!=G){if("R"==r.getAttribute("data-colorstate")&&(Te=null,document.getElementById("action_label").textContent=U,ue=G),"B"==r.getAttribute("data-colorstate")||"GR"==r.getAttribute("data-colorstate")){var a=parseFloat(Te.getAttribute("data-svgid"));Te.style.backgroundImage=Y+btoa(Ee[a])+"')",Te.setAttribute("data-colorstate",r.getAttribute("data-colorstate")),Te=r,a=parseFloat(r.getAttribute("data-svgid")),r.style.backgroundImage=Y+btoa(Ee[a].replace(t,M))+"')",r.setAttribute("data-colorstate","R")}}else{var a=parseFloat(r.getAttribute("data-svgid")),_="B"==r.getAttribute("data-colorstate")?k:K;ue=_,r.style.backgroundImage=Y+btoa(Ee[a].replace(t,M))+"')",r.setAttribute("data-colorstate","R"),document.getElementById("action_label").textContent=_==k?w:C,Te=r}},a=0;a<e.length;a++){var _=e[a];I.add_click_listener(_,r)}}function N(e){var t=document.createElement("label");return t.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;",t.textContent=e,t}function g(){var e=window.innerWidth,t=window.innerHeight;de.style.zoom=t<=750&&t>400||e<=750&&e>400?"0.5":e<=400||t<=400?"0.3":"1"}var h=Object(n.a)(e),R=Object(o.a)(e),I=Object(i.a)(e),b=Object(s.a)(e),Y="url('data:image/svg+xml;base64,",L=new RegExp("#5276cf","g"),M="#ff0000",y="#00ff00",x="#e6e6e6",U="Click on the buttons & arrows to setup your controller",w="Now press the button on the device",C="Now move the axis on the device",D=20,F={};F[I.GMPD_BUTTON_12]=I.GMPD_BUTTON_12,F[I.GMPD_BUTTON_13]=I.GMPD_BUTTON_13,F[I.GMPD_BUTTON_15]=I.GMPD_BUTTON_15,F[I.GMPD_BUTTON_14]=I.GMPD_BUTTON_14,F[I.GMPD_BUTTON_3]=I.GMPD_BUTTON_3,F[I.GMPD_BUTTON_0]=I.GMPD_BUTTON_0,F[I.GMPD_BUTTON_1]=I.GMPD_BUTTON_1,F[I.GMPD_BUTTON_2]=I.GMPD_BUTTON_2,F[I.GMPD_BUTTON_5]=I.GMPD_BUTTON_5,F[I.GMPD_BUTTON_7]=I.GMPD_BUTTON_7,F[I.GMPD_BUTTON_4]=I.GMPD_BUTTON_4,F[I.GMPD_BUTTON_6]=I.GMPD_BUTTON_6,F[I.GMPD_BUTTON_8]=I.GMPD_BUTTON_8,F[I.GMPD_BUTTON_9]=I.GMPD_BUTTON_9,F[I.GMPD_BUTTON_10]=I.GMPD_BUTTON_10,F[I.GMPD_BUTTON_11]=I.GMPD_BUTTON_11,F[I.GMPD_BUTTON_16]=I.GMPD_BUTTON_16;var G=0,k=1,K=2,B='<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>',X='<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>',j='<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',H='<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',Q='<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',z='<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',q='<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',V='<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',W='<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',J='<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',Z='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',$='<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',ee='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>',te='<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',re='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>',ae='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',_e='<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',ne='<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',oe='<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',ie='<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',se='<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',ce='<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>',Ee=[],le=-1,Te=null,ue=G,de=null,fe=null,Pe=null,Ae=null,Se=null,pe=null,ve=[],me=[],Oe=[],Ne=[],ge=!0,he={};he[I.GMPD_AXIS_0]=-2,he[I.GMPD_AXIS_1]=-2,he[I.GMPD_AXIS_2]=-2,he[I.GMPD_AXIS_3]=-2,he[I.GMPD_AXIS_4]=-2,he[I.GMPD_AXIS_5]=-2,he[I.GMPD_AXIS_6]=-2,he[I.GMPD_AXIS_7]=-2,he[I.GMPD_AXIS_8]=-2,he[I.GMPD_AXIS_9]=-2,he[I.GMPD_AXIS_10]=-2,he[I.GMPD_AXIS_11]=-2,t.show=function(){function e(e,t,r){var a=E(),_=a.length;-1==le&&a.length&&(le=a[0].index,Pe=u[le]);for(var n=0;n<u.length;n++)n<_?(u[n].textContent=a[n].index,u[n]==Pe?(u[n].style.backgroundColor="green",pe.textContent="Selected device: "+a[n].index+". Data: "+a[n].id):u[n].style.backgroundColor="blue"):u[n].style.backgroundColor="black";_||(le=-1,pe.textContent="")}var t=document.createElement("div");de=t,t.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);",h.insert_to_container(t,"LAST"),f(t);var n=document.createElement("div");n.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var o=document.createElement("div");o.innerHTML="Select a device",o.style.cssText="color: #fff;display: inline-block;",n.appendChild(o);for(var i=0;i<4;i++){var s=A(i),l=function(){return!0},T=function(e,t,r){if(t==le)for(var a=0;a<me.length;a++){var _=me[a];c(_,R.get_sensor_value(e,t,a),a)}};R.create_sensor_manifold(null,i,R.CT_CONTINUOUS,s,l,T)}E().length>0&&(le=0);var u=[],P=document.createElement("div");P.style.cssText="margin-top: 20px;";for(var v=0;v<4;v++){var O=N(v);v==le&&(O.style.backgroundColor="green",Pe=O),d(v),P.appendChild(O),O.setAttribute("data-device_type","PAD"),u.push(O);var b=function(e){for(var t=E(),r=e.target,a=0;a<t.length;a++)u[a]==r&&(le=a,Pe=r,d(le),m(r.getAttribute("data-device_type")))};I.add_click_listener(O,b)}n.appendChild(P),pe=document.createElement("label"),pe.style.cssText="position: relative;display: block;color: white;",n.appendChild(pe);var Y=document.createElement("div");Y.style.cssText="margin-top: 20px;";var L=p(Y,"Pad"),M=p(Y,"Wheel");L.setAttribute("checked","true"),L.onchange=function(){m("PAD"),Pe&&Pe.setAttribute("data-device_type","PAD")},M.onchange=function(){m("WHEEL"),Pe&&Pe.setAttribute("data-device_type","WHEEL")},L.setAttribute("id","test"),Se=L,Ae=M;var y=document.createElement("label");y.style.cssText+="color: #fff;display: block;",Y.appendChild(y),y.textContent=U,y.setAttribute("id","action_label"),n.appendChild(Y),t.appendChild(n);var x=R.create_elapsed_sensor();R.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",R.CT_CONTINUOUS,[x],l,e);for(var i=0;i<4;i++){var s=S(i),w=function(){return!0},T=function(e,t,n){if(t=="AXES"+le){for(var o=0;o<Oe.length;o+=2){r(Oe[o],e,t,o)}if(ge)for(var o=0;o<12;o+=2)a(e,t,o);else for(var o=0;o<12;o++)_(e,t,o)}};R.create_sensor_manifold(null,"AXES"+i,R.CT_CONTINUOUS,s,w,T)}g(),window.addEventListener("resize",g)},t.hide=function(){ue=G,le=-1,Pe=null,Te=null,Ae=null,Se=null,Oe.length=0,me.length=0,Ne.length=0,h.get_container().removeChild(de),de=null,R.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var e=0;e<4;e++)R.remove_sensor_manifold(null,e),R.remove_sensor_manifold(null,"AXES"+e);window.removeEventListener("resize",g)},t.update=function(){for(var e=0;e<4;e++)d(e)}}var _=r(0),n=r(43),o=r(24),i=r(52),s=r(73),c=Object(_.a)("gp_conf",a);t.a=c},function(e,t,r){"use strict";function a(e,t){function r(e){var t=_.create_gyro_angles_sensor(),r=_.create_gyro_quat_sensor(),n=!0,o=function(e,t,r){if(r>0)if(a.is_eye_camera(e)){var o=_.get_sensor_payload(e,t,1),i=E.transformQuat(u.AXIS_MY,o,P);a.set_vertical_axis(e,i),T.set_rotation_v(e,o)}else{f=_.get_sensor_payload(e,t,0),n&&(d[0]=f[0],d[1]=f[1],d[2]=f[2],n=!1);var s=0,c=0;0==window.orientation&&(s=f[1]-d[1],c=f[0]-d[0],f[1]>S&&f[1]<A&&(c=0)),180==window.orientation&&(s=f[1]-d[1],f[1]<0&&(s=-s),c=d[0]-f[0],(s>Math.PI/2||s<-Math.PI/2)&&(s=0),f[1]>-A&&f[1]<-S&&(c=0)),-90==window.orientation&&(s=f[0]-d[0],(s>Math.PI/2||s<-Math.PI/2)&&(s=0),c=d[1]-f[1],(f[0]>p||f[0]<v)&&(c=0)),90==window.orientation&&(s=d[0]-f[0],(s>Math.PI/2||s<-Math.PI/2)&&(s=0),c=f[1]-d[1],(f[0]>p||f[0]<v)&&(c=0)),a.rotate_camera(e,c,s),d[0]=f[0],d[1]=f[1],d[2]=f[2]}};_.create_sensor_manifold(e,"CAMERA_ROTATE_GYRO",_.CT_CONTINUOUS,[t,r],null,o)}var a=Object(n.a)(e),_=Object(o.a)(e),l=Object(i.a)(e),T=Object(s.a)(e),u=Object(c.a)(e),d=new Float32Array(3),f=new Float32Array(3),P=E.create(),A=u.deg_to_rad(110),S=u.deg_to_rad(70),p=u.deg_to_rad(70),v=-u.deg_to_rad(70);t.enable_camera_rotation=function(){r(l.get_active_camera())},t.disable_camera_rotation=function(){var e=l.get_active_camera();_.remove_sensor_manifold(e,"CAMERA_ROTATE_GYRO")}}var _=r(0),n=r(36),o=r(24),i=r(31),s=r(44),c=r(26),E=r(3),l=Object(_.a)("gyroscope",a);t.a=l},function(e,t,r){"use strict";function a(e,t){function r(){if(!Y.can_use_device(Y.DEVICE_HMD))return!1;var e=Y.get_device_by_type_element(Y.DEVICE_HMD),t=Y.get_value_param(e,Y.HMD_WEBVR_TYPE);return t&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE|Y.HMD_WEBVR_DESKTOP)&&!(t&Y.HMD_WEBVR1)}function a(){var e=M.get("hmd_conf","b4w"),t=JSON.parse(e||"{}"),r=t.profile||"custom",a=document.createElement("div"),n=document.createElement("label");n.innerHTML="Profile: ",n.className="text_label",n.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",a.appendChild(n);var o=document.createElement("select");a.appendChild(o),o.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var i=Y.get_device_by_type_element(Y.DEVICE_HMD);if(i)for(var s in Z)if(Z[s].type==W||Y.get_value_param(i,Y.HMD_WEBVR_TYPE)&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE)&&Z[s].type==J){var c=document.createElement("option");c.value=s,c.text=Z[s].name,o.appendChild(c)}return o.value=r,y.is_ie11()?o.onchange=_:o.oninput=_,a}function _(e){var t=e.target.value,r=Z[t];for(var a in F)if(a in r){var _=document.getElementById(a+"_slider");_&&(_.disabled="custom"!==t,_.value=r[a]);var n=document.getElementById(a+"_number");n&&(n.disabled="custom"!==t,n.value=r[a]),F[a]=r[a]}}function l(){b.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING"),p(),m(),x&&(x=!1,d())}function T(){p(!0),m(),u()}function u(){for(var e in F){var t=document.getElementById(e+"_slider");t&&(t.value=F[e]);var r=document.getElementById(e+"_number");r&&(r.value=F[e])}}function d(){I.get_container().removeChild(U),document.head.removeChild(w),U=null,C=null,w=null}function f(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio}function P(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio}function A(e,t,r,a){return e.ua&&t.indexOf(e.ua)>=0||!e.ua&&e.res&&e.res[0]&&e.res[1]&&Math.min(r,a)==Math.min(e.res[0],e.res[1])&&Math.max(r,a)==Math.max(e.res[0],e.res[1])}function S(e,t,r,a){if(1!=e.format||!e.devices||!e.devices.length)return L.error("DPDB isn't correct."),-1;for(var _=0;_<e.devices.length;_++){var n=e.devices[_];if(n.rules&&("ios"==n.type&&q||"android"==n.type)){for(var o=!1,i=0;i<n.rules.length;i++){if(A(n.rules[i],t,r,a)){o=!0;break}}if(o)return _}}return-1}function p(e){var t=navigator.userAgent||navigator.vendor||window.opera,r=f(),a=P(),_=0,n=0,o=0,i=S(ee,t,r,a);if(-1!=i){var s=ee.devices[i],c=s.dpi[0]||s.dpi,E=s.dpi[1]||s.dpi;_=Math.round(r*z/c),n=Math.round(a*z/E),o=Math.round(s.bw)}var l=M.get("hmd_conf","b4w"),T=JSON.parse(l||"{}");e?(F.first_distortion=G,F.second_distortion=k,F.bevel_size=o||K,F.screen_width=_||B,F.screen_height=n||X,F.screen_lense=j,F.ipd=H,F.baseline=Q):(F.first_distortion="first_distortion"in T?parseFloat(T.first_distortion):G,F.second_distortion="second_distortion"in T?parseFloat(T.second_distortion):k,F.bevel_size="bevel_size"in T?parseFloat(T.bevel_size):o||K,F.screen_width="screen_width"in T?parseFloat(T.screen_width):_||B,F.screen_height="screen_height"in T?parseFloat(T.screen_height):n||X,F.screen_lense="screen_lense"in T?parseFloat(T.screen_lense):j,F.ipd="ipd"in T?parseFloat(T.ipd):H,F.baseline="baseline"in T?parseFloat(T.baseline):Q),D=!0}function v(){M.set("hmd_conf",JSON.stringify(F),"b4w"),l()}function m(){if(D){var e=Y.get_device_by_type_element(Y.DEVICE_HMD);e&&(Y.set_config(e,Y.HMD_DISTORTION,[F.first_distortion,F.second_distortion]),Y.get_value_param(e,Y.HMD_WEBVR_TYPE)&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE)&&(Y.set_config(e,Y.HMD_BEVEL_SIZE,F.bevel_size*V),Y.set_config(e,Y.HMD_SCREEN_WIDTH,F.screen_width*V),Y.set_config(e,Y.HMD_SCREEN_HEIGHT,F.screen_height*V),Y.set_config(e,Y.HMD_SCREEN_LENS_DIST,F.screen_lense*V),Y.set_config(e,Y.HMD_EYE_DISTANCE,F.ipd*V),Y.set_config(e,Y.HMD_BASELINE_DIST,F.baseline*V))),D=!1}}function O(e){var t=e.target.id,r=t.split("_"),a=r.splice(0,r.length-1).join("_");if(a in F&&F[a]!=e.target.value){D=!0,F[a]=e.target.value;document.getElementById(a+"_slider").value=e.target.value;document.getElementById(a+"_number").value=e.target.value}}function N(e,t){var r=document.createElement("div"),a=document.createElement("label");a.className="text_label";var _="8px";t%2&&(_="0"),a.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",a.textContent=e.label,r.appendChild(a),r.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+_+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;";for(var n=0;n<e.inputs.length;n++){var o=e.inputs[n],i=g(o);r.appendChild(i)}return r}function g(e){var t=document.createElement("div");t.className="row";var r=document.createElement("input");r.className="input_slider",r.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;",r.setAttribute("id",e.id+"_slider"),r.setAttribute("type","range"),r.setAttribute("min","0.00"),r.setAttribute("step",e.step),r.setAttribute("value",F[e.id]),r.setAttribute("max",e.max),t.appendChild(r);var a=document.createElement("input");return a.className="input_text",a.setAttribute("id",e.id+"_number"),a.setAttribute("type","number"),a.setAttribute("min","0.00"),a.setAttribute("step",e.step),a.setAttribute("value",F[e.id]),a.setAttribute("max",e.max),t.appendChild(a),a.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",y.is_ie11()?(r.onchange=O,a.onchange=O):(r.oninput=O,a.oninput=O),t}function h(){var e=document.createElement("div"),t=R(v,"SAVE","4px"),r=R(l,"CANCEL","4px"),a=R(T,"RESET","0px");return e.className="row",e.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;",e.appendChild(t),e.appendChild(r),e.appendChild(a),e}function R(e,t,r){var a=document.createElement("button");return a.onclick=e,a.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+r+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",a.innerHTML=t,a}var I=Object(n.a)(e),b=Object(o.a)(e),Y=Object(i.a)(e),L=Object(s.a)(e),M=Object(c.a)(e),y=Object(E.a)(e),x=!1,U=null,w=null,C=null,D=!0,F={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},G=.34,k=.55,K=4,B=110,X=65,j=50,H=64,Q=32,z=25.4,q=/iPad|iPhone|iPod/.test(navigator.platform),V=.001,W=0,J=1,Z={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:J,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:J,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:W,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},$=[{label:"Tray to lens-center distance.",is_mobile:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",is_mobile:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",is_mobile:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",is_mobile:!0,inputs:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",is_mobile:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",is_mobile:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];t.check=r,t.show=function(e){if(r()){var t=I.get_container();if(w=document.createElement("style"),w.innerHTML="."+e+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+e+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}",document.head.appendChild(w),!x){x=!0,p();var _=Y.get_device_by_type_element(Y.DEVICE_MOUSE,t);Y.switch_prevent_default(_,!1);var n=Y.get_device_by_type_element(Y.DEVICE_TOUCH,t);Y.switch_prevent_default(n,!1),U=document.createElement("div"),U.className=e,t.appendChild(U),C=document.createElement("div"),U.appendChild(C),C.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;";var o=a();C.appendChild(o);for(var i=Y.get_device_by_type_element(Y.DEVICE_HMD),s=0;s<$.length;s++)if(Y.get_value_param(i,Y.HMD_WEBVR_TYPE)&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE)||!$[s].is_mobile){var c=N($[s],s);C.appendChild(c)}var E=h();C.appendChild(E);var l=b.create_timeline_sensor();b.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",b.CT_CONTINUOUS,[l],null,m)}}},t.hide=l,t.reset=T,t.update=function(){p(),m()};var ee={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3}]}}var _=r(0),n=r(43),o=r(24),i=r(52),s=r(1),c=r(73),E=r(26),l=Object(_.a)("hmd_conf",a);t.a=l},function(e,t,r){"use strict";function a(e,t){function r(){x.length=0,U=0,w=a(100),C=new Float32Array(w.length),D=new Float32Array(w.length);var e=L.get_speaker_objects();if(e.length){x.push(_());for(var t=0;t<e.length;t++){var r=e[t];x.push(T(r))}x.sort(function(e,t){return"MASTER"==e.id?-1:"MASTER"==t.id?1:"COMPRESSOR"==e.id?-1:"COMPRESSOR"==t.id?1:e.id.toUpperCase()<t.id.toUpperCase()?-1:e.id.toUpperCase()>t.id.toUpperCase()?1:0})}}function a(e){for(var t=new Float32Array(e),r=0,a=0;a<e;a++)t[a]=20*Math.pow(1e3,r),r+=1/(e-1);return t}function _(){var e=l("MASTER"),t=L.get_compressor_params();return t&&(e.params.push(["THRESHOLD",t.threshold,-100,0,100,!1]),e.params.push(["KNEE",t.knee,0,40,40,!1]),e.params.push(["RATIO",t.ratio,1,20,20,!1]),e.params.push(["ATTACK",t.attack,0,1,1e3,!1]),e.params.push(["RELEASE",t.release,0,1,1e3,!1])),e.params.push(["VOLUME",L.get_volume(null),0,1,50,!1]),e.mute=L.is_muted(null)?1:0,e.solo=-1,e}function l(e){return{id:e,params:[],active_param:0,mute:-1,solo:-1,speaker:null}}function T(e){var t=l(b.get_object_name(e));return t.mute=L.is_muted(e)?1:0,t.solo=0,t.speaker=e,t}function u(e){if(x.length){1==e&&U<x.length-1?U++:-1==e&&U>0&&U--;for(var t=h(),r=t[0];r<=t[1];r++)d(x[r])}}function d(e){if(e.speaker){e.params.length=0;var t=L.get_positional_params(e.speaker);t&&(e.params.push(["DIST_REF",t.dist_ref,0,1e3,1e4,!1]),e.params.push(["ATTENUATION",t.attenuation,0,50,1e3,!1]),e.params.push(["DIST_MAX",t.dist_max,0,1e4,1e4,!1]));var r=L.get_filter_params(e.speaker);r&&(e.params.push(["EQ_FREQ",r.freq,20,2e4,100,!0]),e.params.push(["EQ_Q",r.Q,0,10,100,!1]),e.params.push(["EQ_GAIN",r.gain,-70,30,100,!1])),e.params.push(["VOLUME",L.get_volume(e.speaker),0,1,50,!1]),M.clamp(e.active_param,0,e.params.length-1)}}function f(e){var t=x[U];t&&(1==e&&t.active_param<t.params.length-1?t.active_param++:-1==e&&t.active_param>0&&t.active_param--)}function P(e){var t=x[U];if(t){var r=t.params[t.active_param];switch(r[5]?r[1]*=Math.pow(r[3]/r[2],e/r[4]):r[1]+=e*((r[3]-r[2])/r[4]),r[1]=M.clamp(r[1],r[2],r[3]),r[0]){case"VOLUME":"MASTER"!=t.id?L.set_volume(t.speaker,r[1]):L.set_volume(null,r[1]);break;case"DIST_REF":var a=L.get_positional_params(t.speaker);a.dist_ref=r[1],L.set_positional_params(t.speaker,a);break;case"ATTENUATION":var a=L.get_positional_params(t.speaker);a.attenuation=r[1],L.set_positional_params(t.speaker,a);break;case"DIST_MAX":var a=L.get_positional_params(t.speaker);a.dist_max=r[1],L.set_positional_params(t.speaker,a);break;case"EQ_FREQ":var _=L.get_filter_params(t.speaker);_.freq=r[1],L.set_filter_params(t.speaker,_);break;case"EQ_Q":var _=L.get_filter_params(t.speaker);_.Q=r[1],L.set_filter_params(t.speaker,_);break;case"EQ_GAIN":var _=L.get_filter_params(t.speaker);_.gain=r[1],L.set_filter_params(t.speaker,_);break;case"THRESHOLD":var n=L.get_compressor_params();n.threshold=r[1],L.set_compressor_params(n);break;case"KNEE":var n=L.get_compressor_params();n.knee=r[1],L.set_compressor_params(n);break;case"RATIO":var n=L.get_compressor_params();n.ratio=r[1],L.set_compressor_params(n);break;case"ATTACK":var n=L.get_compressor_params();n.attack=r[1],L.set_compressor_params(n);break;case"RELEASE":var n=L.get_compressor_params();n.release=r[1],L.set_compressor_params(n);break;default:I.error("Unknown strip param")}}}function A(){var e=x[U];e&&e.mute>=0&&S(e)}function S(e){"MASTER"!=e.id?0==e.mute?(e.mute=1,L.mute(e.speaker,!0),1==e.solo&&(e.solo=0,p(e)||m(e))):(e.mute=0,p(e)||L.mute(e.speaker,!1)):0==e.mute?(e.mute=1,L.mute(null,!0)):(e.mute=0,L.mute(null,!1))}function p(e){for(var t=0;t<x.length;t++){var r=x[t];if(r!=e&&1==r.solo)return!0}return!1}function v(e){for(var t=0;t<x.length;t++){var r=x[t];r!=e&&0==r.mute&&0==r.solo&&L.mute(r.speaker,!0)}}function m(e){for(var t=0;t<x.length;t++){var r=x[t];r!=e&&0==r.mute&&0==r.solo&&L.mute(r.speaker,!1)}}function O(){var e=x[U];e&&e.solo>=0&&N(e)}function N(e){0==e.solo?(e.solo=1,L.mute(e.speaker,!1),1==e.mute&&(e.mute=0),v(e)):(e.solo=0,p(e)?L.mute(e.speaker,!0):m(e))}function g(){if(x[U])for(var e=h(),t=e[0];t<=e[1];t++){var r=x[t];if(Y.draw_mixer_strip(r.id,t==U,t%8,r.params,r.active_param,r.mute,r.solo),r.speaker&&L.get_filter_params(r.speaker)){L.get_filter_freq_response(r.speaker,w,C,D);for(var a=0;a<C.length;a++){var _=C[a];C[a]=20*Math.log(_)/Math.LN10}Y.plot_array("EQ",t%8,C,20,2e4,-10,10)}}}function h(){if(0==x.length)return[0,-1];var e=8*Math.floor(U/8),t=e+7;return e=M.clamp(e,0,x.length-1),t=M.clamp(t,0,x.length-1),[e,t]}var R=Object(n.a)(e),I=Object(o.a)(e),b=Object(i.a)(e),Y=Object(s.a)(e),L=Object(c.a)(e),M=Object(E.a)(e),y=["SWITCH_STRIP","SWITCH_STRIP_HOLD","SWITCH_PARAM","INC_DEC","INC_DEC_HOLD","MUTE_SOLO"],x=[],U=0,w=null,C=null,D=null;t.enable_mixer_controls=function(){r();var e=R.create_keyboard_sensor(R.KEY_NUM4),t=R.create_keyboard_sensor(R.KEY_NUM6),a=R.create_keyboard_sensor(R.KEY_NUM8),_=R.create_keyboard_sensor(R.KEY_NUM2),n=R.create_keyboard_sensor(R.KEY_ADD),o=R.create_keyboard_sensor(R.KEY_SUB),i=R.create_keyboard_sensor(R.KEY_NUM7),s=R.create_keyboard_sensor(R.KEY_NUM9),c=R.create_timer_sensor(.15,!0),E=R.create_timer_sensor(.05,!0),l=[e,t,c],T=function(e){return e[0]||e[1]},S=function(e){return(e[0]||e[1])&&e[2]},p=function(e,t,r){if(1==r){u(Boolean(R.get_sensor_value(e,t,0))?-1:1),"SWITCH_STRIP"==t?R.reset_timer_sensor(e,t,2,.15+.3):R.reset_timer_sensor(e,t,2,.15)}else R.reset_timer_sensor(e,t,2,10)};R.create_sensor_manifold(null,"SWITCH_STRIP",R.CT_TRIGGER,l,T,p),R.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",R.CT_SHOT,l,S,p);var v=[a,_],m=function(e){return e[0]||e[1]},N=function(e,t,r){f(Boolean(R.get_sensor_value(e,t,0))?-1:1)};R.create_sensor_manifold(null,"SWITCH_PARAM",R.CT_SHOT,v,m,N);var I=[o,n,E],b=function(e,t,r){if(1==r){P(Boolean(R.get_sensor_value(e,t,0))?-1:1),"INC_DEC"==t?R.reset_timer_sensor(e,t,2,.35):R.reset_timer_sensor(e,t,2,.05)}else R.reset_timer_sensor(e,t,2,10)},Y=function(e){return e[0]||e[1]},L=function(e){return(e[0]||e[1])&&e[2]};R.create_sensor_manifold(null,"INC_DEC",R.CT_TRIGGER,I,Y,b),R.create_sensor_manifold(null,"INC_DEC_HOLD",R.CT_SHOT,I,L,b);var M=[i,s],y=function(e,t,r){Boolean(R.get_sensor_value(e,t,0))?A():O()},U=function(e){return e[0]||e[1]};R.create_sensor_manifold(null,"MUTE_SOLO",R.CT_SHOT,M,U,y);var w=R.create_elapsed_sensor();R.create_sensor_manifold(null,"MIXER_DRAW",R.CT_CONTINUOUS,[w],null,function(){g()});var C=R.create_timer_sensor(1,!0);R.create_sensor_manifold(null,"MIXER_UPDATE",R.CT_TRIGGER,[C],null,function(){for(var e=h(),t=e[0];t<=e[1];t++)d(x[t])})},t.disable_mixer_controls=function(){for(var e=0;y.length;e++)R.remove_sensor_manifold(null,y[e])}}var _=r(0),n=r(24),o=r(1),i=r(31),s=r(53),c=r(89),E=r(26),l=Object(_.a)("mixer",a);t.a=l},function(e,t,r){"use strict";function a(e,t){function r(){H==D&&(H=C);var e=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof e&&e.apply(document),R.remove_sensor_manifold(Y.get_active_camera(),"SMOOTH_PL")}function a(e,t,a,_){if(H!=F){H=F,r(),X=t||function(){return!0},a=a||A,z=Boolean(_),e.addEventListener("mousedown",d,!1),e.addEventListener("mouseup",f,!1);var n=Y.get_active_camera();if(!R.check_sensor_manifold(n,"SMOOTH_DRAG")){var o=R.create_elapsed_sensor();R.create_sensor_manifold(n,"SMOOTH_DRAG",R.CT_CONTINUOUS,[o],null,P,a)}}}function _(e){H==F&&(H=C),e.removeEventListener("mousedown",d,!1),e.removeEventListener("mouseup",f,!1),e.removeEventListener("mousemove",u,!1),R.remove_sensor_manifold(Y.get_active_camera(),"SMOOTH_DRAG")}function u(e){if(X()){if(z)var t=h.get_coords_target_space(e,B);else{var t=B;t[0]=e.clientX,t[1]=e.clientY}K[0]+=(t[0]-G)*x,K[1]+=(t[1]-k)*x,G=t[0],k=t[1]}e.preventDefault()}function d(e){if(z)var t=h.get_coords_target_space(e,B);else{var t=B;t[0]=e.clientX,t[1]=e.clientY}G=t[0],k=t[1],e.currentTarget.addEventListener("mousemove",u,!1),e.preventDefault()}function f(e){e.currentTarget.removeEventListener("mousemove",u,!1),e.preventDefault()}function P(e,t,r,a){if(Math.abs(K[0])>.01||Math.abs(K[1])>.01){var _=R.get_sensor_value(e,t,0),n=L.smooth(K[0],0,_,N()),o=L.smooth(K[1],0,_,N());K[0]-=n,K[1]-=o,a(-n*y,-o*y)}}function A(e,t){var r=Y.get_first_character(),a=Y.get_active_camera();if(g.rotate_camera(a,e,t),r){var _=g.get_camera_angles_char(a,B);I.set_character_rotation_h(r,_[0]),I.set_character_vert_move_dir_angle(r,_[1])}}function S(e){if(Q=Boolean(e),!M.detect_mobile()){h.get_canvas().addEventListener("mousemove",v)}}function p(){if(!M.detect_mobile()){h.get_canvas().removeEventListener("mousemove",v),j&&Y.set_outline_intensity(j,0)}}function v(e){if(Q)var t=h.get_coords_target_space(e,!1,B),r=Y.pick_object(t[0],t[1]);else var r=Y.pick_object(e.clientX,e.clientY);r?(Y.outlining_is_enabled(r)&&Y.set_outline_intensity(r,1),Y.outlining_is_enabled(j)&&r!=j&&Y.set_outline_intensity(j,0)):Y.outlining_is_enabled(j)&&Y.set_outline_intensity(j,0),j=r}function m(e,t,r){if(r)return h.get_coords_target_space(e,t,B)[0];if("clientX"in e)return e.clientX;if("touchend"==e.type)var a=e.changedTouches;else var a=t?e.targetTouches:e.touches;return a&&a[0]&&"clientX"in a[0]?a[0].clientX:-1}function O(e,t,r){if(r)return h.get_coords_target_space(e,t,B)[1];if("clientY"in e)return e.clientY;if("touchend"==e.type)var a=e.changedTouches;else var a=t?e.targetTouches:e.touches;return a&&a[0]&&"clientY"in a[0]?a[0].clientY:-1}function N(){return w*U}var g=Object(n.a)(e),h=Object(o.a)(e),R=Object(i.a)(e),I=Object(s.a)(e),b=Object(c.a)(e),Y=Object(E.a)(e),L=Object(l.a)(e),M=Object(T.a)(e),y=4e-4,x=2,U=1,w=.1,C=0,D=1,F=2,G=0,k=0,K=new Float32Array(2),B=new Float32Array(2),X=null,j=null,H=C,Q=!1,z=!1;t.request_pointerlock=function(e,t,r,a,n,o){function i(){if(document.pointerLockElement===e||document.webkitPointerLockElement===e||document.mozPointerLockElement===e){_(e),e.addEventListener("mousemove",a,!1);var n=Y.get_active_camera();if(!R.check_sensor_manifold(n,"SMOOTH_PL")){var s=R.create_elapsed_sensor();R.create_sensor_manifold(n,"SMOOTH_PL",R.CT_CONTINUOUS,[s],null,P,o)}t()}else e.removeEventListener("mousemove",a,!1),H=C,document.removeEventListener("pointerlockchange",i,!1),document.removeEventListener("webkitpointerlockchange",i,!1),document.removeEventListener("mozpointerlockchange",i,!1),r()}if(H!=D){H=D,t=t||function(){},r=r||function(){},o=o||A,n=n||function(){return!0},a=a||function(e){if(n()){if("number"==typeof e.movementX)var t=e.movementX,r=e.movementY;else if("number"==typeof e.webkitMovementX)var t=e.webkitMovementX,r=e.webkitMovementY;else if("number"==typeof e.mozMovementX)var t=e.mozMovementX,r=e.mozMovementY;else var t=0,r=0;K[0]+=t,K[1]+=r}},document.addEventListener("pointerlockchange",i,!1),document.addEventListener("webkitpointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1);var s=e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock;"function"===typeof s?s.apply(e):b.error("Pointer lock is not available")}},t.exit_pointerlock=r,t.check_pointerlock=function(e){return"function"===typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)},t.request_mouse_drag=a,t.exit_mouse_drag=_,t.enable_mouse_hover_outline=S,t.disable_mouse_hover_outline=p,t.get_coords_x=m,t.get_coords_y=O,t.set_plock_smooth_factor=function(e){U=e},t.get_plock_smooth_factor=function(){return U}}var _=r(0),n=r(36),o=r(43),i=r(24),s=r(57),c=r(1),E=r(31),l=r(26),T=r(64),u=Object(_.a)("mouse",a);t.a=u},function(e,t,r){"use strict";function a(e,t){function r(){return{obj:null,rig:null,collider:null,empty:null,type:$,state:re,actions:{},base_pos:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],fired:[],delay:[],random:!0,reached:!0,ground_level:0,vert_correction:0,vert_cor_water:0,rotation_mult:1,speed:1,rot_speed:.1,max_height:0,min_height:0,max_depth:0,min_depth:0}}function a(e,t){var r=t.destination,a=t.base_pos,n=z;K.get_translation(t.collider,n);var o=0,i=n[2];switch(r[2]=i,t.type){case $:if(t.random&&t.reached&&(r[0]=(12*Math.random()-6)*t.speed+a[0],r[1]=-(12*Math.random()-6)*t.speed+a[1],_(t,r,n),t.reached=!1),t.ground_level){o=t.ground_level-i;var s=t.speed*e;o>s?o=s:o<-s&&(o=-s)}t.vert_correction=o;break;case ee:case te:if(t.vert_cor_water?o=t.vert_cor_water:t.vert_correction&&(o=t.vert_correction,t.type==te&&(o*=e)),t.random&&t.reached){if(t.type==te){t.speed=Math.random()+.1;var c=t.max_depth-t.min_depth}else var c=t.max_height-t.min_height;r[0]=10*Math.random()-5+a[0],r[1]=10*Math.random()-5+a[1],r[2]=i-(Math.random()*c-.5*c),t.reached=!1}}o&&(r[2]=i+o),f(e,t)}function _(e,t,r){var a=J,_=q,n=e.speed,o=e.rot_speed;K.get_rotation(e.collider,a),l.transformQuat(j.AXIS_MY,a,_),_[2]=0,l.normalize(_,_);var i=Math.sin(o/2),s=.5*n/i,c=l.dist(t,r);c<2*s&&l.scaleAndAdd(t,_,2*s-c,t)}function f(e,t){var r=Q,a=z,_=q,n=Z,o=t.rig,i=t.collider,s=t.destination,c=t.speed,E=t.actions,l=D.get_current_anim_name(o);if(!D.is_play(o)||!E.idle||-1==E.idle.indexOf(l)){K.get_translation(i,r);var T=s[0]-r[0],u=s[1]-r[1],d=Math.sqrt(T*T+u*u);d>2*c*e?(t.state=ae,j.horizontal_direction(s,r,_),C(t,s,d,_),P(t,a,e,n,_),A(t,a,e,n),K.set_rotation_v(i,n),S(e,n,t,r,s)):t.type==$?E.move&&l&&-1!=E.move.indexOf(l)&&D.is_play(o)?t.state=ae:(t.state=re,t.reached=!0):t.type!=te&&t.type!=ee||(t.reached=!0),I(t)&&b(t)}}function P(e,t,r,a,_){var n=J,o=V;K.get_rotation(e.collider,n),l.transformQuat(j.AXIS_MY,n,t),o[0]=t[0],o[1]=t[1],o[2]=0,l.normalize(o,o);var s=l.dot(o,_),c=Math.acos(s),E=Math.abs(c)/Math.PI,T=r/E*e.rot_speed*e.rotation_mult;if(i.rotationTo(o,_,a),i.rotationTo(j.AXIS_MY,o,n),Math.abs(s)>=1)return void i.copy(n,a);i.multiply(a,n,a),i.slerp(n,a,Math.min(T,1),a)}function A(e,t,r,a){if(e.type!=ee){r=Math.max(r,1/60);var _=W,n=J,o=Math.asin(-t[2]);i.setAxisAngle(j.AXIS_X,-o,n);var s=e.speed*r,c=e.vert_correction,E=Math.atan(c/s);i.setAxisAngle(j.AXIS_X,-E,_),i.slerp(n,_,r,_),i.multiply(a,_,a)}}function S(e,t,r,a,_){var n=q,o=V,i=j.AXIS_MY;j.quat_to_dir(t,i,n),l.scale(n,r.speed*e,o),l.add(o,a,o),r.type!=$?o[2]=(_[2]-a[2])*e*.1+a[2]:o[2]=_[2],K.set_translation_v(r.collider,o)}function p(e,t){if(G.is_visible(e.obj))if(e.random)a(t,e);else{for(var r=k.get_timeline(),_=0;_<e.path.length;_++)if(!e.ended[_]){if(e.fired[_]||(e.fired[_]=!0,e.destination[0]=e.path[_][0],e.destination[1]=e.path[_][1],e.destination[2]=e.path[_][2],e.start[_]=r+e.delay[_]),r<e.start[_])break;a(t,e),e.ended[_]=e.reached;break}m(e)&&v(e)}}function v(e){for(var t=0;t<e.path.length;t++)e.fired[t]=!1,e.ended[t]=!1}function m(e){for(var t=0;t<e.path.length;t++)if(0==e.ended[t])return!1;return!0}function O(e,t,r,a){if(a)if(1==r)switch(a.type){case ee:var _=100*N(e,t);_<a.min_height?a.vert_correction=10:_>a.max_height?a.vert_correction=-10:a.vert_correction=0;break;case $:var n=F.get_sensor_payload(e,t,0);a.ground_level=n.hit_pos[2];break;case te:var n=F.get_sensor_payload(e,t,0);"CLOSE_GROUND"==t?(a.vert_correction=100*n.hit_fract-1,a.vert_correction<.1?a.vert_correction=.05:a.vert_correction=0):"CLOSE_WATER"==t&&(a.vert_cor_water=100*n.hit_fract,a.vert_cor_water<a.min_depth?a.vert_cor_water=-.02:a.vert_cor_water>a.max_depth?a.vert_cor_water=.02:a.vert_cor_water=0)}else a.vert_correction=0}function N(e,t){for(var r=0;r<3;r++){var a=F.get_sensor_payload(e,t,r).hit_fract;if(a)return a}}function g(){for(var e=0;e<H.length;e++){var t=H[e];h(t),R(t),D.get_current_anim_name(t.rig)&&D.play(t.rig)}}function h(e){var t=l.create(),r=e.collider;switch(e.type){case ee:var a=F.create_ray_sensor(r,t,[0,0,-100],"TERRAIN",!0,!0),_=F.create_ray_sensor(r,t,[0,0,-100],"STONE",!0,!0),n=F.create_ray_sensor(r,t,[0,0,-100],"WATER",!0,!0),o=[a,_,n];F.create_sensor_manifold(r,"CLOSE_GROUND",F.CT_CONTINUOUS,o,function(e){return e[0]||e[1]||e[2]},O,e);break;case $:var a=F.create_ray_sensor(r,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),o=[a];F.create_sensor_manifold(r,"CLOSE_GROUND",F.CT_CONTINUOUS,o,null,O,e);break;case te:var a=F.create_ray_sensor(r,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),n=F.create_ray_sensor(r,t,[0,0,100],"WATER",!0,!0),o=[a],i=[n];F.create_sensor_manifold(r,"CLOSE_WATER",F.CT_CONTINUOUS,i,null,O,e),F.create_sensor_manifold(r,"CLOSE_GROUND",F.CT_CONTINUOUS,o,null,O,e)}}function R(e){function t(t,r,a){1==a?(l.copy(e.base_pos,e.destination),e.rotation_mult=4):e.rotation_mult=1}var r=e.collider;if(e.type==$){var a=F.create_collision_sensor(r,"CONSTRUCTION",!1);F.create_sensor_manifold(r,"CONSTRUCTION_COLL",F.CT_CONTINUOUS,[a],null,t)}}function I(e){var t=e.rig;if(!D.is_play(t))return!0;var r=D.get_current_anim_name(t);if(!r)return!0;var a=e.actions;switch(e.state){case re:if(!a.idle)return!1;if(-1==a.idle.indexOf(r))return!0;break;case ae:if(!a.move)return!1;if(-1!=a.move.indexOf(r))return!1;if(a.move_start&&-1!=a.move_start.indexOf(r))return!1;if(a.move_blends&&-1!=a.move_blends.indexOf(r))return!1;break;default:return!1}return!0}function b(e){var t=e.rig;if(!D.is_play(t)){var r=null;switch(e.state){case re:r=Y(e);break;case ae:r=L(e)}r&&(D.apply(t,r),D.set_behavior(t,D.AB_FINISH_RESET),D.set_frame(t,0),D.play(t))}}function Y(e){var t=e.actions;return t.idle?j.random_from_array(t.idle):null}function L(e){var t=D.get_current_anim_name(e.rig),r=e.actions;return y(e,t)?U(e,t):M(e,t)?w(e,t):x(e,t)?j.random_from_array(r.move_start):null}function M(e,t){var r=e.actions;return!!r.move&&(-1!=r.move.indexOf(t)||(!r.move_blends&&!r.move_start||(!r.move_start&&!t||(!(!r.move_blends||-1==r.move_blends.indexOf(t))||!(!r.move_start||-1==r.move_start.indexOf(t))))))}function y(e,t){var r=e.actions;if(!r.move_blends)return!1;if(-1!=r.move_blends.indexOf(t))return!1;if(r.move&&-1!=r.move.indexOf(t)){return Math.random()>.33}return!1}function x(e,t){var r=e.actions;return!!r.move_start&&(-1==r.move_start.indexOf(t)&&!(!r.move||-1!=r.move.indexOf(t)))}function U(e,t){var r=e.actions,a=r.move.indexOf(t);return r.move_blends[a]}function w(e,t){var r=e.actions;if(!r.move_blends)return j.random_from_array(r.move);var a=r.move_blends.indexOf(t);if(-1!=a){var _=a+1;return _=_<r.move.length?_:0,r.move[_]}return-1!=r.move.indexOf(t)?t:j.random_from_array(r.move)}function C(e,t,r,a){var _=e.rig;if(D.is_animated(_)){var n=e.speed,o=r,i=D.get_frame(_),s=D.get_anim_length(_),c=s/24*n,E=(1-i/s)*c;if(o/E<.9){var T=E-o;l.scaleAndAdd(t,a,T,t)}}}var D=Object(n.a)(e),F=Object(o.a)(e),G=Object(s.a)(e),k=Object(c.a)(e),K=Object(E.a)(e),B=Object(T.a)(e),X=Object(u.a)(e),j=Object(d.a)(e),H=[],Q=new Float32Array(3),z=new Float32Array(3),q=new Float32Array(3),V=new Float32Array(3),W=new Float32Array(4),J=new Float32Array(4),Z=new Float32Array(4),$=t.NT_WALKING=10,ee=t.NT_FLYING=20,te=t.NT_SWIMMING=30,re=10,ae=20;t.new_event_track=function(e){var t=r();if("object"!=typeof e.obj)return void X.error("Can't create event track. Wrong object.");if("object"!=typeof e.rig)return void X.error("Can't create event track. Wrong rig object.");if("object"!=typeof e.collider||!B.has_physics(e.collider))return void X.error("Can't create event track. Wrong collider object.");if(t.obj=e.obj,t.collider=e.collider,t.rig=e.rig,K.get_translation(e.collider,t.base_pos),"object"==typeof e.actions&&(t.actions=e.actions),"boolean"==typeof e.random&&(t.random=e.random),"number"==typeof e.type&&(t.type=e.type),"number"==typeof e.speed&&(t.speed=e.speed),"number"==typeof e.rot_speed&&(t.rot_speed=e.rot_speed),"number"==typeof e.max_height&&(t.max_height=e.max_height),"number"==typeof e.min_height&&(t.min_height=e.min_height),!t.random){for(var a=0;a<e.path.length;a++)t.start[a]=-1,t.ended[a]=!1,t.fired[a]=!1;t.path=e.path,t.delay=e.delay}var _=e.actions,n=D.get_current_anim_name(t.rig);for(var o in _)for(var i=_[o],s=0;s<i.length;s++)D.apply(t.rig,i[s]);n&&D.apply(t.rig,n),H.push(t)},t.enable_animation=function(){if(H.length){g();var e=function(e,t,r){if(1==r)for(var a=F.get_sensor_value(e,t,0),_=0;_<H.length;_++)p(H[_],a)},t=F.create_elapsed_sensor();F.create_sensor_manifold(H[0].collider,"ELAPSED",F.CT_CONTINUOUS,[t],function(e){return e[0]},e)}},t.disable_animation=function(){if(!(H.length<=0))for(var e=0;e<H.length;e++){var t=H[e];F.check_sensor_manifolds(t.collider)&&F.remove_sensor_manifold(t.collider),D.is_play(t.rig)&&D.stop(t.rig)}}}var _=r(0),n=r(90),o=r(24),i=r(8),s=r(31),c=r(72),E=r(44),l=r(3),T=r(57),u=r(1),d=r(26),f=Object(_.a)("npc_ai",a);t.a=f},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a={},_=null;t.create_preloader=function(e){var t="#484848",_="#5276cf",n="rgba(150, 150, 150, 0.7)",o="#fff";for(var i in e)switch(i){case"container_color":t=e.container_color;break;case"bar_color":_=e.bar_color;break;case"frame_color":n=e.frame_color;break;case"font_color":o=e.font_color}var s=document.createElement("div"),c=s.cloneNode(!1),E=s.cloneNode(!1),l=s.cloneNode(!1),T=r.get_container();E.appendChild(c),E.appendChild(l),s.appendChild(E),T.appendChild(s),s.style.cssText="background-color: "+t+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;",E.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+n+";border: 2px solid "+n+";",c.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+_+";height: 100%;",l.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+n+";color: "+o+";",a.bar=c,a.caption=l,a.container=s,a.type="DEFAULT"},t.create_simple_preloader=function(e){var t=null,r=null,n="#bf9221",o="#000";for(var i in e)switch(i){case"canvas_container_id":t=e.canvas_container_id;break;case"background_container_id":r=e.background_container_id;break;case"bg_color":o=e.bg_color;break;case"bar_color":n=e.bar_color;break;case"preloader_fadeout":a.fadeout=e.preloader_fadeout}var s=document.createElement("div"),c=document.createElement("div");s.id="simple_preloader_container";var E=document.createElement("div"),l=document.createElement("div"),T=document.getElementById(r);_=document.getElementById(t),s.style.cssText="z-index: 4;background-color: "+o+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",c.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;",E.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+n+";border-radius: 0px;",l.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+c.appendChild(E),c.appendChild(l),s.appendChild(c),document.body.appendChild(s),a.type="SIMPLE",a.container=s,a.bar=E,a.caption=l,a.background=T},t.create_rotation_preloader=function(e){var t=null,r=null,n="rgba(0,0,0,0)",o="",i="",s="rgba(0,0,0,0)";for(var c in e)switch(c){case"canvas_container_id":t=e.canvas_container_id;break;case"background_container_id":r=e.background_container_id;break;case"frame_bg_color":n=e.frame_bg_color;break;case"bg_color":s=e.bg_color;break;case"frame_class":o=e.frame_class;break;case"anim_elem_class":i=e.anim_elem_class}var E=document.createElement("div"),l=document.createElement("div"),T=document.createElement("div"),u=document.createElement("div"),d=document.getElementById(r);_=document.getElementById(t),E.style.cssText="z-index: 4;background-color: "+s+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",l.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+n+";",T.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;",u.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;",T.className=i,l.appendChild(T),l.className=o,l.appendChild(u),E.appendChild(l),_.appendChild(E),a.type="ROTATION",a.container=E,a.anim_elem=T,a.caption=u,a.background=d},t.create_advanced_preloader=function(e){var t=e.img_width,r=e.preloader_width,n=e.canvas_container_id,o=r-t,i=r/o,s=document.getElementById(e.preloader_bar_id),c=document.getElementById(e.fill_band_id),E=document.getElementById(e.preloader_caption_id),l=document.getElementById(e.preloader_container_id),T=document.getElementById(e.background_container_id);_=document.getElementById(n),a.type="ADVANCED",a.bar=s,a.fill=c,a.ratio=i,a.caption=E,a.container=l,a.background=T},t.update_preloader=function(e){a.caption.innerHTML=e+"%","SIMPLE"==a.type?a.bar.style.width=e+"%":"ADVANCED"==a.type?(a.bar.style.width=e/a.ratio+"%",a.fill.style.width=100-e+"%"):"ROTATION"==a.type?a.anim_elem.style.transform="rotate("+e+"deg)":"DEFAULT"==a.type&&(a.bar.style.width=e+"%"),100==e&&(a.container.parentNode.removeChild(a.container),a.background&&a.background.parentNode.removeChild(a.background))}}var _=r(0),n=r(43),o=Object(_.a)("preloader",a);t.a=o},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e);t.shot=function(e,t){a.error_deprecated("shot","screen.shot"),r.shot(e,t)}}var _=r(0),n=r(53),o=r(1),i=Object(_.a)("screenshooter",a);t.a=i},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e);t.attach_move_cb=r.attach_move_cb,t.detach_move_cb=r.detach_move_cb,t.is_anchor=r.is_anchor,t.get_element_id=r.get_element_id,t.update=function(){r.update(!0)}}var _=r(0),n=r(58),o=Object(_.a)("anchors",a);t.a=o},function(e,t,r){"use strict";function a(e,t){var r=Object(o.a)(e),a=Object(i.a)(e),_=Object(s.a)(e);t.get_bone_tsr=function(e,t,a){return r.is_armature(e)?n.a(e,t)?(a||(a=c.b()),n.b(e,t,!1,!1,a),a):(_.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},t.get_bone_tsr_rel=function(e,t,a){return r.is_armature(e)?n.a(e,t)?(a||(a=c.b()),n.b(e,t,!1,!0,a),a):(_.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},t.set_bone_tsr=function(e,t,o){if(r.is_armature(e)){if(!n.a(e,t))return void _.error('There is no bone: "',t,'" in "',e.name,'".');n.c(e,t,o,!1),a.update_transform(e)}},t.set_bone_tsr_rel=function(e,t,o){if(r.is_armature(e)){if(!n.a(e,t))return void _.error('There is no bone: "',t,'" in "',e.name,'".');n.c(e,t,o,!0),a.update_transform(e)}}}var _=r(0),n=r(59),o=r(9),i=r(13),s=r(1),c=r(6),E=Object(_.a)("armature",a);t.a=E},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e);t.AT_ARRAYBUFFER=r.AT_ARRAYBUFFER,t.AT_ARRAYBUFFER_ZIP=r.AT_ARRAYBUFFER_ZIP,t.AT_JSON=r.AT_JSON,t.AT_JSON_ZIP=r.AT_JSON_ZIP,t.AT_TEXT=r.AT_TEXT,t.AT_AUDIOBUFFER=r.AT_AUDIOBUFFER,t.AT_IMAGE_ELEMENT=r.AT_IMAGE_ELEMENT,t.AT_AUDIO_ELEMENT=r.AT_AUDIO_ELEMENT,t.AT_VIDEO_ELEMENT=r.AT_VIDEO_ELEMENT,t.AT_SEQ_VIDEO_ELEMENT=r.AT_SEQ_VIDEO_ELEMENT,t.enqueue=function(e,t,a,_){e.length&&r.enqueue(e,t,a,_)}}var _=r(0),n=r(47),o=Object(_.a)("assets",a);t.a=o},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),E=Object(s.a)(e);t.extract_vertex_array=function(e,t,n){if(!a.has_dyn_geom(e))return _.error("Wrong object:",e.name),null;var o=r.find_batch_material(e,t,"MAIN");if(o){var i=o.bufs_data;return i&&i.pointers&&("a_normal"==n&&i.pointers.a_tbn||i.pointers[n])?a.extract_array_float(i,n):(_.error("Attribute not found:"+n),null)}return _.error("Wrong material:",t),null},t.extract_index_array=function(e,t){if(!a.has_dyn_geom(e))return _.error("Wrong object:",e.name),null;var n=r.find_batch_material(e,t,"MAIN");if(n){var o=n.bufs_data;return o&&o.pointers?o.ibo_array:(_.error("Buffer data not found"),null)}return _.error("Wrong material:",t),null},t.update_vertex_array=function(e,t,n,o){if(!a.has_dyn_geom(e))return void _.error("Wrong object:",e.name);for(var i=["MAIN","SHADOW","COLOR_ID"],s=0;s<i.length;s++){var c=i[s],E=r.find_batch_material(e,t,c);if(E){var l=E.bufs_data;l&&l.pointers&&("a_normal"==n&&l.pointers.a_tbn||l.pointers[n])&&a.update_bufs_data_array(l,n,0,o)}}},t.override_geometry=function(e,t,n,o,i){if(!a.has_dyn_geom(e))return void _.error("Wrong object:",e.name);if(!(n instanceof Uint16Array)&&!(n instanceof Uint32Array))return void _.error("Wrong ibo_array type");if(!(o instanceof Float32Array))return void _.error("Wrong positions_array type");for(var s=["MAIN","SHADOW","COLOR_ID"],l=0;l<s.length;l++){var T=s[l],u=r.find_batch_material(e,t,T);if(u){var d=u.bufs_data;if(d){a.update_bufs_data_index_array(d,u.draw_mode,n);var f={};for(var P in d.pointers){var A=d.pointers[P],S=o.length/3*A.num_comp,p=a.get_vbo_type_by_attr_name(P);f[p]||(f[p]=0),f[p]+=S}var v=a.init_vbo_source_data(f);d.vbo_source_data=v;var m={};for(var P in d.pointers){var A=d.pointers[P],p=a.get_vbo_type_by_attr_name(P);switch(m[p]||(m[p]=0),P){case"a_position":a.vbo_source_data_set_attr(d.vbo_source_data,"a_position",o,m[p]),A.offset=m[p],A.length=o.length,m[p]+=A.length;break;case"a_tbn":var O;i&&(O=a.calc_shared_indices(n,o,o));var N=a.calc_normals(n,o,O);A.length=o.length/3*A.num_comp;for(var g=new Float32Array(A.length),h=0;h<g.length;h+=4)g[h]=1,g[h+3]=1;var R=c.d(N,g);a.vbo_source_data_set_attr(d.vbo_source_data,"a_tbn",R,m[p]),A.offset=m[p],m[p]+=A.length;break;default:A.offset=m[p],A.length=o.length/3*A.num_comp;var I=a.get_constructor_by_type(p),b=new I(A.length);a.vbo_source_data_set_attr(d.vbo_source_data,P,b,m[p]),m[p]+=A.length}}a.update_gl_buffers(d),E.assign_attribute_setters(u);var Y=r.find_batch_material_forked(e,u);Y&&Y.bufs_data&&(Y.bufs_data=d)}}}},t.set_shape_key_value=function(e,t,r){if(!a.check_shape_keys(e))return void _.error("Wrong object:",e.name);if(!a.has_shape_key(e,t))return void _.error("Wrong key name:",t);var n=parseFloat(r);a.apply_shape_key(e,t,n)},t.check_shape_keys=function(e){return a.check_shape_keys(e)},t.get_shape_keys_names=function(e){return a.check_shape_keys(e)?a.get_shape_keys_names(e):(_.error("Wrong object:",e.name),[])},t.get_shape_key_value=function(e,t){return a.check_shape_keys(e)?a.has_shape_key(e,t)?a.get_shape_key_value(e,t):(_.error("Wrong key name:",t),0):(_.error("Wrong object:",e.name),0)},t.draw_line=function(e,t,n){if(n=n||!1,!(t instanceof Float32Array))return void _.error("Wrong positions type");var o=r.get_first_batch(e);o&&(a.draw_line(o,t,n),E.assign_attribute_setters(o))}}var _=r(0),n=r(16),o=r(20),i=r(1),s=r(22),c=r(39),E=Object(_.a)("geometry",a);t.a=E},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e);t.draw_mixer_strip=function(e,t,_,n,o,i,s){a.error_deprecated("draw_mixer_strip","screen.draw_mixer_strip"),r.draw_mixer_strip(e,t,_,n,o,i,s)},t.plot_array=function(e,t,_,n,o,i,s){a.error_deprecated("plot_array","screen.plot_array"),r.plot_array(e,t,_,n,o,i,s)}}var _=r(0),n=r(54),o=r(1),i=Object(_.a)("hud",a);t.a=i},function(e,t,r){"use strict";function a(e,t){function r(){for(var e=v.get_active(),t=A.get_scene_objs(e,"LAMP",A.DATA_ID_ALL),r=null,a=0;a<t.length;a++){var _=t[a];if("SUN"==_.light.type){r=_;break}}if(r){var n=r.light.direction,o=u._39(Math.atan2(-n[1],n[0]))+90;o>180&&(o-=360);var i=u._39(Math.atan2(n[2],Math.sqrt(n[0]*n[0]+n[1]*n[1]))),s={};return s.hor_position=o,s.vert_position=i,s}return null}function a(e){for(var t=v.get_active(),r=A.get_scene_objs(t,"LAMP",A.DATA_ID_ALL),a=0;a<r.length;a++){var _=r[a];if("SUN"==_.light.type){var o=_;break}}if(!o)return void p.error("There is no sun on the scene");if("number"==typeof e.hor_position&&"number"==typeof e.vert_position){var i=u.T(180-e.hor_position),s=u.T(90-e.vert_position),c=o.render;m.set_rotation_euler(o,[s,0,i]);var E=new Float32Array(3),l=T.g(c.world_tsr,R);u._34(l,u.f,E);var f=T.j(c.world_tsr,h),P=d.length(f);d.copy(E,O),d.scale(O,P,O),m.set_translation(o,O),m.update_transform(o);var S=o.light;if(S.dynamic_intensity){var N=t.world.light_settings.environment_energy,g=t.world.horizon_color,I=t.world.zenith_color,b=Math.cos(Math.abs(s)),Y=Math.max(Math.min(3*b,1),0)*S.default_energy,L=Math.max(b,.1)*N;n.d(S,Y),v.set_environment_colors(t,L,g,I)}v.update_lamp_scene(o,t)}}function _(e){for(var t=v.get_active(),r=A.get_scene_objs(t,"LAMP",A.DATA_ID_ALL),a=0;a<r.length;a++){var _=r[a];if("SUN"==_.light.type){var n=_;break}}if(!n)return void p.error("There is no sun on the scene");P(e)}function f(e){return S.is_lamp(e)?e.light.type:(p.error("get_light_type(): Wrong object"),"")}function P(e){var t=e<12?15*e:15*(e-24),r=-Math.cos(e/12*Math.PI)*g,_={};_.hor_position=t,_.vert_position=r,a(_)}var A=Object(o.a)(e),S=Object(i.a)(e),p=Object(s.a)(e),v=Object(E.a)(e),m=Object(l.a)(e),O=new Float32Array(3),N={},g=60,h=d.create(),R=c.create();t.get_lamps=function(e){var t=v.get_active(),r=A.get_scene_objs(t,"LAMP",A.DATA_ID_ALL);if(!e)return r;for(var a=[],_=0;_<r.length;_++){var n=r[_];n.light.type===e&&a.push(n)}return a},t.get_sun_params=r,t.set_sun_params=a,t.set_day_time=_,t.set_date=function(e){return N.y=e.getFullYear(),N.m=e.getMonth(),N.d=e.getDate(),N.y?1582==N.y&&9==N.m&&N.d>4&&N.d<15?void p.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):void 0:void p.error("There is no year 0 in the Julian system!")},t.set_max_sun_angle=function(e){g=Math.min(Math.max(e,0),90)},t.get_light_params=function(e){if(!S.is_lamp(e))return p.error("get_light_params(): Wrong object"),null;var t=e.light,r=f(e);if(r)switch(r){case"SPOT":var a={light_type:r,light_color:new Float32Array(3),light_energy:t.energy,light_spot_blend:t.spot_blend,light_spot_size:t.spot_size,light_distance:t.distance};a.light_color.set(t.color);break;case"POINT":var a={light_type:r,light_color:new Float32Array(3),light_energy:t.energy,light_distance:t.distance};a.light_color.set(t.color);break;default:var a={light_type:r,light_color:new Float32Array(3),light_energy:t.energy};a.light_color.set(t.color)}return a||null},t.get_light_type=f,t.set_light_params=function(e,t){if(!S.is_lamp(e))return void p.error("set_light_params(): Wrong object");var r=e.light,a=v.get_active(),_=!1;"number"==typeof t.light_energy&&n.d(r,t.light_energy),"object"==typeof t.light_color&&n.b(r,t.light_color),"number"==typeof t.light_spot_blend&&(n.e(r,t.light_spot_blend),_=!0),"number"==typeof t.light_spot_size&&(n.f(r,t.light_spot_size),_=!0),"number"==typeof t.light_distance&&(n.c(r,t.light_distance),_=!0),v.update_lamp_scene(e,a),_&&v.update_all_mesh_shaders(a)},t.get_light_energy=function(e){return S.is_lamp(e)?e.light.energy:(p.error("get_light_energy(): Wrong object"),0)},t.set_light_energy=function(e,t){if(!S.is_lamp(e))return void p.error("set_light_energy(): Wrong object");var r=v.get_active();n.d(e.light,t),v.update_lamp_scene(e,r)},t.get_light_color=function(e,t){return S.is_lamp(e)?(t=t||new Float32Array(3),t.set(e.light.color),t):(p.error("get_light_color(): Wrong object"),null)},t.set_light_color=function(e,t){if(!S.is_lamp(e))return void p.error("set_light_color(): Wrong object");var r=v.get_active();n.b(e.light,t),v.update_lamp_scene(e,r)}}var _=r(0),n=r(60),o=r(12),i=r(9),s=r(1),c=r(8),E=r(10),l=r(13),T=r(6),u=r(2),d=r(3),f=Object(_.a)("lights",a);t.a=f},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e);t.append_custom_callback=function(e,t){r.append_custom_cb(e,t)},t.remove_custom_callback=function(e){r.remove_custom_cb(e)},t.run_entrypoint=function(e,t){r.run_ep(e,t)}}var _=r(0),n=r(63),o=Object(_.a)("logic_nodes",a);t.a=o},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),d=Object(s.a)(e),f=Object(c.a)(e),P=Object(E.a)(e),A=Object(l.a)(e),S=Object(u.a)(e),p=a.defaults;t.inherit_material=function(e,t,r,a){if(!_.has_dyn_geom(r)||!_.has_dyn_geom(e))return void P.error('inherit_material(): both objects "'+e.origin_name+'" and "'+r.origin_name+'" must have the "Dynamic Geometry & Materials" flag enabled.');var n=e.mat_inheritance_data.original_mat_names.indexOf(t);if(-1==n)return void P.error('inherit_material(): material "'+t+'" not found on the object "'+e.origin_name+'".');var o=r.mat_inheritance_data.original_mat_names.indexOf(a);if(-1==o)return void P.error('inherit_material(): material "'+a+'" not found on the object "'+r.origin_name+'".');0==r._bpy_obj.data.submeshes[o].shade_tangs.length&&e.materials[n].use_tangent_shading&&P.warn('The target material "'+a+'" was exported without tangent shading data. However, the "'+t+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),d.inherit_material(e,t,r,a)},t.get_materials_names=function(e){var t=[];if(!f.is_dynamic_mesh(e))return P.error('get_materials_names(): Object "'+e.name+'" is not a dynamic MESH.'),t;for(var r=e.scenes_data,a=0;a<r.length;a++)for(var _=r[a].batches,n=0;n<_.length;n++){var o=_[n];if("MAIN"==o.type)for(var i=0;i<o.material_names.length;i++)-1==t.indexOf(o.material_names[i])&&t.push(o.material_names[i])}return t},t.set_diffuse_color=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_diffuse_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.diffuse_color.set(a);var n=r.find_batch_material_forked(e,t,"MAIN");n&&n.diffuse_color.set(a)},t.get_diffuse_color=function(e,t){var a=new Float32Array(4);if(!f.is_dynamic_mesh(e))return P.error('get_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.'),a;var _=r.find_batch_material(e,t,"MAIN");return _?_.has_nodes?(P.error("get_diffuse_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),a):(a.set(_.diffuse_color),a):(P.error('get_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),a)},t.set_diffuse_intensity=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_diffuse_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.diffuse_intensity=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.diffuse_intensity=a)},t.get_diffuse_intensity=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_diffuse_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.diffuse_intensity:(P.error('get_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_specular_color=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_color(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_specular_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.specular_color.set(a);var n=r.find_batch_material_forked(e,t,"MAIN");n&&n.specular_color.set(a)},t.get_specular_color=function(e,t){var a=new Float32Array(3);if(!f.is_dynamic_mesh(e))return P.error('get_specular_color(): Object "'+e.name+'" is not a dynamic MESH.'),a;var _=r.find_batch_material(e,t,"MAIN");return _?_.has_nodes?(P.error("get_specular_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),a):(a.set(_.specular_color),a):(P.error('get_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),a)},t.set_specular_color_factor=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_specular_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.specular_color_factor=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.specular_color_factor=a)},t.get_specular_color_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_specular_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.specular_color_factor:(P.error('get_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_specular_intensity=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_specular_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.specular_params[0]=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.specular_params[0]=a)},t.get_specular_intensity=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_specular_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.specular_params[0]:(P.error('get_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.check_specular_intensity=function(e,t){P.error_once("check_specular_intensity() is deprecated, not needed anymore");var a=r.find_batch_material(e,t,"MAIN");return Boolean(a&&a.specular_params[0])},t.set_specular_hardness=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_specular_hardness(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.specular_params[1]=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.specular_params[1]=a)},t.get_specular_hardness=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_specular_hardness(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.specular_params[1]:(P.error('get_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.check_specular_hardness=function(e,t){P.error_once("check_specular_hardness() is deprecated, not needed anymore");var a=r.find_batch_material(e,t,"MAIN");return Boolean(a&&a.specular_params[1])},t.set_emit_factor=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_emit_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.emit=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.emit=a)},t.get_emit_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_emit_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.emit:(P.error('get_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_ambient_factor=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_ambient_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.ambient=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.ambient=a)},t.get_ambient_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_ambient_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.ambient:(P.error('get_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_diffuse_color_factor=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_diffuse_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.diffuse_color_factor=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.diffuse_color_factor=a)},t.get_diffuse_color_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_diffuse_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.diffuse_color_factor:(P.error('get_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_alpha_factor=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_alpha_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");_.alpha_factor=a;var n=r.find_batch_material_forked(e,t,"MAIN");n&&(n.alpha_factor=a)},t.get_alpha_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_alpha_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):a.alpha_factor:(P.error('get_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.get_material_extended_params=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var a=r.find_batch_material(e,t,"MAIN");if(!a)return P.error('get_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),null;if(a.has_nodes)return P.error("get_material_extended_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var _={};return _.reflect_factor=a.reflect_factor,_.fresnel=a.fresnel_params[0],_.fresnel_factor=5*(1-a.fresnel_params[1]),_.parallax_scale=a.parallax_scale,_.parallax_steps=parseFloat(r.get_batch_directive(a,"PARALLAX_STEPS")[1]),_},t.set_material_extended_params=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_)return void P.error('set_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(_.has_nodes)return void P.error("set_material_extended_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");var n=[_],o=r.find_batch_material_forked(e,t,"MAIN");o&&n.push(o);for(var i=0;i<n.length;i++)_=n[i],"number"==typeof a.reflect_factor&&(_.reflect_factor=a.reflect_factor),"number"==typeof a.fresnel&&(_.fresnel_params[0]=a.fresnel),"number"==typeof a.fresnel_factor&&(_.fresnel_params[1]=1-a.fresnel_factor/5),"number"==typeof a.parallax_scale&&(_.parallax_scale=a.parallax_scale),"number"==typeof a.parallax_steps&&(r.set_batch_directive(_,"PARALLAX_STEPS",A.glsl_value(a.parallax_steps)),r.update_shader(_),S.recalculate_draw_data(_))},t.get_water_material_params=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var a=r.find_batch_material(e,t,"MAIN");if(!a||!a.water)return P.error('get_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material."),null;if(a.has_nodes)return P.error("get_water_material_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var _={};return _.shore_smoothing=p.shore_smoothing&&a.water_shore_smoothing&&Boolean(parseFloat(r.get_batch_directive(a,"SHORE_SMOOTHING")[1])),_.absorb_factor=parseFloat(r.get_batch_directive(a,"ABSORB")[1]),_.foam_factor=a.foam_factor,_.shallow_water_col=new Float32Array(3),_.shore_water_col=new Float32Array(3),_.shallow_water_col_fac=0,_.shore_water_col_fac=0,p.shore_distance&&(_.shallow_water_col.set(a.shallow_water_col),_.shore_water_col.set(a.shore_water_col),_.shallow_water_col_fac=a.shallow_water_col_fac,_.shore_water_col_fac=a.shore_water_col_fac),_.norm_uv_velocity=a.water_norm_uv_velocity,_.water_dynamic=p.water_dynamic&&a.water_dynamic&&Boolean(parseFloat(r.get_batch_directive(a,"DYNAMIC")[1])),_.sss_strength=parseFloat(r.get_batch_directive(a,"SSS_STRENGTH")[1]),_.sss_width=parseFloat(r.get_batch_directive(a,"SSS_WIDTH")[1]),_.waves_height=parseFloat(r.get_batch_directive(a,"WAVES_HEIGHT")[1]),_.waves_length=parseFloat(r.get_batch_directive(a,"WAVES_LENGTH")[1]),_.dst_noise_scale0=parseFloat(r.get_batch_directive(a,"DST_NOISE_SCALE_0")[1]),_.dst_noise_scale1=parseFloat(r.get_batch_directive(a,"DST_NOISE_SCALE_1")[1]),_.dst_noise_freq0=parseFloat(r.get_batch_directive(a,"DST_NOISE_FREQ_0")[1]),_.dst_noise_freq1=parseFloat(r.get_batch_directive(a,"DST_NOISE_FREQ_1")[1]),_.dir_min_shore_fac=parseFloat(r.get_batch_directive(a,"DIR_MIN_SHR_FAC")[1]),_.dir_freq=parseFloat(r.get_batch_directive(a,"DIR_FREQ")[1]),_.dir_noise_scale=parseFloat(r.get_batch_directive(a,"DIR_NOISE_SCALE")[1]),_.dir_noise_freq=parseFloat(r.get_batch_directive(a,"DIR_NOISE_FREQ")[1]),_.dir_min_noise_fac=parseFloat(r.get_batch_directive(a,"DIR_MIN_NOISE_FAC")[1]),_.dst_min_fac=parseFloat(r.get_batch_directive(a,"DST_MIN_FAC")[1]),_.waves_hor_fac=parseFloat(r.get_batch_directive(a,"WAVES_HOR_FAC")[1]),_},t.set_water_material_params=function(e,t,a){if(!f.is_dynamic_mesh(e))return void P.error('set_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.');var _=r.find_batch_material(e,t,"MAIN");if(!_||!_.water)return void P.error('set_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material.");if(_.has_nodes)return void P.error("set_water_material_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");var n=[_],o=r.find_batch_material_forked(e,t,"MAIN");o&&n.push(o);for(var i=0;i<n.length;i++){if(_=n[i],"boolean"==typeof a.shore_smoothing&&(p.shore_smoothing&&_.water_shore_smoothing&&a.shore_smoothing?r.set_batch_directive(_,"SHORE_SMOOTHING",1):r.set_batch_directive(_,"SHORE_SMOOTHING",0)),"number"==typeof a.absorb_factor){var s=A.glsl_value(parseFloat(a.absorb_factor));r.set_batch_directive(_,"ABSORB",s)}if("number"==typeof a.foam_factor&&p.foam&&(_.foam_factor=a.foam_factor),p.shore_distance&&("object"==typeof a.shallow_water_col&&_.shallow_water_col.set(a.shallow_water_col),"number"==typeof a.shallow_water_col_fac&&(_.shallow_water_col_fac=a.shallow_water_col_fac),"object"==typeof a.shore_water_col&&_.shore_water_col.set(a.shore_water_col),"number"==typeof a.shore_water_col_fac&&(_.shore_water_col_fac=a.shore_water_col_fac)),"number"==typeof a.norm_uv_velocity&&(_.water_norm_uv_velocity=a.norm_uv_velocity),p.water_dynamic&&_.water_dynamic){if("boolean"==typeof a.water_dynamic&&(a.water_dynamic?r.set_batch_directive(_,"DYNAMIC",1):r.set_batch_directive(_,"DYNAMIC",0)),"number"==typeof a.sss_strength){var c=A.glsl_value(parseFloat(a.sss_strength));r.set_batch_directive(_,"SSS_STRENGTH",c)}if("number"==typeof a.sss_width){var c=A.glsl_value(parseFloat(a.sss_width));r.set_batch_directive(_,"SSS_WIDTH",c)}if("number"==typeof a.waves_height){var E=A.glsl_value(parseFloat(a.waves_height));r.set_batch_directive(_,"WAVES_HEIGHT",E)}if("number"==typeof a.waves_length){var c=A.glsl_value(parseFloat(a.waves_length));r.set_batch_directive(_,"WAVES_LENGTH",c)}if("number"==typeof a.dst_noise_scale0){var l=A.glsl_value(parseFloat(a.dst_noise_scale0));r.set_batch_directive(_,"DST_NOISE_SCALE_0",l)}if("number"==typeof a.dst_noise_scale1){var T=A.glsl_value(parseFloat(a.dst_noise_scale1));r.set_batch_directive(_,"DST_NOISE_SCALE_1",T)}if("number"==typeof a.dst_noise_freq0){var u=A.glsl_value(parseFloat(a.dst_noise_freq0));r.set_batch_directive(_,"DST_NOISE_FREQ_0",u)}if("number"==typeof a.dst_noise_freq1){var d=A.glsl_value(parseFloat(a.dst_noise_freq1));r.set_batch_directive(_,"DST_NOISE_FREQ_1",d)}if("number"==typeof a.dir_min_shore_fac){var v=A.glsl_value(parseFloat(a.dir_min_shore_fac));r.set_batch_directive(_,"DIR_MIN_SHR_FAC",v)}if("number"==typeof a.dir_freq){var m=A.glsl_value(parseFloat(a.dir_freq));r.set_batch_directive(_,"DIR_FREQ",m)}if("number"==typeof a.dir_noise_scale){var O=A.glsl_value(parseFloat(a.dir_noise_scale));r.set_batch_directive(_,"DIR_NOISE_SCALE",O)}if("number"==typeof a.dir_noise_freq){var N=A.glsl_value(parseFloat(a.dir_noise_freq));r.set_batch_directive(_,"DIR_NOISE_FREQ",N)}if("number"==typeof a.dir_min_noise_fac){var g=A.glsl_value(parseFloat(a.dir_min_noise_fac));r.set_batch_directive(_,"DIR_MIN_NOISE_FAC",g)}if("number"==typeof a.dst_min_fac){var h=A.glsl_value(parseFloat(a.dst_min_fac));r.set_batch_directive(_,"DST_MIN_FAC",h)}if("number"==typeof a.waves_hor_fac){var R=A.glsl_value(parseFloat(a.waves_hor_fac));r.set_batch_directive(_,"WAVES_HOR_FAC",R)}}r.update_shader(_),S.recalculate_draw_data(_)}},t.set_line_params=function(e,t){if(!f.is_line(e))return void P.error('set_line_params(): Object "'+e.name+'" is not a LINE object.');var a=r.get_first_batch(e);if(!a)return void P.error("set_line_params(): Couldn't set line parameters!");T._17(t.color)&&a.diffuse_color.set(t.color),T._17(t.width)&&(a.line_width=t.width)},t.get_line_params=function(e){if(!f.is_line(e))return P.error('get_line_params(): Object "'+e.name+'" is not a LINE object.'),null;var t=r.get_first_batch(e);return t?{color:new Float32Array(t.diffuse_color),width:t.line_width}:(P.error("get_line_params(): Couldn't get line parameters!"),null)},t.set_nodemat_value=function(e,t,a){var _=f.is_dynamic_mesh(e),n=f.is_world(e),o=n?d.get_world_name(e):e.name;if(!_&&!n)return void P.error('set_nodemat_value(): Object "'+o+'" is not a dynamic MESH or WORLD.');if(_){var i=t[0],s=1,c=r.find_batch_material_any(e,i,"MAIN")||r.find_batch_material_any(e,i,"PARTICLES");if(!c)return void P.error('set_nodemat_value(): Material "'+i+'" wasn\'t found on the object "'+o+'".')}else if(n){var E=S.get_active(),i="",s=0,c=r.get_batch_by_type(e,"SKY",E);if(!c)return void P.error("set_nodemat_value(): Sky node material wasn't found on the world object \""+o+'".')}var l=r.name_list_to_node_name(t,s);d.set_nodemat_value(e,i,l,a)||P.error('set_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+o+'".')},t.get_nodemat_value=function(e,t){var a=f.is_dynamic_mesh(e),_=f.is_world(e),n=_?d.get_world_name(e):e.name;if(!a&&!_)return P.error('get_nodemat_value(): Object "'+n+'" is not a dynamic MESH or WORLD.'),0;if(a){var o=t[0],i=1,s=r.find_batch_material_any(e,o,"MAIN")||r.find_batch_material_any(e,o,"PARTICLES");if(!s)return P.error('get_nodemat_value(): Material "'+o+'" wasn\'t found on the object "'+n+'".'),0}else if(_){var c=S.get_active(),o="",i=0,s=r.get_batch_by_type(e,"SKY",c);if(!s)return P.error("get_nodemat_value(): Sky node material wasn't found on the world object \""+n+'".'),0}var E=r.name_list_to_node_name(t,i),l=d.get_nodemat_value(e,o,E);return null===l&&P.error('get_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+n+'".'),l},t.set_nodemat_rgb=function(e,t,a,_,n){var o=f.is_dynamic_mesh(e),i=f.is_world(e),s=i?d.get_world_name(e):e.name;if(!o&&!i)return void P.error('set_nodemat_rgb(): Object "'+s+'" is not a dynamic MESH or WORLD.');if(o){var c=t[0],E=1,l=r.find_batch_material_any(e,c,"MAIN")||r.find_batch_material_any(e,c,"PARTICLES");if(!l)return void P.error('set_nodemat_rgb(): Material "'+c+'" wasn\'t found on the object "'+s+'".')}else if(i){var T=S.get_active(),c="",E=0,l=r.get_batch_by_type(e,"SKY",T);if(!l)return void P.error("set_nodemat_rgb(): Sky node material wasn't found on the world object \""+s+'".')}var u=r.name_list_to_node_name(t,E);d.set_nodemat_rgb(e,c,u,a,_,n)||P.error('set_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+s+'".')},t.get_nodemat_rgb=function(e,t,a){var _=f.is_dynamic_mesh(e),n=f.is_world(e),o=n?d.get_world_name(e):e.name;if(!_&&!n)return P.error('get_nodemat_rgb(): Object "'+o+'" is not a dynamic MESH or WORLD.'),null;if(_){var i=t[0],s=1,c=r.find_batch_material_any(e,i,"MAIN")||r.find_batch_material_any(e,i,"PARTICLES");if(!c)return P.error('get_nodemat_rgb(): Material "'+i+'" wasn\'t found on the object "'+o+'".'),null}else if(n){var E=S.get_active(),i="",s=0,c=r.get_batch_by_type(e,"SKY",E);if(!c)return P.error("get_nodemat_rgb(): Sky node material wasn't found on the world object \""+o+'".'),null}a||(a=new Float32Array(3));var l=r.name_list_to_node_name(t,s);return a=d.get_nodemat_rgb(e,i,l,a),a||P.error('get_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+o+'".'),a},t.is_node_material=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('is_node_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes:(P.error('is_node_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)},t.is_water_material=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('is_water_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var a=r.find_batch_material(e,t,"MAIN");return a?a.water&&!a.has_nodes:(P.error('is_water_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)}}var _=r(0),n=r(16),o=r(4),i=r(20),s=r(12),c=r(9),E=r(1),l=r(37),T=r(2),u=r(10),d=Object(_.a)("material",a);t.a=d},function(e,t,r){"use strict";function a(e,t){var r=new Float32Array(3);t.create_pline_from_points=function(e,t){var a=new Float32Array(6);return i.R(a,e),n.subtract(t,e,r),i.Q(a,r),a},t.create_pline_from_point_vec=function(e,t){var r=new Float32Array(6);return i.R(r,e),i.Q(r,t),r},t.create_pline=function(){return new Float32Array(6)},t.get_pline_directional_vec=i.M,t.get_pline_initial_point=i.N,t.set_pline_initial_point=i.R,t.set_pline_directional_vec=i.Q,t.line_plane_intersect=o._22,t.calc_pline_point=i.f,t.point_plane_dist=i.P,t.linear_tween=i.O,t.ease_in_quad=i.x,t.ease_out_quad=i.H,t.ease_in_out_quad=i.t,t.ease_in_cubic=i.k,t.ease_out_cubic=i.E,t.ease_in_out_cubic=i.q,t.ease_in_quart=i.y,t.ease_out_quart=i.I,t.ease_in_out_quart=i.u,t.ease_in_quint=i.z,t.ease_out_quint=i.J,t.ease_in_out_quint=i.v,t.ease_in_sine=i.A,t.ease_out_sine=i.K,t.ease_in_out_sine=i.w,t.ease_in_expo=i.m,t.ease_out_expo=i.G,t.ease_in_out_expo=i.s,t.ease_in_circ=i.j,t.ease_out_circ=i.D,t.ease_in_out_circ=i.p,t.ease_in_elastic=i.l,t.ease_out_elastic=i.F,t.ease_in_out_elastic=i.r,t.ease_in_back=i.h,t.ease_out_back=i.B,t.ease_in_out_back=i.n,t.ease_in_bounce=i.i,t.ease_out_bounce=i.C,t.ease_in_out_bounce=i.o}var _=r(0),n=r(3),o=r(2),i=r(45),s=Object(_.a)("math",a);t.a=s},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e);t.set_frame=function(e){if(e=s.M(e,r.get_frame_start(),r.get_frame_end()),r.check_logic_nodes())return void _.error("The active scene is using the Logic Editor.");r.set_frame(e,a.get_timeline())},t.get_frame=function(){return r.get_frame(a.get_timeline())},t.stop=function(){r.check_logic_nodes()&&_.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code."),r.stop_nla()},t.play=function(e){r.check_logic_nodes()&&_.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code."),r.play_nla(e)},t.is_play=function(){return r.is_play()},t.get_frame_start=function(){return r.get_frame_start()},t.get_frame_end=function(){return r.get_frame_end()},t.check_nla=function(){return r.check_nla()},t.check_logic_nodes=function(){return r.check_logic_nodes()},t.set_range=function(e,t){if(r.check_logic_nodes())return void _.error("The active scene is using the Logic Editor.");t=parseFloat(t)||r.get_frame_end(),e=parseFloat(e)||r.get_frame_end(),t=s.M(t,r.get_frame_start(),r.get_frame_end()),e=s.M(e,r.get_frame_start(),t),r.set_range(e,t)},t.reset_range=function(){if(r.check_logic_nodes())return void _.error("The active scene is using the Logic Editor.");r.reset_range()},t.set_cyclic=function(e){if(r.check_logic_nodes())return void _.error("The active scene is using the Logic Editor.");r.set_cyclic(e)},t.clear_callback=function(){if(r.check_logic_nodes())return void _.error("The active scene is using the Logic Editor.");r.clear_callback()}}var _=r(0),n=r(55),o=r(18),i=r(1),s=r(2),c=Object(_.a)("nla",a);t.a=c},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),u=Object(s.a)(e),d=Object(c.a)(e),f=Object(E.a)(e);t.get_meta_tags=function(e){if(e)return a.get_meta_tags(e)},t.get_custom_prop=function(e){if(e)return a.get_custom_prop(e)},t.copy=function(e,t,_){if(!u.is_mesh(e)&&!u.is_empty(e))return d.error('object "'+e.name+'" is not of type "MESH".'),!1;if(!u.is_dynamic(e))return d.error('object "'+e.name+'" is not dynamic.'),!1;if(!r.has_dyn_geom(e)&&!r.check_shape_keys(e)&&_)return d.error('object "'+e.name+'" has not dynamic geometry for deep copying.'),!1;var n=a.get_scene_objs(f.get_active(),"MESH",a.DATA_ID_ALL);return-1==n.indexOf(e)&&(n=a.get_scene_objs(f.get_active(),"EMPTY",a.DATA_ID_ALL),-1==n.indexOf(e))?(d.error('object "'+e.name+'" does not belong to the active scene.'),!1):(t=t||"",a.copy(e,t,_))},t.update_boundings=function(e){return u.is_mesh(e)?r.has_dyn_geom(e)||r.check_shape_keys(e)?void a.update_boundings(e):void d.error('object "'+e.name+'" has not dynamic geometry.'):void d.error('The type of the object "'+e.name+'" is not "MESH".')},t.get_parent=u.get_parent,t.get_dg_parent=u.get_dg_parent,t.is_mesh=u.is_mesh,t.is_armature=u.is_armature,t.is_speaker=u.is_speaker,t.is_camera=u.is_camera,t.is_lamp=u.is_lamp,t.is_empty=u.is_empty,t.is_line=u.is_line,t.is_world=u.is_world,t.get_selectable_objects=function(){return a.get_selectable_objects()},t.get_outlining_objects=function(){return a.get_outlining_objects()},t.is_dynamic=u.is_dynamic,t.set_wind_bending_params=function(e,t){if(!u.is_dynamic_mesh(e))return void d.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.');var r=e.render;if(!r.wind_bending)return void d.error('The "'+e.name+"\" object doesn't have wind bending parameters.");if("number"==typeof t.angle){var n=_.wb_angle_to_amp(T.T(t.angle),r.bb_original,l.i(r.world_tsr));r.wind_bending_amp=n}"number"==typeof t.main_frequency&&(r.wind_bending_freq=t.main_frequency),"number"==typeof t.detail_frequency&&(r.detail_bending_freq=t.detail_frequency),"number"==typeof t.detail_amplitude&&(r.detail_bending_amp=t.detail_amplitude),"number"==typeof t.branch_amplitude&&(r.branch_bending_amp=t.branch_amplitude),a.set_hair_particles_wind_bend_params(e)},t.get_wind_bending_params=function(e){var t=e.render;if(!t.wind_bending)return null;var r={},a=T._39(_.wb_amp_to_angle(t.wind_bending_amp,t.bb_original,l.i(t.world_tsr)));return r.angle=a,r.main_frequency=t.wind_bending_freq,r.detail_frequency=t.detail_bending_freq,r.detail_amplitude=t.detail_bending_amp,r.branch_amplitude=t.branch_bending_amp,r},t.create_line=function(e){return a.create_line(e)},t.create_empty=function(e){return a.create_empty(e)},t.hide_all_by_data_id=function(e){for(var t=a.get_all_objects("ALL",e),r=0;r<t.length;r++)f.change_visibility(t[r],!0)},t.show_all_by_data_id=function(e){for(var t=a.get_all_objects("ALL",e),r=0;r<t.length;r++)f.change_visibility(t[r],!1)}}var _=r(0),n=r(20),o=r(12),i=r(16),s=r(9),c=r(1),E=r(10),l=r(6),T=r(2),u=Object(_.a)("objects",a);t.a=u},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e);t.set_size=function(e,t,_){if(!r.obj_has_psys(e,t))return void a.error('set_size(): Object "'+e.name+'" has not a particle system named "'+t+'"');r.set_size(e,t,_)},t.set_normal_factor=function(e,t,_){if(!r.obj_has_psys(e,t))return void a.error('set_normal_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"');r.set_normal_factor(e,t,_)},t.set_factor=function(e,t,_){if(!r.obj_has_psys(e,t))return void a.error('set_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"');_=Math.min(_,1),_=Math.max(_,0),r.set_factor(e,t,_)}}var _=r(0),n=r(50),o=r(1),i=Object(_.a)("particles",a);t.a=i},function(e,t,r){"use strict";function a(e,t){var r=new Float32Array(3);t.create=function(){return new Float32Array(3)},t.from_values=function(e,t,r){var a=new Float32Array(3);return a[0]=e,a[1]=t,a[2]=r,a},t.set=function(e,t,r,a){return a[0]=e,a[1]=t,a[2]=r,a},t.css_to_rgb=function(e,t,r,a){return a=a||new Float32Array(3),a[0]=e/255,a[1]=t/255,a[2]=r/255,n._57(a,a),a},t.rgb_to_css=function(e){var t=n._21(e,r);return[Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])]},t.rgb_to_css_hex=function(e){var t=function(e){var t=Math.round(255*e).toString(16);return 1==t.length?"0"+t:t},a=n._21(e,r);return"#"+t(a[0])+t(a[1])+t(a[2])}}var _=r(0),n=r(2),o=Object(_.a)("rgb",a);t.a=o},function(e,t,r){"use strict";function a(e,t){var r=Object(n.a)(e),a=Object(o.a)(e),_=Object(i.a)(e),l=Object(s.a)(e),T=Object(c.a)(e);t.play_video=function(e,t){t||(t=0);var n=_.get_video_texture(e,t);return n?a.get_active().b4w_use_nla&&_.video_allow_nla(n)?void r.error("NLA texture can't be controlled directly through API."):void _.play_video(n):void r.error('Texture with name "'+e+'" not found!')},t.pause_video=function(e,t){t||(t=0);var n=_.get_video_texture(e,t);return n?a.get_active().b4w_use_nla&&_.video_allow_nla(n)?void r.error("NLA texture can't be controlled directly through API."):void _.pause_video(n):void r.error('Texture with name "'+e+'" not found!')},t.reset_video=function(e,t){t||(t=0);var n=_.get_video_texture(e,t);return n?a.get_active().b4w_use_nla&&_.video_allow_nla(n)?void r.error("NLA texture can't be controlled directly through API."):void _.reset_video(n):void r.error('Texture with name "'+e+'" not found!')},t.get_canvas_ctx=function(e,t){if(l.is_mesh(e)){var a=_.get_canvas_context_by_object(e,t);if(a)return a;r.error("Couldn't find canvas texture with this name: "+t)}else r.error("Object must be type of mesh.");return null},t.update_canvas_ctx=function(e,t){if(!l.is_mesh(e))return r.error("Object must be type of mesh."),!1;var a=_.get_texture_by_name(e,t);return a&&"CANVAS"==a.source?(_.update_texture_canvas(a),!0):(r.error("Couldn't find canvas texture \""+t+'" in object "'+e.name+'".'),!1)},t.change_image=function(e,t,a,n){r.error_deprecated("change_image","replace_image"),n=n||function(){};var o=_.get_texture_by_name(e,t);if(!o)return r.error("Couldn't find texture \""+t+'" in object "'+e.name+'".'),void n(!1);if(o.is_movie)return r.error("Changing video textures is forbidden."),void n(!1);var i=Object(E.b)(a);if(o.img_full_filepath==i)return void n(!0);var s={id:a,type:T.AT_IMAGE_ELEMENT,url:a,request_method:"GET"},c=function(r,i,s,c){r?(_.change_image(e,o,t,r,a),n(!0)):n(!1)};T.enqueue([s],c,null,null)},t.replace_image=function(e,t,a,n){n=n||function(){};var o=_.get_texture_by_name(e,t);if(!o)return r.error("Couldn't find texture \""+t+'" in object "'+e.name+'".'),void n(!1);if(o.is_movie)return r.error("Changing video textures is forbidden."),void n(!1);if(!("src"in a))return r.error("Incorrect image."),void n(!1);var i=a.src;if(a.complete)_.change_image(e,o,t,a,i),n(!0);else{var s=a.onload,c=a.onerror;a.onload=function(){s&&s.call(a),_.change_image(e,o,t,a,i),n(!0)},a.onerror=function(){c&&c.call(a),n(!1)}}},t.get_texture_names=function(e){return l.is_mesh(e)?_.get_texture_names(e):(r.error("Object must be type of mesh."),[])}}var _=r(0),n=r(1),o=r(10),i=r(17),s=r(9),c=r(47),E=r(51),l=Object(_.a)("textures",a);t.a=l},function(e,t,r){"use strict";function a(e,t){t.version=n.e,t.version_str=n.f,t.type=n.d,t.date=n.a,t.date_str=n.b,t.get_build_version=n.c}var _=r(0),n=r(40),o=Object(_.a)("version",a);t.a=o},function(e,t,r){var a=r(148);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,".app-container .customization {\n  width: 100%;\n  background-color: white; }\n\n.app-container .itemContain {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  border-bottom: 6px solid #F7F7F7; }\n  .app-container .itemContain .input {\n    margin: 11px 47px;\n    border: 1px solid #EEEEEE;\n    border-radius: 5px;\n    text-align: center;\n    height: 44px; }\n",""])},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function n(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=r(27),i=r.n(o),s=r(150),c=(r.n(s),function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}()),E=function(e){function t(){return a(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return n(t,e),c(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"dContainer"},i.a.createElement("div",{className:"b4w",id:"b4w"}),i.a.createElement("div",{id:"logo_container"}),i.a.createElement("div",{id:"preloader_cont"},i.a.createElement("div",{id:"prelod_static_path"},i.a.createElement("div",{id:"prelod_dynamic_path"}),i.a.createElement("span",null))))}}]),t}(o.Component);t.a=E},function(e,t,r){var a=r(151);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,".b4w {\n  background-color: black;\n  height: 100%;\n  width: 100%; }\n\ndiv#prelod_static_path {\n  background-color: white;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  width: 395px;\n  height: 10%;\n  -webkit-transform: translate(-50%, -40%);\n  transform: translate(-50%, -40%); }\n\ndiv#prelod_dynamic_path {\n  background-image: url("+r(152)+");\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 0%;\n  height: 100%; }\n\ndiv#preloader_cont {\n  background-color: black;\n  bottom: 20%;\n  height: 20%;\n  position: absolute;\n  visibility: hidden;\n  width: 100%; }\n\ndiv#logo_container {\n  height: 112px;\n  position: absolute;\n  top: 40%;\n  width: 100%;\n  background-repeat: no-repeat;\n  background-position: center center; }\n\n.dContainer {\n  display: flex;\n  height: 80vw;\n  width: 100%;\n  position: relative; }\n",""])},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYsAAACGCAYAAAAsCabhAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAHmSURBVHhe7dWxDYBAAAOxwP47AwXt6xawpSgj3LXt+QYAR/f/AHAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwASGIBQBILAJJYAJDEAoAkFgAksQAgiQUASSwACNsLADsCC+49OoIAAAAASUVORK5CYII="},function(e,t,r){"use strict";var a=r(27),_=r.n(a),n=r(154),o=(r.n(n),function(e){var t=e.contentArr,r=e.selectIndex,a=e.clickItem,n=e.saveAction;return _.a.createElement("div",{className:"select-bar-container"},_.a.createElement("div",{className:"content"},t.map(function(e,t){return _.a.createElement("div",{className:"item",onClick:function(){return a(t)}},_.a.createElement("div",{className:t===r?"itemTitle select":"itemTitle"},e))})),_.a.createElement("div",{className:"save",onClick:n},"\u4fdd\u5b58"))});t.a=o},function(e,t,r){var a=r(155);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,".select-bar-container {\n  display: flex;\n  width: 100%;\n  flex-direction: row;\n  height: 38px;\n  align-items: center; }\n  .select-bar-container .content {\n    display: flex;\n    flex: 1;\n    flex-direction: row;\n    align-items: center;\n    position: relative; }\n    .select-bar-container .content .item {\n      display: flex;\n      width: 72px;\n      height: 100%;\n      align-items: center;\n      justify-content: center; }\n    .select-bar-container .content .itemTitle {\n      font-size: 14px;\n      color: #555555;\n      height: 100%; }\n    .select-bar-container .content .select {\n      font-size: 16px;\n      color: #EBC666;\n      border-bottom: 2px solid #EBC666; }\n  .select-bar-container .save {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-right: 16px;\n    width: 66px;\n    height: 30px;\n    background: #EBC666;\n    border-radius: 100px;\n    color: white;\n    font-size: 16px; }\n",""])},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function n(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=r(27),i=r.n(o),s=r(157),c=r(162),E=r(165),l=r(170),T=(r.n(l),function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}()),u=function(e){function t(e){a(this,t);var r=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={showDetail:!0},r}return n(t,e),T(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.title,a=t.container,_=t.selectValue,n=t.clickItem,o=t.type,l=this.state.showDetail,T="color"===o?c.a:s.a,u=a.findIndex(function(e){return e.ecode===_});return i.a.createElement("div",{className:"model-row-item"},i.a.createElement(E.a,{title:r,value:-1!==u?a[u].name:"",show:!l,onClick:function(){return e.setState({showDetail:!e.state.showDetail})}}),l&&i.a.createElement("div",{className:"itemDetail"},a.map(function(e,t){return i.a.createElement(T,Object.assign({},e,{select:u===t,onClick:function(){return n(e,t)},color:e.colorHex}))})))}}]),t}(o.Component);t.a=u},function(e,t,r){"use strict";var a=r(27),_=r.n(a),n=r(158),o=(r.n(n),function(e){var t=e.name,a=e.lineDraftUrl,n=e.select,o=e.onClick;return _.a.createElement("div",{className:"detailContain",onClick:o},_.a.createElement("img",{className:"detailICon",alt:"isImage",src:r(160)}),_.a.createElement("div",{className:n?"detailTitle selectTitle":"detailTitle"},t),n&&_.a.createElement("div",{className:"selectView"},_.a.createElement("img",{alt:"isImage",src:a||r(161),className:"selectIcon"})))});t.a=o},function(e,t,r){var a=r(159);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,".detailContain {\n  width: 25%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  position: relative; }\n  .detailContain .detailICon {\n    width: 15vw;\n    height: 15vw;\n    margin: 8px 0px;\n    border: 1px solid #CCCCCC;\n    border-radius: 4px; }\n  .detailContain .detailTitle {\n    font-size: 14px;\n    color: #555555; }\n  .detailContain .selectTitle {\n    font-size: 14px;\n    color: #DFB86E; }\n  .detailContain .selectView {\n    position: absolute;\n    display: flex;\n    width: 15vw;\n    height: 15vw;\n    top: 8px;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    border: 1px solid #E0B970; }\n    .detailContain .selectView .selectIcon {\n      width: 86%;\n      height: 80%; }\n",""])},function(e,t,r){e.exports=r.p+"static/media/63caa7a18ab08814178f964ee3202d02.63caa7a1.png"},function(e,t,r){e.exports=r.p+"static/media/select_Icon.087d9252.svg"},function(e,t,r){"use strict";var a=r(27),_=r.n(a),n=r(163),o=(r.n(n),function(e){var t=e.color,r=e.name,a=e.select,n=e.onClick;return _.a.createElement("div",{className:"color-item-container",onClick:n},_.a.createElement("div",{className:a?"bgView selectBg":"bgView"},_.a.createElement("div",{className:"color",style:{backgroundColor:t||"red"}}),_.a.createElement("div",{className:a?"title selectTt":"title"},r)))});t.a=o},function(e,t,r){var a=r(164);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,".color-item-container {\n  width: 25%;\n  display: flex;\n  align-items: center;\n  justify-content: center; }\n\n.bgView {\n  width: 80%;\n  height: 30px;\n  margin: 16px 0px;\n  border: .5px solid #CCCCCC;\n  border-radius: 4px;\n  display: flex;\n  flex-direction: row;\n  overflow: hidden; }\n  .bgView .color {\n    flex: 1; }\n  .bgView .title {\n    flex: 2;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 14px;\n    color: #555555; }\n  .bgView .selectTt {\n    color: #D9B878; }\n\n.selectBg {\n  border-color: #D9B878; }\n",""])},function(e,t,r){"use strict";var a=r(27),_=r.n(a),n=r(166),o=(r.n(n),function(e){var t=e.title,a=e.value,n=e.show,o=e.onClick;return _.a.createElement("div",{className:"model-row-header"},_.a.createElement("div",{className:"title"},t),_.a.createElement("div",{className:"value"},n?a:""),_.a.createElement("div",{className:"arrowContain",onClick:o},_.a.createElement("img",{className:"arrow",alt:"isImage",src:r(n?168:169)})))});t.a=o},function(e,t,r){var a=r(167);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,".model-row-header {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  width: 100%; }\n  .model-row-header .title {\n    margin-left: 16px;\n    font-size: 14px;\n    color: #555555; }\n  .model-row-header .value {\n    font-size: 12px;\n    color: #DFB86E;\n    margin-left: 24px;\n    flex: 1; }\n  .model-row-header .arrowContain {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: flex-end;\n    width: 60px;\n    height: 30px; }\n    .model-row-header .arrowContain .arrow {\n      margin-right: 16px; }\n",""])},function(e,t,r){e.exports=r.p+"static/media/arrow_down.44c0315b.svg"},function(e,t,r){e.exports=r.p+"static/media/arrow_up.0ee6f9be.svg"},function(e,t,r){var a=r(171);"string"===typeof a&&(a=[[e.i,a,""]]);var _={hmr:!0};_.transform=void 0;r(33)(a,_);a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(32)(void 0),t.push([e.i,".model-row-item {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #EEEEEE; }\n  .model-row-item .itemDetail {\n    width: 100%;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap; }\n",""])},function(e,t,r){"use strict";(function(e){function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function a(_,n){try{var o=t[_](n),i=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(i).then(function(e){a("next",e)},function(e){a("throw",e)});e(i)}return a("next")})}}r.d(t,"a",function(){return E});var _=r(76),n=r.n(_),o=r(173),i=function(){function e(e,t){var r=[],a=!0,_=!1,n=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){_=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(_)throw n}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s={info:function(){},show:function(){},success:function(){},fail:function(){},offline:function(){},loading:function(){},hide:function(){}},c=!1,E=function(){var e=a(n.a.mark(function e(t,r,a){var _,i,E,l,T,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _=o.a+t,e.prev=1,a&&a.hiddenLoading||(c=!0,setTimeout(function(){c&&(s.hide(),s.loading("",10))},300)),i={},E=null,E&&(i.headers={Authorization:"Bearer "+E,token:E}),l=Object.assign({},i,r),"POST"!==l.method&&"PUT"!==l.method&&"DELETE"!==l.method||(l.headers=Object.assign({Accept:"application/json","Content-Type":"application/json; charset=utf-8"},i.headers,l.headers)),console.log("==requestUrl==newOptions==",_,l),e.next=11,fetch(_,l);case 11:return T=e.sent,console.log("=====response======",T),e.next=15,T.json();case 15:return u=e.sent,console.log("=====result======",u),e.abrupt("return",u);case 20:e.prev=20,e.t0=e.catch(1),console.log(e.t0.toString());case 23:case"end":return e.stop()}},e,this,[[1,20]])}));return function(t,r,a){return e.apply(this,arguments)}}(),l=function(){var t=a(n.a.mark(function t(r,a){var _,o,i,s,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"http://mobiletest.ehaier.com:38080/";return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getItem("userToken");case 2:return _=t.sent,o=Object.assign({},a,{headers:Object.assign({Accept:"application/json"},a.headers,{TokenAuthorization:_})}),t.next=6,fetch(c+r,o);case 6:if(i=t.sent,i.ok){t.next=12;break}throw s=new Error(""+c+r+" is not OK!"),s.code=i.status,s.text=i.statusText,s;case 12:return t.abrupt("return",i);case 13:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}();!function(){var e=a(n.a.mark(function e(t,r,a,_,o,s){var c,E,T,u,d,f,P,A,S,p,v,m;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(c=-1===t.indexOf("?")?t+"?":t+"&",E=!0,T=!1,u=void 0,e.prev=4,d=Object.entries(r)[Symbol.iterator]();!(E=(f=d.next()).done);E=!0)P=f.value,A=i(P,2),S=A[0],p=A[1],c=c+S+"="+p+"&";e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),T=!0,u=e.t0;case 12:e.prev=12,e.prev=13,!E&&d.return&&d.return();case 15:if(e.prev=15,!T){e.next=18;break}throw u;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return c=c.substring(0,c.length-1),e.next=23,l(c,Object.assign({},a,{method:"GET"}),o);case 23:return v=e.sent,e.next=26,v.json();case 26:return m=e.sent,e.abrupt("return",m);case 28:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}))}()}).call(t,r(75))},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a="http://182.61.51.177:8080/mall/api"},function(e,t,r){"use strict";function a(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="/service-worker.js";o?(n(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):_(e)})}}function _(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}function n(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):_(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}t.a=a;var o=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))}]);
//# sourceMappingURL=main.980e55bf.js.map